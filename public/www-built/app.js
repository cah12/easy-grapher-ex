class MCurveLegendAttributeDlg{constructor(){var self=this,curveAttributeDlgInit=!1;function buildDlg(){$("body").append($('                    <div class="modal fade" id="curveLegendAttributeModal" role="dialog">                    <div class="modal-dialog modal-sm">                    <div class="modal-content">                    <div class="modal-header">                    <button type="button" class="close" data-dismiss="modal">&times;</button>                    <h4 class="modal-title">Curve Legend Attribute</h4>                    </div>                    <div class="modal-body">                    <div class="row">                    <div class="col-sm-5">Attribute:</div>                    <div class="col-sm-7">                    <select id="curveAttribute">                    <option value="default">Brush color(Default)</option>                    <option value="line">Line</option>                    <option value="symbol">Symbol</option>                    <option value="lineAndSymbol">Line and Symbol</option>                    </select>                    </div>                    </div>                    <br>                    <div class="row" id="iconSizeRow">                    <div class="col-sm-5">Icon size:</div>                    <div class="col-sm-7">                    <select id="iconSize">                    <option value="small">Small</option>                    <option value="medium">Medium</option>                    <option value="large">Large</option>                    </select>                    </div>                    </div>                    <br>                    <div class="modal-footer">                    <button id="curveAttributeDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Ok</button>                    </div>                    </div>                    </div>                    </div>                    </div>                    '))}function setIconSize(val){"small"==val?self.curve.setLegendIconSize(new Misc.Size(self.defaultIconSize.height-4,self.defaultIconSize.height-4)):"medium"==val?self.curve.setLegendIconSize(new Misc.Size(self.defaultIconSize.height,self.defaultIconSize.height)):self.curve.setLegendIconSize(new Misc.Size(self.defaultIconSize.height+4,self.defaultIconSize.height+4))}this.curveAttributeCb=function(curve){curveAttributeDlgInit||(buildDlg(),self.init(),self.defaultIconSize=new Misc.Size(curve.getLegendIconSize()),curveAttributeDlgInit=!0),self.curve=curve,self.curveAttributeDlg(),"line"==$("#curveAttribute").val()||"symbol"==$("#curveAttribute").val()||"lineAndSymbol"==$("#curveAttribute").val()?$("#iconSizeRow").hide():$("#iconSizeRow").show()},this.init=function(){var self=this;$("#curveLegendAttributeModal").on("shown.bs.modal",(function(){$("#curveAttributeDlg_ok").trigger("focus")})),$("#curveAttribute").change((function(){Utility.setLegendAttribute(self.curve,$(this).val(),self.defaultIconSize),"line"==$(this).val()?$("#iconSizeRow").hide():"symbol"==$(this).val()?$("#iconSizeRow").hide():"lineAndSymbol"==$(this).val()?$("#iconSizeRow").hide():(setIconSize($("#iconSize").val()),$("#iconSizeRow").show())})),$("#iconSize").change((function(){setIconSize($(this).val())}))},this.curveAttributeDlg=function(){self.curve&&self.curve.rtti===Static.Rtti_PlotCurve&&(self.curve.testLegendAttribute(Static.LegendShowLine)&&self.curve.testLegendAttribute(Static.LegendShowSymbol)?$("#curveAttribute").val("lineAndSymbol"):self.curve.testLegendAttribute(Static.LegendShowSymbol)?$("#curveAttribute").val("symbol"):self.curve.testLegendAttribute(Static.LegendShowLine)?$("#curveAttribute").val("line"):$("#curveAttribute").val("default"),$("#curveLegendAttributeModal").modal({backdrop:"static"}),self.curve.getLegendIconSize().width==self.defaultIconSize.width-4?$("#iconSize").val("small"):self.curve.getLegendIconSize().width==self.defaultIconSize.width?$("#iconSize").val("medium"):self.curve.getLegendIconSize().width==self.defaultIconSize.width+4&&$("#iconSize").val("large"))}}}define("curveLegendAttributeDlg",(function(){}));class MFunctionDlg{constructor(){var m_dlg1=$('                <div class="modal fade" id="functionModal" role="dialog">                <div class="modal-dialog modal-md">                <div class="modal-content">                <div class="modal-header">                \x3c!--button type="button" class="close" data-dismiss="modal">&times;</button--\x3e                <h4 class="modal-title">Curve Function</h4>                </div>                <div class="modal-body">                <div class="row">                <div class="col-sm-2">Three D:</div>                <div class="col-sm-1"><input id="fnDlg_threeD" type="checkbox"/></div>                <div id="threedTypeContainer">                <div class="col-sm-1">Type:</div>                <div class="col-sm-3"><select id="threeDType">                <option value="spectrocurve">Spectrocurve</option>                <option value="spectrogram">Spectrogram</option>                </select>                </div>                <div id="interpolationContainer">                <div class="col-sm-2">Interpolation:</div>                <div class="col-sm-3"><select id="interpolationType">                <option value="biLinear">Bi-linear</option>                <option value="biCubic">Bi-cubic</option>                </select>                </div>                </div>                </div>                </div>                <br>                <div class="row">                <div class="col-sm-2">Curve title:</div>                <div class="col-sm-4"><input id="fnDlg_title" style="width:100%" type="text" value="curve_1"/></div>                <div id="fx" class="col-sm-1">f(x):</div>                <div class="col-sm-5"><input id="fnDlg_function" style="width:100%" type="text" value="x^2"/></div>                </div>                <br>                <div id="limits" class="row">                <div class="col-sm-3">Lower limit(x):</div>                <div class="col-sm-3"><input id="fnDlg_lowerLimit" style="width:100%" type="text" value="-10.0"/></div>                <div class="col-sm-3">Upper limit(x):</div>                <div class="col-sm-3"><input id="fnDlg_upperLimit" style="width:100%" type="text" value="10.0"/></div>                </div>                <br>                <div id="limitsY" class="row">                <div class="col-sm-3">Lower limit(y):</div>                <div class="col-sm-3"><input id="fnDlg_lowerLimitY" style="width:100%" type="text" value="-10.0"/></div>                <div class="col-sm-3">Upper limit(y):</div>                <div class="col-sm-3"><input id="fnDlg_upperLimitY" style="width:100%" type="text" value="10.0"/></div>                </div>                <br>                <div id="limitsFxy" class="row">                <div class="col-sm-3">Lower limit(f(xy)):</div>                <div class="col-sm-3"><input id="fnDlg_lowerLimitFxy" style="width:100%" type="text" value="0"/></div>                <div class="col-sm-3">Upper limit(f(xy)):</div>                <div class="col-sm-3"><input id="fnDlg_upperLimitFxy" style="width:100%" type="text" value="10.0"/></div>                </div>                <br>                <div id="colorInterval" class="row">                <div class="col-sm-3">Color1(min):</div>                <div class="col-sm-3"><input id="fnDlg_color1" type="color" value="#008b8b"/></div>                <div class="col-sm-3">Color2(max):</div>                <div class="col-sm-3"><input id="fnDlg_color2" type="color" value="#ff0000"/></div>                </div>                <br>                <div class="row">                <div id="unboundedContainer">                <div class="col-sm-3">Unbounded range:</div>                <div class="col-sm-3"><input id="fnDlg_unboundedRange" type="checkbox"/></div>                </div>                <div class="col-sm-3">Number of points:</div>                <div class="col-sm-3"><input id="fnDlg_numberOfPoints" style="width:100%" type="number" min="2" max="200" value="100"/></div>                </div>                <br>                <div id="cont_variable" class="row">                <div class="col-sm-3">Enter variable(x):</div>                <div class="col-sm-1"><input id="fnDlg_variable" style="width:100%" type="text" value="x" /></div>                </div>                <div id="cont_variableY" class="row">                <div class="col-sm-3">Enter variable(y):</div>                <div class="col-sm-1"><input id="fnDlg_variableY" style="width:100%" type="text" value="y" /></div>                </div>                <br>                <div class="modal-footer">                <button id="fnDlg_ok" type="button" class="btn btn-default" >Ok</button>                <button id="fnDlg_cancel" type="button" class="btn btn-default"  data-dismiss="modal">Cancel</button>                </div>                </div>                </div>                </div>                </div>                ');function uniqueChars(str){var result=[];str=purgeKewords(str);for(var i=0;i<str.length;++i)Static.isAlpha(str[i])&&-1==result.indexOf(str[i])&&result.push(str[i]);return result}function selectorCont(index){return $("#coeff_cont"+(index+1))}function selector(index){return $("#coeff"+(index+1))}function hasKeyword(str){for(var i=0;i<keywords.length;++i)for(;-1!=str.indexOf(keywords[i]);)return!0;return!1}function insertProductSign(str){if(hasKeyword(str))return str;var result="";result+=str[0];for(var i=1;i<str.length;++i)Static.isAlpha(str[i-1])&&Static.isAlpha(str[i])&&(result+="*"),_.isFinite(str[i-1])&&Static.isAlpha(str[i])&&(result+="*"),result+=str[i];return result}function replaceLnWithLog(str){var result=str;return result.includes("ln")&&(result=result.replace("ln","log")),result}function getCoeffs(fnStr){var result=[],fn=fnStr||$("#fnDlg_function").val();fn=purgeKewords(fn);for(var indepVar=$("#fnDlg_variable").val();-1!=fn.indexOf(indepVar);)fn=fn.replace(indepVar,"");for(var i=0;i<fn.length;++i)Static.isAlpha(fn[i])&&-1==result.indexOf(fn[i])&&result.push(fn[i]);return result}function validateLimits(lowerLimit,upperLimit){return lowerLimit>=upperLimit&&Static.alert("Upper limit is less than Lower limit. Scale will be inverted."),!0}this.init=function(cb){var self=this;$("body").append(m_dlg1),$("#functionModal").on("shown.bs.modal",(function(){$("#fnDlg_ok").trigger("focus")})),$("#cont_variable").hide(),$("#cont_variableY").hide(),$("#threedTypeContainer").hide(),$("#colorInterval").hide(),$("#limitsY").hide(),$("#limitsFxy").hide(),$("#interpolationContainer").hide(),self.threeD=!1,$("#fnDlg_unboundedRange").change((function(){$(this)[0].checked?$("#limits").hide():$("#limits").show()})),$("#fnDlg_threeD").change((function(){self.threeD=$(this)[0].checked,self.threeD?($("#threedTypeContainer").show(),$("#limitsY").show(),$("#limitsFxy").show(),$("#unboundedContainer").hide(),$("#fx").html("f(x,y):"),$("#fnDlg_function").val("x^2 + y^2"),$("#colorInterval").show()):($("#threedTypeContainer").hide(),$("#limitsY").hide(),$("#limitsFxy").hide(),$("#unboundedContainer").show(),$("#fx").html("f(x):"),$("#fnDlg_function").val("x^2"),$("#colorInterval").hide()),$("#cont_variable").hide(),$("#cont_variableY").hide(),$("#fnDlg_variable").val("x"),$("#fnDlg_variableY").val("y")})),$("#threeDType").change((function(){"spectrogram"==$(this).val()?$("#interpolationContainer").show():$("#interpolationContainer").hide()})),$("#fnDlg_ok").click((function(){if($("#fnDlg_numberOfPoints").val()>200||$("#fnDlg_numberOfPoints").val()<2)$("#fnDlg_numberOfPoints").val(60),Static.alert('"Number of points" cannot be \nless than 2 or greater than 200');else{var expandedFn=Static.expandDefines($("#fnDlg_function").val());try{self.lowerLimit=math.evaluate(Static.expandDefines($("#fnDlg_lowerLimit").val()));var lower=Math.abs(self.lowerLimit);if(self.lowerLimit>0&&lower<Math.cbrt(_eps))return void Static.alert(`Absolute value of lower(x) limit must not be less than ${Math.cbrt(_eps)}.`)}catch(err){return void Static.alert("Please enter a valid lower(x) limit.")}try{self.upperLimit=math.evaluate(Static.expandDefines($("#fnDlg_upperLimit").val()));var upper=Math.abs(self.upperLimit);if(self.upperLimit>0&&upper<Math.cbrt(_eps))return void Static.alert(`Absolute value of upper(x) limit must not be less than ${Math.cbrt(_eps)}.`)}catch(err){return void Static.alert("Please enter a valid upper(x) limit.")}if(self.title=$("#fnDlg_title").val(),self.variable=$("#fnDlg_variable").val(),self.fn=$("#fnDlg_function").val(),self.expandedFn=insertProductSign(expandedFn),self.numOfPoints=parseInt($("#fnDlg_numberOfPoints").val()),self.threeD){self.threeDType=$("#threeDType").val(),"spectrogram"===self.threeDType&&(self.threeDInterpolationType=$("#interpolationType").val());try{self.lowerLimitY=math.evaluate($("#fnDlg_lowerLimitY").val())}catch(err){return void Static.alert("Please enter a valid lower(y) limit.")}try{self.upperLimitY=math.evaluate($("#fnDlg_upperLimitY").val())}catch(err){return void Static.alert("Please enter a valid upper(y) limit.")}try{self.lowerLimitFxy=math.evaluate($("#fnDlg_lowerLimitFxy").val())}catch(err){return void Static.alert("Please enter a valid lower(f(xy)) limit.")}try{self.upperLimitFxy=math.evaluate($("#fnDlg_upperLimitFxy").val())}catch(err){return void Static.alert("Please enter a valid upper(f(xy)) limit.")}self.variableY=$("#fnDlg_variableY").val(),self.color1=$("#fnDlg_color1").val(),self.color2=$("#fnDlg_color2").val()}else{var uniqChars=uniqueChars(self.expandedFn);if(uniqChars.length>0&&-1==uniqChars.indexOf($("#fnDlg_variable").val()))return Static.alert("Please enter a valid variable."),void $("#cont_variable").show();if(!validateLimits(parseFloat(self.lowerLimit),parseFloat(self.upperLimit)))return;if(self.unboundedRange=$("#fnDlg_unboundedRange")[0].checked,self.coeffs=getCoeffs(self.expandedFn),self.expandedFn=replaceLnWithLog(self.expandedFn),self.coeffs.length>5)return Static.alert("Number of unknown coefficient cannot be greater than 5."),void $("#cont_variable").show()}cb()}})),$("#fnDlg_function").on("input",(function(){var fn=$(this).val();self.threeD?uniqueChars(fn).length>2||-1==fn.indexOf("x")||-1==fn.indexOf("y")?($("#cont_variable").show(),$("#cont_variableY").show()):($("#cont_variable").hide(),$("#cont_variableY").hide()):uniqueChars(fn).length>1||-1==fn.indexOf("x")?$("#cont_variable").show():$("#cont_variable").hide()}))},this.functionDlg=function(curveName){$("#functionModal").modal({backdrop:"static"}),$("#fnDlg_title").val(curveName)},this.close=function(){$("#fnDlg_cancel").click()}}}define("functionDlg",(function(){}));class MCurveFitDlg{constructor(){var numOfSamples=100,self=this,m_type="",m_retain=!1,m_generate=!1,m_name="",m_color="",m_order=-1,m_origin=!1,m_tolerance=-1,m_chunksize=-1,m_plot=null,m_curve=null,m_option={precision:2},m_dlg1=$('                <div class="modal fade" id="curveFitModal" role="dialog">                <div class="modal-dialog modal-sm">                <div class="modal-content">                <div class="modal-header">                <button type="button" class="close" data-dismiss="modal">&times;</button>                <h4 class="modal-title">Curve Fitter</h4>                </div>                <div class="modal-body">                <div class="row">                <div class="col-sm-5">Fitter type:</div>                <div class="col-sm-7">                <select id="curveFitDlg_type">                <option value="natural">Natural spline</option>                <option value="periodic">Periodic spline</option>                <option value="weeding">Weeding</option>                <option value="linear">Linear</option>                <option value="polynomial">Polynomial</option>                <option value="noFitting">No fitting</option>                </select>                </div>                </div>                <br>                                                <div id="cont_origin">                <div class="row">                <div class="col-sm-7">Through origin:</div>                <div class="col-sm-2"><input id="origin" type="checkbox"/></div>                </div>                <br>                </div>                                <div id="cont_order">                <div class="row">                <div class="col-sm-2">Order:</div>                <div class="col-sm-3"><input id="order" type="number" style="width:100%" value="2" min="1" max="20"/></div><div>Precision: <input id="curveFitDlg_precision" type="number" min="1" max="100" value="2" /></div>                <br>                                               </div>                <br>                </div>                                <div id="cont_tolerance">                <div class="row">                <div class="col-sm-5">Tolerance:</div>                <div class="col-sm-4"><input id="tolerance" type="number" style="width:100%" value="10.0" min="0.0" max="200.0"/></div>                </div>                <br>                </div>                                <div id="cont_chunksize">                <div class="row">                <div class="col-sm-5">Chunk size:</div>                <div class="col-sm-4"><input id="chunksize" type="number" style="width:100%" value="0" min="0" /></div>                </div>                <br>                </div>                \t\t\t\t<div id="cont_retain">                <div class="row">                <div class="col-sm-7">Retain original curve:</div>                <div class="col-sm-2"><input id="curveFitDlg_retain" type="checkbox"/></div>                </div>                <br>\t\t\t\t</div>                                <div id="cont_generate">\t\t\t\t<div class="row">                <div class="col-sm-7">Generate points:</div>                <div class="col-sm-2"><input id="curveFitDlg_generate" type="checkbox" checked/></div>                </div>                <br>\t\t\t\t</div>                                                <div id="attributes">                <div class="row">                <div class="col-sm-6">Fitted curve name:</div>                <div class="col-sm-6"><input id="curveFitDlg_name" type="text" style="width:100%"/></div>                </div>                <br>                <div class="row">                <div class="col-sm-6">Fitted curve color:</div>                <div class="col-sm-2"><input id="curveFitDlg_color" type="color"/></div>                </div>                <br>                </div>                </div>                <div class="modal-footer">                <button id="curveFitDlg_ok" type="button" class="btn btn-default" >Ok</button>                </div>                </div>                </div>                </div>                </div>                ');function getRightHandSide(fn){for(fn=(fn=fn.replace(/\s/g,"")).replace("y=",""),fn=math.simplify(fn,{},{exactFractions:!1}).toString();-1!=fn.indexOf("+ -");)fn=fn.replace("+ -","- ");return fn}$("body").append(m_dlg1),$("#cont_origin").hide(),$("#cont_order").hide(),$("#cont_tolerance").hide(),$("#cont_chunksize").hide(),$("#curveFitModal").on("shown.bs.modal",(function(){$("#curveFitDlg_ok").trigger("focus")})),$("#curveFitDlg_type").change((function(){"linear"==$(this).val()?$("#cont_origin").show():$("#cont_origin").hide(),"polynomial"==$(this).val()?($("#order").val(m_curve.dataSize()-1),$("#cont_order").show()):$("#cont_order").hide(),"natural"==$(this).val()||"periodic"==$(this).val()||"weeding"==$(this).val()?$("#cont_generate").show():$("#cont_generate").hide(),"weeding"==$(this).val()?($("#cont_tolerance").show(),$("#cont_chunksize").show()):($("#cont_tolerance").hide(),$("#cont_chunksize").hide()),"noFitting"!==$(this).val()?($("#cont_retain").show(),$("#cont_retain").show()):($("#curveFitDlg_retain").prop("checked",!1),$("#cont_retain").hide(),$("#attributes").hide())})),$("#attributes").hide(),$("#curveFitDlg_retain")[0].checked=!1,$("#curveFitDlg_retain").change((function(){$(this)[0].checked?$("#attributes").show():$("#attributes").hide()})),this.curveFitCb=function(curve){return $("#curveFitModal").css("zIndex",$("#curveSettingsModal").css("zIndex")+1),self.curveFitDlgInit,null==self.curveFitDlgInit&&(self.init(),self.curveFitDlgInit=!0),m_plot=curve.plot(),m_curve=curve,self.curveFitDlg(),self},this.cb=function(){if(m_retain){var title=m_name;if(m_plot.findPlotCurve(title))return void Static.alert(title+" already exist")}var doReplot=m_plot.autoReplot();m_plot.setAutoReplot(!1);var curve=new MyCurve;if(curve.setPen(new Misc.Pen(m_color)),curve.fn=m_curve.fn,curve.variable=m_curve.variable,curve.setAxes(m_curve.xAxis(),m_curve.yAxis()),curve.origin=m_origin,curve.setStyle(m_curve.style()),"natural"==m_type||"periodic"==m_type){curve.setData(m_curve.data());var splineCurveFitter=new SplineCurveFitter,s=splineCurveFitter.spline();if("periodic"==m_type?s.setSplineType(Static.SplineType.Periodic):s.setSplineType(Static.SplineType.Natural),curve.setCurveFitter(splineCurveFitter),m_generate){for(var xMap=m_plot.axisScaleDraw(m_curve.xAxis()).scaleMap(),yMap=m_plot.axisScaleDraw(m_curve.yAxis()).scaleMap(),samp=m_curve.data().samples(),samps=[],i=0;i<samp.length;i++)samps.push(new Misc.Point(xMap.transform(samp[i].x),yMap.transform(samp[i].y)));samps=splineCurveFitter.fitCurve(samps),curve.setCurveFitter(null);for(var _samps=[],i=0;i<samps.length;i++)_samps.push(new Misc.Point(xMap.invTransform(samps[i].x),yMap.invTransform(samps[i].y)));curve.setSamples(_samps)}else curve.setSamples(m_curve.data().samples())}else if("weeding"==m_type){curve.setData(m_curve.data());var weedingCurveFitter=new WeedingCurveFitter(10);if(weedingCurveFitter.setChunkSize(parseInt(m_chunksize)),weedingCurveFitter.setTolerance(parseInt(m_tolerance)),curve.setCurveFitter(weedingCurveFitter),m_generate){for(var xMap=m_plot.axisScaleDraw(m_curve.xAxis()).scaleMap(),yMap=m_plot.axisScaleDraw(m_curve.yAxis()).scaleMap(),samp=m_curve.data().samples(),samps=[],i=0;i<samp.length;i++)samps.push(new Misc.Point(xMap.transform(samp[i].x),yMap.transform(samp[i].y)));samps=weedingCurveFitter.fitCurve(samps),curve.setCurveFitter(null);for(var _samps=[],i=0;i<samps.length;i++)_samps.push(new Misc.Point(xMap.invTransform(samps[i].x),yMap.invTransform(samps[i].y)));curve.setSamples(_samps)}else curve.setSamples(m_curve.data().samples())}else if("noFitting"==m_type)curve.setData(m_curve.data()),curve.setCurveFitter(null);else{for(var regr=regress(m_curve,m_type,parseInt(m_order),m_origin,m_option),rc=m_curve.data().boundingRect(),fn=regr.string;-1!=fn.indexOf("+ -");)fn=fn.replace("+ -","- ");fn=getRightHandSide(fn),curve.equation="y="+fn,curve.expandedFn=curve.fn=fn,curve.variable="x";let functionDlgData={};functionDlgData.rtti=Static.Rtti_PlotCurve,functionDlgData.coeffs=[],functionDlgData.expandedFn=curve.expandedFn,functionDlgData.fn=curve.expandedFn,functionDlgData.lowerLimit=rc.left(),functionDlgData.numOfPoints=100,functionDlgData.threeD=!1,functionDlgData.title=1==m_retain?title:m_curve.title(),functionDlgData.unboundedRange=!1,functionDlgData.upperLimit=rc.right(),functionDlgData.variable="x",curve.functionDlgData=functionDlgData,curve.setSamples(Utility.makeSamples({fx:fn,lowerX:rc.left(),upperX:rc.right(),numOfSamples:100}))}m_retain?curve.setTitle(title):(curve.setTitle(m_curve.title()),m_curve.detach()),curve.fitType=m_type,curve.attach(m_plot),m_plot.setAutoReplot(doReplot),m_plot.autoRefresh(),self.close()},this.init=function(){var self=this;$("#curveFitDlg_ok").click((function(){m_type=$("#curveFitDlg_type").val(),m_retain=$("#curveFitDlg_retain")[0].checked,m_generate=$("#curveFitDlg_generate")[0].checked,m_name=$("#curveFitDlg_name").val(),m_color=$("#curveFitDlg_color").val(),m_order=$("#order").val()||1,m_option={precision:parseInt($("#curveFitDlg_precision").val())},m_origin=$("#origin")[0].checked,m_tolerance=$("#tolerance").val(),m_chunksize=$("#chunksize").val(),self.cb()}))},this.curveFitDlg=function(){var self=this;m_curve&&m_curve.rtti===Static.Rtti_PlotCurve&&($("#curveFitDlg_name").val(Utility.generateCurveName(m_plot,m_curve.title()+"_fit")),$("#curveFitDlg_color").val(Static.colorNameToHex(m_curve.pen().color)),$("#curveFitModal").modal({backdrop:"static"}))},this.curveFitInfoCb=function(curve){var info="";return"natural"==curve.fitType?info+="Fit type:Natural Spline":"periodic"==curve.fitType?info+="Fit type:Periodic Spline":"polynomial"==curve.fitType?(info+="Fit type:Polynomial",info+="; Equation:"+curve.equation):"weeding"==curve.fitType?(info+="Fit type:Weeding",info+="; Tolerance:"+m_tolerance):"linear"==curve.fitType&&(curve.origin?info+="Fit type:Linear Through Origin":info+="Fit type:Linear",info+="; Equation:"+curve.equation),info},this.close=function(){$(".close").click()}}}define("curveFitDlg",(function(){}));class MCurveStyleDlg{constructor(){var self=this,styleMap={Lines:Lines,Sticks:Sticks,Steps:Steps,Dots:Dots,NoCurve:NoCurve},invertedStyleMap=_.invert(styleMap);function buildDlg(){$("body").append($('                    <div class="modal fade" id="curveStyleModal" role="dialog">                    <div class="modal-dialog modal-sm">                    <div class="modal-content">                    <div class="modal-header">                    <button type="button" class="close" data-dismiss="modal">&times;</button>                    <h4 class="modal-title">Curve Style</h4>                    </div>                    <div class="modal-body">                    <div class="row">                    <div class="col-sm-5">Curve style:</div>                    <div class="col-sm-7">                    <select id="curveStyleDlgStyle">                    <option value="Lines">Lines (Default)</option>                    <option value="Sticks">Sticks</option>                    <option value="Steps">Steps</option>                    <option value="Dots">Dots</option>                    <option value="NoCurve">NoCurve</option>                    </select>                    </div>                    </div>                    <br>                    <div class="row">                    <div class="col-sm-7">                    </div>                    </div>                    <br>                    <div class="modal-footer">                    <button id="curveStyleDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Ok</button>                    </div>                    </div>                    </div>                    </div>                    </div>                    ')),$("#curveStyleModal").on("shown.bs.modal",(function(){$("#curveStyleDlg_ok").trigger("focus")}))}this.curveStyleCb=function(curve){self.curveStyleDlgInit,null==self.curveStyleDlgInit&&(buildDlg(),self.init(),self.curveStyleDlgInit=!0),self.curve=curve,self.curveStyleDlg()},this.init=function(){$("#curveStyleDlgStyle").change((function(){var style=styleMap[$(this).val()];self.curve.setStyle(style),Static.trigger("curveStyleChanged",self.curve)}))},this.curveStyleDlg=function(){self.curve&&self.curve.rtti===Static.Rtti_PlotCurve&&($("#curveStyleDlgStyle").val(invertedStyleMap[self.curve.style()]),$("#curveStyleModal").modal({backdrop:"static"}))}}}define("curveStyleDlg",(function(){}));class MAxisDlg{constructor(){var self=this,_curve=null,buildDlg=_.once((function(){$("body").append($('                        <div class="modal fade" id="axisModal" role="dialog">                        <div class="modal-dialog modal-sm">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal">&times;</button>                        <h4 class="modal-title">Curve Axis</h4>                        </div>                        <div class="modal-body">                        <div class="row">                        <div class="col-sm-5">Horizontal:</div>                        <div class="col-sm-7">                        <select id="axisHorizontal1">                        <option value="bottomAxis">Bottom axis</option>                        <option value="topAxis">Top axis</option>                        </select>                        </div>                        </div>                        <br>                        <div class="row">                        <div class="col-sm-5">Vertical:</div>                        <div class="col-sm-7">                        <select id="axisVertical1">                        <option value="leftAxis">Left axis</option>                        <option value="rightAxis">Right axis</option>                        </select>                        </div>                        </div>                        <br>                        <div class="modal-footer">                        <button id="axisDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Ok</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#axisModal").on("shown.bs.modal",(function(){$("#axisDlg_ok").trigger("focus")})),$("#axisHorizontal1").change((function(){"bottomAxis"==$(this).val()?(_curve.setXAxis(xBottom),Static.trigger("axisChanged",[xBottom,_curve])):(_curve.setXAxis(xTop),Static.trigger("axisChanged",[xTop,_curve]))})),$("#axisVertical1").change((function(){"leftAxis"==$(this).val()?(_curve.setYAxis(yLeft),Static.trigger("axisChanged",[yLeft,_curve])):(_curve.setYAxis(yRight),Static.trigger("axisChanged",[yRight,_curve]))}))}));function axisDlgInit(){_curve.xAxis()==xBottom?$("#axisHorizontal1").val("bottomAxis"):$("#axisHorizontal1").val("topAxis"),_curve.yAxis()==yLeft?$("#axisVertical1").val("leftAxis"):$("#axisVertical1").val("rightAxis")}function showDlg(){$("#axisModal").modal({backdrop:"static"})}this.axisCb=function(curve){buildDlg(),_curve=curve,axisDlgInit(),showDlg()}}}define("axisDlg",(function(){}));class MPointEntryDlg{constructor(){const self=this;let buildDlg=_.once((function(){$("#pointEntryModal").remove(),$("body").append($('                        <div class="modal fade" id="pointEntryModal" role="dialog">                        <div class="modal-dialog modal-sm">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class= "close" id="closePointEntryDlg">&times;</button>                        <h4 id="pointEntryTitle" class="modal-title">Add/Romve Point</h4>                        </div>                        <div class="modal-body">                        <div class="row">                        <div class="col-sm-4">Name:</div>                        <input id="curve_name" type="text" value="curve_1">                        </div>                        <br>                        <div class="row">                        <div class="col-sm-4">Abscissa(X):</div>                        <input id="abscissa" type="text" value="0.0">                        </div>                        <br>                        <div class="row">                        <div class="col-sm-4">Ordinate(Y):</div>                        <input id="ordinate" type="text" value="0.0">                        </div>                        <br>                        <div class="modal-footer">                        <button id="pointEntryDlg_enter" type="button" class="btn btn-default" >Add</button>                        <button id="pointEntryDlg_remove" type="button" class="btn btn-default" >Remove</button>                        <button id="pointEntryDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Finish</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#pointEntryDlg_enter").click(enterCb),$("#pointEntryDlg_remove").click(removeCb),$("#closePointEntryDlg").click(closeCb),$("#curve_name, #abscissa, #ordinate").keyup(keyupCb),$("#pointEntryDlg_remove").attr("disabled",!1),$("#pointEntryDlg_enter").attr("disabled",!0),$("#pointEntryModal").on("shown.bs.modal",(function(){$("#pointEntryDlg_enter").trigger("focus")}))}));function setRemoveButtonAttribute(){var curve=self.plot.findPlotCurve($("#curve_name").val());curve&&curve.data().samples().length>1?$("#pointEntryDlg_remove").attr("disabled",!1):$("#pointEntryDlg_remove").attr("disabled",!0)}function findPoint(pt){var curve=self.plot.findPlotCurve($("#curve_name").val());if(!curve)return!1;var samples=curve.data().samples();if(samples.length>0)for(var i=0;i<samples.length;++i)if(pt.x==samples[i].x&&pt.y==samples[i].y)return!0;return!1}function keyupCb(){var curve=self.plot.findPlotCurve($("#curve_name").val()),samples,abscissaVal,ordinateVal;if(curve&&(samples=curve.data().samples()),"-"==$("#abscissa").val())return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0);try{abscissaVal=math.evaluate(Static.expandDefines($("#abscissa").val()))}catch(error){return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0)}if("-"==$("#ordinate").val())return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0);try{ordinateVal=math.evaluate(Static.expandDefines($("#ordinate").val()))}catch(error){return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0)}if(null==ordinateVal||null==abscissaVal)return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0);findPoint(new Misc.Point(abscissaVal,ordinateVal))?(samples.length>1&&$("#pointEntryDlg_remove").attr("disabled",!1),$("#pointEntryDlg_enter").attr("disabled",!0)):($("#pointEntryDlg_remove").attr("disabled",!0),$("#pointEntryDlg_enter").attr("disabled",!1))}function closeCb(){$("#pointEntryDlg_ok").click()}function removeCb(){let curve;self.plot.findPlotCurve($("#curve_name").val()).removePoint(new Misc.Point(parseFloat($("#abscissa").val()),parseFloat($("#ordinate").val()))),$("#pointEntryDlg_remove").attr("disabled",!0),$("#pointEntryDlg_enter").attr("disabled",!1),Static.trigger("curveAdjusted")}function enterCb(){let curve=self.plot.findPlotCurve($("#curve_name").val());if(curve)"Modify/Remove Point"==self.dlgTitle()&&(curve.removePoint(self.point,!0),Static.trigger("curveAdjusted"));else{curve=new MyCurve($("#curve_name").val()),curve.attach(self.plot);let color=Utility.randomColor();curve.setPen(new Misc.Pen(color));let sym=new Symbol(MRect,new Misc.Brush(Static.invert(color)),new Misc.Pen(color),new Misc.Size(8,8));curve.setSymbol(sym);let attribute="";Static.showline&&Static.showsymbol?attribute="lineAndSymbol":Static.showline?attribute="line":Static.showsymbol&&(attribute="symbol"),Utility.setLegendAttribute(curve,attribute,curve.getLegendIconSize())}let samples=curve.data().samples();var abscissaVal=math.evaluate(Static.expandDefines($("#abscissa").val())),diff=Math.abs(Math.abs(abscissaVal)-_eps),ordinateVal=math.evaluate(Static.expandDefines($("#ordinate").val()));let p=new Misc.Point(abscissaVal,ordinateVal);self.point=p,samples.containsPoint(p)||samples.push(p),samples.sort((function(a,b){return a.x-b.x})),curve.setSamples(samples),self.plot.autoRefresh(),Static.trigger("pointAdded",curve),Static.trigger("curveAdjusted"),$("#pointEntryDlg_enter").attr("disabled",!0),samples.length>1&&$("#pointEntryDlg_remove").attr("disabled",!1)}function showDlg(){setRemoveButtonAttribute(),$("#pointEntryModal").modal({backdrop:"static"})}this.setDlgTitle=function(title){$("#pointEntryTitle").html(title),"Modify/Remove Point"==title?$("#pointEntryDlg_enter").html("Modify"):$("#pointEntryDlg_enter").html("Add")},this.dlgTitle=function(title){return $("#pointEntryTitle").html()},this.pointEntryCb=function(dlgTitle,plot,curveName,point){self.curveName=curveName,self.point=point,buildDlg(),self.setDlgTitle(dlgTitle),void 0!==curveName&&$("#curve_name").val(curveName),void 0!==point&&($("#abscissa").val(point.x),$("#ordinate").val(point.y)),self.plot=plot,showDlg(),"Modify/Remove Point"==dlgTitle?($("#curve_name").attr("disabled",!0),$("#pointEntryDlg_enter").attr("disabled",!0)):($("#curve_name").attr("disabled",!1),findPoint(new Misc.Point($("#abscissa").val(),$("#ordinate").val()))||$("#pointEntryDlg_enter").attr("disabled",!1))}}}define("pointEntryDlg",(function(){}));class ToolBar{constructor(obj){var buttonList=[];function defaultCb(){console.log("No callback defined for button")}obj=obj||{};var tbDiv=$('<div id="toolBar1" class="noprint" style="position:relative; border-style: ridge; background-color: lightBlue"></div>');function textToId(text){for(var id=0,i=0;i<buttonList.length;++i)if(buttonList[i][0].innerText.trim().split(" ")[0]==text)return i;return-1}void 0!==obj.zIndex&&tbDiv.css("zIndex",obj.zIndex),tbDiv.insertBefore($("#plotDiv")),$("#plotDiv").removeClass("noToolBar"),$("#plotDiv").addClass("toolBar");var addToggleSwitch=function(obj){var option=obj.label||"Option 1",checked="";obj.checked&&(checked="checked"),obj.innerHtmlId=obj.innerHtmlId||"elem_"+buttonList.length;var chkbox=$('<label data-toggle="tooltip" class="checkbox-inline switch">                                    <input id='+obj.innerHtmlId+'  type="checkbox" value="" '+checked+'>                                    <span class="slider round" style="width:48px"></span>                                    <span style="margin-left:30px">'+option+"</span>                                  </label>");chkbox.css("marginLeft",obj.marginLeft||4),chkbox.css("marginRight",obj.marginRight||2),tbDiv.append(chkbox),chkbox.attr("title",obj.tooltip);var _cb=obj.cb||function(){console.log("No callback defined for button")};return $("#"+obj.innerHtmlId).on("change",(function(){_cb($(this)[0].checked)})),buttonList.push(chkbox),buttonList.length-1},addPushbutton=function(obj){obj.text=obj.text,obj.class=obj.class||"btn btn-primary",obj.innerHtmlId=obj.innerHtmlId||"elem_"+buttonList.length,obj.duration=obj.duration||40;var b=$("<button id="+obj.innerHtmlId+' type="button" data-toggle="tooltip">');if(b.addClass(obj.class),void 0!==obj.icon){void 0!==obj.text&&obj.text.length&&b.text(obj.text+" ");var img=$("<img src="+obj.icon+' alt="Img" width=18px>');b.append(img)}else b.text(obj.text);tbDiv.append(b),b.attr("title",obj.tooltip);var _cb=obj.cb||function(){console.log("No callback defined for button")},clickEvent="click",mousedownEvent="mousedown",mouseupEvent="mouseup";return Static.isMobile()&&(clickEvent="tap",mousedownEvent="touchstart",mouseupEvent="touchend"),obj.repeat?(b.interval=null,b.bind(mousedownEvent,(function(e){"mousedown"==mousedownEvent&&0!=e.button||(b.interval=setInterval(_cb,obj.duration))})),b.bind(mouseupEvent+" mouseleave",(function(){clearInterval(b.interval)}))):b.bind(clickEvent,_cb),buttonList.push(b),buttonList.length-1};this.html=function(){return tbDiv},this.disable=function(identifier){"string"==typeof identifier&&(identifier=textToId(identifier)),buttonList[identifier].attr("disabled",!0)},this.enable=function(identifier){"string"==typeof identifier&&(identifier=textToId(identifier)),buttonList[identifier].attr("disabled",!1)},this.hide=function(identifier){"string"==typeof identifier&&(identifier=textToId(identifier)),null==identifier&&(identifier=-1),identifier>-1&&identifier<buttonList.length?buttonList[identifier].hide():(tbDiv.hide(),$("#plotDiv").removeClass("toolBar"),$("#plotDiv").addClass("noToolBar")),obj.refreshCb&&refreshCb()},this.show=function(identifier){"string"==typeof identifier&&(identifier=textToId(identifier)),null==identifier&&(identifier=-1),identifier>-1&&identifier<buttonList.length?buttonList[identifier].show():(tbDiv.show(),$("#plotDiv").removeClass("noToolBar"),$("#plotDiv").addClass("toolBar")),obj.refreshCb&&refreshCb()};var addCheckbox=function(obj){var option=obj.label||"Option 1",checked="";obj.checked&&(checked="checked"),obj.innerHtmlId=obj.innerHtmlId||"elem_"+buttonList.length;var chkbox=$('<label data-toggle="tooltip" class="checkbox-inline">                                    <input id='+obj.innerHtmlId+'  type="checkbox" value="" '+checked+">"+option+"                                  </label>");chkbox.css("marginLeft",obj.marginLeft||8),chkbox.css("marginRight",obj.marginRight||8),tbDiv.append(chkbox),obj.disabled&&$("#"+obj.innerHtmlId).attr("disabled",!0),chkbox.attr("title",obj.tooltip);var _cb=obj.cb||function(){console.log("No callback defined for button")};return chkbox.click((function(){_cb($("#"+obj.innerHtmlId).is(":checked"))})),buttonList.push($("#"+obj.innerHtmlId)),buttonList.length-1},addSlider=function(obj){var option=obj.label||"Option 1",min="";void 0!==obj.min&&(min=' min="'+obj.min+'"');var max="";void 0!==obj.max&&(max=' max="'+obj.max+'"');var value="";void 0!==obj.value&&(value=" value="+obj.value+" ");var width=" width:100px ";void 0!==obj.width&&(width=" width:"+obj.width+"px "),obj.innerHtmlId=obj.innerHtmlId||"elem_"+buttonList.length;var sliderCntrl=$('<input style="position:absolute; '+width+'" id='+obj.innerHtmlId+" "+value+'  type="range" '+min+" "+max+"/>"),slider=$("<label for="+obj.innerHtmlId+'data-toggle="tooltip">'+option+"</label>");slider.append(sliderCntrl),slider.css("marginLeft",obj.marginLeft||8),slider.css("marginRight",obj.marginRight||8),sliderCntrl.css("marginLeft",obj.marginLeft||8),sliderCntrl.css("marginTop",obj.marginTop||2),tbDiv.append(slider),sliderCntrl.css("top",tbDiv.css("top"));var parent=$("#"+obj.innerHtmlId).parent()[0],pos=parent.offsetLeft+parent.offsetWidth;sliderCntrl.css("left",pos),slider.css("width",parent.offsetWidth+parseInt(sliderCntrl.css("width"))),slider.attr("title",obj.tooltip);var _cb=obj.cb||function(){console.log("No callback defined for button")};return sliderCntrl.on("change",(function(){_cb(parseInt($(this).val()))})),buttonList.push(slider),buttonList.length-1},addRadiobutton=function(obj){var option=obj.label||"Option 1";obj.value=obj.value||option,obj.innerHtmlId=obj.innerHtmlId||"elem_"+buttonList.length;var name=obj.name||"optradio",checked="";obj.checked&&(checked="checked");var inp=null;inp=obj.checked?$("<input id="+obj.innerHtmlId+' type="radio" checked value='+obj.value+" name="+name+">"):$("<input id="+obj.innerHtmlId+' type="radio" value='+obj.value+" name="+name+">");var r=$('<label data-toggle="tooltip" class="checkbox-inline">                                    '+option+"                                  </label>");r.append(inp),r.css("marginLeft",obj.marginLeft||0),r.css("marginRight",obj.marginRight||0),tbDiv.append(r),r.attr("title",obj.tooltip),r.addClass(obj.class);var _cb=obj.cb||defaultCb;return r.click(_cb),buttonList.push(r),buttonList.length-1};function makeListElement(obj){for(var str="",checkbox=obj.hasCheckbox||!1,elementsInfo=obj.listElements||[],i=0;i<elementsInfo.length;++i)elementsInfo[i].icon=elementsInfo[i].icon||"",elementsInfo[i].checked=elementsInfo[i].checked||"unchecked",checkbox&&!elementsInfo[i].icon.length&&(elementsInfo[i].tooltip?str+='<li title="'+elementsInfo[i].tooltip+'"><a href="#"><label><input type="checkbox" '+elementsInfo[i].checkboxState+" value="+i+">"+elementsInfo[i].text+"</label></a></li>":str+='<li><a href="#"><label><input type="checkbox" '+elementsInfo[i].checkboxState+" value="+i+">"+elementsInfo[i].text+"</label></a></li>"),!checkbox&&elementsInfo[i].icon.length&&(elementsInfo[i].tooltip?str+='<li title="'+elementsInfo[i].tooltip+'"><a href="#"><label><img src='+elementsInfo[i].icon+' alt="Img" width=20px> '+elementsInfo[i].text+"</label></a></li>":str+='<li><a href="#"><label>'+elementsInfo[i].icon+elementsInfo[i].text+"</label></a></li>"),checkbox&&elementsInfo[i].icon.length&&(elementsInfo[i].tooltip?str+='<li title="'+elementsInfo[i].tooltip+'"><a href="#"><label><img src='+elementsInfo[i].icon+' alt="Img" width=20px><input type="checkbox" '+elementsInfo[i].checkboxState+' value="">'+elementsInfo[i].text+"</label></a></li>":str+='<li><a href="#"><label><input type="checkbox" '+elementsInfo[i].checkboxState+' value="">'+elementsInfo[i].icon+elementsInfo[i].text+"</label></a></li>"),checkbox||elementsInfo[i].icon.length||(elementsInfo[i].tooltip?str+='<li title="'+elementsInfo[i].tooltip+'"><a href="#"><label>'+elementsInfo[i].text+"</label></a></li>":str+='<li><a href="#"><label>'+elementsInfo[i].text+"</label></a></li>");return str}var addDropdown=function(obj){var option=obj.label||"Option 1";obj.text=obj.text||"Button",obj.innerHtmlId=obj.innerHtmlId||"elem_"+buttonList.length;var d=$('<span data-toggle="tooltip" class="dropdown">                              <button id='+obj.innerHtmlId+' class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">'+obj.text+'                              <span class="caret"></span></button>                              <ul class="dropdown-menu">'+makeListElement(obj)+"</ul>                          </span>");return d.css("marginLeft",obj.marginLeft||0),d.css("marginRight",obj.marginRight||0),d.addClass(obj.class),d.attr("title",obj.tooltip),tbDiv.append(d),obj.cb=obj.cb||defaultCb,d.on("click",(function(e){var el;if((el=$(e.target)).parent().parent().parent().hasClass("disabled"))return!1;if(!obj.hasCheckbox){var el,index=(el=$(e.target)).closest("li").index();-1!=index&&obj.cb(e,index)}})),d.on("change",(function(e){var el=$(e.target),checked=el.prop("checked");obj.cb(e,el.closest("li").index(),el.prop("checked"))})),buttonList.push(d),buttonList.length-1},addSelect=function(obj){obj.label=obj.label||"Select One",obj.innerHtmlId=obj.innerHtmlId||"elem_"+buttonList.length;var sel=$("<select/>"),s=$('<span data-toggle="tooltip"><label for='+obj.innerHtmlId+">"+obj.label+":</label>                            </span>");s.append(sel);for(var seltns=obj.selections||[],i=0;i<seltns.length;++i)sel.append($("<option>"+seltns[i]+"</option>"));s.css("marginLeft",obj.marginLeft||8),s.css("marginRight",obj.marginRight||8),s.addClass(obj.class),s.attr("title",obj.tooltip),tbDiv.append(s);var _cb=obj.cb||function(){console.log("No callback defined for button")};return sel.on("change",(function(){_cb($(this)[0].selectedIndex)})),buttonList.push(s),buttonList.length-1},addUpload=function(obj){obj.label=obj.label||"Select One",obj.innerHtmlId=obj.innerHtmlId||"elem_"+buttonList.length;var inp=$("<input id="+obj.innerHtmlId+'  type="file" name="files[]" multiple />'),u=$('<button data-toggle="tooltip"></button>');inp.css("marginLeft",-8),inp.css("marginRight",-8),inp.css("marginTop",-3),inp.css("marginBottom",-3),u.append(inp),u.css("marginLeft",obj.marginLeft||8),u.css("marginRight",obj.marginRight||8),u.addClass(obj.class),u.attr("title",obj.tooltip),tbDiv.append(u),buttonList.push(u);var click=!1;return u.click((function(){if(!click)return click=!0,inp.trigger("click"),!1})),buttonList.length-1},addNumber=function(obj){obj.label=obj.label||"Select One",obj.innerHtmlId=obj.innerHtmlId||"elem_"+buttonList.length,obj.min=obj.min||-1e6,obj.max=obj.max||1e6,obj.value=obj.value||obj.min,obj.value>obj.max&&(obj.value=obj.max),obj.value<obj.min&&(obj.value=obj.min);var n=$('<span data-toggle="tooltip"><label for="sel1">'+obj.label+":</label>                                   </span>"),spinBox=$("<input id="+obj.innerHtmlId+'  type="number"                            value="10" name="some-name"/>');n.append(spinBox),tbDiv.append(n),spinBox.attr({width:200,min:obj.min,max:obj.max,step:obj.step,value:obj.value}),n.attr("title",obj.tooltip),n.css("marginLeft",obj.marginLeft||8),n.css("marginRight",obj.marginRight||8),n.addClass(obj.class);var _cb=obj.cb||function(){console.log("No callback defined for button")};return spinBox.on("change",(function(){_cb(parseFloat($(this).val()))})),buttonList.push(n),buttonList.length-1},addLink=function(obj){obj.text=obj.text||"Button",obj.innerHtmlId=obj.innerHtmlId||"elem_"+buttonList.length;var l=$("<A HREF="+obj.href+"></a>");l.text(obj.text),tbDiv.append(l),l.addClass(obj.class),l.attr("title",obj.tooltip),l.attr("target",obj.target);var _cb=obj.cb||function(){console.log("No callback defined for button")};return l.click(_cb),buttonList.push(l),buttonList.length-1};this.addToolButton=function(type,obj){return"pushbutton"==type?addPushbutton(obj):"checkbox"==type?addCheckbox(obj):"toggleSwitch"==type?addToggleSwitch(obj):"radio"==type?addRadiobutton(obj):"dropdown"==type?addDropdown(obj):"select"==type?addSelect(obj):"slider"==type?addSlider(obj):"number"==type?addNumber(obj):"upload"==type?addUpload(obj):"link"==type?addLink(obj):void 0},this.setButtonCheck=function(buttonId,on){"string"==typeof buttonId&&(buttonId=textToId(buttonId)),buttonList[buttonId][0].children[0]?buttonList[buttonId][0].children[0].checked=on:buttonList[buttonId][0].checked=on},this.isDropdownItemChecked=function(buttonId,listIndex){var input;return"string"==typeof buttonId&&(buttonId=textToId(buttonId)),$($(buttonList[buttonId].children()[1]).children()[listIndex]).children().children().children().prop("checked")},this.setDropdownItemCheck=function(buttonId,listIndex,on){var input;"string"==typeof buttonId&&(buttonId=textToId(buttonId)),$($(buttonList[buttonId].children()[1]).children()[listIndex]).children().children().children().prop("checked",on)},this.hideDropdownItem=function(buttonId,listIndex){"string"==typeof buttonId&&(buttonId=textToId(buttonId)),$($(buttonList[buttonId].children()[1]).children()[listIndex]).hide()},this.showDropdownItem=function(buttonId,listIndex){"string"==typeof buttonId&&(buttonId=textToId(buttonId)),$($(buttonList[buttonId].children()[1]).children()[listIndex]).show()},this.enableDropdownItem=function(buttonId,listIndex,on){"string"==typeof buttonId&&(buttonId=textToId(buttonId));var liItem=$($(buttonList[buttonId].children()[1]).children()[listIndex]).addClass("disabled");on?liItem.removeClass("disabled"):liItem.addClass("disabled")}}}define("toolBar",(function(){}));class MCurveSettings{constructor(_plot){let self=this,_curveFitCb=null,_curveFitInfoCb=null,_curveAttributeCb=null,_curveStyleCb=null,_curveAxisCb=null;function addSymbol(curve,style){if("None"==style)return void curve.setSymbol(null);let _style=-1;"MRect"==style&&(_style=MRect),"Cross"==style&&(_style=Cross),"Diamond"==style&&(_style=Diamond),"Ellipse"==style&&(_style=Ellipse),"XCross"==style&&(_style=XCross),Utility.addSymbol(curve,_style)}function setSymbolPenWidth(curve,width){Utility.setSymbolPenWidth(curve,width)}function setSymbolSize(curve,value){Utility.setSymbolSize(curve,value)}function initCurveSelect(){let opts=$("#curveSelect").children();for(let i=0;i<opts.length;++i)$("#curveSelect")[0].removeChild(opts[i]);let curves=_plot.itemList(Static.Rtti_PlotCurve);for(let i=0;i<curves.length;++i)if(curves[i].isVisible()){let opt=$("<option>"+curves[i].title()+"</option>");opt.attr("value",curves[i].title()),$("#curveSelect").append(opt)}return $("#sizeSymbol").val(10),curves.length?curves[0]:null}function initClearBrushButton(curve){curve.brush().color==Static.NoBrush?$("#clearBrush").hide():$("#clearBrush").show()}function initDlg(curve){if(!curve)return;let penStyles=["solid","dot","dash","dashDot","dashDotDot"];$("#penColor").val(Static.colorNameToHex(curve.pen().color)),$("#penWidth")[0].selectedIndex=curve.pen().width-1,$("#penStyle")[0].selectedIndex=penStyles.indexOf(curve.pen().style),$("#horizontalAxis")[0].selectedIndex=curve.xAxis()-2,$("#verticalAxis")[0].selectedIndex=curve.yAxis(),curve.fitType?$("#fitInfo").show():$("#fitInfo").hide(),initClearBrushButton(curve);let symbol=curve.symbol();if(symbol){let symbolStyle=symbol.style();symbolStyle==MRect&&$("#symbolType").val("MRect"),symbolStyle==Cross&&$("#symbolType").val("Cross"),symbolStyle==Diamond&&$("#symbolType").val("Diamond"),symbolStyle==Ellipse&&$("#symbolType").val("Ellipse"),symbolStyle==XCross&&$("#symbolType").val("XCross")}else $("#symbolType").val("None");"None"==$("#symbolType").val()?$("#symbolContainer").hide():($("#symbolContainer").show(),$("#penColorSymbol").val(symbol.pen().color),$("#penWidthSymbol").val(symbol.pen().width),$("#fillBrushSymbol").val(symbol.brush().color),$("#sizeSymbol").val(symbol.size().width))}$("body").append($('                \x3c!-- Modal --\x3e                <div class="modal fade" id="curveSettingsModal" role="dialog">                <div class="modal-dialog">                                \x3c!-- Modal content--\x3e                <div class="modal-content">                <div class="modal-header">                \x3c!--button type="button" class="close" data-dismiss="modal">&times;</button--\x3e                <h4 class="modal-title">Curve attributes</h4>                </div>                <div class="modal-body">                                                <div class="row">                <div class="col-sm-3">Curve name:</div>                <div class="col-sm-5"><select id="curveSelect" style="width:100%"></select></div>                <div class="col-sm-2"><button id="remove">Remove</button></div>                <div class="col-sm-2"><button id="rename">Rename</button></div>                </div>                                <br>                <div class="row">                <div class="col-sm-3">Pen color:<input id="penColor" type="color"/></div>                <div class="col-sm-4">Pen width:<select id="penWidth" style="width:50%"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>                <div class="col-sm-5">Pen style:<select id="penStyle" style="width:60%"><option>solid</option><option>dot</option><option>dash</option><option>dashDot</option><option>dashDotDot</option></select></div>                </div>                                <br>                <div class="row">                <div class="col-sm-6">Horizontal axis:<select id="horizontalAxis" style="width:50%"><option value="2">Bottom</option><option value="3">Top</option></select></div>                <div class="col-sm-5">Vertical axis:<select id="verticalAxis" style="width:60%"><option value="0">Left</option><option value="1">Right</option></select></div>                </div>                                <br>                <div class="row">                <div class="col-sm-1"><button id="fit">Fit</button></div><div class="col-sm-3"><button id="legendAttribute">Legend attribute</button></div><div class="col-sm-3"><button id="curveStyle">Curve style</button></div><div class="col-sm-2"><button id="curveBrush"> Brush</button></div><div class="col-sm-3"><button id="clearBrush">No brush</button></div>\x3c!--div class="col-sm-2"><button id="curveAxis">Axis</button></div--\x3e                <div class="col-sm-3"><button id="fitInfo">Curve Fit Info...</button></div>                </div>                                <br>                <div class="row">                <div class="col-sm-2">Symbols</div>                <div class="col-sm-8"><select id="symbolType"><option value="None">None</option><option value="MRect">Rectangle</option><option value="Cross">Cross</option><option value="Diamond">Diamond</option><option value="Ellipse">Ellipse</option><option value="XCross">Diagonal cross</option></select></div>                </div>                                <br>                <div id="symbolContainer">                <div class="row">                <div class="col-sm-6">Symbol pen color:<input id="penColorSymbol" type="color"/></div>                <div class="col-sm-6">Symbol pen width:<select id="penWidthSymbol" style="width:50%"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>                </div>                <br>                <div class="row">                <div class="col-sm-6">Symbol fill brush:<input id="fillBrushSymbol" type="color"/></div>                <div class="col-sm-6">Symbol size:<select id="sizeSymbol" style="width:50%"><option value="5">5x5</option><option value="6">6x6</option><option value="8">8x8</option><option value="10">10x10</option><option value="12">12x12</option><option value="15">15x15</option></select></div>                </div>                </div>                                                </div>                <div class="modal-footer">                <button id="cancelAxisDlg" type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>                <button type="button" class="btn btn-default" data-dismiss="modal">Ok</button>                </div>                </div>                                </div>                </div>                ')),$("#curveSelect").change((function(){let curve;initDlg(_plot.findPlotCurve($("#curveSelect").val()))})),$("#remove").click((function(){let curve;if(_plot.findPlotCurve($("#curveSelect").val()).detach(),!_plot.hasPlotCurve())return void $("#cancelAxisDlg").click();let opts=$("#curveSelect").children();$("#curveSelect")[0].removeChild(opts[$("#curveSelect")[0].selectedIndex]),initDlg(_plot.findPlotCurve($("#curveSelect").val()))})),$("#rename").click((function(){return Utility.curveRenameDlg($("#curveSelect").val(),_plot,(function(){let ind=$("#curveSelect")[0].selectedIndex;return initCurveSelect(),$("#curveSelect")[0].selectedIndex=ind,!0})),!0})),$("#fit").click((function(){_curveFitCb(_plot.findPlotCurve($("#curveSelect").val()))})),$("#legendAttribute").click((function(){_curveAttributeCb(_plot.findPlotCurve($("#curveSelect").val()))})),$("#clearBrush").click((function(){Utility.removeCurveBrush(_plot.findPlotCurve($("#curveSelect").val())),initClearBrushButton(_plot.findPlotCurve($("#curveSelect").val()))})),$("#curveBrush").click((function(){Utility.setCurveBrush(_plot.findPlotCurve($("#curveSelect").val()),initClearBrushButton)})),$("#curveStyle").click((function(){_curveStyleCb(_plot.findPlotCurve($("#curveSelect").val()))})),$("#curveAxis").click((function(){_curveAxisCb(_plot.findPlotCurve($("#curveSelect").val()))})),$("#fitInfo").click((function(){let curve=_plot.findPlotCurve($("#curveSelect").val()),info=_curveFitInfoCb(curve);info.length?Static.alert(info):Static.alert('No curve fitting equation found for "'+curve.title()+'."')})),$("#penColor").change((function(){let curve=_plot.findPlotCurve($("#curveSelect").val()),pen=curve.pen();pen.color=$(this).val(),curve.setPen(pen)})),$("#penWidth").change((function(){let curve=_plot.findPlotCurve($("#curveSelect").val()),pen=curve.pen();pen.width=$(this).val(),curve.setPen(pen)})),$("#penStyle").change((function(){let curve=_plot.findPlotCurve($("#curveSelect").val()),pen=curve.pen();pen.style=$(this).val(),curve.setPen(pen)})),$("#horizontalAxis").change((function(){let curve=_plot.findPlotCurve($("#curveSelect").val());curve.setXAxis($(this).val()),Static.trigger("axisChanged",[$(this).val(),curve])})),$("#verticalAxis").change((function(){let curve=_plot.findPlotCurve($("#curveSelect").val());curve.setYAxis($(this).val()),Static.trigger("axisChanged",[$(this).val(),curve])})),$("#symbolType").change((function(){let curve=_plot.findPlotCurve($("#curveSelect").val());"None"==$("#symbolType").val()?($("#symbolContainer").hide(),$("#penWidthSymbol").val(1),$("#penColorSymbol").val(Static.colorNameToHex("black")),$("#fillBrushSymbol").val(Static.colorNameToHex("transparent")),$("#sizeSymbol").val(10)):$("#symbolContainer").show(),addSymbol(curve,$(this).val())})),$("#penColorSymbol").change((function(){let curve=_plot.findPlotCurve($("#curveSelect").val()),sym=curve.symbol();if(!sym)return;let pen=sym.pen();pen.color=$(this).val(),sym.setPen(pen),curve.plot().autoRefresh(),curve.plot().updateLegend(curve)})),$("#penWidthSymbol").change((function(){let curve;setSymbolPenWidth(_plot.findPlotCurve($("#curveSelect").val()),parseInt($(this).val()))})),$("#fillBrushSymbol").change((function(){let curve=_plot.findPlotCurve($("#curveSelect").val()),sym=curve.symbol();if(!sym)return;let pen=sym.brush();pen.color=$(this).val(),sym.setBrush(pen),curve.plot().autoRefresh(),curve.plot().updateLegend(curve)})),$("#sizeSymbol").change((function(){let curve;setSymbolSize(_plot.findPlotCurve($("#curveSelect").val()),parseInt($(this).val()))})),this.init=function(){_curveFitCb=_plot.curveFitDlg.curveFitCb,_curveFitInfoCb=_plot.curveFitDlg.curveFitInfoCb,_curveAttributeCb=_plot.curveAttributeDlg.curveAttributeCb,_curveStyleCb=_plot.curveStyleDlg.curveStyleCb,_curveAxisCb=_plot.axisDlg.axisCb},this.curveSettingsDlg=function(){_plot.itemList(Static.Rtti_PlotCurve).length?(initDlg(initCurveSelect()),$("#curveSettingsModal").modal({backdrop:"static"})):Static.alert("No curves found","small")},this.init()}}define("curveSettings",(function(){}));class MToolBar extends ToolBar{constructor(_plot,obj){super(obj);var self=this,watches,m_watchElements=new Watches(_plot).watchElements();function radioButtonCb(){var myRadio,checkedValue=$("input[name=optradio]").filter(":checked").val();"Zoom"==checkedValue&&(_plot.pan.setEnabled(!1),Utility.setAutoScale(_plot,!1),_plot.zm.setEnabled(!0),_plot.zm.setZoomBase(_plot.zm.scaleRect())),"Pan"==checkedValue&&(_plot.pan.setEnabled(!0),_plot.zm.setEnabled(!1),Utility.setAutoScale(_plot,!1)),"Auto"==checkedValue&&(_plot.pan.setEnabled(!1),_plot.zm.setEnabled(!1),Utility.setAutoScale(_plot,!0))}var fnListView=[function leftAxis(on){_plot.enableAxis(yLeft,on)},function bottomAxis(on){_plot.enableAxis(xBottom,on)},function rightAxis(on){_plot.enableAxis(yRight,on)},function topAxis(on){_plot.enableAxis(xTop,on)},function majorGridLines(on){Utility.majorGridLines(_plot.grid,on),self.enableDropdownItem("View",5,on)},function minorGridLines(on){Utility.minorGridLines(_plot.grid,on)},function titleFn(on){on?_plot.showTitle():_plot.hideTitle()},function footerFn(on){on?_plot.showFooter():_plot.hideFooter()},function legendFn(on){_plot.enableLegend(on)}],w;function pointEntryFn(){_plot.pointEntryDlg.pointEntryCb("Add/Romve Point",_plot)}function calculatorFn(){window.open("Calculator:///")}function definesFn(val){Static.defines(_plot)}function markerFn(val){_plot.markerDlg.markerCb(_plot)}function functionFn(){_plot._functionDlg.functionDlg(Utility.generateCurveName(_plot))}Static.bind("majorGridLines",(function(e,grid,on){self.setDropdownItemCheck("View",4,on),self.enableDropdownItem("View",5,on)})),Static.bind("minorGridLines",(function(e,grid,on){self.setDropdownItemCheck("View",5,on)}));var fnListFile=[_plot.file.save,functionFn,pointEntryFn,calculatorFn,definesFn,markerFn,Static.printFn];this.addToolButton("dropdown",{text:"File",cb:function(e,index){fnListFile[index]()},listElements:[{text:"Save",icon:"images/save.png",tooltip:"Save the current graph."},{text:"Function",icon:"images/function.png",tooltip:"Launches the function dialog."},{text:"Point entry",icon:"images/pointEntry.png",tooltip:"Launches the point entry dialog."},{text:"Calculator",icon:"images/calculator.png",tooltip:"Launches the calculator."},{text:"Defines",icon:"images/defines.png",tooltip:"Launches the defines dialog."},{text:"Marker",icon:"images/marker.png",tooltip:"Launches the marker dialog."},{text:"Print",icon:"images/print.png",tooltip:"Print the current graph."}]});var cProp=this.addToolButton("checkbox",{label:"C-Prop",cb:function(on){_plot.leftSidebar.showGridItem(0,on)},tooltip:"Show/Hide curve properties pane",disabled:!0}),pProp=this.addToolButton("checkbox",{label:"P-Prop",checked:!0,cb:function(on){_plot.leftSidebar.showGridItem(1,on)},tooltip:"Show/Hide plot properties pane"});Static.bind("showGridItem",(function(e,m_anchorPosition,gridIndex,on){"left"==m_anchorPosition&&(0==gridIndex?self.setButtonCheck(cProp,on):self.setButtonCheck(pProp,on))})),this.addToolButton("upload",{innerHtmlId:"fileInput",class:"btn btn-primary",tooltip:"Upload data files"}),this.addToolButton("radio",{label:"Zoom",tooltip:"Enable zooming. Press the mouse left button and drag.",cb:radioButtonCb}),this.addToolButton("radio",{label:"Pan",tooltip:"Allow dragging of all plot items to new positions. Press the mouse left button and drag.",cb:radioButtonCb}),this.addToolButton("radio",{label:"Auto",tooltip:"Determine and and apply the scale that\nallows the extent of all curves to be shown.",cb:radioButtonCb,checked:!0}),this.addToolButton("dropdown",{text:"View",hasCheckbox:!0,cb:function(e,index,checked){fnListView[index](checked)},listElements:[{text:"Left axis",icon:"images/axis.png",tooltip:"Enable left axis",checkboxState:"checked"},{text:"Bottom axis",icon:"images/axis.png",tooltip:"Enable bottom axis",checkboxState:"checked"},{text:"Right axis",icon:"images/axis.png",tooltip:"Enable right axis"},{text:"Top axis",icon:"images/axis.png",tooltip:"Enable top axis"},{text:"Major gridlines",icon:"images/major_grid.png",tooltip:"Enable major gridlines",checkboxState:"checked"},{text:"Minor gridlines",icon:"images/minor_grid.png",tooltip:"Enable minor gridlines",checkboxState:"checked"},{text:"Title",icon:"images/title.png",tooltip:"Enable title",checkboxState:"checked"},{text:"Footer",icon:"images/footer.png",tooltip:"Enable footor",checkboxState:"checked"},{text:"Legend",icon:"images/legend.png",tooltip:"Enable the legend (at least one curve should be present)",checkboxState:"checked"}]});var sBar=this.addToolButton("checkbox",{label:"S-Bar",cb:function(on){_plot.itemList(Static.Rtti_PlotCurve).length&&(_plot.rightSidebar.showGridItem(0,on),_plot.rv.updateWatchesAndTable()),on||_plot.sidebar.setSidebarReDisplay(!1)},tooltip:"Show/Hide sidbar",disabled:!0}),pSel=this.addToolButton("checkbox",{label:"P-Sel",cb:function(on){_plot.curveClosestPoint.setEnabled(on),Static.trigger("pSel",on)},tooltip:"Turn on point selection. This may affect response."});function defaultCb(data,status){console.log(status,data)}this.addToolButton("pushbutton",{text:"+",icon:"images/zoom_in.png",repeat:!0,tooltip:"Zoom in.",cb:function(e){var f=.98;_plot.magnifier.rescale(f)}}),this.addToolButton("pushbutton",{text:"-",icon:"images/zoom_out.png",repeat:!0,tooltip:"Zoom out",cb:function(e){var f=1/.98;_plot.magnifier.rescale(f)}}),this.addToolButton("dropdown",{text:"Watch",tooltip:"Enable/disable watches.",hasCheckbox:!0,cb:function(e,index,checked){_plot.rv.watch(index).setEnable(checked),_plot.rv.updateWatchesAndTable(),Static.trigger("curveAdjusted")},listElements:m_watchElements}),this.addToolButton("pushbutton",{text:"Mongo-Filesystem",class:"mongo-fs-login-logout-register btn btn-primary",cb:function(){}}),this.addToolButton("link",{text:"Help",cb:function(){},href:"grapherHelp/Grapher.html",target:"_blank",class:"noSelect",tooltip:"Launches online help."}),Static.bind("showGridItem",(function(e,m_anchorPosition,gridIndex,on){"right"==m_anchorPosition&&(on||(self.setButtonCheck(sBar,!1),_plot.sidebar&&_plot.sidebar.setSidebarReDisplay(!1)))})),Static.bind("visibilityChange",(function(e,plotItem,on){plotItem.rtti==Static.Rtti_PlotCurve&&(_plot.sidebar&&_plot.sidebar.initSidebar(),_plot.hasVisiblePlotCurve()?(self.enable(sBar),_plot.sidebar&&_plot.sidebar.sidebarReDisplay()&&(_plot.rightSidebar.showSidebar(!0),_plot.sidebar.setSidebarReDisplay(!1))):(self.disable(sBar),_plot.tbar.hideDropdownItem("View",10),_plot.rightSidebar&&_plot.rightSidebar.isSideBarVisible()&&(Static.alert("Ooops!! No visible curves to watch."),_plot.rightSidebar.showSidebar(!1),_plot.sidebar.setSidebarReDisplay(!0))))})),Static.bind("itemChanged",(function(e,plotItem,on){plotItem.rtti==Static.Rtti_PlotGrid&&(on?_plot.tbar.showDropdownItem("View",6):_plot.tbar.hideDropdownItem("View",6))})),Static.bind("rescaled",(function(e,auto){auto||self.setButtonCheck("Auto",!1)})),""==_plot.title()&&self.hideDropdownItem("View",7),Static.bind("titleAdded",(function(e,param){param?self.showDropdownItem("View",7):self.hideDropdownItem("View",7)})),""==_plot.footer()&&self.hideDropdownItem("View",8),Static.bind("footerAdded",(function(e,param){param?self.showDropdownItem("View",8):self.hideDropdownItem("View",8)})),Static.bind("itemAttached",(function(e,plotItem,on){plotItem.rtti!=Static.Rtti_PlotCurve&&plotItem.rtti!=Static.Rtti_PlotSpectroCurve&&plotItem.rtti!=Static.Rtti_PlotSpectrogram||(on?(plotItem.rtti==Static.Rtti_PlotCurve&&self.enable(sBar),self.enable(cProp)):(0==_plot.itemList(Static.Rtti_PlotCurve).length&&0==_plot.itemList(Static.Rtti_PlotSpectroCurve).length&&0==_plot.itemList(Static.Rtti_PlotSpectrogram).length&&self.disable(cProp),_plot.itemList(Static.Rtti_PlotCurve).length&&_plot.hasVisiblePlotCurve()||(self.disable(sBar),self.setButtonCheck(sBar,!1))),Static.trigger("visibilityChange",[plotItem,on]))})),Static.bind("showSidebar",(function(e,anchorPosition,on){"right"===anchorPosition&&(self.setButtonCheck(sBar,on),on&&_plot.tbar.isDropdownItemChecked("Watch",6)?_plot.cs.setEnabled(!0):_plot.cs.setEnabled(!1))})),_plot.sidebar}}define("mtoolBar",["toolBar","curveSettings"],(function(){}));
/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */
var DO_NOT_EXPORT_CODEPAGE=!0,DO_NOT_EXPORT_JSZIP=!0;!function(e){if("object"==typeof exports&&"undefined"!=typeof module&&void 0===DO_NOT_EXPORT_JSZIP)module.exports=e();else if("function"==typeof define&&define.amd&&void 0===DO_NOT_EXPORT_JSZIP)JSZipSync=e(),define("xlsx",[],e);else{var r;"undefined"!=typeof window?r=window:"undefined"!=typeof global?r=global:"undefined"!=typeof $&&$.global?r=$.global:"undefined"!=typeof self&&(r=self),r.JSZipSync=e()}}((function(){var e,r,t;return function a(e,r,t){function n(s,f){if(!r[s]){if(!e[s]){var l="function"==typeof require&&require;if(!f&&l)return l(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var o=r[s]={exports:{}};e[s][0].call(o.exports,(function(r){var t=e[s][1][r];return n(t||r)}),o,o.exports,a,e,r,t)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<t.length;s++)n(t[s]);return n}({1:[function(e,r,t){"use strict";var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(e,r){for(var t="",n,i,s,f,l,o,c,u=0;u<e.length;)f=(n=e.charCodeAt(u++))>>2,l=(3&n)<<4|(i=e.charCodeAt(u++))>>4,o=(15&i)<<2|(s=e.charCodeAt(u++))>>6,c=63&s,isNaN(i)?o=c=64:isNaN(s)&&(c=64),t=t+a.charAt(f)+a.charAt(l)+a.charAt(o)+a.charAt(c);return t},t.decode=function(e,r){var t="",n,i,s,f,l,o,c,u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)n=(f=a.indexOf(e.charAt(u++)))<<2|(l=a.indexOf(e.charAt(u++)))>>4,i=(15&l)<<4|(o=a.indexOf(e.charAt(u++)))>>2,s=(3&o)<<6|(c=a.indexOf(e.charAt(u++))),t+=String.fromCharCode(n),64!=o&&(t+=String.fromCharCode(i)),64!=c&&(t+=String.fromCharCode(s));return t}},{}],2:[function(e,r,t){"use strict";function a(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}a.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},r.exports=a},{}],3:[function(e,r,t){"use strict";t.STORE={magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null},t.DEFLATE=e("./flate")},{"./flate":8}],4:[function(e,r,t){"use strict";var a=e("./utils"),n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];r.exports=function i(e,r){if(void 0===e||!e.length)return 0;var t="string"!==a.getTypeOf(e);void 0===r&&(r=0);var i=0,s=0,f=0;r^=-1;for(var l=0,o=e.length;l<o;l++)f=t?e[l]:e.charCodeAt(l),i=n[s=255&(r^f)],r=r>>>8^i;return-1^r}},{"./utils":21}],5:[function(e,r,t){"use strict";var a=e("./utils");function n(e){this.data=null,this.length=0,this.index=0}n.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var r=0,t;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return a.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1)}},r.exports=n},{"./utils":21}],6:[function(e,r,t){"use strict";t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!1,t.date=null,t.compression=null,t.comment=null},{}],7:[function(e,r,t){"use strict";var a=e("./utils");t.string2binary=function(e){return a.string2binary(e)},t.string2Uint8Array=function(e){return a.transformTo("uint8array",e)},t.uint8Array2String=function(e){return a.transformTo("string",e)},t.string2Blob=function(e){var r=a.transformTo("arraybuffer",e);return a.arrayBuffer2Blob(r)},t.arrayBuffer2Blob=function(e){return a.arrayBuffer2Blob(e)},t.transformTo=function(e,r){return a.transformTo(e,r)},t.getTypeOf=function(e){return a.getTypeOf(e)},t.checkSupport=function(e){return a.checkSupport(e)},t.MAX_VALUE_16BITS=a.MAX_VALUE_16BITS,t.MAX_VALUE_32BITS=a.MAX_VALUE_32BITS,t.pretty=function(e){return a.pretty(e)},t.findCompression=function(e){return a.findCompression(e)},t.isRegExp=function(e){return a.isRegExp(e)}},{"./utils":21}],8:[function(e,r,t){"use strict";var a="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=e("pako");t.uncompressInputType=a?"uint8array":"array",t.compressInputType=a?"uint8array":"array",t.magic="\b\0",t.compress=function(e){return n.deflateRaw(e)},t.uncompress=function(e){return n.inflateRaw(e)}},{pako:24}],9:[function(e,r,t){"use strict";var a=e("./base64");function n(e,r){if(!(this instanceof n))return new n(e,r);this.files={},this.comment=null,this.root="",e&&this.load(e,r),this.clone=function(){var e=new n;for(var r in this)"function"!=typeof this[r]&&(e[r]=this[r]);return e}}n.prototype=e("./object"),n.prototype.load=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.utils=e("./deprecatedPublicUtils"),n.base64={encode:function(e){return a.encode(e)},decode:function(e){return a.decode(e)}},n.compressions=e("./compressions"),r.exports=n},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(e,r,t){"use strict";var a=e("./base64"),n=e("./zipEntries");r.exports=function(e,r){var t,i,s,f;for((r=r||{}).base64&&(e=a.decode(e)),t=(i=new n(e,r)).files,s=0;s<t.length;s++)f=t[s],this.file(f.fileName,f.decompressed,{binary:!0,optimizedBinaryString:!0,date:f.date,dir:f.dir,comment:f.fileComment.length?f.fileComment:null,createFolders:r.createFolders});return i.zipComment.length&&(this.comment=i.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(e,r,t){(function(e){"use strict";var t=function(){};if(void 0!==e){var a=!e.from;if(!a)try{e.from("foo","utf8")}catch(n){a=!0}t=a?function(r,t){return t?new e(r,t):new e(r)}:e.from.bind(e),e.alloc||(e.alloc=function(r){return new e(r)})}r.exports=function(r,a){return"number"==typeof r?e.alloc(r):t(r,a)},r.exports.test=function(r){return e.isBuffer(r)}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],12:[function(e,r,t){"use strict";var a=e("./uint8ArrayReader");function n(e){this.data=e,this.length=this.data.length,this.index=0}n.prototype=new a,n.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.index,this.index+e);return this.index+=e,r},r.exports=n},{"./uint8ArrayReader":18}],13:[function(e,r,t){"use strict";var a=e("./support"),n=e("./utils"),i=e("./crc32"),s=e("./signature"),f=e("./defaults"),l=e("./base64"),o=e("./compressions"),c=e("./compressedObject"),u=e("./nodeBuffer"),h=e("./utf8"),d=e("./stringWriter"),v=e("./uint8ArrayWriter"),p=function(e){if(e._data instanceof c&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,"uint8array"===n.getTypeOf(e._data))){var r=e._data;e._data=new Uint8Array(r.length),0!==r.length&&e._data.set(r,0)}return e._data},m=function(e){var r=p(e),t;return"string"===n.getTypeOf(r)?!e.options.binary&&a.nodebuffer?u(r,"utf-8"):e.asBinary():r},b=function(e){var r=p(this);return null==r?"":(this.options.base64&&(r=l.decode(r)),r=e&&this.options.binary?y.utf8decode(r):n.transformTo("string",r),e||this.options.binary||(r=n.transformTo("string",y.utf8encode(r))),r)},g=function(e,r,t){this.name=e,this.dir=t.dir,this.date=t.date,this.comment=t.comment,this._data=r,this.options=t,this._initialMetadata={dir:t.dir,date:t.date}};g.prototype={asText:function(){return b.call(this,!0)},asBinary:function(){return b.call(this,!1)},asNodeBuffer:function(){var e=m(this);return n.transformTo("nodebuffer",e)},asUint8Array:function(){var e=m(this);return n.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var w=function(e,r){var t="",a;for(a=0;a<r;a++)t+=String.fromCharCode(255&e),e>>>=8;return t},k=function(){var e={},r,t;for(r=0;r<arguments.length;r++)for(t in arguments[r])arguments[r].hasOwnProperty(t)&&void 0===e[t]&&(e[t]=arguments[r][t]);return e},E=function(e){return!0!==(e=e||{}).base64||null!==e.binary&&void 0!==e.binary||(e.binary=!0),(e=k(e,f)).date=e.date||new Date,null!==e.compression&&(e.compression=e.compression.toUpperCase()),e},S=function(e,r,t){var a=n.getTypeOf(r),i;if((t=E(t)).createFolders&&(i=_(e))&&C.call(this,i,!0),t.dir||null==r)t.base64=!1,t.binary=!1,r=null;else if("string"===a)t.binary&&!t.base64&&!0!==t.optimizedBinaryString&&(r=n.string2binary(r));else{if(t.base64=!1,t.binary=!0,!(a||r instanceof c))throw new Error("The data of '"+e+"' is in an unsupported format !");"arraybuffer"===a&&(r=n.transformTo("uint8array",r))}var s=new g(e,r,t);return this.files[e]=s,s},_=function(e){"/"==e.slice(-1)&&(e=e.substring(0,e.length-1));var r=e.lastIndexOf("/");return r>0?e.substring(0,r):""},C=function(e,r){return"/"!=e.slice(-1)&&(e+="/"),r=void 0!==r&&r,this.files[e]||S.call(this,e,null,{dir:!0,createFolders:r}),this.files[e]},B=function(e,r){var t=new c,a;return e._data instanceof c?(t.uncompressedSize=e._data.uncompressedSize,t.crc32=e._data.crc32,0===t.uncompressedSize||e.dir?(r=o.STORE,t.compressedContent="",t.crc32=0):e._data.compressionMethod===r.magic?t.compressedContent=e._data.getCompressedContent():(a=e._data.getContent(),t.compressedContent=r.compress(n.transformTo(r.compressInputType,a)))):((a=m(e))&&0!==a.length&&!e.dir||(r=o.STORE,a=""),t.uncompressedSize=a.length,t.crc32=i(a),t.compressedContent=r.compress(n.transformTo(r.compressInputType,a))),t.compressedSize=t.compressedContent.length,t.compressionMethod=r.magic,t},T=function(e,r,t,a){var f=t.compressedContent,l=n.transformTo("string",h.utf8encode(r.name)),o=r.comment||"",c=n.transformTo("string",h.utf8encode(o)),u=l.length!==r.name.length,d=c.length!==o.length,v=r.options,p,m,b="",g="",k="",E,S;E=r._initialMetadata.dir!==r.dir?r.dir:v.dir,p=(S=r._initialMetadata.date!==r.date?r.date:v.date).getHours(),p<<=6,p|=S.getMinutes(),p<<=5,p|=S.getSeconds()/2,m=S.getFullYear()-1980,m<<=4,m|=S.getMonth()+1,m<<=5,m|=S.getDate(),u&&(g=w(1,1)+w(i(l),4)+l,b+="up"+w(g.length,2)+g),d&&(k=w(1,1)+w(this.crc32(c),4)+c,b+="uc"+w(k.length,2)+k);var _="",C,B;return _+="\n\0",_+=u||d?"\0\b":"\0\0",_+=t.compressionMethod,_+=w(p,2),_+=w(m,2),_+=w(t.crc32,4),_+=w(t.compressedSize,4),_+=w(t.uncompressedSize,4),_+=w(l.length,2),_+=w(b.length,2),{fileRecord:s.LOCAL_FILE_HEADER+_+l+b,dirRecord:s.CENTRAL_FILE_HEADER+"\0"+_+w(c.length,2)+"\0\0\0\0"+(!0===E?"\0\0\0":"\0\0\0\0")+w(a,4)+l+b+c,compressedObject:t}},y={load:function(e,r){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var r=[],t,a,n,i;for(t in this.files)this.files.hasOwnProperty(t)&&(n=this.files[t],i=new g(n.name,n._data,k(n.options)),a=t.slice(this.root.length,t.length),t.slice(0,this.root.length)===this.root&&e(a,i)&&r.push(i));return r},file:function(e,r,t){if(1===arguments.length){if(n.isRegExp(e)){var a=e;return this.filter((function(e,r){return!r.dir&&a.test(e)}))}return this.filter((function(r,t){return!t.dir&&r===e}))[0]||null}return e=this.root+e,S.call(this,e,r,t),this},folder:function(e){if(!e)return this;if(n.isRegExp(e))return this.filter((function(r,t){return t.dir&&e.test(r)}));var r=this.root+e,t=C.call(this,r),a=this.clone();return a.root=t.name,a},remove:function(e){e=this.root+e;var r=this.files[e];if(r||("/"!=e.slice(-1)&&(e+="/"),r=this.files[e]),r&&!r.dir)delete this.files[e];else for(var t=this.filter((function(r,t){return t.name.slice(0,e.length)===e})),a=0;a<t.length;a++)delete this.files[t[a].name];return this},generate:function(e){e=k(e||{},{base64:!0,compression:"STORE",type:"base64",comment:null}),n.checkSupport(e.type);var r=[],t=0,a=0,i,f,c=n.transformTo("string",this.utf8encode(e.comment||this.comment||""));for(var u in this.files)if(this.files.hasOwnProperty(u)){var h=this.files[u],p=h.options.compression||e.compression.toUpperCase(),m=o[p];if(!m)throw new Error(p+" is not a valid compression method !");var b=B.call(this,h,m),g=T.call(this,u,h,b,t);t+=g.fileRecord.length+b.compressedSize,a+=g.dirRecord.length,r.push(g)}var E="";E=s.CENTRAL_DIRECTORY_END+"\0\0\0\0"+w(r.length,2)+w(r.length,2)+w(a,4)+w(t,4)+w(c.length,2)+c;var S=e.type.toLowerCase();for(i="uint8array"===S||"arraybuffer"===S||"blob"===S||"nodebuffer"===S?new v(t+a+E.length):new d(t+a+E.length),f=0;f<r.length;f++)i.append(r[f].fileRecord),i.append(r[f].compressedObject.compressedContent);for(f=0;f<r.length;f++)i.append(r[f].dirRecord);i.append(E);var _=i.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return n.transformTo(e.type.toLowerCase(),_);case"blob":return n.arrayBuffer2Blob(n.transformTo("arraybuffer",_));case"base64":return e.base64?l.encode(_):_;default:return _}},crc32:function(e,r){return i(e,r)},utf8encode:function(e){return n.transformTo("string",h.utf8encode(e))},utf8decode:function(e){return h.utf8decode(e)}};r.exports=y},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(e,r,t){"use strict";t.LOCAL_FILE_HEADER="PK",t.CENTRAL_FILE_HEADER="PK",t.CENTRAL_DIRECTORY_END="PK",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",t.ZIP64_CENTRAL_DIRECTORY_END="PK",t.DATA_DESCRIPTOR="PK\b"},{}],15:[function(e,r,t){"use strict";var a=e("./dataReader"),n=e("./utils");function i(e,r){this.data=e,r||(this.data=n.string2binary(this.data)),this.length=this.data.length,this.index=0}i.prototype=new a,i.prototype.byteAt=function(e){return this.data.charCodeAt(e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)},i.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.index,this.index+e);return this.index+=e,r},r.exports=i},{"./dataReader":5,"./utils":21}],16:[function(e,r,t){"use strict";var a=e("./utils"),n=function(){this.data=[]};n.prototype={append:function(e){e=a.transformTo("string",e),this.data.push(e)},finalize:function(){return this.data.join("")}},r.exports=n},{"./utils":21}],17:[function(e,r,t){(function(e){"use strict";if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,t.nodebuffer=void 0!==e,t.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)t.blob=!1;else{var r=new ArrayBuffer(0);try{t.blob=0===new Blob([r],{type:"application/zip"}).size}catch(a){try{var n,i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);i.append(r),t.blob=0===i.getBlob("application/zip").size}catch(a){t.blob=!1}}}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],18:[function(e,r,t){"use strict";var a=e("./dataReader");function n(e){e&&(this.data=e,this.length=this.data.length,this.index=0)}n.prototype=new a,n.prototype.byteAt=function(e){return this.data[e]},n.prototype.lastIndexOfSignature=function(e){for(var r=e.charCodeAt(0),t=e.charCodeAt(1),a=e.charCodeAt(2),n=e.charCodeAt(3),i=this.length-4;i>=0;--i)if(this.data[i]===r&&this.data[i+1]===t&&this.data[i+2]===a&&this.data[i+3]===n)return i;return-1},n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var r=this.data.subarray(this.index,this.index+e);return this.index+=e,r},r.exports=n},{"./dataReader":5}],19:[function(e,r,t){"use strict";var a=e("./utils"),n=function(e){this.data=new Uint8Array(e),this.index=0};n.prototype={append:function(e){0!==e.length&&(e=a.transformTo("uint8array",e),this.data.set(e,this.index),this.index+=e.length)},finalize:function(){return this.data}},r.exports=n},{"./utils":21}],20:[function(e,r,t){"use strict";for(var a=e("./utils"),n=e("./support"),i=e("./nodeBuffer"),s=new Array(256),f=0;f<256;f++)s[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;s[254]=s[254]=1;var l=function(e){var r,t,a,i,s,f=e.length,l=0;for(i=0;i<f;i++)55296==(64512&(t=e.charCodeAt(i)))&&i+1<f&&56320==(64512&(a=e.charCodeAt(i+1)))&&(t=65536+(t-55296<<10)+(a-56320),i++),l+=t<128?1:t<2048?2:t<65536?3:4;for(r=n.uint8array?new Uint8Array(l):new Array(l),s=0,i=0;s<l;i++)55296==(64512&(t=e.charCodeAt(i)))&&i+1<f&&56320==(64512&(a=e.charCodeAt(i+1)))&&(t=65536+(t-55296<<10)+(a-56320),i++),t<128?r[s++]=t:t<2048?(r[s++]=192|t>>>6,r[s++]=128|63&t):t<65536?(r[s++]=224|t>>>12,r[s++]=128|t>>>6&63,r[s++]=128|63&t):(r[s++]=240|t>>>18,r[s++]=128|t>>>12&63,r[s++]=128|t>>>6&63,r[s++]=128|63&t);return r},o=function(e,r){var t;for((r=r||e.length)>e.length&&(r=e.length),t=r-1;t>=0&&128==(192&e[t]);)t--;return t<0?r:0===t?r:t+s[e[t]]>r?t:r},c=function(e){var r,t,n,i,f,l=e.length,o=new Array(2*l);for(n=0,t=0;t<l;)if((i=e[t++])<128)o[n++]=i;else if((f=s[i])>4)o[n++]=65533,t+=f-1;else{for(i&=2===f?31:3===f?15:7;f>1&&t<l;)i=i<<6|63&e[t++],f--;f>1?o[n++]=65533:i<65536?o[n++]=i:(i-=65536,o[n++]=55296|i>>10&1023,o[n++]=56320|1023&i)}return o.length!==n&&(o.subarray?o=o.subarray(0,n):o.length=n),a.applyFromCharCode(o)};t.utf8encode=function u(e){return n.nodebuffer?i(e,"utf-8"):l(e)},t.utf8decode=function h(e){if(n.nodebuffer)return a.transformTo("nodebuffer",e).toString("utf-8");for(var r=[],t=0,i=(e=a.transformTo(n.uint8array?"uint8array":"array",e)).length,s=65536;t<i;){var f=o(e,Math.min(t+s,i));n.uint8array?r.push(c(e.subarray(t,f))):r.push(c(e.slice(t,f))),t=f}return r.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(e,r,t){"use strict";var a=e("./support"),n=e("./compressions"),i=e("./nodeBuffer");function s(e){return e}function f(e,r){for(var t=0;t<e.length;++t)r[t]=255&e.charCodeAt(t);return r}function l(e){var r=65536,a=[],n=e.length,s=t.getTypeOf(e),f=0,l=!0;try{switch(s){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,i(0))}}catch(o){l=!1}if(!l){for(var c="",u=0;u<e.length;u++)c+=String.fromCharCode(e[u]);return c}for(;f<n&&r>1;)try{"array"===s||"nodebuffer"===s?a.push(String.fromCharCode.apply(null,e.slice(f,Math.min(f+r,n)))):a.push(String.fromCharCode.apply(null,e.subarray(f,Math.min(f+r,n)))),f+=r}catch(o){r=Math.floor(r/2)}return a.join("")}function o(e,r){for(var t=0;t<e.length;t++)r[t]=e[t];return r}t.string2binary=function(e){for(var r="",t=0;t<e.length;t++)r+=String.fromCharCode(255&e.charCodeAt(t));return r},t.arrayBuffer2Blob=function(e){t.checkSupport("blob");try{return new Blob([e],{type:"application/zip"})}catch(r){try{var a,n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return n.append(e),n.getBlob("application/zip")}catch(r){throw new Error("Bug : can't construct the Blob.")}}},t.applyFromCharCode=l;var c={};c.string={string:s,array:function(e){return f(e,new Array(e.length))},arraybuffer:function(e){return c.string.uint8array(e).buffer},uint8array:function(e){return f(e,new Uint8Array(e.length))},nodebuffer:function(e){return f(e,i(e.length))}},c.array={string:l,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i(e)}},c.arraybuffer={string:function(e){return l(new Uint8Array(e))},array:function(e){return o(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i(new Uint8Array(e))}},c.uint8array={string:l,array:function(e){return o(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return i(e)}},c.nodebuffer={string:l,array:function(e){return o(e,new Array(e.length))},arraybuffer:function(e){return c.nodebuffer.uint8array(e).buffer},uint8array:function(e){return o(e,new Uint8Array(e.length))},nodebuffer:s},t.transformTo=function(e,r){if(r||(r=""),!e)return r;t.checkSupport(e);var a=t.getTypeOf(r),n;return c[a][e](r)},t.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":a.nodebuffer&&i.test(e)?"nodebuffer":a.uint8array&&e instanceof Uint8Array?"uint8array":a.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},t.checkSupport=function(e){var r;if(!a[e.toLowerCase()])throw new Error(e+" is not supported by this browser")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(e){var r="",t,a;for(a=0;a<(e||"").length;a++)r+="\\x"+((t=e.charCodeAt(a))<16?"0":"")+t.toString(16).toUpperCase();return r},t.findCompression=function(e){for(var r in n)if(n.hasOwnProperty(r)&&n[r].magic===e)return n[r];return null},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(e,r,t){"use strict";var a=e("./stringReader"),n=e("./nodeBufferReader"),i=e("./uint8ArrayReader"),s=e("./utils"),f=e("./signature"),l=e("./zipEntry"),o=e("./support"),c=e("./object");function u(e,r){this.files=[],this.loadOptions=r,e&&this.load(e)}u.prototype={checkSignature:function(e){var r=this.reader.readString(4);if(r!==e)throw new Error("Corrupted zip or bug : unexpected signature ("+s.pretty(r)+", expected "+s.pretty(e)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=c.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e=this.zip64EndOfCentralSize-44,r=0,t,a,n;0<e;)t=this.reader.readInt(2),a=this.reader.readInt(4),n=this.reader.readString(a),this.zip64ExtensibleData[t]={id:t,length:a,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,r;for(e=0;e<this.files.length;e++)r=this.files[e],this.reader.setIndex(r.localHeaderOffset),this.checkSignature(f.LOCAL_FILE_HEADER),r.readLocalPart(this.reader),r.handleUTF8()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===f.CENTRAL_FILE_HEADER;)(e=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(f.CENTRAL_DIRECTORY_END);if(-1===e)throw new Error("Corrupted zip : can't find end of central directory");if(this.reader.setIndex(e),this.checkSignature(f.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,-1===(e=this.reader.lastIndexOfSignature(f.ZIP64_CENTRAL_DIRECTORY_LOCATOR)))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(e),this.checkSignature(f.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(f.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(e){var r=s.getTypeOf(e);"string"!==r||o.uint8array?this.reader="nodebuffer"===r?new n(e):new i(s.transformTo("uint8array",e)):this.reader=new a(e,this.loadOptions.optimizedBinaryString)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(e,r,t){"use strict";var a=e("./stringReader"),n=e("./utils"),i=e("./compressedObject"),s=e("./object");function f(e,r){this.options=e,this.loadOptions=r}f.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},prepareCompressedContent:function(e,r,t){return function(){var a=e.index;e.setIndex(r);var n=e.readData(t);return e.setIndex(a),n}},prepareContent:function(e,r,t,a,i){return function(){var e=n.transformTo(a.uncompressInputType,this.getCompressedContent()),r=a.uncompress(e);if(r.length!==i)throw new Error("Bug : uncompressed data size mismatch");return r}},readLocalPart:function(e){var r,t;if(e.skip(22),this.fileNameLength=e.readInt(2),t=e.readInt(2),this.fileName=e.readString(this.fileNameLength),e.skip(t),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(null===(r=n.findCompression(this.compressionMethod)))throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new i,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,r),this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,r,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=n.transformTo("string",this.decompressed.getContent()),s.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(e){if(this.versionMadeBy=e.readString(2),this.versionNeeded=e.readInt(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4),this.fileNameLength=e.readInt(2),this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=e.readString(this.fileNameLength),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readString(this.fileCommentLength),this.dir=!!(16&this.externalFileAttributes)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var r=new a(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=r.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=r.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=r.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=r.readInt(4))}},readExtraFields:function(e){var r=e.index,t,a,n;for(this.extraFields=this.extraFields||{};e.index<r+this.extraFieldsLength;)t=e.readInt(2),a=e.readInt(2),n=e.readString(a),this.extraFields[t]={id:t,length:a,value:n}},handleUTF8:function(){if(this.useUTF8())this.fileName=s.utf8decode(this.fileName),this.fileComment=s.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();null!==e&&(this.fileName=e);var r=this.findExtraFieldUnicodeComment();null!==r&&(this.fileComment=r)}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var r=new a(e.value);return 1!==r.readInt(1)?null:s.crc32(this.fileName)!==r.readInt(4)?null:s.utf8decode(r.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var r=new a(e.value);return 1!==r.readInt(1)?null:s.crc32(this.fileComment)!==r.readInt(4)?null:s.utf8decode(r.readString(e.length-5))}return null}},r.exports=f},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(e,r,t){"use strict";var a,n,i,s,f={};(0,e("./lib/utils/common").assign)(f,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),r.exports=f},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(e,r,t){"use strict";var a=e("./zlib/deflate.js"),n=e("./utils/common"),i=e("./utils/strings"),s=e("./zlib/messages"),f=e("./zlib/zstream"),l=0,o=4,c=0,u=1,h=-1,d=0,v=8,p=function(e){this.options=n.assign({level:h,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var t=a.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(0!==t)throw new Error(s[t]);r.header&&a.deflateSetHeader(this.strm,r.header)};function m(e,r){var t=new p(r);if(t.push(e,!0),t.err)throw t.msg;return t.result}function b(e,r){return(r=r||{}).raw=!0,m(e,r)}function g(e,r){return(r=r||{}).gzip=!0,m(e,r)}p.prototype.push=function(e,r){var t=this.strm,s=this.options.chunkSize,f,h;if(this.ended)return!1;h=r===~~r?r:!0===r?4:0,t.input="string"==typeof e?i.string2buf(e):e,t.next_in=0,t.avail_in=t.input.length;do{if(0===t.avail_out&&(t.output=new n.Buf8(s),t.next_out=0,t.avail_out=s),1!==(f=a.deflate(t,h))&&0!==f)return this.onEnd(f),this.ended=!0,!1;(0===t.avail_out||0===t.avail_in&&4===h)&&("string"===this.options.to?this.onData(i.buf2binstring(n.shrinkBuf(t.output,t.next_out))):this.onData(n.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||0===t.avail_out)&&1!==f);return 4!==h||(f=a.deflateEnd(this.strm),this.onEnd(f),this.ended=!0,0===f)},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=p,t.deflate=m,t.deflateRaw=b,t.gzip=g},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(e,r,t){"use strict";var a=e("./zlib/inflate.js"),n=e("./utils/common"),i=e("./utils/strings"),s=e("./zlib/constants"),f=e("./zlib/messages"),l=e("./zlib/zstream"),o=e("./zlib/gzheader"),c=function(e){this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,0===r.windowBits&&(r.windowBits=-15)),!(r.windowBits>=0&&r.windowBits<16)||e&&e.windowBits||(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&0==(15&r.windowBits)&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var t=a.inflateInit2(this.strm,r.windowBits);if(t!==s.Z_OK)throw new Error(f[t]);this.header=new o,a.inflateGetHeader(this.strm,this.header)};function u(e,r){var t=new c(r);if(t.push(e,!0),t.err)throw t.msg;return t.result}function h(e,r){return(r=r||{}).raw=!0,u(e,r)}c.prototype.push=function(e,r){var t=this.strm,f=this.options.chunkSize,l,o,c,u,h;if(this.ended)return!1;o=r===~~r?r:!0===r?s.Z_FINISH:s.Z_NO_FLUSH,t.input="string"==typeof e?i.binstring2buf(e):e,t.next_in=0,t.avail_in=t.input.length;do{if(0===t.avail_out&&(t.output=new n.Buf8(f),t.next_out=0,t.avail_out=f),(l=a.inflate(t,s.Z_NO_FLUSH))!==s.Z_STREAM_END&&l!==s.Z_OK)return this.onEnd(l),this.ended=!0,!1;t.next_out&&(0===t.avail_out||l===s.Z_STREAM_END||0===t.avail_in&&o===s.Z_FINISH)&&("string"===this.options.to?(c=i.utf8border(t.output,t.next_out),u=t.next_out-c,h=i.buf2string(t.output,c),t.next_out=u,t.avail_out=f-u,u&&n.arraySet(t.output,t.output,c,u,0),this.onData(h)):this.onData(n.shrinkBuf(t.output,t.next_out)))}while(t.avail_in>0&&l!==s.Z_STREAM_END);return l===s.Z_STREAM_END&&(o=s.Z_FINISH),o!==s.Z_FINISH||(l=a.inflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===s.Z_OK)},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=c,t.inflate=u,t.inflateRaw=h,t.ungzip=u},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(e,r,t){"use strict";var a="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(e){for(var r=Array.prototype.slice.call(arguments,1);r.length;){var t=r.shift();if(t){if("object"!=typeof t)throw new TypeError(t+"must be non-object");for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])}}return e},t.shrinkBuf=function(e,r){return e.length===r?e:e.subarray?e.subarray(0,r):(e.length=r,e)};var n={arraySet:function(e,r,t,a,n){if(r.subarray&&e.subarray)e.set(r.subarray(t,t+a),n);else for(var i=0;i<a;i++)e[n+i]=r[t+i]},flattenChunks:function(e){var r,t,a,n,i,s;for(a=0,r=0,t=e.length;r<t;r++)a+=e[r].length;for(s=new Uint8Array(a),n=0,r=0,t=e.length;r<t;r++)i=e[r],s.set(i,n),n+=i.length;return s}},i={arraySet:function(e,r,t,a,n){for(var i=0;i<a;i++)e[n+i]=r[t+i]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,n)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,i))},t.setTyped(a)},{}],28:[function(e,r,t){"use strict";var a=e("./common"),n=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch(s){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(s){i=!1}for(var f=new a.Buf8(256),l=0;l<256;l++)f[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;function o(e,r){if(r<65537&&(e.subarray&&i||!e.subarray&&n))return String.fromCharCode.apply(null,a.shrinkBuf(e,r));for(var t="",s=0;s<r;s++)t+=String.fromCharCode(e[s]);return t}f[254]=f[254]=1,t.string2buf=function(e){var r,t,n,i,s,f=e.length,l=0;for(i=0;i<f;i++)55296==(64512&(t=e.charCodeAt(i)))&&i+1<f&&56320==(64512&(n=e.charCodeAt(i+1)))&&(t=65536+(t-55296<<10)+(n-56320),i++),l+=t<128?1:t<2048?2:t<65536?3:4;for(r=new a.Buf8(l),s=0,i=0;s<l;i++)55296==(64512&(t=e.charCodeAt(i)))&&i+1<f&&56320==(64512&(n=e.charCodeAt(i+1)))&&(t=65536+(t-55296<<10)+(n-56320),i++),t<128?r[s++]=t:t<2048?(r[s++]=192|t>>>6,r[s++]=128|63&t):t<65536?(r[s++]=224|t>>>12,r[s++]=128|t>>>6&63,r[s++]=128|63&t):(r[s++]=240|t>>>18,r[s++]=128|t>>>12&63,r[s++]=128|t>>>6&63,r[s++]=128|63&t);return r},t.buf2binstring=function(e){return o(e,e.length)},t.binstring2buf=function(e){for(var r=new a.Buf8(e.length),t=0,n=r.length;t<n;t++)r[t]=e.charCodeAt(t);return r},t.buf2string=function(e,r){var t,a,n,i,s=r||e.length,l=new Array(2*s);for(a=0,t=0;t<s;)if((n=e[t++])<128)l[a++]=n;else if((i=f[n])>4)l[a++]=65533,t+=i-1;else{for(n&=2===i?31:3===i?15:7;i>1&&t<s;)n=n<<6|63&e[t++],i--;i>1?l[a++]=65533:n<65536?l[a++]=n:(n-=65536,l[a++]=55296|n>>10&1023,l[a++]=56320|1023&n)}return o(l,a)},t.utf8border=function(e,r){var t;for((r=r||e.length)>e.length&&(r=e.length),t=r-1;t>=0&&128==(192&e[t]);)t--;return t<0?r:0===t?r:t+f[e[t]]>r?t:r}},{"./common":27}],29:[function(e,r,t){"use strict";function a(e,r,t,a){for(var n=65535&e|0,i=e>>>16&65535|0,s=0;0!==t;){t-=s=t>2e3?2e3:t;do{i=i+(n=n+r[a++]|0)|0}while(--s);n%=65521,i%=65521}return n|i<<16|0}r.exports=a},{}],30:[function(e,r,t){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(e,r,t){"use strict";function a(){for(var e,r=[],t=0;t<256;t++){e=t;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;r[t]=e}return r}var n=a();function i(e,r,t,a){var i=n,s=a+t;e^=-1;for(var f=a;f<s;f++)e=e>>>8^i[255&(e^r[f])];return-1^e}r.exports=i},{}],32:[function(e,r,t){"use strict";var a=e("../utils/common"),n=e("./trees"),i=e("./adler32"),s=e("./crc32"),f=e("./messages"),l=0,o=1,c=3,u=4,h=5,d=0,v=1,p=-2,m=-3,b=-5,g=-1,w=1,k=2,E=3,S=4,_=0,C=2,B=8,T=9,y=15,x=8,A=29,I=256,R=286,D=30,F=19,O=573,P=15,N=3,L=258,M=262,U=32,H=42,W=69,z=73,V=91,X=103,G=113,j=666,K=1,Y=2,$=3,Z=4,Q=3;function J(e,r){return e.msg=f[r],r}function q(e){return(e<<1)-(e>4?9:0)}function ee(e){for(var r=e.length;--r>=0;)e[r]=0}function re(e){var r=e.state,t=r.pending;t>e.avail_out&&(t=e.avail_out),0!==t&&(a.arraySet(e.output,r.pending_buf,r.pending_out,t,e.next_out),e.next_out+=t,r.pending_out+=t,e.total_out+=t,e.avail_out-=t,r.pending-=t,0===r.pending&&(r.pending_out=0))}function te(e,r){n._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,r),e.block_start=e.strstart,re(e.strm)}function ae(e,r){e.pending_buf[e.pending++]=r}function ne(e,r){e.pending_buf[e.pending++]=r>>>8&255,e.pending_buf[e.pending++]=255&r}function ie(e,r,t,n){var f=e.avail_in;return f>n&&(f=n),0===f?0:(e.avail_in-=f,a.arraySet(r,e.input,e.next_in,f,t),1===e.state.wrap?e.adler=i(e.adler,r,f,t):2===e.state.wrap&&(e.adler=s(e.adler,r,f,t)),e.next_in+=f,e.total_in+=f,f)}function se(e,r){var t=e.max_chain_length,a=e.strstart,n,i,s=e.prev_length,f=e.nice_match,l=e.strstart>e.w_size-M?e.strstart-(e.w_size-M):0,o=e.window,c=e.w_mask,u=e.prev,h=e.strstart+L,d=o[a+s-1],v=o[a+s];e.prev_length>=e.good_match&&(t>>=2),f>e.lookahead&&(f=e.lookahead);do{if(o[(n=r)+s]===v&&o[n+s-1]===d&&o[n]===o[a]&&o[++n]===o[a+1]){a+=2,n++;do{}while(o[++a]===o[++n]&&o[++a]===o[++n]&&o[++a]===o[++n]&&o[++a]===o[++n]&&o[++a]===o[++n]&&o[++a]===o[++n]&&o[++a]===o[++n]&&o[++a]===o[++n]&&a<h);if(i=L-(h-a),a=h-L,i>s){if(e.match_start=r,s=i,i>=f)break;d=o[a+s-1],v=o[a+s]}}}while((r=u[r&c])>l&&0!=--t);return s<=e.lookahead?s:e.lookahead}function fe(e){var r=e.w_size,t,n,i,s,f;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=r+(r-M)){a.arraySet(e.window,e.window,r,r,0),e.match_start-=r,e.strstart-=r,e.block_start-=r,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=r?i-r:0}while(--n);t=n=r;do{i=e.prev[--t],e.prev[t]=i>=r?i-r:0}while(--n);s+=r}if(0===e.strm.avail_in)break;if(n=ie(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=n,e.lookahead+e.insert>=3)for(f=e.strstart-e.insert,e.ins_h=e.window[f],e.ins_h=(e.ins_h<<e.hash_shift^e.window[f+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[f+3-1])&e.hash_mask,e.prev[f&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=f,f++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<M&&0!==e.strm.avail_in)}function le(e,r){var t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if(fe(e),0===e.lookahead&&0===r)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var a=e.block_start+t;if((0===e.strstart||e.strstart>=a)&&(e.lookahead=e.strstart-a,e.strstart=a,te(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-M&&(te(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===r?(te(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(te(e,!1),e.strm.avail_out),1)}function oe(e,r){for(var t,a;;){if(e.lookahead<M){if(fe(e),e.lookahead<M&&0===r)return 1;if(0===e.lookahead)break}if(t=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==t&&e.strstart-t<=e.w_size-M&&(e.match_length=se(e,t)),e.match_length>=3)if(a=n._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else a=n._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(a&&(te(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===r?(te(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?1:2}function ce(e,r){for(var t,a,i;;){if(e.lookahead<M){if(fe(e),e.lookahead<M&&0===r)return 1;if(0===e.lookahead)break}if(t=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==t&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-M&&(e.match_length=se(e,t),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,a=n._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,a&&(te(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((a=n._tr_tally(e,0,e.window[e.strstart-1]))&&te(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(a=n._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===r?(te(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?1:2}function ue(e,r){for(var t,a,i,s,f=e.window;;){if(e.lookahead<=L){if(fe(e),e.lookahead<=L&&0===r)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(a=f[i=e.strstart-1])===f[++i]&&a===f[++i]&&a===f[++i]){s=e.strstart+L;do{}while(a===f[++i]&&a===f[++i]&&a===f[++i]&&a===f[++i]&&a===f[++i]&&a===f[++i]&&a===f[++i]&&a===f[++i]&&i<s);e.match_length=L-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(t=n._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=n._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(te(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===r?(te(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?1:2}function he(e,r){for(var t;;){if(0===e.lookahead&&(fe(e),0===e.lookahead)){if(0===r)return 1;break}if(e.match_length=0,t=n._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(te(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===r?(te(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?1:2}var de=function(e,r,t,a,n){this.good_length=e,this.max_lazy=r,this.nice_length=t,this.max_chain=a,this.func=n},ve;function pe(e){e.window_size=2*e.w_size,ee(e.head),e.max_lazy_match=ve[e.level].max_lazy,e.good_match=ve[e.level].good_length,e.nice_match=ve[e.level].nice_length,e.max_chain_length=ve[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0}function me(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*O),this.dyn_dtree=new a.Buf16(122),this.bl_tree=new a.Buf16(78),ee(this.dyn_ltree),ee(this.dyn_dtree),ee(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(16),this.heap=new a.Buf16(573),ee(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(573),ee(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function be(e){var r;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(r=e.state).pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap?H:G,e.adler=2===r.wrap?0:1,r.last_flush=0,n._tr_init(r),0):J(e,p)}function ge(e){var r=be(e);return 0===r&&pe(e.state),r}function we(e,r){return e&&e.state?2!==e.state.wrap?p:(e.state.gzhead=r,0):p}function ke(e,r,t,n,i,s){if(!e)return p;var f=1;if(r===g&&(r=6),n<0?(f=0,n=-n):n>15&&(f=2,n-=16),i<1||i>9||8!==t||n<8||n>15||r<0||r>9||s<0||s>4)return J(e,p);8===n&&(n=9);var l=new me;return e.state=l,l.strm=e,l.wrap=f,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new a.Buf8(2*l.w_size),l.head=new a.Buf16(l.hash_size),l.prev=new a.Buf16(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new a.Buf8(l.pending_buf_size),l.d_buf=l.lit_bufsize>>1,l.l_buf=3*l.lit_bufsize,l.level=r,l.strategy=s,l.method=t,ge(e)}function Ee(e,r){return ke(e,r,8,y,8,0)}function Se(e,r){var t,a,i,f;if(!e||!e.state||r>5||r<0)return e?J(e,p):p;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||a.status===j&&4!==r)return J(e,0===e.avail_out?b:p);if(a.strm=e,t=a.last_flush,a.last_flush=r,a.status===H)if(2===a.wrap)e.adler=0,ae(a,31),ae(a,139),ae(a,8),a.gzhead?(ae(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),ae(a,255&a.gzhead.time),ae(a,a.gzhead.time>>8&255),ae(a,a.gzhead.time>>16&255),ae(a,a.gzhead.time>>24&255),ae(a,9===a.level?2:a.strategy>=2||a.level<2?4:0),ae(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(ae(a,255&a.gzhead.extra.length),ae(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=s(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=W):(ae(a,0),ae(a,0),ae(a,0),ae(a,0),ae(a,0),ae(a,9===a.level?2:a.strategy>=2||a.level<2?4:0),ae(a,3),a.status=G);else{var m=8+(a.w_bits-8<<4)<<8,g=-1;m|=(g=a.strategy>=2||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(m|=U),m+=31-m%31,a.status=G,ne(a,m),0!==a.strstart&&(ne(a,e.adler>>>16),ne(a,65535&e.adler)),e.adler=1}if(a.status===W)if(a.gzhead.extra){for(i=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>i&&(e.adler=s(e.adler,a.pending_buf,a.pending-i,i)),re(e),i=a.pending,a.pending!==a.pending_buf_size));)ae(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>i&&(e.adler=s(e.adler,a.pending_buf,a.pending-i,i)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=z)}else a.status=z;if(a.status===z)if(a.gzhead.name){i=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>i&&(e.adler=s(e.adler,a.pending_buf,a.pending-i,i)),re(e),i=a.pending,a.pending===a.pending_buf_size)){f=1;break}f=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,ae(a,f)}while(0!==f);a.gzhead.hcrc&&a.pending>i&&(e.adler=s(e.adler,a.pending_buf,a.pending-i,i)),0===f&&(a.gzindex=0,a.status=V)}else a.status=V;if(a.status===V)if(a.gzhead.comment){i=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>i&&(e.adler=s(e.adler,a.pending_buf,a.pending-i,i)),re(e),i=a.pending,a.pending===a.pending_buf_size)){f=1;break}f=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,ae(a,f)}while(0!==f);a.gzhead.hcrc&&a.pending>i&&(e.adler=s(e.adler,a.pending_buf,a.pending-i,i)),0===f&&(a.status=X)}else a.status=X;if(a.status===X&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&re(e),a.pending+2<=a.pending_buf_size&&(ae(a,255&e.adler),ae(a,e.adler>>8&255),e.adler=0,a.status=G)):a.status=G),0!==a.pending){if(re(e),0===e.avail_out)return a.last_flush=-1,0}else if(0===e.avail_in&&q(r)<=q(t)&&4!==r)return J(e,b);if(a.status===j&&0!==e.avail_in)return J(e,b);if(0!==e.avail_in||0!==a.lookahead||0!==r&&a.status!==j){var w=2===a.strategy?he(a,r):3===a.strategy?ue(a,r):ve[a.level].func(a,r);if(3!==w&&4!==w||(a.status=j),1===w||3===w)return 0===e.avail_out&&(a.last_flush=-1),0;if(2===w&&(1===r?n._tr_align(a):5!==r&&(n._tr_stored_block(a,0,0,!1),3===r&&(ee(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),re(e),0===e.avail_out))return a.last_flush=-1,0}return 4!==r?0:a.wrap<=0?1:(2===a.wrap?(ae(a,255&e.adler),ae(a,e.adler>>8&255),ae(a,e.adler>>16&255),ae(a,e.adler>>24&255),ae(a,255&e.total_in),ae(a,e.total_in>>8&255),ae(a,e.total_in>>16&255),ae(a,e.total_in>>24&255)):(ne(a,e.adler>>>16),ne(a,65535&e.adler)),re(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?0:1)}function _e(e){var r;return e&&e.state?(r=e.state.status)!==H&&r!==W&&r!==z&&r!==V&&r!==X&&r!==G&&r!==j?J(e,p):(e.state=null,r===G?J(e,m):0):p}ve=[new de(0,0,0,0,le),new de(4,4,8,4,oe),new de(4,5,16,8,oe),new de(4,6,32,32,oe),new de(4,4,16,16,ce),new de(8,16,32,32,ce),new de(8,16,128,128,ce),new de(8,32,128,256,ce),new de(32,128,258,1024,ce),new de(32,258,258,4096,ce)],t.deflateInit=Ee,t.deflateInit2=ke,t.deflateReset=ge,t.deflateResetKeep=be,t.deflateSetHeader=we,t.deflate=Se,t.deflateEnd=_e,t.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(e,r,t){"use strict";function a(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}r.exports=a},{}],34:[function(e,r,t){"use strict";var a=30,n=12;r.exports=function i(e,r){var t,i,s,f,l,o,c,u,h,d,v,p,m,b,g,w,k,E,S,_,C,B,T,y,x;t=e.state,i=e.next_in,y=e.input,s=i+(e.avail_in-5),f=e.next_out,x=e.output,l=f-(r-e.avail_out),o=f+(e.avail_out-257),c=t.dmax,u=t.wsize,h=t.whave,d=t.wnext,v=t.window,p=t.hold,m=t.bits,b=t.lencode,g=t.distcode,w=(1<<t.lenbits)-1,k=(1<<t.distbits)-1;e:do{m<15&&(p+=y[i++]<<m,m+=8,p+=y[i++]<<m,m+=8),E=b[p&w];r:for(;;){if(p>>>=S=E>>>24,m-=S,0===(S=E>>>16&255))x[f++]=65535&E;else{if(!(16&S)){if(0==(64&S)){E=b[(65535&E)+(p&(1<<S)-1)];continue r}if(32&S){t.mode=n;break e}e.msg="invalid literal/length code",t.mode=a;break e}_=65535&E,(S&=15)&&(m<S&&(p+=y[i++]<<m,m+=8),_+=p&(1<<S)-1,p>>>=S,m-=S),m<15&&(p+=y[i++]<<m,m+=8,p+=y[i++]<<m,m+=8),E=g[p&k];t:for(;;){if(p>>>=S=E>>>24,m-=S,!(16&(S=E>>>16&255))){if(0==(64&S)){E=g[(65535&E)+(p&(1<<S)-1)];continue t}e.msg="invalid distance code",t.mode=a;break e}if(C=65535&E,m<(S&=15)&&(p+=y[i++]<<m,(m+=8)<S&&(p+=y[i++]<<m,m+=8)),(C+=p&(1<<S)-1)>c){e.msg="invalid distance too far back",t.mode=a;break e}if(p>>>=S,m-=S,C>(S=f-l)){if((S=C-S)>h&&t.sane){e.msg="invalid distance too far back",t.mode=a;break e}if(B=0,T=v,0===d){if(B+=u-S,S<_){_-=S;do{x[f++]=v[B++]}while(--S);B=f-C,T=x}}else if(d<S){if(B+=u+d-S,(S-=d)<_){_-=S;do{x[f++]=v[B++]}while(--S);if(B=0,d<_){_-=S=d;do{x[f++]=v[B++]}while(--S);B=f-C,T=x}}}else if(B+=d-S,S<_){_-=S;do{x[f++]=v[B++]}while(--S);B=f-C,T=x}for(;_>2;)x[f++]=T[B++],x[f++]=T[B++],x[f++]=T[B++],_-=3;_&&(x[f++]=T[B++],_>1&&(x[f++]=T[B++]))}else{B=f-C;do{x[f++]=x[B++],x[f++]=x[B++],x[f++]=x[B++],_-=3}while(_>2);_&&(x[f++]=x[B++],_>1&&(x[f++]=x[B++]))}break}}break}}while(i<s&&f<o);i-=_=m>>3,p&=(1<<(m-=_<<3))-1,e.next_in=i,e.next_out=f,e.avail_in=i<s?s-i+5:5-(i-s),e.avail_out=f<o?o-f+257:257-(f-o),t.hold=p,t.bits=m}},{}],35:[function(e,r,t){"use strict";var a=e("../utils/common"),n=e("./adler32"),i=e("./crc32"),s=e("./inffast"),f=e("./inftrees"),l=0,o=1,c=2,u=4,h=5,d=6,v=0,p=1,m=2,b=-2,g=-3,w=-4,k=-5,E=8,S=1,_=2,C=3,B=4,T=5,y=6,x=7,A=8,I=9,R=10,D=11,F=12,O=13,P=14,N=15,L=16,M=17,U=18,H=19,W=20,z=21,V=22,X=23,G=24,j=25,K=26,Y=27,$=28,Z=29,Q=30,J=31,q=32,ee=852,re=592,te=15,ae=15;function ne(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function ie(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function se(e){var r;return e&&e.state?(r=e.state,e.total_in=e.total_out=r.total=0,e.msg="",r.wrap&&(e.adler=1&r.wrap),r.mode=1,r.last=0,r.havedict=0,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new a.Buf32(ee),r.distcode=r.distdyn=new a.Buf32(re),r.sane=1,r.back=-1,0):b}function fe(e){var r;return e&&e.state?((r=e.state).wsize=0,r.whave=0,r.wnext=0,se(e)):b}function le(e,r){var t,a;return e&&e.state?(a=e.state,r<0?(t=0,r=-r):(t=1+(r>>4),r<48&&(r&=15)),r&&(r<8||r>15)?b:(null!==a.window&&a.wbits!==r&&(a.window=null),a.wrap=t,a.wbits=r,fe(e))):b}function oe(e,r){var t,a;return e?(a=new ie,e.state=a,a.window=null,0!==(t=le(e,r))&&(e.state=null),t):b}function ce(e){return oe(e,15)}var ue=!0,he,de;function ve(e){if(ue){var r;for(he=new a.Buf32(512),de=new a.Buf32(32),r=0;r<144;)e.lens[r++]=8;for(;r<256;)e.lens[r++]=9;for(;r<280;)e.lens[r++]=7;for(;r<288;)e.lens[r++]=8;for(f(1,e.lens,0,288,he,0,e.work,{bits:9}),r=0;r<32;)e.lens[r++]=5;f(2,e.lens,0,32,de,0,e.work,{bits:5}),ue=!1}e.lencode=he,e.lenbits=9,e.distcode=de,e.distbits=5}function pe(e,r,t,n){var i,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new a.Buf8(s.wsize)),n>=s.wsize?(a.arraySet(s.window,r,t-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((i=s.wsize-s.wnext)>n&&(i=n),a.arraySet(s.window,r,t-n,i,s.wnext),(n-=i)?(a.arraySet(s.window,r,t-n,n,0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0}function me(e,r){var t,ee,re,te,ae,ie,se,fe,le,oe,ce,ue,he,de,me=0,be,ge,we,ke,Ee,Se,_e,Ce,Be=new a.Buf8(4),Te,ye,xe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return b;(t=e.state).mode===F&&(t.mode=O),ae=e.next_out,re=e.output,se=e.avail_out,te=e.next_in,ee=e.input,ie=e.avail_in,fe=t.hold,le=t.bits,oe=ie,ce=se,Ce=0;e:for(;;)switch(t.mode){case 1:if(0===t.wrap){t.mode=O;break}for(;le<16;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}if(2&t.wrap&&35615===fe){t.check=0,Be[0]=255&fe,Be[1]=fe>>>8&255,t.check=i(t.check,Be,2,0),fe=0,le=0,t.mode=2;break}if(t.flags=0,t.head&&(t.head.done=!1),!(1&t.wrap)||(((255&fe)<<8)+(fe>>8))%31){e.msg="incorrect header check",t.mode=Q;break}if(8!=(15&fe)){e.msg="unknown compression method",t.mode=Q;break}if(le-=4,_e=8+(15&(fe>>>=4)),0===t.wbits)t.wbits=_e;else if(_e>t.wbits){e.msg="invalid window size",t.mode=Q;break}t.dmax=1<<_e,e.adler=t.check=1,t.mode=512&fe?R:F,fe=0,le=0;break;case 2:for(;le<16;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}if(t.flags=fe,8!=(255&t.flags)){e.msg="unknown compression method",t.mode=Q;break}if(57344&t.flags){e.msg="unknown header flags set",t.mode=Q;break}t.head&&(t.head.text=fe>>8&1),512&t.flags&&(Be[0]=255&fe,Be[1]=fe>>>8&255,t.check=i(t.check,Be,2,0)),fe=0,le=0,t.mode=3;case 3:for(;le<32;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}t.head&&(t.head.time=fe),512&t.flags&&(Be[0]=255&fe,Be[1]=fe>>>8&255,Be[2]=fe>>>16&255,Be[3]=fe>>>24&255,t.check=i(t.check,Be,4,0)),fe=0,le=0,t.mode=4;case 4:for(;le<16;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}t.head&&(t.head.xflags=255&fe,t.head.os=fe>>8),512&t.flags&&(Be[0]=255&fe,Be[1]=fe>>>8&255,t.check=i(t.check,Be,2,0)),fe=0,le=0,t.mode=5;case 5:if(1024&t.flags){for(;le<16;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}t.length=fe,t.head&&(t.head.extra_len=fe),512&t.flags&&(Be[0]=255&fe,Be[1]=fe>>>8&255,t.check=i(t.check,Be,2,0)),fe=0,le=0}else t.head&&(t.head.extra=null);t.mode=6;case 6:if(1024&t.flags&&((ue=t.length)>ie&&(ue=ie),ue&&(t.head&&(_e=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),a.arraySet(t.head.extra,ee,te,ue,_e)),512&t.flags&&(t.check=i(t.check,ee,ue,te)),ie-=ue,te+=ue,t.length-=ue),t.length))break e;t.length=0,t.mode=7;case 7:if(2048&t.flags){if(0===ie)break e;ue=0;do{_e=ee[te+ue++],t.head&&_e&&t.length<65536&&(t.head.name+=String.fromCharCode(_e))}while(_e&&ue<ie);if(512&t.flags&&(t.check=i(t.check,ee,ue,te)),ie-=ue,te+=ue,_e)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=8;case 8:if(4096&t.flags){if(0===ie)break e;ue=0;do{_e=ee[te+ue++],t.head&&_e&&t.length<65536&&(t.head.comment+=String.fromCharCode(_e))}while(_e&&ue<ie);if(512&t.flags&&(t.check=i(t.check,ee,ue,te)),ie-=ue,te+=ue,_e)break e}else t.head&&(t.head.comment=null);t.mode=9;case 9:if(512&t.flags){for(;le<16;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}if(fe!==(65535&t.check)){e.msg="header crc mismatch",t.mode=Q;break}fe=0,le=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=F;break;case R:for(;le<32;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}e.adler=t.check=ne(fe),fe=0,le=0,t.mode=D;case D:if(0===t.havedict)return e.next_out=ae,e.avail_out=se,e.next_in=te,e.avail_in=ie,t.hold=fe,t.bits=le,2;e.adler=t.check=1,t.mode=F;case F:if(5===r||6===r)break e;case O:if(t.last){fe>>>=7&le,le-=7&le,t.mode=Y;break}for(;le<3;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}switch(t.last=1&fe,le-=1,3&(fe>>>=1)){case 0:t.mode=P;break;case 1:if(ve(t),t.mode=W,6===r){fe>>>=2,le-=2;break e}break;case 2:t.mode=M;break;case 3:e.msg="invalid block type",t.mode=Q}fe>>>=2,le-=2;break;case P:for(fe>>>=7&le,le-=7&le;le<32;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}if((65535&fe)!=(fe>>>16^65535)){e.msg="invalid stored block lengths",t.mode=Q;break}if(t.length=65535&fe,fe=0,le=0,t.mode=N,6===r)break e;case N:t.mode=L;case L:if(ue=t.length){if(ue>ie&&(ue=ie),ue>se&&(ue=se),0===ue)break e;a.arraySet(re,ee,te,ue,ae),ie-=ue,te+=ue,se-=ue,ae+=ue,t.length-=ue;break}t.mode=F;break;case M:for(;le<14;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}if(t.nlen=257+(31&fe),fe>>>=5,le-=5,t.ndist=1+(31&fe),fe>>>=5,le-=5,t.ncode=4+(15&fe),fe>>>=4,le-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=Q;break}t.have=0,t.mode=U;case U:for(;t.have<t.ncode;){for(;le<3;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}t.lens[xe[t.have++]]=7&fe,fe>>>=3,le-=3}for(;t.have<19;)t.lens[xe[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,Te={bits:t.lenbits},Ce=f(0,t.lens,0,19,t.lencode,0,t.work,Te),t.lenbits=Te.bits,Ce){e.msg="invalid code lengths set",t.mode=Q;break}t.have=0,t.mode=H;case H:for(;t.have<t.nlen+t.ndist;){for(;ge=(me=t.lencode[fe&(1<<t.lenbits)-1])>>>16&255,we=65535&me,!((be=me>>>24)<=le);){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}if(we<16)fe>>>=be,le-=be,t.lens[t.have++]=we;else{if(16===we){for(ye=be+2;le<ye;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}if(fe>>>=be,le-=be,0===t.have){e.msg="invalid bit length repeat",t.mode=Q;break}_e=t.lens[t.have-1],ue=3+(3&fe),fe>>>=2,le-=2}else if(17===we){for(ye=be+3;le<ye;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}le-=be,_e=0,ue=3+(7&(fe>>>=be)),fe>>>=3,le-=3}else{for(ye=be+7;le<ye;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}le-=be,_e=0,ue=11+(127&(fe>>>=be)),fe>>>=7,le-=7}if(t.have+ue>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=Q;break}for(;ue--;)t.lens[t.have++]=_e}}if(t.mode===Q)break;if(0===t.lens[256]){e.msg="invalid code -- missing end-of-block",t.mode=Q;break}if(t.lenbits=9,Te={bits:t.lenbits},Ce=f(1,t.lens,0,t.nlen,t.lencode,0,t.work,Te),t.lenbits=Te.bits,Ce){e.msg="invalid literal/lengths set",t.mode=Q;break}if(t.distbits=6,t.distcode=t.distdyn,Te={bits:t.distbits},Ce=f(2,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,Te),t.distbits=Te.bits,Ce){e.msg="invalid distances set",t.mode=Q;break}if(t.mode=W,6===r)break e;case W:t.mode=z;case z:if(ie>=6&&se>=258){e.next_out=ae,e.avail_out=se,e.next_in=te,e.avail_in=ie,t.hold=fe,t.bits=le,s(e,ce),ae=e.next_out,re=e.output,se=e.avail_out,te=e.next_in,ee=e.input,ie=e.avail_in,fe=t.hold,le=t.bits,t.mode===F&&(t.back=-1);break}for(t.back=0;ge=(me=t.lencode[fe&(1<<t.lenbits)-1])>>>16&255,we=65535&me,!((be=me>>>24)<=le);){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}if(ge&&0==(240&ge)){for(ke=be,Ee=ge,Se=we;ge=(me=t.lencode[Se+((fe&(1<<ke+Ee)-1)>>ke)])>>>16&255,we=65535&me,!(ke+(be=me>>>24)<=le);){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}fe>>>=ke,le-=ke,t.back+=ke}if(fe>>>=be,le-=be,t.back+=be,t.length=we,0===ge){t.mode=K;break}if(32&ge){t.back=-1,t.mode=F;break}if(64&ge){e.msg="invalid literal/length code",t.mode=Q;break}t.extra=15&ge,t.mode=V;case V:if(t.extra){for(ye=t.extra;le<ye;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}t.length+=fe&(1<<t.extra)-1,fe>>>=t.extra,le-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=X;case X:for(;ge=(me=t.distcode[fe&(1<<t.distbits)-1])>>>16&255,we=65535&me,!((be=me>>>24)<=le);){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}if(0==(240&ge)){for(ke=be,Ee=ge,Se=we;ge=(me=t.distcode[Se+((fe&(1<<ke+Ee)-1)>>ke)])>>>16&255,we=65535&me,!(ke+(be=me>>>24)<=le);){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}fe>>>=ke,le-=ke,t.back+=ke}if(fe>>>=be,le-=be,t.back+=be,64&ge){e.msg="invalid distance code",t.mode=Q;break}t.offset=we,t.extra=15&ge,t.mode=G;case G:if(t.extra){for(ye=t.extra;le<ye;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}t.offset+=fe&(1<<t.extra)-1,fe>>>=t.extra,le-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=Q;break}t.mode=j;case j:if(0===se)break e;if(ue=ce-se,t.offset>ue){if((ue=t.offset-ue)>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=Q;break}ue>t.wnext?(ue-=t.wnext,he=t.wsize-ue):he=t.wnext-ue,ue>t.length&&(ue=t.length),de=t.window}else de=re,he=ae-t.offset,ue=t.length;ue>se&&(ue=se),se-=ue,t.length-=ue;do{re[ae++]=de[he++]}while(--ue);0===t.length&&(t.mode=z);break;case K:if(0===se)break e;re[ae++]=t.length,se--,t.mode=z;break;case Y:if(t.wrap){for(;le<32;){if(0===ie)break e;ie--,fe|=ee[te++]<<le,le+=8}if(ce-=se,e.total_out+=ce,t.total+=ce,ce&&(e.adler=t.check=t.flags?i(t.check,re,ce,ae-ce):n(t.check,re,ce,ae-ce)),ce=se,(t.flags?fe:ne(fe))!==t.check){e.msg="incorrect data check",t.mode=Q;break}fe=0,le=0}t.mode=$;case $:if(t.wrap&&t.flags){for(;le<32;){if(0===ie)break e;ie--,fe+=ee[te++]<<le,le+=8}if(fe!==(4294967295&t.total)){e.msg="incorrect length check",t.mode=Q;break}fe=0,le=0}t.mode=Z;case Z:Ce=1;break e;case Q:Ce=g;break e;case J:return w;case q:default:return b}return e.next_out=ae,e.avail_out=se,e.next_in=te,e.avail_in=ie,t.hold=fe,t.bits=le,(t.wsize||ce!==e.avail_out&&t.mode<Q&&(t.mode<Y||4!==r))&&pe(e,e.output,e.next_out,ce-e.avail_out)?(t.mode=J,w):(oe-=e.avail_in,ce-=e.avail_out,e.total_in+=oe,e.total_out+=ce,t.total+=ce,t.wrap&&ce&&(e.adler=t.check=t.flags?i(t.check,re,ce,e.next_out-ce):n(t.check,re,ce,e.next_out-ce)),e.data_type=t.bits+(t.last?64:0)+(t.mode===F?128:0)+(t.mode===W||t.mode===N?256:0),(0===oe&&0===ce||4===r)&&0===Ce&&(Ce=k),Ce)}function be(e){if(!e||!e.state)return b;var r=e.state;return r.window&&(r.window=null),e.state=null,0}function ge(e,r){var t;return e&&e.state?0==(2&(t=e.state).wrap)?b:(t.head=r,r.done=!1,0):b}t.inflateReset=fe,t.inflateReset2=le,t.inflateResetKeep=se,t.inflateInit=ce,t.inflateInit2=oe,t.inflate=me,t.inflateEnd=be,t.inflateGetHeader=ge,t.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(e,r,t){"use strict";var a=e("../utils/common"),n=15,i=852,s=592,f=0,l=1,o=2,c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function v(e,r,t,p,m,b,g,w){var k=w.bits,E=0,S=0,_=0,C=0,B=0,T=0,y=0,x=0,A=0,I=0,R,D,F,O,P,N=null,L=0,M,U=new a.Buf16(16),H=new a.Buf16(16),W=null,z=0,V,X,G;for(E=0;E<=n;E++)U[E]=0;for(S=0;S<p;S++)U[r[t+S]]++;for(B=k,C=n;C>=1&&0===U[C];C--);if(B>C&&(B=C),0===C)return m[b++]=20971520,m[b++]=20971520,w.bits=1,0;for(_=1;_<C&&0===U[_];_++);for(B<_&&(B=_),x=1,E=1;E<=n;E++)if(x<<=1,(x-=U[E])<0)return-1;if(x>0&&(0===e||1!==C))return-1;for(H[1]=0,E=1;E<n;E++)H[E+1]=H[E]+U[E];for(S=0;S<p;S++)0!==r[t+S]&&(g[H[r[t+S]]++]=S);if(0===e?(N=W=g,M=19):1===e?(N=c,L-=257,W=u,z-=257,M=256):(N=h,W=d,M=-1),I=0,S=0,E=_,P=b,T=B,y=0,F=-1,O=(A=1<<B)-1,1===e&&A>i||2===e&&A>s)return 1;for(var j=0;;){j++,V=E-y,g[S]<M?(X=0,G=g[S]):g[S]>M?(X=W[z+g[S]],G=N[L+g[S]]):(X=96,G=0),R=1<<E-y,_=D=1<<T;do{m[P+(I>>y)+(D-=R)]=V<<24|X<<16|G|0}while(0!==D);for(R=1<<E-1;I&R;)R>>=1;if(0!==R?(I&=R-1,I+=R):I=0,S++,0==--U[E]){if(E===C)break;E=r[t+g[S]]}if(E>B&&(I&O)!==F){for(0===y&&(y=B),P+=_,x=1<<(T=E-y);T+y<C&&!((x-=U[T+y])<=0);)T++,x<<=1;if(A+=1<<T,1===e&&A>i||2===e&&A>s)return 1;m[F=I&O]=B<<24|T<<16|P-b|0}}return 0!==I&&(m[P+I]=E-y<<24|64<<16|0),w.bits=B,0}},{"../utils/common":27}],37:[function(e,r,t){"use strict";r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(e,r,t){"use strict";var a=e("../utils/common"),n=4,i=0,s=1,f=2;function l(e){for(var r=e.length;--r>=0;)e[r]=0}var o=0,c=1,u=2,h=3,d=258,v=29,p=256,m=286,b=30,g=19,w=573,k=15,E=16,S=7,_=256,C=16,B=17,T=18,y=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],x=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=512,D=new Array(576);l(D);var F=new Array(60);l(F);var O=new Array(R);l(O);var P=new Array(256);l(P);var N=new Array(v);l(N);var L=new Array(b);l(L);var M=function(e,r,t,a,n){this.static_tree=e,this.extra_bits=r,this.extra_base=t,this.elems=a,this.max_length=n,this.has_stree=e&&e.length},U,H,W,z=function(e,r){this.dyn_tree=e,this.max_code=0,this.stat_desc=r};function V(e){return e<256?O[e]:O[256+(e>>>7)]}function X(e,r){e.pending_buf[e.pending++]=255&r,e.pending_buf[e.pending++]=r>>>8&255}function G(e,r,t){e.bi_valid>E-t?(e.bi_buf|=r<<e.bi_valid&65535,X(e,e.bi_buf),e.bi_buf=r>>E-e.bi_valid,e.bi_valid+=t-E):(e.bi_buf|=r<<e.bi_valid&65535,e.bi_valid+=t)}function j(e,r,t){G(e,t[2*r],t[2*r+1])}function K(e,r){var t=0;do{t|=1&e,e>>>=1,t<<=1}while(--r>0);return t>>>1}function Y(e){16===e.bi_valid?(X(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function $(e,r){var t=r.dyn_tree,a=r.max_code,n=r.stat_desc.static_tree,i=r.stat_desc.has_stree,s=r.stat_desc.extra_bits,f=r.stat_desc.extra_base,l=r.stat_desc.max_length,o,c,u,h,d,v,p=0;for(h=0;h<=k;h++)e.bl_count[h]=0;for(t[2*e.heap[e.heap_max]+1]=0,o=e.heap_max+1;o<w;o++)(h=t[2*t[2*(c=e.heap[o])+1]+1]+1)>l&&(h=l,p++),t[2*c+1]=h,c>a||(e.bl_count[h]++,d=0,c>=f&&(d=s[c-f]),v=t[2*c],e.opt_len+=v*(h+d),i&&(e.static_len+=v*(n[2*c+1]+d)));if(0!==p){do{for(h=l-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[l]--,p-=2}while(p>0);for(h=l;0!==h;h--)for(c=e.bl_count[h];0!==c;)(u=e.heap[--o])>a||(t[2*u+1]!==h&&(e.opt_len+=(h-t[2*u+1])*t[2*u],t[2*u+1]=h),c--)}}function Z(e,r,t){var a=new Array(16),n=0,i,s;for(i=1;i<=k;i++)a[i]=n=n+t[i-1]<<1;for(s=0;s<=r;s++){var f=e[2*s+1];0!==f&&(e[2*s]=K(a[f]++,f))}}function Q(){var e,r,t,a,n,i=new Array(16);for(t=0,a=0;a<28;a++)for(N[a]=t,e=0;e<1<<y[a];e++)P[t++]=a;for(P[t-1]=a,n=0,a=0;a<16;a++)for(L[a]=n,e=0;e<1<<x[a];e++)O[n++]=a;for(n>>=7;a<b;a++)for(L[a]=n<<7,e=0;e<1<<x[a]-7;e++)O[256+n++]=a;for(r=0;r<=k;r++)i[r]=0;for(e=0;e<=143;)D[2*e+1]=8,e++,i[8]++;for(;e<=255;)D[2*e+1]=9,e++,i[9]++;for(;e<=279;)D[2*e+1]=7,e++,i[7]++;for(;e<=287;)D[2*e+1]=8,e++,i[8]++;for(Z(D,287,i),e=0;e<b;e++)F[2*e+1]=5,F[2*e]=K(e,5);U=new M(D,y,257,m,k),H=new M(F,x,0,b,k),W=new M(new Array(0),A,0,g,7)}function J(e){var r;for(r=0;r<m;r++)e.dyn_ltree[2*r]=0;for(r=0;r<b;r++)e.dyn_dtree[2*r]=0;for(r=0;r<g;r++)e.bl_tree[2*r]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function q(e){e.bi_valid>8?X(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function ee(e,r,t,n){q(e),n&&(X(e,t),X(e,~t)),a.arraySet(e.pending_buf,e.window,r,t,e.pending),e.pending+=t}function re(e,r,t,a){var n=2*r,i=2*t;return e[n]<e[i]||e[n]===e[i]&&a[r]<=a[t]}function te(e,r,t){for(var a=e.heap[t],n=t<<1;n<=e.heap_len&&(n<e.heap_len&&re(r,e.heap[n+1],e.heap[n],e.depth)&&n++,!re(r,a,e.heap[n],e.depth));)e.heap[t]=e.heap[n],t=n,n<<=1;e.heap[t]=a}function ae(e,r,t){var a,n,i=0,s,f;if(0!==e.last_lit)do{a=e.pending_buf[e.d_buf+2*i]<<8|e.pending_buf[e.d_buf+2*i+1],n=e.pending_buf[e.l_buf+i],i++,0===a?j(e,n,r):(j(e,(s=P[n])+p+1,r),0!==(f=y[s])&&G(e,n-=N[s],f),j(e,s=V(--a),t),0!==(f=x[s])&&G(e,a-=L[s],f))}while(i<e.last_lit);j(e,_,r)}function ne(e,r){var t=r.dyn_tree,a=r.stat_desc.static_tree,n=r.stat_desc.has_stree,i=r.stat_desc.elems,s,f,l=-1,o;for(e.heap_len=0,e.heap_max=w,s=0;s<i;s++)0!==t[2*s]?(e.heap[++e.heap_len]=l=s,e.depth[s]=0):t[2*s+1]=0;for(;e.heap_len<2;)t[2*(o=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[o]=0,e.opt_len--,n&&(e.static_len-=a[2*o+1]);for(r.max_code=l,s=e.heap_len>>1;s>=1;s--)te(e,t,s);o=i;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],te(e,t,1),f=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=f,t[2*o]=t[2*s]+t[2*f],e.depth[o]=(e.depth[s]>=e.depth[f]?e.depth[s]:e.depth[f])+1,t[2*s+1]=t[2*f+1]=o,e.heap[1]=o++,te(e,t,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],$(e,r),Z(t,l,e.bl_count)}function ie(e,r,t){var a,n=-1,i,s=r[1],f=0,l=7,o=4;for(0===s&&(l=138,o=3),r[2*(t+1)+1]=65535,a=0;a<=t;a++)i=s,s=r[2*(a+1)+1],++f<l&&i===s||(f<o?e.bl_tree[2*i]+=f:0!==i?(i!==n&&e.bl_tree[2*i]++,e.bl_tree[32]++):f<=10?e.bl_tree[34]++:e.bl_tree[36]++,f=0,n=i,0===s?(l=138,o=3):i===s?(l=6,o=3):(l=7,o=4))}function se(e,r,t){var a,n=-1,i,s=r[1],f=0,l=7,o=4;for(0===s&&(l=138,o=3),a=0;a<=t;a++)if(i=s,s=r[2*(a+1)+1],!(++f<l&&i===s)){if(f<o)do{j(e,i,e.bl_tree)}while(0!=--f);else 0!==i?(i!==n&&(j(e,i,e.bl_tree),f--),j(e,C,e.bl_tree),G(e,f-3,2)):f<=10?(j(e,B,e.bl_tree),G(e,f-3,3)):(j(e,T,e.bl_tree),G(e,f-11,7));f=0,n=i,0===s?(l=138,o=3):i===s?(l=6,o=3):(l=7,o=4)}}function fe(e){var r;for(ie(e,e.dyn_ltree,e.l_desc.max_code),ie(e,e.dyn_dtree,e.d_desc.max_code),ne(e,e.bl_desc),r=18;r>=3&&0===e.bl_tree[2*I[r]+1];r--);return e.opt_len+=3*(r+1)+5+5+4,r}function le(e,r,t,a){var n;for(G(e,r-257,5),G(e,t-1,5),G(e,a-4,4),n=0;n<a;n++)G(e,e.bl_tree[2*I[n]+1],3);se(e,e.dyn_ltree,r-1),se(e,e.dyn_dtree,t-1)}function oe(e){var r=4093624447,t;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<p;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}var ce=!1;function ue(e){ce||(Q(),ce=!0),e.l_desc=new z(e.dyn_ltree,U),e.d_desc=new z(e.dyn_dtree,H),e.bl_desc=new z(e.bl_tree,W),e.bi_buf=0,e.bi_valid=0,J(e)}function he(e,r,t,a){G(e,0+(a?1:0),3),ee(e,r,t,!0)}function de(e){G(e,2,3),j(e,_,D),Y(e)}function ve(e,r,t,a){var i,s,l=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=oe(e)),ne(e,e.l_desc),ne(e,e.d_desc),l=fe(e),i=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=i&&(i=s)):i=s=t+5,t+4<=i&&-1!==r?he(e,r,t,a):4===e.strategy||s===i?(G(e,2+(a?1:0),3),ae(e,D,F)):(G(e,4+(a?1:0),3),le(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),ae(e,e.dyn_ltree,e.dyn_dtree)),J(e),a&&q(e)}function pe(e,r,t){return e.pending_buf[e.d_buf+2*e.last_lit]=r>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&r,e.pending_buf[e.l_buf+e.last_lit]=255&t,e.last_lit++,0===r?e.dyn_ltree[2*t]++:(e.matches++,r--,e.dyn_ltree[2*(P[t]+p+1)]++,e.dyn_dtree[2*V(r)]++),e.last_lit===e.lit_bufsize-1}t._tr_init=ue,t._tr_stored_block=he,t._tr_flush_block=ve,t._tr_tally=pe,t._tr_align=de},{"../utils/common":27}],39:[function(e,r,t){"use strict";function a(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}r.exports=a},{}]},{},[9])(9)}));var XLSX={};function make_xlsx_lib(e){e.version="0.15.5";var r=1200,t=1252;"undefined"!=typeof module&&"undefined"!=typeof require&&"undefined"==typeof cptable&&("undefined"!=typeof global?global.cptable=void 0:"undefined"!=typeof window&&(window.cptable=void 0));for(var a=[874,932,936,949,950],n=0;n<=8;++n)a.push(1250+n);var i={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},s=function(e){-1!=a.indexOf(e)&&(t=i[0]=e)};function f(){s(1252)}var l=function(e){r=e,s(e)};function o(){l(1200),f()}function c(e){for(var r=[],t=0,a=e.length;t<a;++t)r[t]=e.charCodeAt(t);return r}function u(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function h(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var d=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return 255==r&&254==t?u(e.slice(2)):254==r&&255==t?h(e.slice(2)):65279==r?e.slice(1):e},v=function rb(e){return String.fromCharCode(e)},p=function tb(e){return String.fromCharCode(e)};"undefined"!=typeof cptable&&(l=function(e){r=e,s(e)},d=function(e){return 255===e.charCodeAt(0)&&254===e.charCodeAt(1)?cptable.utils.decode(1200,c(e.slice(2))):e},v=function ab(e){return 1200===r?String.fromCharCode(e):cptable.utils.decode(r,[255&e,e>>8])[0]},p=function nb(e){return cptable.utils.decode(t,[e])[0]});var m=null,b=!0,g=function ib(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(r){for(var t="",a=0,n=0,i=0,s=0,f=0,l=0,o=0,c=0;c<r.length;)s=(a=r.charCodeAt(c++))>>2,f=(3&a)<<4|(n=r.charCodeAt(c++))>>4,l=(15&n)<<2|(i=r.charCodeAt(c++))>>6,o=63&i,isNaN(n)?l=o=64:isNaN(i)&&(o=64),t+=e.charAt(s)+e.charAt(f)+e.charAt(l)+e.charAt(o);return t},decode:function r(t){var a="",n=0,i=0,s=0,f=0,l=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)n=(f=e.indexOf(t.charAt(u++)))<<2|(l=e.indexOf(t.charAt(u++)))>>4,a+=String.fromCharCode(n),i=(15&l)<<4|(o=e.indexOf(t.charAt(u++)))>>2,64!==o&&(a+=String.fromCharCode(i)),s=(3&o)<<6|(c=e.indexOf(t.charAt(u++))),64!==c&&(a+=String.fromCharCode(s));return a}}}(),w="undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node,k=function(){};if("undefined"!=typeof Buffer){var E=!Buffer.from;if(!E)try{Buffer.from("foo","utf8")}catch(S){E=!0}k=E?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer),Buffer.alloc||(Buffer.alloc=function(e){return new Buffer(e)}),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(e){return new Buffer(e)})}function _(e){return w?Buffer.alloc(e):new Array(e)}function C(e){return w?Buffer.allocUnsafe(e):new Array(e)}var B=function sb(e){return w?k(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function T(e){if("undefined"==typeof ArrayBuffer)return B(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),a=0;a!=e.length;++a)t[a]=255&e.charCodeAt(a);return r}function y(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function x(e){if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}function A(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return A(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var I=function(e){return[].concat.apply([],e)},R=/\u0000/g,D=/[\u0001-\u0006]/g,F={},O=function fb(e){function r(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function t(e,r){for(var t="";t.length<r;)t+=e;return t}function a(e,r){var a=""+e;return a.length>=r?a:t("0",r-a.length)+a}function n(e,r){var a=""+e;return a.length>=r?a:t(" ",r-a.length)+a}function i(e,r){var a=""+e;return a.length>=r?a:a+t(" ",r-a.length)}function s(e,r){var a=""+Math.round(e);return a.length>=r?a:t("0",r-a.length)+a}function f(e,r){var a=""+e;return a.length>=r?a:t("0",r-a.length)+a}e.version="0.10.2";var l=Math.pow(2,32);function o(e,r){return e>l||e<-l?s(e,r):f(Math.round(e),r);var t}function c(e,r){return r=r||0,e.length>=7+r&&103==(32|e.charCodeAt(r))&&101==(32|e.charCodeAt(r+1))&&110==(32|e.charCodeAt(r+2))&&101==(32|e.charCodeAt(r+3))&&114==(32|e.charCodeAt(r+4))&&97==(32|e.charCodeAt(r+5))&&108==(32|e.charCodeAt(r+6))}var u=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],h=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function d(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e[65535]="General"}var v={};function p(e,r,t){for(var a=e<0?-1:1,n=e*a,i=0,s=1,f=0,l=1,o=0,c=0,u=Math.floor(n);o<r&&(f=(u=Math.floor(n))*s+i,c=u*o+l,!(n-u<5e-8));)n=1/(n-u),i=s,s=f,l=o,o=c;if(c>r&&(o>r?(c=l,f=i):(c=o,f=s)),!t)return[0,a*f,c];var h=Math.floor(a*f/c);return[h,a*f-h*c,c]}function m(e,r,t){if(e>2958465||e<0)return null;var a=0|e,n=Math.floor(86400*(e-a)),i=0,s=[],f={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),r&&r.date1904&&(a+=1462),f.u>.9999&&(f.u=0,86400==++n&&(f.T=n=0,++a,++f.D)),60===a)s=t?[1317,10,29]:[1900,2,29],i=3;else if(0===a)s=t?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var l=new Date(1900,0,1);l.setDate(l.getDate()+a-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),a<60&&(i=(i+6)%7),t&&(i=0)}return f.y=s[0],f.m=s[1],f.d=s[2],f.S=n%60,n=Math.floor(n/60),f.M=n%60,n=Math.floor(n/60),f.H=n,f.q=i,f}d(v),e.parse_date_code=m;var b=new Date(1899,11,31,0,0,0),g=b.getTime(),w=new Date(1900,2,1,0,0,0);function k(e,r){var t=e.getTime();return r?t-=1262304e5:e>=w&&(t+=864e5),(t-(g+6e4*(e.getTimezoneOffset()-b.getTimezoneOffset())))/864e5}function E(e){return e.toString(10)}e._general_int=E;var S=function M(){var e=/\.(\d*[1-9])0+$/,r=/\.0*$/,t=/\.(\d*[1-9])0+/,a=/\.0*[Ee]/,n=/(E[+-])(\d)$/;function i(e){var r=e<0?12:11,t=l(e.toFixed(12));return t.length<=r?t:(t=e.toPrecision(10)).length<=r?t:e.toExponential(5)}function s(r){var t=r.toFixed(11).replace(e,".$1");return t.length>(r<0?12:11)&&(t=r.toPrecision(6)),t}function f(e){for(var r=0;r!=e.length;++r)if(101==(32|e.charCodeAt(r)))return e.replace(t,".$1").replace(a,"E").replace("e","E").replace(n,"$10$2");return e}function l(t){return t.indexOf(".")>-1?t.replace(r,"").replace(e,".$1"):t}return function o(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return l(f(t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?i(e):10===r?e.toFixed(10).substr(0,12):s(e)))}}();function _(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?E(e):S(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return N(14,k(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function C(){return 0}function B(e,r,t,n){var i="",s=0,f=0,l=t.y,o,c=0;switch(e){case 98:l=t.y+543;case 121:switch(r.length){case 1:case 2:o=l%100,c=2;break;default:o=l%1e4,c=4}break;case 109:switch(r.length){case 1:case 2:o=t.m,c=r.length;break;case 3:return h[t.m-1][1];case 5:return h[t.m-1][0];default:return h[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:o=t.d,c=r.length;break;case 3:return u[t.q][0];default:return u[t.q][1]}break;case 104:switch(r.length){case 1:case 2:o=1+(t.H+11)%12,c=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:o=t.H,c=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:o=t.M,c=r.length;break;default:throw"bad minute format: "+r}break;case 115:if("s"!=r&&"ss"!=r&&".0"!=r&&".00"!=r&&".000"!=r)throw"bad second format: "+r;return 0!==t.u||"s"!=r&&"ss"!=r?(f=n>=2?3===n?1e3:100:1===n?10:1,(s=Math.round(f*(t.S+t.u)))>=60*f&&(s=0),"s"===r?0===s?"0":""+s/f:(i=a(s,2+n),"ss"===r?i.substr(0,2):"."+i.substr(2,r.length-1))):a(t.S,r.length);case 90:switch(r){case"[h]":case"[hh]":o=24*t.D+t.H;break;case"[m]":case"[mm]":o=60*(24*t.D+t.H)+t.M;break;case"[s]":case"[ss]":o=60*(60*(24*t.D+t.H)+t.M)+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}c=3===r.length?1:2;break;case 101:o=l,c=1}return c>0?a(o,c):""}function T(e){var r=3;if(e.length<=3)return e;for(var t=e.length%3,a=e.substr(0,t);t!=e.length;t+=3)a+=(a.length>0?",":"")+e.substr(t,3);return a}e._general_num=S,e._general=_;var y=function U(){var e=/%/g;function s(r,a,n){var i=a.replace(e,""),s=a.length-i.length;return y(r,i,n*Math.pow(10,2*s))+t("%",s)}function f(e,r,t){for(var a=r.length-1;44===r.charCodeAt(a-1);)--a;return y(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function l(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+l(e,-r);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),-1===(t=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n)).indexOf("e")){var s=Math.floor(Math.log(r)*Math.LOG10E);for(-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i);"0."===t.substr(0,2);)t=(t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,r,t,a){return r+t+a.substr(0,(n+i)%n)+"."+a.substr(i)+"E"}))}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var c=/# (\?+)( ?)\/( ?)(\d+)/;function u(e,r,i){var s=parseInt(e[4],10),f=Math.round(r*s),l=Math.floor(f/s),o=f-l*s,c=s;return i+(0===l?"":""+l)+" "+(0===o?t(" ",e[1].length+1+e[4].length):n(o,e[1].length)+e[2]+"/"+e[3]+a(c,e[4].length))}function h(e,r,a){return a+(0===r?"":""+r)+t(" ",e[1].length+2+e[4].length)}var d=/^#*0*\.([0#]+)/,v=/\).*[0#]/,m=/\(###\) ###\\?-####/;function b(e){for(var r="",t,a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function g(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function w(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?0:Math.round((e-Math.floor(e))*Math.pow(10,r))}function k(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function E(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}function S(e,h,_){if(40===e.charCodeAt(0)&&!h.match(v)){var C=h.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return _>=0?S("n",C,_):"("+S("n",C,-_)+")"}if(44===h.charCodeAt(h.length-1))return f(e,h,_);if(-1!==h.indexOf("%"))return s(e,h,_);if(-1!==h.indexOf("E"))return l(h,_);if(36===h.charCodeAt(0))return"$"+S(e,h.substr(" "==h.charAt(1)?2:1),_);var B,x,A,I,R=Math.abs(_),D=_<0?"-":"";if(h.match(/^00+$/))return D+o(R,h.length);if(h.match(/^[#?]+$/))return"0"===(B=o(_,0))&&(B=""),B.length>h.length?B:b(h.substr(0,h.length-B.length))+B;if(x=h.match(c))return u(x,R,D);if(h.match(/^#+0+$/))return D+o(R,h.length-h.indexOf("0"));if(x=h.match(d))return B=g(_,x[1].length).replace(/^([^\.]+)$/,"$1."+b(x[1])).replace(/\.$/,"."+b(x[1])).replace(/\.(\d*)$/,(function(e,r){return"."+r+t("0",b(x[1]).length-r.length)})),-1!==h.indexOf("0.")?B:B.replace(/^0\./,".");if(h=h.replace(/^#+([0.])/,"$1"),x=h.match(/^(0*)\.(#*)$/))return D+g(R,x[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,x[1].length?"0.":".");if(x=h.match(/^#{1,3},##0(\.?)$/))return D+T(o(R,0));if(x=h.match(/^#,##0\.([#0]*0)$/))return _<0?"-"+S(e,h,-_):T(""+(Math.floor(_)+k(_,x[1].length)))+"."+a(w(_,x[1].length),x[1].length);if(x=h.match(/^#,#*,#0/))return S(e,h.replace(/^#,#*,/,""),_);if(x=h.match(/^([0#]+)(\\?-([0#]+))+$/))return B=r(S(e,h.replace(/[\\-]/g,""),_)),A=0,r(r(h.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return A<B.length?B.charAt(A++):"0"===e?"0":""})));if(h.match(m))return"("+(B=S(e,"##########",_)).substr(0,3)+") "+B.substr(3,3)+"-"+B.substr(6);var F="";if(x=h.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return A=Math.min(x[4].length,7),I=p(R,Math.pow(10,A)-1,!1),B=""+D," "==(F=y("n",x[1],I[1])).charAt(F.length-1)&&(F=F.substr(0,F.length-1)+"0"),B+=F+x[2]+"/"+x[3],(F=i(I[2],A)).length<x[4].length&&(F=b(x[4].substr(x[4].length-F.length))+F),B+=F;if(x=h.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return A=Math.min(Math.max(x[1].length,x[4].length),7),D+((I=p(R,Math.pow(10,A)-1,!0))[0]||(I[1]?"":"0"))+" "+(I[1]?n(I[1],A)+x[2]+"/"+x[3]+i(I[2],A):t(" ",2*A+1+x[2].length+x[3].length));if(x=h.match(/^[#0?]+$/))return B=o(_,0),h.length<=B.length?B:b(h.substr(0,h.length-B.length))+B;if(x=h.match(/^([#0?]+)\.([#0]+)$/)){B=""+_.toFixed(Math.min(x[2].length,10)).replace(/([^0])0+$/,"$1"),A=B.indexOf(".");var O=h.indexOf(".")-A,P=h.length-B.length-O;return b(h.substr(0,O)+B+h.substr(h.length-P))}if(x=h.match(/^00,000\.([#0]*0)$/))return A=w(_,x[1].length),_<0?"-"+S(e,h,-_):T(E(_)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e}))+"."+a(A,x[1].length);switch(h){case"###,##0.00":return S(e,"#,##0.00",_);case"###,###":case"##,###":case"#,###":var N=T(o(R,0));return"0"!==N?D+N:"";case"###,###.00":return S(e,"###,##0.00",_).replace(/^0\./,".");case"#,###.00":return S(e,"#,##0.00",_).replace(/^0\./,".")}throw new Error("unsupported format |"+h+"|")}function _(e,r,t){for(var a=r.length-1;44===r.charCodeAt(a-1);)--a;return y(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function C(r,a,n){var i=a.replace(e,""),s=a.length-i.length;return y(r,i,n*Math.pow(10,2*s))+t("%",s)}function B(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+B(e,-r);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),!(t=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n)).match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,r,t,a){return r+t+a.substr(0,(n+i)%n)+"."+a.substr(i)+"E"}))}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function x(e,s,f){if(40===e.charCodeAt(0)&&!s.match(v)){var l=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return f>=0?x("n",l,f):"("+x("n",l,-f)+")"}if(44===s.charCodeAt(s.length-1))return _(e,s,f);if(-1!==s.indexOf("%"))return C(e,s,f);if(-1!==s.indexOf("E"))return B(s,f);if(36===s.charCodeAt(0))return"$"+x(e,s.substr(" "==s.charAt(1)?2:1),f);var o,u,g,w,k=Math.abs(f),E=f<0?"-":"";if(s.match(/^00+$/))return E+a(k,s.length);if(s.match(/^[#?]+$/))return o=""+f,0===f&&(o=""),o.length>s.length?o:b(s.substr(0,s.length-o.length))+o;if(u=s.match(c))return h(u,k,E);if(s.match(/^#+0+$/))return E+a(k,s.length-s.indexOf("0"));if(u=s.match(d))return o=(o=(""+f).replace(/^([^\.]+)$/,"$1."+b(u[1])).replace(/\.$/,"."+b(u[1]))).replace(/\.(\d*)$/,(function(e,r){return"."+r+t("0",b(u[1]).length-r.length)})),-1!==s.indexOf("0.")?o:o.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),u=s.match(/^(0*)\.(#*)$/))return E+(""+k).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".");if(u=s.match(/^#{1,3},##0(\.?)$/))return E+T(""+k);if(u=s.match(/^#,##0\.([#0]*0)$/))return f<0?"-"+x(e,s,-f):T(""+f)+"."+t("0",u[1].length);if(u=s.match(/^#,#*,#0/))return x(e,s.replace(/^#,#*,/,""),f);if(u=s.match(/^([0#]+)(\\?-([0#]+))+$/))return o=r(x(e,s.replace(/[\\-]/g,""),f)),g=0,r(r(s.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return g<o.length?o.charAt(g++):"0"===e?"0":""})));if(s.match(m))return"("+(o=x(e,"##########",f)).substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var S="";if(u=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(u[4].length,7),w=p(k,Math.pow(10,g)-1,!1),o=""+E," "==(S=y("n",u[1],w[1])).charAt(S.length-1)&&(S=S.substr(0,S.length-1)+"0"),o+=S+u[2]+"/"+u[3],(S=i(w[2],g)).length<u[4].length&&(S=b(u[4].substr(u[4].length-S.length))+S),o+=S;if(u=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(Math.max(u[1].length,u[4].length),7),E+((w=p(k,Math.pow(10,g)-1,!0))[0]||(w[1]?"":"0"))+" "+(w[1]?n(w[1],g)+u[2]+"/"+u[3]+i(w[2],g):t(" ",2*g+1+u[2].length+u[3].length));if(u=s.match(/^[#0?]+$/))return o=""+f,s.length<=o.length?o:b(s.substr(0,s.length-o.length))+o;if(u=s.match(/^([#0]+)\.([#0]+)$/)){o=""+f.toFixed(Math.min(u[2].length,10)).replace(/([^0])0+$/,"$1"),g=o.indexOf(".");var A=s.indexOf(".")-g,I=s.length-o.length-A;return b(s.substr(0,A)+o+s.substr(s.length-I))}if(u=s.match(/^00,000\.([#0]*0)$/))return f<0?"-"+x(e,s,-f):T(""+f).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e}))+"."+a(0,u[1].length);switch(s){case"###,###":case"##,###":case"#,###":var R=T(""+k);return"0"!==R?E+R:"";default:if(s.match(/\.[0#?]*$/))return x(e,s.slice(0,s.lastIndexOf(".")),f)+b(s.slice(s.lastIndexOf(".")))}throw new Error("unsupported format |"+s+"|")}return function A(e,r,t){return(0|t)===t?x(e,r,t):S(e,r,t)}}();function x(e){for(var r=[],t=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:t=!t;break;case 95:case 42:case 92:++a;break;case 59:r[r.length]=e.substr(n,a-n),n=a+1}if(r[r.length]=e.substr(n),!0===t)throw new Error("Format |"+e+"| unterminated string ");return r}e._split=x;var A=/\[[HhMmSs]*\]/;function I(e){for(var r=0,t="",a="";r<e.length;)switch(t=e.charAt(r)){case"G":c(e,r)&&(r+=6),r++;break;case'"':for(;34!==e.charCodeAt(++r)&&r<e.length;)++r;++r;break;case"\\":case"_":r+=2;break;case"@":++r;break;case"B":case"b":if("1"===e.charAt(r+1)||"2"===e.charAt(r+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===e.substr(r,3).toUpperCase())return!0;if("AM/PM"===e.substr(r,5).toUpperCase())return!0;++r;break;case"[":for(a=t;"]"!==e.charAt(r++)&&r<e.length;)a+=e.charAt(r);if(a.match(A))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||"\\"==t&&"-"==e.charAt(r+1)&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r," "!=e.charAt(r)&&"*"!=e.charAt(r)||++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":default:++r}return!1}function R(e,r,t,a){for(var n=[],i="",s=0,f="",l="t",o,u,h,d="H";s<e.length;)switch(f=e.charAt(s)){case"G":if(!c(e,s))throw new Error("unrecognized character "+f+" in "+e);n[n.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";34!==(h=e.charCodeAt(++s))&&s<e.length;)i+=String.fromCharCode(h);n[n.length]={t:"t",v:i},++s;break;case"\\":var v=e.charAt(++s),p="("===v||")"===v?v:"t";n[n.length]={t:p,v:v},++s;break;case"_":n[n.length]={t:"t",v:" "},s+=2;break;case"@":n[n.length]={t:"T",v:r},++s;break;case"B":case"b":if("1"===e.charAt(s+1)||"2"===e.charAt(s+1)){if(null==o&&null==(o=m(r,t,"2"===e.charAt(s+1))))return"";n[n.length]={t:"X",v:e.substr(s,2)},l=f,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0)return"";if(null==o&&null==(o=m(r,t)))return"";for(i=f;++s<e.length&&e.charAt(s).toLowerCase()===f;)i+=f;"m"===f&&"h"===l.toLowerCase()&&(f="M"),"h"===f&&(f=d),n[n.length]={t:f,v:i},l=f;break;case"A":case"a":var b={t:f,v:f};if(null==o&&(o=m(r,t)),"A/P"===e.substr(s,3).toUpperCase()?(null!=o&&(b.v=o.H>=12?"P":"A"),b.t="T",d="h",s+=3):"AM/PM"===e.substr(s,5).toUpperCase()?(null!=o&&(b.v=o.H>=12?"PM":"AM"),b.t="T",s+=5,d="h"):(b.t="t",++s),null==o&&"T"===b.t)return"";n[n.length]=b,l=f;break;case"[":for(i=f;"]"!==e.charAt(s++)&&s<e.length;)i+=e.charAt(s);if("]"!==i.slice(-1))throw'unterminated "[" block: |'+i+"|";if(i.match(A)){if(null==o&&null==(o=m(r,t)))return"";n[n.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",I(e)||(n[n.length]={t:"t",v:i}));break;case".":if(null!=o){for(i=f;++s<e.length&&"0"===(f=e.charAt(s));)i+=f;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=f;++s<e.length&&"0#?.,E+-%".indexOf(f=e.charAt(s))>-1||"\\"==f&&"-"==e.charAt(s+1)&&s<e.length-2&&"0#".indexOf(e.charAt(s+2))>-1;)i+=f;n[n.length]={t:"n",v:i};break;case"?":for(i=f;e.charAt(++s)===f;)i+=f;n[n.length]={t:f,v:i},l=f;break;case"*":++s," "!=e.charAt(s)&&"*"!=e.charAt(s)||++s;break;case"(":case")":n[n.length]={t:1===a?"t":f,v:f},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=f;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:f,v:f},++s;break;default:if(-1===",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(f))throw new Error("unrecognized character "+f+" in "+e);n[n.length]={t:"t",v:f},++s}var g=0,w=0,k;for(s=n.length-1,l="t";s>=0;--s)switch(n[s].t){case"h":case"H":n[s].t=d,l="h",g<1&&(g=1);break;case"s":(k=n[s].v.match(/\.0+$/))&&(w=Math.max(w,k[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=n[s].t;break;case"m":"s"===l&&(n[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[s].v.match(/[Hh]/)&&(g=1),g<2&&n[s].v.match(/[Mm]/)&&(g=2),g<3&&n[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M),o.M>=60&&(o.M=0,++o.H);break;case 2:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M)}var E="",S;for(s=0;s<n.length;++s)switch(n[s].t){case"t":case"T":case" ":case"D":break;case"X":n[s].v="",n[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[s].v=B(n[s].t.charCodeAt(0),n[s].v,o,w),n[s].t="t";break;case"n":case"(":case"?":for(S=s+1;null!=n[S]&&("?"===(f=n[S].t)||"D"===f||(" "===f||"t"===f)&&null!=n[S+1]&&("?"===n[S+1].t||"t"===n[S+1].t&&"/"===n[S+1].v)||"("===n[s].t&&(" "===f||"n"===f||")"===f)||"t"===f&&("/"===n[S].v||" "===n[S].v&&null!=n[S+1]&&"?"==n[S+1].t));)n[s].v+=n[S].v,n[S]={v:"",t:";"},++S;E+=n[s].v,s=S-1;break;case"G":n[s].t="t",n[s].v=_(r,t)}var C="",T,x;if(E.length>0){40==E.charCodeAt(0)?(T=r<0&&45===E.charCodeAt(0)?-r:r,x=y("(",E,T)):(x=y("n",E,T=r<0&&a>1?-r:r),T<0&&n[0]&&"t"==n[0].t&&(x=x.substr(1),n[0].v="-"+n[0].v)),S=x.length-1;var R=n.length;for(s=0;s<n.length;++s)if(null!=n[s]&&"t"!=n[s].t&&n[s].v.indexOf(".")>-1){R=s;break}var D=n.length;if(R===n.length&&-1===x.indexOf("E")){for(s=n.length-1;s>=0;--s)null!=n[s]&&-1!=="n?(".indexOf(n[s].t)&&(S>=n[s].v.length-1?(S-=n[s].v.length,n[s].v=x.substr(S+1,n[s].v.length)):S<0?n[s].v="":(n[s].v=x.substr(0,S+1),S=-1),n[s].t="t",D=s);S>=0&&D<n.length&&(n[D].v=x.substr(0,S+1)+n[D].v)}else if(R!==n.length&&-1===x.indexOf("E")){for(S=x.indexOf(".")-1,s=R;s>=0;--s)if(null!=n[s]&&-1!=="n?(".indexOf(n[s].t)){for(u=n[s].v.indexOf(".")>-1&&s===R?n[s].v.indexOf(".")-1:n[s].v.length-1,C=n[s].v.substr(u+1);u>=0;--u)S>=0&&("0"===n[s].v.charAt(u)||"#"===n[s].v.charAt(u))&&(C=x.charAt(S--)+C);n[s].v=C,n[s].t="t",D=s}for(S>=0&&D<n.length&&(n[D].v=x.substr(0,S+1)+n[D].v),S=x.indexOf(".")+1,s=R;s<n.length;++s)if(null!=n[s]&&(-1!=="n?(".indexOf(n[s].t)||s===R)){for(u=n[s].v.indexOf(".")>-1&&s===R?n[s].v.indexOf(".")+1:0,C=n[s].v.substr(0,u);u<n[s].v.length;++u)S<x.length&&(C+=x.charAt(S++));n[s].v=C,n[s].t="t",D=s}}}for(s=0;s<n.length;++s)null!=n[s]&&"n(?".indexOf(n[s].t)>-1&&(T=a>1&&r<0&&s>0&&"-"===n[s-1].v?-r:r,n[s].v=y(n[s].t,n[s].v,T),n[s].t="t");var F="";for(s=0;s!==n.length;++s)null!=n[s]&&(F+=n[s].v);return F}e.is_date=I,e._eval=R;var D=/\[[=<>]/,F=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function O(e,r){if(null==r)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0}return!1}function P(e,r){var t=x(e),a=t.length,n=t[a-1].indexOf("@");if(a<4&&n>-1&&--a,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if("number"!=typeof r)return[4,4===t.length||n>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"]}var i=r>0?t[0]:r<0?t[1]:t[2];if(-1===t[0].indexOf("[")&&-1===t[1].indexOf("["))return[a,i];if(null!=t[0].match(D)||null!=t[1].match(D)){var s=t[0].match(F),f=t[1].match(F);return O(r,s)?[a,t[0]]:O(r,f)?[a,t[1]]:[a,t[null!=s&&null!=f?2:1]]}return[a,i]}function N(e,r,t){null==t&&(t={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&t.dateNF?t.dateNF:e;break;case"number":a=14==e&&t.dateNF?t.dateNF:(null!=t.table?t.table:v)[e]}if(c(a,0))return _(r,t);r instanceof Date&&(r=k(r,t.date1904));var n=P(a,r);if(c(n[1]))return _(r,t);if(!0===r)r="TRUE";else if(!1===r)r="FALSE";else if(""===r||null==r)return"";return R(n[1],r,t,n[0])}function L(e,r){if("number"!=typeof r){r=+r||-1;for(var t=0;t<392;++t)if(null!=v[t]){if(v[t]==e){r=t;break}}else r<0&&(r=t);r<0&&(r=391)}return v[r]=e,r}e.load=L,e._table=v,e.get_table=function H(){return v},e.load_table=function W(e){for(var r=0;392!=r;++r)void 0!==e[r]&&L(e[r],r)},e.init_table=d,e.format=N};O(F);var P={"General Number":"General","General Date":F._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":F._table[15],"Short Date":F._table[14],"Long Time":F._table[19],"Medium Time":F._table[18],"Short Time":F._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:F._table[2],Standard:F._table[4],Percent:F._table[10],Scientific:F._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'},N={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},L=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function M(e){var r="number"==typeof e?F._table[e]:e;return r=r.replace(L,"(\\d+)"),new RegExp("^"+r+"$")}function U(e,r,t){var a=-1,n=-1,i=-1,s=-1,f=-1,l=-1;(r.match(L)||[]).forEach((function(e,r){var o=parseInt(t[r+1],10);switch(e.toLowerCase().charAt(0)){case"y":a=o;break;case"d":i=o;break;case"h":s=o;break;case"s":l=o;break;case"m":s>=0?f=o:n=o}})),l>=0&&-1==f&&n>=0&&(f=n,n=-1);var o=(""+(a>=0?a:(new Date).getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==o.length&&(o="0"+o),8==o.length&&(o="20"+o);var c=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==s&&-1==f&&-1==l?o:-1==a&&-1==n&&-1==i?c:o+"T"+c}var H=!0,W;!function(e){e(W={})}((function(e){function r(){for(var e=0,r=new Array(256),t=0;256!=t;++t)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=t)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,r[t]=e;return"undefined"!=typeof Int32Array?new Int32Array(r):r}e.version="1.2.0";var t=r();function a(e,r){for(var a=-1^r,n=e.length-1,i=0;i<n;)a=(a=a>>>8^t[255&(a^e.charCodeAt(i++))])>>>8^t[255&(a^e.charCodeAt(i++))];return i===n&&(a=a>>>8^t[255&(a^e.charCodeAt(i))]),-1^a}function n(e,r){if(e.length>1e4)return i(e,r);for(var a=-1^r,n=e.length-3,s=0;s<n;)a=(a=(a=(a=a>>>8^t[255&(a^e[s++])])>>>8^t[255&(a^e[s++])])>>>8^t[255&(a^e[s++])])>>>8^t[255&(a^e[s++])];for(;s<n+3;)a=a>>>8^t[255&(a^e[s++])];return-1^a}function i(e,r){for(var a=-1^r,n=e.length-7,i=0;i<n;)a=(a=(a=(a=(a=(a=(a=(a=a>>>8^t[255&(a^e[i++])])>>>8^t[255&(a^e[i++])])>>>8^t[255&(a^e[i++])])>>>8^t[255&(a^e[i++])])>>>8^t[255&(a^e[i++])])>>>8^t[255&(a^e[i++])])>>>8^t[255&(a^e[i++])])>>>8^t[255&(a^e[i++])];for(;i<n+7;)a=a>>>8^t[255&(a^e[i++])];return-1^a}function s(e,r){for(var a=-1^r,n=0,i=e.length,s,f;n<i;)(s=e.charCodeAt(n++))<128?a=a>>>8^t[255&(a^s)]:s<2048?a=(a=a>>>8^t[255&(a^(192|s>>6&31))])>>>8^t[255&(a^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),f=1023&e.charCodeAt(n++),a=(a=(a=(a=a>>>8^t[255&(a^(240|s>>8&7))])>>>8^t[255&(a^(128|s>>2&63))])>>>8^t[255&(a^(128|f>>6&15|(3&s)<<4))])>>>8^t[255&(a^(128|63&f))]):a=(a=(a=a>>>8^t[255&(a^(224|s>>12&15))])>>>8^t[255&(a^(128|s>>6&63))])>>>8^t[255&(a^(128|63&s))];return-1^a}e.table=t,e.bstr=a,e.buf=n,e.str=s}));var z=function lb(){var e={},f;function r(e,r){for(var t=e.split("/"),a=r.split("/"),n=0,i=0,s=Math.min(t.length,a.length);n<s;++n){if(i=t[n].length-a[n].length)return i;if(t[n]!=a[n])return t[n]<a[n]?-1:1}return t.length-a.length}function t(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:t(e.slice(0,-1));var r=e.lastIndexOf("/");return-1===r?e:e.slice(0,r+1)}function a(e){if("/"==e.charAt(e.length-1))return a(e.slice(0,-1));var r=e.lastIndexOf("/");return-1===r?e:e.slice(r+1)}function n(e,r){"string"==typeof r&&(r=new Date(r));var t=r.getHours();t=(t=t<<6|r.getMinutes())<<5|r.getSeconds()>>>1,e._W(2,t);var a=r.getFullYear()-1980;a=(a=a<<4|r.getMonth()+1)<<5|r.getDate(),e._W(2,a)}function i(e){var r=65535&e._R(2),t=65535&e._R(2),a=new Date,n=31&t,i=15&(t>>>=5);t>>>=4,a.setMilliseconds(0),a.setFullYear(t+1980),a.setMonth(i-1),a.setDate(n);var s=31&r,f=63&(r>>>=5);return r>>>=6,a.setHours(r),a.setMinutes(f),a.setSeconds(s<<1),a}function s(e){Kr(e,0);for(var r={},t=0;e.l<=e.length-4;){var a=e._R(2),n=e._R(2),i=e.l+n,s={};switch(a){case 21589:1&(t=e._R(1))&&(s.mtime=e._R(4)),n>5&&(2&t&&(s.atime=e._R(4)),4&t&&(s.ctime=e._R(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime))}e.l=i,r[a]=s}return r}function l(){return f||(f=require("fs"))}function o(e,r){if(80==e[0]&&75==e[1])return Te(e,r);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var t=3,a=512,n=0,i=0,s=0,f=0,l=0,o=[],v=e.slice(0,512);Kr(v,0);var m=c(v);switch(t=m[0]){case 3:a=512;break;case 4:a=4096;break;case 0:if(0==m[1])return Te(e,r);default:throw new Error("Major Version: Expected 3 or 4 saw "+t)}512!==a&&Kr(v=e.slice(0,a),28);var g=e.slice(0,a);u(v,t);var w=v._R(4,"i");if(3===t&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);v.l+=4,s=v._R(4,"i"),v.l+=4,v.chk("00100000","Mini Stream Cutoff Size: "),f=v._R(4,"i"),n=v._R(4,"i"),l=v._R(4,"i"),i=v._R(4,"i");for(var E=-1,S=0;S<109&&!((E=v._R(4,"i"))<0);++S)o[S]=E;var _=h(e,a);p(l,i,_,a,o);var C=b(_,s,o,a);C[s].name="!Directory",n>0&&f!==N&&(C[f].name="!MiniFAT"),C[o[0]].name="!FAT",C.fat_addrs=o,C.ssz=a;var B,T=[],y=[],x=[];k(s,C,_,T,n,{},y,f),d(y,x,T),T.shift();var A={FileIndex:y,FullPaths:x};return r&&r.raw&&(A.raw={header:g,sectors:_}),A}function c(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(L,"Header Signature: "),e.l+=16;var r=e._R(2,"u");return[e._R(2,"u"),r]}function u(e,r){var t=9;switch(e.l+=2,t=e._R(2)){case 9:if(3!=r)throw new Error("Sector Shift: Expected 9 saw "+t);break;case 12:if(4!=r)throw new Error("Sector Shift: Expected 12 saw "+t);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+t)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}function h(e,r){for(var t=Math.ceil(e.length/r)-1,a=[],n=1;n<t;++n)a[n-1]=e.slice(n*r,(n+1)*r);return a[t-1]=e.slice(t*r),a}function d(e,r,t){for(var a=0,n=0,i=0,s=0,f=0,l=t.length,o=[],c=[];a<l;++a)o[a]=c[a]=a,r[a]=t[a];for(;f<c.length;++f)n=e[a=c[f]].L,i=e[a].R,s=e[a].C,o[a]===a&&(-1!==n&&o[n]!==n&&(o[a]=o[n]),-1!==i&&o[i]!==i&&(o[a]=o[i])),-1!==s&&(o[s]=a),-1!==n&&a!=o[a]&&(o[n]=o[a],c.lastIndexOf(n)<f&&c.push(n)),-1!==i&&a!=o[a]&&(o[i]=o[a],c.lastIndexOf(i)<f&&c.push(i));for(a=1;a<l;++a)o[a]===a&&(-1!==i&&o[i]!==i?o[a]=o[i]:-1!==n&&o[n]!==n&&(o[a]=o[n]));for(a=1;a<l;++a)if(0!==e[a].type){if((f=a)!=o[f])do{f=o[f],r[a]=r[f]+"/"+r[a]}while(0!==f&&-1!==o[f]&&f!=o[f]);o[a]=-1}for(r[0]+="/",a=1;a<l;++a)2!==e[a].type&&(r[a]+="/")}function v(e,r,t){for(var a=e.start,n=e.size,i=[],s=a;t&&n>0&&s>=0;)i.push(r.slice(s*P,s*P+P)),n-=P,s=Ur(t,4*s);return 0===i.length?$r(0):I(i).slice(0,e.size)}function p(e,r,t,a,n){var i=N;if(e===N){if(0!==r)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=t[e],f=(a>>>2)-1;if(!s)return;for(var l=0;l<f&&(i=Ur(s,4*l))!==N;++l)n.push(i);p(Ur(s,a-4),r-1,t,a,n)}}function m(e,r,t,a,n){var i=[],s=[];n||(n=[]);var f=a-1,l=0,o=0;for(l=r;l>=0;){n[l]=!0,i[i.length]=l,s.push(e[l]);var c=t[Math.floor(4*l/a)];if(a<4+(o=4*l&f))throw new Error("FAT boundary crossed: "+l+" 4 "+a);if(!e[c])break;l=Ur(e[c],o)}return{nodes:i,data:vr([s])}}function b(e,r,t,a){var n=e.length,i=[],s=[],f=[],l=[],o=a-1,c=0,u=0,h=0,d=0;for(c=0;c<n;++c)if(f=[],(h=c+r)>=n&&(h-=n),!s[h]){for(l=[],u=h;u>=0;){s[u]=!0,f[f.length]=u,l.push(e[u]);var v=t[Math.floor(4*u/a)];if(a<4+(d=4*u&o))throw new Error("FAT boundary crossed: "+u+" 4 "+a);if(!e[v])break;u=Ur(e[v],d)}i[h]={nodes:f,data:vr([l])}}return i}function k(e,r,t,a,n,i,s,f){for(var l=0,o=a.length?2:0,c=r[e].data,u=0,h=0,d;u<c.length;u+=128){var p=c.slice(u,u+128);Kr(p,64),h=p._R(2),d=mr(p,0,h-o),a.push(d);var b={name:d,type:p._R(1),color:p._R(1),L:p._R(4,"i"),R:p._R(4,"i"),C:p._R(4,"i"),clsid:p._R(16),state:p._R(4,"i"),start:0,size:0},g,w;0!==p._R(2)+p._R(2)+p._R(2)+p._R(2)&&(b.ct=E(p,p.l-8)),0!==p._R(2)+p._R(2)+p._R(2)+p._R(2)&&(b.mt=E(p,p.l-8)),b.start=p._R(4,"i"),b.size=p._R(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=N,b.name=""),5===b.type?(l=b.start,n>0&&l!==N&&(r[l].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===r[b.start]&&(r[b.start]=m(t,b.start,r.fat_addrs,r.ssz)),r[b.start].name=b.name,b.content=r[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:l!==N&&b.start!==N&&r[l]&&(b.content=v(b,r[l].data,(r[f]||{}).data))),b.content&&Kr(b.content,0),i[d]=b,s.push(b)}}function E(e,r){return new Date(1e3*(Mr(e,r+4)/1e7*Math.pow(2,32)+Mr(e,r)/1e7-11644473600))}function S(e,r){return l(),o(f.readFileSync(e),r)}function T(e,r){switch(r&&r.type||"base64"){case"file":return S(e,r);case"base64":return o(B(g.decode(e)),r);case"binary":return o(B(e),r)}return o(e,r)}function y(e,r){var t=r||{},a=t.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=a+"/",e.FileIndex[0]={name:a,type:5}),t.CLSID&&(e.FileIndex[0].clsid=t.CLSID),x(e)}function x(e){var r="Sh33tJ5";if(!z.find(e,"/"+r)){var t=$r(4);t[0]=55,t[1]=t[3]=50,t[2]=54,e.FileIndex.push({name:r,type:2,content:t,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+r),A(e)}}function A(e,n){y(e);for(var i=!1,s=!1,f=e.FullPaths.length-1;f>=0;--f){var l=e.FileIndex[f];switch(l.type){case 0:s?i=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(l.R*l.L*l.C)&&(i=!0),l.R>-1&&l.L>-1&&l.R==l.L&&(i=!0);break;default:i=!0}}if(i||n){var o=new Date(1987,1,19),c=0,u=[];for(f=0;f<e.FullPaths.length;++f)0!==e.FileIndex[f].type&&u.push([e.FullPaths[f],e.FileIndex[f]]);for(f=0;f<u.length;++f){var h=t(u[f][0]);for(s=!1,c=0;c<u.length;++c)u[c][0]===h&&(s=!0);s||u.push([h,{name:a(h).replace("/",""),type:1,clsid:U,ct:o,mt:o,content:null}])}for(u.sort((function(e,t){return r(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],f=0;f<u.length;++f)e.FullPaths[f]=u[f][0],e.FileIndex[f]=u[f][1];for(f=0;f<u.length;++f){var d=e.FileIndex[f],v=e.FullPaths[f];if(d.name=a(v).replace("/",""),d.L=d.R=d.C=-(d.color=1),d.size=d.content?d.content.length:0,d.start=0,d.clsid=d.clsid||U,0===f)d.C=u.length>1?1:-1,d.size=0,d.type=5;else if("/"==v.slice(-1)){for(c=f+1;c<u.length&&t(e.FullPaths[c])!=v;++c);for(d.C=c>=u.length?-1:c,c=f+1;c<u.length&&t(e.FullPaths[c])!=t(v);++c);d.R=c>=u.length?-1:c,d.type=1}else t(e.FullPaths[f+1]||"")==t(v)&&(d.R=f+1),d.type=2}}}function F(e,r){var t=r||{};if(A(e),"zip"==t.fileType)return xe(e,t);var a=function(e){for(var r=0,t=0,a=0;a<e.FileIndex.length;++a){var n=e.FileIndex[a];if(n.content){var i=n.content.length;i>0&&(i<4096?r+=i+63>>6:t+=i+511>>9)}}for(var s=e.FullPaths.length+3>>2,f,l=r+127>>7,o=(r+7>>3)+t+s+l,c=o+127>>7,u=c<=109?0:Math.ceil((c-109)/127);o+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var h=[1,u,c,l,s,t,r,0];return e.FileIndex[0].size=r<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),n=$r(a[7]<<9),i=0,s=0;for(i=0;i<8;++i)n._W(1,M[i]);for(i=0;i<8;++i)n._W(2,0);for(n._W(2,62),n._W(2,3),n._W(2,65534),n._W(2,9),n._W(2,6),i=0;i<3;++i)n._W(2,0);for(n._W(4,0),n._W(4,a[2]),n._W(4,a[0]+a[1]+a[2]+a[3]-1),n._W(4,0),n._W(4,4096),n._W(4,a[3]?a[0]+a[1]+a[2]-1:N),n._W(4,a[3]),n._W(-4,a[1]?a[0]-1:N),n._W(4,a[1]),i=0;i<109;++i)n._W(-4,i<a[2]?a[1]+i:-1);if(a[1])for(s=0;s<a[1];++s){for(;i<236+127*s;++i)n._W(-4,i<a[2]?a[1]+i:-1);n._W(-4,s===a[1]-1?N:s+1)}var f=function(e){for(s+=e;i<s-1;++i)n._W(-4,i+1);e&&(++i,n._W(-4,N))};for(s=i=0,s+=a[1];i<s;++i)n._W(-4,H.DIFSECT);for(s+=a[2];i<s;++i)n._W(-4,H.FATSECT);f(a[3]),f(a[4]);for(var l=0,o=0,c=e.FileIndex[0];l<e.FileIndex.length;++l)(c=e.FileIndex[l]).content&&((o=c.content.length)<4096||(c.start=s,f(o+511>>9)));for(f(a[6]+7>>3);511&n.l;)n._W(-4,H.ENDOFCHAIN);for(s=i=0,l=0;l<e.FileIndex.length;++l)(c=e.FileIndex[l]).content&&(!(o=c.content.length)||o>=4096||(c.start=s,f(o+63>>6)));for(;511&n.l;)n._W(-4,H.ENDOFCHAIN);for(i=0;i<a[4]<<2;++i){var u=e.FullPaths[i];if(u&&0!==u.length){c=e.FileIndex[i],0===i&&(c.start=c.size?c.start-1:N);var h=0===i&&t.root||c.name;if(o=2*(h.length+1),n._W(64,h,"utf16le"),n._W(2,o),n._W(1,c.type),n._W(1,c.color),n._W(-4,c.L),n._W(-4,c.R),n._W(-4,c.C),c.clsid)n._W(16,c.clsid,"hex");else for(l=0;l<4;++l)n._W(4,0);n._W(4,c.state||0),n._W(4,0),n._W(4,0),n._W(4,0),n._W(4,0),n._W(4,c.start),n._W(4,c.size),n._W(4,0)}else{for(l=0;l<17;++l)n._W(4,0);for(l=0;l<3;++l)n._W(4,-1);for(l=0;l<12;++l)n._W(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((c=e.FileIndex[i]).size>=4096){for(n.l=c.start+1<<9,l=0;l<c.size;++l)n._W(1,c.content[l]);for(;511&l;++l)n._W(1,0)}for(i=1;i<e.FileIndex.length;++i)if((c=e.FileIndex[i]).size>0&&c.size<4096){for(l=0;l<c.size;++l)n._W(1,c.content[l]);for(;63&l;++l)n._W(1,0)}for(;n.l<n.length;)n._W(1,0);return n}function O(e,r){var t=e.FullPaths.map((function(e){return e.toUpperCase()})),a=t.map((function(e){var r=e.split("/");return r[r.length-("/"==e.slice(-1)?2:1)]})),n=!1;47===r.charCodeAt(0)?(n=!0,r=t[0].slice(0,-1)+r):n=-1!==r.indexOf("/");var i=r.toUpperCase(),s=!0===n?t.indexOf(i):a.indexOf(i);if(-1!==s)return e.FileIndex[s];var f=!i.match(D);for(i=i.replace(R,""),f&&(i=i.replace(D,"!")),s=0;s<t.length;++s){if((f?t[s].replace(D,"!"):t[s]).replace(R,"")==i)return e.FileIndex[s];if((f?a[s].replace(D,"!"):a[s]).replace(R,"")==i)return e.FileIndex[s]}return null}e.version="1.1.3";var P=64,N=-2,L="d0cf11e0a1b11ae1",M=[208,207,17,224,161,177,26,225],U="00000000000000000000000000000000",H={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:L,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:U,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]},j;function V(e,r,t){l();var a=F(e,t);f.writeFileSync(r,a)}function X(e){for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function G(e,r){var t=F(e,r);switch(r&&r.type){case"file":return l(),f.writeFileSync(r.filename,t),t;case"binary":return X(t);case"base64":return g.encode(X(t))}return t}function K(e){try{var r,t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");j=e}catch(a){console.error("cannot use native zlib: "+(a.message||a))}}function Y(e,r){if(!j)return Ce(e,r);var t,a=new(0,j.InflateRaw),n=a._processChunk(e.slice(e.l),a._finishFlushFlag);return e.l+=a.bytesRead,n}function $(e){return j?j.deflateRawSync(e):he(e)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function q(e){var r=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(r>>16|r>>8|r)}for(var ee="undefined"!=typeof Uint8Array,re=ee?new Uint8Array(256):[],te=0;te<256;++te)re[te]=q(te);function ae(e,r){var t=re[255&e];return r<=8?t>>>8-r:(t=t<<8|re[e>>8&255],r<=16?t>>>16-r:(t=t<<8|re[e>>16&255])>>>24-r)}function ne(e,r){var t=7&r,a=r>>>3;return(e[a]|(t<=6?0:e[a+1]<<8))>>>t&3}function ie(e,r){var t=7&r,a=r>>>3;return(e[a]|(t<=5?0:e[a+1]<<8))>>>t&7}function se(e,r){var t=7&r,a=r>>>3;return(e[a]|(t<=4?0:e[a+1]<<8))>>>t&15}function fe(e,r){var t=7&r,a=r>>>3;return(e[a]|(t<=3?0:e[a+1]<<8))>>>t&31}function le(e,r){var t=7&r,a=r>>>3;return(e[a]|(t<=1?0:e[a+1]<<8))>>>t&127}function oe(e,r,t){var a=7&r,n=r>>>3,i=(1<<t)-1,s=e[n]>>>a;return t<8-a?s&i:(s|=e[n+1]<<8-a,t<16-a?s&i:(s|=e[n+2]<<16-a,t<24-a?s&i:(s|=e[n+3]<<24-a)&i))}function ce(e,r){var t=e.length,a=2*t>r?2*t:r+5,n=0;if(t>=r)return e;if(w){var i=C(a);if(e.copy)e.copy(i);else for(;n<e.length;++n)i[n]=e[n];return i}if(ee){var s=new Uint8Array(a);if(s.set)s.set(e);else for(;n<e.length;++n)s[n]=e[n];return s}return e.length=a,e}function ue(e){for(var r=new Array(e),t=0;t<e;++t)r[t]=0;return r}var he=function(){var e=function e(r,t){for(var a=0;a<r.length;){var n=Math.min(65535,r.length-a),i=a+n==r.length;for(t._W(1,+i),t._W(2,n),t._W(2,65535&~n);n-- >0;)t[t.l++]=r[a++]}return t.l};return function(r){var t=$r(50+Math.floor(1.1*r.length)),a=e(r,t);return t.slice(0,a)}}();function de(e,r,t){var a=1,n=0,i=0,s=0,f=0,l=e.length,o=ee?new Uint16Array(32):ue(32);for(i=0;i<32;++i)o[i]=0;for(i=l;i<t;++i)e[i]=0;l=e.length;var c=ee?new Uint16Array(l):ue(l);for(i=0;i<l;++i)o[n=e[i]]++,a<n&&(a=n),c[i]=0;for(o[0]=0,i=1;i<=a;++i)o[i+16]=f=f+o[i-1]<<1;for(i=0;i<l;++i)0!=(f=e[i])&&(c[i]=o[f+16]++);var u=0;for(i=0;i<l;++i)if(0!=(u=e[i]))for(f=ae(c[i],a)>>a-u,s=(1<<a+4-u)-1;s>=0;--s)r[f|s<<u]=15&u|i<<4;return a}var ve=ee?new Uint16Array(512):ue(512),pe=ee?new Uint16Array(32):ue(32);if(!ee){for(var me=0;me<512;++me)ve[me]=0;for(me=0;me<32;++me)pe[me]=0}!function(){for(var e=[],r=0;r<32;r++)e.push(5);de(e,pe,32);var t=[];for(r=0;r<=143;r++)t.push(8);for(;r<=255;r++)t.push(9);for(;r<=279;r++)t.push(7);for(;r<=287;r++)t.push(8);de(t,ve,288)}();var be=ee?new Uint16Array(32768):ue(32768),ge=ee?new Uint16Array(32768):ue(32768),we=ee?new Uint16Array(128):ue(128),ke=1,Ee=1;function Se(e,r){var t=fe(e,r)+257,a=fe(e,r+=5)+1,n=se(e,r+=5)+4;r+=4;for(var i=0,s=ee?new Uint8Array(19):ue(19),f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,o=ee?new Uint8Array(8):ue(8),c=ee?new Uint8Array(8):ue(8),u=s.length,h=0;h<n;++h)s[Z[h]]=i=ie(e,r),l<i&&(l=i),o[i]++,r+=3;var d=0;for(o[0]=0,h=1;h<=l;++h)c[h]=d=d+o[h-1]<<1;for(h=0;h<u;++h)0!=(d=s[h])&&(f[h]=c[d]++);var v=0;for(h=0;h<u;++h)if(0!=(v=s[h])){d=re[f[h]]>>8-v;for(var p=(1<<7-v)-1;p>=0;--p)we[d|p<<v]=7&v|h<<3}var m=[];for(l=1;m.length<t+a;)switch(r+=7&(d=we[le(e,r)]),d>>>=3){case 16:for(i=3+ne(e,r),r+=2,d=m[m.length-1];i-- >0;)m.push(d);break;case 17:for(i=3+ie(e,r),r+=3;i-- >0;)m.push(0);break;case 18:for(i=11+le(e,r),r+=7;i-- >0;)m.push(0);break;default:m.push(d),l<d&&(l=d)}var b=m.slice(0,t),g=m.slice(t);for(h=t;h<286;++h)b[h]=0;for(h=a;h<30;++h)g[h]=0;return ke=de(b,be,286),Ee=de(g,ge,30),r}function _e(e,r){if(3==e[0]&&!(3&e[1]))return[_(r),2];for(var t=0,a=0,n=C(r||1<<18),i=0,s=n.length>>>0,f=0,l=0;0==(1&a);)if(a=ie(e,t),t+=3,a>>>1!=0)for(a>>>1==1?(f=9,l=5):(t=Se(e,t),f=ke,l=Ee),!r&&s<i+32767&&(s=(n=ce(n,i+32767)).length);;){var c=oe(e,t,f),u=a>>>1==1?ve[c]:be[c];if(t+=15&u,0==((u>>>=4)>>>8&255))n[i++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var d=i+Q[u];h>0&&(d+=oe(e,t,h),t+=h),c=oe(e,t,l),t+=15&(u=a>>>1==1?pe[c]:ge[c]);var v=(u>>>=4)<4?0:u-2>>1,p=J[u];for(v>0&&(p+=oe(e,t,v),t+=v),!r&&s<d&&(s=(n=ce(n,d)).length);i<d;)n[i]=n[i-p],++i}}else{7&t&&(t+=8-(7&t));var o=e[t>>>3]|e[1+(t>>>3)]<<8;if(t+=32,!r&&s<i+o&&(s=(n=ce(n,i+o)).length),"function"==typeof e.copy)e.copy(n,i,t>>>3,(t>>>3)+o),i+=o,t+=8*o;else for(;o-- >0;)n[i++]=e[t>>>3],t+=8}return[r?n:n.slice(0,i),t+7>>>3]}function Ce(e,r){var t,a=_e(e.slice(e.l||0),r);return e.l+=a[1],a[0]}function Be(e,r){if(!e)throw new Error(r);"undefined"!=typeof console&&console.error(r)}function Te(e,r){var t=e;Kr(t,0);var a,n,i={FileIndex:[],FullPaths:[]};y(i,{root:r.root});for(var f=t.length-4;(80!=t[f]||75!=t[f+1]||5!=t[f+2]||6!=t[f+3])&&f>=0;)--f;t.l=f+4,t.l+=4;var l=t._R(2);t.l+=6;var o=t._R(4);for(t.l=o,f=0;f<l;++f){t.l+=20;var c=t._R(4),u=t._R(4),h=t._R(2),d=t._R(2),v=t._R(2);t.l+=8;var p=t._R(4),m=s(t.slice(t.l+h,t.l+h+d));t.l+=h+d+v;var b=t.l;t.l=p+4,ye(t,c,u,i,m),t.l=b}return i}function ye(e,r,t,a,n){e.l+=2;var f=e._R(2),l=e._R(2),o=i(e);if(8257&f)throw new Error("Unsupported ZIP encryption");for(var c=e._R(4),u=e._R(4),h=e._R(4),d=e._R(2),v=e._R(2),p="",m=0;m<d;++m)p+=String.fromCharCode(e[e.l++]);if(v){var b=s(e.slice(e.l,e.l+v));(b[21589]||{}).mt&&(o=b[21589].mt),((n||{})[21589]||{}).mt&&(o=n[21589].mt)}e.l+=v;var g=e.slice(e.l,e.l+u);switch(l){case 8:g=Y(e,h);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+l)}var w=!1;8&f&&(134695760==(c=e._R(4))&&(c=e._R(4),w=!0),u=e._R(4),h=e._R(4)),u!=r&&Be(w,"Bad compressed size: "+r+" != "+u),h!=t&&Be(w,"Bad uncompressed size: "+t+" != "+h);var k=W.buf(g,0);c>>0!=k>>0&&Be(w,"Bad CRC32 checksum: "+c+" != "+k),Ie(a,p,g,{unsafe:!0,mt:o})}function xe(e,r){var t=r||{},a=[],i=[],s=$r(1),f=t.compression?8:0,l=0,o=!1;var c=0,u=0,h=0,d=0,v=e.FullPaths[0],p=v,m=e.FileIndex[0],b=[],g=0;for(c=1;c<e.FullPaths.length;++c)if(p=e.FullPaths[c].slice(v.length),(m=e.FileIndex[c]).size&&m.content&&"Sh33tJ5"!=p){var w=h,k=$r(p.length);for(u=0;u<p.length;++u)k._W(1,127&p.charCodeAt(u));k=k.slice(0,k.l),b[d]=W.buf(m.content,0);var E=m.content;8==f&&(E=$(E)),(s=$r(30))._W(4,67324752),s._W(2,20),s._W(2,l),s._W(2,f),m.mt?n(s,m.mt):s._W(4,0),s._W(-4,8&l?0:b[d]),s._W(4,8&l?0:E.length),s._W(4,8&l?0:m.content.length),s._W(2,k.length),s._W(2,0),h+=s.length,a.push(s),h+=k.length,a.push(k),h+=E.length,a.push(E),8&l&&((s=$r(12))._W(-4,b[d]),s._W(4,E.length),s._W(4,m.content.length),h+=s.l,a.push(s)),(s=$r(46))._W(4,33639248),s._W(2,0),s._W(2,20),s._W(2,l),s._W(2,f),s._W(4,0),s._W(-4,b[d]),s._W(4,E.length),s._W(4,m.content.length),s._W(2,k.length),s._W(2,0),s._W(2,0),s._W(2,0),s._W(2,0),s._W(4,0),s._W(4,w),g+=s.l,i.push(s),g+=k.length,i.push(k),++d}return(s=$r(22))._W(4,101010256),s._W(2,0),s._W(2,0),s._W(2,d),s._W(2,d),s._W(4,g),s._W(4,h),s._W(2,0),I([I(a),I(i),s])}function Ae(e){var r={};return y(r,e),r}function Ie(e,r,t,n){var i=n&&n.unsafe;i||y(e);var s=!i&&z.find(e,r);if(!s){var f=e.FullPaths[0];r.slice(0,f.length)==f?f=r:("/"!=f.slice(-1)&&(f+="/"),f=(f+r).replace("//","/")),s={name:a(r),type:2},e.FileIndex.push(s),e.FullPaths.push(f),i||z.utils.cfb_gc(e)}return s.content=t,s.size=t?t.length:0,n&&(n.CLSID&&(s.clsid=n.CLSID),n.mt&&(s.mt=n.mt),n.ct&&(s.ct=n.ct)),s}function Re(e,r){y(e);var t=z.find(e,r);if(t)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==t)return e.FileIndex.splice(a,1),e.FullPaths.splice(a,1),!0;return!1}function De(e,r,t){y(e);var n=z.find(e,r);if(n)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==n)return e.FileIndex[i].name=a(t),e.FullPaths[i]=t,!0;return!1}function Fe(e){A(e,!0)}return e.find=O,e.read=T,e.parse=o,e.write=G,e.writeFile=V,e.utils={cfb_new:Ae,cfb_add:Ie,cfb_del:Re,cfb_mov:De,cfb_gc:Fe,ReadShift:Wr,CheckField:jr,prep_blob:Kr,bconcat:I,use_zlib:K,_deflateRaw:he,_inflateRaw:Ce,consts:H},e}(),V;if("undefined"!=typeof require)try{V=require("fs")}catch(S){}function X(e){return"string"==typeof e?T(e):Array.isArray(e)?x(e):e}function G(e,r,t){if(void 0!==V&&V.writeFileSync)return t?V.writeFileSync(e,r,t):V.writeFileSync(e,r);var a="utf8"==t?Ye(r):r;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(a,e);if("undefined"!=typeof Blob){var n=new Blob([X(a)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if("undefined"!=typeof saveAs)return saveAs(n,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(i)}),6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(i)}),6e4),i}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var f=File(e);return f.open("w"),f.encoding="binary",Array.isArray(r)&&(r=y(r)),f.write(r),f.close(),r}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function j(e){if(void 0!==V)return V.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function K(e){for(var r=Object.keys(e),t=[],a=0;a<r.length;++a)e.hasOwnProperty(r[a])&&t.push(r[a]);return t}function Y(e,r){for(var t=[],a=K(e),n=0;n!==a.length;++n)null==t[e[a[n]][r]]&&(t[e[a[n]][r]]=a[n]);return t}function Z(e){for(var r=[],t=K(e),a=0;a!==t.length;++a)r[e[t[a]]]=t[a];return r}function Q(e){for(var r=[],t=K(e),a=0;a!==t.length;++a)r[e[t[a]]]=parseInt(t[a],10);return r}function J(e){for(var r=[],t=K(e),a=0;a!==t.length;++a)null==r[e[t[a]]]&&(r[e[t[a]]]=[]),r[e[t[a]]].push(t[a]);return r}var q=new Date(1899,11,30,0,0,0),ee=q.getTime()+6e4*((new Date).getTimezoneOffset()-q.getTimezoneOffset());function re(e,r){var t=e.getTime();return r&&(t-=1263168e5),(t-ee)/864e5}function te(e){var r=new Date;return r.setTime(24*e*60*60*1e3+ee),r}function ae(e){var r=0,t=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(t=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":t*=24;case"H":t*=60;case"M":if(!a)throw new Error("Unsupported ISO Duration Field: M");t*=60}r+=t*parseInt(n[i],10)}return r}var ne=new Date("2017-02-19T19:06:09.000Z");isNaN(ne.getFullYear())&&(ne=new Date("2/19/17"));var ie=2017==ne.getFullYear();function se(e,r){var t=new Date(e);if(ie)return r>0?t.setTime(t.getTime()+60*t.getTimezoneOffset()*1e3):r<0&&t.setTime(t.getTime()-60*t.getTimezoneOffset()*1e3),t;if(e instanceof Date)return e;if(1917==ne.getFullYear()&&!isNaN(t.getFullYear())){var a=t.getFullYear();return e.indexOf(""+a)>-1?t:(t.setFullYear(t.getFullYear()+100),t)}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function fe(e){for(var r="",t=0;t!=e.length;++t)r+=String.fromCharCode(e[t]);return r}function le(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)e.hasOwnProperty(t)&&(r[t]=le(e[t]));return r}function oe(e,r){for(var t="";t.length<r;)t+=e;return t}function ce(e){var r=Number(e);if(!isNaN(r))return r;var t=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return t*=100,""}));return isNaN(r=Number(a))?(a=a.replace(/[(](.*)[)]/,(function(e,r){return t=-t,r})),isNaN(r=Number(a))?r:r/t):r/t}function ue(e){var r=new Date(e),t=new Date(NaN),a=r.getYear(),n=r.getMonth(),i=r.getDate();return isNaN(i)?t:a<0||a>8099?t:(n>0||i>1)&&101!=a?r:e.toLowerCase().match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)?r:e.match(/[^-0-9:,\/\\]/)?t:r}var he=5=="abacaba".split(/(:?b)/i).length,_e;function de(e,r,t){if(he||"string"==typeof r)return e.split(r);for(var a=e.split(r),n=[a[0]],i=1;i<a.length;++i)n.push(t),n.push(a[i]);return n}function ve(e){return e?e.data?d(e.data):e.asNodeBuffer&&w?d(e.asNodeBuffer().toString("binary")):e.asBinary?d(e.asBinary()):e._data&&e._data.getContent?d(fe(Array.prototype.slice.call(e._data.getContent(),0))):e.content&&e.type?d(fe(e.content)):null:null}function pe(e){if(!e)return null;if(e.data)return c(e.data);if(e.asNodeBuffer&&w)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return"string"==typeof r?c(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function me(e){return e&&".bin"===e.name.slice(-4)?pe(e):ve(e)}function be(e,r){for(var t=e.FullPaths||K(e.files),a=r.toLowerCase(),n=a.replace(/\//g,"\\"),i=0;i<t.length;++i){var s=t[i].toLowerCase();if(a==s||n==s)return e.files[t[i]]}return null}function ge(e,r){var t=be(e,r);if(null==t)throw new Error("Cannot find file "+r+" in zip");return t}function we(e,r,t){if(!t)return me(ge(e,r));if(!r)return null;try{return we(e,r)}catch(a){return null}}function ke(e,r,t){if(!t)return ve(ge(e,r));if(!r)return null;try{return ke(e,r)}catch(a){return null}}function Ee(e){for(var r=e.FullPaths||K(e.files),t=[],a=0;a<r.length;++a)"/"!=r[a].slice(-1)&&t.push(r[a]);return t.sort()}function Se(e,r,t){e.FullPaths?z.utils.cfb_add(e,r,t):e.file(r,t)}function Ce(){return _e?new _e:z.utils.cfb_new()}function Be(e,r){var t;if(_e)switch(r.type){case"base64":t=new _e(e,{base64:!0});break;case"binary":case"array":t=new _e(e,{base64:!1});break;case"buffer":t=new _e(e);break;default:throw new Error("Unrecognized type "+r.type)}else switch(r.type){case"base64":t=z.read(e,{type:"base64"});break;case"binary":t=z.read(e,{type:"binary"});break;case"buffer":case"array":t=z.read(e,{type:"buffer"});break;default:throw new Error("Unrecognized type "+r.type)}return t}function Te(e,r){if("/"==e.charAt(0))return e.slice(1);var t=r.split("/");"/"!=r.slice(-1)&&t.pop();for(var a=e.split("/");0!==a.length;){var n=a.shift();".."===n?t.pop():"."!==n&&t.push(n)}return t.join("/")}"undefined"!=typeof JSZipSync&&(_e=JSZipSync),"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&void 0===_e&&(_e=void 0);var ye='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',xe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ae=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s?[\/\?]?>/g;ye.match(Ae)||(Ae=/<[^>]*>/g);var Ie=/<\w*:/,Re=/<(\/?)\w+:/;function De(e,r,t){for(var a={},n=0,i=0;n!==e.length&&(32!==(i=e.charCodeAt(n))&&10!==i&&13!==i);++n);if(r||(a[0]=e.slice(0,n)),n===e.length)return a;var s=e.match(xe),f=0,l="",o=0,c="",u="",h=1;if(s)for(o=0;o!=s.length;++o){for(u=s[o],i=0;i!=u.length&&61!==u.charCodeAt(i);++i);for(c=u.slice(0,i).trim();32==u.charCodeAt(i+1);)++i;for(h=34==(n=u.charCodeAt(i+1))||39==n?1:0,l=u.slice(i+1+h,u.length-h),f=0;f!=c.length&&58!==c.charCodeAt(f);++f);if(f===c.length)c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),a[c]=l,t||(a[c.toLowerCase()]=l);else{var d=(5===f&&"xmlns"===c.slice(0,5)?"xmlns":"")+c.slice(f+1);if(a[d]&&"ext"==c.slice(f-3,f))continue;a[d]=l,t||(a[d.toLowerCase()]=l)}}return a}function Fe(e){return e.replace(Re,"<$1")}var Oe={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Pe=Z(Oe),Ne=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/g,r=/_x([\da-fA-F]{4})_/g;return function t(a){var n=a+"",i=n.indexOf("<![CDATA[");if(-1==i)return n.replace(e,(function(e,r){return Oe[e]||String.fromCharCode(parseInt(r,e.indexOf("x")>-1?16:10))||e})).replace(r,(function(e,r){return String.fromCharCode(parseInt(r,16))}));var s=n.indexOf("]]>");return t(n.slice(0,i))+n.slice(i+9,s)+t(n.slice(s+3))}}(),Le=/[&<>'"]/g,Me=/[\u0000-\u0008\u000b-\u001f]/g;function Ue(e){var r;return(e+"").replace(Le,(function(e){return Pe[e]})).replace(Me,(function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"}))}function He(e){return Ue(e).replace(/ /g,"_x0020_")}var We=/[\u0000-\u001f]/g;function ze(e){var r;return(e+"").replace(Le,(function(e){return Pe[e]})).replace(/\n/g,"<br/>").replace(We,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}function Ve(e){var r;return(e+"").replace(Le,(function(e){return Pe[e]})).replace(We,(function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"}))}var Xe=function(){var e=/&#(\d+);/g;function r(e,r){return String.fromCharCode(parseInt(r,10))}return function t(a){return a.replace(e,r)}}(),Ge=function e(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")};function je(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}var Ke=function ob(e){for(var r="",t=0,a=0,n=0,i=0,s=0,f=0;t<e.length;)(a=e.charCodeAt(t++))<128?r+=String.fromCharCode(a):(n=e.charCodeAt(t++),a>191&&a<224?(s=(31&a)<<6,s|=63&n,r+=String.fromCharCode(s)):(i=e.charCodeAt(t++),a<240?r+=String.fromCharCode((15&a)<<12|(63&n)<<6|63&i):(f=((7&a)<<18|(63&n)<<12|(63&i)<<6|63&(s=e.charCodeAt(t++)))-65536,r+=String.fromCharCode(55296+(f>>>10&1023)),r+=String.fromCharCode(56320+(1023&f)))));return r},Ye=function(e){for(var r=[],t=0,a=0,n=0;t<e.length;)switch(a=e.charCodeAt(t++),!0){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6))),r.push(String.fromCharCode(128+(63&a)));break;case a>=55296&&a<57344:a-=55296,n=e.charCodeAt(t++)-56320+(a<<10),r.push(String.fromCharCode(240+(n>>18&7))),r.push(String.fromCharCode(144+(n>>12&63))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(63&n)));break;default:r.push(String.fromCharCode(224+(a>>12))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(63&a)))}return r.join("")};if(w){var $e=function cb(e){var r=Buffer.alloc(2*e.length),t,a,n=1,i=0,s=0,f;for(a=0;a<e.length;a+=n)n=1,(f=e.charCodeAt(a))<128?t=f:f<224?(t=64*(31&f)+(63&e.charCodeAt(a+1)),n=2):f<240?(t=4096*(15&f)+64*(63&e.charCodeAt(a+1))+(63&e.charCodeAt(a+2)),n=3):(n=4,t=262144*(7&f)+4096*(63&e.charCodeAt(a+1))+64*(63&e.charCodeAt(a+2))+(63&e.charCodeAt(a+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(r[i++]=255&s,r[i++]=s>>>8,s=0),r[i++]=t%256,r[i++]=t>>>8;return r.slice(0,i).toString("ucs2")},Ze="foo bar baz";Ke(Ze)==$e(Ze)&&(Ke=$e);var Qe=function ub(e){return k(e,"binary").toString("utf8")};Ke(Ze)==Qe(Ze)&&(Ke=Qe),Ye=function(e){return k(e,"utf8").toString("binary")}}var Je=function(){var e={};return function r(t,a){var n=t+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",a||"")}}(),qe=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","g"),e[1]]}));return function r(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),er=function(){var e={};return function r(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),rr=/<\/?(?:vt:)?variant>/g,tr=/<(?:vt:)([^>]*)>([\s\S]*)</;function ar(e,r){var t=De(e),a=e.match(er(t.baseType))||[],n=[];if(a.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+a.length+" != "+t.size);return n}return a.forEach((function(e){var r=e.replace(rr,"").match(tr);r&&n.push({v:Ke(r[2]),t:r[1]})})),n}var nr=/(^\s|\s$|\n)/;function ir(e,r){return"<"+e+(r.match(nr)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function sr(e){return K(e).map((function(r){return" "+r+'="'+e[r]+'"'})).join("")}function fr(e,r,t){return"<"+e+(null!=t?sr(t):"")+(null!=r?(r.match(nr)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function lr(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function or(e){switch(typeof e){case"string":return fr("vt:lpwstr",Ue(e));case"number":return fr((0|e)==e?"vt:i4":"vt:r8",Ue(String(e)));case"boolean":return fr("vt:bool",e?"true":"false")}if(e instanceof Date)return fr("vt:filetime",lr(e));throw new Error("Unable to serialize "+e)}var cr={dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema",main:["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"]},ur_o="urn:schemas-microsoft-com:office:office",ur_x="urn:schemas-microsoft-com:office:excel",ur_ss="urn:schemas-microsoft-com:office:spreadsheet",ur_dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",ur_mv="http://macVmlSchemaUri",ur_v="urn:schemas-microsoft-com:vml",ur_html="http://www.w3.org/TR/REC-html40";function hr(e,r){for(var t=1-2*(e[r+7]>>>7),a=((127&e[r+7])<<4)+(e[r+6]>>>4&15),n=15&e[r+6],i=5;i>=0;--i)n=256*n+e[r+i];return 2047==a?0==n?t*(1/0):NaN:(0==a?a=-1022:(a-=1023,n+=Math.pow(2,52)),t*Math.pow(2,a-52)*n)}function dr(e,r,t){var a=(r<0||1/r==-1/0?1:0)<<7,n=0,i=0,s=a?-r:r;isFinite(s)?0==s?n=i=0:(n=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(r)?26985:0);for(var f=0;f<=5;++f,i/=256)e[t+f]=255&i;e[t+6]=(15&n)<<4|15&i,e[t+7]=n>>4|a}var vr=function(e){for(var r=[],t=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=t)r.push.apply(r,e[0][a].slice(n,n+t));return r},pr=vr,mr=function(e,r,t){for(var a=[],n=r;n<t;n+=2)a.push(String.fromCharCode(Nr(e,n)));return a.join("").replace(R,"")},br=mr,gr=function(e,r,t){for(var a=[],n=r;n<r+t;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},wr=gr,kr=function(e,r,t){for(var a=[],n=r;n<t;n++)a.push(String.fromCharCode(Pr(e,n)));return a.join("")},Er=kr,Sr=function(e,r){var t=Mr(e,r);return t>0?kr(e,r+4,r+4+t-1):""},_r=Sr,Cr=function(e,r){var t=Mr(e,r);return t>0?kr(e,r+4,r+4+t-1):""},Br=Cr,Tr=function(e,r){var t=2*Mr(e,r);return t>0?kr(e,r+4,r+4+t-1):""},yr=Tr,xr,Ar;xr=Ar=function hb(e,r){var t=Mr(e,r);return t>0?mr(e,r+4,r+4+t):""};var Ir=function(e,r){var t=Mr(e,r);return t>0?kr(e,r+4,r+4+t):""},Rr=Ir,Dr,Fr;Dr=Fr=function(e,r){return hr(e,r)};var Or=function db(e){return Array.isArray(e)};w&&(mr=function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(R,""):br(e,r,t)},gr=function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):wr(e,r,t)},Sr=function vb(e,r){if(!Buffer.isBuffer(e))return _r(e,r);var t=e.readUInt32LE(r);return t>0?e.toString("utf8",r+4,r+4+t-1):""},Cr=function pb(e,r){if(!Buffer.isBuffer(e))return Br(e,r);var t=e.readUInt32LE(r);return t>0?e.toString("utf8",r+4,r+4+t-1):""},Tr=function mb(e,r){if(!Buffer.isBuffer(e))return yr(e,r);var t=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+t-1)},xr=function bb(e,r){if(!Buffer.isBuffer(e))return Ar(e,r);var t=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+t)},Ir=function gb(e,r){if(!Buffer.isBuffer(e))return Rr(e,r);var t=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+t)},kr=function wb(e,r,t){return Buffer.isBuffer(e)?e.toString("utf8",r,t):Er(e,r,t)},vr=function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0]):pr(e)},I=function(e){return Buffer.isBuffer(e[0])?Buffer.concat(e):[].concat.apply([],e)},Dr=function kb(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Fr(e,r)},Or=function Eb(e){return Buffer.isBuffer(e)||Array.isArray(e)}),"undefined"!=typeof cptable&&(mr=function(e,r,t){return cptable.utils.decode(1200,e.slice(r,t)).replace(R,"")},kr=function(e,r,t){return cptable.utils.decode(65001,e.slice(r,t))},Sr=function(e,r){var a=Mr(e,r);return a>0?cptable.utils.decode(t,e.slice(r+4,r+4+a-1)):""},Cr=function(e,t){var a=Mr(e,t);return a>0?cptable.utils.decode(r,e.slice(t+4,t+4+a-1)):""},Tr=function(e,r){var t=2*Mr(e,r);return t>0?cptable.utils.decode(1200,e.slice(r+4,r+4+t-1)):""},xr=function(e,r){var t=Mr(e,r);return t>0?cptable.utils.decode(1200,e.slice(r+4,r+4+t)):""},Ir=function(e,r){var t=Mr(e,r);return t>0?cptable.utils.decode(65001,e.slice(r+4,r+4+t)):""});var Pr=function(e,r){return e[r]},Nr=function(e,r){return 256*e[r+1]+e[r]},Lr=function(e,r){var t=256*e[r+1]+e[r];return t<32768?t:-1*(65535-t+1)},Mr=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Ur=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Hr=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Wr(e,t){var a="",n,i,s=[],f,l,o,c;switch(t){case"dbcs":if(c=this.l,w&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)a+=String.fromCharCode(Nr(this,c)),c+=2;e*=2;break;case"utf8":a=kr(this,this.l,this.l+e);break;case"utf16le":e*=2,a=mr(this,this.l,this.l+e);break;case"wstr":if("undefined"==typeof cptable)return Wr.call(this,e,"dbcs");a=cptable.utils.decode(r,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":a=Sr(this,this.l),e=4+Mr(this,this.l);break;case"lpstr-cp":a=Cr(this,this.l),e=4+Mr(this,this.l);break;case"lpwstr":a=Tr(this,this.l),e=4+2*Mr(this,this.l);break;case"lpp4":e=4+Mr(this,this.l),a=xr(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Mr(this,this.l),a=Ir(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,a="";0!==(f=Pr(this,this.l+e++));)s.push(v(f));a=s.join("");break;case"_wstr":for(e=0,a="";0!==(f=Nr(this,this.l+e));)s.push(v(f)),e+=2;e+=2,a=s.join("");break;case"dbcs-cont":for(a="",c=this.l,o=0;o<e;++o){if(this.lens&&-1!==this.lens.indexOf(c))return f=Pr(this,c),this.l=c+1,l=Wr.call(this,e-o,f?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(v(Nr(this,c))),c+=2}a=s.join(""),e*=2;break;case"cpstr":if("undefined"!=typeof cptable){a=cptable.utils.decode(r,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(a="",c=this.l,o=0;o!=e;++o){if(this.lens&&-1!==this.lens.indexOf(c))return f=Pr(this,c),this.l=c+1,l=Wr.call(this,e-o,f?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(v(Pr(this,c))),c+=1}a=s.join("");break;default:switch(e){case 1:return n=Pr(this,this.l),this.l++,n;case 2:return n=("i"===t?Lr:Nr)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0==(128&this[this.l+3])?(n=(e>0?Ur:Hr)(this,this.l),this.l+=4,n):(i=Mr(this,this.l),this.l+=4,i);case 8:case-8:if("f"===t)return i=8==e?Dr(this,this.l):Dr([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:a=gr(this,this.l,e)}}return this.l+=e,a}var zr=function(e,r,t){e[t]=255&r,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},Vr=function(e,r,t){e[t]=255&r,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},Xr=function(e,r,t){e[t]=255&r,e[t+1]=r>>>8&255},at,nt;function Gr(e,r,a){var n=0,i=0;if("dbcs"===a){for(i=0;i!=r.length;++i)Xr(this,r.charCodeAt(i),this.l+2*i);n=2*r.length}else if("sbcs"===a){if("undefined"!=typeof cptable&&874==t)for(i=0;i!=r.length;++i){var s=cptable.utils.encode(t,r.charAt(i));this[this.l+i]=s[0]}else for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=255&r.charCodeAt(i);n=r.length}else{if("hex"===a){for(;i<e;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===a){var f=Math.min(this.l+e,this.length);for(i=0;i<Math.min(r.length,e);++i){var l=r.charCodeAt(i);this[this.l++]=255&l,this[this.l++]=l>>8}for(;this.l<f;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&r;break;case 2:n=2,this[this.l]=255&r,r>>>=8,this[this.l+1]=255&r;break;case 3:n=3,this[this.l]=255&r,r>>>=8,this[this.l+1]=255&r,r>>>=8,this[this.l+2]=255&r;break;case 4:n=4,zr(this,r,this.l);break;case 8:if(n=8,"f"===a){dr(this,r,this.l);break}case 16:break;case-4:n=4,Vr(this,r,this.l)}}return this.l+=n,this}function jr(e,r){var t=gr(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Kr(e,r){e.l=r,e._R=Wr,e.chk=jr,e._W=Gr}function Yr(e,r){e.l+=r}function $r(e){var r=_(e);return Kr(r,0),r}function Zr(e,r,t){if(e){var a,n,i;Kr(e,e.l||0);for(var s=e.length,f=0,l=0;e.l<s;){128&(f=e._R(1))&&(f=(127&f)+((127&e._R(1))<<7));var o=Tp[f]||Tp[65535];for(i=127&(a=e._R(1)),n=1;n<4&&128&a;++n)i+=(127&(a=e._R(1)))<<7*n;l=e.l+i;var c=(o.f||Yr)(e,i,t);if(e.l=l,r(c,o.n,f))return}}}function Qr(){var e=[],r=w?256:2048,t=function l(e){var r=$r(e);return Kr(r,0),r},a=t(r),n=function o(){a&&(a.length>a.l&&((a=a.slice(0,a.l)).l=a.length),a.length>0&&e.push(a),a=null)},i=function c(e){return a&&e<a.length-a.l?a:(n(),a=t(Math.max(e+1,r)))},s,f=function h(e){n(),null==(a=e).l&&(a.l=a.length),i(r)};return{next:i,push:f,end:function u(){return n(),vr([e])},_bufs:e}}function Jr(e,r,t,a){var n=+yp[r],i;if(!isNaN(n)){a||(a=Tp[n].p||(t||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var s=e.next(i);n<=127?s._W(1,n):(s._W(1,128+(127&n)),s._W(1,n>>7));for(var f=0;4!=f;++f){if(!(a>=128)){s._W(1,a);break}s._W(1,128+(127&a)),a>>=7}a>0&&Or(t)&&e.push(t)}}function qr(e,r,t){var a=le(e);if(r.s?(a.cRel&&(a.c+=r.s.c),a.rRel&&(a.r+=r.s.r)):(a.cRel&&(a.c+=r.c),a.rRel&&(a.r+=r.r)),!t||t.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function et(e,r,t){var a=le(e);return a.s=qr(a.s,r.s,t),a.e=qr(a.e,r.s,t),a}function rt(e,r){if(e.cRel&&e.c<0)for(e=le(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=le(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=pt(e);return e.cRel||null==e.cRel||(t=ut(t)),e.rRel||null==e.rRel||(t=ft(t)),t}function tt(e,r){return 0!=e.s.r||e.s.rRel||e.e.r!=(r.biff>=12?1048575:r.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(r.biff>=12?65535:255)||e.e.cRel?rt(e.s,r.biff)+":"+rt(e.e,r.biff):(e.s.rRel?"":"$")+st(e.s.r)+":"+(e.e.rRel?"":"$")+st(e.e.r):(e.s.cRel?"":"$")+ct(e.s.c)+":"+(e.e.cRel?"":"$")+ct(e.e.c)}function it(e){return parseInt(lt(e),10)-1}function st(e){return""+(e+1)}function ft(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function lt(e){return e.replace(/\$(\d+)$/,"$1")}function ot(e){for(var r=ht(e),t=0,a=0;a!==r.length;++a)t=26*t+r.charCodeAt(a)-64;return t-1}function ct(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function ut(e){return e.replace(/^([A-Z])/,"$$$1")}function ht(e){return e.replace(/^\$([A-Z])/,"$1")}function dt(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vt(e){var r=dt(e);return{c:ot(r[0]),r:it(r[1])}}function pt(e){return ct(e.c)+st(e.r)}function mt(e){var r=e.split(":").map(vt);return{s:r[0],e:r[r.length-1]}}function bt(e,r){return void 0===r||"number"==typeof r?bt(e.s,e.e):("string"!=typeof e&&(e=pt(e)),"string"!=typeof r&&(r=pt(r)),e==r?e:e+":"+r)}function gt(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,a=0,n=0,i=e.length;for(t=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)t=26*t+n;for(r.s.c=--t,t=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)t=10*t+n;if(r.s.r=--t,a===i||58===e.charCodeAt(++a))return r.e.c=r.s.c,r.e.r=r.s.r,r;for(t=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)t=26*t+n;for(r.e.c=--t,t=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)t=10*t+n;return r.e.r=--t,r}function wt(e,r){var t="d"==e.t&&r instanceof Date;if(null!=e.z)try{return e.w=F.format(e.z,t?re(r):r)}catch(a){}try{return e.w=F.format((e.XF||{}).numFmtId||(t?14:0),t?re(r):r)}catch(a){return""+r}}function kt(e,r,t){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),wt(e,null==r?e.v:r))}function Et(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",a={};return a[t]=e,{SheetNames:[t],Sheets:a}}function St(e,r,t){var a=t||{},n=e?Array.isArray(e):a.dense;var i=e||(n?[]:{}),s=0,f=0;if(i&&null!=a.origin)if("number"==typeof a.origin)s=a.origin;else{var l="string"==typeof a.origin?vt(a.origin):a.origin;s=l.r,f=l.c}var o={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var c=gt(i["!ref"]);o.s.c=c.s.c,o.s.r=c.s.r,o.e.c=Math.max(o.e.c,c.e.c),o.e.r=Math.max(o.e.r,c.e.r),-1==s&&(o.e.r=s=c.e.r+1)}for(var u=0;u!=r.length;++u)if(r[u]){if(!Array.isArray(r[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=r[u].length;++h)if(void 0!==r[u][h]){var d={v:r[u][h]},v=s+u,p=f+h;if(o.s.r>v&&(o.s.r=v),o.s.c>p&&(o.s.c=p),o.e.r<v&&(o.e.r=v),o.e.c<p&&(o.e.c=p),!r[u][h]||"object"!=typeof r[u][h]||Array.isArray(r[u][h])||r[u][h]instanceof Date)if(Array.isArray(d.v)&&(d.f=r[u][h][1],d.v=d.v[0]),null===d.v)if(d.f)d.t="n";else{if(!a.sheetStubs)continue;d.t="z"}else"number"==typeof d.v?d.t="n":"boolean"==typeof d.v?d.t="b":d.v instanceof Date?(d.z=a.dateNF||F._table[14],a.cellDates?(d.t="d",d.w=F.format(d.z,re(d.v))):(d.t="n",d.v=re(d.v),d.w=F.format(d.z,d.v))):d.t="s";else d=r[u][h];if(n)i[v]||(i[v]=[]),i[v][p]&&i[v][p].z&&(d.z=i[v][p].z),i[v][p]=d;else{var b=pt({c:p,r:v});i[b]&&i[b].z&&(d.z=i[b].z),i[b]=d}}}return o.s.c<1e7&&(i["!ref"]=bt(o)),i}function _t(e,r){return St(null,e,r)}function Ct(e,r){return r||(r=$r(4)),r._W(4,e),r}function Bt(e){var r=e._R(4);return 0===r?"":e._R(r,"dbcs")}function Tt(e,r){var t=!1;return null==r&&(t=!0,r=$r(4+2*e.length)),r._W(4,e.length),e.length>0&&r._W(0,e,"dbcs"),t?r.slice(0,r.l):r}function yt(e){return{ich:e._R(2),ifnt:e._R(2)}}function xt(e,r){return r||(r=$r(4)),r._W(2,e.ich||0),r._W(2,e.ifnt||0),r}function At(e,r){var t=e.l,a=e._R(1),n=Bt(e),i=[],s={t:n,h:n};if(0!=(1&a)){for(var f=e._R(4),l=0;l!=f;++l)i.push(yt(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=t+r,s}function It(e,r){var t=!1;return null==r&&(t=!0,r=$r(15+4*e.t.length)),r._W(1,0),Tt(e.t,r),t?r.slice(0,r.l):r}(function(e,r){var t;if(void 0!==r)t=r;else if("undefined"!=typeof require)try{t=void 0}catch(a){t=null}e.rc4=function(e,r){var t=new Array(256),a=0,n=0,i=0,s=0;for(n=0;256!=n;++n)t[n]=n;for(n=0;256!=n;++n)i=i+t[n]+e[n%e.length].charCodeAt(0)&255,s=t[n],t[n]=t[i],t[i]=s;n=i=0;var f=Buffer(r.length);for(a=0;a!=r.length;++a)i=(i+t[n=n+1&255])%256,s=t[n],t[n]=t[i],t[i]=s,f[a]=r[a]^t[t[n]+t[i]&255];return f},e.md5=function(e){if(!t)throw new Error("Unsupported crypto");return t.createHash("md5").update(e).digest("hex")}})({},"undefined"!=typeof crypto?crypto:void 0);var Rt=At;function Dt(e,r){var t=!1;return null==r&&(t=!0,r=$r(23+4*e.t.length)),r._W(1,1),Tt(e.t,r),r._W(4,1),xt({ich:0,ifnt:0},r),t?r.slice(0,r.l):r}function Ft(e){var r=e._R(4),t=e._R(2);return t+=e._R(1)<<16,e.l++,{c:r,iStyleRef:t}}function Ot(e,r){return null==r&&(r=$r(8)),r._W(-4,e.c),r._W(3,e.iStyleRef||e.s),r._W(1,0),r}var Pt=Bt,Nt=Tt;function Lt(e){var r=e._R(4);return 0===r||4294967295===r?"":e._R(r,"dbcs")}function Mt(e,r){var t=!1;return null==r&&(t=!0,r=$r(127)),r._W(4,e.length>0?e.length:4294967295),e.length>0&&r._W(0,e,"dbcs"),t?r.slice(0,r.l):r}var Ut=Bt,Ht=Lt,Wt=Mt;function zt(e){var r=e.slice(e.l,e.l+4),t=1&r[0],a=2&r[0];e.l+=4,r[0]&=252;var n=0===a?Dr([0,0,0,0,r[0],r[1],r[2],r[3]],0):Ur(r,0)>>2;return t?n/100:n}function Vt(e,r){null==r&&(r=$r(4));var t=0,a=0,n=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?a=1:n==(0|n)&&n>=-(1<<29)&&n<1<<29&&(a=1,t=1),!a)throw new Error("unsupported RkNumber "+e);r._W(-4,((t?n:e)<<2)+(t+2))}function Xt(e){var r={s:{},e:{}};return r.s.r=e._R(4),r.e.r=e._R(4),r.s.c=e._R(4),r.e.c=e._R(4),r}function Gt(e,r){return r||(r=$r(16)),r._W(4,e.s.r),r._W(4,e.e.r),r._W(4,e.s.c),r._W(4,e.e.c),r}var jt=Xt,Kt=Gt;function Yt(e){return e._R(8,"f")}function $t(e,r){return(r||$r(8))._W(8,e,"f")}var Zt={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Qt=Q(Zt);function Jt(e){var r={},t,a=e._R(1)>>>1,n=e._R(1),i=e._R(2,"i"),s=e._R(1),f=e._R(1),l=e._R(1);switch(e.l++,a){case 0:r.auto=1;break;case 1:r.index=n;var o=ya[n];o&&(r.rgb=al(o));break;case 2:r.rgb=al([s,f,l]);break;case 3:r.theme=n}return 0!=i&&(r.tint=i>0?i/32767:i/32768),r}function qt(e,r){if(r||(r=$r(8)),!e||e.auto)return r._W(4,0),r._W(4,0),r;null!=e.index?(r._W(1,2),r._W(1,e.index)):null!=e.theme?(r._W(1,6),r._W(1,e.theme)):(r._W(1,5),r._W(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r._W(2,t),e.rgb&&null==e.theme){var a=e.rgb||"FFFFFF";"number"==typeof a&&(a=("000000"+a.toString(16)).slice(-6)),r._W(1,parseInt(a.slice(0,2),16)),r._W(1,parseInt(a.slice(2,4),16)),r._W(1,parseInt(a.slice(4,6),16)),r._W(1,255)}else r._W(2,0),r._W(1,0),r._W(1,0);return r}function ea(e){var r=e._R(1),t;return e.l++,{fBold:1&r,fItalic:2&r,fUnderline:4&r,fStrikeout:8&r,fOutline:16&r,fShadow:32&r,fCondense:64&r,fExtend:128&r}}function ra(e,r){r||(r=$r(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r._W(1,t),r._W(1,0),r}function ta(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e._R(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return t[e._R(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e._R(0,1==r?"lpstr":"lpwstr")}function aa(e){return ta(e,1)}function na(e){return ta(e,2)}var ia=2,sa=3,fa=11,la=12,oa=19,ca=30,ua=64,ha=65,da=71,va=4096,pa=80,ma=81,ba=[80,81],ga={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{}},wa={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{}},ka={2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};!function(){for(var e in ka)ka.hasOwnProperty(e)&&(ga[e]=wa[e]=ka[e])}();var Ea=Y(ga,"n"),Sa=Y(wa,"n"),_a={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Ca=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Ba(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var Ta,ya=le(Ba([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),xa={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.sheetMetadata":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"TODO","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"vba","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Aa=function(){var e={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};return K(e).forEach((function(r){["xlsm","xlam"].forEach((function(t){e[r][t]||(e[r][t]=e[r].xlsx)}))})),K(e).forEach((function(r){K(e[r]).forEach((function(t){xa[e[r][t]]=r}))})),e}(),Ia=J(xa);function Ra(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],TODO:[],xmlns:""}}function Da(e){var r={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],TODO:[],xmlns:""};if(!e||!e.match)return r;var t={};if((e.match(Ae)||[]).forEach((function(e){var a=De(e);switch(a[0].replace(Ie,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":void 0!==r[xa[a.ContentType]]&&r[xa[a.ContentType]].push(a.PartName)}})),r.xmlns!==cr.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}cr.CT="http://schemas.openxmlformats.org/package/2006/content-types";var Fa=fr("Types",null,{xmlns:cr.CT,"xmlns:xsd":cr.xsd,"xmlns:xsi":cr.xsi}),Oa=[["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels",Ia.rels[0]]].map((function(e){return fr("Default",null,{Extension:e[0],ContentType:e[1]})}));function Pa(e,r){var t=[],a;t[t.length]=ye,t[t.length]=Fa,t=t.concat(Oa);var n=function(n){e[n]&&e[n].length>0&&(a=e[n][0],t[t.length]=fr("Override",null,{PartName:("/"==a[0]?"":"/")+a,ContentType:Aa[n][r.bookType||"xlsx"]}))},i=function(a){(e[a]||[]).forEach((function(e){t[t.length]=fr("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Aa[a][r.bookType||"xlsx"]})}))},s=function(r){(e[r]||[]).forEach((function(e){t[t.length]=fr("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Ia[r][0]})}))};return n("workbooks"),i("sheets"),i("charts"),s("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("drawings"),t.length>2&&(t[t.length]="</Types>",t[1]=t[1].replace("/>",">")),t.join("")}var Na={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function La(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Ma(e,r){var t={"!id":{}};if(!e)return t;"/"!==r.charAt(0)&&(r="/"+r);var a={};return(e.match(Ae)||[]).forEach((function(e){var n=De(e);if("<Relationship"===n[0]){var i={};i.Type=n.Type,i.Target=n.Target,i.Id=n.Id,i.TargetMode=n.TargetMode;var s="External"===n.TargetMode?n.Target:Te(n.Target,r);t[s]=i,a[n.Id]=i}})),t["!id"]=a,t}cr.RELS="http://schemas.openxmlformats.org/package/2006/relationships";var Ua=fr("Relationships",null,{xmlns:cr.RELS});function Ha(e){var r=[ye,Ua];return K(e["!id"]).forEach((function(t){r[r.length]=fr("Relationship",null,e["!id"][t])})),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}var Wa=[Na.HLINK,Na.XPATH,Na.XMISS];function za(e,r,t,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),r<0)for(r=1;e["!id"]["rId"+r];++r);if(n.Id="rId"+r,n.Type=a,n.Target=t,i?n.TargetMode=i:Wa.indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,r}var Va="application/vnd.oasis.opendocument.spreadsheet";function Xa(e,r){for(var t=qv(e),a,n;a=ep.exec(t);)switch(a[3]){case"manifest":break;case"file-entry":if("/"==(n=De(a[0],!1)).path&&n.type!==Va)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw a}}function Ga(e){var r=[ye];r.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),r.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+'"/>\n');return r.push("</manifest:manifest>"),r.join("")}function ja(e,r,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+'"/>\n',"  </rdf:Description>\n"].join("")}function Ka(e,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+'"/>\n',"  </rdf:Description>\n"].join("")}function Ya(e){var r=[ye];r.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var t=0;t!=e.length;++t)r.push(ja(e[t][0],e[t][1])),r.push(Ka("",e[t][0]));return r.push(ja("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}var $a=function(){var r='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+e.version+"</meta:generator></office:meta></office:document-meta>";return function t(){return r}}(),Za=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];cr.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Na.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties";var Qa=function(){for(var e=new Array(Za.length),r=0;r<Za.length;++r){var t=Za[r],a="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function Ja(e){var r={};e=Ke(e);for(var t=0;t<Za.length;++t){var a=Za[t],n=e.match(Qa[t]);null!=n&&n.length>0&&(r[a[1]]=Ne(n[1])),"date"===a[2]&&r[a[1]]&&(r[a[1]]=se(r[a[1]]))}return r}var qa=fr("cp:coreProperties",null,{"xmlns:cp":cr.CORE_PROPS,"xmlns:dc":cr.dc,"xmlns:dcterms":cr.dcterms,"xmlns:dcmitype":cr.dcmitype,"xmlns:xsi":cr.xsi});function en(e,r,t,a,n){null==n[e]&&null!=r&&""!==r&&(n[e]=r,r=Ue(r),a[a.length]=t?fr(e,r,t):ir(e,r))}function rn(e,r){var t=r||{},a=[ye,qa],n={};if(!e&&!t.Props)return a.join("");e&&(null!=e.CreatedDate&&en("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:lr(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),null!=e.ModifiedDate&&en("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:lr(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=Za.length;++i){var s=Za[i],f=t.Props&&null!=t.Props[s[1]]?t.Props[s[1]]:e?e[s[1]]:null;!0===f?f="1":!1===f?f="0":"number"==typeof f&&(f=String(f)),null!=f&&en(s[0],f,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var tn=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];cr.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Na.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties";var an=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function nn(e,r,t,a){var n=[];if("string"==typeof e)n=ar(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map((function(e){return{v:e}})));var s="string"==typeof r?ar(r,a).map((function(e){return e.v})):r,f=0,l=0;if(s.length>0)for(var o=0;o!==n.length;o+=2){switch(l=+n[o+1].v,n[o].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=s.slice(f,f+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=l,t.DefinedNames=s.slice(f,f+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=s.slice(f,f+l)}f+=l}}function sn(e,r,t){var a={};return r||(r={}),e=Ke(e),tn.forEach((function(t){var n=(e.match(Je(t[0]))||[])[1];switch(t[2]){case"string":r[t[1]]=Ne(n||"");break;case"bool":r[t[1]]="true"===n;break;case"raw":var i=e.match(new RegExp("<"+t[0]+"[^>]*>([\\s\\S]*?)</"+t[0]+">"));i&&i.length>0&&(a[t[1]]=i[1])}})),a.HeadingPairs&&a.TitlesOfParts&&nn(a.HeadingPairs,a.TitlesOfParts,r,t),r}var fn=fr("Properties",null,{xmlns:cr.EXT_PROPS,"xmlns:vt":cr.vt});function ln(e){var r=[],t=fr;return e||(e={}),e.Application="SheetJS",r[r.length]=ye,r[r.length]=fn,tn.forEach((function(a){if(void 0!==e[a[1]]){var n;switch(a[2]){case"string":n=Ue(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false"}void 0!==n&&(r[r.length]=t(a[0],n))}})),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map((function(e){return"<vt:lpstr>"+Ue(e)+"</vt:lpstr>"})).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}cr.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Na.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties";var on=/<[^>]+>[^<]*/g;function cn(e,r){var t={},a="",n=e.match(on);if(n)for(var i=0;i!=n.length;++i){var s=n[i],f=De(s);switch(f[0]){case"<?xml":case"<Properties":break;case"<property":a=Ne(f.name);break;case"</property>":a=null;break;default:if(0===s.indexOf("<vt:")){var l=s.split(">"),o=l[0].slice(4),c=l[1];switch(o){case"lpstr":case"bstr":case"lpwstr":t[a]=Ne(c);break;case"bool":t[a]=je(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[a]=parseInt(c,10);break;case"r4":case"r8":case"decimal":t[a]=parseFloat(c);break;case"filetime":case"date":t[a]=se(c);break;case"cy":case"error":t[a]=Ne(c);break;default:if("/"==o.slice(-1))break;r.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",s,o,l)}}else if("</"===s.slice(0,2));else if(r.WTF)throw new Error(s)}}return t}var un=fr("Properties",null,{xmlns:cr.CUST_PROPS,"xmlns:vt":cr.vt});function hn(e){var r=[ye,un];if(!e)return r.join("");var t=1;return K(e).forEach((function a(n){++t,r[r.length]=fr("property",or(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Ue(n)})})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var dn={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},vn=Z(dn);function pn(e,r,t){e[r=vn[r]||r]=t}function mn(e,r){var t=[];return K(dn).map((function(e){for(var r=0;r<Za.length;++r)if(Za[r][1]==e)return Za[r];for(r=0;r<tn.length;++r)if(tn[r][1]==e)return tn[r];throw e})).forEach((function(a){if(null!=e[a[1]]){var n=r&&r.Props&&null!=r.Props[a[1]]?r.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z")}"number"==typeof n?n=String(n):!0===n||!1===n?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),t.push(ir(dn[a[1]]||a[1],n))}})),fr("DocumentProperties",t.join(""),{xmlns:ur_o})}function bn(e,r){var t=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&K(e).forEach((function(r){if(e.hasOwnProperty(r)){for(var a=0;a<Za.length;++a)if(r==Za[a][1])return;for(a=0;a<tn.length;++a)if(r==tn[a][1])return;for(a=0;a<t.length;++a)if(r==t[a])return;var i=e[r],s="string";"number"==typeof i?(s="float",i=String(i)):!0===i||!1===i?(s="boolean",i=i?"1":"0"):i=String(i),n.push(fr(He(r),i,{"dt:dt":s}))}})),r&&K(r).forEach((function(t){if(r.hasOwnProperty(t)&&(!e||!e.hasOwnProperty(t))){var a=r[t],i="string";"number"==typeof a?(i="float",a=String(a)):!0===a||!1===a?(i="boolean",a=a?"1":"0"):a instanceof Date?(i="dateTime.tz",a=a.toISOString()):a=String(a),n.push(fr(He(t),a,{"dt:dt":i}))}})),"<"+a+' xmlns="'+ur_o+'">'+n.join("")+"</"+a+">"}function gn(e){var r=e._R(4),t=e._R(4);return new Date(1e3*(t/1e7*Math.pow(2,32)+r/1e7-11644473600)).toISOString().replace(/\.000/,"")}function wn(e){var r,t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,a=t%Math.pow(2,32),n=(t-a)/Math.pow(2,32);n*=1e7;var i=(a*=1e7)/Math.pow(2,32)|0;i>0&&(a%=Math.pow(2,32),n+=i);var s=$r(8);return s._W(4,a),s._W(4,n),s}function kn(e,r,t){var a=e.l,n=e._R(0,"lpstr-cp");if(t)for(;e.l-a&3;)++e.l;return n}function En(e,r,t){var a=e._R(0,"lpwstr");return t&&(e.l+=4-(a.length+1&3)&3),a}function Sn(e,r,t){return 31===r?En(e):kn(e,r,t)}function _n(e,r,t){return Sn(e,r,!1===t?0:4)}function Cn(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Sn(e,r,0)}function Bn(e){for(var r=e._R(4),t=[],a=0;a!=r;++a)t[a]=e._R(0,"lpstr-cp").replace(R,"");return t}function Tn(e){return Bn(e)}function yn(e){var r,t;return[Fn(e,81),Fn(e,3)]}function xn(e){for(var r=e._R(4),t=[],a=0;a!=r/2;++a)t.push(yn(e));return t}function An(e){return xn(e)}function In(e,r){for(var t=e._R(4),a={},n=0;n!=t;++n){var i=e._R(4),s=e._R(4);a[i]=e._R(s,1200===r?"utf16le":"utf8").replace(R,"").replace(D,"!"),1200===r&&s%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),a}function Rn(e){var r=e._R(4),t=e.slice(e.l,e.l+r);return e.l+=r,(3&r)>0&&(e.l+=4-(3&r)&3),t}function Dn(e){var r={};return r.Size=e._R(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Fn(e,r,t){var a=e._R(2),n,i=t||{};if(e.l+=2,12!==r&&a!==r&&-1===ba.indexOf(r))throw new Error("Expected type "+r+" saw "+a);switch(12===r?a:r){case 2:return n=e._R(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e._R(4,"i");case 11:return 0!==e._R(4);case 19:return n=e._R(4);case 30:return kn(e,a,4).replace(R,"");case 31:return En(e);case 64:return gn(e);case 65:return Rn(e);case 71:return Dn(e);case 80:return _n(e,a,!i.raw).replace(R,"");case 81:return Cn(e,a).replace(R,"");case 4108:return An(e);case 4126:return Tn(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+a)}}function On(e,r){var t=$r(4),a=$r(4);switch(t._W(4,80==e?31:e),e){case 3:a._W(-4,r);break;case 5:(a=$r(8))._W(8,r,"f");break;case 11:a._W(4,r?1:0);break;case 64:a=wn(r);break;case 31:case 80:for((a=$r(4+2*(r.length+1)+(r.length%2?0:2)))._W(4,r.length+1),a._W(0,r,"dbcs");a.l!=a.length;)a._W(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return I([t,a])}function Pn(e,r){var t=e.l,a=e._R(4),n=e._R(4),i=[],s=0,f=0,o=-1,c={};for(s=0;s!=n;++s){var u=e._R(4),h=e._R(4);i[s]=[u,h+t]}i.sort((function(e,r){return e[1]-r[1]}));var d={};for(s=0;s!=n;++s){if(e.l!==i[s][1]){var v=!0;if(s>0&&r)switch(r[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,v=!1);break;case 80:case 4108:e.l<=i[s][1]&&(e.l=i[s][1],v=!1)}if((!r||0==s)&&e.l<=i[s][1]&&(v=!1,e.l=i[s][1]),v)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(r){var p=r[i[s][0]];if(d[p.n]=Fn(e,p.t,{raw:!0}),"version"===p.p&&(d[p.n]=String(d[p.n]>>16)+"."+("0000"+String(65535&d[p.n])).slice(-4)),"CodePage"==p.n)switch(d[p.n]){case 0:d[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:l(f=d[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[p.n])}}else if(1===i[s][0]){if(f=d.CodePage=Fn(e,2),l(f),-1!==o){var m=e.l;e.l=i[o][1],c=In(e,f),e.l=m}}else if(0===i[s][0]){if(0===f){o=s,e.l=i[s+1][1];continue}c=In(e,f)}else{var b=c[i[s][0]],g;switch(e[e.l]){case 65:e.l+=4,g=Rn(e);break;case 30:case 31:e.l+=4,g=_n(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e._R(4,"i");break;case 19:e.l+=4,g=e._R(4);break;case 5:e.l+=4,g=e._R(8,"f");break;case 11:e.l+=4,g=Xn(e,4);break;case 64:e.l+=4,g=se(gn(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[b]=g}}return e.l=t+a,d}var Nn=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"].concat(an);function Ln(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Mn(e,r,t){var a=$r(8),n=[],i=[],s=8,f=0,l=$r(8),o=$r(8);if(l._W(4,2),l._W(4,1200),o._W(4,1),i.push(l),n.push(o),s+=8+l.length,!r){(o=$r(8))._W(4,0),n.unshift(o);var c=[$r(4)];for(c[0]._W(4,e.length),f=0;f<e.length;++f){var u=e[f][0];for((l=$r(8+2*(u.length+1)+(u.length%2?0:2)))._W(4,f+2),l._W(4,u.length+1),l._W(0,u,"dbcs");l.l!=l.length;)l._W(1,0);c.push(l)}l=I(c),i.unshift(l),s+=8+l.length}for(f=0;f<e.length;++f)if((!r||r[e[f][0]])&&!(Nn.indexOf(e[f][0])>-1)&&null!=e[f][1]){var h=e[f][1],d=0;if(r){var v=t[d=+r[e[f][0]]];if("version"==v.p&&"string"==typeof h){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=On(v.t,h)}else{var m=Ln(h);-1==m&&(m=31,h=String(h)),l=On(m,h)}i.push(l),(o=$r(8))._W(4,r?d:2+f),n.push(o),s+=8+l.length}var b=8*(i.length+1);for(f=0;f<i.length;++f)n[f]._W(4,b),b+=i[f].length;return a._W(4,s),a._W(4,i.length),I([a].concat(n).concat(i))}function Un(e,r,t){var a=e.content;if(!a)return{};Kr(a,0);var n,i,s,f,l=0;a.chk("feff","Byte Order: "),a._R(2);var o=a._R(4),c=a._R(16);if(c!==z.utils.consts.HEADER_CLSID&&c!==t)throw new Error("Bad PropertySet CLSID "+c);if(1!==(n=a._R(4))&&2!==n)throw new Error("Unrecognized #Sets: "+n);if(i=a._R(16),f=a._R(4),1===n&&f!==a.l)throw new Error("Length mismatch: "+f+" !== "+a.l);2===n&&(s=a._R(16),l=a._R(4));var u=Pn(a,r),h={SystemIdentifier:o},v;for(var d in u)h[d]=u[d];if(h.FMTID=i,1===n)return h;if(l-a.l==2&&(a.l+=2),a.l!==l)throw new Error("Length mismatch 2: "+a.l+" !== "+l);try{v=Pn(a,null)}catch(p){}for(d in v)h[d]=v[d];return h.FMTID=[i,s],h}function Hn(e,r,t,a,n,i){var s=$r(n?68:48),f=[s];s._W(2,65534),s._W(2,0),s._W(4,842412599),s._W(16,z.utils.consts.HEADER_CLSID,"hex"),s._W(4,n?2:1),s._W(16,r,"hex"),s._W(4,n?68:48);var l=Mn(e,t,a);if(f.push(l),n){var o=Mn(n,null,null);s._W(16,i,"hex"),s._W(4,68+l.length),f.push(o)}return I(f)}function Wn(e,r){return e._R(r),null}function zn(e,r){r||(r=$r(e));for(var t=0;t<e;++t)r._W(1,0);return r}function Vn(e,r,t){for(var a=[],n=e.l+r;e.l<n;)a.push(t(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function Xn(e,r){return 1===e._R(r)}function Gn(e,r){return r||(r=$r(2)),r._W(2,+!!e),r}function jn(e){return e._R(2,"u")}function Kn(e,r){return r||(r=$r(2)),r._W(2,e),r}function Yn(e,r){return Vn(e,r,jn)}function $n(e){var r=e._R(1),t;return 1===e._R(1)?r:1===r}function Zn(e,r,t){return t||(t=$r(2)),t._W(1,+e),t._W(1,"e"==r?1:0),t}function Qn(e,t,a){var n=e._R(a&&a.biff>=12?2:1),i="sbcs-cont",s=r,f;(a&&a.biff>=8&&(r=1200),a&&8!=a.biff)?12==a.biff&&(i="wstr"):e._R(1)&&(i="dbcs-cont");a.biff>=2&&a.biff<=5&&(i="cpstr");var l=n?e._R(n,i):"";return r=s,l}function Jn(e){var t=r;r=1200;var a=e._R(2),n=e._R(1),i=4&n,s=8&n,f=1+(1&n),l=0,o,c={};s&&(l=e._R(2)),i&&(o=e._R(4));var u=2==f?"dbcs-cont":"sbcs-cont",h=0===a?"":e._R(a,u);return s&&(e.l+=4*l),i&&(e.l+=o),c.t=h,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),r=t,c}function qn(e,r,t){var a,n;if(t){if(t.biff>=2&&t.biff<=5)return e._R(r,"cpstr");if(t.biff>=12)return e._R(r,"dbcs-cont")}return a=0===e._R(1)?e._R(r,"sbcs-cont"):e._R(r,"dbcs-cont")}function ei(e,r,t){var a=e._R(t&&2==t.biff?1:2);return 0===a?(e.l++,""):qn(e,a,t)}function ri(e,r,t){if(t.biff>5)return ei(e,r,t);var a=e._R(1);return 0===a?(e.l++,""):e._R(a,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ti(e,r,t){return t||(t=$r(3+2*e.length)),t._W(2,e.length),t._W(1,1),t._W(31,e,"utf16le"),t}function ai(e){var r=e._R(1);e.l++;var t=e._R(2);return e.l+=2,[r,t]}function ni(e){var r=e._R(4),t=e.l,a=!1;r>24&&(e.l+=r-24,"795881f43b1d7f48af2c825dc4852763"===e._R(16)&&(a=!0),e.l=t);var n=e._R((a?r-24:r)>>1,"utf16le").replace(R,"");return a&&(e.l+=24),n}function ii(e){e.l+=2;var r=e._R(0,"lpstr-ansi"),t;if(e.l+=2,57005!=e._R(2))throw new Error("Bad FileMoniker");if(0===e._R(4))return r.replace(/\\/g,"/");var a=e._R(4),n;if(3!=e._R(2))throw new Error("Bad FileMoniker");return e._R(a>>1,"utf16le").replace(R,"")}function si(e,r){var t=e._R(16);switch(r-=16,t){case"e0c9ea79f9bace118c8200aa004ba90b":return ni(e,r);case"0303000000000000c000000000000046":return ii(e,r);default:throw new Error("Unsupported Moniker "+t)}}function fi(e){var r=e._R(4),t;return r>0?e._R(r,"utf16le").replace(R,""):""}function li(e,r){var t=e.l+r,a=e._R(4);if(2!==a)throw new Error("Unrecognized streamVersion: "+a);var n=e._R(2);e.l+=2;var i,s,f,l,o="",c,u;16&n&&(i=fi(e,t-e.l)),128&n&&(s=fi(e,t-e.l)),257==(257&n)&&(f=fi(e,t-e.l)),1==(257&n)&&(l=si(e,t-e.l)),8&n&&(o=fi(e,t-e.l)),32&n&&(c=e._R(16)),64&n&&(u=gn(e)),e.l=t;var h=s||f||l||"";h&&o&&(h+="#"+o),h||(h="#"+o);var d={Target:h};return c&&(d.guid=c),u&&(d.time=u),i&&(d.Tooltip=i),d}function oi(e){var r=$r(512),t=0,a=e.Target,n=a.indexOf("#")>-1?31:23;switch(a.charAt(0)){case"#":n=28;break;case".":n&=-3}r._W(4,2),r._W(4,n);var i=[8,6815827,6619237,4849780,83];for(t=0;t<i.length;++t)r._W(4,i[t]);if(28==n){for(a=a.slice(1),r._W(4,a.length+1),t=0;t<a.length;++t)r._W(2,a.charCodeAt(t));r._W(2,0)}else if(2&n){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<i.length;++t)r._W(1,parseInt(i[t],16));for(r._W(4,2*(a.length+1)),t=0;t<a.length;++t)r._W(2,a.charCodeAt(t));r._W(2,0)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<i.length;++t)r._W(1,parseInt(i[t],16));for(var s=0;"../"==a.slice(3*s,3*s+3)||"..\\"==a.slice(3*s,3*s+3);)++s;for(r._W(2,s),r._W(4,a.length+1),t=0;t<a.length;++t)r._W(1,255&a.charCodeAt(t));for(r._W(1,0),r._W(2,65535),r._W(2,57005),t=0;t<6;++t)r._W(4,0)}return r.slice(0,r.l)}function ci(e){var r,t,a,n;return[e._R(1),e._R(1),e._R(1),e._R(1)]}function ui(e,r){var t=ci(e,r);return t[3]=0,t}function hi(e){var r,t,a;return{r:e._R(2),c:e._R(2),ixfe:e._R(2)}}function di(e,r,t,a){return a||(a=$r(6)),a._W(2,e),a._W(2,r),a._W(2,t||0),a}function vi(e){var r=e._R(2),t=e._R(2);return e.l+=8,{type:r,flags:t}}function pi(e,r,t){return 0===r?"":ri(e,r,t)}function mi(e,r,t){var a=t.biff>8?4:2,n,i,s;return[e._R(a),e._R(a,"i"),e._R(a,"i")]}function bi(e){var r,t;return[e._R(2),zt(e)]}function gi(e,r,t){e.l+=4,r-=4;var a=e.l+r,n=Qn(e,r,t),i=e._R(2);if(i!==(a-=e.l))throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,n}function wi(e){var r=e._R(2),t=e._R(2),a,n;return{s:{c:e._R(2),r:r},e:{c:e._R(2),r:t}}}function ki(e,r){return r||(r=$r(8)),r._W(2,e.s.r),r._W(2,e.e.r),r._W(2,e.s.c),r._W(2,e.e.c),r}function Ei(e){var r=e._R(2),t=e._R(2),a,n;return{s:{c:e._R(1),r:r},e:{c:e._R(1),r:t}}}var Si=Ei;function _i(e){e.l+=4;var r=e._R(2),t=e._R(2),a=e._R(2);return e.l+=12,[t,r,a]}function Ci(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e._R(2),e.l+=4,r}function Bi(e){var r={};return e.l+=4,e.cf=e._R(2),r}function Ti(e){e.l+=2,e.l+=e._R(2)}var yi={0:Ti,4:Ti,5:Ti,6:Ti,7:Bi,8:Ti,9:Ti,10:Ti,11:Ti,12:Ti,13:Ci,14:Ti,15:Ti,16:Ti,17:Ti,18:Ti,19:Ti,20:Ti,21:_i};function xi(e,r){for(var t=e.l+r,a=[];e.l<t;){var n=e._R(2);e.l-=2;try{a.push(yi[n](e,t-e.l))}catch(i){return e.l=t,a}}return e.l!=t&&(e.l=t),a}function Ai(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e._R(2),(r-=2)>=2&&(t.dt=e._R(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e._R(r),t}function Ii(e,r,t){var a=1536,n=16;switch(t.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=$r(n);return i._W(2,a),i._W(2,r),n>4&&i._W(2,29282),n>6&&i._W(2,1997),n>8&&(i._W(2,49161),i._W(2,1),i._W(2,1798),i._W(2,0)),i}function Ri(e,r){return 0===r?1200:(e._R(2),1200)}function Di(e,r,t){if(t.enc)return e.l+=r,"";var a=e.l,n=ri(e,0,t);return e._R(r+a-e.l),n}function Fi(e,r){var t=!r||8==r.biff,a=$r(t?112:54);for(a._W(8==r.biff?2:1,7),t&&a._W(1,0),a._W(4,859007059),a._W(4,5458548|(t?0:536870912));a.l<a.length;)a._W(1,t?0:32);return a}function Oi(e,r,t){var a;return{fDialog:16&(t&&8==t.biff||2==r?e._R(2):(e.l+=r,0))}}function Pi(e,r,t){var a=e._R(4),n=3&e._R(1),i=e._R(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule"}var s=Qn(e,0,t);return 0===s.length&&(s="Sheet1"),{pos:a,hs:n,dt:i,name:s}}function Ni(e,r){var t=!r||r.biff>=8?2:1,a=$r(8+t*e.name.length);a._W(4,e.pos),a._W(1,e.hs||0),a._W(1,e.dt),a._W(1,e.name.length),r.biff>=8&&a._W(1,1),a._W(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function Li(e,r){for(var t=e.l+r,a=e._R(4),n=e._R(4),i=[],s=0;s!=n&&e.l<t;++s)i.push(Jn(e));return i.Count=a,i.Unique=n,i}function Mi(e,r){var t={};return t.dsst=e._R(2),e.l+=r-2,t}function Ui(e){var r={};r.r=e._R(2),r.c=e._R(2),r.cnt=e._R(2)-r.c;var t=e._R(2);e.l+=4;var a=e._R(1);return e.l+=3,7&a&&(r.level=7&a),32&a&&(r.hidden=!0),64&a&&(r.hpt=t/20),r}function Hi(e){var r=vi(e),t;if(2211!=r.type)throw new Error("Invalid Future Record "+r.type);return 0!==e._R(4)}function Wi(e){return e._R(2),e._R(4)}function zi(e,r,t){var a=0;t&&2==t.biff||(a=e._R(2));var n=e._R(2),i;return t&&2==t.biff&&(a=1-(n>>15),n&=32767),[{Unsynced:1&a,DyZero:(2&a)>>1,ExAsc:(4&a)>>2,ExDsc:(8&a)>>3},n]}function Vi(e){var r,t,a,n,i,s,f,l,o;return{Pos:[e._R(2),e._R(2)],Dim:[e._R(2),e._R(2)],Flags:e._R(2),CurTab:e._R(2),FirstTab:e._R(2),Selected:e._R(2),TabRatio:e._R(2)}}function Xi(){var e=$r(18);return e._W(2,0),e._W(2,0),e._W(2,29280),e._W(2,17600),e._W(2,56),e._W(2,0),e._W(2,0),e._W(2,1),e._W(2,500),e}function Gi(e,r,t){return t&&t.biff>=2&&t.biff<8?{}:{RTL:64&e._R(2)};var a}function ji(e){var r=$r(18),t=1718;return e&&e.RTL&&(t|=64),r._W(2,t),r._W(4,0),r._W(4,64),r._W(4,0),r._W(4,0),r}function Ki(){}function Yi(e,r,t){var a={dyHeight:e._R(2),fl:e._R(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return a.name=Qn(e,0,t),a}function $i(e,r){var t=e.name||"Arial",a=r&&5==r.biff,n,i=$r(a?15+t.length:16+2*t.length);return i._W(2,20*(e.sz||12)),i._W(4,0),i._W(2,400),i._W(4,0),i._W(2,0),i._W(1,t.length),a||i._W(1,1),i._W((a?1:2)*t.length,t,a?"sbcs":"utf16le"),i}function Zi(e){var r=hi(e);return r.isst=e._R(4),r}function Qi(e,r,t){var a=e.l+r,n=hi(e,6);2==t.biff&&e.l++;var i=ei(e,a-e.l,t);return n.val=i,n}function Ji(e,r,t,a,n){var i=!n||8==n.biff,s=$r(+i+8+(1+i)*t.length);return di(e,r,a,s),s._W(2,t.length),i&&s._W(1,1),s._W((1+i)*t.length,t,i?"utf16le":"sbcs"),s}function qi(e,r,t){var a,n;return[e._R(2),ri(e,0,t)]}function es(e,r,t,a){var n=t&&5==t.biff;a||(a=$r(n?3+r.length:5+2*r.length)),a._W(2,e),a._W(n?1:2,r.length),n||a._W(1,1),a._W((n?1:2)*r.length,r,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return null==i.l&&(i.l=i.length),i}var rs=ri;function ts(e,r,t){var a=e.l+r,n=8!=t.biff&&t.biff?2:4,i=e._R(n),s=e._R(n),f=e._R(2),l=e._R(2);return e.l=a,{s:{r:i,c:f},e:{r:s,c:l}}}function as(e,r){var t=8!=r.biff&&r.biff?2:4,a=$r(2*t+6);return a._W(t,e.s.r),a._W(t,e.e.r+1),a._W(2,e.s.c),a._W(2,e.e.c+1),a._W(2,0),a}function ns(e){var r=e._R(2),t=e._R(2),a=bi(e);return{r:r,c:t,ixfe:a[0],rknum:a[1]}}function is(e,r){for(var t=e.l+r-2,a=e._R(2),n=e._R(2),i=[];e.l<t;)i.push(bi(e));if(e.l!==t)throw new Error("MulRK read error");var s=e._R(2);if(i.length!=s-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:s,rkrec:i}}function ss(e,r){for(var t=e.l+r-2,a=e._R(2),n=e._R(2),i=[];e.l<t;)i.push(e._R(2));if(e.l!==t)throw new Error("MulBlank read error");var s=e._R(2);if(i.length!=s-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:s,ixfe:i}}function fs(e,r,t,a){var n={},i=e._R(4),s=e._R(4),f=e._R(4),l=e._R(2);return n.patternType=Ca[f>>26],a.cellStyles?(n.alc=7&i,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=15&s,n.dgRight=s>>4&15,n.dgTop=s>>8&15,n.dgBottom=s>>12&15,n.icvLeft=s>>16&127,n.icvRight=s>>23&127,n.grbitDiag=s>>30&3,n.icvTop=127&f,n.icvBottom=f>>7&127,n.icvDiag=f>>14&127,n.dgDiag=f>>21&15,n.icvFore=127&l,n.icvBack=l>>7&127,n.fsxButton=l>>14&1,n):n}function ls(e,r,t){var a={};return a.ifnt=e._R(2),a.numFmtId=e._R(2),a.flags=e._R(2),a.fStyle=a.flags>>2&1,r-=6,a.data=fs(e,r,a.fStyle,t),a}function os(e,r,t,a){var n=t&&5==t.biff;return a||(a=$r(n?16:20)),a._W(2,0),e.style?(a._W(2,e.numFmtId||0),a._W(2,65524)):(a._W(2,e.numFmtId||0),a._W(2,r<<4)),a._W(4,0),a._W(4,0),n||a._W(4,0),a._W(2,0),a}function cs(e){e.l+=4;var r=[e._R(2),e._R(2)];if(0!==r[0]&&r[0]--,0!==r[1]&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function us(e){var r=$r(8);return r._W(4,0),r._W(2,e[0]?e[0]+1:0),r._W(2,e[1]?e[1]+1:0),r}function hs(e,r,t){var a=hi(e,6);2==t.biff&&++e.l;var n=$n(e,2);return a.val=n,a.t=!0===n||!1===n?"b":"e",a}function ds(e,r,t,a,n,i){var s=$r(8);return di(e,r,a,s),Zn(t,i,s),s}function vs(e){var r=hi(e,6),t=Yt(e,8);return r.val=t,r}function ps(e,r,t,a){var n=$r(14);return di(e,r,a,n),$t(t,n),n}var ms=pi;function bs(e,r,t){var a=e.l+r,n=e._R(2),i=e._R(2);if(t.sbcch=i,1025==i||14849==i)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=qn(e,i),f=[];a>e.l;)f.push(ei(e));return[i,n,s,f]}function gs(e,r,t){var a=e._R(2),n,i={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===t.sbcch&&(n=gi(e,r-2,t)),i.body=n||e._R(r-2),"string"==typeof n&&(i.Name=n),i}var ws=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ks(e,r,t){var a=e.l+r,n=e._R(2),i=e._R(1),s=e._R(1),f=e._R(t&&2==t.biff?1:2),l=0;(!t||t.biff>=5)&&(5!=t.biff&&(e.l+=2),l=e._R(2),5==t.biff&&(e.l+=2),e.l+=4);var o=qn(e,s,t);32&n&&(o=ws[o.charCodeAt(0)]);var c=a-e.l,u;return t&&2==t.biff&&--c,{chKey:i,Name:o,itab:l,rgce:a==e.l||0===f?[]:Nu(e,c,t,f)}}function Es(e,r,t){if(t.biff<8)return Ss(e,r,t);for(var a=[],n=e.l+r,i=e._R(t.biff>8?4:2);0!=i--;)a.push(mi(e,t.biff>8?12:6,t));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function Ss(e,r,t){3==e[e.l+1]&&e[e.l]++;var a=Qn(e,r,t);return 3==a.charCodeAt(0)?a.slice(1):a}function _s(e,r,t){if(!(t.biff<8)){var a=e._R(2),n=e._R(2),i,s;return[qn(e,a,t),qn(e,n,t)]}e.l+=r}function Cs(e,r,t){var a=Ei(e,6);e.l++;var n=e._R(1);return[Lu(e,r-=8,t),n,a]}function Bs(e,r,t){var a=Si(e,6);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[a,Ou(e,r,t,a)]}function Ts(e){var r,t,a;return[0!==e._R(4),0!==e._R(4),e._R(4)]}function ys(e,r,t){if(!(t.biff<8)){var a=e._R(2),n=e._R(2),i=e._R(2),s=e._R(2),f=ri(e,0,t);return t.biff<8&&e._R(1),[{r:a,c:n},f,s,i]}}function xs(e,r,t){return ys(e,r,t)}function As(e,r){for(var t=[],a=e._R(2);a--;)t.push(wi(e,r));return t}function Is(e){var r=$r(2+8*e.length);r._W(2,e.length);for(var t=0;t<e.length;++t)ki(e[t],r);return r}function Rs(e,r,t){if(t&&t.biff<8)return Fs(e,r,t);var a=_i(e,22),n;return{cmo:a,ft:xi(e,r-22,a[1])}}var Ds=[];function Fs(e,r,t){e.l+=4;var a=e._R(2),n=e._R(2),i=e._R(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var s=[];return s.push((Ds[a]||Yr)(e,r,t)),{cmo:[n,a,i],ft:s}}function Os(e,r,t){var a=e.l,n="";try{e.l+=4;var i=(t.lastobj||{cmo:[0,0]}).cmo[1],s;-1==[0,5,7,11,12,14].indexOf(i)?e.l+=6:s=ai(e,6,t);var f=e._R(2);e._R(2),jn(e,2);var l=e._R(2);e.l+=l;for(var o=1;o<e.lens.length-1;++o){if(e.l-a!=e.lens[o])throw new Error("TxO: bad continue record");var c=e[e.l],u;if((n+=qn(e,e.lens[o+1]-e.lens[o]-1)).length>=(c?f:2*f))break}if(n.length!==f&&n.length!==2*f)throw new Error("cchText: "+f+" != "+n.length);return e.l=a+r,{t:n}}catch(h){return e.l=a+r,{t:n}}}function Ps(e,r){var t=wi(e,8),a;return e.l+=16,[t,li(e,r-24)]}function Ns(e){var r=$r(24),t=vt(e[0]);r._W(2,t.r),r._W(2,t.r),r._W(2,t.c),r._W(2,t.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)r._W(1,parseInt(a[n],16));return I([r,oi(e[1])])}function Ls(e,r){e._R(2);var t=wi(e,8),a=e._R((r-10)/2,"dbcs-cont");return[t,a=a.replace(R,"")]}function Ms(e){var r=e[1].Tooltip,t=$r(10+2*(r.length+1));t._W(2,2048);var a=vt(e[0]);t._W(2,a.r),t._W(2,a.r),t._W(2,a.c),t._W(2,a.c);for(var n=0;n<r.length;++n)t._W(2,r.charCodeAt(n));return t._W(2,0),t}function Us(e){var r=[0,0],t;return t=e._R(2),r[0]=_a[t]||t,t=e._R(2),r[1]=_a[t]||t,r}function Hs(e){return e||(e=$r(4)),e._W(2,1),e._W(2,1),e}function Ws(e){for(var r=e._R(2),t=[];r-- >0;)t.push(ui(e,8));return t}function zs(e){for(var r=e._R(2),t=[];r-- >0;)t.push(ui(e,8));return t}function Vs(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e._R(2),r.crc=e._R(4),r}function Xs(e,r,t){if(!t.cellStyles)return Yr(e,r);var a=t&&t.biff>=12?4:2,n=e._R(a),i=e._R(a),s=e._R(a),f=e._R(a),l=e._R(2);2==a&&(e.l+=2);var o={s:n,e:i,w:s,ixfe:f,flags:l};return(t.biff>=5||!t.biff)&&(o.level=l>>8&7),o}function Gs(e,r){var t={};return r<32?t:(e.l+=16,t.header=Yt(e,8),t.footer=Yt(e,8),e.l+=2,t)}function js(e,r,t){var a={area:!1};if(5!=t.biff)return e.l+=r,a;var n=e._R(1);return e.l+=3,16&n&&(a.area=!0),a}function Ks(e){for(var r=$r(2*e),t=0;t<e;++t)r._W(2,t+1);return r}Ds[8]=function(e,r){var t=e.l+r;e.l+=10;var a=e._R(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e._R(1);return e.l+=n,e.l=t,{fmt:a}};var Ys=hi,$s=Yn,Zs=ei;function Qs(e){var r=e._R(2),t=e._R(2),a=e._R(4),n={fmt:r,env:t,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function Js(e,r,t){var a=hi(e,6);++e.l;var n=ri(e,r-7,t);return a.t="str",a.val=n,a}function qs(e){var r=hi(e,6);++e.l;var t=Yt(e,8);return r.t="n",r.val=t,r}function ef(e,r,t){var a=$r(15);return Rp(a,e,r),a._W(8,t,"f"),a}function rf(e){var r=hi(e,6);++e.l;var t=e._R(2);return r.t="n",r.val=t,r}function tf(e,r,t){var a=$r(9);return Rp(a,e,r),a._W(2,t),a}function af(e){var r=e._R(1);return 0===r?(e.l++,""):e._R(r,"sbcs-cont")}function nf(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function sf(e,r,t){var a=e.l+r,n=hi(e,6),i=e._R(2),s=qn(e,i,t);return e.l=a,n.t="str",n.val=s,n}var ff=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,255:16969},r=Z({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(r,t){var a=[],n=_(1);switch(t.type){case"base64":n=B(g.decode(r));break;case"binary":n=B(r);break;case"buffer":case"array":n=r}Kr(n,0);var i=n._R(1),s=!1,f=!1,l=!1;switch(i){case 2:case 3:break;case 48:f=!0,s=!0;break;case 49:f=!0;break;case 131:case 139:s=!0;break;case 140:s=!0,l=!0;break;case 245:s=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var o=0,c=0;2==i&&(o=n._R(2)),n.l+=3,2!=i&&(o=n._R(4)),2!=i&&(c=n._R(2));var u=n._R(2),h=1252;2!=i&&(n.l+=16,n._R(1),0!==n[n.l]&&(h=e[n[n.l]]),n.l+=1,n.l+=2),l&&(n.l+=36);for(var d=[],v={},p=c-10-(f?264:0),m=l?32:11;2==i?n.l<n.length&&13!=n[n.l]:n.l<p;)switch((v={}).name=cptable.utils.decode(h,n.slice(n.l,n.l+m)).replace(/[\u0000\r\n].*$/g,""),n.l+=m,v.type=String.fromCharCode(n._R(1)),2==i||l||(v.offset=n._R(4)),v.len=n._R(1),2==i&&(v.offset=n._R(2)),v.dec=n._R(1),v.name.length&&d.push(v),2!=i&&(n.l+=l?13:14),v.type){case"B":f&&8==v.len||!t.WTF||console.log("Skipping "+v.name+":"+v.type);break;case"G":case"P":t.WTF&&console.log("Skipping "+v.name+":"+v.type);break;case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":case"0":case"@":case"+":break;default:throw new Error("Unknown Field Type: "+v.type)}if(13!==n[n.l]?n.l=c-1:2==i&&(n.l=521),2!=i){if(13!==n._R(1))throw new Error("DBF Terminator not found "+n.l+" "+n[n.l]);n.l=c}var b=0,w=0;for(a[0]=[],w=0;w!=d.length;++w)a[0][w]=d[w].name;for(;o-- >0;)if(42!==n[n.l])for(++n.l,a[++b]=[],w=0,w=0;w!=d.length;++w){var k=n.slice(n.l,n.l+d[w].len);n.l+=d[w].len,Kr(k,0);var E=cptable.utils.decode(h,k);switch(d[w].type){case"C":a[b][w]=cptable.utils.decode(h,k),a[b][w]=a[b][w].trim();break;case"D":8===E.length?a[b][w]=new Date(+E.slice(0,4),+E.slice(4,6)-1,+E.slice(6,8)):a[b][w]=E;break;case"F":a[b][w]=parseFloat(E.trim());break;case"+":case"I":a[b][w]=l?2147483648^k._R(-4,"i"):k._R(4,"i");break;case"L":switch(E.toUpperCase()){case"Y":case"T":a[b][w]=!0;break;case"N":case"F":a[b][w]=!1;break;case" ":case"?":a[b][w]=!1;break;default:throw new Error("DBF Unrecognized L:|"+E+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));a[b][w]="##MEMO##"+(l?parseInt(E.trim(),10):k._R(4));break;case"N":a[b][w]=+E.replace(/\u0000/g,"").trim();break;case"@":a[b][w]=new Date(k._R(-8,"f")-621356832e5);break;case"T":a[b][w]=new Date(864e5*(k._R(4)-2440588)+k._R(4));break;case"Y":a[b][w]=k._R(4,"i")/1e4;break;case"O":a[b][w]=-k._R(-8,"f");break;case"B":if(f&&8==d[w].len){a[b][w]=k._R(8,"f");break}case"G":case"P":k.l+=d[w].len;break;case"0":if("_NullFlags"===d[w].name)break;default:throw new Error("DBF Unsupported data type "+d[w].type)}}else n.l+=u;if(2!=i&&n.l<n.length&&26!=n[n.l++])throw new Error("DBF EOF Marker missing "+(n.l-1)+" of "+n.length+" "+n[n.l-1].toString(16));return t&&t.sheetRows&&(a=a.slice(0,t.sheetRows)),a}function n(e,r){var t=r||{};return t.dateNF||(t.dateNF="yyyymmdd"),_t(a(e,t),t)}function i(e,r){try{return Et(n(e,r),r)}catch(t){if(r&&r.WTF)throw t}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function f(e,a){var n=a||{};if(+n.codepage>=0&&l(+n.codepage),"string"==n.type)throw new Error("Cannot write DBF to JS string");var i=Qr(),f=jm(e,{header:1,raw:!0,cellDates:!0}),o=f[0],c=f.slice(1),u=0,h=0,d=0,v=1;for(u=0;u<o.length;++u)if(null!=u){if(++d,"number"==typeof o[u]&&(o[u]=o[u].toString(10)),"string"!=typeof o[u])throw new Error("DBF Invalid column name "+o[u]+" |"+typeof o[u]+"|");if(o.indexOf(o[u])!==u)for(h=0;h<1024;++h)if(-1==o.indexOf(o[u]+"_"+h)){o[u]+="_"+h;break}}var p=gt(e["!ref"]),m=[];for(u=0;u<=p.e.c-p.s.c;++u){var b=[];for(h=0;h<c.length;++h)null!=c[h][u]&&b.push(c[h][u]);if(0!=b.length&&null!=o[u]){var g="",w="";for(h=0;h<b.length;++h){switch(typeof b[h]){case"number":w="B";break;case"string":w="C";break;case"boolean":w="L";break;case"object":w=b[h]instanceof Date?"D":"C";break;default:w="C"}if("C"==(g=g&&g!=w?"C":w))break}v+=s[g]||0,m[u]=g}else m[u]="?"}var k=i.next(32);for(k._W(4,318902576),k._W(4,c.length),k._W(2,296+32*d),k._W(2,v),u=0;u<4;++u)k._W(4,0);for(k._W(4,0|(+r[t]||3)<<8),u=0,h=0;u<o.length;++u)if(null!=o[u]){var E=i.next(32),S=(o[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);E._W(1,S,"sbcs"),E._W(1,"?"==m[u]?"C":m[u],"sbcs"),E._W(4,h),E._W(1,s[m[u]]||0),E._W(1,0),E._W(1,2),E._W(4,0),E._W(1,0),E._W(4,0),E._W(4,0),h+=s[m[u]]||0}var _=i.next(264);for(_._W(4,13),u=0;u<65;++u)_._W(4,0);for(u=0;u<c.length;++u){var C=i.next(v);for(C._W(1,0),h=0;h<o.length;++h)if(null!=o[h])switch(m[h]){case"L":C._W(1,null==c[u][h]?63:c[u][h]?84:70);break;case"B":C._W(8,c[u][h]||0,"f");break;case"D":c[u][h]?(C._W(4,("0000"+c[u][h].getFullYear()).slice(-4),"sbcs"),C._W(2,("00"+(c[u][h].getMonth()+1)).slice(-2),"sbcs"),C._W(2,("00"+c[u][h].getDate()).slice(-2),"sbcs")):C._W(8,"00000000","sbcs");break;case"C":var B=String(c[u][h]||"");for(C._W(1,B,"sbcs"),d=0;d<250-B.length;++d)C._W(1,32)}}return i.next(1)._W(1,26),i.end()}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),lf=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,B:180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("N("+K(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(r,t){var a=e[t];return"number"==typeof a?p(a):a},a=function(e,r,t){var a=r.charCodeAt(0)-32<<4|t.charCodeAt(0)-48;return 59==a?e:p(a)};function n(e,r){switch(r.type){case"base64":return i(g.decode(e),r);case"binary":return i(e,r);case"buffer":return i(e.toString("binary"),r);case"array":return i(fe(e),r)}throw new Error("Unrecognized type "+r.type)}function i(e,n){var i=e.split(/[\n\r]+/),s=-1,f=-1,o=0,c=0,u=[],h=[],d=null,v={},p=[],m=[],b=[],g=0,w;for(+n.codepage>=0&&l(+n.codepage);o!==i.length;++o){g=0;var k=i[o].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(r,t),E=k.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),S=E[0],_;if(k.length>0)switch(S){case"ID":case"E":case"B":case"O":break;case"P":"P"==E[1].charAt(0)&&h.push(k.slice(3).replace(/;;/g,";"));break;case"C":var C=!1,B=!1;for(c=1;c<E.length;++c)switch(E[c].charAt(0)){case"X":f=parseInt(E[c].slice(1))-1,B=!0;break;case"Y":for(s=parseInt(E[c].slice(1))-1,B||(f=0),w=u.length;w<=s;++w)u[w]=[];break;case"K":'"'===(_=E[c].slice(1)).charAt(0)?_=_.slice(1,_.length-1):"TRUE"===_?_=!0:"FALSE"===_?_=!1:isNaN(ce(_))?isNaN(ue(_).getDate())||(_=se(_)):(_=ce(_),null!==d&&F.is_date(d)&&(_=te(_))),"undefined"!=typeof cptable&&"string"==typeof _&&"string"!=(n||{}).type&&(n||{}).codepage&&(_=cptable.utils.decode(n.codepage,_)),C=!0;break;case"E":var T=Jo(E[c].slice(1),{r:s,c:f});u[s][f]=[u[s][f],T];break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+k)}C&&(u[s][f]=_,d=null);break;case"F":var y=0;for(c=1;c<E.length;++c)switch(E[c].charAt(0)){case"X":f=parseInt(E[c].slice(1))-1,++y;break;case"Y":for(s=parseInt(E[c].slice(1))-1,w=u.length;w<=s;++w)u[w]=[];break;case"M":g=parseInt(E[c].slice(1))/20;break;case"F":case"G":break;case"P":d=h[parseInt(E[c].slice(1))];break;case"S":case"D":case"N":break;case"W":for(b=E[c].slice(1).split(" "),w=parseInt(b[0],10);w<=parseInt(b[1],10);++w)g=parseInt(b[2],10),m[w-1]=0===g?{hidden:!0}:{wch:g},ml(m[w-1]);break;case"C":m[f=parseInt(E[c].slice(1))-1]||(m[f]={});break;case"R":p[s=parseInt(E[c].slice(1))-1]||(p[s]={}),g>0?(p[s].hpt=g,p[s].hpx=kl(g)):0===g&&(p[s].hidden=!0);break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+k)}y<1&&(d=null);break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+k)}}return p.length>0&&(v["!rows"]=p),m.length>0&&(v["!cols"]=m),n&&n.sheetRows&&(u=u.slice(0,n.sheetRows)),[u,v]}function s(e,r){var t=n(e,r),a=t[0],i=t[1],s=_t(a,r);return K(i).forEach((function(e){s[e]=i[e]})),s}function f(e,r){return Et(s(e,r),r)}function o(e,r,t,a){var n="C;Y"+(t+1)+";X"+(a+1)+";K";switch(e.t){case"n":n+=e.v||0,e.f&&!e.F&&(n+=";E"+ec(e.f,{r:t,c:a}));break;case"b":n+=e.v?"TRUE":"FALSE";break;case"e":n+=e.w||e.v;break;case"d":n+='"'+(e.w||e.v)+'"';break;case"s":n+='"'+e.v.replace(/"/g,"")+'"'}return n}function c(e,r){r.forEach((function(r,t){var a="F;W"+(t+1)+" "+(t+1)+" ";r.hidden?a+="0":("number"==typeof r.width&&(r.wpx=ul(r.width)),"number"==typeof r.wpx&&(r.wch=hl(r.wpx)),"number"==typeof r.wch&&(a+=Math.round(r.wch)))," "!=a.charAt(a.length-1)&&e.push(a)}))}function u(e,r){r.forEach((function(r,t){var a="F;";r.hidden?a+="M0;":r.hpt?a+="M"+20*r.hpt+";":r.hpx&&(a+="M"+20*wl(r.hpx)+";"),a.length>2&&e.push(a+"R"+(t+1))}))}function h(e,r){var t=["ID;PWXL;N;E"],a=[],n=gt(e["!ref"]),i,s=Array.isArray(e),f="\r\n";t.push("P;PGeneral"),t.push("F;P0;DG0G8;M255"),e["!cols"]&&c(t,e["!cols"]),e["!rows"]&&u(t,e["!rows"]),t.push("B;Y"+(n.e.r-n.s.r+1)+";X"+(n.e.c-n.s.c+1)+";D"+[n.s.c,n.s.r,n.e.c,n.e.r].join(" "));for(var l=n.s.r;l<=n.e.r;++l)for(var h=n.s.c;h<=n.e.c;++h){var d=pt({r:l,c:h});(i=s?(e[l]||[])[h]:e[d])&&(null!=i.v||i.f&&!i.F)&&a.push(o(i,e,l,h,r))}return t.join(f)+f+a.join(f)+f+"E"+f}return e["|"]=254,{to_workbook:f,to_sheet:s,from_sheet:h}}(),of=function(){function e(e,t){switch(t.type){case"base64":return r(g.decode(e),t);case"binary":return r(e,t);case"buffer":return r(e.toString("binary"),t);case"array":return r(fe(e),t)}throw new Error("Unrecognized type "+t.type)}function r(e,r){for(var t=e.split("\n"),a=-1,n=-1,i=0,s=[];i!==t.length;++i)if("BOT"!==t[i].trim()){if(!(a<0)){var f=t[i].trim().split(","),l=f[0],o=f[1],c=t[++i].trim();switch(+l){case-1:if("BOT"===c){s[++a]=[],n=0;continue}if("EOD"!==c)throw new Error("Unrecognized DIF special command "+c);break;case 0:"TRUE"===c?s[a][n]=!0:"FALSE"===c?s[a][n]=!1:isNaN(ce(o))?isNaN(ue(o).getDate())?s[a][n]=o:s[a][n]=se(o):s[a][n]=ce(o),++n;break;case 1:c=c.slice(1,c.length-1),s[a][n++]=""!==c?c:null}if("EOD"===c)break}}else s[++a]=[],n=0;return r&&r.sheetRows&&(s=s.slice(0,r.sheetRows)),s}function t(r,t){return _t(e(r,t),t)}function a(e,r){return Et(t(e,r),r)}var n=function(){var e=function t(e,r,a,n,i){e.push(r),e.push(a+","+n),e.push('"'+i.replace(/"/g,'""')+'"')},r=function a(e,r,t,n){e.push(r+","+t),e.push(1==r?'"'+n.replace(/"/g,'""')+'"':n)};return function n(t){var a=[],n=gt(t["!ref"]),i,s=Array.isArray(t);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,n.e.r-n.s.r+1,""),e(a,"TUPLES",0,n.e.c-n.s.c+1,""),e(a,"DATA",0,0,"");for(var f=n.s.r;f<=n.e.r;++f){r(a,-1,0,"BOT");for(var l=n.s.c;l<=n.e.c;++l){var o=pt({r:f,c:l});if(i=s?(t[f]||[])[l]:t[o])switch(i.t){case"n":var c=i.w;c||null==i.v||(c=i.v),null==c?i.f&&!i.F?r(a,1,0,"="+i.f):r(a,1,0,""):r(a,0,c,"V");break;case"b":r(a,0,i.v?1:0,i.v?"TRUE":"FALSE");break;case"s":r(a,1,0,isNaN(i.v)?i.v:'="'+i.v+'"');break;case"d":i.w||(i.w=F.format(i.z||F._table[14],re(se(i.v)))),r(a,0,i.w,"V");break;default:r(a,1,0,"")}else r(a,1,0,"")}}r(a,-1,0,"EOD");var u="\r\n",h;return a.join(u)}}();return{to_workbook:a,to_sheet:t,from_sheet:n}}(),cf=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function r(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(r,t){for(var a=r.split("\n"),n=-1,i=-1,s=0,f=[];s!==a.length;++s){var l=a[s].trim().split(":");if("cell"===l[0]){var o=vt(l[1]);if(f.length<=o.r)for(n=f.length;n<=o.r;++n)f[n]||(f[n]=[]);switch(n=o.r,i=o.c,l[2]){case"t":f[n][i]=e(l[3]);break;case"v":f[n][i]=+l[3];break;case"vtf":var c=l[l.length-1];case"vtc":switch(l[3]){case"nl":f[n][i]=!!+l[4];break;default:f[n][i]=+l[4]}"vtf"==l[2]&&(f[n][i]=[f[n][i],c])}}}return t&&t.sheetRows&&(f=f.slice(0,t.sheetRows)),f}function a(e,r){return _t(t(e,r),r)}function n(e,r){return Et(a(e,r),r)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),l="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var t=[],a=[],n,i="",s=mt(e["!ref"]),f=Array.isArray(e),l=s.s.r;l<=s.e.r;++l)for(var o=s.s.c;o<=s.e.c;++o)if(i=pt({r:l,c:o}),(n=f?(e[l]||[])[o]:e[i])&&null!=n.v&&"z"!==n.t){switch(a=["cell",i,"t"],n.t){case"s":case"str":a.push(r(n.v));break;case"n":n.f?(a[2]="vtf",a[3]="n",a[4]=n.v,a[5]=r(n.f)):(a[2]="v",a[3]=n.v);break;case"b":a[2]="vt"+(n.f?"f":"c"),a[3]="nl",a[4]=n.v?"1":"0",a[5]=r(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var c=re(se(n.v));a[2]="vtc",a[3]="nd",a[4]=""+c,a[5]=n.w||F.format(n.z||F._table[14],c);break;case"e":continue}t.push(a.join(":"))}return t.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),t.push("valueformat:1:text-wiki"),t.join("\n")}function c(e){return[i,s,f,s,o(e),l].join("\n")}return{to_workbook:n,to_sheet:a,from_sheet:c}}(),uf=function(){function e(e,r,t,a,n){n.raw?r[t][a]=e:"TRUE"===e?r[t][a]=!0:"FALSE"===e?r[t][a]=!1:""===e||(isNaN(ce(e))?isNaN(ue(e).getDate())?r[t][a]=e:r[t][a]=se(e):r[t][a]=ce(e))}function r(r,t){var a=t||{},n=[];if(!r||0===r.length)return n;for(var i=r.split(/[\r\n]/),s=i.length-1;s>=0&&0===i[s].length;)--s;for(var f=10,l=0,o=0;o<=s;++o)-1==(l=i[o].indexOf(" "))?l=i[o].length:l++,f=Math.max(f,l);for(o=0;o<=s;++o){n[o]=[];var c=0;for(e(i[o].slice(0,f).trim(),n,o,c,a),c=1;c<=(i[o].length-f)/10+1;++c)e(i[o].slice(f+10*(c-1),f+10*c).trim(),n,o,c,a)}return a.sheetRows&&(n=n.slice(0,a.sheetRows)),n}var t={44:",",9:"\t",59:";"},a={44:3,9:2,59:1};function n(e){for(var r={},n=!1,i=0,s=0;i<e.length;++i)34==(s=e.charCodeAt(i))?n=!n:!n&&s in t&&(r[s]=(r[s]||0)+1);for(i in s=[],r)r.hasOwnProperty(i)&&s.push([r[i],i]);if(!s.length)for(i in r=a)r.hasOwnProperty(i)&&s.push([r[i],i]);return s.sort((function(e,r){return e[0]-r[0]||a[e[1]]-a[r[1]]})),t[s.pop()[1]]}function i(e,r){var t=r||{},a="";var i=t.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)&&10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=n(e.slice(0,1024));var f=0,l=0,o=0,c=0,u=0,h=a.charCodeAt(0),d=!1,v=0;e=e.replace(/\r\n/gm,"\n");var p=null!=t.dateNF?M(t.dateNF):null;function b(){var r=e.slice(c,u),a={};if('"'==r.charAt(0)&&'"'==r.charAt(r.length-1)&&(r=r.slice(1,-1).replace(/""/g,'"')),0===r.length)a.t="z";else if(t.raw)a.t="s",a.v=r;else if(0===r.trim().length)a.t="s",a.v=r;else if(61==r.charCodeAt(0))34==r.charCodeAt(1)&&34==r.charCodeAt(r.length-1)?(a.t="s",a.v=r.slice(2,-1).replace(/""/g,'"')):ac(r)?(a.t="n",a.f=r.slice(1)):(a.t="s",a.v=r);else if("TRUE"==r)a.t="b",a.v=!0;else if("FALSE"==r)a.t="b",a.v=!1;else if(isNaN(o=ce(r)))if(!isNaN(ue(r).getDate())||p&&r.match(p)){a.z=t.dateNF||F._table[14];var n=0;p&&r.match(p)&&(r=U(r,t.dateNF,r.match(p)||[]),n=1),t.cellDates?(a.t="d",a.v=se(r,n)):(a.t="n",a.v=re(se(r,n))),!1!==t.cellText&&(a.w=F.format(a.z,a.v instanceof Date?re(a.v):a.v)),t.cellNF||delete a.z}else a.t="s",a.v=r;else a.t="n",!1!==t.cellText&&(a.w=r),a.v=o;if("z"==a.t||(t.dense?(i[f]||(i[f]=[]),i[f][l]=a):i[pt({c:l,r:f})]=a),c=u+1,s.e.c<l&&(s.e.c=l),s.e.r<f&&(s.e.r=f),v==h)++l;else if(l=0,++f,t.sheetRows&&t.sheetRows<=f)return!0}e:for(;u<e.length;++u)switch(v=e.charCodeAt(u)){case 34:d=!d;break;case h:case 10:case 13:if(!d&&b())break e}return u-c>0&&b(),i["!ref"]=bt(s),i}function s(e,t){return"sep="==e.slice(0,4)?i(e,t):e.indexOf("\t")>=0||e.indexOf(",")>=0||e.indexOf(";")>=0?i(e,t):_t(r(e,t),t)}function f(e,r){var t="",a="string"==r.type?[0,0,0,0]:Bm(e,r);switch(r.type){case"base64":t=g.decode(e);break;case"binary":t=e;break;case"buffer":t=65001==r.codepage?e.toString("utf8"):r.codepage&&"undefined"!=typeof cptable?cptable.utils.decode(r.codepage,e):e.toString("binary");break;case"array":t=fe(e);break;case"string":t=e;break;default:throw new Error("Unrecognized type "+r.type)}return 239==a[0]&&187==a[1]&&191==a[2]?t=Ke(t.slice(3)):"binary"==r.type&&"undefined"!=typeof cptable&&r.codepage&&(t=cptable.utils.decode(r.codepage,cptable.utils.encode(1252,t))),"socialcalc:version:"==t.slice(0,19)?cf.to_sheet("string"==r.type?t:Ke(t),r):s(t,r)}function l(e,r){return Et(f(e,r),r)}function o(e){for(var r=[],t=gt(e["!ref"]),a,n=Array.isArray(e),i=t.s.r;i<=t.e.r;++i){for(var s=[],f=t.s.c;f<=t.e.c;++f){var l=pt({r:i,c:f});if((a=n?(e[i]||[])[f]:e[l])&&null!=a.v){for(var o=(a.w||(kt(a),a.w)||"").slice(0,10);o.length<10;)o+=" ";s.push(o+(0===f?" ":""))}else s.push("          ")}r.push(s.join(""))}return r.join("\n")}return{to_workbook:l,to_sheet:f,from_sheet:o}}();function hf(e,r){var t=r||{},a=!!t.WTF;t.WTF=!0;try{var n=lf.to_workbook(e,t);return t.WTF=a,n}catch(i){if(t.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return uf.to_workbook(e,r)}}var df=function(){function e(e,r,t){if(e){Kr(e,e.l||0);for(var a=t.Enum||w;e.l<e.length;){var n=e._R(2),i=a[n]||a[255],s=e._R(2),f=e.l+s,l=(i.f||Yr)(e,s,t);if(e.l=f,r(l,i.n,n))return}}}function r(e,r){switch(r.type){case"base64":return t(B(g.decode(e)),r);case"binary":return t(B(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}function t(r,t){if(!r)return r;var a=t||{};var n=a.dense?[]:{},i="Sheet1",s=0,f={},l=[i],o={s:{r:0,c:0},e:{r:0,c:0}},c=a.sheetRows||0;if(2==r[2])a.Enum=w;else if(26==r[2])a.Enum=k;else{if(14!=r[2])throw new Error("Unrecognized LOTUS BOF "+r[2]);a.Enum=k,a.qpro=!0,r.l=0}return e(r,(function(e,t,u){if(2==r[2])switch(u){case 0:a.vers=e,e>=4096&&(a.qpro=!0);break;case 6:o=e;break;case 15:a.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:case 51:14==u&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=a.dateNF||F._table[14],a.cellDates&&(e[1].t="d",e[1].v=te(e[1].v))),a.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[pt(e[0])]=e[1]}else switch(u){case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>s&&(n["!ref"]=bt(o),f[i]=n,n=a.dense?[]:{},o={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],i="Sheet"+(s+1),l.push(i)),c>0&&e[0].r>=c)break;a.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[pt(e[0])]=e[1],o.e.c<e[0].c&&(o.e.c=e[0].c),o.e.r<e[0].r&&(o.e.r=e[0].r)}}),a),n["!ref"]=bt(o),f[i]=n,{SheetNames:l,Sheets:f}}function a(e){var r={s:{c:0,r:0},e:{c:0,r:0}};return r.s.c=e._R(2),r.s.r=e._R(2),r.e.c=e._R(2),r.e.r=e._R(2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r}function n(e,r,t){var a=[{c:0,r:0},{t:"n",v:0},0];return t.qpro&&20768!=t.vers?(a[0].c=e._R(1),e.l++,a[0].r=e._R(2),e.l+=2):(a[2]=e._R(1),a[0].c=e._R(2),a[0].r=e._R(2)),a}function i(e,r,t){var a=e.l+r,i=n(e,r,t);if(i[1].t="s",20768==t.vers){e.l++;var s=e._R(1);return i[1].v=e._R(s,"utf8"),i}return t.qpro&&e.l++,i[1].v=e._R(a-e.l,"cstr"),i}function s(e,r,t){var a=n(e,r,t);return a[1].v=e._R(2,"i"),a}function f(e,r,t){var a=n(e,r,t);return a[1].v=e._R(8,"f"),a}function l(e,r,t){var a=e.l+r,i=n(e,r,t);if(i[1].v=e._R(8,"f"),t.qpro)e.l=a;else{var s=e._R(2);e.l+=s}return i}function o(e){var r=[{c:0,r:0},{t:"n",v:0},0];return r[0].r=e._R(2),r[3]=e[e.l++],r[0].c=e[e.l++],r}function c(e,r){var t=o(e,r);return t[1].t="s",t[1].v=e._R(r-4,"cstr"),t}function u(e,r){var t=o(e,r);t[1].v=e._R(2);var a=t[1].v>>1;if(1&t[1].v)switch(7&a){case 1:a=500*(a>>3);break;case 2:a=(a>>3)/20;break;case 4:a=(a>>3)/2e3;break;case 6:a=(a>>3)/16;break;case 7:a=(a>>3)/64;break;default:throw"unknown NUMBER_18 encoding "+(7&a)}return t[1].v=a,t}function h(e,r){var t=o(e,r),a=e._R(4),n=e._R(4),i=e._R(2);if(65535==i)return t[1].v=0,t;var s=32768&i;return i=(32767&i)-16446,t[1].v=(2*s-1)*((i>0?n<<i:n>>>-i)+(i>-32?a<<i+32:a>>>-(i+32))),t}function d(e,r){var t=h(e,14);return e.l+=r-14,t}function v(e,r){var t=o(e,r),a=e._R(4);return t[1].v=a>>6,t}function p(e,r){var t=o(e,r),a=e._R(8,"f");return t[1].v=a,t}function b(e,r){var t=p(e,14);return e.l+=r-10,t}var w={0:{n:"BOF",f:jn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:s},14:{n:"NUMBER",f:f},15:{n:"LABEL",f:i},16:{n:"FORMULA",f:l},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:i},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},255:{n:"",f:Yr}},k={0:{n:"BOF"},1:{n:"EOF"},3:{n:"??"},4:{n:"??"},5:{n:"??"},6:{n:"??"},7:{n:"??"},9:{n:"??"},10:{n:"??"},11:{n:"??"},12:{n:"??"},14:{n:"??"},15:{n:"??"},16:{n:"??"},17:{n:"??"},18:{n:"??"},19:{n:"??"},21:{n:"??"},22:{n:"LABEL16",f:c},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:u},25:{n:"FORMULA19",f:d},26:{n:"??"},27:{n:"??"},28:{n:"??"},29:{n:"??"},30:{n:"??"},31:{n:"??"},33:{n:"??"},37:{n:"NUMBER25",f:v},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:b},255:{n:"",f:Yr}};return{to_workbook:r}}();function vf(e){var r={},t=e.match(Ae),a=0,n=!1;if(t)for(;a!=t.length;++a){var s=De(t[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;r.cp=i[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=s.val;break;case"<sz":r.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting"}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":s.rgb&&(r.color=s.rgb.slice(2,8));break;case"<family":r.family=s.val;break;case"<vertAlign":r.valign=s.val;break;case"<scheme":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(47!==s[0].charCodeAt(1)&&!n)throw new Error("Unrecognized rich format "+s[0])}}return r}var pf=function(){var e=Je("t"),r=Je("rPr");function t(t){var a=t.match(e);if(!a)return{t:"s",v:""};var n={t:"s",v:Ne(a[1])},i=t.match(r);return i&&(n.s=vf(i[1])),n}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function i(e){return e.replace(a,"").split(n).map(t).filter((function(e){return e.v}))}}(),mf=function Sb(){var e=/(\r\n|\n)/g;function r(e,r,t){var a=[];e.u&&a.push("text-decoration: underline;"),e.uval&&a.push("text-underline-style:"+e.uval+";"),e.sz&&a.push("font-size:"+e.sz+"pt;"),e.outline&&a.push("text-effect: outline;"),e.shadow&&a.push("text-shadow: auto;"),r.push('<span style="'+a.join("")+'">'),e.b&&(r.push("<b>"),t.push("</b>")),e.i&&(r.push("<i>"),t.push("</i>")),e.strike&&(r.push("<s>"),t.push("</s>"));var n=e.valign||"";return"superscript"==n||"super"==n?n="sup":"subscript"==n&&(n="sub"),""!=n&&(r.push("<"+n+">"),t.push("</"+n+">")),t.push("</span>"),e}function t(t){var a=[[],t.v,[]];return t.v?(t.s&&r(t.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function a(e){return e.map(t).join("")}}(),bf=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,gf=/<(?:\w+:)?r>/,wf=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function kf(e,r){var t=!r||r.cellHTML,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Ne(Ke(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Ke(e),t&&(a.h=ze(a.t))):e.match(gf)&&(a.r=Ke(e),a.t=Ne(Ke((e.replace(wf,"").match(bf)||[]).join("").replace(Ae,""))),t&&(a.h=mf(pf(a.r)))),a):null}var Ef=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Sf=/<(?:\w+:)?(?:si|sstItem)>/g,_f=/<\/(?:\w+:)?(?:si|sstItem)>/;function Cf(e,r){var t=[],a="";if(!e)return t;var n=e.match(Ef);if(n){a=n[2].replace(Sf,"").split(_f);for(var i=0;i!=a.length;++i){var s=kf(a[i].trim(),r);null!=s&&(t[t.length]=s)}n=De(n[1]),t.Count=n.count,t.Unique=n.uniqueCount}return t}Na.SST="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings";var Bf=/^\s|\s$|[\t\n\r]/;function Tf(e,r){if(!r.bookSST)return"";var t=[ye];t[t.length]=fr("sst",null,{xmlns:cr.main[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(null!=e[a]){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(Bf)&&(i+=' xml:space="preserve"'),i+=">"+Ue(n.t)+"</t>"),i+="</si>",t[t.length]=i}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function yf(e){return[e._R(4),e._R(4)]}function xf(e,r){var t=[],a=!1;return Zr(e,(function n(e,i,s){switch(s){case 159:t.Count=e[0],t.Unique=e[1];break;case 19:t.push(e);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(i.indexOf("Begin")>0||i.indexOf("End"),!a||r.WTF)throw new Error("Unexpected record "+s+" "+i)}})),t}function Af(e,r){return r||(r=$r(8)),r._W(4,e.Count),r._W(4,e.Unique),r}var If=It;function Rf(e){var r=Qr();Jr(r,"BrtBeginSst",Af(e));for(var t=0;t<e.length;++t)Jr(r,"BrtSSTItem",If(e[t]));return Jr(r,"BrtEndSst"),r.end()}function Df(e){if("undefined"!=typeof cptable)return cptable.utils.encode(t,e);for(var r=[],a=e.split(""),n=0;n<a.length;++n)r[n]=a[n].charCodeAt(0);return r}function Ff(e,r){var t={};return t.Major=e._R(2),t.Minor=e._R(2),r>=4&&(e.l+=r-4),t}function Of(e){var r={};return r.id=e._R(0,"lpp4"),r.R=Ff(e,4),r.U=Ff(e,4),r.W=Ff(e,4),r}function Pf(e){for(var r=e._R(4),t=e.l+r-4,a={},n=e._R(4),i=[];n-- >0;)i.push({t:e._R(4),v:e._R(0,"lpp4")});if(a.name=e._R(0,"lpp4"),a.comps=i,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return a}function Nf(e){var r=[];e.l+=4;for(var t=e._R(4);t-- >0;)r.push(Pf(e));return r}function Lf(e){var r=[];e.l+=4;for(var t=e._R(4);t-- >0;)r.push(e._R(0,"lpp4"));return r}function Mf(e){var r={};return e._R(4),e.l+=4,r.id=e._R(0,"lpp4"),r.name=e._R(0,"lpp4"),r.R=Ff(e,4),r.U=Ff(e,4),r.W=Ff(e,4),r}function Uf(e){var r=Mf(e);if(r.ename=e._R(0,"8lpp4"),r.blksz=e._R(4),r.cmode=e._R(4),4!=e._R(4))throw new Error("Bad !Primary record");return r}function Hf(e,r){var t=e.l+r,a={};a.Flags=63&e._R(4),e.l+=4,a.AlgID=e._R(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=36==a.Flags;break;case 26625:n=4==a.Flags;break;case 0:n=16==a.Flags||4==a.Flags||36==a.Flags;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e._R(4),a.KeySize=e._R(4),a.ProviderType=e._R(4),e.l+=8,a.CSPName=e._R(t-e.l>>1,"utf16le"),e.l=t,a}function Wf(e,r){var t={},a=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e._R(4),t.VerifierHash=e.slice(e.l,a),e.l=a,t}function zf(e){var r=Ff(e);switch(r.Minor){case 2:return[r.Minor,Vf(e,r)];case 3:return[r.Minor,Xf(e,r)];case 4:return[r.Minor,Gf(e,r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function Vf(e){var r;if(36!=(63&e._R(4)))throw new Error("EncryptionInfo mismatch");var t=e._R(4),a,n;return{t:"Std",h:Hf(e,t),v:Wf(e,e.length-e.l)}}function Xf(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Gf(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e._R(e.length-e.l,"utf8"),a={};return t.replace(Ae,(function n(e){var t=De(e);switch(Fe(t[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach((function(e){a[e]=t[e]}));break;case"<dataIntegrity":a.encryptedHmacKey=t.encryptedHmacKey,a.encryptedHmacValue=t.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=t.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(t);break;default:throw t[0]}})),a}function jf(e,r){var t={},a=t.EncryptionVersionInfo=Ff(e,4);if(r-=4,2!=a.Minor)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);t.Flags=e._R(4),r-=4;var n=e._R(4);return r-=4,t.EncryptionHeader=Hf(e,n),r-=n,t.EncryptionVerifier=Wf(e,r),t}function Kf(e){var r={},t=r.EncryptionVersionInfo=Ff(e,4);if(1!=t.Major||1!=t.Minor)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e._R(16),r.EncryptedVerifier=e._R(16),r.EncryptedVerifierHash=e._R(16),r}function Yf(e){var r=0,t,a=Df(e),n=a.length+1,i,s,f,l,o;for((t=_(n))[0]=a.length,i=1;i!=n;++i)t[i]=a[i-1];for(i=n-1;i>=0;--i)r=(o=(f=0==(16384&r)?0:1)|(l=r<<1&32767))^(s=t[i]);return 52811^r}var $f=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(e){return 255&(e/2|128*e)},n=function(e,r){return a(e^r)},i=function(e){for(var a=r[e.length-1],n=104,i=e.length-1;i>=0;--i)for(var s=e[i],f=0;7!=f;++f)64&s&&(a^=t[n]),s*=2,--n;return a};return function(r){for(var t=Df(r),a=i(t),s=t.length,f=_(16),l=0,o,c,u;16!=l;++l)f[l]=0;for(1==(1&s)&&(o=a>>8,f[s]=n(e[0],o),--s,o=255&a,c=t[t.length-1],f[s]=n(c,o));s>0;)o=a>>8,f[--s]=n(t[s],o),o=255&a,f[--s]=n(t[s],o);for(s=15,u=15-t.length;u>0;)o=a>>8,f[s]=n(e[u],o),--u,o=255&a,f[--s]=n(t[s],o),--s,--u;return f}}(),Zf=function(e,r,t,a,n){var i,s;for(n||(n=r),a||(a=$f(e)),i=0;i!=r.length;++i)s=r[i],s=255&((s^=a[t])>>5|s<<3),n[i]=s,++t;return[n,t,a]},Qf=function(e){var r=0,t=$f(e);return function(e){var a=Zf("",e,r,t);return r=a[1],a[0]}};function Jf(e,r,t,a){var n={key:jn(e),verificationBytes:jn(e)};return t.password&&(n.verifier=Yf(t.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=Qf(t.password)),n}function qf(e,r,t){var a=t||{};return a.Info=e._R(2),e.l-=2,1===a.Info?a.Data=Kf(e,r):a.Data=jf(e,r),a}function el(e,r,t){var a={Type:t.biff>=8?e._R(2):0};return a.Type?qf(e,r-2,a):Jf(e,t.biff>=8?r:r-2,t,a),a}var rl=function(){function e(e,t){switch(t.type){case"base64":return r(g.decode(e),t);case"binary":return r(e,t);case"buffer":return r(e.toString("binary"),t);case"array":return r(fe(e),t)}throw new Error("Unrecognized type "+t.type)}function r(e,r){var t,a=(r||{}).dense?[]:{},n={s:{c:0,r:0},e:{c:0,r:0}};if(!e.match(/\\trowd/))throw new Error("RTF missing table");return a["!ref"]=bt(n),a}function t(r,t){return Et(e(r,t),t)}function a(e){for(var r=["{\\rtf1\\ansi"],t=gt(e["!ref"]),a,n=Array.isArray(e),i=t.s.r;i<=t.e.r;++i){r.push("\\trowd\\trautofit1");for(var s=t.s.c;s<=t.e.c;++s)r.push("\\cellx"+(s+1));for(r.push("\\pard\\intbl"),s=t.s.c;s<=t.e.c;++s){var f=pt({r:i,c:s});(a=n?(e[i]||[])[s]:e[f])&&(null!=a.v||a.f&&!a.F)&&(r.push(" "+(a.w||(kt(a),a.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:a}}();function tl(e){var r=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function al(e){for(var r=0,t=1;3!=r;++r)t=256*t+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function nl(e){var r=e[0]/255,t=e[1]/255,a=e[2]/255,n=Math.max(r,t,a),i=Math.min(r,t,a),s=n-i;if(0===s)return[0,0,r];var f=0,l=0,o=n+i;switch(l=s/(o>1?2-o:o),n){case r:f=((t-a)/s+6)%6;break;case t:f=(a-r)/s+2;break;case a:f=(r-t)/s+4}return[f/6,l,o/2]}function il(e){var r=e[0],t=e[1],a=e[2],n=2*t*(a<.5?a:1-a),i=a-n/2,s=[i,i,i],f=6*r,l;if(0!==t)switch(0|f){case 0:case 6:l=n*f,s[0]+=n,s[1]+=l;break;case 1:l=n*(2-f),s[0]+=l,s[1]+=n;break;case 2:l=n*(f-2),s[1]+=n,s[2]+=l;break;case 3:l=n*(4-f),s[1]+=l,s[2]+=n;break;case 4:l=n*(f-4),s[2]+=n,s[0]+=l;break;case 5:l=n*(6-f),s[2]+=l,s[0]+=n}for(var o=0;3!=o;++o)s[o]=Math.round(255*s[o]);return s}function sl(e,r){if(0===r)return e;var t=nl(tl(e));return t[2]=r<0?t[2]*(1+r):1-(1-t[2])*(1-r),al(il(t))}var fl=6,ll=15,ol=1,cl=6;function ul(e){return Math.floor((e+Math.round(128/cl)/256)*cl)}function hl(e){return Math.floor((e-5)/cl*100+.5)/100}function dl(e){return Math.round((e*cl+5)/cl*256)/256}function vl(e){return dl(hl(ul(e)))}function pl(e){var r=Math.abs(e-vl(e)),t=cl;if(r>.005)for(cl=1;cl<15;++cl)Math.abs(e-vl(e))<=r&&(r=Math.abs(e-vl(e)),t=cl);cl=t}function ml(e){e.width?(e.wpx=ul(e.width),e.wch=hl(e.wpx),e.MDW=cl):e.wpx?(e.wch=hl(e.wpx),e.width=dl(e.wch),e.MDW=cl):"number"==typeof e.wch&&(e.width=dl(e.wch),e.wpx=ul(e.width),e.MDW=cl),e.customWidth&&delete e.customWidth}var bl=96,gl=96;function wl(e){return 96*e/96}function kl(e){return 96*e/96}var El={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Sl(e,r,t,a){r.Borders=[];var n={},i=!1;(e[0].match(Ae)||[]).forEach((function(e){var t=De(e);switch(Fe(t[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},t.diagonalUp&&(n.diagonalUp=je(t.diagonalUp)),t.diagonalDown&&(n.diagonalDown=je(t.diagonalDown)),r.Borders.push(n);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+t[0]+" in borders")}}))}function _l(e,r,t,a){r.Fills=[];var n={},i=!1;(e[0].match(Ae)||[]).forEach((function(e){var t=De(e);switch(Fe(t[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},r.Fills.push(n);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":t.patternType&&(n.patternType=t.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),t.indexed&&(n.bgColor.indexed=parseInt(t.indexed,10)),t.theme&&(n.bgColor.theme=parseInt(t.theme,10)),t.tint&&(n.bgColor.tint=parseFloat(t.tint)),t.rgb&&(n.bgColor.rgb=t.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),t.theme&&(n.fgColor.theme=parseInt(t.theme,10)),t.tint&&(n.fgColor.tint=parseFloat(t.tint)),null!=t.rgb&&(n.fgColor.rgb=t.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+t[0]+" in fills")}}))}function Cl(e,r,t,a){r.Fonts=[];var n={},s=!1;(e[0].match(Ae)||[]).forEach((function(e){var f=De(e);switch(Fe(f[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(n),n={};break;case"<name":f.val&&(n.name=f.val);break;case"<name/>":case"</name>":break;case"<b":n.bold=f.val?je(f.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=f.val?je(f.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(f.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=f.val?je(f.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=f.val?je(f.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=f.val?je(f.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=f.val?je(f.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=f.val?je(f.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":f.val&&(n.sz=+f.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":f.val&&(n.vertAlign=f.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":f.val&&(n.family=parseInt(f.val,10));break;case"<family/>":case"</family>":break;case"<scheme":f.val&&(n.scheme=f.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if("1"==f.val)break;f.codepage=i[parseInt(f.val,10)];break;case"<color":if(n.color||(n.color={}),f.auto&&(n.color.auto=je(f.auto)),f.rgb)n.color.rgb=f.rgb.slice(-6);else if(f.indexed){n.color.index=parseInt(f.indexed,10);var l=ya[n.color.index];if(81==n.color.index&&(l=ya[1]),!l)throw new Error(e);n.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else f.theme&&(n.color.theme=parseInt(f.theme,10),f.tint&&(n.color.tint=parseFloat(f.tint)),f.theme&&t.themeElements&&t.themeElements.clrScheme&&(n.color.rgb=sl(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+f[0]+" in fonts")}}))}function Bl(e,r,t){r.NumberFmt=[];for(var a=K(F._table),n=0;n<a.length;++n)r.NumberFmt[a[n]]=F._table[a[n]];var i=e[0].match(Ae);if(i)for(n=0;n<i.length;++n){var s=De(i[n]);switch(Fe(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var f=Ne(Ke(s.formatCode)),l=parseInt(s.numFmtId,10);if(r.NumberFmt[l]=f,l>0){if(l>392){for(l=392;l>60&&null!=r.NumberFmt[l];--l);r.NumberFmt[l]=f}F.load(f,l)}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function Tl(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(t){for(var a=t[0];a<=t[1];++a)null!=e[a]&&(r[r.length]=fr("numFmt",null,{numFmtId:a,formatCode:Ue(e[a])}))})),1===r.length?"":(r[r.length]="</numFmts>",r[0]=fr("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var yl=["numFmtId","fillId","fontId","borderId","xfId"],xl=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Al(e,r,t){var a;r.CellXf=[];var n=!1;(e[0].match(Ae)||[]).forEach((function(e){var i=De(e),s=0;switch(Fe(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(a=i)[0],s=0;s<yl.length;++s)a[yl[s]]&&(a[yl[s]]=parseInt(a[yl[s]],10));for(s=0;s<xl.length;++s)a[xl[s]]&&(a[xl[s]]=je(a[xl[s]]));if(a.numFmtId>392)for(s=392;s>60;--s)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[s]){a.numFmtId=s;break}r.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};i.vertical&&(f.vertical=i.vertical),i.horizontal&&(f.horizontal=i.horizontal),null!=i.textRotation&&(f.textRotation=i.textRotation),i.indent&&(f.indent=i.indent),i.wrapText&&(f.wrapText=je(i.wrapText)),a.alignment=f;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(t&&t.WTF&&!n)throw new Error("unrecognized "+i[0]+" in cellXfs")}}))}function Il(e){var r=[];return r[r.length]=fr("cellXfs",null),e.forEach((function(e){r[r.length]=fr("xf",null,e)})),r[r.length]="</cellXfs>",2===r.length?"":(r[0]=fr("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var Rl=function _b(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,t=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function i(s,f,l){var o={},c;return s?((c=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&Bl(c,o,l),(c=s.match(a))&&Cl(c,o,f,l),(c=s.match(t))&&_l(c,o,f,l),(c=s.match(n))&&Sl(c,o,f,l),(c=s.match(r))&&Al(c,o,l),o):o}}(),Dl=fr("styleSheet",null,{xmlns:cr.main[0],"xmlns:vt":cr.vt});function Fl(e,r){var t=[ye,Dl],a;return e.SSF&&null!=(a=Tl(e.SSF))&&(t[t.length]=a),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Il(r.cellXfs))&&(t[t.length]=a),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Ol(e,r){var t,a;return[e._R(2),Bt(e,r-2)]}function Pl(e,r,t){t||(t=$r(6+4*r.length)),t._W(2,e),Tt(r,t);var a=t.length>t.l?t.slice(0,t.l):t;return null==t.l&&(t.l=t.length),a}function Nl(e,r,t){var a={};a.sz=e._R(2)/20;var n=ea(e,2,t),i;switch(n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1),700===e._R(2)&&(a.bold=1),e._R(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript"}var s=e._R(1);0!=s&&(a.underline=s);var f=e._R(1);f>0&&(a.family=f);var l=e._R(1);switch(l>0&&(a.charset=l),e.l++,a.color=Jt(e,8),e._R(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor"}return a.name=Bt(e,r-21),a}function Ll(e,r){r||(r=$r(153)),r._W(2,20*e.sz),ra(e,r),r._W(2,e.bold?700:400);var t=0;"superscript"==e.vertAlign?t=1:"subscript"==e.vertAlign&&(t=2),r._W(2,t),r._W(1,e.underline||0),r._W(1,e.family||0),r._W(1,e.charset||0),r._W(1,0),qt(e.color,r);var a=0;return"major"==e.scheme&&(a=1),"minor"==e.scheme&&(a=2),r._W(1,a),Tt(e.name,r),r.length>r.l?r.slice(0,r.l):r}Na.STY="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles";var Ml,Ul=Z(["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"]),Hl=Yr;function Wl(e,r){r||(r=$r(84));var t=Ul[e.patternType];null==t&&(t=40),r._W(4,t);var a=0;if(40!=t)for(qt({auto:1},r),qt({auto:1},r);a<12;++a)r._W(4,0);else{for(;a<4;++a)r._W(4,0);for(;a<12;++a)r._W(4,0)}return r.length>r.l?r.slice(0,r.l):r}function zl(e,r){var t=e.l+r,a=e._R(2),n=e._R(2);return e.l=t,{ixfe:a,numFmtId:n}}function Vl(e,r,t){t||(t=$r(16)),t._W(2,r||0),t._W(2,e.numFmtId||0),t._W(2,0),t._W(2,0),t._W(2,0),t._W(1,0),t._W(1,0);var a=0;return t._W(1,0),t._W(1,0),t._W(1,0),t._W(1,0),t}function Xl(e,r){return r||(r=$r(10)),r._W(1,0),r._W(1,0),r._W(4,0),r._W(4,0),r}var Gl=Yr;function jl(e,r){return r||(r=$r(51)),r._W(1,0),Xl(null,r),Xl(null,r),Xl(null,r),Xl(null,r),Xl(null,r),r.length>r.l?r.slice(0,r.l):r}function Kl(e,r){return r||(r=$r(52)),r._W(4,e.xfId),r._W(2,1),r._W(1,+e.builtinId),r._W(1,0),Mt(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function Yl(e,r,t){var a=$r(2052);return a._W(4,e),Mt(r,a),Mt(t,a),a.length>a.l?a.slice(0,a.l):a}function $l(e,r,t){var a={NumberFmt:[]};for(var n in F._table)a.NumberFmt[n]=F._table[n];a.CellXf=[],a.Fonts=[];var i=[],s=!1;return Zr(e,(function f(e,n,l){switch(l){case 44:a.NumberFmt[e[0]]=e[1],F.load(e[1],e[0]);break;case 43:a.Fonts.push(e),null!=e.color.theme&&r&&r.themeElements&&r.themeElements.clrScheme&&(e.color.rgb=sl(r.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:break;case 47:"BrtBeginCellXFs"==i[i.length-1]&&a.CellXf.push(e);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(n),s=!0;break;case 38:i.pop(),s=!1;break;default:if((n||"").indexOf("Begin")>0)i.push(n);else if((n||"").indexOf("End")>0)i.pop();else if(!s||t.WTF&&"BrtACBegin"!=i[i.length-1])throw new Error("Unexpected record "+l+" "+n)}})),a}function Zl(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach((function(e){for(var a=e[0];a<=e[1];++a)null!=r[a]&&++t})),0!=t&&(Jr(e,"BrtBeginFmts",Ct(t)),[[5,8],[23,26],[41,44],[50,392]].forEach((function(t){for(var a=t[0];a<=t[1];++a)null!=r[a]&&Jr(e,"BrtFmt",Pl(a,r[a]))})),Jr(e,"BrtEndFmts"))}}function Ql(e){var r=1;Jr(e,"BrtBeginFonts",Ct(1)),Jr(e,"BrtFont",Ll({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Jr(e,"BrtEndFonts")}function Jl(e){var r=2;Jr(e,"BrtBeginFills",Ct(2)),Jr(e,"BrtFill",Wl({patternType:"none"})),Jr(e,"BrtFill",Wl({patternType:"gray125"})),Jr(e,"BrtEndFills")}function ql(e){var r=1;Jr(e,"BrtBeginBorders",Ct(1)),Jr(e,"BrtBorder",jl({})),Jr(e,"BrtEndBorders")}function eo(e){var r=1;Jr(e,"BrtBeginCellStyleXFs",Ct(1)),Jr(e,"BrtXF",Vl({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Jr(e,"BrtEndCellStyleXFs")}function ro(e,r){Jr(e,"BrtBeginCellXFs",Ct(r.length)),r.forEach((function(r){Jr(e,"BrtXF",Vl(r,0))})),Jr(e,"BrtEndCellXFs")}function to(e){var r=1;Jr(e,"BrtBeginStyles",Ct(1)),Jr(e,"BrtStyle",Kl({xfId:0,builtinId:0,name:"Normal"})),Jr(e,"BrtEndStyles")}function ao(e){var r=0;Jr(e,"BrtBeginDXFs",Ct(0)),Jr(e,"BrtEndDXFs")}function no(e){var r=0;Jr(e,"BrtBeginTableStyles",Yl(0,"TableStyleMedium9","PivotStyleMedium4")),Jr(e,"BrtEndTableStyles")}function io(){}function so(e,r){var t=Qr();return Jr(t,"BrtBeginStyleSheet"),Zl(t,e.SSF),Ql(t,e),Jl(t,e),ql(t,e),eo(t,e),ro(t,r.cellXfs),to(t,e),ao(t,e),no(t,e),Jr(t,"BrtEndStyleSheet"),t.end()}function fo(e,r,t){r.themeElements.clrScheme=[];var a={};(e[0].match(Ae)||[]).forEach((function(e){var n=De(e);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=n.val;break;case"<a:sysClr":a.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===n[0].charAt(1)?(r.themeElements.clrScheme.push(a),a={}):a.name=n[0].slice(3,n[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}}))}function lo(){}function oo(){}Na.THEME="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme";var co=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,uo=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ho=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function vo(e,r,t){var a;r.themeElements={},[["clrScheme",co,fo],["fontScheme",uo,lo],["fmtScheme",ho,oo]].forEach((function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,r,t)}))}var po=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function mo(e,r){if(!e||0===e.length)return mo(bo());var t,a={};if(!(t=e.match(po)))throw new Error("themeElements not found in theme");return vo(t[0],a,r),a.raw=e,a}function bo(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var t=[ye];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function go(e,r,t){var a=e.l+r,n;if(124226!==e._R(4))if(t.cellStyles&&_e){var i=e.slice(e.l),s;e.l=a;try{s=new _e(i)}catch(f){return}var l=ke(s,"theme/theme/theme1.xml",!0);if(l)return mo(l,t)}else e.l=a}function wo(e){return e._R(4)}function ko(e){var r={};switch(r.xclrType=e._R(2),r.nTintShade=e._R(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=Eo(e,4);break;case 2:r.xclrValue=ci(e,4);break;case 3:r.xclrValue=wo(e,4);break;case 4:e.l+=4}return e.l+=8,r}function Eo(e,r){return Yr(e,r)}function So(e,r){return Yr(e,r)}function _o(e){var r=e._R(2),t=e._R(2)-4,a=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=ko(e,t);break;case 6:a[1]=So(e,t);break;case 14:case 15:a[1]=e._R(1===t?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return a}function Co(e,r){var t=e.l+r;e.l+=2;var a=e._R(2);e.l+=2;for(var n=e._R(2),i=[];n-- >0;)i.push(_o(e,t-e.l));return{ixfe:a,ext:i}}function Bo(e,r){r.forEach((function(e){e[0]}))}function To(e){var r=[];if(!e)return r;var t=1;return(e.match(Ae)||[]).forEach((function(e){var a=De(e);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a)}})),r}function yo(e){var r={};r.i=e._R(4);var t={};t.r=e._R(4),t.c=e._R(4),r.r=pt(t);var a=e._R(1);return 2&a&&(r.l="1"),8&a&&(r.a="1"),r}function xo(e,r,t){var a=[],n=!1;return Zr(e,(function i(e,r,s){switch(s){case 63:a.push(e);break;default:if((r||"").indexOf("Begin")>0);else if(!((r||"").indexOf("End")>0))throw new Error("Unexpected record "+s+" "+r)}})),a}function Ao(){}function Io(e,r,t,a){if(!e)return e;var n=a||{},i=!1,s=!1;Zr(e,(function f(e,r,t){switch(t){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if((r||"").indexOf("Begin")>0);else if((r||"").indexOf("End")>0);else if(!i||n.WTF)throw new Error("Unexpected record "+t.toString(16)+" "+r)}}),n)}function Ro(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}Na.IMG="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Na.DRAW="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing";var Do=1024;function Fo(e,r){for(var t=[21600,21600],a=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),n=[fr("xml",null,{"xmlns:v":ur_v,"xmlns:o":ur_o,"xmlns:x":ur_x,"xmlns:mv":ur_mv}).replace(/\/>/,">"),fr("o:shapelayout",fr("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),fr("v:shapetype",[fr("v:stroke",null,{joinstyle:"miter"}),fr("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:a})];Do<1e3*e;)Do+=1e3;return r.forEach((function(e){var r=vt(e[0]),t={color2:"#BEFF82",type:"gradient"};"gradient"==t.type&&(t.angle="-180");var a="gradient"==t.type?fr("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,i=fr("v:fill",a,t),s={on:"t",obscured:"t"};++Do,n=n.concat(["<v:shape"+sr({id:"_x0000_s"+Do,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",i,fr("v:shadow",null,s),fr("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ir("x:Anchor",[r.c+1,0,r.r+1,0,r.c+3,20,r.r+5,20].join(",")),ir("x:AutoFill","False"),ir("x:Row",String(r.r)),ir("x:Column",String(r.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])})),n.push("</xml>"),n.join("")}function Oo(e,r){var t=Array.isArray(e),a;r.forEach((function(r){var n=vt(r.ref);if(t?(e[n.r]||(e[n.r]=[]),a=e[n.r][n.c]):a=e[r.ref],!a){a={t:"z"},t?e[n.r][n.c]=a:e[r.ref]=a;var i=gt(e["!ref"]||"BDWGO1000001:A1");i.s.r>n.r&&(i.s.r=n.r),i.e.r<n.r&&(i.e.r=n.r),i.s.c>n.c&&(i.s.c=n.c),i.e.c<n.c&&(i.e.c=n.c);var s=bt(i);s!==e["!ref"]&&(e["!ref"]=s)}a.c||(a.c=[]);var f={a:r.author,t:r.t,r:r.r};r.h&&(f.h=r.h),a.c.push(f)}))}function Po(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var r=e.match(/<(?:\w+:)?author[^>]*>(.*)/);r&&t.push(r[1])}}));var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var n=e.match(/<(?:\w+:)?comment[^>]*>/);if(n){var i=De(n[0]),s={author:i.authorId&&t[i.authorId]||"sheetjsghost",ref:i.ref,guid:i.guid},f=vt(i.ref);if(!(r.sheetRows&&r.sheetRows<=f.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),o=!!l&&!!l[1]&&kf(l[1])||{r:"",t:"",h:""};s.r=o.r,"<t></t>"==o.r&&(o.t=o.h=""),s.t=o.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),r.cellHTML&&(s.h=o.h),a.push(s)}}}})),a}Na.CMNT="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments";var No=fr("comments",null,{xmlns:cr.main[0]});function Lo(e){var r=[ye,No],t=[];return r.push("<authors>"),e.forEach((function(e){e[1].forEach((function(e){var a=Ue(e.a);t.indexOf(a)>-1||(t.push(a),r.push("<author>"+a+"</author>"))}))})),r.push("</authors>"),r.push("<commentList>"),e.forEach((function(e){e[1].forEach((function(a){r.push('<comment ref="'+e[0]+'" authorId="'+t.indexOf(Ue(a.a))+'"><text>'),r.push(ir("t",null==a.t?"":Ue(a.t))),r.push("</text></comment>")}))})),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Mo(e){var r={};r.iauthor=e._R(4);var t=jt(e,16);return r.rfx=t.s,r.ref=pt(t.s),e.l+=16,r}function Uo(e,r){return null==r&&(r=$r(36)),r._W(4,e[1].iauthor),Kt(e[0],r),r._W(4,0),r._W(4,0),r._W(4,0),r._W(4,0),r}var Ho=Bt;function Wo(e){return Tt(e.slice(0,54))}function zo(e,r){var t=[],a=[],n={},i=!1;return Zr(e,(function s(e,f,l){switch(l){case 632:a.push(e);break;case 635:n=e;break;case 637:n.t=e.t,n.h=e.h,n.r=e.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,r.sheetRows&&n.rfx&&r.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,t.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:case 38:break;default:if((f||"").indexOf("Begin")>0);else if((f||"").indexOf("End")>0);else if(!i||r.WTF)throw new Error("Unexpected record "+l+" "+f)}})),t}function Vo(e){var r=Qr(),t=[];return Jr(r,"BrtBeginComments"),Jr(r,"BrtBeginCommentAuthors"),e.forEach((function(e){e[1].forEach((function(e){t.indexOf(e.a)>-1||(t.push(e.a.slice(0,54)),Jr(r,"BrtCommentAuthor",Wo(e.a)))}))})),Jr(r,"BrtEndCommentAuthors"),Jr(r,"BrtBeginCommentList"),e.forEach((function(e){e[1].forEach((function(a){a.iauthor=t.indexOf(a.a);var n={s:vt(e[0]),e:vt(e[0])};Jr(r,"BrtBeginComment",Uo([n,a])),a.t&&a.t.length>0&&Jr(r,"BrtCommentText",Dt(a)),Jr(r,"BrtEndComment"),delete a.iauthor}))})),Jr(r,"BrtEndCommentList"),Jr(r,"BrtEndComments"),r.end()}var Xo="application/vnd.ms-office.vbaProject";function Go(e){var r=z.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(t,a){if("/"!==t.slice(-1)&&t.match(/_VBA_PROJECT_CUR/)){var n=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");z.utils.cfb_add(r,n,e.FileIndex[a].content)}})),z.write(r)}function jo(e,r){r.FullPaths.forEach((function(t,a){if(0!=a){var n=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==n.slice(-1)&&z.utils.cfb_add(e,n,r.FileIndex[a].content)}}))}var Ko=["xlsb","xlsm","xlam","biff8","xla"];function Yo(){return{"!type":"dialog"}}function $o(){return{"!type":"dialog"}}function Zo(){return{"!type":"macro"}}function Qo(){return{"!type":"macro"}}Na.DS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",Na.MS="http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet";var Jo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(e,t,a,n){var i=!1,s=!1;0==a.length?s=!0:"["==a.charAt(0)&&(s=!0,a=a.slice(1,-1)),0==n.length?i=!0:"["==n.charAt(0)&&(i=!0,n=n.slice(1,-1));var f=a.length>0?0|parseInt(a,10):0,l=n.length>0?0|parseInt(n,10):0;return i?l+=r.c:--l,s?f+=r.r:--f,t+(i?"":"$")+ct(l)+(s?"":"$")+st(f)}return function a(n,i){return r=i,n.replace(e,t)}}(),qo=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)([1-9]\d{0,5}|10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6])(?![_.\(A-Za-z0-9])/g,ec=function e(r,t){return r.replace(qo,(function(e,r,a,n,i,s){var f=ot(n)-(a?0:t.c),l=it(s)-(i?0:t.r),o,c;return r+"R"+(0==l?"":i?l+1:"["+l+"]")+"C"+(0==f?"":a?f+1:"["+f+"]")}))},qc,eu,ru;function rc(e,r){return e.replace(qo,(function(e,t,a,n,i,s){return t+("$"==a?a+n:ct(ot(n)+r.c))+("$"==i?i+s:st(it(s)+r.r))}))}function tc(e,r,t){var a,n=mt(r).s,i=vt(t),s;return rc(e,{r:i.r-n.r,c:i.c-n.c})}function ac(e){return 1!=e.length}function nc(e){return e.replace(/_xlfn\./g,"")}function ic(e){e.l+=1}function sc(e,r){var t=e._R(1==r?1:2);return[16383&t,t>>14&1,t>>15&1]}function fc(e,r,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return lc(e,r,t);12==t.biff&&(a=4)}var n=e._R(a),i=e._R(a),s=sc(e,2),f=sc(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:f[0],cRel:f[1],rRel:f[2]}}}function lc(e){var r=sc(e,2),t=sc(e,2),a=e._R(1),n=e._R(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function oc(e,r,t){if(t.biff<8)return lc(e,r,t);var a=e._R(12==t.biff?4:2),n=e._R(12==t.biff?4:2),i=sc(e,2),s=sc(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:s[0],cRel:s[1],rRel:s[2]}}}function cc(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return uc(e,r,t);var a=e._R(t&&12==t.biff?4:2),n=sc(e,2);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function uc(e){var r=sc(e,2),t=e._R(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function hc(e){var r=e._R(2),t=e._R(2);return{r:r,c:255&t,fQuoted:!!(16384&t),cRel:t>>15,rRel:t>>15}}function dc(e,r,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return vc(e,r,t);var n=e._R(a>=12?4:2),i=e._R(2),s=(16384&i)>>14,f=(32768&i)>>15;if(i&=16383,1==f)for(;n>524287;)n-=1048576;if(1==s)for(;i>8191;)i-=16384;return{r:n,c:i,cRel:s,rRel:f}}function vc(e){var r=e._R(2),t=e._R(1),a=(32768&r)>>15,n=(16384&r)>>14;return r&=16383,1==a&&r>=8192&&(r-=16384),1==n&&t>=128&&(t-=256),{r:r,c:t,cRel:n,rRel:a}}function pc(e,r,t){var a,n;return[(96&e[e.l++])>>5,fc(e,t.biff>=2&&t.biff<=5?6:8,t)]}function mc(e,r,t){var a=(96&e[e.l++])>>5,n=e._R(2,"i"),i=8,s;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return[a,n,fc(e,i,t)]}function bc(e,r,t){var a=(96&e[e.l++])>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[a]}function gc(e,r,t){var a=(96&e[e.l++])>>5,n=e._R(2),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[a,n]}function wc(e,r,t){var a,n;return[(96&e[e.l++])>>5,oc(e,r-1,t)]}function kc(e,r,t){var a=(96&e[e.l++])>>5;return e.l+=2==t.biff?6:12==t.biff?14:7,[a]}function Ec(e){var r=1&e[e.l+1],t=1;return e.l+=4,[r,1]}function Sc(e,r,t){e.l+=2;for(var a=e._R(t&&2==t.biff?1:2),n=[],i=0;i<=a;++i)n.push(e._R(t&&2==t.biff?1:2));return n}function _c(e,r,t){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e._R(t&&2==t.biff?1:2)]}function Cc(e,r,t){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e._R(t&&2==t.biff?1:2)]}function Bc(e){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e._R(2)]}function Tc(e,r,t){var a=255&e[e.l+1]?1:0;return e.l+=t&&2==t.biff?3:4,[a]}function yc(e){var r,t;return[e._R(1),e._R(1)]}function xc(e){return e._R(2),yc(e,2)}function Ac(e){return e._R(2),yc(e,2)}function Ic(e,r,t){var a=(96&e[e.l])>>5,n;return e.l+=1,[a,cc(e,0,t)]}function Rc(e,r,t){var a=(96&e[e.l])>>5,n;return e.l+=1,[a,dc(e,0,t)]}function Dc(e,r,t){var a=(96&e[e.l])>>5;e.l+=1;var n=e._R(2),i;return t&&5==t.biff&&(e.l+=12),[a,n,cc(e,0,t)]}function Fc(e,r,t){var a=(96&e[e.l])>>5;e.l+=1;var n=e._R(t&&t.biff<=3?1:2);return[$u[n],Yu[n],a]}function Oc(e,r,t){var a=e[e.l++],n=e._R(1),i=t&&t.biff<=3?[88==a?-1:0,e._R(1)]:Pc(e);return[n,(0===i[0]?Yu:Ku)[i[1]]]}function Pc(e){return[e[e.l+1]>>7,32767&e._R(2)]}function Nc(e,r,t){e.l+=t&&2==t.biff?3:4}function Lc(e,r,t){return e.l++,t&&12==t.biff?[e._R(4,"i"),0]:[e._R(2),e._R(t&&2==t.biff?1:2)];var a,n}function Mc(e){return e.l++,Zt[e._R(1)]}function Uc(e){return e.l++,e._R(2)}function Hc(e){return e.l++,0!==e._R(1)}function Wc(e){return e.l++,Yt(e,8)}function zc(e,r,t){return e.l++,Qn(e,r-1,t)}function Vc(e,r){var t=[e._R(1)];if(12==r)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2}switch(t[0]){case 4:t[1]=Xn(e,1)?"TRUE":"FALSE",12!=r&&(e.l+=7);break;case 37:case 16:t[1]=Zt[e[e.l]],e.l+=12==r?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Yt(e,8);break;case 2:t[1]=ri(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Xc(e,r,t){for(var a=e._R(12==t.biff?4:2),n=[],i=0;i!=a;++i)n.push((12==t.biff?jt:wi)(e,8));return n}function Gc(e,r,t){var a=0,n=0;12==t.biff?(a=e._R(4),n=e._R(4)):(n=1+e._R(1),a=1+e._R(2)),t.biff>=2&&t.biff<8&&(--a,0==--n&&(n=256));for(var i=0,s=[];i!=a&&(s[i]=[]);++i)for(var f=0;f!=n;++f)s[i][f]=Vc(e,t.biff);return s}function jc(e,r,t){var a=e._R(1)>>>5&3,n=!t||t.biff>=8?4:2,i=e._R(n);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[a,0,i]}function Kc(e,r,t){return 5==t.biff?Yc(e,r,t):[e._R(1)>>>5&3,e._R(2),e._R(4)];var a,n,i}function Yc(e){var r=e._R(1)>>>5&3,t=e._R(2,"i");e.l+=8;var a=e._R(2);return e.l+=12,[r,t,a]}function $c(e,r,t){var a=e._R(1)>>>5&3,n;return e.l+=t&&2==t.biff?3:4,[a,e._R(t&&2==t.biff?1:2)]}function Zc(e,r,t){var a,n;return[e._R(1)>>>5&3,e._R(t&&2==t.biff?1:2)]}function Qc(e,r,t){var a=e._R(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,12==t.biff&&(e.l+=2),[a]}function Jc(e,r,t){var a=(96&e[e.l++])>>5,n=e._R(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[a,n]}function tu(e,r,t){return e.l+=2,[hc(e,4,t)]}function au(e){return e.l+=6,[]}var nu=tu,iu=au,su=au,fu=tu;function lu(e){return e.l+=2,[jn(e),1&e._R(2)]}var ou=tu,cu=lu,uu=au,hu=tu,du=tu,vu=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function pu(e){e.l+=2;var r=e._R(2),t=e._R(2),a=e._R(4),n=e._R(2),i=e._R(2),s;return{ixti:r,coltype:3&t,rt:vu[t>>2&31],idx:a,c:n,C:i}}function mu(e){return e.l+=2,[e._R(4)]}function bu(e,r,t){return e.l+=5,e.l+=2,e.l+=2==t.biff?1:4,["PTGSHEET"]}function gu(e,r,t){return e.l+=2==t.biff?4:5,["PTGENDSHEET"]}function wu(e){var r,t;return[e._R(1)>>>5&3,e._R(2)]}function ku(e){var r,t;return[e._R(1)>>>5&3,e._R(2)]}function Eu(e){return e.l+=4,[0,0]}var Su={1:{n:"PtgExp",f:Lc},2:{n:"PtgTbl",f:Yr},3:{n:"PtgAdd",f:ic},4:{n:"PtgSub",f:ic},5:{n:"PtgMul",f:ic},6:{n:"PtgDiv",f:ic},7:{n:"PtgPower",f:ic},8:{n:"PtgConcat",f:ic},9:{n:"PtgLt",f:ic},10:{n:"PtgLe",f:ic},11:{n:"PtgEq",f:ic},12:{n:"PtgGe",f:ic},13:{n:"PtgGt",f:ic},14:{n:"PtgNe",f:ic},15:{n:"PtgIsect",f:ic},16:{n:"PtgUnion",f:ic},17:{n:"PtgRange",f:ic},18:{n:"PtgUplus",f:ic},19:{n:"PtgUminus",f:ic},20:{n:"PtgPercent",f:ic},21:{n:"PtgParen",f:ic},22:{n:"PtgMissArg",f:ic},23:{n:"PtgStr",f:zc},26:{n:"PtgSheet",f:bu},27:{n:"PtgEndSheet",f:gu},28:{n:"PtgErr",f:Mc},29:{n:"PtgBool",f:Hc},30:{n:"PtgInt",f:Uc},31:{n:"PtgNum",f:Wc},32:{n:"PtgArray",f:kc},33:{n:"PtgFunc",f:Fc},34:{n:"PtgFuncVar",f:Oc},35:{n:"PtgName",f:jc},36:{n:"PtgRef",f:Ic},37:{n:"PtgArea",f:pc},38:{n:"PtgMemArea",f:$c},39:{n:"PtgMemErr",f:Yr},40:{n:"PtgMemNoMem",f:Yr},41:{n:"PtgMemFunc",f:Zc},42:{n:"PtgRefErr",f:Qc},43:{n:"PtgAreaErr",f:bc},44:{n:"PtgRefN",f:Rc},45:{n:"PtgAreaN",f:wc},46:{n:"PtgMemAreaN",f:wu},47:{n:"PtgMemNoMemN",f:ku},57:{n:"PtgNameX",f:Kc},58:{n:"PtgRef3d",f:Dc},59:{n:"PtgArea3d",f:mc},60:{n:"PtgRefErr3d",f:Jc},61:{n:"PtgAreaErr3d",f:gc},255:{}},_u={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61};!function(){for(var e in _u)Su[e]=Su[_u[e]]}();var Cu={1:{n:"PtgElfLel",f:lu},2:{n:"PtgElfRw",f:hu},3:{n:"PtgElfCol",f:nu},6:{n:"PtgElfRwV",f:du},7:{n:"PtgElfColV",f:fu},10:{n:"PtgElfRadical",f:ou},11:{n:"PtgElfRadicalS",f:uu},13:{n:"PtgElfColS",f:iu},15:{n:"PtgElfColSV",f:su},16:{n:"PtgElfRadicalLel",f:cu},25:{n:"PtgList",f:pu},29:{n:"PtgSxName",f:mu},255:{}},Bu={0:{n:"PtgAttrNoop",f:Eu},1:{n:"PtgAttrSemi",f:Tc},2:{n:"PtgAttrIf",f:Cc},4:{n:"PtgAttrChoose",f:Sc},8:{n:"PtgAttrGoto",f:_c},16:{n:"PtgAttrSum",f:Nc},32:{n:"PtgAttrBaxcel",f:Ec},64:{n:"PtgAttrSpace",f:xc},65:{n:"PtgAttrSpaceSemi",f:Ac},128:{n:"PtgAttrIfError",f:Bc},255:{}};function Tu(e,r,t,a){if(a.biff<8)return Yr(e,r);for(var n=e.l+r,i=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=Gc(e,0,a),i.push(t[s][1]);break;case"PtgMemArea":t[s][2]=Xc(e,t[s][1],a),i.push(t[s][2]);break;case"PtgExp":a&&12==a.biff&&(t[s][1][1]=e._R(4),i.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0]}return 0!==(r=n-e.l)&&i.push(Yr(e,r)),i}function yu(e,r,t){for(var a=e.l+r,n,i,s=[];a!=e.l;)r=a-e.l,i=e[e.l],n=Su[i],24!==i&&25!==i||(n=(24===i?Cu:Bu)[e[e.l+1]]),n&&n.f?s.push([n.n,n.f(e,r,t)]):Yr(e,r);return s}function xu(e){for(var r=[],t=0;t<e.length;++t){for(var a=e[t],n=[],i=0;i<a.length;++i){var s=a[i];if(s)switch(s[0]){case 2:n.push('"'+s[1].replace(/"/g,'""')+'"');break;default:n.push(s[1])}else n.push("")}r.push(n.join(","))}return r.join(";")}Bu[33]=Bu[32];var Au={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Iu(e,r){if(!(e||r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return e.indexOf(" ")>-1?"'"+e+"'":e}function Ru(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),0==r?"":e.XTI[r-1];if(!a)return"SH33TJSERR1";var n="";if(t.biff>8)switch(e[a[0]][0]){case 357:return n=-1==a[1]?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return null!=t.SID?e.SheetNames[t.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=-1==a[1]?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[a[0]][0][3]?(n=-1==a[1]?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Du(e,r,t){return Iu(Ru(e,r,t),t)}function Fu(e,r,t,a,n){var i=n&&n.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},f=[],l,o,c,u=0,h=0,d,v="";if(!e[0]||!e[0][0])return"";for(var p=-1,m="",b=0,g=e[0].length;b<g;++b){var w=e[0][b];switch(w[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=f.pop(),o=f.pop(),p>=0){switch(e[0][p][1][0]){case 0:m=oe(" ",e[0][p][1][1]);break;case 1:m=oe("\r",e[0][p][1][1]);break;default:if(m="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}o+=m,p=-1}f.push(o+Au[w[0]]+l);break;case"PtgIsect":l=f.pop(),o=f.pop(),f.push(o+" "+l);break;case"PtgUnion":l=f.pop(),o=f.pop(),f.push(o+","+l);break;case"PtgRange":l=f.pop(),o=f.pop(),f.push(o+":"+l);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":c=qr(w[1][1],s,n),f.push(rt(c,i));break;case"PtgRefN":c=t?qr(w[1][1],t,n):w[1][1],f.push(rt(c,i));break;case"PtgRef3d":u=w[1][1],c=qr(w[1][2],s,n);var k=v=Du(a,u,n);f.push(v+"!"+rt(c,i));break;case"PtgFunc":case"PtgFuncVar":var E=w[1][0],S=w[1][1];E||(E=0);var _=0==(E&=127)?[]:f.slice(-E);f.length-=E,"User"===S&&(S=_.shift()),f.push(S+"("+_.join(",")+")");break;case"PtgBool":f.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(w[1]);break;case"PtgNum":f.push(String(w[1]));break;case"PtgStr":f.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(w[1]);break;case"PtgAreaN":d=et(w[1][1],t?{s:t}:s,n),f.push(tt(d,n));break;case"PtgArea":d=et(w[1][1],s,n),f.push(tt(d,n));break;case"PtgArea3d":u=w[1][1],d=w[1][2],v=Du(a,u,n),f.push(v+"!"+tt(d,n));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var C=(a.names||[])[h-1]||(a[0]||[])[h],B=C?C.Name:"SH33TJSNAME"+String(h);B in Zu&&(B=Zu[B]),f.push(B);break;case"PtgNameX":var T=w[1][1],y;if(h=w[1][2],!(n.biff<=5)){var x="";if(14849==((a[T]||[])[0]||[])[0]||(1025==((a[T]||[])[0]||[])[0]?a[T][h]&&a[T][h].itab>0&&(x=a.SheetNames[a[T][h].itab-1]+"!"):x=a.SheetNames[h-1]+"!"),a[T]&&a[T][h])x+=a[T][h].Name;else if(a[0]&&a[0][h])x+=a[0][h].Name;else{var A=Ru(a,T,n).split(";;");A[h-1]?x=A[h-1]:x+="SH33TJSERRX"}f.push(x);break}T<0&&(T=-T),a[T]&&(y=a[T][h]),y||(y={Name:"SH33TJSERRY"}),f.push(y.Name);break;case"PtgParen":var I="(",R=")";if(p>=0){switch(m="",e[0][p][1][0]){case 2:I=oe(" ",e[0][p][1][1])+I;break;case 3:I=oe("\r",e[0][p][1][1])+I;break;case 4:R=oe(" ",e[0][p][1][1])+R;break;case 5:R=oe("\r",e[0][p][1][1])+R;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}f.push(I+f.pop()+R);break;case"PtgRefErr":case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":c={c:w[1][1],r:w[1][0]};var D={c:t.c,r:t.r};if(a.sharedf[pt(c)]){var F=a.sharedf[pt(c)];f.push(Fu(F,s,D,a,n))}else{var O=!1;for(l=0;l!=a.arrayf.length;++l)if(o=a.arrayf[l],!(c.c<o[0].s.c||c.c>o[0].e.c||c.r<o[0].s.r||c.r>o[0].e.r)){f.push(Fu(o[1],s,D,a,n)),O=!0;break}O||f.push(w[1])}break;case"PtgArray":f.push("{"+xu(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=b;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":default:throw new Error("Unrecognized Formula Token: "+String(w))}var P=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(3!=n.biff&&p>=0&&-1==P.indexOf(e[0][b][0])){var N=!0;switch((w=e[0][p])[1][0]){case 4:N=!1;case 0:m=oe(" ",w[1][1]);break;case 5:N=!1;case 1:m=oe("\r",w[1][1]);break;default:if(m="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}f.push((N?m:"")+f.pop()+(N?"":m)),p=-1}}if(f.length>1&&n.WTF)throw new Error("bad formula stack");return f[0]}function Ou(e,r,t){var a=e.l+r,n=2==t.biff?1:2,i,s=e._R(n);if(65535==s)return[[],Yr(e,r-2)];var f=yu(e,s,t);return r!==s+n&&(i=Tu(e,r-s-n,f,t)),e.l=a,[f,i]}function Pu(e,r,t){var a=e.l+r,n=2==t.biff?1:2,i,s=e._R(n);if(65535==s)return[[],Yr(e,r-2)];var f=yu(e,s,t);return r!==s+n&&(i=Tu(e,r-s-n,f,t)),e.l=a,[f,i]}function Nu(e,r,t,a){var n=e.l+r,i=yu(e,a,t),s;return n!==e.l&&(s=Tu(e,n-e.l,i,t)),[i,s]}function Lu(e,r,t){var a=e.l+r,n,i=e._R(2),s=yu(e,i,t);return 65535==i?[[],Yr(e,r-2)]:(r!==i+2&&(n=Tu(e,a-i-2,s,t)),[s,n])}function Mu(e){var r;if(65535!==Nr(e,e.l+6))return[Yt(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=1===e[e.l+2],e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Uu(e){if(null==e){var r=$r(8);return r._W(1,3),r._W(1,0),r._W(2,0),r._W(2,0),r._W(2,65535),r}return $t("number"==typeof e?e:0)}function Hu(e,r,t){var a=e.l+r,n=hi(e,6);2==t.biff&&++e.l;var i=Mu(e,8),s=e._R(1);2!=t.biff&&(e._R(1),t.biff>=5&&e._R(4));var f=Pu(e,a-e.l,t);return{cell:n,val:i[0],formula:f,shared:s>>3&1,tt:i[1]}}function Wu(e,r,t,a,n){var i=di(r,t,n),s=Uu(e.v),f=$r(6),l=33,u;f._W(2,l),f._W(4,0);for(var o=$r(e.bf.length),c=0;c<e.bf.length;++c)o[c]=e.bf[c];return I([i,s,f,o])}function zu(e,r,t){var a=e._R(4),n=yu(e,a,t),i=e._R(4),s;return[n,i>0?Tu(e,i,n,t):null]}var Vu=zu,Xu=zu,Gu=zu,ju=zu,Ku={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Yu={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},$u={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0},Zu={"_xlfn.ACOT":"ACOT","_xlfn.ACOTH":"ACOTH","_xlfn.AGGREGATE":"AGGREGATE","_xlfn.ARABIC":"ARABIC","_xlfn.AVERAGEIF":"AVERAGEIF","_xlfn.AVERAGEIFS":"AVERAGEIFS","_xlfn.BASE":"BASE","_xlfn.BETA.DIST":"BETA.DIST","_xlfn.BETA.INV":"BETA.INV","_xlfn.BINOM.DIST":"BINOM.DIST","_xlfn.BINOM.DIST.RANGE":"BINOM.DIST.RANGE","_xlfn.BINOM.INV":"BINOM.INV","_xlfn.BITAND":"BITAND","_xlfn.BITLSHIFT":"BITLSHIFT","_xlfn.BITOR":"BITOR","_xlfn.BITRSHIFT":"BITRSHIFT","_xlfn.BITXOR":"BITXOR","_xlfn.CEILING.MATH":"CEILING.MATH","_xlfn.CEILING.PRECISE":"CEILING.PRECISE","_xlfn.CHISQ.DIST":"CHISQ.DIST","_xlfn.CHISQ.DIST.RT":"CHISQ.DIST.RT","_xlfn.CHISQ.INV":"CHISQ.INV","_xlfn.CHISQ.INV.RT":"CHISQ.INV.RT","_xlfn.CHISQ.TEST":"CHISQ.TEST","_xlfn.COMBINA":"COMBINA","_xlfn.CONCAT":"CONCAT","_xlfn.CONFIDENCE.NORM":"CONFIDENCE.NORM","_xlfn.CONFIDENCE.T":"CONFIDENCE.T","_xlfn.COT":"COT","_xlfn.COTH":"COTH","_xlfn.COUNTIFS":"COUNTIFS","_xlfn.COVARIANCE.P":"COVARIANCE.P","_xlfn.COVARIANCE.S":"COVARIANCE.S","_xlfn.CSC":"CSC","_xlfn.CSCH":"CSCH","_xlfn.DAYS":"DAYS","_xlfn.DECIMAL":"DECIMAL","_xlfn.ECMA.CEILING":"ECMA.CEILING","_xlfn.ERF.PRECISE":"ERF.PRECISE","_xlfn.ERFC.PRECISE":"ERFC.PRECISE","_xlfn.EXPON.DIST":"EXPON.DIST","_xlfn.F.DIST":"F.DIST","_xlfn.F.DIST.RT":"F.DIST.RT","_xlfn.F.INV":"F.INV","_xlfn.F.INV.RT":"F.INV.RT","_xlfn.F.TEST":"F.TEST","_xlfn.FILTERXML":"FILTERXML","_xlfn.FLOOR.MATH":"FLOOR.MATH","_xlfn.FLOOR.PRECISE":"FLOOR.PRECISE","_xlfn.FORECAST.ETS":"FORECAST.ETS","_xlfn.FORECAST.ETS.CONFINT":"FORECAST.ETS.CONFINT","_xlfn.FORECAST.ETS.SEASONALITY":"FORECAST.ETS.SEASONALITY","_xlfn.FORECAST.ETS.STAT":"FORECAST.ETS.STAT","_xlfn.FORECAST.LINEAR":"FORECAST.LINEAR","_xlfn.FORMULATEXT":"FORMULATEXT","_xlfn.GAMMA":"GAMMA","_xlfn.GAMMA.DIST":"GAMMA.DIST","_xlfn.GAMMA.INV":"GAMMA.INV","_xlfn.GAMMALN.PRECISE":"GAMMALN.PRECISE","_xlfn.GAUSS":"GAUSS","_xlfn.HYPGEOM.DIST":"HYPGEOM.DIST","_xlfn.IFERROR":"IFERROR","_xlfn.IFNA":"IFNA","_xlfn.IFS":"IFS","_xlfn.IMCOSH":"IMCOSH","_xlfn.IMCOT":"IMCOT","_xlfn.IMCSC":"IMCSC","_xlfn.IMCSCH":"IMCSCH","_xlfn.IMSEC":"IMSEC","_xlfn.IMSECH":"IMSECH","_xlfn.IMSINH":"IMSINH","_xlfn.IMTAN":"IMTAN","_xlfn.ISFORMULA":"ISFORMULA","_xlfn.ISO.CEILING":"ISO.CEILING","_xlfn.ISOWEEKNUM":"ISOWEEKNUM","_xlfn.LOGNORM.DIST":"LOGNORM.DIST","_xlfn.LOGNORM.INV":"LOGNORM.INV","_xlfn.MAXIFS":"MAXIFS","_xlfn.MINIFS":"MINIFS","_xlfn.MODE.MULT":"MODE.MULT","_xlfn.MODE.SNGL":"MODE.SNGL","_xlfn.MUNIT":"MUNIT","_xlfn.NEGBINOM.DIST":"NEGBINOM.DIST","_xlfn.NETWORKDAYS.INTL":"NETWORKDAYS.INTL","_xlfn.NIGBINOM":"NIGBINOM","_xlfn.NORM.DIST":"NORM.DIST","_xlfn.NORM.INV":"NORM.INV","_xlfn.NORM.S.DIST":"NORM.S.DIST","_xlfn.NORM.S.INV":"NORM.S.INV","_xlfn.NUMBERVALUE":"NUMBERVALUE","_xlfn.PDURATION":"PDURATION","_xlfn.PERCENTILE.EXC":"PERCENTILE.EXC","_xlfn.PERCENTILE.INC":"PERCENTILE.INC","_xlfn.PERCENTRANK.EXC":"PERCENTRANK.EXC","_xlfn.PERCENTRANK.INC":"PERCENTRANK.INC","_xlfn.PERMUTATIONA":"PERMUTATIONA","_xlfn.PHI":"PHI","_xlfn.POISSON.DIST":"POISSON.DIST","_xlfn.QUARTILE.EXC":"QUARTILE.EXC","_xlfn.QUARTILE.INC":"QUARTILE.INC","_xlfn.QUERYSTRING":"QUERYSTRING","_xlfn.RANK.AVG":"RANK.AVG","_xlfn.RANK.EQ":"RANK.EQ","_xlfn.RRI":"RRI","_xlfn.SEC":"SEC","_xlfn.SECH":"SECH","_xlfn.SHEET":"SHEET","_xlfn.SHEETS":"SHEETS","_xlfn.SKEW.P":"SKEW.P","_xlfn.STDEV.P":"STDEV.P","_xlfn.STDEV.S":"STDEV.S","_xlfn.SUMIFS":"SUMIFS","_xlfn.SWITCH":"SWITCH","_xlfn.T.DIST":"T.DIST","_xlfn.T.DIST.2T":"T.DIST.2T","_xlfn.T.DIST.RT":"T.DIST.RT","_xlfn.T.INV":"T.INV","_xlfn.T.INV.2T":"T.INV.2T","_xlfn.T.TEST":"T.TEST","_xlfn.TEXTJOIN":"TEXTJOIN","_xlfn.UNICHAR":"UNICHAR","_xlfn.UNICODE":"UNICODE","_xlfn.VAR.P":"VAR.P","_xlfn.VAR.S":"VAR.S","_xlfn.WEBSERVICE":"WEBSERVICE","_xlfn.WEIBULL.DIST":"WEIBULL.DIST","_xlfn.WORKDAY.INTL":"WORKDAY.INTL","_xlfn.XOR":"XOR","_xlfn.Z.TEST":"Z.TEST"};function Qu(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,r){return r.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Ju(e){var r;return("of:="+e.replace(qo,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function qu(e){var r=e.split(":"),t;return[r[0].split(".")[0],r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function eh(e){return e.replace(/\./,"!")}var rh={},th={};Na.WS=["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"];var ah="undefined"!=typeof Map;function nh(e,r,t){var a=0,n=e.length;if(t){if(ah?t.has(r):t.hasOwnProperty(r))for(var i=ah?t.get(r):t[r];a<i.length;++a)if(e[i[a]].t===r)return e.Count++,i[a]}else for(;a<n;++a)if(e[a].t===r)return e.Count++,a;return e[n]={t:r},e.Count++,e.Unique++,t&&(ah?(t.has(r)||t.set(r,[]),t.get(r).push(n)):(t.hasOwnProperty(r)||(t[r]=[]),t[r].push(n))),n}function ih(e,r){var t={min:e+1,max:e+1},a=-1;return r.MDW&&(cl=r.MDW),null!=r.width?t.customWidth=1:null!=r.wpx?a=hl(r.wpx):null!=r.wch&&(a=r.wch),a>-1?(t.width=dl(a),t.customWidth=1):null!=r.width&&(t.width=r.width),r.hidden&&(t.hidden=!0),t}function sh(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];"xlml"==r&&(t=[1,1,1,1,.5,.5]),null==e.left&&(e.left=t[0]),null==e.right&&(e.right=t[1]),null==e.top&&(e.top=t[2]),null==e.bottom&&(e.bottom=t[3]),null==e.header&&(e.header=t[4]),null==e.footer&&(e.footer=t[5])}}function fh(e,r,t){var a=t.revssf[null!=r.z?r.z:"General"],n=60,i=e.length;if(null==a&&t.ssf)for(;n<392;++n)if(null==t.ssf[n]){F.load(r.z,n),t.ssf[n]=r.z,t.revssf[r.z]=a=n;break}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function lh(e,r,t,a,n,i){try{a.cellNF&&(e.z=F._table[r])}catch(s){if(a.WTF)throw s}if("z"!==e.t){if("d"===e.t&&"string"==typeof e.v&&(e.v=se(e.v)),!a||!1!==a.cellText)try{if(null==F._table[r]&&F.load(N[r]||"General",r),"e"===e.t)e.w=e.w||Zt[e.v];else if(0===r)if("n"===e.t)(0|e.v)===e.v?e.w=F._general_int(e.v):e.w=F._general_num(e.v);else if("d"===e.t){var f=re(e.v);e.w=(0|f)===f?F._general_int(f):F._general_num(f)}else{if(void 0===e.v)return"";e.w=F._general(e.v,th)}else"d"===e.t?e.w=F.format(r,re(e.v),th):e.w=F.format(r,e.v,th)}catch(s){if(a.WTF)throw s}if(a.cellStyles&&null!=t)try{e.s=i.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=sl(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=sl(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(s){if(a.WTF&&i.Fills)throw s}}}function oh(e,r,t){if(e&&e["!ref"]){var a=gt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function ch(e,r){var t=gt(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=bt(t))}var uh=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,hh=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,dh=/<(?:\w:)?hyperlink [^>]*>/gm,vh=/"(\w*:\w*)"/,ph=/<(?:\w:)?col\b[^>]*[\/]?>/g,mh=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,bh=/<(?:\w:)?pageMargins[^>]*\/>/g,gh=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,wh=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function kh(e,r,t,a,n,i,s){if(!e)return e;a||(a={"!id":{}});var f=r.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},o="",c="",u=e.match(hh);u?(o=e.slice(0,u.index),c=e.slice(u.index+u[0].length)):o=c=e;var h=o.match(gh);h&&Sh(h[0],f,n,t);var d=(o.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var v=o.slice(d,d+50).match(vh);v&&ch(f,v[1])}var p=o.match(wh);p&&p[1]&&Ph(p[1],n);var b=[];if(r.cellStyles){var g=o.match(ph);g&&Ih(b,g)}u&&Mh(u[1],f,r,l,i,s);var w=c.match(mh);w&&(f["!autofilter"]=Dh(w[0]));var k=[],E=c.match(uh);if(E)for(d=0;d!=E.length;++d)k[d]=gt(E[d].slice(E[d].indexOf('"')+1));var S=c.match(dh);S&&yh(f,S,a);var _=c.match(bh);if(_&&(f["!margins"]=xh(De(_[0]))),!f["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(f["!ref"]=bt(l)),r.sheetRows>0&&f["!ref"]){var C=gt(f["!ref"]);r.sheetRows<=+C.e.r&&(C.e.r=r.sheetRows-1,C.e.r>l.e.r&&(C.e.r=l.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>l.e.c&&(C.e.c=l.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),f["!fullref"]=f["!ref"],f["!ref"]=bt(C))}return b.length>0&&(f["!cols"]=b),k.length>0&&(f["!merges"]=k),f}function Eh(e){if(0===e.length)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+bt(e[t])+'"/>';return r+"</mergeCells>"}function Sh(e,r,t,a){var n=De(e);t.Sheets[a]||(t.Sheets[a]={}),n.codeName&&(t.Sheets[a].CodeName=n.codeName)}function _h(e,r,t,a,n){var i=!1,s={},f=null;if("xlsx"!==a.bookType&&r.vbaraw){var l=r.SheetNames[t];try{r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch(o){}i=!0,s.codeName=Ue(l)}i&&(n[n.length]=fr("sheetPr",f,s))}var Ch=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Bh=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Th(e){var r={sheet:1};return Ch.forEach((function(t){null!=e[t]&&e[t]&&(r[t]="1")})),Bh.forEach((function(t){null==e[t]||e[t]||(r[t]="0")})),e.password&&(r.password=Yf(e.password).toString(16).toUpperCase()),fr("sheetProtection",null,r)}function yh(e,r,t){for(var a=Array.isArray(e),n=0;n!=r.length;++n){var i=De(Ke(r[n]),!0);if(!i.ref)return;var s=((t||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+i.location)):(i.Target="#"+i.location,s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var f=gt(i.ref),l=f.s.r;l<=f.e.r;++l)for(var o=f.s.c;o<=f.e.c;++o){var c=pt({c:o,r:l});a?(e[l]||(e[l]=[]),e[l][o]||(e[l][o]={t:"z",v:void 0}),e[l][o].l=i):(e[c]||(e[c]={t:"z",v:void 0}),e[c].l=i)}}}function xh(e){var r={};return["left","right","top","bottom","header","footer"].forEach((function(t){e[t]&&(r[t]=parseFloat(e[t]))})),r}function Ah(e){return sh(e),fr("pageMargins",null,e)}function Ih(e,r){for(var t=!1,a=0;a!=r.length;++a){var n=De(r[a],!0);n.hidden&&(n.hidden=je(n.hidden));var i=parseInt(n.min,10)-1,s=parseInt(n.max,10)-1;for(delete n.min,delete n.max,n.width=+n.width,!t&&n.width&&(t=!0,pl(n.width)),ml(n);i<=s;)e[i++]=le(n)}}function Rh(e,r){for(var t=["<cols>"],a,n=0;n!=r.length;++n)(a=r[n])&&(t[t.length]=fr("col",null,ih(n,a)));return t[t.length]="</cols>",t.join("")}function Dh(e){var r;return{ref:(e.match(/ref="([^"]*)"/)||[])[1]}}function Fh(e,r,t,a){var n="string"==typeof e.ref?e.ref:bt(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,s=mt(n);s.s.r==s.e.r&&(s.e.r=mt(r["!ref"]).e.r,n=bt(s));for(var f=0;f<i.length;++f){var l=i[f];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==a){l.Ref="'"+t.SheetNames[a]+"'!"+n;break}}return f==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+n}),fr("autoFilter",null,{ref:n})}var Oh=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Ph(e,r){r.Views||(r.Views=[{}]),(e.match(Oh)||[]).forEach((function(e,t){var a=De(e);r.Views[t]||(r.Views[t]={}),je(a.rightToLeft)&&(r.Views[t].RTL=!0)}))}function Nh(e,r,t,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),fr("sheetViews",fr("sheetView",null,n),{})}function Lh(e,r,t,a){if(void 0===e.v&&void 0===e.f||"z"===e.t)return"";var n="",i=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Zt[e.v];break;case"d":a&&a.cellDates?n=se(e.v,-1).toISOString():((e=le(e)).t="n",n=""+(e.v=re(se(e.v)))),void 0===e.z&&(e.z=F._table[14]);break;default:n=e.v}var f=ir("v",Ue(n)),l={r:r},o=fh(a.cellXfs,e,a);switch(0!==o&&(l.s=o),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(null==e.v){delete e.t;break}if(a&&a.bookSST){f=ir("v",""+nh(a.Strings,e.v,a.revStrings)),l.t="s";break}l.t="str"}if(e.t!=i&&(e.t=i,e.v=s),e.f){var c=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;f=fr("f",Ue(e.f),c)+(null!=e.v?f:"")}return e.l&&t["!links"].push([r,e.l]),e.c&&t["!comments"].push([r,e.c]),fr("c",f,l)}var Mh=function(){var e=/<(?:\w+:)?c[ >]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=Je("v"),s=Je("f");return function f(l,o,c,u,h,d){for(var v=0,p="",m=[],b=[],g=0,w=0,k=0,E="",S,_,C=0,B=0,T,y,x=0,A=0,I=Array.isArray(d.CellXf),R,D=[],O=[],P=Array.isArray(o),N=[],L={},M=!1,U=l.split(r),H=0,W=U.length;H!=W;++H){var z=(p=U[H].trim()).length;if(0!==z){for(v=0;v<z&&62!==p.charCodeAt(v);++v);if(++v,C=null!=(_=De(p.slice(0,v),!0)).r?parseInt(_.r,10):C+1,B=-1,!(c.sheetRows&&c.sheetRows<C)){u.s.r>C-1&&(u.s.r=C-1),u.e.r<C-1&&(u.e.r=C-1),c&&c.cellStyles&&(L={},M=!1,_.ht&&(M=!0,L.hpt=parseFloat(_.ht),L.hpx=kl(L.hpt)),"1"==_.hidden&&(M=!0,L.hidden=!0),null!=_.outlineLevel&&(M=!0,L.level=+_.outlineLevel),M&&(N[C-1]=L)),m=p.slice(v).split(e);for(var V=0;V!=m.length&&"<"==m[V].trim().charAt(0);++V);for(m=m.slice(V),v=0;v!=m.length;++v)if(0!==(p=m[v].trim()).length){if(b=p.match(t),g=v,w=0,k=0,p="<c "+("<"==p.slice(0,1)?">":"")+p,null!=b&&2===b.length){for(g=0,E=b[1],w=0;w!=E.length&&!((k=E.charCodeAt(w)-64)<1||k>26);++w)g=26*g+k;B=--g}else++B;for(w=0;w!=p.length&&62!==p.charCodeAt(w);++w);if(++w,(_=De(p.slice(0,w),!0)).r||(_.r=pt({r:C-1,c:B})),S={t:""},null!=(b=(E=p.slice(w)).match(i))&&""!==b[1]&&(S.v=Ne(b[1])),c.cellFormula){null!=(b=E.match(s))&&""!==b[1]?(S.f=nc(Ne(Ke(b[1]))),b[0].indexOf('t="array"')>-1?(S.F=(E.match(n)||[])[1],S.F.indexOf(":")>-1&&D.push([gt(S.F),S.F])):b[0].indexOf('t="shared"')>-1&&(y=De(b[0]),O[parseInt(y.si,10)]=[y,nc(Ne(Ke(b[1]))),_.r])):(b=E.match(/<f[^>]*\/>/))&&O[(y=De(b[0])).si]&&(S.f=tc(O[y.si][1],O[y.si][2],_.r));var X=vt(_.r);for(w=0;w<D.length;++w)X.r>=D[w][0].s.r&&X.r<=D[w][0].e.r&&X.c>=D[w][0].s.c&&X.c<=D[w][0].e.c&&(S.F=D[w][1])}if(null==_.t&&void 0===S.v)if(S.f||S.F)S.v=0,S.t="n";else{if(!c.sheetStubs)continue;S.t="z"}else S.t=_.t||"n";switch(u.s.c>B&&(u.s.c=B),u.e.c<B&&(u.e.c=B),S.t){case"n":if(""==S.v||null==S.v){if(!c.sheetStubs)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(void 0===S.v){if(!c.sheetStubs)continue;S.t="z"}else T=rh[parseInt(S.v,10)],S.v=T.t,S.r=T.r,c.cellHTML&&(S.h=T.h);break;case"str":S.t="s",S.v=null!=S.v?Ke(S.v):"",c.cellHTML&&(S.h=ze(S.v));break;case"inlineStr":b=E.match(a),S.t="s",null!=b&&(T=kf(b[1]))?(S.v=T.t,c.cellHTML&&(S.h=T.h)):S.v="";break;case"b":S.v=je(S.v);break;case"d":c.cellDates?S.v=se(S.v,1):(S.v=re(se(S.v,1)),S.t="n");break;case"e":c&&!1===c.cellText||(S.w=S.v),S.v=Qt[S.v]}if(x=A=0,R=null,I&&void 0!==_.s&&null!=(R=d.CellXf[_.s])&&(null!=R.numFmtId&&(x=R.numFmtId),c.cellStyles&&null!=R.fillId&&(A=R.fillId)),lh(S,x,A,c,h,d),c.cellDates&&I&&"n"==S.t&&F.is_date(F._table[x])&&(S.t="d",S.v=te(S.v)),P){var G=vt(_.r);o[G.r]||(o[G.r]=[]),o[G.r][G.c]=S}else o[_.r]=S}}}}N.length>0&&(o["!rows"]=N)}}();function Uh(e,r,t,a){var n=[],i=[],s=gt(e["!ref"]),f="",l,o="",c=[],u=0,h=0,d=e["!rows"],v=Array.isArray(e),p={r:o},m,b=-1;for(h=s.s.c;h<=s.e.c;++h)c[h]=ct(h);for(u=s.s.r;u<=s.e.r;++u){for(i=[],o=st(u),h=s.s.c;h<=s.e.c;++h){l=c[h]+o;var g=v?(e[u]||[])[h]:e[l];void 0!==g&&(null!=(f=Lh(g,l,e,r,t,a))&&i.push(f))}(i.length>0||d&&d[u])&&(p={r:o},d&&d[u]&&((m=d[u]).hidden&&(p.hidden=1),b=-1,m.hpx?b=wl(m.hpx):m.hpt&&(b=m.hpt),b>-1&&(p.ht=b,p.customHeight=1),m.level&&(p.outlineLevel=m.level)),n[n.length]=fr("row",i.join(""),p))}if(d)for(;u<d.length;++u)d&&d[u]&&(p={r:u+1},(m=d[u]).hidden&&(p.hidden=1),b=-1,m.hpx?b=wl(m.hpx):m.hpt&&(b=m.hpt),b>-1&&(p.ht=b,p.customHeight=1),m.level&&(p.outlineLevel=m.level),n[n.length]=fr("row","",p));return n.join("")}var Hh=fr("worksheet",null,{xmlns:cr.main[0],"xmlns:r":cr.r});function Wh(e,r,t,a){var n=[ye,Hh],i=t.SheetNames[e],s=0,f="",l=t.Sheets[i];null==l&&(l={});var o=l["!ref"]||"A1",c=gt(o);if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+o+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),o=bt(c)}a||(a={}),l["!comments"]=[];var u=[];_h(l,t,e,r,n),n[n.length]=fr("dimension",null,{ref:o}),n[n.length]=Nh(l,r,e,t),r.sheetFormat&&(n[n.length]=fr("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(n[n.length]=Rh(l,l["!cols"])),n[s=n.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(f=Uh(l,r,e,t,a)).length>0&&(n[n.length]=f),n.length>s+1&&(n[n.length]="</sheetData>",n[s]=n[s].replace("/>",">")),null!=l["!protect"]&&(n[n.length]=Th(l["!protect"])),null!=l["!autofilter"]&&(n[n.length]=Fh(l["!autofilter"],l,t,e)),null!=l["!merges"]&&l["!merges"].length>0&&(n[n.length]=Eh(l["!merges"]));var h=-1,d,v=-1;return l["!links"].length>0&&(n[n.length]="<hyperlinks>",l["!links"].forEach((function(e){e[1].Target&&(d={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(v=za(a,-1,Ue(e[1].Target).replace(/#.*$/,""),Na.HLINK),d["r:id"]="rId"+v),(h=e[1].Target.indexOf("#"))>-1&&(d.location=Ue(e[1].Target.slice(h+1))),e[1].Tooltip&&(d.tooltip=Ue(e[1].Tooltip)),n[n.length]=fr("hyperlink",null,d))})),n[n.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(n[n.length]=Ah(l["!margins"])),r&&!r.ignoreEC&&null!=r.ignoreEC||(n[n.length]=ir("ignoredErrors",fr("ignoredError",null,{numberStoredAsText:1,sqref:o}))),u.length>0&&(v=za(a,-1,"../drawings/drawing"+(e+1)+".xml",Na.DRAW),n[n.length]=fr("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=u),l["!comments"].length>0&&(v=za(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Na.VML),n[n.length]=fr("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function zh(e,r){var t={},a=e.l+r;t.r=e._R(4),e.l+=4;var n=e._R(2);e.l+=1;var i=e._R(1);return e.l=a,7&i&&(t.level=7&i),16&i&&(t.hidden=!0),32&i&&(t.hpt=n/20),t}function Vh(e,r,t){var a=$r(145),n=(t["!rows"]||[])[e]||{};a._W(4,e),a._W(4,0);var i=320;n.hpx?i=20*wl(n.hpx):n.hpt&&(i=20*n.hpt),a._W(2,i),a._W(1,0);var s=0;n.level&&(s|=n.level),n.hidden&&(s|=16),(n.hpx||n.hpt)&&(s|=32),a._W(1,s),a._W(1,0);var f=0,l=a.l;a.l+=4;for(var o={r:e,c:0},c=0;c<16;++c)if(!(r.s.c>c+1<<10||r.e.c<c<<10)){for(var u=-1,h=-1,d=c<<10;d<c+1<<10;++d){var v;o.c=d,(Array.isArray(t)?(t[o.r]||[])[o.c]:t[pt(o)])&&(u<0&&(u=d),h=d)}u<0||(++f,a._W(4,u),a._W(4,h))}var p=a.l;return a.l=l,a._W(4,f),a.l=p,a.length>a.l?a.slice(0,a.l):a}function Xh(e,r,t,a){var n=Vh(a,t,r);(n.length>17||(r["!rows"]||[])[a])&&Jr(e,"BrtRowHdr",n)}var Gh=jt,jh=Kt;function Kh(){}function Yh(e,r){var t={};return e.l+=19,t.name=Pt(e,r-19),t}function $h(e,r){null==r&&(r=$r(84+4*e.length));for(var t=0;t<3;++t)r._W(1,0);return qt({auto:1},r),r._W(-4,-1),r._W(-4,-1),Nt(e,r),r.slice(0,r.l)}function Zh(e){var r;return[Ft(e)]}function Qh(e,r,t){return null==t&&(t=$r(8)),Ot(r,t)}function Jh(e){var r,t;return[Ft(e),e._R(1),"b"]}function qh(e,r,t){return null==t&&(t=$r(9)),Ot(r,t),t._W(1,e.v?1:0),t}function ed(e){var r,t;return[Ft(e),e._R(1),"e"]}function rd(e){var r,t;return[Ft(e),e._R(4),"s"]}function td(e,r,t){return null==t&&(t=$r(12)),Ot(r,t),t._W(4,r.v),t}function ad(e){var r,t;return[Ft(e),Yt(e),"n"]}function nd(e,r,t){return null==t&&(t=$r(16)),Ot(r,t),$t(e.v,t),t}function id(e){var r,t;return[Ft(e),zt(e),"n"]}function sd(e,r,t){return null==t&&(t=$r(12)),Ot(r,t),Vt(e.v,t),t}function fd(e){var r,t;return[Ft(e),Bt(e),"str"]}function ld(e,r,t){return null==t&&(t=$r(12+4*e.v.length)),Ot(r,t),Tt(e.v,t),t.length>t.l?t.slice(0,t.l):t}function od(e,r,t){var a=e.l+r,n=Ft(e);n.r=t["!row"];var i,s=[n,e._R(1),"b"];if(t.cellFormula){e.l+=2;var f=Xu(e,a-e.l,t);s[3]=Fu(f,null,n,t.supbooks,t)}else e.l=a;return s}function cd(e,r,t){var a=e.l+r,n=Ft(e);n.r=t["!row"];var i,s=[n,e._R(1),"e"];if(t.cellFormula){e.l+=2;var f=Xu(e,a-e.l,t);s[3]=Fu(f,null,n,t.supbooks,t)}else e.l=a;return s}function ud(e,r,t){var a=e.l+r,n=Ft(e);n.r=t["!row"];var i,s=[n,Yt(e),"n"];if(t.cellFormula){e.l+=2;var f=Xu(e,a-e.l,t);s[3]=Fu(f,null,n,t.supbooks,t)}else e.l=a;return s}function hd(e,r,t){var a=e.l+r,n=Ft(e);n.r=t["!row"];var i,s=[n,Bt(e),"str"];if(t.cellFormula){e.l+=2;var f=Xu(e,a-e.l,t);s[3]=Fu(f,null,n,t.supbooks,t)}else e.l=a;return s}var dd=jt,vd=Kt;function pd(e,r){return null==r&&(r=$r(4)),r._W(4,e),r}function md(e,r){var t=e.l+r,a=jt(e,16),n=Lt(e),i=Bt(e),s=Bt(e),f=Bt(e);e.l=t;var l={rfx:a,relId:n,loc:i,display:f};return s&&(l.Tooltip=s),l}function bd(e,r){var t=$r(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Kt({s:vt(e[0]),e:vt(e[0])},t),Wt("rId"+r,t);var a=e[1].Target.indexOf("#"),n;return Tt((-1==a?"":e[1].Target.slice(a+1))||"",t),Tt(e[1].Tooltip||"",t),Tt("",t),t.slice(0,t.l)}function gd(){}function wd(e,r,t){var a=e.l+r,n=Xt(e,16),i=e._R(1),s=[n];if(s[2]=i,t.cellFormula){var f=Vu(e,a-e.l,t);s[1]=f}else e.l=a;return s}function kd(e,r,t){var a=e.l+r,n,i=[jt(e,16)];if(t.cellFormula){var s=ju(e,a-e.l,t);i[1]=s,e.l=a}else e.l=a;return i}function Ed(e,r,t){null==t&&(t=$r(18));var a=ih(e,r);t._W(-4,e),t._W(-4,e),t._W(4,256*(a.width||10)),t._W(4,0);var n=0;return r.hidden&&(n|=1),"number"==typeof a.width&&(n|=2),r.level&&(n|=r.level<<8),t._W(2,n),t}var Sd=["left","right","top","bottom","header","footer"];function _d(e){var r={};return Sd.forEach((function(t){r[t]=Yt(e,8)})),r}function Cd(e,r){return null==r&&(r=$r(48)),sh(e),Sd.forEach((function(t){$t(e[t],r)})),r}function Bd(e){var r=e._R(2);return e.l+=28,{RTL:32&r}}function Td(e,r,t){null==t&&(t=$r(30));var a=924;return(((r||{}).Views||[])[0]||{}).RTL&&(a|=32),t._W(2,a),t._W(4,0),t._W(4,0),t._W(4,0),t._W(1,0),t._W(1,0),t._W(2,0),t._W(2,100),t._W(2,0),t._W(2,0),t._W(2,0),t._W(4,0),t}function yd(e){var r=$r(24);return r._W(4,4),r._W(4,1),Kt(e,r),r}function xd(e,r){return null==r&&(r=$r(66)),r._W(2,e.password?Yf(e.password):0),r._W(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach((function(t){t[1]?r._W(4,null==e[t[0]]||e[t[0]]?0:1):r._W(4,null!=e[t[0]]&&e[t[0]]?0:1)})),r}function Ad(){}function Id(){}function Rd(e,r,t,a,n,i,s){if(!e)return e;var f=r||{};a||(a={"!id":{}});var l=f.dense?[]:{},o,c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=[],h=!1,d=!1,v,p,b,g,w,k,E,S,_,C=[];f.biff=12,f["!row"]=0;var B=0,T=!1,y=[],x={},A=f.supbooks||n.supbooks||[[]];if(A.sharedf=x,A.arrayf=y,A.SheetNames=n.SheetNames||n.Sheets.map((function(e){return e.name})),!f.supbooks&&(f.supbooks=A,n.Names))for(var I=0;I<n.Names.length;++I)A[0][I+1]=n.Names[I];var R=[],D=[],O=!1;if(Zr(e,(function N(e,r,m){if(!d)switch(m){case 148:o=e;break;case 0:v=e,f.sheetRows&&f.sheetRows<=v.r&&(d=!0),S=st(g=v.r),f["!row"]=v.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=kl(e.hpt)),D[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:switch(p={t:e[2]},e[2]){case"n":p.v=e[1];break;case"s":E=rh[e[1]],p.v=E.t,p.r=E.r;break;case"b":p.v=!!e[1];break;case"e":p.v=e[1],!1!==f.cellText&&(p.w=Zt[p.v]);break;case"str":p.t="s",p.v=e[1]}if((b=s.CellXf[e[0].iStyleRef])&&lh(p,b.numFmtId,null,f,i,s),w=e[0].c,f.dense?(l[g]||(l[g]=[]),l[g][w]=p):l[ct(w)+S]=p,f.cellFormula){for(T=!1,B=0;B<y.length;++B){var I=y[B];v.r>=I[0].s.r&&v.r<=I[0].e.r&&w>=I[0].s.c&&w<=I[0].e.c&&(p.F=bt(I[0]),T=!0)}!T&&e.length>3&&(p.f=e[3])}if(c.s.r>v.r&&(c.s.r=v.r),c.s.c>w&&(c.s.c=w),c.e.r<v.r&&(c.e.r=v.r),c.e.c<w&&(c.e.c=w),f.cellDates&&b&&"n"==p.t&&F.is_date(F._table[b.numFmtId])){var P=F.parse_date_code(p.v);P&&(p.t="d",p.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}break;case 1:if(!f.sheetStubs||h)break;p={t:"z",v:void 0},w=e[0].c,f.dense?(l[g]||(l[g]=[]),l[g][w]=p):l[ct(w)+S]=p,c.s.r>v.r&&(c.s.r=v.r),c.s.c>w&&(c.s.c=w),c.e.r<v.r&&(c.e.r=v.r),c.e.c<w&&(c.e.c=w);break;case 176:C.push(e);break;case 494:var N=a["!id"][e.relId];for(N?(e.Target=N.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=N):""==e.relId&&(e.Target="#"+e.loc),g=e.rfx.s.r;g<=e.rfx.e.r;++g)for(w=e.rfx.s.c;w<=e.rfx.e.c;++w)f.dense?(l[g]||(l[g]=[]),l[g][w]||(l[g][w]={t:"z",v:void 0}),l[g][w].l=e):(k=pt({c:w,r:g}),l[k]||(l[k]={t:"z",v:void 0}),l[k].l=e);break;case 426:if(!f.cellFormula)break;y.push(e),(_=f.dense?l[g][w]:l[ct(w)+S]).f=Fu(e[1],c,{r:v.r,c:w},A,f),_.F=bt(e[0]);break;case 427:if(!f.cellFormula)break;x[pt(e[0].s)]=e[1],(_=f.dense?l[g][w]:l[ct(w)+S]).f=Fu(e[1],c,{r:v.r,c:w},A,f);break;case 60:if(!f.cellStyles)break;for(;e.e>=e.s;)R[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},O||(O=!0,pl(e.w/256)),ml(R[e.e+1]);break;case 161:l["!autofilter"]={ref:bt(e)};break;case 476:l["!margins"]=e;break;case 147:n.Sheets[t]||(n.Sheets[t]={}),e.name&&(n.Sheets[t].CodeName=e.name);break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),e.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 49:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 152:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:u.push(r),h=!0;break;case 38:u.pop(),h=!1;break;default:if((r||"").indexOf("Begin")>0);else if((r||"").indexOf("End")>0);else if(!h||f.WTF)throw new Error("Unexpected record "+m+" "+r)}}),f),delete f.supbooks,delete f["!row"],!l["!ref"]&&(c.s.r<2e6||o&&(o.e.r>0||o.e.c>0||o.s.r>0||o.s.c>0))&&(l["!ref"]=bt(o||c)),f.sheetRows&&l["!ref"]){var P=gt(l["!ref"]);f.sheetRows<=+P.e.r&&(P.e.r=f.sheetRows-1,P.e.r>c.e.r&&(P.e.r=c.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>c.e.c&&(P.e.c=c.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),l["!fullref"]=l["!ref"],l["!ref"]=bt(P))}return C.length>0&&(l["!merges"]=C),R.length>0&&(l["!cols"]=R),D.length>0&&(l["!rows"]=D),l}function Dd(e,r,t,a,n,i){if(void 0!==r.v){var s="";switch(r.t){case"b":s=r.v?"1":"0";break;case"d":(r=le(r)).z=r.z||F._table[14],r.v=re(se(r.v)),r.t="n";break;case"n":case"e":s=""+r.v;break;default:s=r.v}var f={r:t,c:a};switch(f.s=fh(n.cellXfs,r,n),r.l&&i["!links"].push([pt(f),r.l]),r.c&&i["!comments"].push([pt(f),r.c]),r.t){case"s":case"str":return void(n.bookSST?(s=nh(n.Strings,r.v,n.revStrings),f.t="s",f.v=s,Jr(e,"BrtCellIsst",td(r,f))):(f.t="str",Jr(e,"BrtCellSt",ld(r,f))));case"n":return void(r.v==(0|r.v)&&r.v>-1e3&&r.v<1e3?Jr(e,"BrtCellRk",sd(r,f)):Jr(e,"BrtCellReal",nd(r,f)));case"b":return f.t="b",void Jr(e,"BrtCellBool",qh(r,f));case"e":f.t="e"}Jr(e,"BrtCellBlank",Qh(r,f))}}function Fd(e,r,t,a){var n=gt(r["!ref"]||"A1"),i,s="",f=[];Jr(e,"BrtBeginSheetData");var l=Array.isArray(r),o=n.e.r;r["!rows"]&&(o=Math.max(n.e.r,r["!rows"].length-1));for(var c=n.s.r;c<=o;++c)if(s=st(c),Xh(e,r,n,c),c<=n.e.r)for(var u=n.s.c;u<=n.e.c;++u){c===n.s.r&&(f[u]=ct(u)),i=f[u]+s;var h=l?(r[c]||[])[u]:r[i];h&&Dd(e,h,c,u,a,r)}Jr(e,"BrtEndSheetData")}function Od(e,r){r&&r["!merges"]&&(Jr(e,"BrtBeginMergeCells",pd(r["!merges"].length)),r["!merges"].forEach((function(r){Jr(e,"BrtMergeCell",vd(r))})),Jr(e,"BrtEndMergeCells"))}function Pd(e,r){r&&r["!cols"]&&(Jr(e,"BrtBeginColInfos"),r["!cols"].forEach((function(r,t){r&&Jr(e,"BrtColInfo",Ed(t,r))})),Jr(e,"BrtEndColInfos"))}function Nd(e,r){r&&r["!ref"]&&(Jr(e,"BrtBeginCellIgnoreECs"),Jr(e,"BrtCellIgnoreEC",yd(gt(r["!ref"]))),Jr(e,"BrtEndCellIgnoreECs"))}function Ld(e,r,t){r["!links"].forEach((function(r){if(r[1].Target){var a=za(t,-1,r[1].Target.replace(/#.*$/,""),Na.HLINK);Jr(e,"BrtHLink",bd(r,a))}})),delete r["!links"]}function Md(e,r,t,a){if(r["!comments"].length>0){var n=za(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Na.VML);Jr(e,"BrtLegacyDrawing",Wt("rId"+n)),r["!legacy"]=n}}function Ud(e,r,t,a){if(r["!autofilter"]){var n=r["!autofilter"],i="string"==typeof n.ref?n.ref:bt(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,f=mt(i);f.s.r==f.e.r&&(f.e.r=mt(r["!ref"]).e.r,i=bt(f));for(var l=0;l<s.length;++l){var o=s[l];if("_xlnm._FilterDatabase"==o.Name&&o.Sheet==a){o.Ref="'"+t.SheetNames[a]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+i}),Jr(e,"BrtBeginAFilter",Kt(gt(i))),Jr(e,"BrtEndAFilter")}}function Hd(e,r,t){Jr(e,"BrtBeginWsViews"),Jr(e,"BrtBeginWsView",Td(r,t)),Jr(e,"BrtEndWsView"),Jr(e,"BrtEndWsViews")}function Wd(){}function zd(e,r){r["!protect"]&&Jr(e,"BrtSheetProtection",xd(r["!protect"]))}function Vd(e,r,t,a){var n=Qr(),i=t.SheetNames[e],s=t.Sheets[i]||{},f=i;try{t&&t.Workbook&&(f=t.Workbook.Sheets[e].CodeName||f)}catch(l){}var o=gt(s["!ref"]||"A1");if(o.e.c>16383||o.e.r>1048575){if(r.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");o.e.c=Math.min(o.e.c,16383),o.e.r=Math.min(o.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Jr(n,"BrtBeginSheet"),t.vbaraw&&Jr(n,"BrtWsProp",$h(f)),Jr(n,"BrtWsDim",jh(o)),Hd(n,s,t.Workbook),Pd(n,s,e,r,t),Fd(n,s,e,r,t),zd(n,s),Ud(n,s,t,e),Od(n,s),Ld(n,s,a),s["!margins"]&&Jr(n,"BrtMargins",Cd(s["!margins"])),r&&!r.ignoreEC&&null!=r.ignoreEC||Nd(n,s),Md(n,s,e,a),Jr(n,"BrtEndSheet"),n.end()}function Xd(e){var r=[],t=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var a=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(r[+a[1]]=t?+a[2]:a[2])}));var n=Ne((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){a=e.replace(/<.*?>/g,"")})),[r,n,a]}function Gd(e,r,t,a,n,i){var s=i||{"!type":"chart"};if(!e)return i;var f=0,l=0,o="A",c={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var r=Xd(e);c.s.r=c.s.c=0,c.e.c=f,o=ct(f),r[0].forEach((function(e,t){s[o+st(t)]={t:"n",v:e,z:r[1]},l=t})),c.e.r<l&&(c.e.r=l),++f})),f>0&&(s["!ref"]=bt(c)),s}Na.CHART="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",Na.CHARTEX="http://schemas.microsoft.com/office/2014/relationships/chartEx",Na.CS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet";var jd=fr("chartsheet",null,{xmlns:cr.main[0],"xmlns:r":cr.r});function Kd(e,r,t,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,f=e.match(gh);return f&&Sh(f[0],i,n,t),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function Yd(e,r,t,a){var n=[ye,jd];return n[n.length]=fr("drawing",null,{"r:id":"rId1"}),za(a,-1,"../drawings/drawing"+(e+1)+".xml",Na.DRAW),n.length>2&&(n[n.length]="</chartsheet>",n[1]=n[1].replace("/>",">")),n.join("")}function $d(e,r){var t;return e.l+=10,{name:Bt(e,r-10)}}function Zd(e,r,t,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=[],f=!1;return Zr(e,(function l(e,a,o){switch(o){case 550:i["!rel"]=e;break;case 651:n.Sheets[t]||(n.Sheets[t]={}),e.name&&(n.Sheets[t].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:s.push(a);break;case 38:s.pop();break;default:if((a||"").indexOf("Begin")>0)s.push(a);else if((a||"").indexOf("End")>0)s.pop();else if(!f||r.WTF)throw new Error("Unexpected record "+o+" "+a)}}),r),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function Qd(){var e=Qr();return Jr(e,"BrtBeginSheet"),Jr(e,"BrtEndSheet"),e.end()}var Jd=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],qd=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ev=[],rv=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function tv(e,r){for(var t=0;t!=e.length;++t)for(var a=e[t],n=0;n!=r.length;++n){var i=r[n];if(null==a[i[0]])a[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof a[i[0]]&&(a[i[0]]=je(a[i[0]]));break;case"int":"string"==typeof a[i[0]]&&(a[i[0]]=parseInt(a[i[0]],10))}}}function av(e,r){for(var t=0;t!=r.length;++t){var a=r[t];if(null==e[a[0]])e[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof e[a[0]]&&(e[a[0]]=je(e[a[0]]));break;case"int":"string"==typeof e[a[0]]&&(e[a[0]]=parseInt(e[a[0]],10))}}}function nv(e){av(e.WBProps,Jd),av(e.CalcPr,rv),tv(e.WBView,qd),tv(e.Sheets,ev),th.date1904=je(e.WBProps.date1904)}function iv(e){return e.Workbook&&e.Workbook.WBProps&&je(e.Workbook.WBProps.date1904)?"true":"false"}var sv="][*?/\\".split("");function fv(e,r){if(e.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return sv.forEach((function(a){if(-1!=e.indexOf(a)){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}})),t}function lv(e,r,t){e.forEach((function(a,n){fv(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(t){var s=r&&r[n]&&r[n].CodeName||a;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}}))}function ov(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];lv(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)oh(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var cv=/<\w+:workbook/;function uv(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},s=0;if(e.replace(Ae,(function f(l,o){var c=De(l);switch(Fe(c[0])){case"<?xml":break;case"<workbook":l.match(cv)&&(n="xmlns"+l.match(/<(\w+):/)[1]),t.xmlns=c[n];break;case"</workbook>":break;case"<fileVersion":delete c[0],t.AppVersion=c;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Jd.forEach((function(e){if(null!=c[e[0]])switch(e[2]){case"bool":t.WBProps[e[0]]=je(c[e[0]]);break;case"int":t.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:t.WBProps[e[0]]=c[e[0]]}})),c.codeName&&(t.WBProps.CodeName=c.codeName);break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete c[0],t.WBView.push(c);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=Ne(Ke(c.name)),delete c[0],t.Sheets.push(c);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":(i={}).Name=Ke(c.name),c.comment&&(i.Comment=c.comment),c.localSheetId&&(i.Sheet=+c.localSheetId),je(c.hidden||"0")&&(i.Hidden=!0),s=o+l.length;break;case"</definedName>":i.Ref=Ne(Ke(e.slice(s,o))),t.Names.push(i);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete c[0],t.CalcPr=c;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return l})),-1===cr.main.indexOf(t.xmlns))throw new Error("Unknown Namespace: "+t.xmlns);return nv(t),t}var hv=fr("workbook",null,{xmlns:cr.main[0],"xmlns:r":cr.r});function dv(e){var r=[ye];r[r.length]=hv;var t=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Jd.forEach((function(r){null!=e.Workbook.WBProps[r[0]]&&e.Workbook.WBProps[r[0]]!=r[1]&&(a[r[0]]=e.Workbook.WBProps[r[0]])})),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),r[r.length]=fr("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;for(r[r.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Ue(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}r[r.length]=fr("sheet",null,s)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach((function(e){var t={name:e.Name};e.Comment&&(t.comment=e.Comment),null!=e.Sheet&&(t.localSheetId=""+e.Sheet),e.Hidden&&(t.hidden="1"),e.Ref&&(r[r.length]=fr("definedName",String(e.Ref).replace(/</g,"&lt;").replace(/>/g,"&gt;"),t))})),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function vv(e,r){var t={};return t.Hidden=e._R(4),t.iTabID=e._R(4),t.strRelID=Ht(e,r-8),t.name=Bt(e),t}function pv(e,r){return r||(r=$r(127)),r._W(4,e.Hidden),r._W(4,e.iTabID),Wt(e.strRelID,r),Tt(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function mv(e,r){var t={},a=e._R(4);t.defaultThemeVersion=e._R(4);var n=r>8?Bt(e):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(65536&a),t.backupFile=!!(64&a),t.checkCompatibility=!!(4096&a),t.date1904=!!(1&a),t.filterPrivacy=!!(8&a),t.hidePivotFieldList=!!(1024&a),t.promptedSolutions=!!(16&a),t.publishItems=!!(2048&a),t.refreshAllConnections=!!(262144&a),t.saveExternalLinkValues=!!(128&a),t.showBorderUnselectedTables=!!(4&a),t.showInkAnnotation=!!(32&a),t.showObjects=["all","placeholders","none"][a>>13&3],t.showPivotChartFilter=!!(32768&a),t.updateLinks=["userSet","never","always"][a>>8&3],t}function bv(e,r){r||(r=$r(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r._W(4,t),r._W(4,0),Nt(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function gv(e,r){var t={};return e._R(4),t.ArchID=e._R(4),e.l+=r-8,t}function wv(e,r,t){var a=e.l+r;e.l+=4,e.l+=1;var n=e._R(4),i=Ut(e),s=Gu(e,0,t),f=Lt(e);e.l=a;var l={Name:i,Ptg:s};return n<268435455&&(l.Sheet=n),f&&(l.Comment=f),l}function kv(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;r||(r={}),r.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Zr(e,(function f(e,l,o){switch(o){case 156:s.SheetNames.push(e.name),t.Sheets.push(e);break;case 153:t.WBProps=e;break;case 39:null!=e.Sheet&&(r.SID=e.Sheet),e.Ref=Fu(e.Ptg,null,null,s,r),delete r.SID,delete e.Ptg,i.push(e);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([o,e]):s[0]=[o,e],s[s.length-1].XTI=[];break;case 362:0===s.length&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(e),s.XTI=s.XTI.concat(e);break;case 361:break;case 3072:case 3073:case 2071:case 534:case 677:case 158:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(l),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(l),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if((l||"").indexOf("Begin")>0);else if((l||"").indexOf("End")>0);else if(!n||r.WTF&&"BrtACBegin"!=a[a.length-1]&&"BrtFRTBegin"!=a[a.length-1])throw new Error("Unexpected record "+o+" "+l)}}),r),nv(t),t.Names=i,t.supbooks=s,t}function Ev(e,r){Jr(e,"BrtBeginBundleShs");for(var t=0;t!=r.SheetNames.length;++t){var a,n;Jr(e,"BrtBundleSh",pv({Hidden:r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]}))}Jr(e,"BrtEndBundleShs")}function Sv(r,t){t||(t=$r(127));for(var a=0;4!=a;++a)t._W(4,0);return Tt("SheetJS",t),Tt(e.version,t),Tt(e.version,t),Tt("7262",t),t.length=t.l,t.length>t.l?t.slice(0,t.l):t}function _v(e,r){r||(r=$r(29)),r._W(-4,0),r._W(-4,460),r._W(4,28800),r._W(4,17600),r._W(4,500),r._W(4,e),r._W(4,e);var t=120;return r._W(1,t),r.length>r.l?r.slice(0,r.l):r}function Cv(e,r){if(r.Workbook&&r.Workbook.Sheets){for(var t=r.Workbook.Sheets,a=0,n=-1,i=-1;a<t.length;++a)!t[a]||!t[a].Hidden&&-1==n?n=a:1==t[a].Hidden&&-1==i&&(i=a);i>n||(Jr(e,"BrtBeginBookViews"),Jr(e,"BrtBookView",_v(n)),Jr(e,"BrtEndBookViews"))}}function Bv(e,r){var t=Qr();return Jr(t,"BrtBeginBook"),Jr(t,"BrtFileVersion",Sv()),Jr(t,"BrtWbProp",bv(e.Workbook&&e.Workbook.WBProps||null)),Cv(t,e,r),Ev(t,e,r),Jr(t,"BrtEndBook"),t.end()}function Tv(e,r,t){return".bin"===r.slice(-4)?kv(e,t):uv(e,t)}function yv(e,r,t,a,n,i,s,f){return".bin"===r.slice(-4)?Rd(e,a,t,n,i,s,f):kh(e,a,t,n,i,s,f)}function xv(e,r,t,a,n,i,s,f){return".bin"===r.slice(-4)?Zd(e,a,t,n,i,s,f):Kd(e,a,t,n,i,s,f)}function Av(e,r,t,a,n,i,s,f){return r.slice(-4),{"!type":"macro"}}function Iv(e,r,t,a,n,i,s,f){return r.slice(-4),{"!type":"dialog"}}function Rv(e,r,t,a){return".bin"===r.slice(-4)?$l(e,t,a):Rl(e,t,a)}function Dv(e,r,t){return mo(e,t)}function Fv(e,r,t){return".bin"===r.slice(-4)?xf(e,t):Cf(e,t)}function Ov(e,r,t){return".bin"===r.slice(-4)?zo(e,t):Po(e,t)}function Pv(e,r,t){return".bin"===r.slice(-4)?xo(e,r,t):To(e,r,t)}function Nv(e,r,t,a){if(".bin"===t.slice(-4))return Io(e,r,t,a)}function Lv(e,r,t){return(".bin"===r.slice(-4)?Bv:dv)(e,t)}function Mv(e,r,t,a,n){return(".bin"===r.slice(-4)?Vd:Wh)(e,t,a,n)}function Uv(e,r,t,a,n){return(".bin"===r.slice(-4)?Qd:Yd)(e,t,a,n)}function Hv(e,r,t){return(".bin"===r.slice(-4)?so:Fl)(e,t)}function Wv(e,r,t){return(".bin"===r.slice(-4)?Rf:Tf)(e,t)}function zv(e,r,t){return(".bin"===r.slice(-4)?Vo:Lo)(e,t)}var Vv=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Xv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Gv(e,r){var t=e.split(/\s+/),a=[];if(r||(a[0]=t[0]),1===t.length)return a;var n=e.match(Vv),i,s,f,l;if(n)for(l=0;l!=n.length;++l)-1===(s=(i=n[l].match(Xv))[1].indexOf(":"))?a[i[1]]=i[2].slice(1,i[2].length-1):a[f="xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(s+1)]=i[2].slice(1,i[2].length-1);return a}function jv(e){var r,t={};if(1===e.split(/\s+/).length)return t;var a=e.match(Vv),n,i,s,f;if(a)for(f=0;f!=a.length;++f)-1===(i=(n=a[f].match(Xv))[1].indexOf(":"))?t[n[1]]=n[2].slice(1,n[2].length-1):t[s="xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(i+1)]=n[2].slice(1,n[2].length-1);return t}function Kv(e,r){var t=P[e]||Ne(e);return"General"===t?F._general(r):F.format(t,r)}function Yv(e,r,t,a){var n=a;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=je(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=se(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Ne(r)]=n}function $v(e,r,t){if("z"!==e.t){if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Zt[e.v]:"General"===r?"n"===e.t?(0|e.v)===e.v?e.w=F._general_int(e.v):e.w=F._general_num(e.v):e.w=F._general(e.v):e.w=Kv(r||"General",e.v)}catch(a){if(t.WTF)throw a}try{var n=P[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&"n"==e.t&&F.is_date(n)){var i=F.parse_date_code(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(t.WTF)throw a}}}function Zv(e,r,t){if(t.cellStyles&&r.Interior){var a=r.Interior;a.Pattern&&(a.patternType=El[a.Pattern]||a.Pattern)}e[r.ID]=r}function Qv(e,r,t,a,n,i,s,f,l,o){var c="General",u=a.StyleID,h={};o=o||{};var d=[],v=0;for(void 0===u&&f&&(u=f.StyleID),void 0===u&&s&&(u=s.StyleID);void 0!==i[u]&&(i[u].nf&&(c=i[u].nf),i[u].Interior&&d.push(i[u].Interior),i[u].Parent);)u=i[u].Parent;switch(t.Type){case"Boolean":a.t="b",a.v=je(e);break;case"String":a.t="s",a.r=Xe(Ne(e)),a.v=e.indexOf("<")>-1?Ne(r||e):a.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),a.v=(se(e)-new Date(Date.UTC(1899,11,30)))/864e5,a.v!=a.v?a.v=Ne(e):a.v<60&&(a.v=a.v-1),c&&"General"!=c||(c="yyyy-mm-dd");case"Number":void 0===a.v&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Qt[e],!1!==o.cellText&&(a.w=e);break;default:a.t="s",a.v=Xe(r||e)}if($v(a,c,o),!1!==o.cellFormula)if(a.Formula){var p=Ne(a.Formula);61==p.charCodeAt(0)&&(p=p.slice(1)),a.f=Jo(p,n),delete a.Formula,"RC"==a.ArrayRange?a.F=Jo("RC:RC",n):a.ArrayRange&&(a.F=Jo(a.ArrayRange,n),l.push([gt(a.F),a.F]))}else for(v=0;v<l.length;++v)n.r>=l[v][0].s.r&&n.r<=l[v][0].e.r&&n.c>=l[v][0].s.c&&n.c<=l[v][0].e.c&&(a.F=l[v][1]);o.cellStyles&&(d.forEach((function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)})),a.s=h),void 0!==a.StyleID&&(a.ixfe=a.StyleID)}function Jv(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function qv(e){if(w&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return Ke(y(A(e)));throw new Error("Bad input format: expected Buffer or string")}var ep=/<(\/?)([^\s?>!\/:]*:|)([^\s?>:\/]+)[^>]*>/gm;function rp(e,r){var t=r||{};O(F);var a=d(qv(e));"binary"!=t.type&&"array"!=t.type&&"base64"!=t.type||(a="undefined"!=typeof cptable?cptable.utils.decode(65001,c(a)):Ke(a));var n=a.slice(0,1024).toLowerCase(),i=!1,s;if(-1==n.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){n.indexOf("<"+e)>=0&&(i=!0)})),i)return Kp.to_workbook(a,t);var f=[],l;var o={},u=[],h=t.dense?[]:{},v="",p={},b={},g={},w=Gv('<Data ss:Type="String">'),k=0,E=0,S=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},B={},T="",y=0,x=[],A={},I={},R=0,D=[],N=[],L={},M=[],U,H=!1,W=[],z=[],V={},X=0,G=0,j={Sheets:[],WBProps:{date1904:!1}},K={};for(ep.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/gm,"");s=ep.exec(a);)switch(s[3]){case"Data":if(f[f.length-1][1])break;"/"===s[1]?Qv(a.slice(k,s.index),T,w,"Comment"==f[f.length-1][0]?L:b,{c:E,r:S},C,M[E],g,W,t):(T="",w=Gv(s[0]),k=s.index+s[0].length);break;case"Cell":if("/"===s[1])if(N.length>0&&(b.c=N),(!t.sheetRows||t.sheetRows>S)&&void 0!==b.v&&(t.dense?(h[S]||(h[S]=[]),h[S][E]=b):h[ct(E)+st(S)]=b),b.HRef&&(b.l={Target:b.HRef},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(X=E+(0|parseInt(b.MergeAcross,10)),G=S+(0|parseInt(b.MergeDown,10)),x.push({s:{c:E,r:S},e:{c:X,r:G}})),t.sheetStubs)if(b.MergeAcross||b.MergeDown){for(var Y=E;Y<=X;++Y)for(var $=S;$<=G;++$)(Y>E||$>S)&&(t.dense?(h[$]||(h[$]=[]),h[$][Y]={t:"z"}):h[ct(Y)+st($)]={t:"z"});E=X+1}else++E;else b.MergeAcross?E=X+1:++E;else(b=jv(s[0])).Index&&(E=+b.Index-1),E<_.s.c&&(_.s.c=E),E>_.e.c&&(_.e.c=E),"/>"===s[0].slice(-2)&&++E,N=[];break;case"Row":"/"===s[1]||"/>"===s[0].slice(-2)?(S<_.s.r&&(_.s.r=S),S>_.e.r&&(_.e.r=S),"/>"===s[0].slice(-2)&&(g=Gv(s[0])).Index&&(S=+g.Index-1),E=0,++S):((g=Gv(s[0])).Index&&(S=+g.Index-1),V={},("0"==g.AutoFitHeight||g.Height)&&(V.hpx=parseInt(g.Height,10),V.hpt=wl(V.hpx),z[S]=V),"1"==g.Hidden&&(V.hidden=!0,z[S]=V));break;case"Worksheet":if("/"===s[1]){if((l=f.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"));u.push(v),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(h["!ref"]=bt(_),t.sheetRows&&t.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=t.sheetRows-1,h["!ref"]=bt(_))),x.length&&(h["!merges"]=x),M.length>0&&(h["!cols"]=M),z.length>0&&(h["!rows"]=z),o[v]=h}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=E=0,f.push([s[3],!1]),l=Gv(s[0]),v=Ne(l.Name),h=t.dense?[]:{},x=[],W=[],z=[],K={name:v,Hidden:0},j.Sheets.push(K);break;case"Table":if("/"===s[1]){if((l=f.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==s[0].slice(-2))break;p=Gv(s[0]),f.push([s[3],!1]),M=[],H=!1}break;case"Style":"/"===s[1]?Zv(C,B,t):B=Gv(s[0]);break;case"NumberFormat":B.nf=Ne(Gv(s[0]).Format||"General"),P[B.nf]&&(B.nf=P[B.nf]);for(var Z=0;392!=Z&&F._table[Z]!=B.nf;++Z);if(392==Z)for(Z=57;392!=Z;++Z)if(null==F._table[Z]){F.load(B.nf,Z);break}break;case"Column":if("Table"!==f[f.length-1][0])break;if((U=Gv(s[0])).Hidden&&(U.hidden=!0,delete U.Hidden),U.Width&&(U.wpx=parseInt(U.Width,10)),!H&&U.wpx>10){H=!0,cl=6;for(var Q=0;Q<M.length;++Q)M[Q]&&ml(M[Q])}H&&ml(U),M[U.Index-1||M.length]=U;for(var J=0;J<+U.Span;++J)M[M.length]=le(U);break;case"NamedRange":j.Names||(j.Names=[]);var q=De(s[0]),ee={Name:q.Name,Ref:Jo(q.RefersTo.slice(1),{r:0,c:0})};j.Sheets.length>0&&(ee.Sheet=j.Sheets.length-1),j.Names.push(ee);break;case"NamedCell":case"B":case"I":case"U":case"S":case"Sub":case"Sup":case"Span":case"Alignment":case"Borders":case"Border":break;case"Font":if("/>"===s[0].slice(-2))break;"/"===s[1]?T+=a.slice(y,s.index):y=s.index+s[0].length;break;case"Interior":if(!t.cellStyles)break;B.Interior=Gv(s[0]);break;case"Protection":break;case"Author":case"Title":case"Description":case"Created":case"Keywords":case"Subject":case"Category":case"Company":case"LastAuthor":case"LastSaved":case"LastPrinted":case"Version":case"Revision":case"TotalTime":case"HyperlinkBase":case"Manager":case"ContentStatus":case"Identifier":case"Language":case"AppName":if("/>"===s[0].slice(-2))break;"/"===s[1]?pn(A,s[3],a.slice(R,s.index)):R=s.index+s[0].length;break;case"Paragraphs":break;case"Styles":case"Workbook":if("/"===s[1]){if((l=f.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else f.push([s[3],!1]);break;case"Comment":if("/"===s[1]){if((l=f.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"));Jv(L),N.push(L)}else f.push([s[3],!1]),L={a:(l=Gv(s[0])).Author};break;case"AutoFilter":if("/"===s[1]){if((l=f.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==s[0].charAt(s[0].length-2)){var re=Gv(s[0]);h["!autofilter"]={ref:Jo(re.Range).replace(/\$/g,"")},f.push([s[3],!0])}break;case"Name":break;case"DataValidation":if("/"===s[1]){if((l=f.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&f.push([s[3],!0]);break;case"ComponentOptions":case"DocumentProperties":case"CustomDocumentProperties":case"OfficeDocumentSettings":case"PivotTable":case"PivotCache":case"Names":case"MapInfo":case"PageBreaks":case"QueryTable":case"Sorting":case"Schema":case"data":case"ConditionalFormatting":case"SmartTagType":case"SmartTags":case"ExcelWorkbook":case"WorkbookOptions":case"WorksheetOptions":if("/"===s[1]){if((l=f.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&f.push([s[3],!0]);break;default:if(0==f.length&&"document"==s[3])return em(a,t);if(0==f.length&&"UOF"==s[3])return em(a,t);var te=!0;switch(f[f.length-1][0]){case"OfficeDocumentSettings":switch(s[3]){case"AllowPNG":case"RemovePersonalInformation":case"DownloadComponents":case"LocationOfComponents":case"Colors":case"Color":case"Index":case"RGB":case"PixelsPerInch":case"TargetScreenSize":case"ReadOnlyRecommended":break;default:te=!1}break;case"ComponentOptions":switch(s[3]){case"Toolbar":case"HideOfficeLogo":case"SpreadsheetAutoFit":case"Label":case"Caption":case"MaxHeight":case"MaxWidth":case"NextSheetNumber":break;default:te=!1}break;case"ExcelWorkbook":switch(s[3]){case"Date1904":j.WBProps.date1904=!0;break;case"WindowHeight":case"WindowWidth":case"WindowTopX":case"WindowTopY":case"TabRatio":case"ProtectStructure":case"ProtectWindow":case"ProtectWindows":case"ActiveSheet":case"DisplayInkNotes":case"FirstVisibleSheet":case"SupBook":case"SheetName":case"SheetIndex":case"SheetIndexFirst":case"SheetIndexLast":case"Dll":case"AcceptLabelsInFormulas":case"DoNotSaveLinkValues":case"Iteration":case"MaxIterations":case"MaxChange":case"Path":case"Xct":case"Count":case"SelectedSheets":case"Calculation":case"Uncalced":case"StartupPrompt":case"Crn":case"ExternName":case"Formula":case"ColFirst":case"ColLast":case"WantAdvise":case"Boolean":case"Error":case"Text":case"OLE":case"NoAutoRecover":case"PublishObjects":case"DoNotCalculateBeforeSave":case"Number":case"RefModeR1C1":case"EmbedSaveSmartTags":break;default:te=!1}break;case"WorkbookOptions":switch(s[3]){case"OWCVersion":case"Height":case"Width":break;default:te=!1}break;case"WorksheetOptions":switch(s[3]){case"Visible":if("/>"===s[0].slice(-2));else if("/"===s[1])switch(a.slice(R,s.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2}else R=s.index+s[0].length;break;case"Header":h["!margins"]||sh(h["!margins"]={},"xlml"),h["!margins"].header=De(s[0]).Margin;break;case"Footer":h["!margins"]||sh(h["!margins"]={},"xlml"),h["!margins"].footer=De(s[0]).Margin;break;case"PageMargins":var ae=De(s[0]);h["!margins"]||sh(h["!margins"]={},"xlml"),ae.Top&&(h["!margins"].top=ae.Top),ae.Left&&(h["!margins"].left=ae.Left),ae.Right&&(h["!margins"].right=ae.Right),ae.Bottom&&(h["!margins"].bottom=ae.Bottom);break;case"DisplayRightToLeft":j.Views||(j.Views=[]),j.Views[0]||(j.Views[0]={}),j.Views[0].RTL=!0;break;case"FreezePanes":case"FrozenNoSplit":break;case"SplitHorizontal":case"SplitVertical":case"DoNotDisplayGridlines":case"TopRowBottomPane":case"LeftColumnRightPane":case"Unsynced":case"Print":case"Panes":case"Scale":case"Pane":case"Number":case"Layout":case"PageSetup":case"Selected":case"ProtectObjects":case"EnableSelection":case"ProtectScenarios":case"ValidPrinterInfo":case"HorizontalResolution":case"VerticalResolution":case"NumberofCopies":case"ActiveRow":case"ActiveCol":case"ActivePane":case"TopRowVisible":case"LeftColumnVisible":case"FitToPage":case"RangeSelection":case"PaperSizeIndex":case"PageLayoutZoom":case"PageBreakZoom":case"FilterOn":case"FitWidth":case"FitHeight":case"CommentsLayout":case"Zoom":case"LeftToRight":case"Gridlines":case"AllowSort":case"AllowFilter":case"AllowInsertRows":case"AllowDeleteRows":case"AllowInsertCols":case"AllowDeleteCols":case"AllowInsertHyperlinks":case"AllowFormatCells":case"AllowSizeCols":case"AllowSizeRows":case"NoSummaryRowsBelowDetail":case"TabColorIndex":case"DoNotDisplayHeadings":case"ShowPageLayoutZoom":case"NoSummaryColumnsRightDetail":case"BlackAndWhite":case"DoNotDisplayZeros":case"DisplayPageBreak":case"RowColHeadings":case"DoNotDisplayOutline":case"NoOrientation":case"AllowUsePivotTables":case"ZeroHeight":case"ViewableRange":case"Selection":case"ProtectContents":break;default:te=!1}break;case"PivotTable":case"PivotCache":switch(s[3]){case"ImmediateItemsOnDrop":case"ShowPageMultipleItemLabel":case"CompactRowIndent":case"Location":case"PivotField":case"Orientation":case"LayoutForm":case"LayoutSubtotalLocation":case"LayoutCompactRow":case"Position":case"PivotItem":case"DataType":case"DataField":case"SourceName":case"ParentField":case"PTLineItems":case"PTLineItem":case"CountOfSameItems":case"Item":case"ItemType":case"PTSource":case"CacheIndex":case"ConsolidationReference":case"FileName":case"Reference":case"NoColumnGrand":case"NoRowGrand":case"BlankLineAfterItems":case"Hidden":case"Subtotal":case"BaseField":case"MapChildItems":case"Function":case"RefreshOnFileOpen":case"PrintSetTitles":case"MergeLabels":case"DefaultVersion":case"RefreshName":case"RefreshDate":case"RefreshDateCopy":case"VersionLastRefresh":case"VersionLastUpdate":case"VersionUpdateableMin":case"VersionRefreshableMin":case"Calculation":break;default:te=!1}break;case"PageBreaks":switch(s[3]){case"ColBreaks":case"ColBreak":case"RowBreaks":case"RowBreak":case"ColStart":case"ColEnd":case"RowEnd":break;default:te=!1}break;case"AutoFilter":switch(s[3]){case"AutoFilterColumn":case"AutoFilterCondition":case"AutoFilterAnd":case"AutoFilterOr":break;default:te=!1}break;case"QueryTable":switch(s[3]){case"Id":case"AutoFormatFont":case"AutoFormatPattern":case"QuerySource":case"QueryType":case"EnableRedirections":case"RefreshedInXl9":case"URLString":case"HTMLTables":case"Connection":case"CommandText":case"RefreshInfo":case"NoTitles":case"NextId":case"ColumnInfo":case"OverwriteCells":case"DoNotPromptForFile":case"TextWizardSettings":case"Source":case"Number":case"Decimal":case"ThousandSeparator":case"TrailingMinusNumbers":case"FormatSettings":case"FieldType":case"Delimiters":case"Tab":case"Comma":case"AutoFormatName":case"VersionLastEdit":case"VersionLastRefresh":break;default:te=!1}break;case"DataValidation":switch(s[3]){case"Range":case"Type":case"Min":case"Max":case"Sort":case"Descending":case"Order":case"CaseSensitive":case"Value":case"ErrorStyle":case"ErrorMessage":case"ErrorTitle":case"InputMessage":case"InputTitle":case"ComboHide":case"InputHide":case"Condition":case"Qualifier":case"UseBlank":case"Value1":case"Value2":case"Format":case"CellRangeList":break;default:te=!1}break;case"Sorting":case"ConditionalFormatting":switch(s[3]){case"Range":case"Type":case"Min":case"Max":case"Sort":case"Descending":case"Order":case"CaseSensitive":case"Value":case"ErrorStyle":case"ErrorMessage":case"ErrorTitle":case"CellRangeList":case"InputMessage":case"InputTitle":case"ComboHide":case"InputHide":case"Condition":case"Qualifier":case"UseBlank":case"Value1":case"Value2":case"Format":break;default:te=!1}break;case"MapInfo":case"Schema":case"data":switch(s[3]){case"Map":case"Entry":case"Range":case"XPath":case"Field":case"XSDType":case"FilterOn":case"Aggregate":case"ElementType":case"AttributeType":break;case"schema":case"element":case"complexType":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:te=!1}break;case"SmartTags":break;default:te=!1}if(te)break;if(s[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+s[3]+"|"+f.join("|");if("CustomDocumentProperties"===f[f.length-1][0]){if("/>"===s[0].slice(-2))break;"/"===s[1]?Yv(I,s[3],D,a.slice(R,s.index)):(D=s,R=s.index+s[0].length);break}if(t.WTF)throw"Unrecognized tag: "+s[3]+"|"+f.join("|")}var ne={};return t.bookSheets||t.bookProps||(ne.Sheets=o),ne.SheetNames=u,ne.Workbook=j,ne.SSF=F.get_table(),ne.Props=A,ne.Custprops=I,ne}function tp(e,r){switch(mm(r=r||{}),r.type||"base64"){case"base64":return rp(g.decode(e),r);case"binary":case"buffer":case"file":return rp(e,r);case"array":return rp(y(e),r)}}function ap(e,r){var t=[];return e.Props&&t.push(mn(e.Props,r)),e.Custprops&&t.push(bn(e.Props,e.Custprops,r)),t.join("")}function np(){return""}function ip(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach((function(e,r){var a=[];a.push(fr("NumberFormat",null,{"ss:Format":Ue(F._table[e.numFmtId])})),t.push(fr("Style",a.join(""),{"ss:ID":"s"+(21+r)}))})),fr("Styles",t.join(""))}function sp(e){return fr("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ec(e.Ref,{r:0,c:0})})}function fp(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],a=0;a<r.length;++a){var n=r[a];null==n.Sheet&&(n.Name.match(/^_xlfn\./)||t.push(sp(n)))}return fr("Names",t.join(""))}function lp(e,r,t,a){if(!e)return"";if(!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],s=0;s<n.length;++s){var f=n[s];f.Sheet==t&&(f.Name.match(/^_xlfn\./)||i.push(sp(f)))}return i.join("")}function op(e,r,t,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(fr("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(fr("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(fr("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t])if(a.Workbook.Sheets[t].Hidden)n.push(fr("Visible",1==a.Workbook.Sheets[t].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<t&&(!a.Workbook.Sheets[i]||a.Workbook.Sheets[i].Hidden);++i);i==t&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(ir("ProtectContents","True")),e["!protect"].objects&&n.push(ir("ProtectObjects","True")),e["!protect"].scenarios&&n.push(ir("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||n.push(ir("EnableSelection","UnlockedCells")):n.push(ir("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach((function(r){e["!protect"][r[0]]&&n.push("<"+r[1]+"/>")}))),0==n.length?"":fr("WorksheetOptions",n.join(""),{xmlns:ur_x})}function cp(e){return e.map((function(e){var r,t=fr("ss:Data",Ge(e.t||""),{xmlns:"http://www.w3.org/TR/REC-html40"});return fr("Comment",t,{"ss:Author":e.a})})).join("")}function up(e,r,t,a,n,i,s){if(!e||null==e.v&&null==e.f)return"";var f={};if(e.f&&(f["ss:Formula"]="="+Ue(ec(e.f,s))),e.F&&e.F.slice(0,r.length)==r){var l=vt(e.F.slice(r.length+1));f["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(f["ss:HRef"]=Ue(e.l.Target),e.l.Tooltip&&(f["x:HRefScreenTip"]=Ue(e.l.Tooltip))),t["!merges"])for(var o=t["!merges"],c=0;c!=o.length;++c)o[c].s.c==s.c&&o[c].s.r==s.r&&(o[c].e.c>o[c].s.c&&(f["ss:MergeAcross"]=o[c].e.c-o[c].s.c),o[c].e.r>o[c].s.r&&(f["ss:MergeDown"]=o[c].e.r-o[c].s.r));var u="",h="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":u="Number",h=String(e.v);break;case"b":u="Boolean",h=e.v?"1":"0";break;case"e":u="Error",h=Zt[e.v];break;case"d":u="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||F._table[14]);break;case"s":u="String",h=Ve(e.v||"")}var d=fh(a.cellXfs,e,a);f["ss:StyleID"]="s"+(21+d),f["ss:Index"]=s.c+1;var v=null!=e.v?h:"",p="z"==e.t?"":'<Data ss:Type="'+u+'">'+v+"</Data>";return(e.c||[]).length>0&&(p+=cp(e.c)),fr("Cell",p,f)}function hp(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=kl(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function dp(e,r,t,a){if(!e["!ref"])return"";var n=gt(e["!ref"]),i=e["!merges"]||[],s=0,f=[];e["!cols"]&&e["!cols"].forEach((function(e,r){ml(e);var t=!!e.width,a=ih(r,e),n={"ss:Index":r+1};t&&(n["ss:Width"]=ul(a.width)),e.hidden&&(n["ss:Hidden"]="1"),f.push(fr("Column",null,n))}));for(var l=Array.isArray(e),o=n.s.r;o<=n.e.r;++o){for(var c=[hp(o,(e["!rows"]||[])[o])],u=n.s.c;u<=n.e.c;++u){var h=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>u||i[s].s.r>o||i[s].e.c<u||i[s].e.r<o)){i[s].s.c==u&&i[s].s.r==o||(h=!0);break}if(!h){var d={r:o,c:u},v=pt(d),p=l?(e[o]||[])[u]:e[v];c.push(up(p,v,e,r,t,a,d))}}c.push("</Row>"),c.length>2&&f.push(c.join(""))}return f.join("")}function vp(e,r,t){var a=[],n=t.SheetNames[e],i=t.Sheets[n],s=i?lp(i,r,e,t):"";return s.length>0&&a.push("<Names>"+s+"</Names>"),(s=i?dp(i,r,e,t):"").length>0&&a.push("<Table>"+s+"</Table>"),a.push(op(i,r,e,t)),a.join("")}function pp(e,r){r||(r={}),e.SSF||(e.SSF=F.get_table()),e.SSF&&(O(F),F.load_table(e.SSF),r.revssf=Q(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],fh(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(ap(e,r)),t.push(""),t.push(""),t.push("");for(var a=0;a<e.SheetNames.length;++a)t.push(fr("Worksheet",vp(a,r,e),{"ss:Name":Ue(e.SheetNames[a])}));return t[2]=ip(e,r),t[3]=fp(e,r),ye+fr("Workbook",t.join(""),{xmlns:ur_ss,"xmlns:o":ur_o,"xmlns:x":ur_x,"xmlns:ss":ur_ss,"xmlns:dt":ur_dt,"xmlns:html":ur_html})}function mp(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t._R(0,"lpstr-ansi"),r.AnsiClipboardFormat=aa(t),t.length-t.l<=4)return r;var a=t._R(4);return 0==a||a>40?r:(t.l-=4,r.Reserved1=t._R(0,"lpstr-ansi"),t.length-t.l<=4?r:1907505652!==(a=t._R(4))?r:(r.UnicodeClipboardFormat=na(t),0==(a=t._R(4))||a>40?r:(t.l-=4,void(r.Reserved2=t._R(0,"lpwstr")))))}function bp(e,r,t,a){var n=t,i=[],s=r.slice(r.l,r.l+n);if(a&&a.enc&&a.enc.insitu)switch(e.n){case"BOF":case"FilePass":case"FileLock":case"InterfaceHdr":case"RRDInfo":case"RRDHead":case"UsrExcl":break;default:if(0===s.length)break;a.enc.insitu(s)}i.push(s),r.l+=n;for(var f=xp[Nr(r,r.l)],l=0;null!=f&&"Continue"===f.n.slice(0,8);)n=Nr(r,r.l+2),l=r.l+4,"ContinueFrt"==f.n?l+=4:"ContinueFrt"==f.n.slice(0,11)&&(l+=12),i.push(r.slice(l,r.l+4+n)),r.l+=4+n,f=xp[Nr(r,r.l)];var o=I(i);Kr(o,0);var c=0;o.lens=[];for(var u=0;u<i.length;++u)o.lens.push(c),c+=i[u].length;return e.f(o,o.length,a)}function gp(e,r,t){if("z"!==e.t&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=F._table[a])}catch(n){if(r.WTF)throw n}if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||Zt[e.v]:0===a||"General"==a?"n"===e.t?(0|e.v)===e.v?e.w=F._general_int(e.v):e.w=F._general_num(e.v):e.w=F._general(e.v):e.w=F.format(a,e.v,{date1904:!!t})}catch(n){if(r.WTF)throw n}if(r.cellDates&&a&&"n"==e.t&&F.is_date(F._table[a]||String(a))){var i=F.parse_date_code(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function wp(e,r,t){return{v:e,ixfe:r,t:t}}function kp(e,r){var t={opts:{}},a={};var n=r.dense?[]:{},i={},s={},f=null,o=[],c="",u={},h,d="",v,p,b,g,w={},k=[],E,S,_=!0,C=[],B=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},y={},x=function we(e){return e<8?ya[e]:e<64&&B[e-8]||ya[e]},A=function ke(e,r,t){var a=r.XF.data,n;a&&a.patternType&&t&&t.cellStyles&&(r.s={},r.s.patternType=a.patternType,(n=al(x(a.icvFore)))&&(r.s.fgColor={rgb:n}),(n=al(x(a.icvBack)))&&(r.s.bgColor={rgb:n}))},I=function Ee(e,r,t){if(!(V>1)&&(t.sheetRows&&e.r>=t.sheetRows&&(_=!1),_)){if(t.cellStyles&&r.XF&&r.XF.data&&A(e,r,t),delete r.ixfe,delete r.XF,h=e,d=pt(e),s&&s.s&&s.e||(s={s:{r:0,c:0},e:{r:0,c:0}}),e.r<s.s.r&&(s.s.r=e.r),e.c<s.s.c&&(s.s.c=e.c),e.r+1>s.e.r&&(s.e.r=e.r+1),e.c+1>s.e.c&&(s.e.c=e.c+1),t.cellFormula&&r.f)for(var a=0;a<k.length;++a)if(!(k[a][0].s.c>e.c||k[a][0].s.r>e.r||k[a][0].e.c<e.c||k[a][0].e.r<e.r)){r.F=bt(k[a][0]),k[a][0].s.c==e.c&&k[a][0].s.r==e.r||delete r.f,r.f&&(r.f=""+Fu(k[a][1],s,e,W,R));break}t.dense?(n[e.r]||(n[e.r]=[]),n[e.r][e.c]=r):n[d]=r}},R={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf},D;r.password&&(R.password=r.password);var O=[],P=[],N=[],L=[],M=0,U=0,H=!1,W=[];W.SheetNames=R.snames,W.sharedf=R.sharedf,W.arrayf=R.arrayf,W.names=[],W.XTI=[];var z="",V=0,X=0,G=[],j=[],Y;R.codepage=1200,l(1200);for(var $=!1;e.l<e.length-1;){var Z=e.l,Q=e._R(2);if(0===Q&&"EOF"===z)break;var J=e.l===e.length?0:e._R(2),q=xp[Q];if(q&&q.f){if(r.bookSheets&&"BoundSheet8"===z&&"BoundSheet8"!==q.n)break;if(z=q.n,2===q.r||12==q.r){var ee=e._R(2);if(J-=2,!R.enc&&ee!==Q&&((255&ee)<<8|ee>>8)!==Q)throw new Error("rt mismatch: "+ee+"!="+Q);12==q.r&&(e.l+=10,J-=10)}var re={};re="EOF"===q.n?q.f(e,J,R):bp(q,e,J,R);var te=q.n;if(0==V&&"BOF"!=te)continue;switch(te){case"Date1904":t.opts.Date1904=T.WBProps.date1904=re;break;case"WriteProtect":t.opts.WriteProtect=!0;break;case"FilePass":if(R.enc||(e.l=0),R.enc=re,!r.password)throw new Error("File is password-protected");if(null==re.valid)throw new Error("Encryption scheme unsupported");if(!re.valid)throw new Error("Password is incorrect");break;case"WriteAccess":R.lastuser=re;break;case"FileSharing":break;case"CodePage":var ae=Number(re);switch(ae){case 21010:ae=1200;break;case 32768:ae=1e4;break;case 32769:ae=1252}l(R.codepage=ae),$=!0;break;case"RRTabId":R.rrtabid=re;break;case"WinProtect":R.winlocked=re;break;case"Template":case"BookBool":case"UsesELFs":case"MTRSettings":break;case"RefreshAll":case"CalcCount":case"CalcDelta":case"CalcIter":case"CalcMode":case"CalcPrecision":case"CalcSaveRecalc":t.opts[te]=re;break;case"CalcRefMode":R.CalcRefMode=re;break;case"Uncalced":break;case"ForceFullCalculation":t.opts.FullCalc=re;break;case"WsBool":re.fDialog&&(n["!type"]="dialog");break;case"XF":C.push(re);break;case"ExtSST":case"BookExt":case"RichTextStream":case"BkHim":break;case"SupBook":W.push([re]),W[W.length-1].XTI=[];break;case"ExternName":W[W.length-1].push(re);break;case"Index":break;case"Lbl":Y={Name:re.Name,Ref:Fu(re.rgce,s,null,W,R)},re.itab>0&&(Y.Sheet=re.itab-1),W.names.push(Y),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(re),"_xlnm._FilterDatabase"==re.Name&&re.itab>0&&re.rgce&&re.rgce[0]&&re.rgce[0][0]&&"PtgArea3d"==re.rgce[0][0][0]&&(j[re.itab-1]={ref:bt(re.rgce[0][0][1][2])});break;case"ExternCount":R.ExternCount=re;break;case"ExternSheet":0==W.length&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(re),W.XTI=W.XTI.concat(re);break;case"NameCmt":if(R.biff<8)break;null!=Y&&(Y.Comment=re[1]);break;case"Protect":n["!protect"]=re;break;case"Password":0!==re&&R.WTF&&console.error("Password verifier: "+re);break;case"Prot4Rev":case"Prot4RevPass":break;case"BoundSheet8":i[re.pos]=re,R.snames.push(re.name);break;case"EOF":if(--V)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,n["!ref"]=bt(s),r.sheetRows&&r.sheetRows<=s.e.r){var ne=s.e.r;s.e.r=r.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=bt(s),s.e.r=ne}s.e.r++,s.e.c++}O.length>0&&(n["!merges"]=O),P.length>0&&(n["!objects"]=P),N.length>0&&(n["!cols"]=N),L.length>0&&(n["!rows"]=L),T.Sheets.push(y)}""===c?u=n:a[c]=n,n=r.dense?[]:{};break;case"BOF":if(8===R.biff&&(R.biff={9:2,521:3,1033:4}[Q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[re.BIFFVer]||8),8==R.biff&&0==re.BIFFVer&&16==re.dt&&(R.biff=2),V++)break;if(_=!0,n=r.dense?[]:{},R.biff<8&&!$&&($=!0,l(R.codepage=r.codepage||1252)),R.biff<5){""===c&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var ie={pos:e.l-J,name:c};i[ie.pos]=ie,R.snames.push(c)}else c=(i[Z]||{name:""}).name;32==re.dt&&(n["!type"]="chart"),64==re.dt&&(n["!type"]="macro"),O=[],P=[],R.arrayf=k=[],N=[],L=[],M=U=0,H=!1,y={Hidden:(i[Z]||{hs:0}).hs,name:c};break;case"Number":case"BIFF2NUM":case"BIFF2INT":"chart"==n["!type"]&&(r.dense?(n[re.r]||[])[re.c]:n[pt({c:re.c,r:re.r})])&&++re.c,E={ixfe:re.ixfe,XF:C[re.ixfe]||{},v:re.val,t:"n"},X>0&&(E.z=G[E.ixfe>>8&31]),gp(E,r,t.opts.Date1904),I({c:re.c,r:re.r},E,r);break;case"BoolErr":E={ixfe:re.ixfe,XF:C[re.ixfe],v:re.val,t:re.t},X>0&&(E.z=G[E.ixfe>>8&31]),gp(E,r,t.opts.Date1904),I({c:re.c,r:re.r},E,r);break;case"RK":E={ixfe:re.ixfe,XF:C[re.ixfe],v:re.rknum,t:"n"},X>0&&(E.z=G[E.ixfe>>8&31]),gp(E,r,t.opts.Date1904),I({c:re.c,r:re.r},E,r);break;case"MulRk":for(var se=re.c;se<=re.C;++se){var fe=re.rkrec[se-re.c][0];E={ixfe:fe,XF:C[fe],v:re.rkrec[se-re.c][1],t:"n"},X>0&&(E.z=G[E.ixfe>>8&31]),gp(E,r,t.opts.Date1904),I({c:se,r:re.r},E,r)}break;case"Formula":if("String"==re.val){f=re;break}if((E=wp(re.val,re.cell.ixfe,re.tt)).XF=C[E.ixfe],r.cellFormula){var le=re.formula;if(le&&le[0]&&le[0][0]&&"PtgExp"==le[0][0][0]){var oe=le[0][0][1][0],ce=le[0][0][1][1],ue=pt({r:oe,c:ce});w[ue]?E.f=""+Fu(re.formula,s,re.cell,W,R):E.F=((r.dense?(n[oe]||[])[ce]:n[ue])||{}).F}else E.f=""+Fu(re.formula,s,re.cell,W,R)}X>0&&(E.z=G[E.ixfe>>8&31]),gp(E,r,t.opts.Date1904),I(re.cell,E,r),f=re;break;case"String":if(!f)throw new Error("String record expects Formula");f.val=re,(E=wp(re,f.cell.ixfe,"s")).XF=C[E.ixfe],r.cellFormula&&(E.f=""+Fu(f.formula,s,f.cell,W,R)),X>0&&(E.z=G[E.ixfe>>8&31]),gp(E,r,t.opts.Date1904),I(f.cell,E,r),f=null;break;case"Array":k.push(re);var he=pt(re[0].s);if(v=r.dense?(n[re[0].s.r]||[])[re[0].s.c]:n[he],r.cellFormula&&v){if(!f)break;if(!he||!v)break;v.f=""+Fu(re[1],s,re[0],W,R),v.F=bt(re[0])}break;case"ShrFmla":if(!_)break;if(!r.cellFormula)break;if(d){if(!f)break;w[pt(f.cell)]=re[0],((v=r.dense?(n[f.cell.r]||[])[f.cell.c]:n[pt(f.cell)])||{}).f=""+Fu(re[0],s,h,W,R)}break;case"LabelSst":E=wp(o[re.isst].t,re.ixfe,"s"),o[re.isst].h&&(E.h=o[re.isst].h),E.XF=C[E.ixfe],X>0&&(E.z=G[E.ixfe>>8&31]),gp(E,r,t.opts.Date1904),I({c:re.c,r:re.r},E,r);break;case"Blank":r.sheetStubs&&(E={ixfe:re.ixfe,XF:C[re.ixfe],t:"z"},X>0&&(E.z=G[E.ixfe>>8&31]),gp(E,r,t.opts.Date1904),I({c:re.c,r:re.r},E,r));break;case"MulBlank":if(r.sheetStubs)for(var de=re.c;de<=re.C;++de){var ve=re.ixfe[de-re.c];E={ixfe:ve,XF:C[ve],t:"z"},X>0&&(E.z=G[E.ixfe>>8&31]),gp(E,r,t.opts.Date1904),I({c:de,r:re.r},E,r)}break;case"RString":case"Label":case"BIFF2STR":(E=wp(re.val,re.ixfe,"s")).XF=C[E.ixfe],X>0&&(E.z=G[E.ixfe>>8&31]),gp(E,r,t.opts.Date1904),I({c:re.c,r:re.r},E,r);break;case"Dimensions":1===V&&(s=re);break;case"SST":o=re;break;case"Format":if(4==R.biff){G[X++]=re[1];for(var pe=0;pe<X+163&&F._table[pe]!=re[1];++pe);pe>=163&&F.load(re[1],X+163)}else F.load(re[1],re[0]);break;case"BIFF2FORMAT":G[X++]=re;for(var me=0;me<X+163&&F._table[me]!=re;++me);me>=163&&F.load(re,X+163);break;case"MergeCells":O=O.concat(re);break;case"Obj":P[re.cmo[0]]=R.lastobj=re;break;case"TxO":R.lastobj.TxO=re;break;case"ImData":R.lastobj.ImData=re;break;case"HLink":for(g=re[0].s.r;g<=re[0].e.r;++g)for(b=re[0].s.c;b<=re[0].e.c;++b)(v=r.dense?(n[g]||[])[b]:n[pt({c:b,r:g})])&&(v.l=re[1]);break;case"HLinkTooltip":for(g=re[0].s.r;g<=re[0].e.r;++g)for(b=re[0].s.c;b<=re[0].e.c;++b)(v=r.dense?(n[g]||[])[b]:n[pt({c:b,r:g})])&&v.l&&(v.l.Tooltip=re[1]);break;case"Note":if(R.biff<=5&&R.biff>=2)break;v=r.dense?(n[re[0].r]||[])[re[0].c]:n[pt(re[0])];var be=P[re[2]];v||(r.dense?(n[re[0].r]||(n[re[0].r]=[]),v=n[re[0].r][re[0].c]={t:"z"}):v=n[pt(re[0])]={t:"z"},s.e.r=Math.max(s.e.r,re[0].r),s.s.r=Math.min(s.s.r,re[0].r),s.e.c=Math.max(s.e.c,re[0].c),s.s.c=Math.min(s.s.c,re[0].c)),v.c||(v.c=[]),p={a:re[1],t:be.TxO.t},v.c.push(p);break;default:switch(q.n){case"ClrtClient":break;case"XFExt":Bo(C[re.ixfe],re.ext);break;case"DefColWidth":M=re;break;case"DefaultRowHeight":U=re[1];break;case"ColInfo":if(!R.cellStyles)break;for(;re.e>=re.s;)N[re.e--]={width:re.w/256},H||(H=!0,pl(re.w/256)),ml(N[re.e+1]);break;case"Row":var ge={};null!=re.level&&(L[re.r]=ge,ge.level=re.level),re.hidden&&(L[re.r]=ge,ge.hidden=!0),re.hpt&&(L[re.r]=ge,ge.hpt=re.hpt,ge.hpx=kl(re.hpt));break;case"LeftMargin":case"RightMargin":case"TopMargin":case"BottomMargin":n["!margins"]||sh(n["!margins"]={}),n["!margins"][te.slice(0,-6).toLowerCase()]=re;break;case"Setup":n["!margins"]||sh(n["!margins"]={}),n["!margins"].header=re.header,n["!margins"].footer=re.footer;break;case"Window2":re.RTL&&(T.Views[0].RTL=!0);break;case"Header":case"Footer":case"HCenter":case"VCenter":case"Pls":case"GCW":case"LHRecord":case"DBCell":case"EntExU2":case"SxView":case"Sxvd":case"SXVI":case"SXVDEx":case"SxIvd":case"SXString":case"Sync":case"Addin":case"SXDI":case"SXLI":case"SXEx":case"QsiSXTag":case"Selection":case"Feat":break;case"FeatHdr":case"FeatHdr11":break;case"Feature11":case"Feature12":case"List12":break;case"Country":S=re;break;case"RecalcId":case"DxGCol":break;case"Fbi":case"Fbi2":case"GelFrame":case"Font":case"XFCRC":case"Style":case"StyleExt":break;case"Palette":B=re;break;case"Theme":D=re;break;case"ScenarioProtect":case"ObjProtect":case"CondFmt12":case"Table":case"TableStyles":case"TableStyle":case"TableStyleElement":case"SXStreamID":case"SXVS":case"DConRef":case"SXAddl":case"DConBin":case"DConName":case"SXPI":case"SxFormat":case"SxSelect":case"SxRule":case"SxFilt":case"SxItm":case"SxDXF":case"ScenMan":case"DCon":case"CellWatch":case"PrintRowCol":case"PrintGrid":case"PrintSize":case"XCT":case"CRN":case"Scl":case"SheetExt":case"SheetExtOptional":case"ObNoMacros":case"ObProj":break;case"CodeName":c?y.CodeName=re||y.name:T.WBProps.CodeName=re||"ThisWorkbook";break;case"GUIDTypeLib":case"WOpt":case"PhoneticInfo":case"OleObjectSize":break;case"DXF":case"DXFN":case"DXFN12":case"DXFN12List":case"DXFN12NoCB":break;case"Dv":case"DVal":break;case"BRAI":case"Series":case"SeriesText":case"DConn":case"DbOrParamQry":case"DBQueryExt":case"OleDbConn":case"ExtString":case"IFmtRecord":break;case"CondFmt":case"CF":case"CF12":case"CFEx":case"Excel9File":case"Units":break;case"InterfaceHdr":case"Mms":case"InterfaceEnd":case"DSF":case"BuiltInFnGroupCount":break;case"Window1":case"HideObj":case"GridSet":case"Guts":case"UserBView":case"UserSViewBegin":case"UserSViewEnd":case"Pane":break;default:switch(q.n){case"Dat":case"Begin":case"End":case"StartBlock":case"EndBlock":case"Frame":case"Area":case"Axis":case"AxisLine":case"Tick":break;case"AxesUsed":case"CrtLayout12":case"CrtLayout12A":case"CrtLink":case"CrtLine":case"CrtMlFrt":case"CrtMlFrtContinue":break;case"LineFormat":case"AreaFormat":case"Chart":case"Chart3d":case"Chart3DBarShape":case"ChartFormat":case"ChartFrtInfo":break;case"PlotArea":case"PlotGrowth":break;case"SeriesList":case"SerParent":case"SerAuxTrend":break;case"DataFormat":case"SerToCrt":case"FontX":break;case"CatSerRange":case"AxcExt":case"SerFmt":case"ShtProps":break;case"DefaultText":case"Text":case"CatLab":case"DataLabExtContents":break;case"Legend":case"LegendException":break;case"Pie":case"Scatter":break;case"PieFormat":case"MarkerFormat":break;case"StartObject":case"EndObject":break;case"AlRuns":case"ObjectLink":case"SIIndex":break;case"AttachedLabel":case"YMult":break;case"Line":case"Bar":case"Surf":case"AxisParent":case"Pos":case"ValueRange":case"SXViewEx9":case"SXViewLink":case"PivotChartBits":case"SBaseRef":case"TextPropsStream":case"LnExt":case"MkrExt":case"CrtCoopt":break;case"Qsi":case"Qsif":case"Qsir":case"QsiSXTag":case"TxtQry":case"FilterMode":break;case"AutoFilter":case"AutoFilterInfo":case"AutoFilter12":case"DropDownObjIds":case"Sort":case"SortData":case"ShapePropsStream":break;case"MsoDrawing":case"MsoDrawingGroup":case"MsoDrawingSelection":break;case"WebPub":case"AutoWebPub":break;case"HeaderFooter":case"HFPicture":case"PLV":case"HorizontalPageBreaks":case"VerticalPageBreaks":break;case"Backup":case"CompressPictures":case"Compat12":break;case"Continue":case"ContinueFrt12":break;case"FrtFontList":case"FrtWrapper":break;default:switch(q.n){case"TabIdConf":case"Radar":case"RadarArea":case"DropBar":case"Intl":case"CoordList":case"SerAuxErrBar":break;case"BIFF2FONTCLR":case"BIFF2FMTCNT":case"BIFF2FONTXTRA":break;case"BIFF2XF":case"BIFF3XF":case"BIFF4XF":break;case"BIFF4FMTCNT":case"BIFF2ROW":case"BIFF2WINDOW2":break;case"SCENARIO":case"DConBin":case"PicF":case"DataLabExt":case"Lel":case"BopPop":case"BopPopCustom":case"RealTimeData":case"Name":break;case"LHNGraph":case"FnGroupName":case"AddMenu":case"LPr":break;case"ListObj":case"ListField":case"RRSort":case"BigName":break;case"ToolbarHdr":case"ToolbarEnd":case"DDEObjName":case"FRTArchId$":break;default:if(r.WTF)throw"Unrecognized Record "+q.n}}}}}else e.l+=J}return t.SheetNames=K(i).sort((function(e,r){return Number(e)-Number(r)})).map((function(e){return i[e].name})),r.bookSheets||(t.Sheets=a),t.Sheets&&j.forEach((function(e,r){t.Sheets[t.SheetNames[r]]["!autofilter"]=e})),t.Preamble=u,t.Strings=o,t.SSF=F.get_table(),R.enc&&(t.Encryption=R.enc),D&&(t.Themes=D),t.Metadata={},void 0!==S&&(t.Metadata.Country=S),W.names.length>0&&(T.Names=W.names),t.Workbook=T,t}var Ep_SI="e0859ff2f94f6810ab9108002b27b3d9",Ep_DSI="02d5cdd59c2e1b10939708002b2cf9ae",Ep_UDI="05d5cdd59c2e1b10939708002b2cf9ae";function Sp(e,r,t){var a=z.find(e,"!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Un(a,ga,Ep_DSI);for(var i in n)r[i]=n[i]}catch(s){if(t.WTF)throw s}var f=z.find(e,"!SummaryInformation");if(f&&f.size>0)try{var l=Un(f,wa,Ep_SI);for(var o in l)null==r[o]&&(r[o]=l[o])}catch(s){if(t.WTF)throw s}r.HeadingPairs&&r.TitlesOfParts&&(nn(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function _p(e,r){var t=[],a=[],n=[],i=0,s;if(e.Props)for(s=K(e.Props),i=0;i<s.length;++i)(Ea.hasOwnProperty(s[i])?t:Sa.hasOwnProperty(s[i])?a:n).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=K(e.Custprops),i=0;i<s.length;++i)(e.Props||{}).hasOwnProperty(s[i])||(Ea.hasOwnProperty(s[i])?t:Sa.hasOwnProperty(s[i])?a:n).push([s[i],e.Custprops[s[i]]]);var f=[];for(i=0;i<n.length;++i)Nn.indexOf(n[i][0])>-1||null!=n[i][1]&&f.push(n[i]);a.length&&z.utils.cfb_add(r,"/SummaryInformation",Hn(a,Ep_SI,Sa,wa)),(t.length||f.length)&&z.utils.cfb_add(r,"/DocumentSummaryInformation",Hn(t,Ep_DSI,Ea,ga,f.length?f:null,Ep_UDI))}function Cp(e,r){var t,a,n,i;if(r||(r={}),mm(r),o(),r.codepage&&s(r.codepage),e.FullPaths){if(z.find(e,"/encryption"))throw new Error("File is password-protected");t=z.find(e,"!CompObj"),a=z.find(e,"/Workbook")||z.find(e,"/Book")}else{switch(r.type){case"base64":e=B(g.decode(e));break;case"binary":e=B(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Kr(e,0),a={content:e}}if(t&&mp(t),r.bookProps&&!r.bookSheets)n={};else{var f=w?"buffer":"array";if(a&&a.content)n=kp(a.content,r);else if((i=z.find(e,"PerfectOffice_MAIN"))&&i.content)n=df.to_workbook(i.content,(r.type=f,r));else{if(!(i=z.find(e,"NativeContent_MAIN"))||!i.content)throw new Error("Cannot find Workbook stream");n=df.to_workbook(i.content,(r.type=f,r))}r.bookVBA&&e.FullPaths&&z.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=Go(e))}var l={};return e.FullPaths&&Sp(e,l,r),n.Props=n.Custprops=l,r.bookFiles&&(n.cfb=e),n}function Bp(e,r){var t=r||{},a=z.utils.cfb_new({root:"R"}),n="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":n="/Workbook",t.biff=8;break;case"biff5":n="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return z.utils.cfb_add(a,n,jp(e,t)),8==t.biff&&(e.Props||e.Custprops)&&_p(e,a),8==t.biff&&e.vbaraw&&jo(a,z.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),a}var Tp={0:{n:"BrtRowHdr",f:zh},1:{n:"BrtCellBlank",f:Zh},2:{n:"BrtCellRk",f:id},3:{n:"BrtCellError",f:ed},4:{n:"BrtCellBool",f:Jh},5:{n:"BrtCellReal",f:ad},6:{n:"BrtCellSt",f:fd},7:{n:"BrtCellIsst",f:rd},8:{n:"BrtFmlaString",f:hd},9:{n:"BrtFmlaNum",f:ud},10:{n:"BrtFmlaBool",f:od},11:{n:"BrtFmlaError",f:cd},16:{n:"BrtFRTArchID$",f:gv},19:{n:"BrtSSTItem",f:At},20:{n:"BrtPCDIMissing"},21:{n:"BrtPCDINumber"},22:{n:"BrtPCDIBoolean"},23:{n:"BrtPCDIError"},24:{n:"BrtPCDIString"},25:{n:"BrtPCDIDatetime"},26:{n:"BrtPCDIIndex"},27:{n:"BrtPCDIAMissing"},28:{n:"BrtPCDIANumber"},29:{n:"BrtPCDIABoolean"},30:{n:"BrtPCDIAError"},31:{n:"BrtPCDIAString"},32:{n:"BrtPCDIADatetime"},33:{n:"BrtPCRRecord"},34:{n:"BrtPCRRecordDt"},35:{n:"BrtFRTBegin"},36:{n:"BrtFRTEnd"},37:{n:"BrtACBegin"},38:{n:"BrtACEnd"},39:{n:"BrtName",f:wv},40:{n:"BrtIndexRowBlock"},42:{n:"BrtIndexBlock"},43:{n:"BrtFont",f:Nl},44:{n:"BrtFmt",f:Ol},45:{n:"BrtFill",f:Hl},46:{n:"BrtBorder",f:Gl},47:{n:"BrtXF",f:zl},48:{n:"BrtStyle"},49:{n:"BrtCellMeta"},50:{n:"BrtValueMeta"},51:{n:"BrtMdb"},52:{n:"BrtBeginFmd"},53:{n:"BrtEndFmd"},54:{n:"BrtBeginMdx"},55:{n:"BrtEndMdx"},56:{n:"BrtBeginMdxTuple"},57:{n:"BrtEndMdxTuple"},58:{n:"BrtMdxMbrIstr"},59:{n:"BrtStr"},60:{n:"BrtColInfo",f:Xs},62:{n:"BrtCellRString"},63:{n:"BrtCalcChainItem$",f:yo},64:{n:"BrtDVal",f:Ad},65:{n:"BrtSxvcellNum"},66:{n:"BrtSxvcellStr"},67:{n:"BrtSxvcellBool"},68:{n:"BrtSxvcellErr"},69:{n:"BrtSxvcellDate"},70:{n:"BrtSxvcellNil"},128:{n:"BrtFileVersion"},129:{n:"BrtBeginSheet"},130:{n:"BrtEndSheet"},131:{n:"BrtBeginBook",f:Yr,p:0},132:{n:"BrtEndBook"},133:{n:"BrtBeginWsViews"},134:{n:"BrtEndWsViews"},135:{n:"BrtBeginBookViews"},136:{n:"BrtEndBookViews"},137:{n:"BrtBeginWsView",f:Bd},138:{n:"BrtEndWsView"},139:{n:"BrtBeginCsViews"},140:{n:"BrtEndCsViews"},141:{n:"BrtBeginCsView"},142:{n:"BrtEndCsView"},143:{n:"BrtBeginBundleShs"},144:{n:"BrtEndBundleShs"},145:{n:"BrtBeginSheetData"},146:{n:"BrtEndSheetData"},147:{n:"BrtWsProp",f:Yh},148:{n:"BrtWsDim",f:Gh,p:16},151:{n:"BrtPane",f:gd},152:{n:"BrtSel"},153:{n:"BrtWbProp",f:mv},154:{n:"BrtWbFactoid"},155:{n:"BrtFileRecover"},156:{n:"BrtBundleSh",f:vv},157:{n:"BrtCalcProp"},158:{n:"BrtBookView"},159:{n:"BrtBeginSst",f:yf},160:{n:"BrtEndSst"},161:{n:"BrtBeginAFilter",f:jt},162:{n:"BrtEndAFilter"},163:{n:"BrtBeginFilterColumn"},164:{n:"BrtEndFilterColumn"},165:{n:"BrtBeginFilters"},166:{n:"BrtEndFilters"},167:{n:"BrtFilter"},168:{n:"BrtColorFilter"},169:{n:"BrtIconFilter"},170:{n:"BrtTop10Filter"},171:{n:"BrtDynamicFilter"},172:{n:"BrtBeginCustomFilters"},173:{n:"BrtEndCustomFilters"},174:{n:"BrtCustomFilter"},175:{n:"BrtAFilterDateGroupItem"},176:{n:"BrtMergeCell",f:dd},177:{n:"BrtBeginMergeCells"},178:{n:"BrtEndMergeCells"},179:{n:"BrtBeginPivotCacheDef"},180:{n:"BrtEndPivotCacheDef"},181:{n:"BrtBeginPCDFields"},182:{n:"BrtEndPCDFields"},183:{n:"BrtBeginPCDField"},184:{n:"BrtEndPCDField"},185:{n:"BrtBeginPCDSource"},186:{n:"BrtEndPCDSource"},187:{n:"BrtBeginPCDSRange"},188:{n:"BrtEndPCDSRange"},189:{n:"BrtBeginPCDFAtbl"},190:{n:"BrtEndPCDFAtbl"},191:{n:"BrtBeginPCDIRun"},192:{n:"BrtEndPCDIRun"},193:{n:"BrtBeginPivotCacheRecords"},194:{n:"BrtEndPivotCacheRecords"},195:{n:"BrtBeginPCDHierarchies"},196:{n:"BrtEndPCDHierarchies"},197:{n:"BrtBeginPCDHierarchy"},198:{n:"BrtEndPCDHierarchy"},199:{n:"BrtBeginPCDHFieldsUsage"},200:{n:"BrtEndPCDHFieldsUsage"},201:{n:"BrtBeginExtConnection"},202:{n:"BrtEndExtConnection"},203:{n:"BrtBeginECDbProps"},204:{n:"BrtEndECDbProps"},205:{n:"BrtBeginECOlapProps"},206:{n:"BrtEndECOlapProps"},207:{n:"BrtBeginPCDSConsol"},208:{n:"BrtEndPCDSConsol"},209:{n:"BrtBeginPCDSCPages"},210:{n:"BrtEndPCDSCPages"},211:{n:"BrtBeginPCDSCPage"},212:{n:"BrtEndPCDSCPage"},213:{n:"BrtBeginPCDSCPItem"},214:{n:"BrtEndPCDSCPItem"},215:{n:"BrtBeginPCDSCSets"},216:{n:"BrtEndPCDSCSets"},217:{n:"BrtBeginPCDSCSet"},218:{n:"BrtEndPCDSCSet"},219:{n:"BrtBeginPCDFGroup"},220:{n:"BrtEndPCDFGroup"},221:{n:"BrtBeginPCDFGItems"},222:{n:"BrtEndPCDFGItems"},223:{n:"BrtBeginPCDFGRange"},224:{n:"BrtEndPCDFGRange"},225:{n:"BrtBeginPCDFGDiscrete"},226:{n:"BrtEndPCDFGDiscrete"},227:{n:"BrtBeginPCDSDTupleCache"},228:{n:"BrtEndPCDSDTupleCache"},229:{n:"BrtBeginPCDSDTCEntries"},230:{n:"BrtEndPCDSDTCEntries"},231:{n:"BrtBeginPCDSDTCEMembers"},232:{n:"BrtEndPCDSDTCEMembers"},233:{n:"BrtBeginPCDSDTCEMember"},234:{n:"BrtEndPCDSDTCEMember"},235:{n:"BrtBeginPCDSDTCQueries"},236:{n:"BrtEndPCDSDTCQueries"},237:{n:"BrtBeginPCDSDTCQuery"},238:{n:"BrtEndPCDSDTCQuery"},239:{n:"BrtBeginPCDSDTCSets"},240:{n:"BrtEndPCDSDTCSets"},241:{n:"BrtBeginPCDSDTCSet"},242:{n:"BrtEndPCDSDTCSet"},243:{n:"BrtBeginPCDCalcItems"},244:{n:"BrtEndPCDCalcItems"},245:{n:"BrtBeginPCDCalcItem"},246:{n:"BrtEndPCDCalcItem"},247:{n:"BrtBeginPRule"},248:{n:"BrtEndPRule"},249:{n:"BrtBeginPRFilters"},250:{n:"BrtEndPRFilters"},251:{n:"BrtBeginPRFilter"},252:{n:"BrtEndPRFilter"},253:{n:"BrtBeginPNames"},254:{n:"BrtEndPNames"},255:{n:"BrtBeginPName"},256:{n:"BrtEndPName"},257:{n:"BrtBeginPNPairs"},258:{n:"BrtEndPNPairs"},259:{n:"BrtBeginPNPair"},260:{n:"BrtEndPNPair"},261:{n:"BrtBeginECWebProps"},262:{n:"BrtEndECWebProps"},263:{n:"BrtBeginEcWpTables"},264:{n:"BrtEndECWPTables"},265:{n:"BrtBeginECParams"},266:{n:"BrtEndECParams"},267:{n:"BrtBeginECParam"},268:{n:"BrtEndECParam"},269:{n:"BrtBeginPCDKPIs"},270:{n:"BrtEndPCDKPIs"},271:{n:"BrtBeginPCDKPI"},272:{n:"BrtEndPCDKPI"},273:{n:"BrtBeginDims"},274:{n:"BrtEndDims"},275:{n:"BrtBeginDim"},276:{n:"BrtEndDim"},277:{n:"BrtIndexPartEnd"},278:{n:"BrtBeginStyleSheet"},279:{n:"BrtEndStyleSheet"},280:{n:"BrtBeginSXView"},281:{n:"BrtEndSXVI"},282:{n:"BrtBeginSXVI"},283:{n:"BrtBeginSXVIs"},284:{n:"BrtEndSXVIs"},285:{n:"BrtBeginSXVD"},286:{n:"BrtEndSXVD"},287:{n:"BrtBeginSXVDs"},288:{n:"BrtEndSXVDs"},289:{n:"BrtBeginSXPI"},290:{n:"BrtEndSXPI"},291:{n:"BrtBeginSXPIs"},292:{n:"BrtEndSXPIs"},293:{n:"BrtBeginSXDI"},294:{n:"BrtEndSXDI"},295:{n:"BrtBeginSXDIs"},296:{n:"BrtEndSXDIs"},297:{n:"BrtBeginSXLI"},298:{n:"BrtEndSXLI"},299:{n:"BrtBeginSXLIRws"},300:{n:"BrtEndSXLIRws"},301:{n:"BrtBeginSXLICols"},302:{n:"BrtEndSXLICols"},303:{n:"BrtBeginSXFormat"},304:{n:"BrtEndSXFormat"},305:{n:"BrtBeginSXFormats"},306:{n:"BrtEndSxFormats"},307:{n:"BrtBeginSxSelect"},308:{n:"BrtEndSxSelect"},309:{n:"BrtBeginISXVDRws"},310:{n:"BrtEndISXVDRws"},311:{n:"BrtBeginISXVDCols"},312:{n:"BrtEndISXVDCols"},313:{n:"BrtEndSXLocation"},314:{n:"BrtBeginSXLocation"},315:{n:"BrtEndSXView"},316:{n:"BrtBeginSXTHs"},317:{n:"BrtEndSXTHs"},318:{n:"BrtBeginSXTH"},319:{n:"BrtEndSXTH"},320:{n:"BrtBeginISXTHRws"},321:{n:"BrtEndISXTHRws"},322:{n:"BrtBeginISXTHCols"},323:{n:"BrtEndISXTHCols"},324:{n:"BrtBeginSXTDMPS"},325:{n:"BrtEndSXTDMPs"},326:{n:"BrtBeginSXTDMP"},327:{n:"BrtEndSXTDMP"},328:{n:"BrtBeginSXTHItems"},329:{n:"BrtEndSXTHItems"},330:{n:"BrtBeginSXTHItem"},331:{n:"BrtEndSXTHItem"},332:{n:"BrtBeginMetadata"},333:{n:"BrtEndMetadata"},334:{n:"BrtBeginEsmdtinfo"},335:{n:"BrtMdtinfo"},336:{n:"BrtEndEsmdtinfo"},337:{n:"BrtBeginEsmdb"},338:{n:"BrtEndEsmdb"},339:{n:"BrtBeginEsfmd"},340:{n:"BrtEndEsfmd"},341:{n:"BrtBeginSingleCells"},342:{n:"BrtEndSingleCells"},343:{n:"BrtBeginList"},344:{n:"BrtEndList"},345:{n:"BrtBeginListCols"},346:{n:"BrtEndListCols"},347:{n:"BrtBeginListCol"},348:{n:"BrtEndListCol"},349:{n:"BrtBeginListXmlCPr"},350:{n:"BrtEndListXmlCPr"},351:{n:"BrtListCCFmla"},352:{n:"BrtListTrFmla"},353:{n:"BrtBeginExternals"},354:{n:"BrtEndExternals"},355:{n:"BrtSupBookSrc",f:Ht},357:{n:"BrtSupSelf"},358:{n:"BrtSupSame"},359:{n:"BrtSupTabs"},360:{n:"BrtBeginSupBook"},361:{n:"BrtPlaceholderName"},362:{n:"BrtExternSheet",f:Es},363:{n:"BrtExternTableStart"},364:{n:"BrtExternTableEnd"},366:{n:"BrtExternRowHdr"},367:{n:"BrtExternCellBlank"},368:{n:"BrtExternCellReal"},369:{n:"BrtExternCellBool"},370:{n:"BrtExternCellError"},371:{n:"BrtExternCellString"},372:{n:"BrtBeginEsmdx"},373:{n:"BrtEndEsmdx"},374:{n:"BrtBeginMdxSet"},375:{n:"BrtEndMdxSet"},376:{n:"BrtBeginMdxMbrProp"},377:{n:"BrtEndMdxMbrProp"},378:{n:"BrtBeginMdxKPI"},379:{n:"BrtEndMdxKPI"},380:{n:"BrtBeginEsstr"},381:{n:"BrtEndEsstr"},382:{n:"BrtBeginPRFItem"},383:{n:"BrtEndPRFItem"},384:{n:"BrtBeginPivotCacheIDs"},385:{n:"BrtEndPivotCacheIDs"},386:{n:"BrtBeginPivotCacheID"},387:{n:"BrtEndPivotCacheID"},388:{n:"BrtBeginISXVIs"},389:{n:"BrtEndISXVIs"},390:{n:"BrtBeginColInfos"},391:{n:"BrtEndColInfos"},392:{n:"BrtBeginRwBrk"},393:{n:"BrtEndRwBrk"},394:{n:"BrtBeginColBrk"},395:{n:"BrtEndColBrk"},396:{n:"BrtBrk"},397:{n:"BrtUserBookView"},398:{n:"BrtInfo"},399:{n:"BrtCUsr"},400:{n:"BrtUsr"},401:{n:"BrtBeginUsers"},403:{n:"BrtEOF"},404:{n:"BrtUCR"},405:{n:"BrtRRInsDel"},406:{n:"BrtRREndInsDel"},407:{n:"BrtRRMove"},408:{n:"BrtRREndMove"},409:{n:"BrtRRChgCell"},410:{n:"BrtRREndChgCell"},411:{n:"BrtRRHeader"},412:{n:"BrtRRUserView"},413:{n:"BrtRRRenSheet"},414:{n:"BrtRRInsertSh"},415:{n:"BrtRRDefName"},416:{n:"BrtRRNote"},417:{n:"BrtRRConflict"},418:{n:"BrtRRTQSIF"},419:{n:"BrtRRFormat"},420:{n:"BrtRREndFormat"},421:{n:"BrtRRAutoFmt"},422:{n:"BrtBeginUserShViews"},423:{n:"BrtBeginUserShView"},424:{n:"BrtEndUserShView"},425:{n:"BrtEndUserShViews"},426:{n:"BrtArrFmla",f:wd},427:{n:"BrtShrFmla",f:kd},428:{n:"BrtTable"},429:{n:"BrtBeginExtConnections"},430:{n:"BrtEndExtConnections"},431:{n:"BrtBeginPCDCalcMems"},432:{n:"BrtEndPCDCalcMems"},433:{n:"BrtBeginPCDCalcMem"},434:{n:"BrtEndPCDCalcMem"},435:{n:"BrtBeginPCDHGLevels"},436:{n:"BrtEndPCDHGLevels"},437:{n:"BrtBeginPCDHGLevel"},438:{n:"BrtEndPCDHGLevel"},439:{n:"BrtBeginPCDHGLGroups"},440:{n:"BrtEndPCDHGLGroups"},441:{n:"BrtBeginPCDHGLGroup"},442:{n:"BrtEndPCDHGLGroup"},443:{n:"BrtBeginPCDHGLGMembers"},444:{n:"BrtEndPCDHGLGMembers"},445:{n:"BrtBeginPCDHGLGMember"},446:{n:"BrtEndPCDHGLGMember"},447:{n:"BrtBeginQSI"},448:{n:"BrtEndQSI"},449:{n:"BrtBeginQSIR"},450:{n:"BrtEndQSIR"},451:{n:"BrtBeginDeletedNames"},452:{n:"BrtEndDeletedNames"},453:{n:"BrtBeginDeletedName"},454:{n:"BrtEndDeletedName"},455:{n:"BrtBeginQSIFs"},456:{n:"BrtEndQSIFs"},457:{n:"BrtBeginQSIF"},458:{n:"BrtEndQSIF"},459:{n:"BrtBeginAutoSortScope"},460:{n:"BrtEndAutoSortScope"},461:{n:"BrtBeginConditionalFormatting"},462:{n:"BrtEndConditionalFormatting"},463:{n:"BrtBeginCFRule"},464:{n:"BrtEndCFRule"},465:{n:"BrtBeginIconSet"},466:{n:"BrtEndIconSet"},467:{n:"BrtBeginDatabar"},468:{n:"BrtEndDatabar"},469:{n:"BrtBeginColorScale"},470:{n:"BrtEndColorScale"},471:{n:"BrtCFVO"},472:{n:"BrtExternValueMeta"},473:{n:"BrtBeginColorPalette"},474:{n:"BrtEndColorPalette"},475:{n:"BrtIndexedColor"},476:{n:"BrtMargins",f:_d},477:{n:"BrtPrintOptions"},478:{n:"BrtPageSetup"},479:{n:"BrtBeginHeaderFooter"},480:{n:"BrtEndHeaderFooter"},481:{n:"BrtBeginSXCrtFormat"},482:{n:"BrtEndSXCrtFormat"},483:{n:"BrtBeginSXCrtFormats"},484:{n:"BrtEndSXCrtFormats"},485:{n:"BrtWsFmtInfo",f:Kh},486:{n:"BrtBeginMgs"},487:{n:"BrtEndMGs"},488:{n:"BrtBeginMGMaps"},489:{n:"BrtEndMGMaps"},490:{n:"BrtBeginMG"},491:{n:"BrtEndMG"},492:{n:"BrtBeginMap"},493:{n:"BrtEndMap"},494:{n:"BrtHLink",f:md},495:{n:"BrtBeginDCon"},496:{n:"BrtEndDCon"},497:{n:"BrtBeginDRefs"},498:{n:"BrtEndDRefs"},499:{n:"BrtDRef"},500:{n:"BrtBeginScenMan"},501:{n:"BrtEndScenMan"},502:{n:"BrtBeginSct"},503:{n:"BrtEndSct"},504:{n:"BrtSlc"},505:{n:"BrtBeginDXFs"},506:{n:"BrtEndDXFs"},507:{n:"BrtDXF"},508:{n:"BrtBeginTableStyles"},509:{n:"BrtEndTableStyles"},510:{n:"BrtBeginTableStyle"},511:{n:"BrtEndTableStyle"},512:{n:"BrtTableStyleElement"},513:{n:"BrtTableStyleClient"},514:{n:"BrtBeginVolDeps"},515:{n:"BrtEndVolDeps"},516:{n:"BrtBeginVolType"},517:{n:"BrtEndVolType"},518:{n:"BrtBeginVolMain"},519:{n:"BrtEndVolMain"},520:{n:"BrtBeginVolTopic"},521:{n:"BrtEndVolTopic"},522:{n:"BrtVolSubtopic"},523:{n:"BrtVolRef"},524:{n:"BrtVolNum"},525:{n:"BrtVolErr"},526:{n:"BrtVolStr"},527:{n:"BrtVolBool"},528:{n:"BrtBeginCalcChain$"},529:{n:"BrtEndCalcChain$"},530:{n:"BrtBeginSortState"},531:{n:"BrtEndSortState"},532:{n:"BrtBeginSortCond"},533:{n:"BrtEndSortCond"},534:{n:"BrtBookProtection"},535:{n:"BrtSheetProtection"},536:{n:"BrtRangeProtection"},537:{n:"BrtPhoneticInfo"},538:{n:"BrtBeginECTxtWiz"},539:{n:"BrtEndECTxtWiz"},540:{n:"BrtBeginECTWFldInfoLst"},541:{n:"BrtEndECTWFldInfoLst"},542:{n:"BrtBeginECTwFldInfo"},548:{n:"BrtFileSharing"},549:{n:"BrtOleSize"},550:{n:"BrtDrawing",f:Ht},551:{n:"BrtLegacyDrawing"},552:{n:"BrtLegacyDrawingHF"},553:{n:"BrtWebOpt"},554:{n:"BrtBeginWebPubItems"},555:{n:"BrtEndWebPubItems"},556:{n:"BrtBeginWebPubItem"},557:{n:"BrtEndWebPubItem"},558:{n:"BrtBeginSXCondFmt"},559:{n:"BrtEndSXCondFmt"},560:{n:"BrtBeginSXCondFmts"},561:{n:"BrtEndSXCondFmts"},562:{n:"BrtBkHim"},564:{n:"BrtColor"},565:{n:"BrtBeginIndexedColors"},566:{n:"BrtEndIndexedColors"},569:{n:"BrtBeginMRUColors"},570:{n:"BrtEndMRUColors"},572:{n:"BrtMRUColor"},573:{n:"BrtBeginDVals"},574:{n:"BrtEndDVals"},577:{n:"BrtSupNameStart"},578:{n:"BrtSupNameValueStart"},579:{n:"BrtSupNameValueEnd"},580:{n:"BrtSupNameNum"},581:{n:"BrtSupNameErr"},582:{n:"BrtSupNameSt"},583:{n:"BrtSupNameNil"},584:{n:"BrtSupNameBool"},585:{n:"BrtSupNameFmla"},586:{n:"BrtSupNameBits"},587:{n:"BrtSupNameEnd"},588:{n:"BrtEndSupBook"},589:{n:"BrtCellSmartTagProperty"},590:{n:"BrtBeginCellSmartTag"},591:{n:"BrtEndCellSmartTag"},592:{n:"BrtBeginCellSmartTags"},593:{n:"BrtEndCellSmartTags"},594:{n:"BrtBeginSmartTags"},595:{n:"BrtEndSmartTags"},596:{n:"BrtSmartTagType"},597:{n:"BrtBeginSmartTagTypes"},598:{n:"BrtEndSmartTagTypes"},599:{n:"BrtBeginSXFilters"},600:{n:"BrtEndSXFilters"},601:{n:"BrtBeginSXFILTER"},602:{n:"BrtEndSXFilter"},603:{n:"BrtBeginFills"},604:{n:"BrtEndFills"},605:{n:"BrtBeginCellWatches"},606:{n:"BrtEndCellWatches"},607:{n:"BrtCellWatch"},608:{n:"BrtBeginCRErrs"},609:{n:"BrtEndCRErrs"},610:{n:"BrtCrashRecErr"},611:{n:"BrtBeginFonts"},612:{n:"BrtEndFonts"},613:{n:"BrtBeginBorders"},614:{n:"BrtEndBorders"},615:{n:"BrtBeginFmts"},616:{n:"BrtEndFmts"},617:{n:"BrtBeginCellXFs"},618:{n:"BrtEndCellXFs"},619:{n:"BrtBeginStyles"},620:{n:"BrtEndStyles"},625:{n:"BrtBigName"},626:{n:"BrtBeginCellStyleXFs"},627:{n:"BrtEndCellStyleXFs"},628:{n:"BrtBeginComments"},629:{n:"BrtEndComments"},630:{n:"BrtBeginCommentAuthors"},631:{n:"BrtEndCommentAuthors"},632:{n:"BrtCommentAuthor",f:Ho},633:{n:"BrtBeginCommentList"},634:{n:"BrtEndCommentList"},635:{n:"BrtBeginComment",f:Mo},636:{n:"BrtEndComment"},637:{n:"BrtCommentText",f:Rt},638:{n:"BrtBeginOleObjects"},639:{n:"BrtOleObject"},640:{n:"BrtEndOleObjects"},641:{n:"BrtBeginSxrules"},642:{n:"BrtEndSxRules"},643:{n:"BrtBeginActiveXControls"},644:{n:"BrtActiveX"},645:{n:"BrtEndActiveXControls"},646:{n:"BrtBeginPCDSDTCEMembersSortBy"},648:{n:"BrtBeginCellIgnoreECs"},649:{n:"BrtCellIgnoreEC"},650:{n:"BrtEndCellIgnoreECs"},651:{n:"BrtCsProp",f:$d},652:{n:"BrtCsPageSetup"},653:{n:"BrtBeginUserCsViews"},654:{n:"BrtEndUserCsViews"},655:{n:"BrtBeginUserCsView"},656:{n:"BrtEndUserCsView"},657:{n:"BrtBeginPcdSFCIEntries"},658:{n:"BrtEndPCDSFCIEntries"},659:{n:"BrtPCDSFCIEntry"},660:{n:"BrtBeginListParts"},661:{n:"BrtListPart"},662:{n:"BrtEndListParts"},663:{n:"BrtSheetCalcProp"},664:{n:"BrtBeginFnGroup"},665:{n:"BrtFnGroup"},666:{n:"BrtEndFnGroup"},667:{n:"BrtSupAddin"},668:{n:"BrtSXTDMPOrder"},669:{n:"BrtCsProtection"},671:{n:"BrtBeginWsSortMap"},672:{n:"BrtEndWsSortMap"},673:{n:"BrtBeginRRSort"},674:{n:"BrtEndRRSort"},675:{n:"BrtRRSortItem"},676:{n:"BrtFileSharingIso"},677:{n:"BrtBookProtectionIso"},678:{n:"BrtSheetProtectionIso"},679:{n:"BrtCsProtectionIso"},680:{n:"BrtRangeProtectionIso"},681:{n:"BrtDValList"},1024:{n:"BrtRwDescent"},1025:{n:"BrtKnownFonts"},1026:{n:"BrtBeginSXTupleSet"},1027:{n:"BrtEndSXTupleSet"},1028:{n:"BrtBeginSXTupleSetHeader"},1029:{n:"BrtEndSXTupleSetHeader"},1030:{n:"BrtSXTupleSetHeaderItem"},1031:{n:"BrtBeginSXTupleSetData"},1032:{n:"BrtEndSXTupleSetData"},1033:{n:"BrtBeginSXTupleSetRow"},1034:{n:"BrtEndSXTupleSetRow"},1035:{n:"BrtSXTupleSetRowItem"},1036:{n:"BrtNameExt"},1037:{n:"BrtPCDH14"},1038:{n:"BrtBeginPCDCalcMem14"},1039:{n:"BrtEndPCDCalcMem14"},1040:{n:"BrtSXTH14"},1041:{n:"BrtBeginSparklineGroup"},1042:{n:"BrtEndSparklineGroup"},1043:{n:"BrtSparkline"},1044:{n:"BrtSXDI14"},1045:{n:"BrtWsFmtInfoEx14"},1046:{n:"BrtBeginConditionalFormatting14"},1047:{n:"BrtEndConditionalFormatting14"},1048:{n:"BrtBeginCFRule14"},1049:{n:"BrtEndCFRule14"},1050:{n:"BrtCFVO14"},1051:{n:"BrtBeginDatabar14"},1052:{n:"BrtBeginIconSet14"},1053:{n:"BrtDVal14",f:Id},1054:{n:"BrtBeginDVals14"},1055:{n:"BrtColor14"},1056:{n:"BrtBeginSparklines"},1057:{n:"BrtEndSparklines"},1058:{n:"BrtBeginSparklineGroups"},1059:{n:"BrtEndSparklineGroups"},1061:{n:"BrtSXVD14"},1062:{n:"BrtBeginSXView14"},1063:{n:"BrtEndSXView14"},1064:{n:"BrtBeginSXView16"},1065:{n:"BrtEndSXView16"},1066:{n:"BrtBeginPCD14"},1067:{n:"BrtEndPCD14"},1068:{n:"BrtBeginExtConn14"},1069:{n:"BrtEndExtConn14"},1070:{n:"BrtBeginSlicerCacheIDs"},1071:{n:"BrtEndSlicerCacheIDs"},1072:{n:"BrtBeginSlicerCacheID"},1073:{n:"BrtEndSlicerCacheID"},1075:{n:"BrtBeginSlicerCache"},1076:{n:"BrtEndSlicerCache"},1077:{n:"BrtBeginSlicerCacheDef"},1078:{n:"BrtEndSlicerCacheDef"},1079:{n:"BrtBeginSlicersEx"},1080:{n:"BrtEndSlicersEx"},1081:{n:"BrtBeginSlicerEx"},1082:{n:"BrtEndSlicerEx"},1083:{n:"BrtBeginSlicer"},1084:{n:"BrtEndSlicer"},1085:{n:"BrtSlicerCachePivotTables"},1086:{n:"BrtBeginSlicerCacheOlapImpl"},1087:{n:"BrtEndSlicerCacheOlapImpl"},1088:{n:"BrtBeginSlicerCacheLevelsData"},1089:{n:"BrtEndSlicerCacheLevelsData"},1090:{n:"BrtBeginSlicerCacheLevelData"},1091:{n:"BrtEndSlicerCacheLevelData"},1092:{n:"BrtBeginSlicerCacheSiRanges"},1093:{n:"BrtEndSlicerCacheSiRanges"},1094:{n:"BrtBeginSlicerCacheSiRange"},1095:{n:"BrtEndSlicerCacheSiRange"},1096:{n:"BrtSlicerCacheOlapItem"},1097:{n:"BrtBeginSlicerCacheSelections"},1098:{n:"BrtSlicerCacheSelection"},1099:{n:"BrtEndSlicerCacheSelections"},1100:{n:"BrtBeginSlicerCacheNative"},1101:{n:"BrtEndSlicerCacheNative"},1102:{n:"BrtSlicerCacheNativeItem"},1103:{n:"BrtRangeProtection14"},1104:{n:"BrtRangeProtectionIso14"},1105:{n:"BrtCellIgnoreEC14"},1111:{n:"BrtList14"},1112:{n:"BrtCFIcon"},1113:{n:"BrtBeginSlicerCachesPivotCacheIDs"},1114:{n:"BrtEndSlicerCachesPivotCacheIDs"},1115:{n:"BrtBeginSlicers"},1116:{n:"BrtEndSlicers"},1117:{n:"BrtWbProp14"},1118:{n:"BrtBeginSXEdit"},1119:{n:"BrtEndSXEdit"},1120:{n:"BrtBeginSXEdits"},1121:{n:"BrtEndSXEdits"},1122:{n:"BrtBeginSXChange"},1123:{n:"BrtEndSXChange"},1124:{n:"BrtBeginSXChanges"},1125:{n:"BrtEndSXChanges"},1126:{n:"BrtSXTupleItems"},1128:{n:"BrtBeginSlicerStyle"},1129:{n:"BrtEndSlicerStyle"},1130:{n:"BrtSlicerStyleElement"},1131:{n:"BrtBeginStyleSheetExt14"},1132:{n:"BrtEndStyleSheetExt14"},1133:{n:"BrtBeginSlicerCachesPivotCacheID"},1134:{n:"BrtEndSlicerCachesPivotCacheID"},1135:{n:"BrtBeginConditionalFormattings"},1136:{n:"BrtEndConditionalFormattings"},1137:{n:"BrtBeginPCDCalcMemExt"},1138:{n:"BrtEndPCDCalcMemExt"},1139:{n:"BrtBeginPCDCalcMemsExt"},1140:{n:"BrtEndPCDCalcMemsExt"},1141:{n:"BrtPCDField14"},1142:{n:"BrtBeginSlicerStyles"},1143:{n:"BrtEndSlicerStyles"},1144:{n:"BrtBeginSlicerStyleElements"},1145:{n:"BrtEndSlicerStyleElements"},1146:{n:"BrtCFRuleExt"},1147:{n:"BrtBeginSXCondFmt14"},1148:{n:"BrtEndSXCondFmt14"},1149:{n:"BrtBeginSXCondFmts14"},1150:{n:"BrtEndSXCondFmts14"},1152:{n:"BrtBeginSortCond14"},1153:{n:"BrtEndSortCond14"},1154:{n:"BrtEndDVals14"},1155:{n:"BrtEndIconSet14"},1156:{n:"BrtEndDatabar14"},1157:{n:"BrtBeginColorScale14"},1158:{n:"BrtEndColorScale14"},1159:{n:"BrtBeginSxrules14"},1160:{n:"BrtEndSxrules14"},1161:{n:"BrtBeginPRule14"},1162:{n:"BrtEndPRule14"},1163:{n:"BrtBeginPRFilters14"},1164:{n:"BrtEndPRFilters14"},1165:{n:"BrtBeginPRFilter14"},1166:{n:"BrtEndPRFilter14"},1167:{n:"BrtBeginPRFItem14"},1168:{n:"BrtEndPRFItem14"},1169:{n:"BrtBeginCellIgnoreECs14"},1170:{n:"BrtEndCellIgnoreECs14"},1171:{n:"BrtDxf14"},1172:{n:"BrtBeginDxF14s"},1173:{n:"BrtEndDxf14s"},1177:{n:"BrtFilter14"},1178:{n:"BrtBeginCustomFilters14"},1180:{n:"BrtCustomFilter14"},1181:{n:"BrtIconFilter14"},1182:{n:"BrtPivotCacheConnectionName"},2048:{n:"BrtBeginDecoupledPivotCacheIDs"},2049:{n:"BrtEndDecoupledPivotCacheIDs"},2050:{n:"BrtDecoupledPivotCacheID"},2051:{n:"BrtBeginPivotTableRefs"},2052:{n:"BrtEndPivotTableRefs"},2053:{n:"BrtPivotTableRef"},2054:{n:"BrtSlicerCacheBookPivotTables"},2055:{n:"BrtBeginSxvcells"},2056:{n:"BrtEndSxvcells"},2057:{n:"BrtBeginSxRow"},2058:{n:"BrtEndSxRow"},2060:{n:"BrtPcdCalcMem15"},2067:{n:"BrtQsi15"},2068:{n:"BrtBeginWebExtensions"},2069:{n:"BrtEndWebExtensions"},2070:{n:"BrtWebExtension"},2071:{n:"BrtAbsPath15"},2072:{n:"BrtBeginPivotTableUISettings"},2073:{n:"BrtEndPivotTableUISettings"},2075:{n:"BrtTableSlicerCacheIDs"},2076:{n:"BrtTableSlicerCacheID"},2077:{n:"BrtBeginTableSlicerCache"},2078:{n:"BrtEndTableSlicerCache"},2079:{n:"BrtSxFilter15"},2080:{n:"BrtBeginTimelineCachePivotCacheIDs"},2081:{n:"BrtEndTimelineCachePivotCacheIDs"},2082:{n:"BrtTimelineCachePivotCacheID"},2083:{n:"BrtBeginTimelineCacheIDs"},2084:{n:"BrtEndTimelineCacheIDs"},2085:{n:"BrtBeginTimelineCacheID"},2086:{n:"BrtEndTimelineCacheID"},2087:{n:"BrtBeginTimelinesEx"},2088:{n:"BrtEndTimelinesEx"},2089:{n:"BrtBeginTimelineEx"},2090:{n:"BrtEndTimelineEx"},2091:{n:"BrtWorkBookPr15"},2092:{n:"BrtPCDH15"},2093:{n:"BrtBeginTimelineStyle"},2094:{n:"BrtEndTimelineStyle"},2095:{n:"BrtTimelineStyleElement"},2096:{n:"BrtBeginTimelineStylesheetExt15"},2097:{n:"BrtEndTimelineStylesheetExt15"},2098:{n:"BrtBeginTimelineStyles"},2099:{n:"BrtEndTimelineStyles"},2100:{n:"BrtBeginTimelineStyleElements"},2101:{n:"BrtEndTimelineStyleElements"},2102:{n:"BrtDxf15"},2103:{n:"BrtBeginDxfs15"},2104:{n:"brtEndDxfs15"},2105:{n:"BrtSlicerCacheHideItemsWithNoData"},2106:{n:"BrtBeginItemUniqueNames"},2107:{n:"BrtEndItemUniqueNames"},2108:{n:"BrtItemUniqueName"},2109:{n:"BrtBeginExtConn15"},2110:{n:"BrtEndExtConn15"},2111:{n:"BrtBeginOledbPr15"},2112:{n:"BrtEndOledbPr15"},2113:{n:"BrtBeginDataFeedPr15"},2114:{n:"BrtEndDataFeedPr15"},2115:{n:"BrtTextPr15"},2116:{n:"BrtRangePr15"},2117:{n:"BrtDbCommand15"},2118:{n:"BrtBeginDbTables15"},2119:{n:"BrtEndDbTables15"},2120:{n:"BrtDbTable15"},2121:{n:"BrtBeginDataModel"},2122:{n:"BrtEndDataModel"},2123:{n:"BrtBeginModelTables"},2124:{n:"BrtEndModelTables"},2125:{n:"BrtModelTable"},2126:{n:"BrtBeginModelRelationships"},2127:{n:"BrtEndModelRelationships"},2128:{n:"BrtModelRelationship"},2129:{n:"BrtBeginECTxtWiz15"},2130:{n:"BrtEndECTxtWiz15"},2131:{n:"BrtBeginECTWFldInfoLst15"},2132:{n:"BrtEndECTWFldInfoLst15"},2133:{n:"BrtBeginECTWFldInfo15"},2134:{n:"BrtFieldListActiveItem"},2135:{n:"BrtPivotCacheIdVersion"},2136:{n:"BrtSXDI15"},2137:{n:"BrtBeginModelTimeGroupings"},2138:{n:"BrtEndModelTimeGroupings"},2139:{n:"BrtBeginModelTimeGrouping"},2140:{n:"BrtEndModelTimeGrouping"},2141:{n:"BrtModelTimeGroupingCalcCol"},3072:{n:"BrtUid"},3073:{n:"BrtRevisionPtr"},5095:{n:"BrtBeginCalcFeatures"},5096:{n:"BrtEndCalcFeatures"},5097:{n:"BrtCalcFeature"},65535:{n:""}},yp=Y(Tp,"n"),xp={3:{n:"BIFF2NUM",f:qs},4:{n:"BIFF2STR",f:Js},6:{n:"Formula",f:Hu},9:{n:"BOF",f:Ai},10:{n:"EOF",f:Wn},12:{n:"CalcCount",f:jn},13:{n:"CalcMode",f:jn},14:{n:"CalcPrecision",f:Xn},15:{n:"CalcRefMode",f:Xn},16:{n:"CalcDelta",f:Yt},17:{n:"CalcIter",f:Xn},18:{n:"Protect",f:Xn},19:{n:"Password",f:jn},20:{n:"Header",f:ms},21:{n:"Footer",f:ms},23:{n:"ExternSheet",f:Es},24:{n:"Lbl",f:ks},25:{n:"WinProtect",f:Xn},26:{n:"VerticalPageBreaks"},27:{n:"HorizontalPageBreaks"},28:{n:"Note",f:xs},29:{n:"Selection"},34:{n:"Date1904",f:Xn},35:{n:"ExternName",f:gs},36:{n:"COLWIDTH"},38:{n:"LeftMargin",f:Yt},39:{n:"RightMargin",f:Yt},40:{n:"TopMargin",f:Yt},41:{n:"BottomMargin",f:Yt},42:{n:"PrintRowCol",f:Xn},43:{n:"PrintGrid",f:Xn},47:{n:"FilePass",f:el},49:{n:"Font",f:Yi},51:{n:"PrintSize",f:jn},60:{n:"Continue"},61:{n:"Window1",f:Vi},64:{n:"Backup",f:Xn},65:{n:"Pane",f:Ki},66:{n:"CodePage",f:jn},77:{n:"Pls"},80:{n:"DCon"},81:{n:"DConRef"},82:{n:"DConName"},85:{n:"DefColWidth",f:jn},89:{n:"XCT"},90:{n:"CRN"},91:{n:"FileSharing"},92:{n:"WriteAccess",f:Di},93:{n:"Obj",f:Rs},94:{n:"Uncalced"},95:{n:"CalcSaveRecalc",f:Xn},96:{n:"Template"},97:{n:"Intl"},99:{n:"ObjProtect",f:Xn},125:{n:"ColInfo",f:Xs},128:{n:"Guts",f:cs},129:{n:"WsBool",f:Oi},130:{n:"GridSet",f:jn},131:{n:"HCenter",f:Xn},132:{n:"VCenter",f:Xn},133:{n:"BoundSheet8",f:Pi},134:{n:"WriteProtect"},140:{n:"Country",f:Us},141:{n:"HideObj",f:jn},144:{n:"Sort"},146:{n:"Palette",f:zs},151:{n:"Sync"},152:{n:"LPr"},153:{n:"DxGCol"},154:{n:"FnGroupName"},155:{n:"FilterMode"},156:{n:"BuiltInFnGroupCount",f:jn},157:{n:"AutoFilterInfo"},158:{n:"AutoFilter"},160:{n:"Scl",f:$s},161:{n:"Setup",f:Gs},174:{n:"ScenMan"},175:{n:"SCENARIO"},176:{n:"SxView"},177:{n:"Sxvd"},178:{n:"SXVI"},180:{n:"SxIvd"},181:{n:"SXLI"},182:{n:"SXPI"},184:{n:"DocRoute"},185:{n:"RecipName"},189:{n:"MulRk",f:is},190:{n:"MulBlank",f:ss},193:{n:"Mms",f:Wn},197:{n:"SXDI"},198:{n:"SXDB"},199:{n:"SXFDB"},200:{n:"SXDBB"},201:{n:"SXNum"},202:{n:"SxBool",f:Xn},203:{n:"SxErr"},204:{n:"SXInt"},205:{n:"SXString"},206:{n:"SXDtr"},207:{n:"SxNil"},208:{n:"SXTbl"},209:{n:"SXTBRGIITM"},210:{n:"SxTbpg"},211:{n:"ObProj"},213:{n:"SXStreamID"},215:{n:"DBCell"},216:{n:"SXRng"},217:{n:"SxIsxoper"},218:{n:"BookBool",f:jn},220:{n:"DbOrParamQry"},221:{n:"ScenarioProtect",f:Xn},222:{n:"OleObjectSize"},224:{n:"XF",f:ls},225:{n:"InterfaceHdr",f:Ri},226:{n:"InterfaceEnd",f:Wn},227:{n:"SXVS"},229:{n:"MergeCells",f:As},233:{n:"BkHim"},235:{n:"MsoDrawingGroup"},236:{n:"MsoDrawing"},237:{n:"MsoDrawingSelection"},239:{n:"PhoneticInfo"},240:{n:"SxRule"},241:{n:"SXEx"},242:{n:"SxFilt"},244:{n:"SxDXF"},245:{n:"SxItm"},246:{n:"SxName"},247:{n:"SxSelect"},248:{n:"SXPair"},249:{n:"SxFmla"},251:{n:"SxFormat"},252:{n:"SST",f:Li},253:{n:"LabelSst",f:Zi},255:{n:"ExtSST",f:Mi},256:{n:"SXVDEx"},259:{n:"SXFormula"},290:{n:"SXDBEx"},311:{n:"RRDInsDel"},312:{n:"RRDHead"},315:{n:"RRDChgCell"},317:{n:"RRTabId",f:Yn},318:{n:"RRDRenSheet"},319:{n:"RRSort"},320:{n:"RRDMove"},330:{n:"RRFormat"},331:{n:"RRAutoFmt"},333:{n:"RRInsertSh"},334:{n:"RRDMoveBegin"},335:{n:"RRDMoveEnd"},336:{n:"RRDInsDelBegin"},337:{n:"RRDInsDelEnd"},338:{n:"RRDConflict"},339:{n:"RRDDefName"},340:{n:"RRDRstEtxp"},351:{n:"LRng"},352:{n:"UsesELFs",f:Xn},353:{n:"DSF",f:Wn},401:{n:"CUsr"},402:{n:"CbUsr"},403:{n:"UsrInfo"},404:{n:"UsrExcl"},405:{n:"FileLock"},406:{n:"RRDInfo"},407:{n:"BCUsrs"},408:{n:"UsrChk"},425:{n:"UserBView"},426:{n:"UserSViewBegin"},427:{n:"UserSViewEnd"},428:{n:"RRDUserView"},429:{n:"Qsi"},430:{n:"SupBook",f:bs},431:{n:"Prot4Rev",f:Xn},432:{n:"CondFmt"},433:{n:"CF"},434:{n:"DVal"},437:{n:"DConBin"},438:{n:"TxO",f:Os},439:{n:"RefreshAll",f:Xn},440:{n:"HLink",f:Ps},441:{n:"Lel"},442:{n:"CodeName",f:ei},443:{n:"SXFDBType"},444:{n:"Prot4RevPass",f:jn},445:{n:"ObNoMacros"},446:{n:"Dv"},448:{n:"Excel9File",f:Wn},449:{n:"RecalcId",f:Wi,r:2},450:{n:"EntExU2",f:Wn},512:{n:"Dimensions",f:ts},513:{n:"Blank",f:Ys},515:{n:"Number",f:vs},516:{n:"Label",f:Qi},517:{n:"BoolErr",f:hs},518:{n:"Formula",f:Hu},519:{n:"String",f:Zs},520:{n:"Row",f:Ui},523:{n:"Index"},545:{n:"Array",f:Bs},549:{n:"DefaultRowHeight",f:zi},566:{n:"Table"},574:{n:"Window2",f:Gi},638:{n:"RK",f:ns},659:{n:"Style"},1030:{n:"Formula",f:Hu},1048:{n:"BigName"},1054:{n:"Format",f:qi},1084:{n:"ContinueBigName"},1212:{n:"ShrFmla",f:Cs},2048:{n:"HLinkTooltip",f:Ls},2049:{n:"WebPub"},2050:{n:"QsiSXTag"},2051:{n:"DBQueryExt"},2052:{n:"ExtString"},2053:{n:"TxtQry"},2054:{n:"Qsir"},2055:{n:"Qsif"},2056:{n:"RRDTQSIF"},2057:{n:"BOF",f:Ai},2058:{n:"OleDbConn"},2059:{n:"WOpt"},2060:{n:"SXViewEx"},2061:{n:"SXTH"},2062:{n:"SXPIEx"},2063:{n:"SXVDTEx"},2064:{n:"SXViewEx9"},2066:{n:"ContinueFrt"},2067:{n:"RealTimeData"},2128:{n:"ChartFrtInfo"},2129:{n:"FrtWrapper"},2130:{n:"StartBlock"},2131:{n:"EndBlock"},2132:{n:"StartObject"},2133:{n:"EndObject"},2134:{n:"CatLab"},2135:{n:"YMult"},2136:{n:"SXViewLink"},2137:{n:"PivotChartBits"},2138:{n:"FrtFontList"},2146:{n:"SheetExt"},2147:{n:"BookExt",r:12},2148:{n:"SXAddl"},2149:{n:"CrErr"},2150:{n:"HFPicture"},2151:{n:"FeatHdr",f:Wn},2152:{n:"Feat"},2154:{n:"DataLabExt"},2155:{n:"DataLabExtContents"},2156:{n:"CellWatch"},2161:{n:"FeatHdr11"},2162:{n:"Feature11"},2164:{n:"DropDownObjIds"},2165:{n:"ContinueFrt11"},2166:{n:"DConn"},2167:{n:"List12"},2168:{n:"Feature12"},2169:{n:"CondFmt12"},2170:{n:"CF12"},2171:{n:"CFEx"},2172:{n:"XFCRC",f:Vs,r:12},2173:{n:"XFExt",f:Co,r:12},2174:{n:"AutoFilter12"},2175:{n:"ContinueFrt12"},2180:{n:"MDTInfo"},2181:{n:"MDXStr"},2182:{n:"MDXTuple"},2183:{n:"MDXSet"},2184:{n:"MDXProp"},2185:{n:"MDXKPI"},2186:{n:"MDB"},2187:{n:"PLV"},2188:{n:"Compat12",f:Xn,r:12},2189:{n:"DXF"},2190:{n:"TableStyles",r:12},2191:{n:"TableStyle"},2192:{n:"TableStyleElement"},2194:{n:"StyleExt"},2195:{n:"NamePublish"},2196:{n:"NameCmt",f:_s,r:12},2197:{n:"SortData"},2198:{n:"Theme",f:go,r:12},2199:{n:"GUIDTypeLib"},2200:{n:"FnGrp12"},2201:{n:"NameFnGrp12"},2202:{n:"MTRSettings",f:Ts,r:12},2203:{n:"CompressPictures",f:Wn},2204:{n:"HeaderFooter"},2205:{n:"CrtLayout12"},2206:{n:"CrtMlFrt"},2207:{n:"CrtMlFrtContinue"},2211:{n:"ForceFullCalculation",f:Hi},2212:{n:"ShapePropsStream"},2213:{n:"TextPropsStream"},2214:{n:"RichTextStream"},2215:{n:"CrtLayout12A"},4097:{n:"Units"},4098:{n:"Chart"},4099:{n:"Series"},4102:{n:"DataFormat"},4103:{n:"LineFormat"},4105:{n:"MarkerFormat"},4106:{n:"AreaFormat"},4107:{n:"PieFormat"},4108:{n:"AttachedLabel"},4109:{n:"SeriesText"},4116:{n:"ChartFormat"},4117:{n:"Legend"},4118:{n:"SeriesList"},4119:{n:"Bar"},4120:{n:"Line"},4121:{n:"Pie"},4122:{n:"Area"},4123:{n:"Scatter"},4124:{n:"CrtLine"},4125:{n:"Axis"},4126:{n:"Tick"},4127:{n:"ValueRange"},4128:{n:"CatSerRange"},4129:{n:"AxisLine"},4130:{n:"CrtLink"},4132:{n:"DefaultText"},4133:{n:"Text"},4134:{n:"FontX",f:jn},4135:{n:"ObjectLink"},4146:{n:"Frame"},4147:{n:"Begin"},4148:{n:"End"},4149:{n:"PlotArea"},4154:{n:"Chart3d"},4156:{n:"PicF"},4157:{n:"DropBar"},4158:{n:"Radar"},4159:{n:"Surf"},4160:{n:"RadarArea"},4161:{n:"AxisParent"},4163:{n:"LegendException"},4164:{n:"ShtProps",f:js},4165:{n:"SerToCrt"},4166:{n:"AxesUsed"},4168:{n:"SBaseRef"},4170:{n:"SerParent"},4171:{n:"SerAuxTrend"},4174:{n:"IFmtRecord"},4175:{n:"Pos"},4176:{n:"AlRuns"},4177:{n:"BRAI"},4187:{n:"SerAuxErrBar"},4188:{n:"ClrtClient",f:Ws},4189:{n:"SerFmt"},4191:{n:"Chart3DBarShape"},4192:{n:"Fbi"},4193:{n:"BopPop"},4194:{n:"AxcExt"},4195:{n:"Dat"},4196:{n:"PlotGrowth"},4197:{n:"SIIndex"},4198:{n:"GelFrame"},4199:{n:"BopPopCustom"},4200:{n:"Fbi2"},0:{n:"Dimensions",f:ts},2:{n:"BIFF2INT",f:rf},5:{n:"BoolErr",f:hs},7:{n:"String",f:af},8:{n:"BIFF2ROW"},11:{n:"Index"},22:{n:"ExternCount",f:jn},30:{n:"BIFF2FORMAT",f:rs},31:{n:"BIFF2FMTCNT"},32:{n:"BIFF2COLINFO"},33:{n:"Array",f:Bs},37:{n:"DefaultRowHeight",f:zi},50:{n:"BIFF2FONTXTRA",f:nf},52:{n:"DDEObjName"},62:{n:"BIFF2WINDOW2"},67:{n:"BIFF2XF"},69:{n:"BIFF2FONTCLR"},86:{n:"BIFF4FMTCNT"},126:{n:"RK"},127:{n:"ImData",f:Qs},135:{n:"Addin"},136:{n:"Edg"},137:{n:"Pub"},145:{n:"Sub"},148:{n:"LHRecord"},149:{n:"LHNGraph"},150:{n:"Sound"},169:{n:"CoordList"},171:{n:"GCW"},188:{n:"ShrFmla"},191:{n:"ToolbarHdr"},192:{n:"ToolbarEnd"},194:{n:"AddMenu"},195:{n:"DelMenu"},214:{n:"RString",f:sf},223:{n:"UDDesc"},234:{n:"TabIdConf"},354:{n:"XL5Modify"},421:{n:"FileSharing2"},521:{n:"BOF",f:Ai},536:{n:"Lbl",f:ks},547:{n:"ExternName",f:gs},561:{n:"Font"},579:{n:"BIFF3XF"},1033:{n:"BOF",f:Ai},1091:{n:"BIFF4XF"},2157:{n:"FeatInfo"},2163:{n:"FeatInfo11"},2177:{n:"SXAddl12"},2240:{n:"AutoWebPub"},2241:{n:"ListObj"},2242:{n:"ListField"},2243:{n:"ListDV"},2244:{n:"ListCondFmt"},2245:{n:"ListCF"},2246:{n:"FMQry"},2247:{n:"FMSQry"},2248:{n:"PLV"},2249:{n:"LnExt"},2250:{n:"MkrExt"},2251:{n:"CrtCoopt"},2262:{n:"FRTArchId$",r:12},29282:{}},Ap=Y(xp,"n");function Ip(e,r,t,a){var n=+r||+Ap[r];if(!isNaN(n)){var i=a||(t||[]).length||0,s=e.next(4);s._W(2,n),s._W(2,i),i>0&&Or(t)&&e.push(t)}}function Rp(e,r,t){return e||(e=$r(7)),e._W(2,r),e._W(2,t),e._W(2,0),e._W(1,0),e}function Dp(e,r,t,a){var n=$r(9);return Rp(n,e,r),"e"==a?(n._W(1,t),n._W(1,1)):(n._W(1,t?1:0),n._W(1,0)),n}function Fp(e,r,t){var a=$r(8+2*t.length);return Rp(a,e,r),a._W(1,t.length),a._W(t.length,t,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function Op(e,r,t,a){if(null!=r.v)switch(r.t){case"d":case"n":var n="d"==r.t?re(se(r.v)):r.v;return void(n==(0|n)&&n>=0&&n<65536?Ip(e,2,tf(t,a,n)):Ip(e,3,ef(t,a,n)));case"b":case"e":return void Ip(e,5,Dp(t,a,r.v,r.t));case"s":case"str":return void Ip(e,4,Fp(t,a,r.v))}Ip(e,1,Rp(null,t,a))}function Pp(e,r,t,a){var n=Array.isArray(r),i=gt(r["!ref"]||"A1"),s,f="",l=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=bt(i)}for(var o=i.s.r;o<=i.e.r;++o){f=st(o);for(var c=i.s.c;c<=i.e.c;++c){o===i.s.r&&(l[c]=ct(c)),s=l[c]+f;var u=n?(r[o]||[])[c]:r[s];u&&Op(e,u,o,c,a)}}}function Np(e,r){var t=r||{};for(var a=Qr(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==t.sheet&&(n=i);if(0==n&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Ip(a,9,Ii(e,16,t)),Pp(a,e.Sheets[e.SheetNames[n]],n,t,e),Ip(a,10),a.end()}function Lp(e,r,t){Ip(e,"Font",$i({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}function Mp(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach((function(a){for(var n=a[0];n<=a[1];++n)null!=r[n]&&Ip(e,"Format",es(n,r[n],t))}))}function Up(e,r){var t=$r(19);t._W(4,2151),t._W(4,0),t._W(4,0),t._W(2,3),t._W(1,1),t._W(4,0),Ip(e,"FeatHdr",t),(t=$r(39))._W(4,2152),t._W(4,0),t._W(4,0),t._W(2,3),t._W(1,0),t._W(4,0),t._W(2,1),t._W(4,4),t._W(2,0),ki(gt(r["!ref"]||"A1"),t),t._W(4,4),Ip(e,"Feat",t)}function Hp(e,r){for(var t=0;t<16;++t)Ip(e,"XF",os({numFmtId:0,style:!0},0,r));r.cellXfs.forEach((function(t){Ip(e,"XF",os(t,0,r))}))}function Wp(e,r){for(var t=0;t<r["!links"].length;++t){var a=r["!links"][t];Ip(e,"HLink",Ns(a)),a[1].Tooltip&&Ip(e,"HLinkTooltip",Ms(a))}delete r["!links"]}function zp(e,r,t,a,n){var i=16+fh(n.cellXfs,r,n);if(null!=r.v||r.bf)if(r.bf)Ip(e,"Formula",Wu(r,t,a,n,i));else switch(r.t){case"d":case"n":var s;Ip(e,"Number",ps(t,a,"d"==r.t?re(se(r.v)):r.v,i,n));break;case"b":case"e":Ip(e,517,ds(t,a,r.v,i,n,r.t));break;case"s":case"str":Ip(e,"Label",Ji(t,a,r.v,i,n));break;default:Ip(e,"Blank",di(t,a,i))}else Ip(e,"Blank",di(t,a,i))}function Vp(e,r,t){var a=Qr(),n=t.SheetNames[e],i=t.Sheets[n]||{},s=(t||{}).Workbook||{},f=(s.Sheets||[])[e]||{},l=Array.isArray(i),o=8==r.biff,c,u="",h=[],d=gt(i["!ref"]||"A1"),v=o?65536:16384;if(d.e.c>255||d.e.r>=v){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,v-1)}Ip(a,2057,Ii(t,16,r)),Ip(a,"CalcMode",Kn(1)),Ip(a,"CalcCount",Kn(100)),Ip(a,"CalcRefMode",Gn(!0)),Ip(a,"CalcIter",Gn(!1)),Ip(a,"CalcDelta",$t(.001)),Ip(a,"CalcSaveRecalc",Gn(!0)),Ip(a,"PrintRowCol",Gn(!1)),Ip(a,"PrintGrid",Gn(!1)),Ip(a,"GridSet",Kn(1)),Ip(a,"Guts",us([0,0])),Ip(a,"HCenter",Gn(!1)),Ip(a,"VCenter",Gn(!1)),Ip(a,512,as(d,r)),o&&(i["!links"]=[]);for(var p=d.s.r;p<=d.e.r;++p){u=st(p);for(var m=d.s.c;m<=d.e.c;++m){p===d.s.r&&(h[m]=ct(m)),c=h[m]+u;var b=l?(i[p]||[])[m]:i[c];b&&(zp(a,b,p,m,r),o&&b.l&&i["!links"].push([c,b.l]))}}var g=f.CodeName||f.name||n;return o&&s.Views&&Ip(a,"Window2",ji(s.Views[0])),o&&(i["!merges"]||[]).length&&Ip(a,"MergeCells",Is(i["!merges"])),o&&Wp(a,i),Ip(a,"CodeName",ti(g,r)),o&&Up(a,i),Ip(a,"EOF"),a.end()}function Xp(e,r,t){var a=Qr(),n=(e||{}).Workbook||{},i=n.Sheets||[],s=n.WBProps||{},f=8==t.biff,l=5==t.biff,o;(Ip(a,2057,Ii(e,5,t)),"xla"==t.bookType&&Ip(a,"Addin"),Ip(a,"InterfaceHdr",f?Kn(1200):null),Ip(a,"Mms",zn(2)),l&&Ip(a,"ToolbarHdr"),l&&Ip(a,"ToolbarEnd"),Ip(a,"InterfaceEnd"),Ip(a,"WriteAccess",Fi("SheetJS",t)),Ip(a,"CodePage",Kn(f?1200:1252)),f&&Ip(a,"DSF",Kn(0)),f&&Ip(a,"Excel9File"),Ip(a,"RRTabId",Ks(e.SheetNames.length)),f&&e.vbaraw&&Ip(a,"ObProj"),f&&e.vbaraw)&&Ip(a,"CodeName",ti(s.CodeName||"ThisWorkbook",t));Ip(a,"BuiltInFnGroupCount",Kn(17)),Ip(a,"WinProtect",Gn(!1)),Ip(a,"Protect",Gn(!1)),Ip(a,"Password",Kn(0)),f&&Ip(a,"Prot4Rev",Gn(!1)),f&&Ip(a,"Prot4RevPass",Kn(0)),Ip(a,"Window1",Xi(t)),Ip(a,"Backup",Gn(!1)),Ip(a,"HideObj",Kn(0)),Ip(a,"Date1904",Gn("true"==iv(e))),Ip(a,"CalcPrecision",Gn(!0)),f&&Ip(a,"RefreshAll",Gn(!1)),Ip(a,"BookBool",Kn(0)),Lp(a,e,t),Mp(a,e.SSF,t),Hp(a,t),f&&Ip(a,"UsesELFs",Gn(!1));var c=a.end(),u=Qr();f&&Ip(u,"Country",Hs()),Ip(u,"EOF");var h=u.end(),d=Qr(),v=0,p=0;for(p=0;p<e.SheetNames.length;++p)v+=(f?12:11)+(f?2:1)*e.SheetNames[p].length;var m=c.length+v+h.length;for(p=0;p<e.SheetNames.length;++p){var b;Ip(d,"BoundSheet8",Ni({pos:m,hs:(i[p]||{}).Hidden||0,dt:0,name:e.SheetNames[p]},t)),m+=r[p].length}var g=d.end();if(v!=g.length)throw new Error("BS8 "+v+" != "+g.length);var w=[];return c.length&&w.push(c),g.length&&w.push(g),h.length&&w.push(h),vr([w])}function Gp(e,r){var t=r||{},a=[];e&&!e.SSF&&(e.SSF=F.get_table()),e&&e.SSF&&(O(F),F.load_table(e.SSF),t.revssf=Q(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,bm(t),t.cellXfs=[],fh(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=Vp(n,t,e);return a.unshift(Xp(e,a,t)),vr([a])}function jp(e,r){var t=r||{};switch(t.biff||2){case 8:case 5:return Gp(e,r);case 4:case 3:case 2:return Np(e,r)}throw new Error("invalid type "+t.bookType+" for BIFF")}var Kp=function(){function e(e,r){var t=r||{};var a=t.dense?[]:{},n=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=n.index,f=i&&i.index||e.length,l=de(e.slice(s,f),/(:?<tr[^>]*>)/i,"<tr>"),o=-1,c=0,u=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(s=0;s<l.length;++s){var p=l[s].trim(),b=p.slice(0,3).toLowerCase();if("<tr"!=b){if("<td"==b||"<th"==b){var g=p.split(/<\/t[dh]>/i);for(f=0;f<g.length;++f){var w=g[f].trim();if(w.match(/<t[dh]/i)){for(var k=w,E=0;"<"==k.charAt(0)&&(E=k.indexOf(">"))>-1;)k=k.slice(E+1);for(var S=0;S<v.length;++S){var _=v[S];_.s.c==c&&_.s.r<o&&o<=_.e.r&&(c=_.e.c+1,S=-1)}var C=De(w.slice(0,w.indexOf(">")));h=C.colspan?+C.colspan:1,((u=+C.rowspan)>1||h>1)&&v.push({s:{r:o,c:c},e:{r:o+(u||1)-1,c:c+h-1}});var B=C.t||"";if(k.length){if(k=qe(k),d.s.r>o&&(d.s.r=o),d.e.r<o&&(d.e.r=o),d.s.c>c&&(d.s.c=c),d.e.c<c&&(d.e.c=c),k.length){var T={t:"s",v:k};t.raw||!k.trim().length||"s"==B||("TRUE"===k?T={t:"b",v:!0}:"FALSE"===k?T={t:"b",v:!1}:isNaN(ce(k))?isNaN(ue(k).getDate())||(T={t:"d",v:se(k)},t.cellDates||(T={t:"n",v:re(T.v)}),T.z=t.dateNF||F._table[14]):T={t:"n",v:ce(k)}),t.dense?(a[o]||(a[o]=[]),a[o][c]=T):a[pt({r:o,c:c})]=T,c+=h}}else c+=h}}}}else{if(++o,t.sheetRows&&t.sheetRows<=o){--o;break}c=0}}return a["!ref"]=bt(d),v.length&&(a["!merges"]=v),a}function r(r,t){return Et(e(r,t),t)}function t(e,r,t,a){for(var n=e["!merges"]||[],i=[],s=r.s.c;s<=r.e.c;++s){for(var f=0,l=0,o=0;o<n.length;++o)if(!(n[o].s.r>t||n[o].s.c>s||n[o].e.r<t||n[o].e.c<s)){if(n[o].s.r<t||n[o].s.c<s){f=-1;break}f=n[o].e.r-n[o].s.r+1,l=n[o].e.c-n[o].s.c+1;break}if(!(f<0)){var c=pt({r:t,c:s}),u=a.dense?(e[t]||[])[s]:e[c],h=u&&null!=u.v&&(u.h||ze(u.w||(kt(u),u.w)||""))||"",d={};f>1&&(d.rowspan=f),l>1&&(d.colspan=l),d.t=u&&u.t||"z",a.editable&&(h='<span contenteditable="true">'+h+"</span>"),d.id=(a.id||"sjs")+"-"+c,i.push(fr("td",h,d))}}var v;return"<tr>"+i.join("")+"</tr>"}function a(e,r,t){var a;return[].join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}var n='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',i="</body></html>";function s(e,r){var s=r||{},f=null!=s.header?s.header:n,l=null!=s.footer?s.footer:i,o=[f],c=mt(e["!ref"]);s.dense=Array.isArray(e),o.push(a(e,c,s));for(var u=c.s.r;u<=c.e.r;++u)o.push(t(e,c,u,s));return o.push("</table>"+l),o.join("")}return{to_workbook:r,to_sheet:e,_row:t,BEGIN:n,END:i,_preamble:a,from_sheet:s}}();function Yp(e,r){var t=r||{};for(var a=t.dense?[]:{},n=e.getElementsByTagName("tr"),i=t.sheetRows||1e7,s={s:{r:0,c:0},e:{r:0,c:0}},f=[],l=0,o=[],c=0,u=0,h=0,d=0,v=0,p=0;c<n.length&&u<i;++c){var b=n[c];if(Zp(b)){if(t.display)continue;o[u]={hidden:!0}}var g=b.children;for(h=d=0;h<g.length;++h){var w=g[h];if(!t.display||!Zp(w)){var k=qe(w.innerHTML);for(l=0;l<f.length;++l){var E=f[l];E.s.c==d&&E.s.r<=u&&u<=E.e.r&&(d=E.e.c+1,l=-1)}p=+w.getAttribute("colspan")||1,((v=+w.getAttribute("rowspan"))>0||p>1)&&f.push({s:{r:u,c:d},e:{r:u+(v||1)-1,c:d+p-1}});var S={t:"s",v:k},_=w.getAttribute("t")||"";null!=k&&(0==k.length?S.t=_||"z":t.raw||0==k.trim().length||"s"==_||("TRUE"===k?S={t:"b",v:!0}:"FALSE"===k?S={t:"b",v:!1}:isNaN(ce(k))?isNaN(ue(k).getDate())||(S={t:"d",v:se(k)},t.cellDates||(S={t:"n",v:re(S.v)}),S.z=t.dateNF||F._table[14]):S={t:"n",v:ce(k)})),t.dense?(a[u]||(a[u]=[]),a[u][d]=S):a[pt({c:d,r:u})]=S,s.e.c<d&&(s.e.c=d),d+=p}}++u}return f.length&&(a["!merges"]=f),o.length&&(a["!rows"]=o),s.e.r=u-1,a["!ref"]=bt(s),u>=i&&(a["!fullref"]=bt((s.e.r=n.length-c+u-1,s))),a}function $p(e,r){return Et(Yp(e,r),r)}function Zp(e){var r="",t=Qp(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style.display),"none"===r}function Qp(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}var Jp=function(){var e=function(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,r){return Array(parseInt(r,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n"),t;return[Ne(r.replace(/<[^>]*>/g,""))]},r={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};return function t(a,n){var i=n||{};var s=qv(a),f=[],l,o,c={name:""},u="",h=0,d,v,p={},b=[],g=i.dense?[]:{},w,k,E={value:""},S="",_=0,C,B=[],T=-1,y=-1,x={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,I={},R=[],D={},F=0,O=0,P=[],N=1,L=1,M=[],U={Names:[]},H={},W=["",""],z=[],V={},X="",G=0,j=!1,K=!1,Y=0;for(ep.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=ep.exec(s);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":"/"===w[1]?(x.e.c>=x.s.c&&x.e.r>=x.s.r&&(g["!ref"]=bt(x)),i.sheetRows>0&&i.sheetRows<=x.e.r&&(g["!fullref"]=g["!ref"],x.e.r=i.sheetRows-1,g["!ref"]=bt(x)),R.length&&(g["!merges"]=R),P.length&&(g["!rows"]=P),d.name=d[""]||d.name,"undefined"!=typeof JSON&&JSON.stringify(d),b.push(d.name),p[d.name]=g,K=!1):"/"!==w[0].charAt(w[0].length-2)&&(d=De(w[0],!1),T=y=-1,x.s.r=x.s.c=1e7,x.e.r=x.e.c=0,g=i.dense?[]:{},R=[],P=[],K=!0);break;case"table-row-group":"/"===w[1]?--A:++A;break;case"table-row":case"":if("/"===w[1]){T+=N,N=1;break}if((v=De(w[0],!1))[""]?T=v[""]-1:-1==T&&(T=0),(N=+v["number-rows-repeated"]||1)<10)for(Y=0;Y<N;++Y)A>0&&(P[T+Y]={level:A});y=-1;break;case"covered-table-cell":"/"!==w[1]&&++y,i.sheetStubs&&(i.dense?(g[T]||(g[T]=[]),g[T][y]={t:"z"}):g[pt({r:T,c:y})]={t:"z"}),S="",B=[];break;case"table-cell":case"":if("/"===w[0].charAt(w[0].length-2))++y,E=De(w[0],!1),L=parseInt(E["number-columns-repeated"]||"1",10),k={t:"z",v:null},E.formula&&0!=i.cellFormula&&(k.f=Qu(Ne(E.formula))),"string"==(E[""]||E["value-type"])&&(k.t="s",k.v=Ne(E["string-value"]||""),i.dense?(g[T]||(g[T]=[]),g[T][y]=k):g[pt({r:T,c:y})]=k),y+=L-1;else if("/"!==w[1]){L=1;var $=N?T+N-1:T;if(++y>x.e.c&&(x.e.c=y),y<x.s.c&&(x.s.c=y),T<x.s.r&&(x.s.r=T),$>x.e.r&&(x.e.r=$),z=[],V={},k={t:(E=De(w[0],!1))[""]||E["value-type"],v:null},i.cellFormula)if(E.formula&&(E.formula=Ne(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(D={s:{r:T,c:y},e:{r:T+(F=parseInt(E["number-matrix-rows-spanned"],10)||0)-1,c:y+(O=parseInt(E["number-matrix-columns-spanned"],10)||0)-1}},k.F=bt(D),M.push([D,k.F])),E.formula)k.f=Qu(E.formula);else for(Y=0;Y<M.length;++Y)T>=M[Y][0].s.r&&T<=M[Y][0].e.r&&y>=M[Y][0].s.c&&y<=M[Y][0].e.c&&(k.F=M[Y][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(D={s:{r:T,c:y},e:{r:T+(F=parseInt(E["number-rows-spanned"],10)||0)-1,c:y+(O=parseInt(E["number-columns-spanned"],10)||0)-1}},R.push(D)),E["number-columns-repeated"]&&(L=parseInt(E["number-columns-repeated"],10)),k.t){case"boolean":k.t="b",k.v=je(E["boolean-value"]);break;case"float":case"percentage":case"currency":k.t="n",k.v=parseFloat(E.value);break;case"date":k.t="d",k.v=se(E["date-value"]),i.cellDates||(k.t="n",k.v=re(k.v)),k.z="m/d/yy";break;case"time":k.t="n",k.v=ae(E["time-value"])/86400;break;case"number":k.t="n",k.v=parseFloat(E[""]);break;default:if("string"!==k.t&&"text"!==k.t&&k.t)throw new Error("Unsupported value type "+k.t);k.t="s",null!=E["string-value"]&&(S=Ne(E["string-value"]),B=[])}}else{if(j=!1,"s"===k.t&&(k.v=S||"",B.length&&(k.R=B),j=0==_),H.Target&&(k.l=H),z.length>0&&(k.c=z,z=[]),S&&!1!==i.cellText&&(k.w=S),(!j||i.sheetStubs)&&!(i.sheetRows&&i.sheetRows<=T))for(var Z=0;Z<N;++Z){if(L=parseInt(E["number-columns-repeated"]||"1",10),i.dense)for(g[T+Z]||(g[T+Z]=[]),g[T+Z][y]=0==Z?k:le(k);--L>0;)g[T+Z][y+L]=le(k);else for(g[pt({r:T+Z,c:y})]=k;--L>0;)g[pt({r:T+Z,c:y+L})]=le(k);x.e.c<=y&&(x.e.c=y)}y+=(L=parseInt(E["number-columns-repeated"]||"1",10))-1,L=0,k={},S="",B=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":if("/"===w[1]){if((l=f.pop())[0]!==w[3])throw"Bad state: "+l}else"/"!==w[0].charAt(w[0].length-2)&&f.push([w[3],!0]);break;case"annotation":if("/"===w[1]){if((l=f.pop())[0]!==w[3])throw"Bad state: "+l;V.t=S,B.length&&(V.R=B),V.a=X,z.push(V)}else"/"!==w[0].charAt(w[0].length-2)&&f.push([w[3],!1]);X="",G=0,S="",_=0,B=[];break;case"creator":"/"===w[1]?X=s.slice(G,w.index):G=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===w[1]){if((l=f.pop())[0]!==w[3])throw"Bad state: "+l}else"/"!==w[0].charAt(w[0].length-2)&&f.push([w[3],!1]);S="",_=0,B=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===w[1]){if(I[c.name]=u,(l=f.pop())[0]!==w[3])throw"Bad state: "+l}else"/"!==w[0].charAt(w[0].length-2)&&(u="",c=De(w[0],!1),f.push([w[3],!0]));break;case"script":case"libraries":case"automatic-styles":case"master-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(f[f.length-1][0]){case"time-style":case"date-style":o=De(w[0],!1),u+=r[w[3]]["long"===o.style?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(f[f.length-1][0]){case"time-style":case"date-style":o=De(w[0],!1),u+=r[w[3]]["long"===o.style?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if("/>"===w[0].slice(-2))break;if("/"===w[1])switch(f[f.length-1][0]){case"number-style":case"date-style":case"time-style":u+=s.slice(h,w.index)}else h=w.index+w[0].length;break;case"named-range":W=qu((o=De(w[0],!1))["cell-range-address"]);var Q={Name:o.name,Ref:W[0]+"!"+W[1]};K&&(Q.Sheet=b.length),U.Names.push(Q);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"":if("/"!==w[1]||E&&E["string-value"])C=De(w[0],!1),_=w.index+w[0].length;else{var J=e(s.slice(_,w.index),C);S=(S.length>0?S+"\n":"")+J[0]}break;case"s":break;case"database-range":if("/"===w[1])break;try{p[(W=qu(De(w[0])["target-range-address"]))[0]]["!autofilter"]={ref:W[1]}}catch(q){}break;case"date":case"object":break;case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if("/"!==w[1]){if(!(H=De(w[0],!1)).href)break;H.Target=H.href,delete H.href,"#"==H.Target.charAt(0)&&H.Target.indexOf(".")>-1&&(W=qu(H.Target.slice(1)),H.Target="#"+W[0]+"!"+W[1])}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(i.WTF)throw new Error(w)}}var ee={Sheets:p,SheetNames:b,Workbook:U};return i.bookSheets&&delete ee.Sheets,ee}}();function qp(e,r){r=r||{};var t=!!be(e,"objectdata");t&&Xa(we(e,"META-INF/manifest.xml"),r);var a=ke(e,"content.xml");if(!a)throw new Error("Missing content.xml in "+(t?"ODS":"UOF")+" file");var n=Jp(t?a:Ke(a),r);return be(e,"meta.xml")&&(n.Props=Ja(we(e,"meta.xml"))),n}function em(e,r){return Jp(e,r)}var rm=function(){var e="<office:document-styles "+sr({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+"></office:document-styles>";return function r(){return ye+e}}(),tm=function(){var e=function(e){return Ue(e).replace(/  +/g,(function(e){return'<text:s text:c="'+e.length+'"/>'})).replace(/\t/g,"<text:tab/>").replace(/\n/g,"<text:line-break/>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r="          <table:table-cell />\n",t="          <table:covered-table-cell/>\n",a=function(a,n,i){var s=[];s.push('      <table:table table:name="'+Ue(n.SheetNames[i])+'">\n');var f=0,l=0,o=mt(a["!ref"]),c=a["!merges"]||[],u=0,h=Array.isArray(a);for(f=0;f<o.s.r;++f)s.push("        <table:table-row></table:table-row>\n");for(;f<=o.e.r;++f){for(s.push("        <table:table-row>\n"),l=0;l<o.s.c;++l)s.push(r);for(;l<=o.e.c;++l){var d=!1,v={},p="";for(u=0;u!=c.length;++u)if(!(c[u].s.c>l||c[u].s.r>f||c[u].e.c<l||c[u].e.r<f)){c[u].s.c==l&&c[u].s.r==f||(d=!0),v["table:number-columns-spanned"]=c[u].e.c-c[u].s.c+1,v["table:number-rows-spanned"]=c[u].e.r-c[u].s.r+1;break}if(d)s.push(t);else{var m=pt({r:f,c:l}),b=h?(a[f]||[])[l]:a[m];if(b&&b.f&&(v["table:formula"]=Ue(Ju(b.f)),b.F&&b.F.slice(0,m.length)==m)){var g=mt(b.F);v["table:number-matrix-columns-spanned"]=g.e.c-g.s.c+1,v["table:number-matrix-rows-spanned"]=g.e.r-g.s.r+1}if(b){switch(b.t){case"b":p=b.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=b.v?"true":"false";break;case"n":p=b.w||String(b.v||0),v["office:value-type"]="float",v["office:value"]=b.v||0;break;case"s":case"str":p=b.v,v["office:value-type"]="string";break;case"d":p=b.w||se(b.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=se(b.v).toISOString(),v["table:style-name"]="ce1";break;default:s.push(r);continue}var w=e(p);if(b.l&&b.l.Target){var k=b.l.Target;w=fr("text:a",w,{"xlink:href":k="#"==k.charAt(0)?"#"+eh(k.slice(1)):k})}s.push("          "+fr("table:table-cell",fr("text:p",w,{}),v)+"\n")}else s.push(r)}}s.push("        </table:table-row>\n")}return s.push("      </table:table>\n"),s.join("")},n=function(e){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")};return function i(e,r){var t=[ye],i=sr({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),s=sr({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==r.bookType?t.push("<office:document"+i+s+">\n"):t.push("<office:document-content"+i+">\n"),n(t),t.push("  <office:body>\n"),t.push("    <office:spreadsheet>\n");for(var f=0;f!=e.SheetNames.length;++f)t.push(a(e.Sheets[e.SheetNames[f]],e,f,r));return t.push("    </office:spreadsheet>\n"),t.push("  </office:body>\n"),"fods"==r.bookType?t.push("</office:document>"):t.push("</office:document-content>"),t.join("")}}();function am(e,r){if("fods"==r.bookType)return tm(e,r);var t=Ce(),a="",n=[],i=[];return Se(t,a="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Se(t,a="content.xml",tm(e,r)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),Se(t,a="styles.xml",rm(e,r)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),Se(t,a="meta.xml",$a()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),Se(t,a="manifest.rdf",Ya(i)),n.push([a,"application/rdf+xml"]),Se(t,a="META-INF/manifest.xml",Ga(n)),t}function nm(e,r){if(!r)return 0;var t=e.SheetNames.indexOf(r);if(-1==t)throw new Error("Sheet not found: "+r);return t}function im(e){return function r(t,a){var n=nm(t,a.sheet);return e.from_sheet(t.Sheets[t.SheetNames[n]],a,t)}}var sm=im(Kp),fm=im({from_sheet:$m}),lm=im(void 0!==lf?lf:{}),om=im(void 0!==of?of:{}),cm=im(void 0!==uf?uf:{}),um=im(void 0!==rl?rl:{}),hm=im({from_sheet:Zm}),dm=im(void 0!==ff?ff:{}),vm=im(void 0!==cf?cf:{});function pm(e){return function r(t){for(var a=0;a!=e.length;++a){var n=e[a];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}var mm=pm([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]]),bm=pm([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]]);function gm(e){return Na.WS.indexOf(e)>-1?"sheet":Na.CS&&e==Na.CS?"chart":Na.DS&&e==Na.DS?"dialog":Na.MS&&e==Na.MS?"macro":e&&e.length?e:"sheet"}function wm(e,r){if(!e)return 0;try{e=r.map((function a(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,gm(e["!id"][r.id].Type)]}))}catch(t){return null}return e&&0!==e.length?e:null}function km(e,r,t,a,n,i,s,f,l,o,c,u){try{i[a]=Ma(ke(e,t,!0),r);var h=we(e,r),d;switch(f){case"sheet":d=yv(h,r,n,l,i[a],o,c,u);break;case"chart":if(!(d=xv(h,r,n,l,i[a],o,c,u))||!d["!drawel"])break;var v=Te(d["!drawel"].Target,r),p=La(v),m,b=Te(Ro(ke(e,v,!0),Ma(ke(e,p,!0),v)),v),g=La(b);d=Gd(ke(e,b,!0),b,l,Ma(ke(e,g,!0),b),o,d);break;case"macro":d=Av(h,r,n,l,i[a],o,c,u);break;case"dialog":d=Iv(h,r,n,l,i[a],o,c,u);break;default:throw new Error("Unrecognized sheet type "+f)}s[a]=d;var w=[];i&&i[a]&&K(i[a]).forEach((function(t){if(i[a][t].Type==Na.CMNT){var n=Te(i[a][t].Target,r);if(!(w=Ov(we(e,n,!0),n,l))||!w.length)return;Oo(d,w)}}))}catch(k){if(l.WTF)throw k}}function Em(e){return"/"==e.charAt(0)?e.slice(1):e}function Sm(e,r){if(O(F),mm(r=r||{}),be(e,"META-INF/manifest.xml"))return qp(e,r);if(be(e,"objectdata.xml"))return qp(e,r);if(be(e,"Index/Document.iwa"))throw new Error("Unsupported NUMBERS file");var t=Ee(e),a=Da(ke(e,"[Content_Types].xml")),n=!1,i,s;if(0===a.workbooks.length&&we(e,s="xl/workbook.xml",!0)&&a.workbooks.push(s),0===a.workbooks.length){if(!we(e,s="xl/workbook.bin",!0))throw new Error("Could not find workbook");a.workbooks.push(s),n=!0}"bin"==a.workbooks[0].slice(-3)&&(n=!0);var f={},l={};if(!r.bookSheets&&!r.bookProps){if(rh=[],a.sst)try{rh=Fv(we(e,Em(a.sst)),a.sst,r)}catch(o){if(r.WTF)throw o}r.cellStyles&&a.themes.length&&(f=Dv(ke(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(l=Rv(we(e,Em(a.style)),a.style,f,r))}a.links.map((function(t){try{var a=Ma(ke(e,La(Em(t))),t);return Nv(we(e,Em(t)),a,t,r)}catch(n){}}));var c=Tv(we(e,Em(a.workbooks[0])),a.workbooks[0],r),u={},h="";a.coreprops.length&&((h=we(e,Em(a.coreprops[0]),!0))&&(u=Ja(h)),0!==a.extprops.length&&(h=we(e,Em(a.extprops[0]),!0))&&sn(h,u,r));var d={};r.bookSheets&&!r.bookProps||0!==a.custprops.length&&(h=ke(e,Em(a.custprops[0]),!0))&&(d=cn(h,r));var v={};if((r.bookSheets||r.bookProps)&&(c.Sheets?i=c.Sheets.map((function I(e){return e.name})):u.Worksheets&&u.SheetNames.length>0&&(i=u.SheetNames),r.bookProps&&(v.Props=u,v.Custprops=d),r.bookSheets&&void 0!==i&&(v.SheetNames=i),r.bookSheets?v.SheetNames:r.bookProps))return v;i={};var p={};r.bookDeps&&a.calcchain&&(p=Pv(we(e,Em(a.calcchain)),a.calcchain,r));var m=0,b={},g,w,k=c.Sheets;u.Worksheets=k.length,u.SheetNames=[];for(var E=0;E!=k.length;++E)u.SheetNames[E]=k[E].name;var S=n?"bin":"xml",_=a.workbooks[0].lastIndexOf("/"),C=(a.workbooks[0].slice(0,_+1)+"_rels/"+a.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");be(e,C)||(C="xl/_rels/workbook."+S+".rels");var B=Ma(ke(e,C,!0),C);B&&(B=wm(B,c.Sheets));var T=we(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=u.Worksheets;++m){var y="sheet";if(B&&B[m]?(g="xl/"+B[m][1].replace(/[\/]?xl\//,""),be(e,g)||(g=B[m][1]),be(e,g)||(g=C.replace(/_rels\/.*$/,"")+B[m][1]),y=B[m][2]):g=(g="xl/worksheets/sheet"+(m+1-T)+"."+S).replace(/sheet0\./,"sheet."),w=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&null!=r.sheets)switch(typeof r.sheets){case"number":if(m!=r.sheets)continue e;break;case"string":if(u.SheetNames[m].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var x=!1,A=0;A!=r.sheets.length;++A)"number"==typeof r.sheets[A]&&r.sheets[A]==m&&(x=1),"string"==typeof r.sheets[A]&&r.sheets[A].toLowerCase()==u.SheetNames[m].toLowerCase()&&(x=1);if(!x)continue e}}km(e,g,w,u.SheetNames[m],m,b,i,y,r,c,f,l)}return v={Directory:a,Workbook:c,Props:u,Custprops:d,Deps:p,Sheets:i,SheetNames:u.SheetNames,Strings:rh,Styles:l,Themes:f,SSF:F.get_table()},r&&r.bookFiles&&(v.keys=t,v.files=e.files),r&&r.bookVBA&&(a.vba.length>0?v.vbaraw=we(e,Em(a.vba[0]),!0):a.defaults&&a.defaults.bin===Xo&&(v.vbaraw=we(e,"xl/vbaProject.bin",!0))),v}function _m(e,r){var t=r||{},a="Workbook",n=z.find(e,a);try{if(a="/!DataSpaces/Version",!(n=z.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(Of(n.content),a="/!DataSpaces/DataSpaceMap",!(n=z.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=Nf(n.content);if(1!==i.length||1!==i[0].comps.length||0!==i[0].comps[0].t||"StrongEncryptionDataSpace"!==i[0].name||"EncryptedPackage"!==i[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(n=z.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=Lf(n.content);if(1!=s.length||"StrongEncryptionTransform"!=s[0])throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(n=z.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);Uf(n.content)}catch(f){}if(a="/EncryptionInfo",!(n=z.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=zf(n.content);if(a="/EncryptedPackage",!(n=z.find(e,a))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(4==l[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(l[1],n.content,t.password||"",t);if(2==l[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(l[1],n.content,t.password||"",t);throw new Error("File is password-protected")}function Cm(e,r){if(Do=1024,"ods"==r.bookType)return am(e,r);e&&!e.SSF&&(e.SSF=F.get_table()),e&&e.SSF&&(O(F),F.load_table(e.SSF),r.revssf=Q(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ah?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xlsb"==r.bookType?"bin":"xml",a=Ko.indexOf(r.bookType)>-1,n={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],TODO:[],xmlns:""};bm(r=r||{});var i=Ce(),s="",f=0;if(r.cellXfs=[],fh(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Se(i,s="docProps/core.xml",rn(e.Props,r)),n.coreprops.push(s),za(r.rels,2,s,Na.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],o=0;o<e.SheetNames.length;++o)2!=(e.Workbook.Sheets[o]||{}).Hidden&&l.push(e.SheetNames[o]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;for(e.Props.Worksheets=e.Props.SheetNames.length,Se(i,s,ln(e.Props,r)),n.extprops.push(s),za(r.rels,3,s,Na.EXT_PROPS),e.Custprops!==e.Props&&K(e.Custprops||{}).length>0&&(Se(i,s="docProps/custom.xml",hn(e.Custprops,r)),n.custprops.push(s),za(r.rels,4,s,Na.CUST_PROPS)),f=1;f<=e.SheetNames.length;++f){var c={"!id":{}},u=e.Sheets[e.SheetNames[f-1]],h;switch((u||{})["!type"]||"sheet"){case"chart":default:Se(i,s="xl/worksheets/sheet"+f+"."+t,Mv(f-1,s,r,e,c)),n.sheets.push(s),za(r.wbrels,-1,"worksheets/sheet"+f+"."+t,Na.WS[0])}if(u){var d=u["!comments"],v=!1;if(d&&d.length>0){var p="xl/comments"+f+"."+t;Se(i,p,zv(d,p,r)),n.comments.push(p),za(c,-1,"../comments"+f+"."+t,Na.CMNT),v=!0}u["!legacy"]&&v&&Se(i,"xl/drawings/vmlDrawing"+f+".vml",Fo(f,u["!comments"])),delete u["!comments"],delete u["!legacy"]}c["!id"].rId1&&Se(i,La(s),Ha(c))}return null!=r.Strings&&r.Strings.length>0&&(Se(i,s="xl/sharedStrings."+t,Wv(r.Strings,s,r)),n.strs.push(s),za(r.wbrels,-1,"sharedStrings."+t,Na.SST)),Se(i,s="xl/workbook."+t,Lv(e,s,r)),n.workbooks.push(s),za(r.rels,1,s,Na.WB),Se(i,s="xl/theme/theme1.xml",bo(e.Themes,r)),n.themes.push(s),za(r.wbrels,-1,"theme/theme1.xml",Na.THEME),Se(i,s="xl/styles."+t,Hv(e,s,r)),n.styles.push(s),za(r.wbrels,-1,"styles."+t,Na.STY),e.vbaraw&&a&&(Se(i,s="xl/vbaProject.bin",e.vbaraw),n.vba.push(s),za(r.wbrels,-1,"vbaProject.bin",Na.VBA)),Se(i,"[Content_Types].xml",Pa(n,r)),Se(i,"_rels/.rels",Ha(r.rels)),Se(i,"xl/_rels/workbook."+t+".rels",Ha(r.wbrels)),delete r.revssf,delete r.ssf,i}function Bm(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3]];case"base64":t=g.decode(e.slice(0,24));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]}function Tm(e,r){return z.find(e,"EncryptedPackage")?_m(e,r):Cp(e,r)}function ym(e,r){var t,a=e,n=r||{};return n.type||(n.type=w&&Buffer.isBuffer(e)?"buffer":"base64"),Sm(t=Be(a,n),n)}function xm(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return tp(e.slice(t),r);default:break e}return uf.to_workbook(e,r)}function Am(e,r){var t="",a=Bm(e,r);switch(r.type){case"base64":t=g.decode(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=fe(e);break;default:throw new Error("Unrecognized type "+r.type)}return 239==a[0]&&187==a[1]&&191==a[2]&&(t=Ke(t)),xm(t,r)}function Im(e,r){var t=e;return"base64"==r.type&&(t=g.decode(t)),t=cptable.utils.decode(1200,t.slice(2),"str"),r.type="binary",xm(t,r)}function Rm(e){return e.match(/[^\x00-\x7F]/)?Ye(e):e}function Dm(e,r,t,a){return a?(t.type="string",uf.to_workbook(e,t)):uf.to_workbook(r,t)}function Fm(e,r){if(o(),"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return Fm(new Uint8Array(e),r);var t=e,a=[0,0,0,0],n=!1,i=r||{};if(i.cellStyles&&(i.cellNF=!0),th={},i.dateNF&&(th.dateNF=i.dateNF),i.type||(i.type=w&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==i.type&&(i.type=w?"buffer":"binary",t=j(e)),"string"==i.type&&(n=!0,i.type="binary",i.codepage=65001,t=Rm(e)),"array"==i.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var s=new ArrayBuffer(3),f=new Uint8Array(s);if(f.foo="bar",!f.foo)return(i=le(i)).type="array",Fm(A(t),i)}switch((a=Bm(t,i))[0]){case 208:return Tm(z.read(t,i),i);case 9:if(a[1]<=4)return Cp(t,i);break;case 60:return tp(t,i);case 73:if(68===a[1])return hf(t,i);break;case 84:if(65===a[1]&&66===a[2]&&76===a[3])return of.to_workbook(t,i);break;case 80:return 75===a[1]&&a[2]<9&&a[3]<9?ym(t,i):Dm(e,t,i,n);case 239:return 60===a[3]?tp(t,i):Dm(e,t,i,n);case 255:if(254===a[1])return Im(t,i);break;case 0:if(0===a[1]&&a[2]>=2&&0===a[3])return df.to_workbook(t,i);break;case 3:case 131:case 139:case 140:return ff.to_workbook(t,i);case 123:if(92===a[1]&&114===a[2]&&116===a[3])return rl.to_workbook(t,i);break;case 10:case 13:case 32:return Am(t,i)}return a[2]<=12&&a[3]<=31?ff.to_workbook(t,i):Dm(e,t,i,n)}function Om(e,r){var t=r||{};return t.type="file",Fm(e,t)}function Pm(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return G(r.file,z.write(e,{type:w?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return z.write(e,r)}function Nm(e,r){var t=r||{},a=Cm(e,t),n={};if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=w?"nodebuffer":"string";else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=w?"nodebuffer":"string";break;default:throw new Error("Unrecognized type "+t.type)}var i=a.FullPaths?z.write(a,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type}):a.generate(n);return t.password&&"undefined"!=typeof encrypt_agile?Pm(encrypt_agile(i,t.password),t):"file"===t.type?G(t.file,i):"string"==t.type?Ke(i):i}function Lm(e,r){var t=r||{},a;return Pm(Bp(e,t),t)}function Mm(e,r,t){t||(t="");var a=t+e;switch(r.type){case"base64":return g.encode(Ye(a));case"binary":return Ye(a);case"string":return e;case"file":return G(r.file,a,"utf8");case"buffer":return w?k(a,"utf8"):Mm(a,{type:"binary"}).split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+r.type)}function Um(e,r){switch(r.type){case"base64":return g.encode(e);case"binary":case"string":return e;case"file":return G(r.file,e,"binary");case"buffer":return w?k(e,"binary"):e.split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+r.type)}function Hm(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",a=0;a<e.length;++a)t+=String.fromCharCode(e[a]);return"base64"==r.type?g.encode(t):"string"==r.type?Ke(t):t;case"file":return G(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function Wm(e,r){o(),ov(e);var t=r||{};if(t.cellStyles&&(t.cellNF=!0),"array"==t.type){t.type="binary";var a=Wm(e,t);return t.type="array",T(a)}switch(t.bookType||"xlsb"){case"xml":case"xlml":return Mm(pp(e,t),t);case"slk":case"sylk":return Mm(lm(e,t),t);case"htm":case"html":return Mm(sm(e,t),t);case"txt":return Um(hm(e,t),t);case"csv":return Mm(fm(e,t),t,"\ufeff");case"dif":return Mm(om(e,t),t);case"dbf":return Hm(dm(e,t),t);case"prn":return Mm(cm(e,t),t);case"rtf":return Mm(um(e,t),t);case"eth":return Mm(vm(e,t),t);case"fods":return Mm(am(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Hm(jp(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),Lm(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"ods":return Nm(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function zm(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function Vm(e,r,t){var a=t||{};return a.type="file",a.file=r,zm(a),Wm(e,a)}function Xm(e,r,t,a){var n=t||{};n.type="file",n.file=e,zm(n),n.type="buffer";var i=a;return i instanceof Function||(i=t),V.writeFile(e,Wm(r,n),i)}function Gm(e,r,t,a,n,i,s,f){var l=st(t),o=f.defval,c=f.raw||!f.hasOwnProperty("raw"),u=!0,h=1===n?[]:{};if(1!==n)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:t,enumerable:!1})}catch(d){h.__rowNum__=t}else h.__rowNum__=t;if(!s||e[t])for(var v=r.s.c;v<=r.e.c;++v){var p=s?e[t][v]:e[a[v]+l];if(void 0!==p&&void 0!==p.t){var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=i[v]){if(null==m)if(void 0!==o)h[i[v]]=o;else{if(!c||null!==m)continue;h[i[v]]=null}else h[i[v]]=c?m:kt(p,m,f);null!=m&&(u=!1)}}else{if(void 0===o)continue;null!=i[v]&&(h[i[v]]=o)}}return{row:h,isempty:u}}function jm(e,r){if(null==e||null==e["!ref"])return[];var t={t:"n",v:0},a=0,n=1,i=[],s=0,f="",l={s:{r:0,c:0},e:{r:0,c:0}},o=r||{},c=null!=o.range?o.range:e["!ref"];switch(1===o.header?a=1:"A"===o.header?a=2:Array.isArray(o.header)?a=3:null==o.header&&(a=0),typeof c){case"string":l=gt(c);break;case"number":(l=gt(e["!ref"])).s.r=c;break;default:l=c}a>0&&(n=0);var u=st(l.s.r),h=[],d=[],v=0,p=0,m=Array.isArray(e),b=l.s.r,g=0,w=0;for(m&&!e[b]&&(e[b]=[]),g=l.s.c;g<=l.e.c;++g)switch(h[g]=ct(g),t=m?e[b][g]:e[h[g]+u],a){case 1:i[g]=g-l.s.c;break;case 2:i[g]=h[g];break;case 3:i[g]=o.header[g-l.s.c];break;default:for(null==t&&(t={w:"__EMPTY",t:"s"}),f=s=kt(t,null,o),p=0,w=0;w<i.length;++w)i[w]==f&&(f=s+"_"+ ++p);i[g]=f}for(b=l.s.r+n;b<=l.e.r;++b){var k=Gm(e,l,b,h,a,i,m,o);(!1===k.isempty||(1===a?!1!==o.blankrows:o.blankrows))&&(d[v++]=k.row)}return d.length=v,d}var Km=/"/g;function Ym(e,r,t,a,n,i,s,f){for(var l=!0,o=[],c="",u=st(t),h=r.s.c;h<=r.e.c;++h)if(a[h]){var d=f.dense?(e[t]||[])[h]:e[a[h]+u];if(null==d)c="";else if(null!=d.v){l=!1,c=""+kt(d,null,f);for(var v=0,p=0;v!==c.length;++v)if((p=c.charCodeAt(v))===n||p===i||34===p){c='"'+c.replace(Km,'""')+'"';break}"ID"==c&&(c='"ID"')}else null==d.f||d.F?c="":(l=!1,(c="="+d.f).indexOf(",")>=0&&(c='"'+c.replace(Km,'""')+'"'));o.push(c)}return!1===f.blankrows&&l?null:o.join(s)}function $m(e,r){var t=[],a=null==r?{}:r;if(null==e||null==e["!ref"])return"";var n=gt(e["!ref"]),i=void 0!==a.FS?a.FS:",",s=i.charCodeAt(0),f=void 0!==a.RS?a.RS:"\n",l=f.charCodeAt(0),o=new RegExp(("|"==i?"\\|":i)+"+$"),c="",u=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],d=a.skipHidden&&e["!rows"]||[],v=n.s.c;v<=n.e.c;++v)(h[v]||{}).hidden||(u[v]=ct(v));for(var p=n.s.r;p<=n.e.r;++p)(d[p]||{}).hidden||null!=(c=Ym(e,n,p,u,s,l,i,a))&&(a.strip&&(c=c.replace(o,"")),t.push(c+f));return delete a.dense,t.join("")}function Zm(e,r){r||(r={}),r.FS="\t",r.RS="\n";var t=$m(e,r);if("undefined"==typeof cptable||"string"==r.type)return t;var a=cptable.utils.encode(1200,t,"str");return String.fromCharCode(255)+String.fromCharCode(254)+a}function Qm(e){var r="",t,a="";if(null==e||null==e["!ref"])return[];var n=gt(e["!ref"]),i="",s=[],f,l=[],o=Array.isArray(e);for(f=n.s.c;f<=n.e.c;++f)s[f]=ct(f);for(var c=n.s.r;c<=n.e.r;++c)for(i=st(c),f=n.s.c;f<=n.e.c;++f)if(r=s[f]+i,a="",void 0!==(t=o?(e[c]||[])[f]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;a=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)a=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)a=""+t.v;else if("b"==t.t)a=t.v?"TRUE":"FALSE";else if(void 0!==t.w)a="'"+t.w;else{if(void 0===t.v)continue;a="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=r+"="+a}return l}function Jm(e,r,t){var a=t||{},n=+!a.skipHeader,i=e||{},s=0,f=0,o;if(i&&null!=a.origin)if("number"==typeof a.origin)s=a.origin;else{var l="string"==typeof a.origin?vt(a.origin):a.origin;s=l.r,f=l.c}var c={s:{c:0,r:0},e:{c:f,r:s+r.length-1+n}};if(i["!ref"]){var u=gt(i["!ref"]);c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==s&&(s=c.e.r+1,c.e.r=s+r.length-1+n)}var h=a.header||[],d=0;r.forEach((function(e,r){K(e).forEach((function(t){-1==(d=h.indexOf(t))&&(h[d=h.length]=t);var l=e[t],c="z",u="",v=pt({c:f+d,r:s+r+n});o=eb.sheet_get_cell(i,v),!l||"object"!=typeof l||l instanceof Date?("number"==typeof l?c="n":"boolean"==typeof l?c="b":"string"==typeof l?c="s":l instanceof Date&&(c="d",a.cellDates||(c="n",l=re(l)),u=a.dateNF||F._table[14]),o?(o.t=c,o.v=l,delete o.w,delete o.R,u&&(o.z=u)):i[v]=o={t:c,v:l},u&&(o.z=u)):i[v]=l}))})),c.e.c=Math.max(c.e.c,f+h.length-1);var v=st(s);if(n)for(d=0;d<h.length;++d)i[ct(d+f)+v]={t:"s",v:h[d]};return i["!ref"]=bt(c),i}function qm(e,r){return Jm(null,e,r)}var eb={encode_col:ct,encode_row:st,encode_cell:pt,encode_range:bt,decode_col:ot,decode_row:it,split_cell:dt,decode_cell:vt,decode_range:mt,format_cell:kt,get_formulae:Qm,make_csv:$m,make_json:jm,make_formulae:Qm,sheet_add_aoa:St,sheet_add_json:Jm,aoa_to_sheet:_t,json_to_sheet:qm,table_to_sheet:Yp,table_to_book:$p,sheet_to_csv:$m,sheet_to_txt:Zm,sheet_to_json:jm,sheet_to_html:Kp.from_sheet,sheet_to_formulae:Qm,sheet_to_row_object_array:jm};!function(e){function r(r){r.forEach((function(r){e.consts[r[0]]=r[1]}))}function t(e,r,t){return null!=e[r]?e[r]:e[r]=t}function a(e,r,t){if("string"==typeof r){if(Array.isArray(e)){var n=vt(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return a(e,pt("number"!=typeof r?r:{r:r,c:t||0}))}function n(e,r){if("number"==typeof r){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}if("string"==typeof r){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}throw new Error("Cannot find sheet |"+r+"|")}e.consts=e.consts||{},e.sheet_get_cell=a,e.book_new=function(){return{SheetNames:[],Sheets:{}}},e.book_append_sheet=function(e,r,t){if(!t)for(var a=1;a<=65535&&-1!=e.SheetNames.indexOf(t="Sheet"+a);++a);if(!t)throw new Error("Too many worksheets");if(fv(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");e.SheetNames.push(t),e.Sheets[t]=r},e.book_set_sheet_visibility=function(e,r,a){t(e,"Workbook",{}),t(e.Workbook,"Sheets",[]);var i=n(e,r);switch(t(e.Workbook.Sheets,i,{}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[i].Hidden=a},r([["SHEET_VISIBLE",0],["SHEET_HIDDEN",1],["SHEET_VERY_HIDDEN",2]]),e.cell_set_number_format=function(e,r){return e.z=r,e},e.cell_set_hyperlink=function(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e},e.cell_set_internal_link=function(r,t,a){return e.cell_set_hyperlink(r,"#"+t,a)},e.cell_add_comment=function(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})},e.sheet_set_array_formula=function(e,r,t){for(var n="string"!=typeof r?r:gt(r),i="string"==typeof r?r:bt(r),s=n.s.r;s<=n.e.r;++s)for(var f=n.s.c;f<=n.e.c;++f){var l=a(e,s,f);l.t="n",l.F=i,delete l.v,s==n.s.r&&f==n.s.c&&(l.f=t)}return e}}(eb),w&&"undefined"!=typeof require&&function(){var r={}.Readable,t=function(e,t){var a=r(),n=null==t?{}:t;if(null==e||null==e["!ref"])return a.push(null),a;var i=gt(e["!ref"]),s=void 0!==n.FS?n.FS:",",f=s.charCodeAt(0),l=void 0!==n.RS?n.RS:"\n",o=l.charCodeAt(0),c=new RegExp(("|"==s?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(d[p]||{}).hidden||(h[p]=ct(p));var m=i.s.r,b=!1;return a._read=function(){if(!b)return b=!0,a.push("\ufeff");for(;m<=i.e.r;)if(++m,!(v[m-1]||{}).hidden&&null!=(u=Ym(e,i,m-1,h,f,o,s,n))){n.strip&&(u=u.replace(c,"")),a.push(u+l);break}return m>i.e.r?a.push(null):void 0},a},a=function(e,t){var a=r(),n=t||{},i=null!=n.header?n.header:Kp.BEGIN,s=null!=n.footer?n.footer:Kp.END;a.push(i);var f=mt(e["!ref"]);n.dense=Array.isArray(e),a.push(Kp._preamble(e,f,n));var l=f.s.r,o=!1;return a._read=function(){if(l>f.e.r)return o||(o=!0,a.push("</table>"+s)),a.push(null);for(;l<=f.e.r;){a.push(Kp._row(e,f,l,n)),++l;break}},a},n=function(e,t){var a=r({objectMode:!0});if(null==e||null==e["!ref"])return a.push(null),a;var n={t:"n",v:0},i=0,s=1,f=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},h=null!=u.range?u.range:e["!ref"];switch(1===u.header?i=1:"A"===u.header?i=2:Array.isArray(u.header)&&(i=3),typeof h){case"string":c=gt(h);break;case"number":(c=gt(e["!ref"])).s.r=h;break;default:c=h}i>0&&(s=0);var d=st(c.s.r),v=[],p=0,m=Array.isArray(e),b=c.s.r,g=0,w=0;for(m&&!e[b]&&(e[b]=[]),g=c.s.c;g<=c.e.c;++g)switch(v[g]=ct(g),n=m?e[b][g]:e[v[g]+d],i){case 1:f[g]=g-c.s.c;break;case 2:f[g]=v[g];break;case 3:f[g]=u.header[g-c.s.c];break;default:for(null==n&&(n={w:"__EMPTY",t:"s"}),o=l=kt(n,null,u),p=0,w=0;w<f.length;++w)f[w]==o&&(o=l+"_"+ ++p);f[g]=o}return b=c.s.r+s,a._read=function(){if(b>c.e.r)return a.push(null);for(;b<=c.e.r;){var r=Gm(e,c,b,v,i,f,m,u);if(++b,!1===r.isempty||(1===i?!1!==u.blankrows:u.blankrows)){a.push(r.row);break}}},a};e.stream={to_json:n,to_html:a,to_csv:t}}(),void 0!==Cp&&(e.parse_xlscfb=Cp),e.parse_zip=Sm,e.read=Fm,e.readFile=Om,e.readFileSync=Om,e.write=Wm,e.writeFile=Vm,e.writeFileSync=Vm,e.writeFileAsync=Xm,e.utils=eb,e.SSF=F,void 0!==z&&(e.CFB=z)}"undefined"!=typeof exports?make_xlsx_lib(exports):"undefined"!=typeof module&&module.exports?make_xlsx_lib(module.exports):"function"==typeof define&&define.amd?define("xlsx",[],(function(){return XLSX.version||make_xlsx_lib(XLSX),XLSX})):make_xlsx_lib(XLSX);var XLS=XLSX,ODS=XLSX;class UpLoad{constructor(plot,name,rulerGroup){var self=this;this.cb=null,this.reset=function(inputDiv){inputDiv[0].value=""},this.setInputElement=function(inputDiv){Static.bind("itemAttached",(function(e,plotItem,on){plotItem.rtti>Static.Rtti_PlotMarker&&plotItem.rtti<Static.Rtti_PlotShape&&$("#fileInput").val().includes(plotItem.title())&&!on&&self.reset($("#fileInput"))})),inputDiv.change((function(evt){for(var files=evt.target.files,i=0,f;f=files[i];i++){var fileExtension=f.name.split(".")[1];if("txt"==fileExtension||"xls"==fileExtension||"xlsx"==fileExtension||"plt"==fileExtension){var reader=new FileReader;reader.onload=function(theFile){return function(e){self.cb?self.cb({fileName:theFile.name,content:e.target.result}):console.log({fileName:theFile.name,content:e.target.result})}}(f),"xls"==fileExtension||"xlsx"==fileExtension?reader.readAsBinaryString(f):reader.readAsText(f)}}}))}}}define("upload",(function(){}));class MFile{constructor(plot){let Upload=new UpLoad,self=this,_plot=null;function get_plotData(){let data=[],p={};p.bottomScaleEngineType=_plot.axisScaleEngine(xBottom).toString(),p.leftScaleEngineType=_plot.axisScaleEngine(yLeft).toString(),p.topScaleEngineType=_plot.axisScaleEngine(xTop).toString(),p.rightScaleEngineType=_plot.axisScaleEngine(yRight).toString(),p.title=_plot.title(),p.titleFont=_plot.titleFont(),p.footer=_plot.footer(),p.footerFont=_plot.footerFont(),p.axisTitleFont=_plot.axisTitleFont(xBottom),p.xBottomAxisTitle=_plot.axisTitle(xBottom),p.xTopAxisTitle=_plot.axisTitle(xTop),p.yLeftAxisTitle=_plot.axisTitle(yLeft),p.yRightAxisTitle=_plot.axisTitle(yRight),p.autoScale=_plot.axisAutoScale(xBottom),p.autoScale||(p.xBottomMin=_plot.axisInterval(xBottom).minValue(),p.xBottomMax=_plot.axisInterval(xBottom).maxValue(),p.yLeftMin=_plot.axisInterval(yLeft).minValue(),p.yLeftMax=_plot.axisInterval(yLeft).maxValue(),p.xTopMin=_plot.axisInterval(xTop).minValue(),p.xTopMax=_plot.axisInterval(xTop).maxValue(),p.yRightMin=_plot.axisInterval(yRight).minValue(),p.yRightMax=_plot.axisInterval(yRight).maxValue()),data.push(p);let list=_plot.itemList(Static.Rtti_PlotCurve);for(let i=0;i<list.length;++i){let d={};d.rtti=Static.Rtti_PlotCurve,d.title=list[i].title();const fn=list[i].fn;fn?d.functionDlgData=list[i].functionDlgData:d.samples=list[i].data().samples(),d.fn=list[i].fn,d.pen=list[i].pen(),d.fitType=list[i].fitType,d.equation=list[i].equation;let sym=list[i].symbol();d.symbolType=NoSymbol,sym&&(d.symbolType=sym.style(),d.symbolWidth=sym.size().width,d.symbolPenColor=sym.pen().color,d.symbolPenWidth=sym.pen().width,d.symbolBrushColor=sym.brush().color),d.style=list[i].style(),d.xAxis=list[i].xAxis(),d.yAxis=list[i].yAxis(),data.push(d)}list=_plot.itemList(Static.Rtti_PlotMarker),list=_.filter(list,(function(item){return void 0===item.rulers&&"ClosestPointMarker123@###"!==item.title()&&"cgMarker@12345"!==item.title()}));for(let i=0;i<list.length;++i){let d={};d.title=list[i].title(),d.rtti=Static.Rtti_PlotMarker,d.label=list[i].label(),d.x=list[i].xValue(),d.y=list[i].yValue(),d.labelAlignment=list[i].labelAlignment(),d.labelOrientation=list[i].labelOrientation(),d.labelFont=list[i].labelFont(),d.lineStyle=list[i].lineStyle(),d.linePen=list[i].linePen();let sym=list[i].symbol();sym&&(d.type=sym.type,d.symbolType=sym.style(),d.symbolWidth=sym.size().width,d.symbolHeight=sym.size().height,d.symbolPenColor=sym.pen().color,d.symbolPenWidth=sym.pen().width,d.symbolBrushColor=sym.brush().color,d.rotation=sym.rotation&&sym.rotation()),d.xAxis=list[i].xAxis(),d.yAxis=list[i].yAxis(),data.push(d)}list=_plot.itemList(Static.Rtti_PlotSpectroCurve);for(let i=0;i<list.length;++i){let d={};d.title=list[i].title(),d.rtti=Static.Rtti_PlotSpectroCurve;const fn=list[i].fn;fn?d.functionDlgData=list[i].functionDlgData:d.samples=list[i].data().samples(),d.color1=list[i].color1(),d.color2=list[i].color2(),d.minZ=list[i].minZ,d.maxZ=list[i].maxZ,d.fn=list[i].fn,d.penWidth=list[i].penWidth(),d.xAxis=list[i].xAxis(),d.yAxis=list[i].yAxis(),data.push(d)}list=_plot.itemList(Static.Rtti_PlotSpectrogram);for(let i=0;i<list.length;++i){let d={};d.title=list[i].title(),d.rtti=Static.Rtti_PlotSpectrogram;const fn=list[i].fn;fn&&(d.functionDlgData=list[i].functionDlgData),d.fn=list[i].fn,d.upload=list[i].upload,d.spectrogramData=list[i].spectrogramData;const colorMap=list[i].colorMap();d.color1=colorMap.color1(),d.color2=colorMap.color2(),d.showContour=list[i].testDisplayMode(Enum.DisplayMode.ContourMode),d.showSpectrogram=list[i].testDisplayMode(Enum.DisplayMode.ImageMode),d.numberOfContourPlanes=list[i].numberOfContourPlanes(),data.push(d)}return data}function saveData(data,fileName){let a=document.createElement("a");document.body.appendChild(a),a.style="display: none";let json=JSON.stringify(data),blob=new Blob([json],{type:"octet/stream"}),url=window.URL.createObjectURL(blob);a.href=url,a.download=fileName,a.click(),window.URL.revokeObjectURL(url)}function plt(data){let obj=JSON.parse(data.content),p=obj[0];"[LogScaleEngine]"==p.rightScaleEngineType&&_plot.setAxisScaleEngine(yRight,new LogScaleEngine),"[LogScaleEngine]"==p.leftScaleEngineType&&_plot.setAxisScaleEngine(yLeft,new LogScaleEngine),"[LogScaleEngine]"==p.bottomScaleEngineType&&_plot.setAxisScaleEngine(xBottom,new LogScaleEngine),"[LogScaleEngine]"==p.topScaleEngineType&&_plot.setAxisScaleEngine(xTop,new LogScaleEngine),"[LinearScaleEngine]"==p.rightScaleEngineType&&_plot.setAxisScaleEngine(yRight,new LinearScaleEngine),"[LinearScaleEngine]"==p.leftScaleEngineType&&_plot.setAxisScaleEngine(yLeft,new LinearScaleEngine),"[LinearScaleEngine]"==p.bottomScaleEngineType&&_plot.setAxisScaleEngine(xBottom,new LinearScaleEngine),"[LinearScaleEngine]"==p.topScaleEngineType&&_plot.setAxisScaleEngine(xTop,new LinearScaleEngine),p.autoScale?Utility.setAutoScale(_plot,!0):(_plot.setAxisScale(xBottom,p.xBottomMin,p.xBottomMax),_plot.setAxisScale(yLeft,p.yLeftMin,p.yLeftMax),_plot.setAxisScale(xTop,p.xTopMin,p.xTopMax),_plot.setAxisScale(yRight,p.yRightMin,p.yRightMax)),_plot.setTitleFont(new Misc.Font(p.titleFont)),_plot.setFooterFont(new Misc.Font(p.footerFont)),_plot.setAxisTitleFont(xBottom,new Misc.Font(p.axisTitleFont)),_plot.setAxisTitleFont(xTop,new Misc.Font(p.axisTitleFont)),_plot.setAxisTitleFont(yLeft,new Misc.Font(p.axisTitleFont)),_plot.setAxisTitleFont(yRight,new Misc.Font(p.axisTitleFont)),_plot.setTitle(p.title),_plot.setFooter(p.footer),_plot.setAxisTitle(xBottom,p.xBottomAxisTitle),_plot.setAxisTitle(xTop,p.xTopAxisTitle),_plot.setAxisTitle(yLeft,p.yLeftAxisTitle),_plot.setAxisTitle(yRight,p.yRightAxisTitle);for(let i=1;i<obj.length;++i)if(obj[i].rtti==Static.Rtti_PlotCurve&&_plot.findPlotCurve(obj[i].title))return Static.alert(obj[i].title+" already exist"),void Upload.reset($("#fileInput"));for(let i=1;i<obj.length;++i){if(obj[i].rtti==Static.Rtti_PlotCurve){let curve=null;if(obj[i].fn?curve=_plot.functionDlgCb(obj[i].functionDlgData):(curve=_plot.createCurve(obj[i].rtti,obj[i].title),curve.setSamples(Utility.pointsFromXYObjectArray(obj[i].samples))),obj[i].symbolType!==NoSymbol){let sym=new Symbol;sym.setStyle(obj[i].symbolType),sym.setSize(new Misc.Size(obj[i].symbolWidth,obj[i].symbolWidth)),sym.setPen(new Misc.Pen(obj[i].symbolPenColor,obj[i].symbolPenWidth)),sym.setBrush(new Misc.Brush(obj[i].symbolBrushColor)),curve.setSymbol(sym)}if(curve.setStyle(obj[i].style),obj[i].fitType&&(curve.fitType=obj[i].fitType,curve.equation=obj[i].equation),"natural"==obj[i].fitType||"periodic"==obj[i].fitType){let f=new SplineCurveFitter,s=f.spline();"periodic"==obj[i].fitType?s.setSplineType(Static.SplineType.Periodic):s.setSplineType(Static.SplineType.Natural),curve.setCurveFitter(f)}curve.setPen(new Misc.Pen(obj[i].pen.color,obj[i].pen.width,obj[i].pen.style)),curve.setAxes(obj[i].xAxis,obj[i].yAxis),curve.attach(_plot)}if(obj[i].rtti==Static.Rtti_PlotSpectroCurve){let curve=null;obj[i].fn?curve=_plot.functionDlgCb(obj[i].functionDlgData):(curve=_plot.createCurve(obj[i].rtti,obj[i].title),curve.setSamples(obj[i].samples)),curve.setPenWidth(obj[i].penWidth),curve.setColorInterval(obj[i].color1,obj[i].color2),curve.setColorRange(new Interval(obj[i].minZ,obj[i].maxZ)),curve.minZ=obj[i].minZ,curve.maxZ=obj[i].maxZ,curve.attach(_plot)}if(obj[i].rtti==Static.Rtti_PlotSpectrogram){let curve=null;if(obj[i].fn)curve=_plot.functionDlgCb(obj[i].functionDlgData),curve.setNumberOfContourPlanes(obj[i].numberOfContourPlanes),curve.showContour(obj[i].showContour),curve.showSpectrogram(obj[i].showSpectrogram);else{const displayData={title:obj[i].title,color1:obj[i].color1,color2:obj[i].color2,showContour:obj[i].showContour,showSpectrogram:obj[i].showSpectrogram,numberOfContourPlanes:obj[i].numberOfContourPlanes};_plot.uploadSpectrogram(displayData,obj[i].spectrogramData,obj[i].upload)}}if(obj[i].rtti==Static.Rtti_PlotMarker){let marker=_plot.createCurve(obj[i].rtti,obj[i].title);if(obj[i].symbolType!==NoSymbol){let sym=null;obj[i].type&&"arrow"===obj[i].type?sym=new ArrowSymbol:obj[i].type&&"dotOnLine"===obj[i].type&&(sym=new DotOnLineSymbol),sym&&(sym.setSize(new Misc.Size(obj[i].symbolWidth,obj[i].symbolHeight)),sym.setRotation&&sym.setRotation(obj[i].rotation),sym.setPen(new Misc.Pen(obj[i].symbolPenColor,obj[i].symbolPenWidth)),sym.setBrush(new Misc.Brush(obj[i].symbolBrushColor)),marker.setSymbol(sym)),marker.setLineStyle(obj[i].lineStyle),marker.setLinePen(new Misc.Pen(obj[i].linePen.color,obj[i].linePen.width,obj[i].linePen.style)),marker.setAxes(obj[i].xAxis,obj[i].yAxis),marker.setValue(obj[i].x,obj[i].y),marker.setLabel(obj[i].label),marker.setLabelAlignment(obj[i].labelAlignment),marker.setLabelOrientation(obj[i].labelOrientation),marker.setLabelFont(new Misc.Font(obj[i].labelFont.th,obj[i].labelFont.name,obj[i].labelFont.style,obj[i].labelFont.weight,obj[i].labelFont.fontColor)),marker.attach(_plot)}}}Upload.reset($("#fileInput"))}this.getPlotData=function(){const _data=get_plotData();return JSON.stringify(_data)},this.setPlotData=function(data){this.upload(data)},this.init=function(plot){_plot=plot,Upload.cb=this.upload},this.setInputElement=function(el){Upload.setInputElement(el)},this.upload=function(data){let extension=data.fileName.split(".")[1];if("xls"==extension||"xlsx"==extension||"txt"==extension||"tbl"==extension){let samples=null,csvArray=null;if("xls"==extension||"xlsx"==extension){let workbook=XLSX.read(data.content,{type:"binary"}),firstSheet=workbook.SheetNames[0];csvArray=Utility.toArrays(XLSX.utils.sheet_to_csv(workbook.Sheets[firstSheet]))}else csvArray=Utility.toArrays(data.content);if(!csvArray.dataType)if(csvArray.array.length&&csvArray.array[0].hasOwnProperty("z")){let tempArray=[];for(let i=0;i<csvArray.array.length;i++)tempArray.push(csvArray.array[i].x);tempArray.length===_.uniq(tempArray).length?csvArray.dataType="spectrocurve":csvArray.dataType="spectrogram"}else csvArray.dataType="curve";if("curve"===csvArray.dataType){let samples=Utility.makePoints(csvArray.array);Static.trigger("addCurve",[data.fileName,samples,!0])}else"spectrocurve"===csvArray.dataType?Static.trigger("addSpectrocurve",[data.fileName,csvArray,!0]):"spectrogram"===csvArray.dataType&&Static.trigger("addSpectrogram",[data.fileName,csvArray,!0])}else if("plt"==extension){let sideBarHidden=!1;_plot.rightSidebar.isSideBarVisible()&&(_plot.rightSidebar.showSidebar(!1),sideBarHidden=!0);let list=_plot.itemList(Static.Rtti_PlotCurve),list2=_plot.itemList(Static.Rtti_PlotMarker),list3=_plot.itemList(Static.Rtti_PlotSpectroCurve),list4=_plot.itemList(Static.Rtti_PlotSpectrogram);list2=_.filter(list2,(function(item){return void 0===item.rulers&&"ClosestPointMarker123@###"!==item.title()&&"cgMarker@12345"!==item.title()})),list=list.concat(list2),list=list.concat(list3),list=list.concat(list4),list.length?Static.alertYesNo("Do you want to save the changes to the Grapher?",(function(answer){if(answer==Static.Cancel)return Upload.reset($("#fileInput")),void(sideBarHidden&&_plot.rightSidebar.showSidebar(!0));if(answer!=Static.Yes){if(answer==Static.No){for(let i=0;i<list.length;++i)list[i].detach();return plt(data),void(sideBarHidden&&_plot.rightSidebar.showSidebar(!0))}}else{self.save(),Upload.reset($("#fileInput"));for(let i=0;i<list.length;++i)list[i].detach();plt(data)}})):plt(data)}},this.save=function(){Static.prompt("Enter a filename without extensions","plot_1",(function(filename){let data;return filename+=".plt",saveData(get_plotData(),filename),!0}),"small")},this.init(plot)}}define("file",["xlsx","upload"],(function(){}));class Watch{constructor(rulerGroup,dependentRuler){var self=this;this._dependentRuler=dependentRuler||Static.NoRuler,this._rulerGroup=rulerGroup;var _enable=!0;this._curveName="",this._curve=null,this._rulerLeft=Number.MAX_VALUE,this._rulerRight=Number.MAX_VALUE,this._rulerBottom=Number.MAX_VALUE,this._rulerTop=Number.MAX_VALUE,this._value,this._magnifying=!1,this._rulerLeftPrevious=Number.MAX_VALUE,this._rulerRightPrevious=Number.MAX_VALUE,Static.bind("invalidateWatch",(function(){self._rulerLeftPrevious=Number.MAX_VALUE,self._rulerRightPrevious=Number.MAX_VALUE})),Static.bind("magnifyingStart",(function(){self._magnifying=!0})),Static.bind("magnifyingEnd",(function(){self._magnifying=!1,Static.trigger("positionChanged")})),this.name=function(){},this.computeWatch=function(){},this.value=function(){return this._value},this.setCurveName=function(curveName){this._curveName=curveName},this.setCurve=function(curve){this._curve=curve},this.setRulerLeft=function(val){this._rulerLeft=val},this.setRulerRight=function(val){this._rulerRight=val},this.setRulerBottom=function(val){this._curve&&this._curve.plot()&&(val=Static.adjustForDecimalPlaces(val,this._curve.plot().axisDecimalPlaces(this._curve.yAxis()))),this._rulerBottom=val},this.setRulerTop=function(val){this._curve&&this._curve.plot()&&(val=Static.adjustForDecimalPlaces(val,this._curve.plot().axisDecimalPlaces(this._curve.yAxis()))),this._rulerTop=val},this.setEnable=function(set){_enable=set,Static.trigger("watchEnabled",[this,set])},this.isEnable=function(){return _enable}}}define("watch",(function(){}));var MoveToElement=0,LineToElement=1,CurveToElement=2,CurveToDataElement=3,Misc={};Misc.EPSILON=Number.MIN_VALUE,Misc.Image=function(w,h){var _w=w,_h=h,_colorTable=null;"object"==typeof w&&_.has(w,"width")&&_.has(w,"height")&&(_w=w.width,_h=w.height),null==w&&(_w=0,_h=0);var cnvs,m_ctx=$("<canvas/>")[0].getContext("2d"),m_data=null;0!==_w&&0!==_h&&(m_data=m_ctx.createImageData(_w,_h)),this.data=function(){return m_data.data},this.scaleImageData=function(scale){if(m_data){for(var scaled=m_ctx.createImageData(m_data.width*scale,m_data.height*scale),subLine=m_ctx.createImageData(scale,1).data,row=0;row<m_data.height;row++)for(var col=0;col<m_data.width;col++){for(var sourcePixel=m_data.data.subarray(4*(row*m_data.width+col),4*(row*m_data.width+col)+4),x=0;x<scale;x++)subLine.set(sourcePixel,4*x);for(var y=0;y<scale;y++){var destRow=row*scale+y,destCol=col*scale;scaled.data.set(subLine,4*(destRow*scaled.width+destCol))}}m_data=scaled}},this.imageData=function(){return m_data},this.setImageData=function(d){m_data=d},this.width=function(){return _w},this.height=function(){return _h},this.size=function(){return new Misc.Size(_w,_h)},this.isNull=function(){return null==m_data},this.copy=function(){var res=new Misc.Image(this.width(),this.height()),imageDataCopy=new ImageData(new Uint8ClampedArray(this.imageData().data),this.imageData().width,this.imageData().height);return res.setImageData(imageDataCopy),res},this.setAlpha=function(a){var data=m_data.data,i,len=data.length;for(i=3;i<len;i+=4)data[i]=a},this.setPixel=function(x,y,rgba){"number"==typeof rgba&&(rgba=_colorTable[Math.round(rgba)]);var redAddress=y*(4*_w)+4*x;m_data.data[redAddress]=rgba.r,m_data.data[redAddress+1]=rgba.g,m_data.data[redAddress+2]=rgba.b,m_data.data[redAddress+3]=255,rgba.a&&(rgba.a>255&&(rgba.a=255),rgba.a<0&&(rgba.a=0),m_data.data[redAddress+3]=rgba.a)},this.setColorTable=function(ct){_colorTable=ct},this.pixel=function(x,y){if(null==y&&_colorTable)return _colorTable[Math.round(x)];var redAddress=y*(4*_w)+4*x;return{r:m_data.data[redAddress],g:m_data.data[redAddress+1],b:m_data.data[redAddress+2],a:m_data.data[redAddress+3]}}},Misc.Pen=function(c,w,s){if("object"==typeof c)return new Misc.Pen(c.color,c.width,c.style);this.color="black",this.width=1,this.style="solid",c!=Static.NoPen&&s!=Static.NoPen||(this.style=Static.NoPen),void 0!==s&&(this.style=s),void 0!==w&&(this.width=w),void 0!==c&&(this.color=c)},Misc.Pen.prototype.toString=function(){return"[color:"+this.color+", width:"+this.width+", style:"+this.style+"]"},Misc.Pen.prototype.isEqual=function(otherPen){return null!=otherPen&&(this.color==otherPen.color&&this.style==otherPen.style&&this.width==otherPen.width)},Misc.Brush=function(type){this.color=Static.NoBrush,void 0!==type&&(this.color=type)},Misc.Brush.prototype.toString=function(){return"[Brush: "+this.color+"]"},Misc.Brush.prototype.isEqual=function(otherBrush){return this.color==otherBrush.color},Misc.Line=function(point1,point2){var m_p1=point1,m_p2=point2;this.p1=function(){return m_p1},this.p2=function(){return m_p2}},Misc.Line.prototype.x1=function(){return this.p1().x},Misc.Line.prototype.x2=function(){return this.p2().x},Misc.Line.prototype.y1=function(){return this.p1().y},Misc.Line.prototype.y2=function(){return this.p2().y},Misc.Line.prototype.x2=function(){return this.p2().x},Misc.Line.prototype.length=function(){return Math.sqrt((this.p2().x-this.p1().x)*(this.p2().x-this.p1().x)+(this.p2().y-this.p1().y)*(this.p2().y-this.p1().y))},Misc.Size=function(w,h){w instanceof Misc.Size&&(h=w.height,w=w.width),this.width=0,this.height=0,void 0!==h&&(this.width=w,this.height=h)},Misc.Size.prototype.isValid=function(){return!(this.width<0||this.height<0)},Misc.Size.prototype.isEmpty=function(){return this.width<=0||this.height<=0},Misc.Size.prototype.copy=function(){return new Misc.Size(this.width,this.height)},Misc.Size.prototype.isEqual=function(size){var x=this.width-size.width,y=this.height-size.height;return x*x+y*y<Misc.EPSILON},Misc.Size.prototype.expandedTo=function(otherSize){return new Misc.Size(Math.max(this.width,otherSize.width),Math.max(this.height,otherSize.height))},Misc.Size.prototype.boundedTo=function(otherSize){return new Misc.Size(Math.min(this.width,otherSize.width),Math.min(this.height,otherSize.height))},Misc.Size.prototype.toString=function(){return"["+this.width+", "+this.height+"]"},Misc.Point=function(x,y){this.x=0,this.y=0,void 0!==y&&(this.y=y),void 0!==x&&(this.x=x)},Misc.Point.prototype.interpolatedPoint=function(pt,xVal){if(xVal==pt.x)return pt;if(xVal==this.x)return this;var yVal=(this.y-pt.y)/(this.x-pt.x)*(xVal-pt.x)+pt.y;return new Misc.Point(xVal,yVal)},Misc.Point.prototype.logInterpolatedPoint=function(pt,xVal){if(xVal==pt.x)return pt;if(xVal==this.x)return this;var yVal=(this.y-pt.y)/(math.log(this.x,10)-math.log(pt.x,10))*(math.log(xVal,10)-math.log(pt.x,10))+pt.y;return new Misc.Point(xVal,yVal)},Misc.Point.prototype.isEqual=function(pt){var x=this.x-pt.x,y=this.y-pt.y;return x*x+y*y<Misc.EPSILON},Misc.Point.prototype.toString=function(){return"("+this.x+", "+this.y+")"},Misc.Rect=function(param1,param2,param3,param4){var m_left=0,m_top=0,m_right=-1,m_bottom=-1,m_width=-1,m_height=-1;void 0!==param4?(m_right=(m_left=param1)+(m_width=param3),m_bottom=(m_top=param2)+(m_height=param4)):void 0!==param3?(m_left=param1.x,m_top=param1.y,m_right=m_left+(m_width=param2),m_bottom=m_top+(m_height=param3)):void 0!==param2&&(m_left=param1.x,m_top=param1.y,void 0!==param2.x?(m_right=param2.x,m_bottom=param2.y,m_width=m_right-m_left,m_height=m_bottom-m_top):(m_width=param2.width,m_height=param2.height,m_right=m_left+m_width,m_bottom=m_top+m_height)),this.left=function(){return m_left},this.setLeft=function(val){m_left!==val&&(m_width=m_right-(m_left=val))},this.top=function(){return m_top},this.setTop=function(val){m_top!==val&&(m_height=m_bottom-(m_top=val))},this.right=function(){return m_right},this.setRight=function(val){m_right!==val&&(m_width=(m_right=val)-m_left)},this.bottom=function(){return m_bottom},this.setBottom=function(val){m_bottom!==val&&(m_height=(m_bottom=val)-m_top)},this.width=function(){return m_width},this.height=function(){return m_height}},Misc.Rect.prototype.setWidth=function(val){this.width()!==val&&this.setRight(this.left()+val)},Misc.Rect.prototype.isValid=function(){return!(this.width()<=0||this.height()<=0)},Misc.Rect.prototype.copy=function(){return new Misc.Rect(this.left(),this.top(),this.width(),this.height())},Misc.Rect.prototype.setHeight=function(val){this.height()!==val&&this.setBottom(this.top()+val)},Misc.Rect.prototype.adjust=function(dx1,dy1,dx2,dy2){this.setLeft(this.left()+dx1),this.setTop(this.top()+dy1),this.setRight(this.right()+dx2),this.setBottom(this.bottom()+dy2)},Misc.Rect.prototype.size=function(){return new Misc.Size(this.width(),this.height())},Misc.Rect.prototype.setSize=function(sz){this.setWidth(sz.width),this.setHeight(sz.height)},Misc.Rect.prototype.setRect=function(x,y,width,height){this.setLeft(x),this.setTop(y),this.setWidth(width),this.setHeight(height)},Misc.Rect.prototype.united=function(rect){return new Misc.Rect(Math.min(this.left(),rect.left()),Math.min(this.top(),rect.top()),Math.max(this.right(),rect.right())-Math.min(this.left(),rect.left()),Math.max(this.bottom(),rect.bottom())-Math.min(this.top(),rect.top()))},Misc.Rect.prototype.normalized=function(){var rc=new Misc.Rect(this.left(),this.top(),this.width(),this.height());if(rc.width()<0){var temp=rc.right();rc.setRight(rc.left()),rc.setLeft(temp)}if(this.height()<0){var temp=rc.bottom();rc.setBottom(rc.top()),rc.setTop(temp)}return rc},Misc.Rect.prototype.toRect=function(){return new Misc.Rect(Math.round(this.left()),Math.round(this.top()),Math.round(this.width()),Math.round(this.height()))},Misc.Rect.prototype.center=function(){return new Misc.Point(.5*(this.left()+this.right()),.5*(this.top()+this.bottom()))},Misc.Rect.prototype.moveTopLeft=function(pt){var w=this.width(),h=this.height();this.setLeft(pt.x),this.setTop(pt.y),this.setRight(pt.x+w),this.setBottom(pt.y+h)},Misc.Rect.prototype.moveBottomRight=function(pt){var w=this.width(),h=this.height();this.setRight(pt.x),this.setBottom(pt.y),this.setLeft(pt.x-w),this.setTop(pt.y-h)},Misc.Rect.prototype.moveCenter=function(pt){var w=this.width(),h=this.height();this.setRight(pt.x+.5*w),this.setBottom(pt.y+.5*h),this.setLeft(pt.x-.5*w),this.setTop(pt.y-.5*h)},Misc.Rect.prototype.intersects=function(rect){var xmin=Math.max(this.left(),rect.left()),xmax1=this.left()+this.width(),xmax2=rect.left()+rect.width(),xmax;if(Math.min(xmax1,xmax2)>xmin){var ymin=Math.max(this.top(),rect.top()),ymax1=this.top()+this.height(),ymax2=rect.top()+rect.height(),ymax;if(Math.min(ymax1,ymax2)>ymin)return!0}return!1},Misc.Rect.prototype.intersected=function(rect){if(rect.contains(new Misc.Point(this.left(),this.top()),!1)||rect.contains(new Misc.Point(this.right(),this.top()),!1)||rect.contains(new Misc.Point(this.right(),this.bottom()),!1)||rect.contains(new Misc.Point(this.left(),this.bottom()),!1)||this.contains(new Misc.Point(rect.left(),rect.top()),!1)||this.contains(new Misc.Point(rect.right(),rect.top()),!1)||this.contains(new Misc.Point(rect.right(),rect.bottom()),!1)||this.contains(new Misc.Point(rect.left(),rect.bottom()),!1)){var left=Math.max(this.left(),rect.left()),top=Math.max(this.top(),rect.top()),width=Math.min(this.right()-left,rect.right()-left),height=Math.min(this.bottom()-top,rect.bottom()-top);return new Misc.Rect(left,top,width,height)}return new Misc.Rect},Misc.Rect.prototype.adjusted=function(left,top,right,bottom){var pt1=new Misc.Point(this.left()+left,this.top()+top),pt2=new Misc.Point(this.right()+right,this.bottom()+bottom);return new Misc.Rect(pt1,pt2)},Misc.Rect.prototype.contains=function(pt,proper){return void 0===proper||!0===proper?pt.x>this.left()&&pt.y>this.top()&&pt.x<this.right()&&pt.y<this.bottom():pt.x>=this.left()&&pt.y>=this.top()&&pt.x<=this.right()&&pt.y<=this.bottom()},Misc.Rect.prototype.isEqual=function(other){var otherPoint=new Misc.Point(other.left(),other.top());if(new Misc.Point(this.left(),this.top()).isEqual(otherPoint)){var x=this.width()-other.width(),y=this.height()-other.height();return x*x+y*y<Misc.EPSILON}return!1},Misc.Rect.prototype.leftTop=function(){return new Misc.Point(this.left(),this.top())},Misc.Rect.prototype.topLeft=function(){return this.leftTop()},Misc.Rect.prototype.rightTop=function(){return new Misc.Point(this.right(),this.top())},Misc.Rect.prototype.topRight=function(){return new Misc.Point(this.right(),this.top())},Misc.Rect.prototype.leftBottom=function(){return new Misc.Point(this.left(),this.bottom())},Misc.Rect.prototype.rightBottom=function(){return new Misc.Point(this.right(),this.bottom())},Misc.Rect.prototype.bottomRight=function(){return this.rightBottom()},Misc.Rect.prototype.bottomLeft=function(){return this.rightBottom()},Misc.Rect.prototype.toString=function(){return"["+this.left()+", "+this.top()+", "+this.width()+", "+this.height()+"]"},Misc.Rect.prototype.isEmpty=function(){return this.width()<=0||this.height()<=0},Misc.Rect.prototype.x=function(){return this.left()},Misc.Rect.prototype.y=function(){return this.top()},Misc.Polygon=function(rectangle,closed=!1){this.points=[],this.points.push(new Misc.Point(rectangle.left(),rectangle.top()),new Misc.Point(rectangle.right(),rectangle.top()),new Misc.Point(rectangle.right(),rectangle.bottom()),new Misc.Point(rectangle.left(),rectangle.bottom())),close&&this.points.push(new Misc.Point(rectangle.left(),rectangle.top()))},Misc.Polygon.prototype.toString=function(){return"[Polygon]"},Misc.Font=function(th,name,style,weight,color){"object"==typeof th?(this.th=th.th,this.name=th.name,this.style=th.style,this.weight=th.weight,this.fontColor=th.fontColor):(this.th=12,this.name="Arial",this.style="normal",this.weight="normal",this.fontColor="black"),"object"!=typeof th&&(void 0!==color&&(this.fontColor=color),void 0!==weight&&(this.weight=weight),void 0!==style&&(this.style=style),void 0!==name&&(this.name=name),void 0!==th&&(this.th=th))},Misc.Font.prototype.textSize=function(str){if(""==str||void 0===str)return new Misc.Size(0,0);var canvas=$("<canvas />"),context=canvas[0].getContext("2d");context.font=this.weight+" "+this.style+" "+this.th+"px "+this.name;var w=1.16*context.measureText(str).width,h=context.measureText("M").width;return canvas.remove(),new Misc.Size(w,h)},Misc.Font.prototype.toString=function(){return"[th:"+this.th+", name:"+this.name+", style:"+this.style+", weight:"+this.weight+", color:"+this.fontColor+"]"},Misc.MPathElement=function(elementType,xVal,yVal){this.type=MoveToElement,this.x=0,this.y=0,void 0!==xVal&&(this.x=xVal),void 0!==yVal&&(this.y=yVal),void 0!==elementType&&(this.type=elementType)},Misc.MPathElement.prototype.toString=function(){return"[MPathElement: type("+this.type+"), point"+new Misc.Point(this.x,this.y)+"]"},Misc.MPath=function(){var m_elements=[];this.data={},this.elements=function(){return m_elements}},Misc.MPath.prototype.elementCount=function(){return this.elements().length},Misc.MPath.prototype.elementAt=function(index){return index<0||index>=this.elements().length?null:this.elements()[index]},Misc.MPath.prototype.moveTo=function(x,y){this.elements().push(new Misc.MPathElement(MoveToElement,x,y))},Misc.MPath.prototype.lineTo=function(x,y){this.elements().push(new Misc.MPathElement(LineToElement,x,y))},Misc.MPath.prototype.cubicTo=function(x,y,x1,y1,x2,y2){var els=this.elements();els.push(new Misc.MPathElement(CurveToElement,x,y)),els.push(new Misc.MPathElement(CurveToElement,x1,y1)),els.push(new Misc.MPathElement(CurveToElement,x2,y2))},Misc.MPath.prototype.toString=function(){var s;return"[MPath: elementCount = "+this.elements().length+"]"},Misc.MPath.prototype.isEmpty=function(){return 0==this.elements().length},Misc.MPath.prototype.addRect=function(rect){var els=this.elements();els.push(new Misc.MPathElement(MoveToElement,rect.left(),rect.top())),els.push(new Misc.MPathElement(LineToElement,rect.right(),rect.top())),els.push(new Misc.MPathElement(LineToElement,rect.right(),rect.bottom())),els.push(new Misc.MPathElement(LineToElement,rect.left(),rect.bottom())),els.push(new Misc.MPathElement(LineToElement,rect.left(),rect.top()))},Misc.MPath.prototype.addPolygon=function(polygon){if(polygon&&polygon.length){this.elements().push(new Misc.MPathElement(MoveToElement,polygon[0].x,polygon[0].y));for(var i=1;i<polygon.length;++i)this.elements().push(new Misc.MPathElement(LineToElement,polygon[i].x,polygon[i].y))}},Misc.MPath.prototype.addPathElement=function(pathElement){this.elements().push(pathElement)},Misc.MPath.prototype.boundingRect=function(){for(var pts=[],left=0,top=0,right=0,bottom=0,firstPass=!1,i=0;i<this.elements().length;i++){var element=this.elements()[i];switch(element.type){case LineToElement:case MoveToElement:case CurveToElement:firstPass||(left=element.x,top=element.y,right=element.x,bottom=element.y,firstPass=!0),left=Math.min(left,element.x),right=Math.max(right,element.x),top=Math.min(top,element.y),bottom=Math.max(bottom,element.y)}}if(null==this.data.rotation||0==this.data.rotation)return new Misc.Rect(left,top,right-left,bottom-top);let theta=this.data.rotation;theta=theta*Math.PI/180;let w=right-left,h=bottom-top,newHeight=Math.abs(w*Math.sin(theta))+Math.abs(h*Math.cos(theta)),newWidth=Math.abs(h*Math.sin(theta))+Math.abs(w*Math.cos(theta));return new Misc.Rect(left-(newWidth-w)/2,top-(newHeight-h)/2,newWidth,newHeight)},define("miscObjects",(function(){})),
/**
* @license
*
* Regression.JS - Regression functions for javascript
* http://tom-alexander.github.com/regression-js/
*
* copyright(c) 2013 Tom Alexander
* Licensed under the MIT license.
*
* @module regression - Least-squares regression functions for JavaScript
**/
function _umd(global,factory){var returned;returned="function"==typeof define&&define.amd?define("regression",factory):"undefined"!=typeof module?module.exports=factory():global.regression=factory()}(this,(function _regressionUmdFactory(){"use strict";var exports;function determinationCoefficient(observations,predictions){var sum,mean=observations.reduce((function(accum,observation){return accum+observation[1]}),0)/observations.length,ssyy=observations.reduce((function(accum,observation){var diff=observation[1]-mean;return accum+diff*diff}),0),sse;return 1-observations.reduce((function(accum,observation,ix){var prediction=predictions[ix],resid=observation[1]-prediction[1];return accum+resid*resid}),0)/ssyy}function gaussianElimination(matrix,order){var i=0,j=0,k=0,maxrow=0,tmp=0,n=matrix.length-1,coefficients=new Array(order);for(i=0;i<n;i++){for(maxrow=i,j=i+1;j<n;j++)Math.abs(matrix[i][j])>Math.abs(matrix[i][maxrow])&&(maxrow=j);for(k=i;k<n+1;k++)tmp=matrix[k][i],matrix[k][i]=matrix[k][maxrow],matrix[k][maxrow]=tmp;for(j=i+1;j<n;j++)for(k=n;k>=i;k--)matrix[k][j]-=matrix[k][i]*matrix[i][j]/matrix[i][i]}for(j=n-1;j>=0;j--){for(tmp=0,k=j+1;k<n;k++)tmp+=matrix[k][j]*coefficients[k];coefficients[j]=(matrix[n][j]-tmp)/matrix[j][j]}return coefficients}var _DEFAULT_PRECISION=2;function _round(number,precision){var factor=Math.pow(10,precision);return Math.round(number*factor)/factor}var methods={linear:function(data,_order,options){for(var sum=[0,0,0,0,0],results,gradient,intercept,len=data.length,n=0;n<len;n++)null!==data[n][1]&&(sum[0]+=data[n][0],sum[1]+=data[n][1],sum[2]+=data[n][0]*data[n][0],sum[3]+=data[n][0]*data[n][1],sum[4]+=data[n][1]*data[n][1]);return gradient=(len*sum[3]-sum[0]*sum[1])/(len*sum[2]-sum[0]*sum[0]),intercept=sum[1]/len-gradient*sum[0]/len,results=data.map((function(xyPair){var x=xyPair[0];return[x,gradient*x+intercept]})),{r2:determinationCoefficient(data,results),equation:[gradient,intercept],points:results,string:"y = "+_round(gradient,options.precision)+"x + "+_round(intercept,options.precision)}},linearthroughorigin:function(data,_order,options){for(var sum=[0,0],gradient,results,n=0;n<data.length;n++)null!==data[n][1]&&(sum[0]+=data[n][0]*data[n][0],sum[1]+=data[n][0]*data[n][1]);return gradient=sum[1]/sum[0],results=data.map((function(xyPair){var x=xyPair[0];return[x,gradient*x]})),{r2:determinationCoefficient(data,results),equation:[gradient],points:results,string:"y = "+_round(gradient,options.precision)+"x"}},exponential:function(data,_order,options){for(var sum=[0,0,0,0,0,0],denominator,coeffA,coeffB,results,n=0;n<data.length;n++)null!==data[n][1]&&(sum[0]+=data[n][0],sum[1]+=data[n][1],sum[2]+=data[n][0]*data[n][0]*data[n][1],sum[3]+=data[n][1]*Math.log(data[n][1]),sum[4]+=data[n][0]*data[n][1]*Math.log(data[n][1]),sum[5]+=data[n][0]*data[n][1]);return denominator=sum[1]*sum[2]-sum[5]*sum[5],coeffA=Math.exp((sum[2]*sum[3]-sum[5]*sum[4])/denominator),coeffB=(sum[1]*sum[4]-sum[5]*sum[3])/denominator,results=data.map((function(xyPair){var x=xyPair[0];return[x,coeffA*Math.exp(coeffB*x)]})),{r2:determinationCoefficient(data,results),equation:[coeffA,coeffB],points:results,string:"y = "+_round(coeffA,options.precision)+"e^("+_round(coeffB,options.precision)+"x)"}},logarithmic:function(data,_order,options){for(var sum=[0,0,0,0],coeffA,coeffB,results,len=data.length,n=0;n<len;n++)null!==data[n][1]&&(sum[0]+=Math.log(data[n][0]),sum[1]+=data[n][1]*Math.log(data[n][0]),sum[2]+=data[n][1],sum[3]+=Math.pow(Math.log(data[n][0]),2));return coeffB=(len*sum[1]-sum[2]*sum[0])/(len*sum[3]-sum[0]*sum[0]),coeffA=(sum[2]-coeffB*sum[0])/len,results=data.map((function(xyPair){var x=xyPair[0];return[x,coeffA+coeffB*Math.log(x)]})),{r2:determinationCoefficient(data,results),equation:[coeffA,coeffB],points:results,string:"y = "+_round(coeffA,options.precision)+" + "+_round(coeffB,options.precision)+" ln(x)"}},power:function(data,_order,options){for(var sum=[0,0,0,0],coeffA,coeffB,results,len=data.length,n=0;n<len;n++)null!==data[n][1]&&(sum[0]+=Math.log(data[n][0]),sum[1]+=Math.log(data[n][1])*Math.log(data[n][0]),sum[2]+=Math.log(data[n][1]),sum[3]+=Math.pow(Math.log(data[n][0]),2));return coeffB=(len*sum[1]-sum[2]*sum[0])/(len*sum[3]-sum[0]*sum[0]),coeffA=Math.exp((sum[2]-coeffB*sum[0])/len),results=data.map((function(xyPair){var x=xyPair[0];return[x,coeffA*Math.pow(x,coeffB)]})),{r2:determinationCoefficient(data,results),equation:[coeffA,coeffB],points:results,string:"y = "+_round(coeffA,options.precision)+"x^"+_round(coeffB,options.precision)}},polynomial:function(data,order,options){var lhs=[],rhs=[],a=0,b=0,c,k,i,j,l,len=data.length,results,equation,string;for(k=void 0===order?3:order+1,i=0;i<k;i++){for(l=0;l<len;l++)null!==data[l][1]&&(a+=Math.pow(data[l][0],i)*data[l][1]);for(lhs.push(a),a=0,c=[],j=0;j<k;j++){for(l=0;l<len;l++)null!==data[l][1]&&(b+=Math.pow(data[l][0],i+j));c.push(b),b=0}rhs.push(c)}for(rhs.push(lhs),equation=gaussianElimination(rhs,k),results=data.map((function(xyPair){var x=xyPair[0],answer=equation.reduce((function(sum,coeff,power){return sum+coeff*Math.pow(x,power)}),0);return[x,answer]})),string="y = ",i=equation.length-1;i>=0;i--)string+=i>1?_round(equation[i],options.precision)+"x^"+i+" + ":1===i?_round(equation[i],options.precision)+"x + ":_round(equation[i],options.precision);return{r2:determinationCoefficient(data,results),equation:equation,points:results,string:string}},lastvalue:function(data,_order,options){for(var results=[],lastvalue=null,i=0;i<data.length;i++)null!==data[i][1]&&isFinite(data[i][1])?(lastvalue=data[i][1],results.push([data[i][0],data[i][1]])):results.push([data[i][0],lastvalue]);return{r2:determinationCoefficient(data,results),equation:[lastvalue],points:results,string:""+_round(lastvalue,options.precision)}}};return exports=function regression(method,data,order,options){var methodOptions="object"==typeof order&&void 0===options?order:options||{};return methodOptions.precision||(methodOptions.precision=2),"string"==typeof method?methods[method.toLowerCase()](data,order,methodOptions):null}}));var Static={},Enum={};math.config({epsilon:1e-301}),Enum.MousePatternCode={
/*!
    The default setting for 1, 2 and 3 button mice is:

    - Qt::LeftButton
    - Qt::LeftButton
    - Qt::LeftButton
     */
MouseSelect1:0,
/*!
    The default setting for 1, 2 and 3 button mice is:

    - Qt::LeftButton + Qt::ControlModifier
    - Qt::RightButton
    - Qt::RightButton
     */
MouseSelect2:1,
/*!
    The default setting for 1, 2 and 3 button mice is:

    - Qt::LeftButton + Qt::AltModifier
    - Qt::LeftButton + Qt::AltModifier
    - Qt::MidButton
     */
MouseSelect3:2,
/*!
    The default setting for 1, 2 and 3 button mice is:

    - Qt::LeftButton + Qt::ShiftModifier
    - Qt::LeftButton + Qt::ShiftModifier
    - Qt::LeftButton + Qt::ShiftModifier
     */
MouseSelect4:3,
/*!
    The default setting for 1, 2 and 3 button mice is:

    - Qt::LeftButton + Qt::ControlButton | Qt::ShiftModifier
    - Qt::RightButton + Qt::ShiftModifier
    - Qt::RightButton + Qt::ShiftModifier
     */
MouseSelect5:4,
/*!
    The default setting for 1, 2 and 3 button mice is:

    - Qt::LeftButton + Qt::AltModifier + Qt::ShiftModifier
    - Qt::LeftButton + Qt::AltModifier | Qt::ShiftModifier
    - Qt::MidButton + Qt::ShiftModifier
     */
MouseSelect6:5,MousePatternCount:6},
/*!
\brief Symbolic keyboard input codes

Individual settings can be configured using setKeyPattern()

\sa setKeyPattern(), setMousePattern()
 */
Enum.KeyPatternCode={KeySelect1:0,KeySelect2:1,KeyAbort:2,KeyLeft:3,KeyRight:4,KeyUp:5,KeyDown:6,KeyRedo:7,KeyUndo:8,KeyHome:9,KeyPatternCount:10},Enum.ScaleComponent={Backbone:1,Ticks:2,Labels:4},
/*!
Format for color mapping
\sa rgb(), colorIndex(), colorTable()
 */
Enum.Format={RGB:0,
/*!
    The map is intended to map into 8 bit values, that
    are indices into the color table.
     */
Indexed:1},
/*!
Mode of color map
\sa setMode(), mode()
 */
Enum.Mode={FixedColors:0,ScaledColors:1},
/*!
Spline type
The default setting is Auto
\sa setFitMode(), FitMode()
 */
Enum.FitMode={
/*!
    Use the default spline algorithm for polygons with
    increasing x values ( p[i-1] < p[i] ), otherwise use
    a parametric spline algorithm.
     */
Auto:0,Spline:1,ParametricSpline:2},Static.makeAbstract=function(obj,constructor){if(obj.constructor==constructor)throw new Error("Abstract classes can't be instantiated.")},Static.qBound=function(min,val,max){return Math.max(min,Math.min(val,max))},Array.prototype.mid=function(pos,length=-1){return-1==length?this.slice(pos+1):(length=Math.max(length,0),this.slice(pos,pos+length))},String.prototype.insertAt=function(idx,rem,str){return this.slice(0,idx)+str+this.slice(idx+Math.abs(rem))},String.prototype.replaceAt=function(index,replacement){return this.substr(0,index)+replacement+this.substr(index+replacement.length)},Array.prototype.resize=function(newSize,init){for(;newSize>this.length;)this.push(init)},Array.prototype.containsPoint=function(point){for(var self=this,i=0;i<this.length;++i)if(this[i].isEqual(point))return!0;return!1},Static.MagnifierEnabled=1,Static.ZoomEnabled=2,Static.PanEnabled=4,Static.Locked=8,Static.LeftButtonDown=16,Static.DragCursor=32,Static.PanningInProgress=64,Static.MagnifierSearch=128,Static.ZoomerSearch=256,Static.PannerSearch=512,Static.NoRuler=1024,Static.Left=0,Static.Right=1,Static.Bottom=2,Static.Top=3,Static.LeftAndRight=75776,Static.BottomAndTop=153088,Static.NoTrackingText=0,Static.FullTrackingText=1,Static.PartialTrackingText=2,Static.ReadOnly=0,Static.Clickable=1,Static.Checkable=2,Static.ModeRole=0,Static.TitleRole=1,Static.IconRole=2,Static.UserRole=32,Static.NoRubberBand=0,Static.HLineRubberBand=1,Static.VLineRubberBand=2,Static.CrossRubberBand=3,Static.RectRubberBand=4,Static.EllipseRubberBand=5,Static.PolygonRubberBand=6,
/*!
Values >= UserRubberBand can be used to define additional
rubber bands.
 */
Static.UserRubberBand=100,Static.NoSelection=-1,Static.PointSelection=0,Static.RectSelection=1,Static.PolygonSelection=2,Static.AlwaysOff=0,Static.AlwaysOn=1,Static.ActiveOnly=2,Static.NoPen="noPen",Static.NoBrush="noBrush",Static.accuracyFactorModerate=.002,Static.accuracyFactor=Static.accuracyFactorModerate,Static.watchUpdateError=!1,Static.showWatchUpdateError=!0;var _eps=1e-300,NoTick=-1,MinorTick=0,MediumTick=1,MajorTick=2,NTickTypes=3,BottomScale=0,TopScale=1,LeftScale=2,RightScale=3,Horizontal=1,Vertical=2,ScaleInterest=1,IncludeBorders=0,ExcludeMinimum=1,ExcludeMaximum=2,ExcludeBorders=3,XAxis=0,YAxis=1,ZAxis=2,yLeft=0,yRight=1,xBottom=2,xTop=3,axisCnt=4,Legend=1,AutoScale=2,Margins=4,NoCurve=-1,Lines=0,Sticks=1,Steps=2,Dots=3,UserCurve=100,Inverted=1,Fitted=2,RoundPoints=1,WeedOutPoints=2,FilterPoints=1,MinimizeMemory=2,NoLine=0,NoSymbol=-1,Ellipse=0,MRect=2,Diamond=3,Triangle=4,DTriangle=5,UTriangle=6,LTriangle=7,RTriangle=8,Cross=9,XCross=10,HLine=11,VLine=12,Star1=13,Star2=14,Hexagon=15,Path=16,Pixmap=17,MGraphic=18,SvgDocument=19,UserStyle=1e3;function insertLogBase(expStr,logStr){var str=expStr;if(expStr.includes(logStr))for(var base=logStr.replace("log","");-1!==str.indexOf(logStr);)for(var i=str.indexOf(logStr)+logStr.length,leftPar=0,rightPar=0;i<str.length;++i)if("("==str[i]&&leftPar++,")"==str[i]&&rightPar++,leftPar==rightPar){str=(str=str.insertAt(i,0,","+base)).replace(logStr,"log");break}return str}function logBaseAdjust(expStr){for(var logBaseStr=["log2","log3","log4","log5","log6","log7","log8","log9","log10"],i=0;i<logBaseStr.length;i++)expStr=insertLogBase(expStr,logBaseStr[i]);return expStr}function EvaluateExp(expStr){var m_expStr=expStr,f,simplified;this.error=!1;var self=this;function init(){var expanded=Static.expandDefines(m_expStr);try{simplified=math.parse(expanded),m_expStr.includes("log")||(simplified=math.simplify(simplified))}catch(err){var charPos=parseInt(err.message.match(/(\d+)/)[0]);return Static.alert("Invalid character in function: "+expanded[charPos-1]),void(self.error=!0)}simplified=simplified.compile()}void 0!==m_expStr&&m_expStr.length>0&&(m_expStr=logBaseAdjust(m_expStr),init()),this.setExpString=function(s){m_expStr=s,init()},this.getExpString=function(){return m_expStr},this.eval=function(obj){this.error=!1;try{return simplified.evaluate(obj)}catch(err){return this.errorMessage=err.message,this.error=!0,0}}}Static.NoButton=-1,Static.LeftButton=0,Static.MiddleButton=1,Static.MidButton=1,Static.RightButton=2,Static.Key_Escape=27,Static.Key_Plus=107,Static.Key_Minus=109,Static.Key_Ctrl=17,Static.Key_Shift=16,Static.Key_Return=13,Static.Key_Space=32,Static.Key_Left=37,Static.Key_Right=39,Static.Key_Up=38,Static.Key_Down=40,Static.Key_Undo=90,Static.Key_Redo=89,Static.Key_Home=36,Static.Key_I=73,Static.Key_O=79,Static.Key_unknown=-1,Static.NoModifier=0,Static.ShiftModifier=33554432,Static.ControlModifier=67108864,Static.AltModifier=134217728,Static.AlignRight=1,Static.AlignLeft=2,Static.AlignBottom=4,Static.AlignTop=8,Static.AlignCenter=16,Static.toPrecision=function(value,numberOfDigits){return numberOfDigits<1?numberOfDigits=1:numberOfDigits>16&&(numberOfDigits=16),value.toPrecision(numberOfDigits)},Static.adjustForDecimalPlaces=function(number,places){null==places&&(places=5);var multiplier=Math.pow(10,places);return Math.round(number*multiplier)/multiplier},Static.mFuzzyCompare=function(a,b){var diff;return Math.abs(a-b)<_eps},Static.m3FuzzyCompare=function(value1,value2,intervalSize){var eps=Math.abs(_eps*intervalSize);return value2-value1>eps?-1:value1-value2>eps?1:0},Static.bind=function(sig,data,cb){$(window).on(sig,data,cb)},Static.unbind=function(sig,cb){$(window).off(sig,cb)},Static.trigger=function(sig,param){$(window).trigger(sig,param)},Static.invert=function(rgb){rgb=[].slice.call(arguments).join(",").replace(/rgb\(|\)|rgba\(|\)|\s/gi,"").split(",");for(var i=0;i<rgb.length;i++)rgb[i]=(3===i?1:255)-rgb[i];return"rgb("+rgb.join(", ")+")"},Static.RGB2HTML=function(red,green,blue){if("string"==typeof red){var str=red;str=str.replace("rgb(",""),red=parseInt(str),str=(str=str.replace(",","")).replace(red,""),green=parseInt(str),str=(str=str.replace(",","")).replace(green,""),blue=parseInt(str)}if(void 0!==red.r){var temp=red;red=red.r,green=temp.g,blue=temp.b}var decColor;return"#"+(16777216+blue+256*green+65536*red).toString(16).substr(1)},Static.HTMLToRGB=function(hex){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null},Static.mRgb=function(red,green,blue){return{r:red,g:green,b:blue,toString:function(){return"rgb("+red+","+green+","+blue+")"}}},Static.mRgba=function(red,green,blue,alpha){return{r:red,g:green,b:blue,a:alpha,toString:function(){return"rgb("+red+","+green+","+blue+","+alpha+")"}}},Static.colorNameToHex=function(colour){var colours={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return"object"==typeof colour?Static.RGB2HTML(colour.r,colour.g,colour.b):"r"==colour[0]&&"g"==colour[1]&&"b"==colour[2]?Static.RGB2HTML(colour):"#"==colour[0]?colour:void 0!==colours[colour.toLowerCase()]?colours[colour.toLowerCase()]:"#000000"},Static.sqr=function(value){return Math.pow(value,2)},Static.setElementIndex=function(element,index){var Children=$(element).parent().children(),target=Children[index];$(element).index()>index?(null==target&&(target=Children[0]),target!=element&&null!=target&&$(target).before(element)):(null==target&&(target=Children[Children.length-1]),target!=element&&null!=target&&$(target).after(element))},Static.elementsFromPoint=function(x,y,elem){var until=elem[0],parents=[],current;do{(current=document.elementFromPoint(x,y))!==until?(parents.push(current),current.style.pointerEvents="none"):current=!1}while(current);return parents.forEach((function(parent){return parent.style.pointerEvents="all"})),$(parents)},Static.stopkeyPressPropagation=function(element){element.keydown((function(event){event.stopPropagation()}))},window.matchMedia("print").addListener((function(mql){mql.matches?Static.trigger("beforePrint"):Static.trigger("afterPrint")})),Static.Cancel=0,Static.No=1,Static.Yes=2,Static.alertDlg=function(){var dlg=$('<div class="modal fade" id="alert_Modal" role="dialog">            <div id="dlg" class="modal-dialog">            \x3c!-- Modal content--\x3e            <div class="modal-content">            <div class="modal-header">            \x3c!--button type="button" class="close" data-dismiss="modal">&times;</button--\x3e            <h4 class="modal-title"><b>Alert</b></h4>            </div>            <div class="modal-body">            <p id="msg"></p>            </div>            <div id="alertDlgFooter1" class="modal-footer">            <button type="button" class="btn btn-default" data-dismiss="modal">Ok</button>            </div>            <div id="alertDlgFooter2" class="modal-footer">            <button id="yes" type="button" class="btn btn-default">Yes</button>            <button id="no" type="button" class="btn btn-default">No</button>            <button id="cancel" type="button" class="btn btn-default">Cancel</button>            </div>            </div>            </div>            </div>');$("body").append(dlg),dlg.css("z-index",1e9),this.alert=function(msg,type){$("#alertDlgFooter2").hide(),$("#alertDlgFooter1").show(),$("#msg").text(msg),"small"==type?$("#dlg").addClass("modal-sm"):$("#dlg").removeClass("modal-sm"),dlg.modal({backdrop:"static"})};var self=this;this.alertYesNo=function(msg,cb,type){$("#alert_Modal").modal("hide"),this.alertYesCb=cb,$("#alertDlgFooter1").hide(),$("#alertDlgFooter2").show(),$("#msg").text(msg),"small"==type?$("#dlg").addClass("modal-sm"):$("#dlg").removeClass("modal-sm"),$("#alert_Modal").modal("show")},$("#yes").click((function(){$("#alert_Modal").modal("hide"),self.alertYesCb(Static.Yes)})),$("#no").click((function(){$("#alert_Modal").modal("hide"),self.alertYesCb(Static.No)})),$("#cancel").click((function(){$("#alert_Modal").modal("hide"),self.alertYesCb(Static.Cancel)}))},Static.alert=function(msg,type){null==Static.alertObj&&(Static.alertObj=new Static.alertDlg),Static.alertObj.alert(msg,type)},Static.alertYesNo=function(msg,cb,type){null==Static.alertObj&&(Static.alertObj=new Static.alertDlg),Static.alertObj.alertYesNo(msg,cb,type)},Static.promptDlg=function(){var prompt_dlg=$('<div class="modal fade" id="promptModal" role="dialog">            <div id="prompt_dlg" class="modal-dialog">            \x3c!-- Modal content--\x3e            <div class="modal-content">            <div class="modal-header">            <button type="button" class="close" data-dismiss="modal"></button>            <h4 class="modal-title" id="prompt_title">Alert</h4>            </div>            <div class="modal-body">            <input id="prompt_msg" style="width:100%" autofocus />            </div>            <div class="modal-footer">            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>            <button id="prompt_ok" type="button" class="btn btn-default">Ok</button>            </div>            </div>            </div>            </div>');$("body").append(prompt_dlg);var self=this;this.prompt=function(title,defaultMsg,cb,type){"small"==type&&$("#prompt_dlg").addClass("modal-sm"),$("#prompt_title").text(title),$("#prompt_msg").val(defaultMsg),$("#prompt_msg").select(),this.cb=cb,prompt_dlg.modal({backdrop:"static"})},$("#prompt_ok").on("click",(function(){self.cb($("#prompt_msg").val())?$(".close").click():$("#prompt_msg").select()}))},Static.prompt=function(msg,defaultMsg,cb,type){null==Static.promptObj&&(Static.promptObj=new Static.promptDlg),Static.promptObj.prompt(msg,defaultMsg,cb,type)},Static.isMobile=function(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i.test(navigator.userAgent||navigator.vendor||window.opera)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test((navigator.userAgent||navigator.vendor||window.opera).substr(0,4))},Static.expandDefines=function(str){for(var defined,i,res,res=purgeAndMarkKeywords(res=str.slice()),m=0;m<Static.m_defines.length;m++)for(var n=0;n<Static.m_defines.length;n++)for(;-1!==res.search(Static.m_defines[n].name);)res=res.replace(Static.m_defines[n].name,purgeAndMarkKeywords(Static.getDefined(Static.m_defines[n].name)));return res=replaceKeywordMarkers(res)};var keywords=["asinh","acosh","atanh","acoth","asech","acsch","asin","acos","atan","acot","asec","acsc","sinh","cosh","tanh","coth","sech","csch","sin","cos","tan","sec","csc","cot","ln","log","log2","log3","log4","log5","log6","log7","log8","log9","log10","deg","pi","PI","e","E"];function containsKeyword(str){for(var i=0;i<keywords.length;i++)if(-1!=str.indexOf(keywords[i]))return keywords[i];return null}function purgeKewords(str){for(var i=0;i<keywords.length;++i)for(;-1!=str.indexOf(keywords[i]);)str=str.replace(keywords[i],"");return str}var keywordMarkers=[];function purgeAndMarkKeywords(str){for(var i=0;i<keywords.length;++i)for(;-1!=str.indexOf(keywords[i]);){var _marker="%"+keywordMarkers.length+"%";str=str.replace(keywords[i],_marker),keywordMarkers.push({marker:_marker,keyword:keywords[i]})}return str}function replaceKeywordMarkers(str){for(var i=0;i<keywordMarkers.length;++i)for(;-1!=str.indexOf(keywordMarkers[i].marker);)str=str.replace(keywordMarkers[i].marker,keywordMarkers[i].keyword);return keywordMarkers=[],str}function findIndepVar(fx){for(var alphas="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i=0,fnWithoutKeywords=purgeKewords(fx);i<fnWithoutKeywords.length;){for(var c=fnWithoutKeywords.charAt(i),str="";-1!=alphas.indexOf(c)&&i<fnWithoutKeywords.length;)str+=c,++i,c=fnWithoutKeywords.charAt(i);if(1===str.length)return str;++i}}function regress(curve,type,order,throughOrigin,option){"linear"==type&&throughOrigin&&(type="linearthroughorigin");for(var samples=curve.data().samples(),points=[],i=0;i<samples.length;++i)points.push([samples[i].x,samples[i].y]);return Static.regression(type,points,order,option)}function integrate(f,start,end,volumeX,step){Static.total_area=0,Static.total_volume=0;var _x=0,x=start,y=0;if(volumeX=volumeX||!1){if(step>_eps)for(;x<end;x+=step){var _x;(_x=x+step)>end&&(step-=_x-end),y=f(x+step/2),Static.total_volume+=y*step*y*Math.PI}else alert("The aplication is attempted to use too small a step in the trapezoidial rule.");return Static.total_volume}if(step>_eps)for(;x<end;x+=step){var _x;(_x=x+step)>end&&(step-=_x-end),y=f(x+step/2),Static.total_area+=y*step}else alert("The aplication is attempted to use too small a step in the trapezoidial rule.");return Static.total_area}define("static",["regression"],(function(regression){Static.regression=regression})),$("body").on("contextmenu",(function(e){e.preventDefault()})),Static.total_area=0,Static.total_volume=0,integrate.transform=function(args,math,scope){if(!args[1].isSymbolNode)throw new Error("Second argument must be a symbol");const variable=args[1].name;var start=args[2].compile().evaluate(scope),end=args[3].compile().evaluate(scope),volumeX=args[4]&&args[4].compile().evaluate(scope),step=args[5]&&args[5].compile().evaluate(scope),fnScope=Object.create(scope),fnCode=args[0].compile(),f;return integrate((function(x){return fnScope[variable]=x,fnCode.evaluate(fnScope)}),start,end,volumeX,step)},integrate.transform.rawArgs=!0,math.import({integrate:integrate}),Static.isAlpha=function(ch){return(ch=ch.toLowerCase().charCodeAt(0))>96&&ch<122},Static.printFn=function(){window.print()},Static.addCSS=function(path){var head=document.getElementsByTagName("head")[0],link=document.createElement("link");link.rel="stylesheet",link.type="text/css",link.href=path,link.media="all",head.appendChild(link)},Static.m_defines=[],Static.define=function(_name,_value){Static.m_defines.push({name:_name,value:_value})},Static.containsDefine=function(str){for(var i=0;i<Static.m_defines.length;i++)if(-1!=str.indexOf(Static.m_defines[i].name))return Static.m_defines[i].name;for(var i=0;i<Static.m_defines.length;i++)if(-1!=Static.m_defines[i].name.indexOf(str))return Static.m_defines[i].name;return null},Enum.DefineError={noError:0,start:1,contain:2,keyword:3},Static.validateDefineName=function(_name){if(!Static.isAlpha(_name[0]))return{errorType:Enum.DefineError.start,name:_name};var earlier=Static.containsDefine(_name);if(earlier)return{errorType:Enum.DefineError.contain,name:earlier};var keyword=containsKeyword(_name);return keyword?{errorType:Enum.DefineError.keyword,name:keyword}:{errorType:Enum.DefineError.noError,name:_name}},Static.getDefined=function(name){for(var i=0;i<Static.m_defines.length;i++)if(Static.m_defines[i].name===name)return"("+Static.m_defines[i].value+")";return console.warn('"'+name+'" is not predefined!'),""};class DefinesDlg{constructor(plot){var buildDlg=_.once((function(){function setRemoveButtonAttribute(){var define;findDefine($("#definesName").val())?($("#definesRemove").attr("disabled",!1),$("#definesRemoveAll").attr("disabled",!1)):($("#definesRemove").attr("disabled",!0),$("#definesRemoveAll").attr("disabled",!0))}function upload(data){var extension=data.fileName.split(".")[1];if("xls"==extension||"xlsx"==extension||"txt"==extension||"def"==extension){var samples=null,csvArray=null;if("xls"==extension||"xlsx"==extension){var workbook=XLSX.read(data.content,{type:"binary"}),firstSheet=workbook.SheetNames[0];csvArray=XLSX.utils.sheet_to_csv(workbook.Sheets[firstSheet]).split("\n")}else csvArray=data.content.split("\n");for(var errorFound=!1,i=0;i<csvArray.length;i++){var row=csvArray[i].split(",");if(2===row.length){var name=row[0],value=row[1];if(name.length&&value.length){var error=Static.validateDefineName(name);!errorFound&&error.errorType>Enum.DefineError.noError&&(errorFound=!0),error.errorType==Enum.DefineError.noError&&doAdd(name,value)}}}errorFound&&Static.alert("One or more invalid names found or an attempt to load the same file more than once.")}$("#definesUpload")[0].value=""}$("body").append($('                        <div class="modal fade" id="definesModal" role="dialog">                        <div class="modal-dialog modal-md">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal">&times;</button>                        <h4 class="modal-title">Defines</h4>                        </div>                        <div class="modal-body">                        <div class="row">                        <div class="col-md-3">Name:</div>                        <div class="col-md-8">                        <input id="definesName" type="text" style="width:100%">                        </input>                        </div>                        </div>                        <br>                        <div class="row">                        <div class="col-md-3">Value:</div>                        <div class="col-md-8">                        <input id="definesValue" type="text" style="width:100%">                        </input>                        </div>                        </div>                        <br>                                                <table>                        <tr style="border: 1px solid black">                        <th style="border: 0px"> Name</th>                        <th style="text-align: right; border: 0px">Value </th>                        </tr>                        </table>                        <div style="position:relative; overflow: auto;height: 100px">                        <table id="definesTable" style="border: 1px solid black">                        <col width="15%">                        </table>                        </div>                                                <div class="modal-footer">                        <button id="definesUploadButton" type="button" class="btn btn-default">\t\t\t\t\t\tLoad                        </button>                        <select name="uploadDefinesType" id="uploadDefinesType">                            <option value="loadFromLocalFs">from Local System</option>                            <option value="loadFromMongoFs">from Mongo System</option>                        </select>                        <label>                        <input id="definesUpload" type="file" style="display: none;" name="files[]" multiple />                        </label>                        <button id="definesAdd" type="button" class="btn btn-default" >Add</button>                        <button id="definesRemove" type="button" class="btn btn-default" >Remove</button>                        <button id="definesRemoveAll" type="button" class="btn btn-default" >Remove All</button>                        <button type="button" class="btn btn-default"  data-dismiss="modal">Close</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#definesAdd").click(addCb),$("#definesRemove").click(removeCb),$("#definesAdd").attr("disabled",!0),$("#definesRemove").attr("disabled",!0),Static.m_defines.length||($("#definesRemoveAll").attr("disabled",!0),$("#definesRemove").attr("disabled",!0)),$("#definesRemoveAll").on("click",(function(){for(var i=0;i<Static.m_defines.length;i++){var id="#"+Static.m_defines[i].name;$(id).remove()}$("#definesRemoveAll").attr("disabled",!0),$("#definesRemove").attr("disabled",!0),Static.m_defines=[]})),$(window).bind("fileOpened",(function(e,data,filename,ext,editorName){".txt"===ext||".def"===ext?editorName===plot.definesEditor.m_data.name&&upload({fileName:filename,content:data}):alert(`Cannot load "${ext}" files.`)})),$("#definesUploadButton").on("click",(function(){"loadFromLocalFs"===$("#uploadDefinesType").val()?$("#definesUpload").trigger("click"):plot.definesEditor.openFile()})),$("#definesUpload").on("change",(function(evt){for(var files=evt.target.files,i=0,f;f=files[i];i++){var fileExtension=f.name.split(".")[1];if("txt"==fileExtension||"xls"==fileExtension||"xlsx"==fileExtension||"plt"==fileExtension){var reader=new FileReader;reader.onload=function(theFile){return function(e){upload({fileName:theFile.name,content:e.target.result})}}(f),"xls"==fileExtension||"xlsx"==fileExtension?reader.readAsBinaryString(f):reader.readAsText(f)}}})),$("#definesName").on("input",(function(e){if($("#definesName").val().length&&_.isString($("#definesName").val())){var define=findDefine($("#definesName").val());define&&$("#definesValue").val(define.value)}$("#definesName").val().length&&_.isString($("#definesName").val())&&$("#definesValue").val().length&&_.isString($("#definesValue").val())?(setRemoveButtonAttribute(),$("#definesAdd").attr("disabled",!1)):($("#definesAdd").attr("disabled",!0),$("#definesRemove").attr("disabled",!0),$("#definesRemoveAll").attr("disabled",!0))})),$("#definesValue").on("input",(function(e){$("#definesName").val().length&&_.isString($("#definesName").val())&&$("#definesValue").val().length&&_.isString($("#definesValue").val())?(setRemoveButtonAttribute(),$("#definesAdd").attr("disabled",!1)):($("#definesAdd").attr("disabled",!0),$("#definesRemove").attr("disabled",!0),$("#definesRemoveAll").attr("disabled",!0))}));for(var i=0;i<Static.m_defines.length;i++)$("#definesTable").append($("<tr id="+Static.m_defines[i].name+' style="border: 1px solid black">                            <td style="border: 1px solid black">'+Static.m_defines[i].name+'</td>                            <td style="border: 1px solid black">'+Static.m_defines[i].value+"</td>                            </tr>"))}));function doAdd(name,value){name=name.trim(),value=value.trim();var define=findDefine(name);define?(define.value=value,$("#"+name)[0].children[1].innerText=value):(Static.define(name,value),$("#definesRemoveAll").attr("disabled",!1),$("#definesTable").append($("<tr id="+name+' style="border: 1px solid black">                        <td style="border: 1px solid black">'+name+"</td>                        <td>"+value+"</td>                        </tr>"))),$("#definesName").val(""),$("#definesValue").val(""),$("#definesName").focus(),$("#definesAdd").attr("disabled",!0),$("#definesRemove").attr("disabled",!0)}function findDefine(def){for(var i=0;i<Static.m_defines.length;i++)if(Static.m_defines[i].name===def)return Static.m_defines[i];return null}function removeDefine(name){var cpy=Static.m_defines.slice();Static.m_defines=[];for(var i=0;i<cpy.length;i++)cpy[i].name!==name&&Static.m_defines.push(cpy[i]);Static.m_defines.length||($("#definesRemove").attr("disabled",!0),$("#definesRemoveAll").attr("disabled",!0),$("#definesAdd").attr("disabled",!0))}function removeCb(){var id="#"+$("#definesName").val();removeDefine($("#definesName").val()),$(id).remove(),$("#definesName").val(""),$("#definesValue").val(""),$("#definesName").focus(),$("#definesRemove").attr("disabled",!0),$("#definesAdd").attr("disabled",!0)}function addCb(){var name=$("#definesName").val(),error=Static.validateDefineName($("#definesName").val()),value;return error.errorType==Enum.DefineError.start?(Static.alert('Define name,"'+name+'", must start with alpha character.'),$("#definesName").val(""),void(Static.m_defines.length&&$("#definesRemoveAll").attr("disabled",!1))):error.errorType==Enum.DefineError.contain?(Static.alert('Define name,"'+name+'", contains, or is part of, the earlier define, "'+error.name+'".'),$("#definesName").val(""),void(Static.m_defines.length&&$("#definesRemoveAll").attr("disabled",!1))):error.errorType==Enum.DefineError.keyword?(Static.alert('Define name,"'+name+'", contains "'+error.name+'" keyword!'),$("#definesName").val(""),void(Static.m_defines.length&&$("#definesRemoveAll").attr("disabled",!1))):void doAdd(name,$("#definesValue").val())}function showDlg(){$("#definesModal").modal({backdrop:"static"})}this.defines=function(){buildDlg(),showDlg()}}}var definesDlg=null;Static.defines=function(plot){definesDlg||(definesDlg=new DefinesDlg(plot)),definesDlg.defines()};class PlotItem{constructor(tle){Static.Rtti_PlotItem=0,Static.Rtti_PlotGrid=1,Static.Rtti_PlotScale=2,Static.Rtti_PlotLegend=3,Static.Rtti_PlotMarker=4,Static.Rtti_PlotCurve=5,Static.Rtti_PlotSpectroCurve=6,Static.Rtti_PlotIntervalCurve=7,Static.Rtti_PlotHistogram=8,Static.Rtti_PlotSpectrogram=9,Static.Rtti_PlotSVG=10,Static.Rtti_PlotTradingCurve=11,Static.Rtti_PlotBarChart=12,Static.Rtti_PlotMultiBarChart=13,Static.Rtti_PlotShape=14,Static.Rtti_PlotTextLabel=15,Static.Rtti_PlotZone=16,Static.Rtti_PlotUserItem=1e3;var self=this;this.plotId="";var _context=null,_plot=null,cnvs=null,d_interests,m_domDiv=$("#centralDiv"),m_isVisible=!0,m_attributes=0,m_z=0,m_xAxis=xBottom,m_yAxis=yLeft,m_title=tle||"";this.rtti=Static.Rtti_PlotItem;var m_legendIconSize=new Misc.Size(10,10);this.getLegendIconSize=function(){return m_legendIconSize}
/*!
        Set the size of the legend icon

        The default setting is 8x8 pixels

        \param size Size
        \sa legendIconSize(), legendIcon()
         */,this.setLegendIconSize=function(size){m_legendIconSize=size,_plot&&_plot.updateLegend(this)}
/*!
        Toggle an item interest

        \param interest Interest type
        \param on true/false

        \sa testItemInterest(), ItemAttribute
         */,this.setItemInterest=function(interest,on){on?d_interests|=interest:d_interests&=~interest,this.itemChanged()}
/*!
        Test an item interest

        \param interest Interest type
        \return true/false
        \sa setItemInterest(), ItemAttribute
         */,this.testItemInterest=function(interest){return d_interests&interest},this.plot=function(){return _plot},this.title=function(){return m_title},this.setTitle=function(tle){m_title!==tle&&(m_title=tle,this.legendChanged(),this.itemChanged(),Static.trigger("titleChange",[this,tle]))},this.clearCanvas=function(){this.getContext().clearRect(0,0,cnvs[0].width,cnvs[0].height)},this.attach=function(plot){plot!=_plot&&(_plot&&(this.getContext().clearRect(0,0,cnvs[0].width,cnvs[0].height),cnvs.hide(),cnvs=null,_plot.attachItem(this,!1)),(_plot=plot)&&(null===cnvs&&(cnvs=$("<canvas />").attr({style:"position: absolute; background-color: transparent"}),_plot.getLayout().getCentralDiv().append(cnvs),cnvs.css({"border-radius":"inherit"}),0!=m_z&&cnvs.css("zIndex",m_z)),_plot.attachItem(this,!0)))}
/*!
        \brief This method detaches a QwtPlotItem from any
        QwtPlot it has been associated with.

        detach() is equivalent to calling attach( NULL )
        \sa attach()
         */,this.detach=function(){this.attach(null)},this.setZ=function(z){m_z!==z&&(m_z=z,cnvs&&cnvs.css("zIndex",m_z),this.itemChanged())},this.getZ=function(z){return m_z},this.getCanvas=function(){return cnvs},this.syncSizes=function(){var cd=_plot.getLayout().getCentralDiv();cnvs[0].width=parseFloat(cd.css("width")),cnvs[0].height=parseFloat(cd.css("height"))},this.getContext=function(){return this.syncSizes(),cnvs[0].getContext("2d")},
/*!
        Set X and Y axis

        The item will painted according to the coordinates of its Axes.

        \param xAxis X Axis ( QwtPlot::xBottom or QwtPlot::xTop )
        \param yAxis Y Axis ( QwtPlot::yLeft or QwtPlot::yRight )

        \sa setXAxis(), setYAxis(), xAxis(), yAxis(), QwtPlot::Axis
         */
this._setAxes=function(xAxis,yAxis){xAxis!=xBottom&&xAxis!=xTop||(m_xAxis=xAxis),yAxis!=yLeft&&yAxis!=yRight||(m_yAxis=yAxis),this.itemChanged()}
/*!
        Toggle an item attribute

        \param attribute Attribute type
        \param on true/false

        \sa testItemAttribute(), ItemInterest
         */,this.setItemAttribute=function(attribute,on){on?m_attributes|=attribute:m_attributes&=~attribute,attribute==Legend&&this.legendChanged(),this.itemChanged()}
/*!
        Test an item attribute

        \param attribute Attribute type
        \return true/false
        \sa setItemAttribute(), ItemInterest
         */,this.testItemAttribute=function(attribute){return m_attributes&attribute},this.show=function(){this.setVisible(!0)},this.hide=function(){this.setVisible(!1)},this.doSetVisible=function(on){on!==m_isVisible&&(m_isVisible=on,on?cnvs.show():cnvs.hide(),this.itemChanged(),Static.trigger("visibilityChange",[this,on]))}
/*!
        \return true if visible
        \sa setVisible(), show(), hide()
         */,this.isVisible=function(){return m_isVisible}
/*!
        Update the legend and call QwtPlot::autoRefresh() for the
        parent plot.

        \sa QwtPlot::legendChanged(), QwtPlot::autoRefresh()
         */,this.itemChanged=function(){_plot&&_plot.autoRefresh()}
/*!
        Update the legend of the parent plot.
        \sa QwtPlot::updateLegend(), itemChanged()
         */,this.legendChanged=function(){this.testItemAttribute(Legend)&&_plot&&_plot.updateLegend(this)}
/*!
        Set the X axis

        The item will painted according to the coordinates its Axes.

        \param axis X Axis ( QwtPlot::xBottom or QwtPlot::xTop )
        \sa setAxes(), setYAxis(), xAxis(), QwtPlot::Axis
         */,this._setXAxis=function(axis){axis!=xBottom&&axis!=xTop||(m_xAxis=axis,this.itemChanged())}
/*!
        Set the Y axis

        The item will painted according to the coordinates its Axes.

        \param axis Y Axis ( QwtPlot::yLeft or QwtPlot::yRight )
        \sa setAxes(), setXAxis(), yAxis(), QwtPlot::Axis
         */,this._setYAxis=function(axis){axis!=yLeft&&axis!=yRight||(m_yAxis=axis,this.itemChanged())},this.xAxis=function(){return m_xAxis},this.yAxis=function(){return m_yAxis},this.getCanvasRect=function(){return this.syncSizes(),new Misc.Rect(new Misc.Point,cnvs[0].width,cnvs[0].height)}
/*!
        \return Legend icon size
        \sa setLegendIconSize(), legendIcon()
         */,this.legendIconSize=function(){return this.getLegendIconSize()}
/*!
        \return Icon representing the item on the legend

        The default implementation returns an invalid icon

        \param index Index of the legend entry
        ( usually there is only one )
        \param size Icon size

        \sa setLegendIconSize(), legendData()
         */,this.legendIcon=function(index,size){return null}
/*!
        \brief Return a default icon from a brush

        The default icon is a filled rectangle used
        in several derived classes as legendIcon().

        \param brush Fill brush
        \param size Icon size

        \return A filled rectangle
         */,this.defaultIcon=function(brush,size){var icon=null;if(size.width>0&&size.height>0){var r=new Misc.Rect(0,0,size.width,size.height),painter;icon=new GraphicUtil.Graphic(null,size.width+1,size.height+1),new GraphicPainter(icon).fillRect(r,brush)}return icon}
/*!
        \brief Return all information, that is needed to represent
        the item on the legend

        Most items are represented by one entry on the legend
        showing an icon and a text, but f.e. QwtPlotMultiBarChart
        displays one entry for each bar.

        QwtLegendData is basically a list of QVariants that makes it
        possible to overload and reimplement legendData() to
        return almost any type of information, that is understood
        by the receiver that acts as the legend.

        The default implementation returns one entry with
        the title() of the item and the legendIcon().

        \return Data, that is needed to represent the item on the legend
        \sa title(), legendIcon(), QwtLegend, QwtPlotLegendItem
         */,this.legendData=function(){var data=new LegendData,titleValue=this.title();data.setValue(Static.TitleRole,titleValue);var iconValue=this.legendIcon(0,this.legendIconSize());return iconValue&&data.setValue(Static.IconRole,iconValue),[data]},this.toString=function(){return'[PlotItem "'+this.plotId+'"]'}}
/*!
        \return An invalid bounding rect: QRectF(1.0, 1.0, -2.0, -2.0)
        \note A width or height < 0.0 is ignored by the autoscaler
         */boundingRect(){return new Misc.Rect}setVisible(on){this.doSetVisible(on)}
/*!
        Set the X axis

        The item will painted according to the coordinates its Axes.

        \param axis X Axis ( QwtPlot::xBottom or QwtPlot::xTop )
        \sa setAxes(), setYAxis(), xAxis(), QwtPlot::Axis
         */setXAxis(axis){this._setXAxis(axis)}
/*!
        Set the Y axis

        The item will painted according to the coordinates its Axes.

        \param axis Y Axis ( QwtPlot::yLeft or QwtPlot::yRight )
        \sa setAxes(), setXAxis(), yAxis(), QwtPlot::Axis
         */setYAxis(axis){this._setYAxis(axis)}
/*!
        Set X and Y axis

        The item will painted according to the coordinates of its Axes.

        \param xAxis X Axis ( QwtPlot::xBottom or QwtPlot::xTop )
        \param yAxis Y Axis ( QwtPlot::yLeft or QwtPlot::yRight )

        \sa setXAxis(), setYAxis(), xAxis(), yAxis(), QwtPlot::Axis
         */setAxes(xAxis,yAxis){this._setAxes(xAxis,yAxis)}draw(xMap,yMap){console.log("No drawing mehod define in subclass")}}define("plotItem",["static"],(function(){}));class PlotMarker extends PlotItem{constructor(tle){super(tle);var m_label="",m_labelFont=new Misc.Font,m_labelAlignment=Static.AlignCenter,m_labelOrientation=Horizontal,m_spacing=2,m_pen=new Misc.Pen,m_symbol=null,m_style=NoLine,m_xValue=0,m_yValue=0;this.rtti=Static.Rtti_PlotMarker,this.labelFont=function(){return m_labelFont},this.setLabelFont=function(f){m_labelFont=f},this.value=function(){return new Misc.Point(m_xValue,m_yValue)},this.xValue=function(){return m_xValue},this.yValue=function(){return m_yValue},this.setValue=function(x,y){if("object"==typeof x){var temp=x;x=temp.x,y=temp.y}x==m_xValue&&y==m_yValue||(m_xValue=x,m_yValue=y,this.plot()&&this.plot().autoRefresh())},this.setXValue=function(x){this.setValue(x,m_yValue)},this.setYValue=function(y){this.setValue(m_xValue,y)}
/*!
          \brief Set the label
          \param label Label text
          \sa label()
        */,this.setLabel=function(label){label!=m_label&&(m_label=label)}
/*!
          \return the label
          \sa setLabel()
        */,this.label=function(){return m_label}
/*!
          \brief Set the alignment of the label
    
          In case of QwtPlotMarker::HLine the alignment is relative to the
          y position of the marker, but the horizontal flags correspond to the
          canvas rectangle. In case of QwtPlotMarker::VLine the alignment is
          relative to the x position of the marker, but the vertical flags
          correspond to the canvas rectangle.
    
          In all other styles the alignment is relative to the marker's position.
    
          \param align Alignment.
          \sa labelAlignment(), labelOrientation()
        */,this.setLabelAlignment=function(align){align!==m_labelAlignment&&(m_labelAlignment=align)}
/*!
          \return the label alignment
          \sa setLabelAlignment(), setLabelOrientation()
        */,this.labelAlignment=function(){return m_labelAlignment}
/*!
          \brief Set the orientation of the label
    
          When orientation is Qt::Vertical the label is rotated by 90.0 degrees
          ( from bottom to top ).
    
          \param orientation Orientation of the label
    
          \sa labelOrientation(), setLabelAlignment()
        */,this.setLabelOrientation=function(orientation){orientation!=m_labelOrientation&&(m_labelOrientation=orientation)}
/*!
          \return the label orientation
          \sa setLabelOrientation(), labelAlignment()
        */,this.labelOrientation=function(){return m_labelOrientation}
/*!
          \brief Set the spacing
    
          When the label is not centered on the marker position, the spacing
          is the distance between the position and the label.
    
          \param spacing Spacing
          \sa spacing(), setLabelAlignment()
        */,this.setSpacing=function(spacing){spacing<0&&(spacing=0),spacing!=m_spacing&&(m_spacing=spacing)}
/*!
          \return the spacing
          \sa setSpacing()
        */,this.spacing=function(){return m_spacing}
/*!
          \brief Assign a symbol
          \param symbol New symbol
          \sa symbol()
        */,this.setSymbol=function(symbol){m_symbol=symbol}
/*!
          \return the symbol
          \sa setSymbol(), QwtSymbol
        */,this.symbol=function(){return m_symbol}
/*!
          Draw the marker
    
          \param painter Painter
          \param xMap x Scale Map
          \param yMap y Scale Map
          \param canvasRect Contents rectangle of the canvas in painter coordinates
        */,this.draw=function(xMap,yMap){var canvasRect=this.getCanvasRect(),pos=new Misc.Point(xMap.transform(m_xValue),yMap.transform(m_yValue)),ctx=this.getContext();if(this.drawLines(ctx,canvasRect,pos),m_symbol&&m_symbol.style()!==NoSymbol){var sz=m_symbol.size(),clipRect;canvasRect.adjusted(-sz.width,-sz.height,sz.width,sz.height).contains(pos)&&m_symbol.drawSymbol(ctx,pos)}this.drawLabel(ctx,canvasRect,pos)}
/*!
          Align and draw the text label of the marker
    
          \param painter Painter
          \param canvasRect Contents rectangle of the canvas in painter coordinates
          \param pos Position of the marker, translated into widget coordinates
    
          \sa drawLabel(), QwtSymbol::drawSymbol()
        */,this.drawLabel=function(ctx,canvasRect,pos){if(""!==m_label){var align=m_labelAlignment,alignPos=pos,symbolOff=new Misc.Size(0,0);switch(m_style){case VLine:m_labelAlignment&Static.AlignTop?(alignPos.y=canvasRect.top(),align&=~Static.AlignTop,align|=Static.AlignBottom):m_labelAlignment&Static.AlignBottom?(alignPos.y=canvasRect.bottom()-1,align&=~Static.AlignBottom,align|=Static.AlignTop):alignPos.y=canvasRect.center().y;break;case HLine:m_labelAlignment&Static.AlignLeft?(alignPos.x=canvasRect.left(),align&=~Static.AlignLeft,align|=Static.AlignRight):m_labelAlignment&Static.AlignRight?(alignPos.x=canvasRect.right()-1,align&=~Static.AlignRight,align|=Static.AlignLeft):alignPos.x=canvasRect.center().x;break;default:if(m_symbol&&m_symbol.style()!==NoSymbol){var sz=m_symbol.size();symbolOff=new Misc.Size((sz.width+1)/2,(sz.height+1)/2)}}var pw2=m_pen.width/2;0==pw2&&(pw2=.5);var spacing=m_spacing,xOff=Math.max(pw2,symbolOff.width),yOff=Math.max(pw2,symbolOff.height),textSize=m_labelFont.textSize(m_label);align&Static.AlignLeft?(alignPos.x-=xOff+spacing,alignPos.x-=m_labelOrientation==Vertical?textSize.height:textSize.width):align&Static.AlignRight?(alignPos.x+=xOff+spacing,m_labelOrientation==Vertical&&(alignPos.x+=textSize.height)):alignPos.x-=m_labelOrientation==Vertical?textSize.height/2:textSize.width/2,align&Static.AlignTop?(alignPos.y-=yOff+spacing,m_labelOrientation!=Vertical&&(alignPos.y-=textSize.height)):align&Static.AlignBottom?(alignPos.y+=yOff+spacing,m_labelOrientation==Vertical&&(alignPos.y+=textSize.width)):m_labelOrientation==Vertical?alignPos.y+=textSize.width/2:alignPos.y-=textSize.height/2;var painter=new PaintUtil.Painter(ctx);painter.translate(alignPos.x,alignPos.y),painter.setFont(m_labelFont);var textRect=new Misc.Rect(0,0,textSize.width,textSize.height);m_labelOrientation==Vertical?painter.drawVerticalText(m_label,textRect.left()+.3*textSize.height,textRect.bottom()-.75*textSize.width):painter.drawText(m_label,textRect.left(),textRect.bottom()-2)}}
/*!
          Draw the lines marker
    
          \param painter Painter
          \param canvasRect Contents rectangle of the canvas in painter coordinates
          \param pos Position of the marker, translated into widget coordinates
    
          \sa drawLabel(), QwtSymbol::drawSymbol()
        */,this.drawLines=function(ctx,canvasRect,pos){if(m_style!=NoLine){var painter=new PaintUtil.Painter(ctx);if(painter.setPen(m_pen),m_style==HLine||m_style==Cross){var y=pos.y;painter.drawLine(canvasRect.left(),y,canvasRect.right()-1,y)}if(m_style==VLine||m_style==Cross){var x=pos.x;painter.drawLine(x,canvasRect.top(),x,canvasRect.bottom()-1)}painter=null}}
/*!
          \brief Set the line style
          \param style Line style.
          \sa lineStyle()
        */,this.setLineStyle=function(style){style!=m_style&&(m_style=style)}
/*!
          \return the line style
          \sa setLineStyle()
        */,this.lineStyle=function(){return m_style}
/*!
          Specify a pen for the line.
    
          \param pen New pen
          \sa linePen()
        */,this.setLinePen=function(pen){m_pen=pen,this.plot()&&this.plot().autoRefresh()}
/*!
          \return the line pen
          \sa setLinePen()
        */,this.linePen=function(){return m_pen},this.setZ(30),this.toString=function(){return"[PlotMarker]"}
/*!
           \return Icon representing the marker on the legend
        
           \param index Index of the legend entry 
                        ( usually there is only one )
           \param size Icon size
        
           \sa setLegendIconSize(), legendData()
        */,this.legendIcon=function(index,size){if(0===size.width&&0===size.height)return null;var graphic=new Graphic(null,size.width,size.height),painter=new PaintUtil.Painter(graphic);if(m_style!==NoLine){if(painter.setPen(this.linePen()),m_style==HLine||m_style==Cross){let y=.5*size.height;painter.drawLine(0,y,size.width,y)}if(m_style==VLine||m_style==Cross){let x=.5*size.width;painter.drawLine(x,0,x,size.height)}}if(this.symbol()){let sh=size.height/2;this.symbol().style()==Ellipse&&(sh-=1),painter.setPen(this.symbol().pen()),this.symbol().drawGraphicSymbol(painter,new Misc.Point(size.width/2,sh),size)}return painter=null,graphic}
/*!
        \return Icon representing the marker on the legend
        \param index Index of the legend entry 
                        ( usually there is only one )
        \param size Icon size
        \sa setLegendIconSize(), legendData()
        */}}define("plotMarker",["static","plotItem"],(function(){}));class Graphic{constructor(e,w,h){var m_parent=e,m_width=w,m_height=h,m_svg=document.createElementNS("http://www.w3.org/2000/svg","svg");m_svg.setAttribute("width",w),m_svg.setAttribute("height",h),this.parent&&this.parent[0].appendChild(m_svg),this.setParent=function(p){this.parent=p,this.parent[0].appendChild(m_svg)},this.parent=function(){return m_parent},this.setWidth=function(w){m_width=w},this.width=function(){return m_width},this.setHeight=function(h){m_height=h},this.height=function(){return m_height},this.svg=function(){return m_svg},this.toString=function(){return"[Graphic]"}}}function mDrawXCrossSymbols(ctx,points,symbol){var size=symbol.size(),pen=symbol.pen(),brush=symbol.brush(),sw=size.width,sh=size.height;ctx.beginPath(),ctx.strokeStyle=pen.color,ctx.lineWidth=pen.width;for(var i=0;i<points.length;i++){var x=points[i].x-.5*sw-1,y=points[i].y-.5*sh-1;ctx.moveTo(x,y),ctx.lineTo(x+sw,y+sh),ctx.moveTo(x+sw,y),ctx.lineTo(x,y+sh)}ctx.stroke()}function mDrawLineSymbols(ctx,orientations,points,symbol){var size=symbol.size(),pen=symbol.pen(),brush=symbol.brush(),sw=size.width,sh=size.height,painter=new PaintUtil.Painter(ctx);painter.setPen(pen),painter.save();for(var i=0;i<points.length;i++){if(orientations&Horizontal){var x=points[i].x-.5*sw-1,y=points[i].y-1;painter.drawLine(x,y,x+sw,y)}if(orientations&Vertical){var x=points[i].x-1,y=points[i].y-.5*sh-1;painter.drawLine(x,y,x,y+sh)}}painter.restore(),painter=null}function mDrawPathSymbols(ctx,points,symbol){var numPoints=points.length,size=symbol.size(),pen=symbol.pen(),brush=symbol.brush(),sw=size.width,sh=size.height,painter=new PaintUtil.Painter(ctx);painter.setPen(pen),painter.setBrush(brush);for(var i=0;i<numPoints;i++){var x=points[i].x,y=points[i].y,bRc=symbol.m_path.boundingRect();painter.save(),painter.translate(x,y),symbol.m_path.data.scale=Math.min(size.width/bRc.width(),size.height/bRc.height()),symbol.m_path.data.rotation&&painter.rotate(symbol.m_path.data.rotation);var pinpoint=symbol.pinPoint();painter.translate(-1*pinpoint.x,-1*pinpoint.y),painter.drawPath(symbol.m_path),painter.restore()}painter=null}function mDrawDiamondSymbols(ctx,points,symbol){var painter=new PaintUtil.Painter(ctx);painter.save(),painter.setBrush(symbol.brush()),painter.setPen(symbol.pen());for(var sz=symbol.size(),rc=new Misc.Rect(new Misc.Point,symbol.size()),numPoints=points.length,i=0;i<numPoints;i++)painter.save(),painter.translate(points[i].x-1,points[i].y-1),painter.rotate(45),painter.drawRect(-.5*sz.width,-.5*sz.height,sz.width,sz.height),painter.restore();painter.restore(),painter=null}function mDrawRectSymbols(ctx,points,symbol){var painter=new PaintUtil.Painter(ctx);painter.save(),painter.setBrush(symbol.brush()),painter.setPen(symbol.pen());for(var rc=new Misc.Rect(new Misc.Point,symbol.size()),numPoints=points.length,i=0;i<numPoints;i++)rc.moveCenter(points[i]),painter.drawRect(rc.left(),rc.top(),rc.width(),rc.height());painter.restore(),painter=null}function mDrawEllipseSymbols(ctx,points,symbol){var painter=new PaintUtil.Painter(ctx);painter.save(),painter.setBrush(symbol.brush()),painter.setPen(symbol.pen());for(var radius=Math.min(symbol.size().width,symbol.size().height)/2,numPoints=points.length,i=0;i<numPoints;i++)painter.drawCircle(points[i].x-1,points[i].y-1,radius);painter.restore(),painter=null}function mDrawCrossGraphicSymbol(painter,point,size,symbol){painter.setBrush(symbol.brush()),painter.setPen(symbol.pen());var rc=new Misc.Rect(new Misc.Point,symbol.size());rc.moveCenter(point),painter.drawLine(rc.left()+.5*rc.width(),rc.top(),rc.left()+.5*rc.width(),rc.bottom()),painter.drawLine(rc.left(),rc.top()+.5*rc.height(),rc.right(),rc.top()+.5*rc.height())}function mDrawXCrossGraphicSymbol(painter,point,size,symbol){painter.setBrush(symbol.brush()),painter.setPen(symbol.pen());var rc=new Misc.Rect(new Misc.Point,symbol.size());rc.moveCenter(point),painter.drawLine(rc.left(),rc.top(),rc.right(),rc.bottom()),painter.drawLine(rc.right(),rc.top(),rc.left(),rc.bottom())}function mDrawRectGraphicSymbol(painter,point,size,symbol){painter.setBrush(symbol.brush());var rc=new Misc.Rect(new Misc.Point,symbol.size());rc.moveCenter(point),painter.drawRect(rc.left(),rc.top(),rc.width(),rc.height())}function mDrawDiamondGraphicSymbol(painter,point,size,symbol){painter.setBrush(symbol.brush());var rc=new Misc.Rect(new Misc.Point,.707*symbol.size().width,.707*symbol.size().height);rc.moveCenter(point),painter.drawRect(rc.left(),rc.top(),rc.width(),rc.height()),painter.transform({rotation:45,rotationX:point.x,rotationY:point.y})}function mDrawEllipseGraphicSymbol(painter,point,size,symbol){painter.setBrush(symbol.brush());var radius=Math.min(symbol.size().width-symbol.pen().width,symbol.size().height-symbol.pen().width)/2;painter.drawCircle(point.x,point.y,radius)}function mDrawPathGraphicSymbol(painter,point,iconSize,symbol){var pen=symbol.pen(),pw=0;pen.style!==Static.NoPen&&(pw=Math.max(pen.width,1));var rc=symbol.path().boundingRect();rc=rc.adjusted(-pw,-pw,pw,pw);var data=symbol.path().data;data.xOffset=-1*rc.left(),data.yOffset=-1*rc.top(),data.xCenter=(rc.right()-rc.left())/2,data.yCenter=(rc.bottom()-rc.top())/2,painter.setBrush(symbol.brush()),painter.setPen(symbol.pen()),data.scale=Math.min(iconSize.width/rc.width(),iconSize.height/rc.height()),painter.drawPath(symbol.path())}
/*!
  Default Constructor
  \param style Symbol Style

  The symbol is constructed with gray interior,
  black outline with zero width, no size and style 'NoSymbol'.
*/define("graphic",(function(){}));class Symbol{constructor(style,brush,pen,size){var m_style=NoSymbol,m_size=new Misc.Size(-1,-1),m_brush=new Misc.Brush("gray"),m_pen=new Misc.Pen,m_isPinPointEnabled=!1;this.m_path=0;var m_pinpoint=new Misc.Point(0,0);void 0!==size?(m_style=style,m_brush=brush,m_pen=pen,m_size=size):void 0!==pen?(m_style=style,m_brush=brush,m_pen=pen):void 0!==brush?(m_style=style,m_brush=brush):void 0!==style&&(m_style=style),this.setPinPoint=function(pt){m_pinpoint=pt},this.pinPoint=function(pt){return m_pinpoint}
/*!
       Set the symbol's size
       \param size Size

       \sa size()
    */,this.setSize=function(size){size.isValid()&&!size.isEqual(m_size)&&(m_size=size)}
/*!
       \return Size
       \sa setSize()
    */,this.size=function(){return m_size}
/*!
      Specify the symbol style

      \param style Style
      \sa style()
    */,this.setStyle=function(style){m_style!=style&&(m_style=style)}
/*!
      \return Current symbol style
      \sa setStyle()
    */,this.style=function(){return m_style}
/*!
      \brief Set a painter path as symbol

      The symbol is represented by a painter path, where the 
      origin ( 0, 0 ) of the path coordinate system is mapped to
      the position of the symbol.

      When the symbol has valid size the painter path gets scaled
      to fit into the size. Otherwise the symbol size depends on
      the bounding rectangle of the path.

      \note The style is implicitely set to QwtSymbol::Path.
      \sa path(), setSize()
     */,this.setPath=function(path){m_style=Path,this.m_path=path}
/*!
       \return Painter path for displaying the symbol
       \sa setPath()
    */,this.path=function(){return this.m_path},this.setPen=function(pen){m_pen=pen},this.pen=function(){return m_pen}
/*!
      \brief Assign a brush

      The brush is used to draw the interior of the symbol.
      \param brush Brush

      \sa brush()
    */,this.setBrush=function(brush){m_brush=brush}
/*!
      \return Brush
      \sa setBrush()
    */,this.brush=function(){return m_brush},this.brush1=function(){return"noBrush"!==m_brush.color}
/*!
      Render an array of symbols

      Painting several symbols is more effective than drawing symbols
      one by one, as a couple of layout calculations and setting of pen/brush
      can be done once for the complete array.

      \param painter Painter
      \param points Array of points
      \param numPoints Number of points
    */,this.drawSymbols=function(ctx,points){if(!(points.length<=0)){var useCache=!1,dx,dy,i,left,top;this.renderSymbols(ctx,points)}},this.drawGraphicSymbol=function(painter,pos,size){this.renderGraphicSymbol(painter,pos,size)},this.drawSymbol=function(ctx,pos){this.drawSymbols(ctx,[pos])}
/*!
      Render the symbol to series of points

      \param painter Qt painter
      \param points Positions of the symbols
      \param numPoints Number of points
     */,this.renderSymbols=function(ctx,points){var numPoints=points.length;switch(m_style){case Ellipse:mDrawEllipseSymbols(ctx,points,this);break;case MRect:mDrawRectSymbols(ctx,points,this);break;case Diamond:mDrawDiamondSymbols(ctx,points,this);break;case Cross:mDrawLineSymbols(ctx,Horizontal|Vertical,points,this);break;case XCross:mDrawXCrossSymbols(ctx,points,this);break;case HLine:mDrawLineSymbols(ctx,Horizontal,points,this);break;case VLine:mDrawLineSymbols(ctx,Vertical,points,this);break;case Path:mDrawPathSymbols(ctx,points,this)}},this.renderGraphicSymbol=function(painter,point,size){if(m_style!==Cross||m_style!==XCross){var p=new Misc.Pen(this.pen());this.brush1()&&(p.width/=2),painter.setPen(p)}switch(m_style){case Ellipse:mDrawEllipseGraphicSymbol(painter,point,0,this);break;case MRect:mDrawRectGraphicSymbol(painter,point,0,this);break;case Diamond:mDrawDiamondGraphicSymbol(painter,point,0,this);break;case Cross:mDrawCrossGraphicSymbol(painter,point,0,this);break;case XCross:mDrawXCrossGraphicSymbol(painter,point,0,this);break;case HLine:case VLine:break;case Path:mDrawPathGraphicSymbol(painter,point,size,this)}}
/*!
      Calculate the bounding rectangle for a symbol
      at position (0,0).

      \return Bounding rectangle
     */,this.boundingRect=function(){var rect=new Misc.Rect;switch(m_style){case Ellipse:case MRect:case Hexagon:var pw=0;m_pen.style!=Static.NoPen&&(pw=Math.max(m_pen.width,1)),(rect=new Misc.Rect(new Misc.Point,m_size.width+pw,m_size.height+pw)).moveCenter(new Misc.Point);break;case XCross:case Diamond:case Triangle:case UTriangle:case DTriangle:case RTriangle:case LTriangle:case Star1:case Star2:var pw=0;m_pen.style!==Static.NoPen&&(pw=Math.max(m_pen.width,1)),(rect=new Misc.Rect(new Misc.Point,m_size.width+pw,m_size.height+pw)).moveCenter(new Misc.Point);break;case Path:rect=m_path.boundingRect(),console.log(rect.width()),rect.moveCenter(new Misc.Point);break;default:(rect=new Misc.Rect(new Misc.Point,m_size.width,m_size.height)).moveCenter(new Misc.Point)}var r=new Misc.Rect;return r.setLeft(Math.floor(rect.left())),r.setTop(Math.floor(rect.top())),r.setRight(Math.ceil(rect.right())),r.setBottom(Math.ceil(rect.bottom())),r}}toString(){return"[Symbol]"}}class ArrowSymbol extends Symbol{constructor(angle=0){super();var self=this;this.type="arrow",this.setPen(new Misc.Pen("black")),this.setBrush(new Misc.Brush("red"));var path=new Misc.MPath;path.moveTo(13,30),path.lineTo(13,15),path.lineTo(10,15),path.lineTo(13,10),path.lineTo(16,15),path.lineTo(13,15),path.data.rotation=angle,this.setPath(path),this.setPinPoint(new Misc.Point(13,10)),this.rotation=function(){return path.data.rotation},this.setRotation=function(val){path.data.rotation=val}}}class DotOnLineSymbol extends Symbol{constructor(angle=0){super();var self=this;this.type="dotOnLine",this.setPen(new Misc.Pen("black")),this.setBrush(new Misc.Brush("red"));var path=new Misc.MPath;path.moveTo(13,30),path.lineTo(13,15),path.addRect(new Misc.Rect(10,9,6,6)),path.data.rotation=angle,this.setPath(path),this.setPinPoint(new Misc.Point(14,13)),this.setSize(new Misc.Size(6,23)),this.rotation=function(){return path.data.rotation},this.setRotation=function(val){path.data.rotation=val}}}define("symbol",["static","graphic"],(function(){}));class CGMarker extends PlotMarker{constructor(){super("cgMarker@12345");var self=this;class CGSymbol extends Symbol{constructor(){super();var self=this;this.type="arrow",this.setPen(new Misc.Pen("black",2)),this.setBrush(new Misc.Brush("red"));var path=new Misc.MPath;path.moveTo(5,10),path.lineTo(5,0),path.moveTo(0,5),path.lineTo(10,5),this.setPath(path),this.setPinPoint(new Misc.Point(6,6)),this.setSize(new Misc.Size(12,12))}}self.setSymbol(new CGSymbol),self.setLabel("CG"),self.setLabelAlignment(Static.AlignCenter|Static.AlignBottom);var areaWatchEnabled=!1;Static.bind("watchEnabled",(function(e,watch,on){"Area below curve"===watch.name()&&(self.setVisible(on),areaWatchEnabled=on)})),Static.bind("showSidebar",(function(e,anchorPosition,on){on&&areaWatchEnabled?self.setVisible(!0):self.setVisible(!1)})),Static.bind("currentCurveChanged",(function(e,curve){null!=curve&&self.setAxes(curve.xAxis(),curve.yAxis())}))}}class WatchCurveName extends Watch{constructor(){super(),this.name=function(){return"Curve name"},this.computeWatch=function(){this._value=this._curveName}}}class WatchLeftRulerPosition extends Watch{constructor(rulerGroup){super(rulerGroup,Static.Left);var self=this;this.name=function(){return"Left ruler position"},this.valueType="number",this.computeWatch=function(){this._rulerLeft==Number.MAX_VALUE?this._value="Invalid":(this._value=Static.adjustForDecimalPlaces(this._rulerLeft,this._curve.plot().axisDecimalPlaces(this._curve.xAxis())),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,this._curve.plot().axisPrecision(this._curve.xAxis())))},this.cb=function(){var prevValue=self._value,pos=self._rulerGroup.setPosition(0,$(this).val());prevValue!==pos?Static.trigger("positionChanged",[self._rulerGroup.ruler(0),pos]):$(this).val(pos)}}}class WatchRightRulerPosition extends Watch{constructor(rulerGroup){super(rulerGroup,Static.Right);var self=this;this.name=function(){return"Right ruler position"},this.valueType="number",this.computeWatch=function(){this._rulerLeft==Number.MAX_VALUE?this._value="Invalid":(this._value=Static.adjustForDecimalPlaces(this._rulerRight,this._curve.plot().axisDecimalPlaces(this._curve.xAxis())),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,this._curve.plot().axisPrecision(this._curve.xAxis())))},this.cb=function(){var prevValue=self._value,pos=self._rulerGroup.setPosition(1,$(this).val());prevValue!==pos?Static.trigger("positionChanged",[self._rulerGroup.ruler(1),pos]):$(this).val(pos)}}}class WatchBottomRulerPosition extends Watch{constructor(rulerGroup){super(rulerGroup,Static.Bottom);var self=this;this.valueType="number",this.name=function(){return"Bottom ruler position"},this.computeWatch=function(){this._rulerBottom==Number.MAX_VALUE?this._value="Invalid":(this._value=Static.adjustForDecimalPlaces(this._rulerBottom,this._curve.plot().axisDecimalPlaces(this._curve.xAxis())),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,this._curve.plot().axisPrecision(this._curve.yAxis())))},this.cb=function(){var prevValue=self._value,pos=self._rulerGroup.setPosition(2,$(this).val());prevValue!==pos?Static.trigger("positionChanged",[self._rulerGroup.ruler(2),pos]):$(this).val(pos)}}}class WatchTopRulerPosition extends Watch{constructor(rulerGroup){super(rulerGroup,Static.Top);var self=this;this.valueType="number",this.name=function(){return"Top ruler position"},this.computeWatch=function(){this._rulerTop==Number.MAX_VALUE?this._value="Invalid":(this._value=Static.adjustForDecimalPlaces(this._rulerTop,this._curve.plot().axisDecimalPlaces(this._curve.xAxis())),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,this._curve.plot().axisPrecision(this._curve.yAxis())))},this.cb=function(){var prevValue=self._value,pos=self._rulerGroup.setPosition(3,$(this).val());prevValue!==pos?Static.trigger("positionChanged",[self._rulerGroup.ruler(3),pos]):$(this).val(pos)}}}class WatchSlope extends Watch{constructor(){super(Static.Left),this.name=function(){return"Slope at left ruler"},this.computeWatch=function(){if(1==self._magnifying||this._rulerLeft==this._rulerLeftPrevious)return;let m_value=0;var precisionY=this._curve.plot().axisPrecision(this._curve.yAxis()),precisionX=this._curve.plot().axisPrecision(this._curve.xAxis()),decimalPlacesY=this._curve.plot().axisDecimalPlaces(this._curve.yAxis()),decimalPlacesX=this._curve.plot().axisDecimalPlaces(this._curve.xAxis());let _rulerLeft=this._rulerLeftPrevious=this._rulerLeft;if(_rulerLeft=Static.adjustForDecimalPlaces(_rulerLeft,decimalPlacesX),this._rulerLeft!=Number.MAX_VALUE&&isFinite(this._rulerLeft)){if(this._curve.expandedFn&&!this._curve.expandedFn.includes("log")){var fn=this._curve.expandedFn;if("z"!=this._curve.variable)for(;-1!=fn.indexOf(this._curve.variable);)fn=fn.replace(this._curve.variable,"z");if(this._curve.coeffs)for(var i=0;i<this._curve.coeffs.length;++i)for(;-1!=fn.indexOf(this._curve.coeffs[i]);)fn=fn.replace(this._curve.coeffs[i],this._curve.coeffsVal[i]);return this._value=math.derivative(fn,"z").evaluate({z:_rulerLeft}),this._value=Static.adjustForDecimalPlaces(this._value,Math.max(decimalPlacesX,decimalPlacesY)),isNaN(this._value)&&(Static.watchUpdateError=!0),void(this._value=Static.toPrecision(this._value,Math.max(precisionX,precisionY)))}for(var numOfPoints=this._curve.dataSize(),x=this._rulerLeft,i=0;i<numOfPoints;++i)if(this._curve.sample(i).x>x){var p2=this._curve.sample(i),p1=this._curve.sample(i-1);return this._value=(p2.y-p1.y)/(p2.x-p1.x),this._value=Static.adjustForDecimalPlaces(this._value,Math.max(decimalPlacesX,decimalPlacesY)),isNaN(this._value)&&(Static.watchUpdateError=!0),void(this._value=Static.toPrecision(this._value,Math.max(precisionX,precisionY)))}}else this._value="Invalid"}}}class WatchAreaBelowCurve extends Watch{constructor(){super(Static.LeftAndRight);var self=this,cgMarker=null,plot=null;this.name=function(){return"Area below curve"},this.computeWatch=function(){if(1==self._magnifying||this._rulerLeft==this._rulerLeftPrevious&&this._rulerRight==this._rulerRightPrevious)return;let m_value=0;var precisionY=this._curve.plot().axisPrecision(this._curve.yAxis()),precisionX=this._curve.plot().axisPrecision(this._curve.xAxis()),decimalPlacesY=this._curve.plot().axisDecimalPlaces(this._curve.yAxis()),decimalPlacesX=this._curve.plot().axisDecimalPlaces(this._curve.xAxis());let _rulerLeft=this._rulerLeftPrevious=this._rulerLeft,_rulerRight=this._rulerRightPrevious=this._rulerRight;_rulerLeft=Static.adjustForDecimalPlaces(_rulerLeft,decimalPlacesX),_rulerRight=Static.adjustForDecimalPlaces(_rulerRight,decimalPlacesX);var widthPx=this._curve.plot().transform(this._curve.xAxis(),_rulerRight)-this._curve.plot().transform(this._curve.xAxis(),_rulerLeft),step=Static.accuracyFactor*(_rulerRight-_rulerLeft)/widthPx;if(isNaN(step)||0===step)console.log(step);else if(cgMarker||((cgMarker=new CGMarker).setAxes(this._curve.xAxis(),this._curve.yAxis()),plot=this._curve.plot(),cgMarker.attach(plot)),_rulerLeft!=Number.MAX_VALUE&&isFinite(_rulerLeft)&&_rulerRight!=Number.MAX_VALUE&&isFinite(_rulerRight)){if(this._curve.expandedFn){var fn;if(fn=logBaseAdjust(fn=this._curve.expandedFn),"z"!=this._curve.variable)for(;-1!=fn.indexOf(this._curve.variable);)fn=fn.replace(this._curve.variable,"z");if(this._curve.coeffs)for(var i=0;i<this._curve.coeffs.length;++i)for(;-1!=fn.indexOf(this._curve.coeffs[i]);)fn=fn.replace(this._curve.coeffs[i],this._curve.coeffsVal[i]);this._value=math.evaluate("integrate("+fn+", z,"+_rulerLeft+","+_rulerRight+",false,"+step+")");var twoAbarY=math.evaluate("integrate((("+fn+")*("+fn+")), z,"+_rulerLeft+","+_rulerRight+",false,"+step+")"),AbarX=math.evaluate("integrate(z * ("+fn+"), z,"+_rulerLeft+","+_rulerRight+",false,"+step+")");m_value=this._value,this._value=Static.adjustForDecimalPlaces(this._value,decimalPlacesX+decimalPlacesY),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,precisionX+precisionY);var barY=Static.adjustForDecimalPlaces(twoAbarY/(2*m_value),decimalPlacesY);isNaN(barY)&&(Static.watchUpdateError=!0),barY=Static.toPrecision(barY,precisionY);var barX=Static.adjustForDecimalPlaces(AbarX/m_value,decimalPlacesX);return isNaN(barX)&&(Static.watchUpdateError=!0),barX=Static.toPrecision(barX,precisionY),void(Static.watchCentroidWithArea?(0==this._value&&(barX=barY="Infinity"),this._value+=" centroid:("+barX+", "+barY+")",cgMarker.setValue(barX,barY),cgMarker.setVisible(!0)):cgMarker.setVisible(!1))}var numOfPoints=this._curve.dataSize();this._value=0;for(var twoAbarY=0,AbarX=0,i=1;i<numOfPoints;++i){var p2=this._curve.sample(i),p1=this._curve.sample(i-1),fn=Utility.linearEquationFromPoints(p1,p2),left=p1.x;if(!(p2.x<_rulerLeft)&&!(p1.x>_rulerRight)){left<_rulerLeft&&(left=_rulerLeft);var right=p2.x;right>_rulerRight&&(right=_rulerRight),this._value+=math.evaluate("integrate("+fn+", x,"+left+","+right+",false,"+step+")"),twoAbarY+=math.evaluate("integrate((("+fn+")*("+fn+")), x,"+left+","+right+",false,"+step+")"),AbarX+=math.evaluate("integrate(x * ("+fn+"), x,"+left+","+right+",false,"+step+")")}}m_value=this._value,this._value=Static.adjustForDecimalPlaces(this._value,decimalPlacesX+decimalPlacesY),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,precisionX+precisionY);var barY=Static.adjustForDecimalPlaces(twoAbarY/(2*m_value),decimalPlacesY);isNaN(barY)&&(Static.watchUpdateError=!0);var barX=Static.adjustForDecimalPlaces(AbarX/m_value,decimalPlacesX);isNaN(barX)&&(Static.watchUpdateError=!0),barY=Static.toPrecision(barY,precisionY),barX=Static.toPrecision(barX,precisionX),Static.watchCentroidWithArea?(0==this._value&&(barX=barY="Infinity"),this._value+=" centroid:("+barX+", "+barY+")",cgMarker.setValue(barX,barY),cgMarker.setVisible(!0)):cgMarker.setVisible(!1)}else this._value="Invalid"}}}class WatchVolumeOfRevolution extends Watch{constructor(){super(Static.LeftAndRight);var self=this;function getvolume(y1,y2,w){var volume=y1*w*Math.PI*y1;return volume+=.5*(y2-y1)*w*(y1+(y2-y1)/3)*2*Math.PI}this.name=function(){return"Volume of revolution"},this.computeWatch=function(){if(1==self._magnifying||this._rulerLeft==this._rulerLeftPrevious&&this._rulerRight==this._rulerRightPrevious)return;var precisionY=this._curve.plot().axisPrecision(this._curve.yAxis()),precisionX=this._curve.plot().axisPrecision(this._curve.xAxis()),decimalPlacesY=this._curve.plot().axisDecimalPlaces(this._curve.yAxis()),decimalPlacesX=this._curve.plot().axisDecimalPlaces(this._curve.xAxis());let _rulerLeft=this._rulerLeftPrevious=this._rulerLeft,_rulerRight=this._rulerRightPrevious=this._rulerRight;_rulerLeft=Static.adjustForDecimalPlaces(_rulerLeft,decimalPlacesX),_rulerRight=Static.adjustForDecimalPlaces(_rulerRight,decimalPlacesX);var widthPx=this._curve.plot().transform(this._curve.xAxis(),_rulerRight)-this._curve.plot().transform(this._curve.xAxis(),_rulerLeft),step=Static.accuracyFactor*(_rulerRight-_rulerLeft)/widthPx;if(isNaN(step)||0===step)console.log(step);else if(this._rulerLeft!=Number.MAX_VALUE&&isFinite(this._rulerLeft)){if(this._curve.expandedFn){var fn=this._curve.expandedFn;if(fn=logBaseAdjust(fn),"x"!=this._curve.variable)for(;-1!=fn.indexOf(this._curve.variable);)fn=fn.replace(this._curve.variable,"x");if(this._curve.coeffs)for(var i=0;i<this._curve.coeffs.length;++i)for(;-1!=fn.indexOf(this._curve.coeffs[i]);)fn=fn.replace(this._curve.coeffs[i],this._curve.coeffsVal[i]);return this._value=math.evaluate("integrate("+fn+", x,"+this._rulerLeft+","+this._rulerRight+",true,"+step+")"),this._value=Static.adjustForDecimalPlaces(this._value,decimalPlacesX+2*decimalPlacesY),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,2*precisionX+precisionY),void(isNaN(this._value)&&(this._value="< 1E-300"))}for(var numOfPoints=this._curve.dataSize(),xLeft=this._rulerLeft,xRight=this._rulerRight,A0=0,An=0,Ai=0,i=1;i<numOfPoints;++i){var p2=this._curve.sample(i),p1=this._curve.sample(i-1),y;if(!A0&&p2.x>xLeft&&p2.x<=xRight)A0=getvolume(y=p1.y+(p2.y-p1.y)*(xLeft-p1.x)/(p2.x-p1.x),p2.y,p2.x-xLeft);else if(A0&&p2.x<=xRight)Ai+=getvolume(p2.y,p1.y,p2.x-p1.x);else if(p2.x>xRight){if(p1.x>=xLeft){var y;An=getvolume(y=p2.y+(p2.y-p1.y)*(xRight-p2.x)/(p2.x-p1.x),p1.y,xRight-p1.x);break}var y2,y1;An=getvolume(p2.y+(p2.y-p1.y)*(xRight-p2.x)/(p2.x-p1.x),p1.y+(p2.y-p1.y)*(xLeft-p1.x)/(p2.x-p1.x),xRight-xLeft);break}}this._value=Static.adjustForDecimalPlaces(A0+Ai+An,decimalPlacesY+2*decimalPlacesX),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,2*precisionY+precisionX),isNaN(this._value)&&(this._value="< 1E-300")}else this._value="Invalid"}}}define("basicWatch",["static","watch","plotMarker","symbol"],(function(){})),function($,window,document,undefined){"use strict";var single;$.single=(single=$({}),function(elm){return single[0]=elm,single}),$.fn.contextMenu=function(method,selector,option){methods[method]?selector&&(selector instanceof Array||"string"==typeof selector||selector.nodeType||selector.jquery||(option=selector,selector=null)):(option=selector,selector=method,method="popup"),selector instanceof Array&&"update"!=method&&(method="menu");var myoptions=option;return $.inArray(method,["menu","popup","close","destroy"])>-1?(option=iMethods.optionOtimizer(method,option),this.each((function(){var $this=$(this);(myoptions=$.extend({},$.fn.contextMenu.defaults,option)).baseTrigger||(myoptions.baseTrigger=$this),methods[method].call($this,selector,myoptions)}))):methods[method].call(this,selector,myoptions),this},$.fn.contextMenu.defaults={triggerOn:"click",subMenuTriggerOn:"hover click",displayAround:"cursor",mouseClick:"left",verAdjust:0,horAdjust:0,top:"auto",left:"auto",closeOther:!0,containment:window,winEventClose:!0,position:"auto",closeOnClick:!0,onOpen:function(data,event){},afterOpen:function(data,event){},onClose:function(data,event){}};var methods={menu:function(selector,option){selector=iMethods.createMenuList(this,selector,option),iMethods.contextMenuBind.call(this,selector,option,"menu")},popup:function(selector,option){$(selector).addClass("iw-contextMenu"),iMethods.contextMenuBind.call(this,selector,option,"popup")},update:function(selector,option){var self=this;option=option||{},this.each((function(){var trgr=$(this),menuData=trgr.data("iw-menuData");menuData||(self.contextMenu("refresh"),menuData=trgr.data("iw-menuData"));var menu=menuData.menu;if("object"==typeof selector)for(var i=0;i<selector.length;i++){var name=selector[i].name,disable=selector[i].disable,fun=selector[i].fun,icon=selector[i].icon,img=selector[i].img,title=selector[i].title,className=selector[i].className,elm=menu.children("li").filter((function(){return $(this).contents().filter((function(){return 3==this.nodeType})).text()==name})),subMenu=selector[i].subMenu;null!=disable&&(disable?elm.addClass("iw-mDisable"):elm.removeClass("iw-mDisable")),fun&&elm.unbind("click.contextMenu").bind("click.contextMenu",fun),null!=title&&elm.attr("title",title),null!=className&&elm.attr("class",className);var imgIcon=elm.find(".iw-mIcon");imgIcon.length&&imgIcon.remove(),img?elm.prepend('<img src="'+img+'" align="absmiddle" class="iw-mIcon" />'):icon&&elm.prepend('<span align="absmiddle" class="iw-mIcon '+icon+'" />'),subMenu&&elm.contextMenu("update",subMenu)}iMethods.onOff(menu);var triggerOn=option.triggerOn;if(triggerOn){trgr.unbind(".contextMenu");for(var events=[],i=0,ln=(triggerOn=triggerOn.split(" ")).length;i<ln;i++)events.push(triggerOn[i]+".contextMenu");trgr.bind(events.join(" "),iMethods.eventHandler)}menuData.option=$.extend({},menuData.option,option),trgr.data("iw-menuData",menuData)}))},refresh:function(){var menuData=this.filter((function(){return!!$(this).data("iw-menuData")})).data("iw-menuData"),newElm=this.filter((function(){return!$(this).data("iw-menuData")}));menuData.option.baseTrigger=this,iMethods.contextMenuBind.call(newElm,menuData.menuSelector,menuData.option)},open:function(sel,data){var e=(data=data||{}).event||$.Event("click");data.top&&(e.clientY=data.top),data.left&&(e.clientX=data.left),this.each((function(){iMethods.eventHandler.call(this,e)}))},close:function(){var menuData=this.data("iw-menuData");menuData&&iMethods.closeContextMenu(menuData.option,this,menuData.menu,null)},value:function(key){var menuData=this.data("iw-menuData");return menuData[key]?menuData[key]:menuData.option?menuData.option[key]:null},destroy:function(){var trgr=this,menuId=this.data("iw-menuData").menuId,menu=$(".iw-contextMenu[menuId="+menuId+"]"),menuData=menu.data("iw-menuData");menuData&&(1==menuData.noTrigger?menu.hasClass("iw-created")?menu.remove():(menu.removeClass("iw-contextMenu "+menuId).removeAttr("menuId").removeData("iw-menuData"),menu.find("li.iw-mTrigger").contextMenu("destroy")):(menuData.noTrigger--,menu.data("iw-menuData",menuData)),this.unbind(".contextMenu").removeClass("iw-mTrigger").removeData("iw-menuData"))}},iMethods={contextMenuBind:function(selector,option,method){var trigger=this,menu=$(selector),menuData=menu.data("iw-menuData");if(0!=menu.length||0!=(menu=trigger.find(selector)).length){"menu"==method&&iMethods.menuHover(menu);var baseTrigger=option.baseTrigger;if(menuData)menuData.noTrigger++,menu.data("iw-menuData",menuData);else{var menuId;baseTrigger.data("iw-menuData")?menuId=baseTrigger.data("iw-menuData").menuId:(menuId=Math.ceil(1e5*Math.random()),baseTrigger.data("iw-menuData",{menuId:menuId}));var cloneMenu=menu.clone();cloneMenu.appendTo("body"),menuData={menuId:menuId,menuWidth:cloneMenu.outerWidth(!0),menuHeight:cloneMenu.outerHeight(!0),noTrigger:1,trigger:trigger},menu.data("iw-menuData",menuData).attr("menuId",menuId),cloneMenu.remove()}trigger.addClass("iw-mTrigger").data("iw-menuData",{menuId:menuData.menuId,option:option,menu:menu,menuSelector:selector,method:method});var triggerOn=option.triggerOn;-1!=triggerOn.indexOf("hover")&&(triggerOn=triggerOn.replace("hover","mouseenter"),-1!=baseTrigger.index(trigger)&&baseTrigger.add(menu).bind("mouseleave.contextMenu",(function(e){0==$(e.relatedTarget).closest(".iw-contextMenu").length&&$('.iw-contextMenu[menuId="'+menuData.menuId+'"]').fadeOut(100)}))),trigger.delegate("input,a,.needs-click","click",(function(e){e.stopImmediatePropagation()}));for(var events=[],i=0,ln=(triggerOn=triggerOn.split(" ")).length;i<ln;i++)events.push(triggerOn[i]+".contextMenu");trigger.bind(events.join(" "),iMethods.eventHandler),menu.bind("click mouseenter",(function(e){e.stopPropagation()})),menu.delegate("li","click",(function(e){option.closeOnClick&&!$.single(this).hasClass("iw-has-submenu")&&iMethods.closeContextMenu(option,trigger,menu,e)}))}},eventHandler:function(e){e.preventDefault();var trigger=$(this),trgrData=trigger.data("iw-menuData"),menu=trgrData.menu,menuData=menu.data("iw-menuData"),option=trgrData.option,cntnmnt=option.containment,clbckData={trigger:trigger,menu:menu},cntWin=cntnmnt==window,btChck=-1==option.baseTrigger.index(trigger);!btChck&&option.closeOther&&$(".iw-contextMenu").css("display","none"),menu.find(".iw-mSelected").removeClass("iw-mSelected"),option.onOpen.call(this,clbckData,e);var cObj=$(cntnmnt),cHeight=cObj.innerHeight(),cWidth=cObj.innerWidth(),cTop=0,cLeft=0,menuHeight=menuData.menuHeight,menuWidth=menuData.menuWidth,va,ha,left=0,top=0,bottomMenu,rightMenu,verAdjust=va=parseInt(option.verAdjust),horAdjust=ha=parseInt(option.horAdjust);if(cntWin||(cTop=cObj.offset().top,cLeft=cObj.offset().left,"static"==cObj.css("position")&&cObj.css("position","relative")),"cursor"==option.displayAround)left=cntWin?e.clientX:e.clientX+$(window).scrollLeft()-cLeft,(bottomMenu=(top=cntWin?e.clientY:e.clientY+$(window).scrollTop()-cTop)+menuHeight)>cHeight&&(top-menuHeight<0?bottomMenu-cHeight<menuHeight-top?(top=cHeight-menuHeight,va*=-1):(top=0,va=0):(top-=menuHeight,va*=-1)),(rightMenu=left+menuWidth)>cWidth&&(left-menuWidth<0?rightMenu-cWidth<menuWidth-left?(left=cWidth-menuWidth,ha*=-1):(left=0,ha=0):(left-=menuWidth,ha*=-1));else if("trigger"==option.displayAround){var triggerHeight=trigger.outerHeight(!0),triggerWidth=trigger.outerWidth(!0),triggerLeft=cntWin?trigger.offset().left-cObj.scrollLeft():trigger.offset().left-cLeft,triggerTop=cntWin?trigger.offset().top-cObj.scrollTop():trigger.offset().top-cTop,leftShift=triggerWidth;(bottomMenu=(top=triggerTop)+menuHeight)>cHeight&&(top-menuHeight<0?bottomMenu-cHeight<menuHeight-top?(top=cHeight-menuHeight,va*=-1):(top=0,va=0):(top=top-menuHeight+triggerHeight,va*=-1)),(rightMenu=(left=triggerLeft+triggerWidth)+menuWidth)>cWidth&&(left-menuWidth<0?rightMenu-cWidth<menuWidth-left?(left=cWidth-menuWidth,ha*=-1,leftShift=-triggerWidth):(left=0,ha=0,leftShift=0):(left=left-menuWidth-triggerWidth,ha*=-1,leftShift=-triggerWidth)),"top"==option.position?(top=triggerTop-menuHeight,va=verAdjust,left-=leftShift):"left"==option.position?(left=triggerLeft-menuWidth,ha=horAdjust):"bottom"==option.position?(top=triggerTop+triggerHeight,va=verAdjust,left-=leftShift):"right"==option.position&&(left=triggerLeft+triggerWidth,ha=horAdjust)}var cssObj={position:cntWin||btChck?"fixed":"absolute",display:"inline-block",height:"",width:""};if("auto"!=option.left&&(left=iMethods.getPxSize(option.left,cWidth)),"auto"!=option.top&&(top=iMethods.getPxSize(option.top,cHeight)),!cntWin){var oParPos=trigger.offsetParent().offset();btChck?(left=left+cLeft-$(window).scrollLeft(),top=top+cTop-$(window).scrollTop()):(left-=cLeft-oParPos.left,top-=cTop-oParPos.top)}cssObj.left=left+ha+"px",cssObj.top=top+va+"px",menu.css(cssObj),option.afterOpen.call(this,clbckData,e),0==trigger.closest(".iw-contextMenu").length&&($(".iw-curMenu").removeClass("iw-curMenu"),menu.addClass("iw-curMenu"));var dataParm={trigger:trigger,menu:menu,option:option,method:trgrData.method};$("html").unbind("click",iMethods.clickEvent).click(dataParm,iMethods.clickEvent),$(document).unbind("keydown",iMethods.keyEvent).keydown(dataParm,iMethods.keyEvent),option.winEventClose&&$(window).bind("scroll resize",dataParm,iMethods.scrollEvent)},scrollEvent:function(e){iMethods.closeContextMenu(e.data.option,e.data.trigger,e.data.menu,e)},clickEvent:function(e){var button;e.data.trigger.get(0)!==e.target&&0==$(e.target).closest(".iw-contextMenu").length&&iMethods.closeContextMenu(e.data.option,e.data.trigger,e.data.menu,e)},keyEvent:function(e){e.preventDefault();var menu=e.data.menu,option=e.data.option,keyCode=e.keyCode;if(27==keyCode&&iMethods.closeContextMenu(option,e.data.trigger,menu,e),"menu"==e.data.method){var curMenu=$(".iw-curMenu"),optList=curMenu.children("li:not(.iw-mDisable)"),selected=optList.filter(".iw-mSelected"),index=optList.index(selected),focusOn=function(elm){var menuData;iMethods.selectMenu(curMenu,elm),elm.data("iw-menuData")&&iMethods.eventHandler.call(elm[0],e)},first=function(){focusOn(optList.filter(":first"))},last=function(){focusOn(optList.filter(":last"))},next=function(){focusOn(optList.filter(":eq("+(index+1)+")"))},prev=function(){focusOn(optList.filter(":eq("+(index-1)+")"))},subMenu=function(){var menuData=selected.data("iw-menuData");if(menuData){iMethods.eventHandler.call(selected[0],e);var selector=menuData.menu;selector.addClass("iw-curMenu"),curMenu.removeClass("iw-curMenu"),optList=(curMenu=selector).children("li:not(.iw-mDisable)"),selected=optList.filter(".iw-mSelected"),first()}},parMenu=function(){var selector,parMenu=curMenu.data("iw-menuData").trigger.closest(".iw-contextMenu");0!=parMenu.length&&(curMenu.removeClass("iw-curMenu").css("display","none"),parMenu.addClass("iw-curMenu"))};switch(keyCode){case 13:selected.click();break;case 40:index==optList.length-1||0==selected.length?first():next();break;case 38:0==index||0==selected.length?last():prev();break;case 33:first();break;case 34:last();break;case 37:parMenu();break;case 39:subMenu()}}},closeContextMenu:function(option,trigger,menu,e){$(document).unbind("keydown",iMethods.keyEvent),$("html").unbind("click",iMethods.clickEvent),$(window).unbind("scroll resize",iMethods.scrollEvent),$(".iw-contextMenu").css("display","none"),$(document).focus(),option.onClose.call(this,{trigger:trigger,menu:menu},e)},getPxSize:function(size,of){return isNaN(size)?-1!=size.indexOf("%")?parseInt(size)*of/100:parseInt(size):size},selectMenu:function(menu,elm){var selected=menu.find("li.iw-mSelected"),submenu=selected.find(".iw-contextMenu");0!=submenu.length&&selected[0]!=elm[0]&&submenu.fadeOut(100),selected.removeClass("iw-mSelected"),elm.addClass("iw-mSelected")},menuHover:function(menu){var lastEventTime=Date.now();menu.children("li").bind("mouseenter.contextMenu click.contextMenu",(function(e){$(".iw-curMenu").removeClass("iw-curMenu"),menu.addClass("iw-curMenu"),iMethods.selectMenu(menu,$(this))}))},createMenuList:function(trgr,selector,option){var baseTrigger=option.baseTrigger,randomNum=Math.floor(1e4*Math.random());if("object"==typeof selector&&!selector.nodeType&&!selector.jquery){var menuList=$('<ul class="iw-contextMenu iw-created iw-cm-menu" id="iw-contextMenu'+randomNum+'"></ul>'),z=option.zIndex||trgr.css("zIndex");if(menuList.css("zIndex",z),$.each(selector,(function(index,selObj){var name=selObj.name,fun=selObj.fun||function(){},subMenu=selObj.subMenu,img=selObj.img||"",icon=selObj.icon||"",title=selObj.title||"",className=selObj.className||"",disable=selObj.disable,list=$('<li title="'+title+'" class="'+className+'">'+name+"</li>");img?list.prepend('<img src="'+img+'" align="absmiddle" class="iw-mIcon" />'):icon&&list.prepend('<span align="absmiddle" class="iw-mIcon '+icon+'" />'),disable&&list.addClass("iw-mDisable"),subMenu||list.bind("click.contextMenu",(function(e){fun.call(this,{trigger:baseTrigger,menu:menuList},e)})),menuList.append(list),subMenu&&(list.addClass("iw-has-submenu").append('<div class="iw-cm-arrow-right" />'),iMethods.subMenu(list,subMenu,baseTrigger,option))})),-1==baseTrigger.index(trgr[0]))trgr.append(menuList);else{var par=option.containment==window?"body":option.containment;$(par).append(menuList)}return iMethods.onOff($("#iw-contextMenu"+randomNum)),"#iw-contextMenu"+randomNum}if(0!=$(selector).length){var element=$(selector);return element.removeClass("iw-contextMenuCurrent").addClass("iw-contextMenu iw-cm-menu iw-contextMenu"+randomNum).attr("menuId","iw-contextMenu"+randomNum).css("display","none"),element.find("ul").each((function(index,element){var subMenu=$(this),parent=subMenu.parent("li");parent.append('<div class="iw-cm-arrow-right" />'),subMenu.addClass("iw-contextMenuCurrent"),iMethods.subMenu(parent,".iw-contextMenuCurrent",baseTrigger,option)})),iMethods.onOff($(".iw-contextMenu"+randomNum)),".iw-contextMenu"+randomNum}},subMenu:function(trigger,selector,baseTrigger,option){trigger.contextMenu("menu",selector,{triggerOn:option.subMenuTriggerOn,displayAround:"trigger",position:"auto",mouseClick:"left",baseTrigger:baseTrigger,containment:option.containment})},onOff:function(menu){menu.find(".iw-mOverlay").remove(),menu.find(".iw-mDisable").each((function(){var list=$(this);list.append('<div class="iw-mOverlay"/>'),list.find(".iw-mOverlay").bind("click mouseenter",(function(event){event.stopPropagation()}))}))},optionOtimizer:function(method,option){if(option)return"menu"==method&&(option.mouseClick||(option.mouseClick="right")),"right"==option.mouseClick&&"click"==option.triggerOn&&(option.triggerOn="contextmenu"),-1!=$.inArray(option.triggerOn,["hover","mouseenter","mouseover","mouseleave","mouseout","focusin","focusout"])&&(option.displayAround="trigger"),option}}}(jQuery,window,document),define("contextMenu",(function(){}));class LegendMenu{constructor(plot){var self=this,el=null,table=null,m_curve=null,penWidthSubMenu=[{name:"1",fun:function(){var curve=m_curve;if(curve&&curve.rtti==Static.Rtti_PlotSpectroCurve)return curve.setPenWidth(1),void Static.trigger("penAttributeChanged",curve);if(curve&&curve.rtti===Static.Rtti_PlotCurve){var pen=curve.pen();pen.width=1,curve.setPen(pen),Static.trigger("penAttributeChanged",curve)}}},{name:"2",fun:function(){var curve=m_curve;if(curve&&curve.rtti==Static.Rtti_PlotSpectroCurve)return curve.setPenWidth(2),void Static.trigger("penAttributeChanged",curve);if(curve&&curve.rtti===Static.Rtti_PlotCurve){var pen=curve.pen();pen.width=2,curve.setPen(pen),Static.trigger("penAttributeChanged",curve)}}},{name:"3",fun:function(){var curve=m_curve;if(curve&&curve.rtti==Static.Rtti_PlotSpectroCurve)return curve.setPenWidth(3),void Static.trigger("penAttributeChanged",curve);if(curve&&curve.rtti===Static.Rtti_PlotCurve){var pen=curve.pen();pen.width=3,curve.setPen(pen),Static.trigger("penAttributeChanged",curve)}}},{name:"4",fun:function(){var curve=m_curve;if(curve&&curve.rtti==Static.Rtti_PlotSpectroCurve)return curve.setPenWidth(4),void Static.trigger("penAttributeChanged",curve);if(curve&&curve.rtti===Static.Rtti_PlotCurve){var pen=curve.pen();pen.width=4,curve.setPen(pen),Static.trigger("penAttributeChanged",curve)}}},{name:"5",fun:function(){var curve=m_curve;if(curve&&curve.rtti==Static.Rtti_PlotSpectroCurve)return curve.setPenWidth(5),void Static.trigger("penAttributeChanged",curve);if(curve&&curve.rtti===Static.Rtti_PlotCurve){var pen=curve.pen();pen.width=5,curve.setPen(pen),Static.trigger("penAttributeChanged",curve)}}}];this.getPenWidthSubMenu=function(){return penWidthSubMenu};var penSubMenu=[{name:"color",fun:function(){var colorSelector=$('<input type="color" style="opacity:0;">'),curve=m_curve;curve&&curve.rtti===Static.Rtti_PlotCurve&&(colorSelector.val(Static.colorNameToHex(curve.pen().color)),colorSelector.change((function(){var pen=curve.pen();pen.color=$(this).val(),curve.setPen(pen),Static.trigger("penAttributeChanged",curve)})),colorSelector.trigger("click"))}},{name:"line style",subMenu:[{name:"solid",fun:function(){var curve=m_curve;if(curve&&curve.rtti===Static.Rtti_PlotCurve){var pen=curve.pen();pen.style="solid",curve.setPen(pen),Static.trigger("penAttributeChanged",curve)}}},{name:"dot",fun:function(){var curve=m_curve;if(curve&&curve.rtti===Static.Rtti_PlotCurve){var pen=curve.pen();pen.style="dot",curve.setPen(pen),Static.trigger("penAttributeChanged",curve)}}},{name:"dash",fun:function(){var curve=m_curve;if(curve&&curve.rtti===Static.Rtti_PlotCurve){var pen=curve.pen();pen.style="dash",curve.setPen(pen),Static.trigger("penAttributeChanged",curve)}}},{name:"dashDot",fun:function(){var curve=m_curve;if(curve&&curve.rtti===Static.Rtti_PlotCurve){var pen=curve.pen();pen.style="dashDot",curve.setPen(pen),Static.trigger("penAttributeChanged",curve)}}},{name:"dashDotDot",fun:function(){var curve=m_curve;if(curve&&curve.rtti===Static.Rtti_PlotCurve){var pen=curve.pen();pen.style="dashDotDot",curve.setPen(pen),Static.trigger("penAttributeChanged",curve)}}}]},{name:"pen width",subMenu:penWidthSubMenu}];this.getPenSubMenu=function(){return penSubMenu};var subMenu1=[{name:"style",subMenu:[{name:"Rectangle",fun:function(){Utility.addSymbol(m_curve,MRect)}},{name:"Cross",fun:function(){Utility.addSymbol(m_curve,Cross)}},{name:"Diamond",fun:function(){Utility.addSymbol(m_curve,Diamond)}},{name:"Ellipse",fun:function(){Utility.addSymbol(m_curve,Ellipse)}},{name:"Diagonal cross",fun:function(){Utility.addSymbol(m_curve,XCross)}},{name:"None",fun:function(){var curve=m_curve;curve&&curve.rtti===Static.Rtti_PlotCurve&&curve.setSymbol(null)}}]}],subMenu2=[{name:"style",subMenu:[{name:"Rectangle",fun:function(){Utility.addSymbol(m_curve,MRect)}},{name:"Cross",fun:function(){Utility.addSymbol(m_curve,Cross)}},{name:"Diamond",fun:function(){Utility.addSymbol(m_curve,Diamond)}},{name:"Ellipse",fun:function(){Utility.addSymbol(m_curve,Ellipse)}},{name:"Diagonal cross",fun:function(){Utility.addSymbol(m_curve,XCross)}},{name:"None",fun:function(){var curve;m_curve&&Utility.addSymbol(m_curve,NoSymbol)}}]},{name:"size",subMenu:[{name:"5x5",fun:function(){Utility.setSymbolSize(m_curve,5)}},{name:"6x6",fun:function(){Utility.setSymbolSize(m_curve,6)}},{name:"8x8",fun:function(){Utility.setSymbolSize(m_curve,8)}},{name:"10x10",fun:function(){Utility.setSymbolSize(m_curve,10)}},{name:"12x12",fun:function(){Utility.setSymbolSize(m_curve,12)}},{name:"15x15",fun:function(){Utility.setSymbolSize(m_curve,15)}}]},{name:"fill brush",fun:function(){var colorSelector=$('<input type="color" style="opacity:0;">'),curve=m_curve;if(curve){var sym=curve.symbol();if(sym){var brush=sym.brush(),c=brush.color;"noBrush"==c&&(c="#000000"),colorSelector.val(Static.colorNameToHex(c)),colorSelector.change((function(){$(this).remove(),brush.color=$(this).val(),sym.setBrush(brush),plot.autoRefresh(),plot.updateLegend(curve),Static.trigger("symbolAttributeChanged",curve)})),colorSelector.trigger("click")}}}},{name:"pen",subMenu:[{name:"color",fun:function(){var colorSelector=$('<input type="color" style="opacity:0;">'),curve=m_curve;if(curve){var sym=curve.symbol();sym&&(colorSelector.val(Static.colorNameToHex(sym.pen().color)),colorSelector.change((function(){var pen=sym.pen();pen.color=$(this).val(),sym.setPen(pen),plot.autoRefresh(),plot.updateLegend(curve),Static.trigger("symbolAttributeChanged",curve)})),colorSelector.trigger("click"))}}},{name:"pen width",subMenu:[{name:"1",fun:function(){Utility.setSymbolPenWidth(m_curve,1)}},{name:"2",fun:function(){Utility.setSymbolPenWidth(m_curve,2)}},{name:"3",fun:function(){Utility.setSymbolPenWidth(m_curve,3)}},{name:"4",fun:function(){Utility.setSymbolPenWidth(m_curve,4)}},{name:"5",fun:function(){Utility.setSymbolPenWidth(m_curve,5)}}]}]}],menu1=[{pos:0,name:"curve brush",img:"images/brush.png",title:"Set the fill color.",fun:function(){Utility.setCurveBrush(m_curve,(function(curve){Static.trigger("curveBrushChanged",curve)}))}},{pos:4,name:"remove",img:"images/scissors.png",title:"Removes the curve from the plot.",fun:function(){var curve=m_curve;m_curve&&m_curve.detach()}},{pos:5,name:"rename",img:"images/rename.png",title:"Renames the curve.",fun:function(){var curve=m_curve;curve&&Utility.curveRenameDlg(curve.title(),curve.plot())}},{pos:7,name:"symbol",img:"images/symbol.png",title:"attach/modify curve symbol",subMenu:null},{pos:8,name:"pen",img:"images/pen.png",title:"modify/change curve pen",subMenu:penSubMenu}];this.getCurve=function(){return m_curve};var getCurve=function(){if(null==el)return null;var txt=el.text().replace(" ","");return plot.findPlotCurve(txt)},menuModificationCb=function(){};this.setMenuModificationCb=function(cb){menuModificationCb=cb};var initialize=function(){var _menuItemName="";function indexOfMenuItemCb(_name,legendMenu){return _menuItemName=_name,legendMenu.findIndex(findIndexOfMenuItemCb)}function findIndexOfMenuItemCb(obj){return obj.name==_menuItemName}function doLegenMenu(x,y){for(var res=[],ele=document.elementFromPoint(x,y);ele&&"BODY"!=ele.tagName&&"HTML"!=ele.tagName;)res.push(ele),ele.style.display="none",ele=document.elementFromPoint(x,y);for(var i=0;i<res.length;i++)res[i].style.display="";for(var _ele=null,i=0;i<res.length;i++)if("LABEL"===res[i].tagName){_ele=res[i];break}el&&void 0!==el.menuAppended&&el.menuAppended&&el.contextMenu("destroy"),el=$(_ele).parent();var curve=m_curve=getCurve();if(curve){menuModificationCb();var subMenuIndex=indexOfMenuItemCb("symbol",menu1);subMenuIndex>-1&&(menu1[subMenuIndex].subMenu=subMenu1,curve&&curve.rtti==Static.Rtti_PlotCurve&&curve.symbol()&&(menu1[subMenuIndex].subMenu=subMenu2)),el.menuAppended=!0,el.contextMenu(menu1,{triggerOn:"contextmenu",zIndex:1})}}(table=$(plot.getLayout().getLegendDiv().children()[0])).on("touchstart",(function(e){var x,y;doLegenMenu(e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY)})),table.on("mousedown",(function(e){var x,y;(Static.isMobile||2==e.button)&&doLegenMenu(e.pageX,e.pageY)}))};function insertItems(list){for(var i=0;i<list.length;++i){var found;void 0===_.find(menu1,(function(item){return item.name==list[i].name}))&&menu1.push(list[i])}}function sortItems(){menu1=menu1.sort((function(a,b){return a.pos-b.pos}))}function removeItemAtIndex(list,index){index>-1&&list.splice(index,1)}this.modifyMenu=function(name,modificationDataObj){if(null!=name){var index1=-1,menu1Item=_.find(menu1,(function(item,ind){return index1=ind,item.name==name}));null!=menu1Item&&(_.isEmpty(modificationDataObj)?removeItemAtIndex(menu1,index1):(menu1Item.pos=modificationDataObj.pos||menu1Item.pos,menu1Item.name=modificationDataObj.name||menu1Item.name,menu1Item.img=modificationDataObj.img||menu1Item.img,menu1Item.title=modificationDataObj.title||menu1Item.title,menu1Item.fun=modificationDataObj.fun||menu1Item.fun,menu1=sortItems(menu1)))}else{var found;_.isArray(modificationDataObj)?insertItems(modificationDataObj):null==_.find(menu1,(function(item){return item.name==modificationDataObj.name}))&&menu1.push(modificationDataObj),sortItems()}},plot.legend()?initialize():Static.bind("legendInserted",(function(){initialize(),Static.unbind("legendInserted")}))}}define("legendMenu",["static","contextMenu"],(function(){}));class HObject{constructor(el){let self=this,m_isEnabled=!1,element=$("body"),removed=!1,m_bind=!1;this.m_objectName="jObject",this.m_mouseTracking=!0,this.m_filterObjs=[],void 0!==el&&(element=el&&el instanceof HObject?el.getElement():el);let clickEvent="click",mousedownEvent="mousedown",mouseupEvent="mouseup",mousemoveEvent="mousemove";Static.isMobile()&&(clickEvent="tap",mousedownEvent="touchstart",mouseupEvent="touchend",mousemoveEvent="touchmove"),this.mapToElement=function(pt){if(!element)return;let result=new Misc.Point,rect=element[0].getBoundingClientRect();return result.x=pt.x-rect.left,result.y=pt.y-rect.top,result},this.setElement=function(el){element=el},this.getElement=function(){return element},this.setEnabled_1=function(on){m_isEnabled!=on&&(m_isEnabled=on,this.elementEvent(m_isEnabled),m_isEnabled&&Static.trigger("enabled"))},this.event=function(event){return!0},this.elementEventOnCb=function(event){if(!self.m_filterObjs.length)return self.event(event);self.m_filterObjs.forEach((function(filterObj){if(!filterObj.eventFilter(self,event))return self.event(event)}))},this.elementEvent=function(on){if(this instanceof HObject){let self=this;on?(self.getElement().on(mousedownEvent+" "+mouseupEvent+" "+mousemoveEvent+" mouseenter mouseleave mousewheel",(function(event){self.elementEventOnCb(event)})),$("body").on("keydown keyup",(function(event){if(!self.m_filterObjs.length)return self.event(event);self.m_filterObjs.forEach((function(filterObj){if(!filterObj.eventFilter(self,event))return self.event(event)}))}))):(self.getElement().off(mousedownEvent+" "+mouseupEvent+" "+mousemoveEvent+" mouseenter mouseleave mousewheel"),$("body").off("keydown keyup"))}},this.installEventFilter=function(filterObj){this.m_filterObjs.push(filterObj)},this.removeEventFilter=function(obj){let index=this.m_filterObjs.indexOf(obj);index>-1&&this.m_filterObjs.splice(index,1)},this.hasSameElement=function(otherObj){return this.getElement()==otherObj.getElement()},this.isEnabled=function(){return m_isEnabled},this.toString=function(){return"[HObject]"}}eventFilter(watched,event){console.log("eventFilter() called")}setMouseTracking(on){if(this.getElement()&&on){let self=this;this.getElement().on("mousemove touchmove",(function(event){self.elementEventOnCb(event)})),this.m_mouseTracking=!0}else this.getElement().off("mousemove touchmove"),this.m_mouseTracking=!1}hasMouseTracking(){return this.m_mouseTracking}setObjectName(name){this.m_objectName=name}objectName(){return this.m_objectName}isWidget(){return"[Widget]"==this.toString()}}define("hObject",(function(){}));class Widget extends HObject{constructor(el){super(el);let self=this,m_visible=!0,m_z=0;var m_font=new Misc.Font(12);let cnvs=$("<canvas />").attr({style:"position: absolute; background-color: transparent"});this.getElement()&&this.getElement().append(cnvs),this.clearCanvas=function(){let ctx=this.getContext();ctx&&ctx.clearRect(0,0,cnvs[0].width,cnvs[0].height)},this.getContext=function(){let ctx=null;return this.getElement()?(cnvs[0].width=parseFloat(this.getElement().css("width")),cnvs[0].height=parseFloat(this.getElement().css("height")),ctx=cnvs[0].getContext("2d"),ctx):null},this.width=function(){return cnvs[0].width},this.height=function(){return cnvs[0].height},this.setCanvasParent=function(el){this.getElement().append(cnvs)},this.getCanvas=function(){return cnvs},this.contentsRect=function(){let e=this.getElement();return new Misc.Rect(0,0,parseFloat(e.css("width")),parseFloat(e.css("height")))},this.setVisible=function(on){on||void 0===on?(this.getCanvas().show(),m_visible=!0):(this.getCanvas().hide(),m_visible=!1)},this.hide=function(){this.setVisible(!1)},this.show=function(){this.setVisible(!0)},this.font=function(){return m_font},this.setFont=function(f){m_font=f},this.isVisible=function(){return m_visible},this.setZ=function(z){m_z!==z&&(m_z=z,cnvs&&cnvs.css("zIndex",m_z))},this.getZ=function(z){return m_z},this.toString=function(){return"[Widget]"}}setElement(el){this.super(el),this.setCanvasParent(el)}}define("widget",["static","hObject"],(function(){}));class WidgetOverlay extends Widget{constructor(w){super(w);let self=this;this.draw=function(){let p=new PaintUtil.Painter(this);this.drawOverlay(p),p=null},this.toString=function(){return"[WidgetOverlay]"}}updateOverlay(){this.draw()}drawOverlay(painter){console.warn("drawOverlay() not reimplemented")}}define("widgetOverlay",["static","widget"],(function(){}));
/*!
    \brief Symbolic mouse input codes

    QwtEventPattern implements 3 different settings for
    mice with 1, 2, or 3 buttons that can be activated
    using initMousePattern(). The default setting is for
    3 button mice.

    Individual settings can be configured using setMousePattern().

    \sa initMousePattern(), setMousePattern(), setKeyPattern()
  */
/*! 
  The default setting for 1, 2 and 3 button mice is:

  - Qt::LeftButton 
  - Qt::LeftButton 
  - Qt::LeftButton 
 */
/*!
    The default setting for 1, 2 and 3 button mice is:

    - Qt::LeftButton + Qt::ControlModifier
    - Qt::RightButton
    - Qt::RightButton
   */
/*!
    The default setting for 1, 2 and 3 button mice is:

    - Qt::LeftButton + Qt::AltModifier
    - Qt::LeftButton + Qt::AltModifier
    - Qt::MidButton
   */
/*!
    The default setting for 1, 2 and 3 button mice is:

    - Qt::LeftButton + Qt::ShiftModifier
    - Qt::LeftButton + Qt::ShiftModifier
    - Qt::LeftButton + Qt::ShiftModifier
   */
/*!
    The default setting for 1, 2 and 3 button mice is:

    - Qt::LeftButton + Qt::ControlButton | Qt::ShiftModifier
    - Qt::RightButton + Qt::ShiftModifier
    - Qt::RightButton + Qt::ShiftModifier
   */
/*!
    The default setting for 1, 2 and 3 button mice is:

    - Qt::LeftButton + Qt::AltModifier + Qt::ShiftModifier
    - Qt::LeftButton + Qt::AltModifier | Qt::ShiftModifier
    - Qt::MidButton + Qt::ShiftModifier
   */
/*!
  \brief Symbolic keyboard input codes

  Individual settings can be configured using setKeyPattern()

  \sa setKeyPattern(), setMousePattern()
*/
class MousePattern{constructor(btn,modifierCodes){this.button=Static.NoButton,this.modifiers=Static.NoModifier,void 0!==btn&&(this.button=btn),void 0!==modifierCodes&&(this.modifiers=modifierCodes)}}function KeyPattern(keyCode,modifierCodes){this.key=Static.Key_unknown,this.modifiers=Static.NoModifier,void 0!==keyCode&&(this.key=keyCode),void 0!==modifierCodes&&(this.modifiers=modifierCodes)}
/*!
  Constructor

  \sa MousePatternCode, KeyPatternCode
*/class EventPattern extends HObject{constructor(parent){super(parent);const MouseSelect1=Enum.MousePatternCode.MouseSelect1,MouseSelect2=Enum.MousePatternCode.MouseSelect2,MouseSelect3=Enum.MousePatternCode.MouseSelect3,MouseSelect4=Enum.MousePatternCode.MouseSelect4,MouseSelect5=Enum.MousePatternCode.MouseSelect5,MouseSelect6=Enum.MousePatternCode.MouseSelect6,MousePatternCount=Enum.MousePatternCode.MousePatternCount;var d_mousePattern=[],d_keyPattern=[];this.initMousePattern=function(numButtons){for(var i=0;i<MousePatternCount;++i)d_mousePattern.push(new MousePattern);switch(numButtons){case 1:this.setMousePattern(MouseSelect1,Static.LeftButton),this.setMousePattern(MouseSelect2,Static.LeftButton,Static.ControlModifier),this.setMousePattern(MouseSelect3,Static.LeftButton,Static.AltModifier);break;case 2:this.setMousePattern(MouseSelect1,Static.LeftButton),this.setMousePattern(MouseSelect2,Static.RightButton),this.setMousePattern(MouseSelect3,Static.LeftButton,Static.AltModifier);break;default:this.setMousePattern(MouseSelect1,Static.LeftButton),this.setMousePattern(MouseSelect2,Static.RightButton),this.setMousePattern(MouseSelect3,Static.MidButton)}this.setMousePattern(MouseSelect4,d_mousePattern[MouseSelect1].button,d_mousePattern[MouseSelect1].modifiers|Static.ShiftModifier),this.setMousePattern(MouseSelect5,d_mousePattern[MouseSelect2].button,d_mousePattern[MouseSelect2].modifiers|Static.ShiftModifier),this.setMousePattern(MouseSelect6,d_mousePattern[MouseSelect3].button,d_mousePattern[MouseSelect3].modifiers|Static.ShiftModifier)},this.initKeyPattern=function(){for(var i=0;i<Enum.KeyPatternCode.KeyPatternCount;++i)d_keyPattern.push(new KeyPattern);this.setKeyPattern(Enum.KeyPatternCode.KeySelect1,Static.Key_Return),this.setKeyPattern(Enum.KeyPatternCode.KeySelect2,Static.Key_Space),this.setKeyPattern(Enum.KeyPatternCode.KeyAbort,Static.Key_Escape),this.setKeyPattern(Enum.KeyPatternCode.KeyLeft,Static.Key_Left),this.setKeyPattern(Enum.KeyPatternCode.KeyRight,Static.Key_Right),this.setKeyPattern(Enum.KeyPatternCode.KeyUp,Static.Key_Up),this.setKeyPattern(Enum.KeyPatternCode.KeyDown,Static.Key_Down),this.setKeyPattern(Enum.KeyPatternCode.KeyRedo,Static.Key_Plus),this.setKeyPattern(Enum.KeyPatternCode.KeyUndo,Static.Key_Minus),this.setKeyPattern(Enum.KeyPatternCode.KeyHome,Static.Key_Escape)},this.setMousePattern=function(pattern,button,modifiers){null==button?d_mousePattern=pattern:(null==modifiers&&(modifiers=Static.NoModifier),pattern>=0&&pattern<MousePatternCount&&(d_mousePattern[pattern].button=button,d_mousePattern[pattern].modifiers=modifiers))},this.setKeyPattern=function(pattern,key,modifiers){null==key?d_mousePattern=pattern:(null==modifiers&&(modifiers=Static.NoModifier),pattern>=0&&pattern<Enum.KeyPatternCode.KeyPatternCount&&(d_keyPattern[pattern].key=key,d_keyPattern[pattern].modifiers=modifiers))}
/*!
      \brief Compare a mouse event with an event pattern.

      A mouse event matches the pattern when both have the same button
      value and in the state value the same key flags(Qt::KeyButtonMask)
      are set.

      \param code Index of the event pattern
      \param event Mouse event
      \return true if matches

      \sa keyMatch()
    */,this.mouseMatch=function(code,event){return code>=0&&code<MousePatternCount&&this.mouseMatch2(d_mousePattern[code],event)}
/*!
      \brief Compare a mouse event with an event pattern.

      A mouse event matches the pattern when both have the same button
      value and in the state value the same key flags(Qt::KeyButtonMask)
      are set.

      \param pattern Mouse event pattern
      \param event Mouse event
      \return true if matches

      \sa keyMatch()
    */,this.mouseMatch2=function(pattern,event){return null!=event&&(pattern.button==Utility.button(event)&&pattern.modifiers==Utility.modifiers(event))},this.keyPattern=function(){return d_keyPattern},this.key=function(event){return null!=event&&event.keyCode}
/*!
  \brief Compare a key event with an event pattern.

  A key event matches the pattern when both have the same key
  value and in the state value the same key flags (Qt::KeyButtonMask)
  are set.

  \param code Index of the event pattern
  \param event Key event
  \return true if matches

  \sa mouseMatch()
*/,this.keyMatch=function(code,event){return code>=0&&code<Enum.KeyPatternCode.KeyPatternCount&&this.keyMatch2(d_keyPattern[code],event)}
/*!
  \brief Compare a key event with an event pattern.

  A key event matches the pattern when both have the same key
  value and in the state value the same key flags (Qt::KeyButtonMask)
  are set.

  \param pattern Key event pattern
  \param event Key event
  \return true if matches

  \sa mouseMatch()
*/,this.keyMatch2=function(pattern,event){return null!=event&&(pattern.key==this.key(event)&&pattern.modifiers==Utility.modifiers(event))},this.initKeyPattern(),this.initMousePattern(3)}}define("eventpattern",(function(){}));class PickerMachine{constructor(type){Static.Begin=0,Static.Append=1,Static.Move=2,Static.Remove=3,Static.End=4;var d_selectionType=type,d_state=0;this.selectionType=function(){return d_selectionType},this.state=function(){return d_state},this.setState=function(state){d_state=state},this.reset=function(){this.setState(0)}}}class PickerTrackerMachine extends PickerMachine{constructor(){super(Static.NoSelection),this.transition=function(p,e){var cmdList=[];switch(e.type){case"mouseenter":case"mousemove":case"touchmove":0==this.state()?(cmdList.push(Static.Begin),cmdList.push(Static.Append),this.setState(1)):cmdList.push(Static.Move);break;case"mouseleave":cmdList.push(Static.Remove),cmdList.push(Static.End),this.setState(0)}return cmdList}}}class PickerClickPointMachine extends PickerMachine{constructor(){super(Static.PointSelection),this.transition=function(eventPattern,event){var cmdList=[];switch(event.type){case"mousedown":case"touchstart":eventPattern.mouseMatch(Enum.MousePatternCode.MouseSelect1,event)&&(cmdList.push(Static.Begin),cmdList.push(Static.Append),cmdList.push(Static.End));break;case"keydown":var keyEvent=event;eventPattern.keyMatch(Enum.KeyPatternCode.KeySelect1,keyEvent)&&(cmdList.push(Static.Begin),cmdList.push(Static.Append),cmdList.push(Static.End))}return cmdList}}toString(){return"[PickerClickPointMachine]"}}class PickerDragPointMachine extends PickerMachine{constructor(){super(Static.PointSelection),this.transition=function(eventPattern,event){var cmdList=[];switch(event.type){case"mousedown":case"touchstart":eventPattern.mouseMatch(Enum.MousePatternCode.MouseSelect1,event)&&0==this.state()&&(cmdList.push(Static.Begin),cmdList.push(Static.Append),this.setState(1));break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&cmdList.push(Static.Move);break;case"mouseup":case"touchend":0!=this.state()&&(cmdList.push(Static.End),this.setState(0));break;case"keydown":var keyEvent=event;eventPattern.keyMatch(Enum.KeyPatternCode.KeySelect1,keyEvent)&&(0==this.state()?(cmdList.push(Static.Begin),cmdList.push(Static.Append),this.setState(1)):(cmdList.push(Static.End),this.setState(0)))}return cmdList}}toString(){return"[PickerDragPointMachine]"}}class PickerClickRectMachine extends PickerMachine{constructor(){super(Static.RectSelection),this.transition=function(eventPattern,event){var cmdList=[];switch(event.type){case"mousedown":case"touchstart":if(eventPattern.mouseMatch(Enum.MousePatternCode.MouseSelect1,event))switch(this.state()){case 0:cmdList.push(Static.Begin),cmdList.push(Static.Append),this.setState(1);break;case 1:break;default:cmdList.push(Static.End),this.setState(0)}break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&cmdList.push(Static.Move);break;case"mouseup":case"touchend":eventPattern.mouseMatch(Enum.MousePatternCode.MouseSelect1,event)&&1==this.state()&&(cmdList.push(Static.Append),this.setState(2));break;case"keydown":var keyEvent=event;eventPattern.keyMatch(Enum.KeyPatternCode.KeySelect1,keyEvent)&&(0==this.state()?(cmdList.push(Static.Begin),cmdList.push(Static.Append),this.setState(1)):1==this.state()?(cmdList.push(Static.Append),this.setState(2)):2==this.state()&&(cmdList.push(Static.End),this.setState(0)))}return cmdList}}toString(){return"[PickerClickRectMachine]"}}class PickerDragRectMachine extends PickerMachine{constructor(){super(Static.RectSelection),this.transition=function(eventPattern,event){var cmdList=[];switch(event.type){case"mousedown":case"touchstart":("touchstart"==event.type||eventPattern.mouseMatch(Enum.MousePatternCode.MouseSelect1,event))&&0==this.state()&&(cmdList.push(Static.Begin),cmdList.push(Static.Append),cmdList.push(Static.Append),this.setState(2));break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&cmdList.push(Static.Move);break;case"mouseup":case"touchend":2==this.state()&&(cmdList.push(Static.End),this.setState(0));break;case"keydown":eventPattern.keyMatch(Enum.KeyPatternCode.KeySelect1,event)&&(0==this.state()?(cmdList.push(Static.Begin),cmdList.push(Static.Append),cmdList.push(Static.Append),this.setState(2)):(cmdList.push(Static.End),this.setState(0)))}return cmdList}}toString(){return"[PickerDragRectMachine]"}}class PickerPolygonMachine extends PickerMachine{constructor(){super(Static.PolygonSelection),this.transition=function(eventPattern,event){var cmdList=[];switch(event.type){case"mousedown":case"touchstart":eventPattern.mouseMatch(Enum.MousePatternCode.MouseSelect1,event)&&(0==this.state()?(cmdList.push(Static.Begin),cmdList.push(Static.Append),cmdList.push(Static.Append),this.setState(1)):cmdList.push(Static.Append)),eventPattern.mouseMatch(Enum.MousePatternCode.MouseSelect2,event)&&1==this.state()&&(cmdList.push(Static.End),this.setState(0));break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&cmdList.push(Static.Move);break;case"keydown":var keyEvent=event;eventPattern.keyMatch(Enum.KeyPatternCode.KeySelect1,keyEvent)?0==this.state()?(cmdList.push(Static.Begin),cmdList.push(Static.Append),cmdList.push(Static.Append),this.setState(1)):cmdList.push(Static.Append):eventPattern.keyMatch(Enum.KeyPatternCode.KeySelect2,keyEvent)&&1==this.state()&&(cmdList.push(Static.End),this.setState(0))}return cmdList}}toString(){return"[PickerPolygonMachine]"}}class PickerDragLineMachine extends PickerMachine{constructor(){super(Static.PolygonSelection),this.transition=function transition(eventPattern,event){var cmdList=[];switch(event.type){case"mousedown":case"touchstart":eventPattern.mouseMatch(Enum.MousePatternCode.MouseSelect1,event)&&0==this.state()&&(cmdList.push(Static.Begin),cmdList.push(Static.Append),cmdList.push(Static.Append),this.setState(1));break;case"keydown":eventPattern.keyMatch(Enum.KeyPatternCode.KeySelect1,event)&&(0==this.state()?(cmdList.push(Static.Begin),cmdList.push(Static.Append),cmdList.push(Static.Append),this.setState(1)):(cmdList.push(Static.End),this.setState(0)));break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&cmdList.push(Static.Move);break;case"mouseup":case"touchend":0!=this.state()&&(cmdList.push(Static.End),this.setState(0))}return cmdList}}toString(){return"[PickerDragLineMachine]"}}define("pickermachine",["static","eventpattern"],(function(){}));class PickerRubberband extends WidgetOverlay{constructor(picker,parent){super(parent),this.setZ(30);var d_picker=picker;this.drawOverlay=function(painter){painter.setPen(d_picker.rubberBandPen()),painter.setBrush(Static.NoBrush),d_picker.drawRubberBand(painter)}}}class PickerTracker extends WidgetOverlay{constructor(picker,parent){super(parent),this.setZ(30);var d_picker=picker;this.drawOverlay=function(painter){d_picker.trackerOverlay().clearCanvas(),painter.save(),painter.setPen(d_picker.trackerPen()),d_picker.drawTracker(painter),painter.restore()}}}function PickerPrivateData(){this.enabled=!1,this.stateMachine=null,this.resizeMode,this.rubberBand=Static.NoRubberBand,this.rubberBandPen=new Misc.Pen("red",1,"solid"),this.trackerMode=Static.AlwaysOff,this.trackerPen=new Misc.Pen("red"),this.trackerFont,this.pickedPoints=[],this.isActive=!1,this.trackerPosition=new Misc.Point,this.mouseTracking=!1,this.rubberBandOverlay=null,this.trackerOverlay=null}
/*!
Constructor

Creates an picker that is enabled, but without a state machine.
rubber band and tracker are disabled.

\param parent Parent widget, that will be observed
 */
/*!
Constructor

\param rubberBand Rubber band style
\param trackerMode Tracker mode
\param parent Parent widget, that will be observed
 */
class Picker extends EventPattern{constructor(rubberBand,trackerMode,parent){super(parent);let clickEvent="click",mousedownEvent="mousedown",mouseupEvent="mouseup",mousemoveEvent="mousemove";var d_data;Static.isMobile()&&(clickEvent="tap",mousedownEvent="touchstart",mouseupEvent="touchend",mousemoveEvent="touchmove");var m_pickedPoints=[],m_parent=null;void 0!==parent&&"[Widget]"==parent.toString()&&(m_parent=parent),this.init=function(parent,rubberBand,trackerMode){(d_data=new PickerPrivateData).rubberBand=rubberBand,parent&&(d_data.trackerFont=new Misc.Font(12),this.setEnabled_1(!0)),this.setTrackerMode(trackerMode),Picker.pickers.push(this)},this.getPickerData=function(){return d_data}
/*!
		Set a state machine and delete the previous one

		\param stateMachine State machine
		\sa stateMachine()
		 */,this.setStateMachine=function(stateMachine){d_data.stateMachine!=stateMachine&&(this.reset(),d_data.stateMachine=stateMachine,d_data.stateMachine&&d_data.stateMachine.reset())}
/*!
		\return Assigned state machine
		\sa setStateMachine()
		 */,this.stateMachine=function(){return d_data.stateMachine},this.parentWidget=function(){return m_parent}
/*!
		Set the rubber band style

		\param rubberBand Rubber band style
		The default value is NoRubberBand.

		\sa rubberBand(), RubberBand, setRubberBandPen()
		 */,this.setRubberBand=function(rubberBand){d_data.rubberBand=rubberBand}
/*!
		\return Rubber band style
		\sa setRubberBand(), RubberBand, rubberBandPen()
		 */,this.rubberBand=function(){return d_data.rubberBand}
/*!
		\brief Set the display mode of the tracker.

		A tracker displays information about current position of
		the cursor as a string. The display mode controls
		if the tracker has to be displayed whenever the observed
		widget has focus and cursor (AlwaysOn), never (AlwaysOff), or
		only when the selection is active (ActiveOnly).

		\param mode Tracker display mode

		\warning In case of AlwaysOn, mouseTracking will be enabled
		for the observed widget.
		\sa trackerMode(), DisplayMode
		 */,this.setTrackerMode=function(mode){d_data.trackerMode!=mode&&(d_data.trackerMode=mode)}
/*!
		\return Tracker display mode
		\sa setTrackerMode(), DisplayMode
		 */,this.trackerMode=function(){return d_data.trackerMode}
/*!
		\brief Set the resize mode.

		The resize mode controls what to do with the selected points of an active
		selection when the observed widget is resized.

		Stretch means the points are scaled according to the new
		size, KeepSize means the points remain unchanged.

		The default mode is Stretch.

		\param mode Resize mode
		\sa resizeMode(), ResizeMode
		 */
/*!
		\return Resize mode
		\sa setResizeMode(), ResizeMode
		 */
/*!
		\brief En/disable the picker

		When enabled is true an event filter is installed for
		the observed widget, otherwise the event filter is removed.

		\param enabled true or false
		\sa isEnabled(), eventFilter()
		 */,this.setEnabled=function(enabled){if(d_data.enabled!=enabled){d_data.enabled=enabled;var w=this.parentWidget();w&&(enabled?w.installEventFilter(this):w.removeEventFilter(this)),this.updateDisplay()}}
/*!
		\return true when enabled, false otherwise
		\sa setEnabled(), eventFilter()
		 */,this.isEnabled=function(){return d_data.enabled}
/*!
		Set the font for the tracker

		\param font Tracker font
		\sa trackerFont(), setTrackerMode(), setTrackerPen()
		 */,this.setTrackerFont=function(font){font!=d_data.trackerFont&&(d_data.trackerFont=font,this.updateDisplay())}
/*!
		\return Tracker font
		\sa setTrackerFont(), trackerMode(), trackerPen()
		 */,this.trackerFont=function(){return d_data.trackerFont}
/*!
		Set the pen for the tracker

		\param pen Tracker pen
		\sa trackerPen(), setTrackerMode(), setTrackerFont()
		 */,this.setTrackerPen=function(pen){pen!=d_data.trackerPen&&(d_data.trackerPen=pen,this.updateDisplay())}
/*!
		\return Tracker pen
		\sa setTrackerPen(), trackerMode(), trackerFont()
		 */,this.trackerPen=function(){return d_data.trackerPen}
/*!
		Set the pen for the rubberband

		\param pen Rubber band pen
		\sa rubberBandPen(), setRubberBand()
		 */,this.setRubberBandPen=function(pen){pen!=d_data.rubberBandPen&&(d_data.rubberBandPen=pen,this.updateDisplay())}
/*!
		\return Rubber band pen
		\sa setRubberBandPen(), rubberBand()
		 */,this.rubberBandPen=function(){return d_data.rubberBandPen}
/*!
		Draw a rubber band, depending on rubberBand()

		\param painter Painter, initialized with a clip region

		\sa rubberBand(), RubberBand
		 */,this.drawRubberBand=function(painter){if(this.isActive()&&this.rubberBand()!=Static.NoRubberBand&&this.rubberBandPen().style!=Static.NoPen){var pa=this.adjustedPoints(d_data.pickedPoints),selectionType=Static.NoSelection;switch(d_data.stateMachine&&(selectionType=d_data.stateMachine.selectionType()),selectionType){case Static.NoSelection:case Static.PointSelection:if(pa.length<1)return;var pos=pa[0],pRect=this.pickArea();switch(this.rubberBand()){case Static.VLineRubberBand:painter.drawLine(pos.x,pRect.top(),pos.x,pRect.bottom());break;case Static.HLineRubberBand:painter.drawLine(pRect.left(),pos.y,pRect.right(),pos.y);break;case Static.CrossRubberBand:painter.drawLine(pos.x,pRect.top(),pos.x,pRect.bottom()),painter.drawLine(pRect.left(),pos.y,pRect.right(),pos.y)}break;case Static.RectSelection:if(pa.length<2)return;var rect=new Misc.Rect(pa[0],pa[pa.length-1]);switch(rect=rect.normalized(),this.rubberBand()){case Static.EllipseRubberBand:painter.drawEllipse(rect);break;case Static.RectRubberBand:painter.drawRect(rect)}break;case Static.PolygonSelection:if(pa.length<2)return;this.rubberBand()==Static.PolygonRubberBand&&painter.drawPolyline(pa)}}}
/*!
		Draw the tracker

		\param painter Painter
		\sa trackerRect(), trackerText()
		 */,this.drawTracker=function(painter){var textRect=this.trackerRect(this.trackerFont());if(null!==textRect){var label=this.trackerText(d_data.trackerPosition);""!==label&&(painter.setFont(d_data.trackerFont),painter.drawText(label,textRect.left(),textRect.bottom()))}}
/*!
		\brief Map the pickedPoints() into a selection()

		adjustedPoints() maps the points, that have been collected on
		the parentWidget() into a selection(). The default implementation
		simply returns the points unmodified.

		The reason, why a selection() differs from the picked points
		depends on the application requirements. F.e. :

		- A rectangular selection might need to have a specific aspect ratio only.\n
		- A selection could accept non intersecting polygons only.\n
		- ...\n

		The example below is for a rectangular selection, where the first
		point is the center of the selected rectangle.
		\par Example
		\verbatim QPolygon MyPicker::adjustedPoints(const QPolygon &points) const{
		QPolygon adjusted;
		if ( points.size() == 2 ){
		const int width = qAbs(points[1].x() - points[0].x());
		const int height = qAbs(points[1].y() - points[0].y());

		QRect rect(0, 0, 2 * width, 2 * height);
		rect.moveCenter(points[0]);

		adjusted += rect.topLeft();
		adjusted += rect.bottomRight();
		}
		return adjusted;
		}\endverbatim\n

		\param points Selected points
		\return Selected points unmodified
		 */,this.adjustedPoints=function(points){return points}
/*!
		\return Selected points
		\sa pickedPoints(), adjustedPoints()
		 */,this.selection=function(){return this.adjustedPoints(d_data.pickedPoints)},this.trackerPosition=function(){return d_data.trackerPosition}
/*!
		Calculate the bounding rectangle for the tracker text
		from the current position of the tracker

		\param font Font of the tracker text
		\return Bounding rectangle of the tracker text

		\sa trackerPosition()
		 */,this.trackerRect=function(font){if(this.trackerMode()===Static.AlwaysOff)return null;if(this.trackerPosition().x<0||this.trackerPosition().y<0)return null;var text=this.trackerText(this.trackerPosition());if(""==text)return null;var textSize=font.textSize(text),textRect=new Misc.Rect(new Misc.Point,textSize.width,textSize.height),pos=this.trackerPosition(),alignment=0;if(m_pickedPoints.length.length>1&&this.rubberBand()!=Static.NoRubberBand){var last=m_pickedPoints[0];alignment|=pos.x>=last.x?Static.AlignRight:Static.AlignLeft,alignment|=pos.y>last.y?Static.AlignBottom:Static.AlignTop}else alignment=Static.AlignTop|Static.AlignRight;var margin=5,x=pos.x;alignment&Static.AlignLeft?x-=textRect.width()+5:alignment&Static.AlignRight&&(x+=5);var y=pos.y;alignment&Static.AlignBottom?y+=5:alignment&Static.AlignTop&&(y-=textRect.height()+5),textRect.moveTopLeft(new Misc.Point(x,y));var pickRect=new Misc.Rect(new Misc.Point,this.trackerOverlay().width(),this.trackerOverlay().height()),right=Math.min(textRect.right(),pickRect.right()-5),bottom=Math.min(textRect.bottom(),pickRect.bottom()-5);textRect.moveBottomRight(new Misc.Point(right,bottom));var left=Math.max(textRect.left(),pickRect.left()+5),top=Math.max(textRect.top(),pickRect.top()+5);return textRect.moveTopLeft(new Misc.Point(left,top)),textRect}
/*!
		\brief Event filter

		When isEnabled() is true all events of the observed widget are filtered.
		Mouse and keyboard events are translated into widgetMouse- and widgetKey-
		and widgetWheel-events. Paint and Resize events are handled to keep
		rubber band and tracker up to date.

		\param object Object to be filtered
		\param event Event

		\return Always false.

		\sa widgetEnterEvent(), widgetLeaveEvent(),
		widgetMousePressEvent(), widgetMouseReleaseEvent(),
		widgetMouseDoubleClickEvent(), widgetMouseMoveEvent(),
		widgetWheelEvent(), widgetKeyPressEvent(), widgetKeyReleaseEvent(),
		QObject::installEventFilter(), QObject::event()
		 */,this.eventFilter=function(object,event){if(!this.isEnabled())return!1;if(object&&object==this.parentWidget())switch(event.type){case"mouseenter":this.widgetEnterEvent(event);break;case"mouseleave":this.widgetLeaveEvent(event);break;case mousedownEvent:this.widgetMousePressEvent(event);break;case mouseupEvent:this.widgetMouseReleaseEvent(event);break;case"dblclick":this.widgetMouseDoubleClickEvent(event);break;case mousemoveEvent:this.widgetMouseMoveEvent(event);break;case"keydown":this.widgetKeyPressEvent(event);break;case"keyup":this.widgetKeyReleaseEvent(event);break;case"mousewheel":this.widgetWheelEvent(event)}return!1}
/*!
		Passes an event to the state machine and executes the resulting
		commands. Append and Move commands use the current position
		of the cursor ( QCursor::pos() ).

		\param event Event
		 */,this.transition=function(event){if(d_data.stateMachine){var commandList=d_data.stateMachine.transition(this,event),pos;switch(event.type){case mousedownEvent:case mouseupEvent:case mousemoveEvent:var me=event,pos=new Misc.Point(me.clientX,me.clientY);Static.isMobile()&&(pos=new Misc.Point(event.originalEvent.changedTouches[0].clientX,event.originalEvent.changedTouches[0].clientY)),pos=this.parentWidget().mapToElement(pos);break;default:pos=this.parentWidget().mapToElement(new Misc.Point(0,0))}for(var i=0;i<commandList.length;i++)switch(commandList[i]){case Static.Begin:this.begin();break;case Static.Append:this.append(pos);break;case Static.Move:this.move(pos);break;case Static.Remove:this.remove();break;case Static.End:this.end()}}}
/*!
		Reset the state machine and terminate ( end(false) ) the selection
		 */,this.reset=function(){d_data.stateMachine&&d_data.stateMachine.reset(),this.isActive()&&this.end(!1)}
/*!
		Append a point to the selection and update rubber band and tracker.
		The appended() signal is emitted.

		\param pos Additional point

		\sa isActive(), begin(), end(), move(), appended()
		 */,this.append=function(pos){d_data.isActive&&(d_data.pickedPoints.push(pos),this.updateDisplay(),Static.trigger("appended",pos))}
/*!
		Move the last point of the selection
		The moved() signal is emitted.

		\param pos New position
		\sa isActive(), begin(), end(), append()
		 */,this.move=function(pos){if(d_data.isActive){var idx=d_data.pickedPoints.length-1;idx>=0&&d_data.pickedPoints[idx]!=pos&&(d_data.pickedPoints[idx]=pos,this.updateDisplay(),Static.trigger("moved",pos))}}
/*!
		Remove the last point of the selection
		The removed() signal is emitted.

		\sa isActive(), begin(), end(), append(), move()
		 */,this.remove=function(){var idx;if(d_data.isActive&&d_data.pickedPoints.length-1>0){var pos=d_data.pickedPoints.pop();this.updateDisplay(),Static.trigger("removed",pos)}}
/*!
		\brief Validate and fix up the selection

		Accepts all selections unmodified

		\param selection Selection to validate and fix up
		\return true, when accepted, false otherwise
		 */,this.accept=function(selection){return!0}
/*!
		A picker is active between begin() and end().
		\return true if the selection is active.
		 */,this.isActive=function(){return d_data.isActive}
/*!
		Return the points, that have been collected so far. The selection()
		is calculated from the pickedPoints() in adjustedPoints().
		\return Picked points
		 */,this.pickedPoints=function(){return d_data.pickedPoints}
/*!
		Scale the selection by the ratios of oldSize and newSize
		The changed() signal is emitted.

		\param oldSize Previous size
		\param newSize Current size

		\sa ResizeMode, setResizeMode(), resizeMode()
		 */
/*!
		Set mouse tracking for the observed widget.

		In case of enable is true, the previous value
		is saved, that is restored when enable is false.

		\warning Even when enable is false, mouse tracking might be restored
		to true. When mouseTracking for the observed widget
		has been changed directly by QWidget::setMouseTracking
		while mouse tracking has been set to true, this value can't
		be restored.
		 */,this.setMouseTracking=function(enable){var widget=this.parentWidget();widget&&(enable?(d_data.mouseTracking=widget.hasMouseTracking(),widget.setMouseTracking(!0)):widget.setMouseTracking(d_data.mouseTracking))}
/*!
		Find the area of the observed widget, where selection might happen.

		\return parentWidget()->contentsRect()
		 */,this.pickArea=function(){var widget=this.parentWidget();return widget?widget.contentsRect():null},this.updateDisplay=function(){var w=this.parentWidget(),showRubberband=!1,showTracker=!1;w&&w.isVisible()&&d_data.enabled&&(this.rubberBand()!==Static.NoRubberBand&&this.isActive()&&this.rubberBandPen().style!==Static.NoPen&&(showRubberband=!0),(this.trackerMode()==Static.AlwaysOn||this.trackerMode()==Static.ActiveOnly&&this.isActive())&&this.trackerPen()!=Static.NoPen&&(showTracker=!0));var rw=d_data.rubberBandOverlay;showRubberband?(null==rw&&((rw=new PickerRubberband(this,w)).setObjectName("PickerRubberBand"),d_data.rubberBandOverlay=rw),rw.updateOverlay()):rw&&(d_data.rubberBandOverlay.getCanvas().hide(),d_data.rubberBandOverlay.getCanvas(),d_data.rubberBandOverlay=null);var tw=d_data.trackerOverlay;showTracker?(null==tw&&((tw=new PickerTracker(this,w)).setObjectName("PickerTracker"),d_data.trackerOverlay=tw),tw.setFont(d_data.trackerFont),tw.updateOverlay()):tw&&(d_data.trackerOverlay.getCanvas().hide(),d_data.trackerOverlay.getCanvas(),d_data.trackerOverlay=null)},this.rubberBandOverlay=function(){return d_data.rubberBandOverlay},this.trackerOverlay=function(){return d_data.trackerOverlay},null==rubberBand&&null==trackerMode?this.init(parent,Static.NoRubberBand,Static.AlwaysOff):this.init(parent,rubberBand,trackerMode)}
/*!
	Handle a enter event for the observed widget.

	\param event Qt event

	\sa eventFilter(), widgetMousePressEvent(), widgetMouseReleaseEvent(),
	widgetMouseDoubleClickEvent(),
	widgetWheelEvent(), widgetKeyPressEvent(), widgetKeyReleaseEvent()
	 */widgetEnterEvent(event){this.transition(event)}
/*!
	Handle a leave event for the observed widget.

	\param event Qt event

	\sa eventFilter(), widgetMousePressEvent(), widgetMouseReleaseEvent(),
	widgetMouseDoubleClickEvent(),
	widgetWheelEvent(), widgetKeyPressEvent(), widgetKeyReleaseEvent()
	 */widgetLeaveEvent(event){this.transition(event),this.getPickerData().trackerPosition=new Misc.Point(-1,-1),this.isActive()||this.updateDisplay()}
/*!
	Handle a key release event for the observed widget.

	Passes the event to the state machine.

	\param keyEvent Key event

	\sa eventFilter(), widgetMousePressEvent(), widgetMouseReleaseEvent(),
	widgetMouseDoubleClickEvent(), widgetMouseMoveEvent(),
	widgetWheelEvent(), widgetKeyPressEvent(), stateMachine()
	 */widgetKeyReleaseEvent(keyEvent){this.transition(keyEvent)}
/*!
	Handle a wheel event for the observed widget.

	Move the last point of the selection in case of isActive() == true

	\param wheelEvent Wheel event

	\sa eventFilter(), widgetMousePressEvent(), widgetMouseReleaseEvent(),
	widgetMouseDoubleClickEvent(), widgetMouseMoveEvent(),
	widgetKeyPressEvent(), widgetKeyReleaseEvent()
	 */widgetWheelEvent(wheelEvent){var pos=new Misc.Point(wheelEvent.clientX,wheelEvent.clientY);this.pickArea().contains(pos)?this.getPickerData().trackerPosition=pos:this.getPickerData().trackerPosition=new Misc.Point(-1,-1),this.updateDisplay(),this.transition(wheelEvent)}
/*!
	Handle mouse double click event for the observed widget.

	\param mouseEvent Mouse event

	\sa eventFilter(), widgetMousePressEvent(), widgetMouseReleaseEvent(),
	widgetMouseMoveEvent(),
	widgetWheelEvent(), widgetKeyPressEvent(), widgetKeyReleaseEvent()
	 */widgetMouseDoubleClickEvent(mouseEvent){this.transition(mouseEvent)}
/*!
	Handle a mouse move event for the observed widget.

	\param mouseEvent Mouse event

	\sa eventFilter(), widgetMousePressEvent(), widgetMouseReleaseEvent(),
	widgetMouseDoubleClickEvent(),
	widgetWheelEvent(), widgetKeyPressEvent(), widgetKeyReleaseEvent()
	 */widgetMouseMoveEvent(mouseEvent){var pos=new Misc.Point(mouseEvent.clientX,mouseEvent.clientY);Static.isMobile()&&(pos=new Misc.Point(mouseEvent.originalEvent.changedTouches[0].clientX,mouseEvent.originalEvent.changedTouches[0].clientY)),pos=this.mapToElement(pos),this.pickArea().contains(pos)?this.getPickerData().trackerPosition=pos:this.getPickerData().trackerPosition=new Misc.Point(-1,-1),this.isActive()||this.updateDisplay(),this.transition(mouseEvent)}
/*!
	Handle a mouse press event for the observed widget.

	\param mouseEvent Mouse event

	\sa eventFilter(), widgetMouseReleaseEvent(),
	widgetMouseDoubleClickEvent(), widgetMouseMoveEvent(),
	widgetWheelEvent(), widgetKeyPressEvent(), widgetKeyReleaseEvent()
	 */widgetMousePressEvent(mouseEvent){this.transition(mouseEvent)}
/*!
	Handle a key press event for the observed widget.

	Selections can be completely done by the keyboard. The arrow keys
	move the cursor, the abort key aborts a selection. All other keys
	are handled by the current state machine.

	\param keyEvent Key event

	\sa eventFilter(), widgetMousePressEvent(), widgetMouseReleaseEvent(),
	widgetMouseDoubleClickEvent(), widgetMouseMoveEvent(),
	widgetWheelEvent(), widgetKeyReleaseEvent(), stateMachine(),
	QwtEventPattern::KeyPatternCode
	 */widgetKeyPressEvent(keyEvent){var dx=0,dy=0,offset=1;if(this.keyMatch(Enum.KeyPatternCode.KeyLeft,keyEvent)?dx=-1:this.keyMatch(Enum.KeyPatternCode.KeyRight,keyEvent)?dx=1:this.keyMatch(Enum.KeyPatternCode.KeyUp,keyEvent)?dy=-1:this.keyMatch(Enum.KeyPatternCode.KeyDown,keyEvent)?dy=1:this.keyMatch(Enum.KeyPatternCode.KeyAbort,keyEvent)?this.reset():this.transition(keyEvent),0!==dx||0!==dy){var rect=pickArea(),pos=this.parentWidget().mapToElement(new Misc.Point(clientX,clientY)),x=pos.x+dx;x=Math.max(rect.left(),x),x=Math.min(rect.right(),x);var y=pos.y+dy;y=Math.max(rect.top(),y),y=Math.min(rect.bottom(),y)}}
/*!
	Handle a mouse release event for the observed widget.

	\param mouseEvent Mouse event

	\sa eventFilter(), widgetMousePressEvent(),
	widgetMouseDoubleClickEvent(), widgetMouseMoveEvent(),
	widgetWheelEvent(), widgetKeyPressEvent(), widgetKeyReleaseEvent()
	 */widgetMouseReleaseEvent(mouseEvent){this.transition(mouseEvent)}
/*!
	\brief Close a selection setting the state to inactive.

	The selection is validated and maybe fixed by accept().

	\param ok If true, complete the selection and emit a selected signal
	otherwise discard the selection.
	\return true if the selection is accepted, false otherwise
	\sa isActive(), begin(), append(), move(), selected(), accept()
	 */end(ok){var d=this.getPickerData();return d.isActive?(this.setMouseTracking(!1),d.isActive=!1,Static.trigger("activated",!1),this.trackerMode()==Static.ActiveOnly&&(d.trackerPosition=new Misc.Point(-1,-1)),ok&&(ok=this.accept(d.pickedPoints)),ok?Static.trigger("selected",d.pickedPoints):d.pickedPoints=[],this.updateDisplay()):ok=!1,ok}
/*!
	Open a selection setting the state to active

	\sa isActive(), end(), append(), move()
	 */begin(){var d=this.getPickerData();if(d&&!d.isActive){if(d.pickedPoints=[],d.isActive=!0,Static.trigger("activated",!0),this.trackerMode()!==Static.AlwaysOff&&(d.trackerPosition.x<0||d.trackerPosition.y<0)){var w=this.parentWidget();w&&(d.trackerPosition=w.mapToElement(new Misc.Point(0,0)))}this.updateDisplay(),this.setMouseTracking(!0)}}
/*!
	\brief Return the label for a position

	In case of HLineRubberBand the label is the value of the
	y position, in case of VLineRubberBand the value of the x position.
	Otherwise the label contains x and y position separated by a ',' .

	The format for the string conversion is "%d".

	\param pos Position
	\return Converted position as string
	 */trackerText(pos){var label;switch(this.rubberBand()){case Static.HLineRubberBand:label=pos.y.toString();break;case Static.VLineRubberBand:label=pos.x.toString();break;default:label=pos.x.toString()+", "+pos.y.toString()}return label}}Picker.pickers=[],define("picker",["static","widgetOverlay","pickermachine"],(function(){}));
/*!
  \brief QwtPlotPicker provides selections on a plot canvas

  QwtPlotPicker is a QwtPicker tailored for selections on
  a plot canvas. It is set to a x-Axis and y-Axis and
  translates all pixel coordinates into this coordinate system.
*/
/*!
  \brief Create a plot picker

  The picker is set to those x- and y-axis of the plot
  that are enabled. If both or no x-axis are enabled, the picker
  is set to QwtPlot::xBottom. If both or no y-axis are
  enabled, it is set to QwtPlot::yLeft.

  \param canvas Plot canvas to observe, also the parent object

  \sa QwtPlot::autoReplot(), QwtPlot::replot(), scaleRect()
*/
class PlotPicker extends Picker{constructor(xAxis,yAxis,rubberBand,trackerMode,canvas){var _constructor=0;if("number"!=typeof xAxis&&(canvas=xAxis,xAxis=-1,yAxis=-1,rubberBand=Static.NoRubberBand,trackerMode=Static.AlwaysOff,_constructor=1),"number"!=typeof rubberBand&&(canvas=rubberBand,rubberBand=Static.NoRubberBand,trackerMode=Static.AlwaysOff,_constructor=2),canvas instanceof Plot&&(canvas=canvas.getCentralWidget()),super(rubberBand,trackerMode,canvas),this.d_xAxis=-1,this.d_yAxis=-1,1==_constructor){var plot=this.plot(),xAxis=xBottom;plot&&!plot.axisEnabled(xBottom)&&plot.axisEnabled(xTop)&&(xAxis=xTop);var yAxis=yLeft;plot&&!plot.axisEnabled(yLeft)&&plot.axisEnabled(yRight)&&(yAxis=yRight),this.setAxis(xAxis,yAxis)}else this.d_xAxis=xAxis,this.d_yAxis=yAxis;this.setEnabled(!0),canvas&&canvas.setEnabled_1(!0)}setAxis(xAxis,yAxis){var plt;this.plot()&&(xAxis==this.d_xAxis&&yAxis==this.d_yAxis||(this.d_xAxis=xAxis,this.d_yAxis=yAxis))}xAxis(){return this.d_xAxis}yAxis(){return this.d_yAxis}plot(){var w=this.parentWidget();return w?w.plot:null}canvas(){return this.parentWidget()}
/*!
      A signal emitted in case of QwtPickerMachine::PointSelection.
      \param pos Selected point
    */
/*!
      A signal emitted in case of QwtPickerMachine::RectSelection.
      \param rect Selected rectangle
    */
/*!
      A signal emitting the selected points,
      at the end of a selection.

      \param pa Selected points
    */
/*!
      A signal emitted when a point has been appended to the selection

      \param pos Position of the appended point.
      \sa append(). moved()
    */
/*!
      A signal emitted whenever the last appended point of the
      selection has been moved.

      \param pos Position of the moved last point of the selection.
      \sa move(), appended()
    */scaleRect(){var rect=null;if(this.plot()){var xs=this.plot().axisScaleDiv(this.xAxis()),ys=this.plot().axisScaleDiv(this.yAxis());rect=(rect=new Misc.Rect(xs.lowerBound(),ys.lowerBound(),xs.range(),ys.range())).normalized()}return rect}
/*!
    Translate a point from pixel into plot coordinates
    \return Point in plot coordinates
    \sa transform()
*/
/*!
    Translate a rectangle from pixel into plot coordinates
    \return Rectangle in plot coordinates
    \sa transform()
*/invTransform(rect){var xMap=this.plot().canvasMap(this.d_xAxis),yMap=this.plot().canvasMap(this.d_yAxis);if(_.has(rect,"x")&&_.has(rect,"y")){var pos=rect;return new Misc.Point(xMap.invTransform(pos.x),yMap.invTransform(pos.y))}return ScaleMap.invTransform_Rect(xMap,yMap,rect)}
/*!
    Translate a rectangle from plot into pixel coordinates
    \return Rectangle in pixel coordinates
    \sa invTransform()
*/transform(rect){var xMap=this.plot().canvasMap(this.d_xAxis),yMap=this.plot().canvasMap(this.d_yAxis);if(void 0!==rect.x){var pos=rect,p;return new Misc.Point(xMap.transform(pos.x),yMap.transform(pos.y))}return Static.mTransform(xMap,yMap,rect)}trackerText(pos){var label;switch(pos=this.invTransform(pos),this.rubberBand()){case Static.HLineRubberBand:label=pos.y.toString();break;case Static.VLineRubberBand:label=pos.x.toString();break;default:label=pos.x.toString()+", "+pos.y.toString()}return label}
/*!
  Move the last point of the selection

  \param pos New position
  \sa isActive, begin(), end(), append()

  \note The moved(const QPoint &), moved(const QDoublePoint &)
        signals are emitted.
*/move(pos){super.method(move(pos)),Static.trigger("moved",invTransform(pos))}
/*!
  Append a point to the selection and update rubber band and tracker.

  \param pos Additional point
  \sa isActive, begin(), end(), move(), appended()

  \note The appended(const QPoint &), appended(const QDoublePoint &)
        signals are emitted.
*/append(pos){super.method(append(pos)),Static.trigger("appended",invTransform(pos))}
/*!
  Close a selection setting the state to inactive.

  \param ok If true, complete the selection and emit selected signals
            otherwise discard the selection.
  \return True if the selection has been accepted, false otherwise
*/end(ok=!0){if(!(ok=super.end(ok)))return!1;var plot;if(!this.plot())return!1;var points=this.selection();if(0==points.length)return!1;var selectionType=Static.NoSelection;switch(this.stateMachine()&&(selectionType=this.stateMachine().selectionType()),selectionType){case Static.PointSelection:var pos=this.invTransform(points[0]);Static.trigger("selected",pos);break;case Static.RectSelection:if(points.length>=2){var p1=points[0],p2=points[points.length-1],rect=new Misc.Rect(p1,p2).normalized();Static.trigger("selected",this.invTransform(rect))}break;case Static.PolygonSelection:for(var dpa=[],i=0;i<points.length;i++)dpa.push(this.invTransform(points[i]));Static.trigger("selected",dpa)}return!0}}define("plotpicker",["static","picker"],(function(){}));class MPicker extends PlotPicker{constructor(plot,rulerPos,ruler){super(plot);var self=this;this._rulerPos=rulerPos,this._ruler=ruler;var _zoomer=0,_panner=0,_magnifier=0,_qwtPlotCursorShape="",_cursorOld=null,_cursorDrag=null,_preventDragging=!1,_controlFlags=0;this._ruler&&this._ruler.setAxes(this.xAxis(),this.yAxis());var _trackingTextStyle=Static.FullTrackingText;this.plot()&&(_qwtPlotCursorShape=this.plot().cursor()),this.preventDragging=function(on){_preventDragging=on},this.controlFlag=function(flag){return Boolean(_controlFlags&flag)},this.setControlFlag=function(flag,set){set?_controlFlags|=flag:_controlFlags&=~flag},this.prohibit=function(){_zoomer&&this.controlFlag(Static.ZoomerSearch)&&(this.setControlFlag(Static.ZoomEnabled,_zoomer.isEnabled()),this.controlFlag(Static.ZoomEnabled)&&_zoomer.setEnabled(!1)),_panner&&this.controlFlag(Static.PannerSearch)&&(this.setControlFlag(Static.PanEnabled,_panner.isEnabled()),this.controlFlag(Static.PanEnabled)&&_panner.setEnabled(!1)),_magnifier&&this.controlFlag(Static.MagnifierSearch)&&(this.setControlFlag(Static.MagnifierEnabled,_magnifier.isEnabled()),this.controlFlag(Static.MagnifierEnabled)&&_magnifier.setEnabled(!1))},this.restore=function(){_zoomer&&this.controlFlag(Static.ZoomEnabled)&&(_zoomer.setEnabled(!0),this.setControlFlag(Static.ZoomEnabled,!1)),_panner&&this.controlFlag(Static.PanEnabled)&&(_panner.setEnabled(!0),this.setControlFlag(Static.PanEnabled,!1)),_magnifier&&this.controlFlag(Static.MagnifierEnabled)&&(_magnifier.setEnabled(!0),this.setControlFlag(Static.MagnifierEnabled,!1))},this.setDragCursor=function(){_preventDragging||this.controlFlag(Static.DragCursor)||plot.cursor()==_qwtPlotCursorShape&&(_cursorOld=plot.cursor(),_cursorDrag=this._dragCursorShape,plot.setCursor(_cursorDrag),this.setControlFlag(Static.DragCursor,!0),this.prohibit(),Static.trigger("rulerSelected",self._ruler))},this.clearDragCursor=function(){this.controlFlag(Static.DragCursor)&&(this._ruler.plot().setCursor(_cursorOld),this.setControlFlag(Static.DragCursor,!1),this.restore(),Static.trigger("rulerDeselected",self._ruler))},this.setTrackingTextStyle=function(trackingTextStyle){_trackingTextStyle=trackingTextStyle},this.trackerText=function(pos){if(this._ruler.lock()||_trackingTextStyle==Static.NoTrackingText||!this.controlFlag(Static.LeftButtonDown)&&!this.controlFlag(Static.ZoomEnabled))return"";if(_trackingTextStyle==Static.FullTrackingText){var xTitle=this.axisTitle();return xTitle.length?xTitle+"="+this._rulerPos:this._rulerPos}return _trackingTextStyle==Static.PartialTrackingText?this._rulerPos:""},this.panningFinished=function(){this.setControlFlag(Static.PanningInProgress,!1)},this.panningStarted=function(){this.setControlFlag(Static.PanningInProgress,!0)},$("#plotDivContainer").on("mouseup",(function(){Static.LeftButtonDown&&(Static.isMobile()&&self.clearDragCursor(),self.setControlFlag(Static.LeftButtonDown,!1))})),this.initMagnifier=function(){this.controlFlag(Static.MagnifierSearch)&&!_magnifier&&plot.magnifier&&(_magnifier=plot.magnifier)},this.initZoomer=function(){!this.controlFlag(Static.ZoomerSearch)&&_zoomer||plot.zoomer&&(_zoomer=plot.zoomer)},this.initPanner=function(){!this.controlFlag(Static.PannerSearch)&&_panner||plot.panner&&(_panner=plot.panner)},this.doMouseReleaseEvent=function(event){this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)&&(event.button==Static.LeftButton&&(this.controlFlag(Static.LeftButtonDown)&&Static.trigger("positionChanged",[this._ruler,this._rulerPos]),this.setControlFlag(Static.LeftButtonDown,!1)),Static.isMobile()&&(this.controlFlag(Static.LeftButtonDown)&&Static.trigger("positionChanged",[this._ruler,this._rulerPos]),this.setControlFlag(Static.LeftButtonDown,!1)))}}widgetMouseReleaseEvent(event){this.doMouseReleaseEvent(event),super.widgetMouseReleaseEvent(event)}widgetLeaveEvent(event){this.doMouseReleaseEvent(event),super.widgetMouseReleaseEvent(event)}}class PickerV extends MPicker{constructor(plot,rulerPos,ruler){super(plot,rulerPos,ruler),this._dragCursorShape="w-resize",this.axisTitle=function(){return this._ruler.plot().axisTitle(this.xAxis())}}widgetMousePressEvent(event){if(this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)){if(2==event.button)return this.controlFlag(Static.DragCursor),!0;if(Static.isMobile()){Static.isMobile()&&this.clearDragCursor();var _rulerPosVal=this._ruler.plot().transform(this.xAxis(),this._rulerPos),clientX=event.originalEvent.touches[0].clientX,clientY=event.originalEvent.touches[0].clientY,pt,val=this.mapToElement(new Misc.Point(clientX,clientY)).x;!this.controlFlag(Static.LeftButtonDown)&&val<_rulerPosVal+12&&val>_rulerPosVal-12&&(this.setDragCursor(),this.setControlFlag(Static.LeftButtonDown,!0))}else if(event.button==Static.LeftButton||Static.isMobile())return this.controlFlag(Static.DragCursor)&&this.setControlFlag(Static.LeftButtonDown,!0),!0}}widgetMouseMoveEvent(event){if(event.preventDefault(),this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)&&!this.controlFlag(Static.Locked)){var plot=this._ruler.plot(),clientX=event.clientX,clientY=event.clientY;if(Static.isMobile()){var touchobj=event.originalEvent.changedTouches[0];clientX=parseInt(touchobj.clientX),clientY=parseInt(touchobj.clientY)}var pt,val=this.mapToElement(new Misc.Point(clientX,clientY)).x,_rulerPosVal=this._ruler.plot().transform(this.xAxis(),this._rulerPos);this.controlFlag(Static.LeftButtonDown)&&(this._rulerPos=plot.invTransform(this.xAxis(),val),this._rulerPos=this._ruler._rulers.setPosition(this._ruler._rulers.rulerId(this._ruler),this._rulerPos),Static.trigger("positionChanging",[this._ruler,this._ruler._pos])),!this.controlFlag(Static.LeftButtonDown)&&val<_rulerPosVal+2&&val>_rulerPosVal-2&&this.setDragCursor(),this.controlFlag(Static.LeftButtonDown)||val<_rulerPosVal+2&&val>_rulerPosVal-2||this.clearDragCursor()}}}class PickerH extends MPicker{constructor(plot,rulerPos,ruler){super(plot,rulerPos,ruler),this._dragCursorShape="s-resize",this.axisTitle=function(){return this._ruler.plot().axisTitle(this.yAxis())}}widgetMousePressEvent(event){if(this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)){if(2==event.button)return this.controlFlag(Static.DragCursor),!0;if(Static.isMobile()){var _rulerPosVal=this._ruler.plot().transform(this.yAxis(),this._rulerPos),clientX=event.originalEvent.touches[0].clientX,clientY=event.originalEvent.touches[0].clientY,pt,val=this.mapToElement(new Misc.Point(clientX,clientY)).y;!this.controlFlag(Static.LeftButtonDown)&&val<_rulerPosVal+12&&val>_rulerPosVal-12&&(this.setDragCursor(),this.setControlFlag(Static.LeftButtonDown,!0))}else if(event.button==Static.LeftButton||Static.isMobile())return this.controlFlag(Static.DragCursor)&&this.setControlFlag(Static.LeftButtonDown,!0),!0}}widgetMouseMoveEvent(event){if(event.preventDefault(),this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)&&!this.controlFlag(Static.Locked)){var plot=this._ruler.plot(),clientX=event.clientX,clientY=event.clientY;if(Static.isMobile()){var touchobj=event.originalEvent.changedTouches[0];clientX=parseInt(touchobj.clientX),clientY=parseInt(touchobj.clientY)}var pt,val=this.mapToElement(new Misc.Point(clientX,clientY)).y,_rulerPosVal=this._ruler.plot().transform(this.yAxis(),this._rulerPos);this.controlFlag(Static.LeftButtonDown)&&(this._rulerPos=plot.invTransform(this.yAxis(),val),this._rulerPos=this._ruler._rulers.setPosition(this._ruler._rulers.rulerId(this._ruler),this._rulerPos),Static.trigger("positionChanging",[this._ruler,this._ruler._pos])),!this.controlFlag(Static.LeftButtonDown)&&val<_rulerPosVal+2&&val>_rulerPosVal-2&&this.setDragCursor(),this.controlFlag(Static.LeftButtonDown)||val<_rulerPosVal+2&&val>_rulerPosVal-2||this.clearDragCursor()}}}define("mpicker",["static","plotpicker"],(function(){}));class Ruler extends PlotMarker{constructor(plot,name,lineStyle){super(name),this._picker=0,this._pos=Number.MAX_VALUE,this._rightClickMenu=0,this._rulers=null,lineStyle!=VLine&&lineStyle!=HLine||(this.setLineStyle(lineStyle),this.setLinePen(new Misc.Pen("blue"))),this.attach(plot),this.setMouseTracking=function(enable){this._picker.setMouseTracking(enable)}}}Ruler.prototype.toString=function(){return"[Ruler]"},Ruler.prototype.setPicker=function(pick){return!!pick&&(this._picker=pick,!0)},Ruler.prototype.setZoomerSearch=function(on){this._picker.setControlFlag(Static.ZoomerSearch,on),this._picker.initZoomer()},Ruler.prototype.setPannerSearch=function(on){this._picker.setControlFlag(Static.PannerSearch,on)},Ruler.prototype.setLock=function(lock){this._picker.setControlFlag(Static.Locked,lock),this._picker.clearDragCursor()},Ruler.prototype.lock=function(){return this._picker.controlFlag(Static.Locked)},Ruler.prototype.setTrackingTextStyle=function(trackingTextStyle){this._picker.setTrackingTextStyle(trackingTextStyle)},Ruler.prototype.trackingTextStyle=function(){return this._picker.trackingTextStyle()},Ruler.prototype.setTrackingTextFont=function(f){this._picker.setTrackerFont(f)},Ruler.prototype.trackingTextFont=function(){return this._picker.trackerFont()},Ruler.prototype.setTrackingTextColor=function(c){var font=this._picker.trackerFont();font.fontColor=c,this._picker.setTrackerFont(font)},Ruler.prototype.trackingTextColor=function(){return this._picker.trackerFont().color},Ruler.prototype.validatePosition=function(min,max){},Ruler.prototype.dragCursorShape=function(){return this._picker.dragCursorShape()},Ruler.prototype.setDragCursorShape=function(shape){this._picker.setDragCursorShape(shape)},Ruler.prototype.setRightClickMenu=function(menu){};class RulerV extends Ruler{constructor(plot,name,rulerGroup){super(plot,name,VLine),rulerGroup&&(this._rulers=rulerGroup),this._picker=new PickerV(plot,this._pos,this)}}RulerV.prototype.setPosition=function(pos){this._pos=pos,this._picker._rulerPos=pos,this.setXValue(this._pos)};class RulerH extends Ruler{constructor(plot,name,rulerGroup){super(plot,name,HLine),rulerGroup&&(this._rulers=rulerGroup),this._picker=new PickerH(plot,this._pos,this)}}RulerH.prototype.setPosition=function(pos){this._pos=pos,this._picker._rulerPos=pos,this.setYValue(this._pos)},define("ruler",["static","plotMarker"],(function(){}));class MRulerV extends RulerV{constructor(plot,name,rulerGroup){super(plot,name,rulerGroup),this.rulers=function(){return this._rulers},this.validatePosition=function(){var changed=!1,plot=this.plot(),intv=plot.axisInterval(this.xAxis()),min=intv.minValue(),max=intv.maxValue(),minVal=plot.transform(this._picker.xAxis(),min),maxVal=plot.transform(this._picker.xAxis(),max),rulerPosVal=plot.transform(this._picker.xAxis(),this._pos),minX=this._rulers.minX(),maxX=this._rulers.maxX(),space=2;Static.isMobile()&&(space=12);var separationX=.5*(this.rulers().ruler(0).linePen().width+this.rulers().ruler(1).linePen().width)+space,n=this._rulers.rulerId(this),val,val;0==n&&(this._rulers.ruler(1).isVisible()?(rulerPosVal>=(val=plot.transform(this._picker.xAxis(),this._rulers.ruler(1)._pos))-separationX&&(this._pos=plot.invTransform(this._picker.xAxis(),val-separationX),changed=!0),rulerPosVal<minVal&&(this._pos=plot.invTransform(this._picker.xAxis(),minVal),changed=!0),this._rulers._curve&&this._pos<minX&&(this._pos=minX,changed=!0)):(rulerPosVal<minVal&&(this._pos=plot.invTransform(this._picker.xAxis(),minVal),changed=!0),rulerPosVal>maxVal&&(this._pos=plot.invTransform(this._picker.xAxis(),maxVal),changed=!0),this._rulers._curve&&this._pos<minX&&(this._pos=minX,changed=!0),this._rulers._curve&&this._pos>maxX&&(this._pos=maxX,changed=!0)));1==n&&(this._rulers.ruler(0).isVisible()?(rulerPosVal<=(val=plot.transform(this._picker.xAxis(),this._rulers.ruler(0)._pos))+separationX&&(this._pos=plot.invTransform(this._picker.xAxis(),val+separationX),changed=!0),rulerPosVal>maxVal&&(this._pos=plot.invTransform(this._picker.xAxis(),maxVal),changed=!0),this._rulers._curve&&this._pos>maxX&&(this._pos=maxX,changed=!0)):(rulerPosVal<minVal&&(this._pos=plot.invTransform(this._picker.xAxis(),minVal),changed=!0),rulerPosVal>maxVal&&(this._pos=plot.invTransform(this._picker.xAxis(),maxVal),changed=!0),this._rulers._curve&&this._pos<minX&&(this._pos=minX,changed=!0),this._rulers._curve&&this._pos>maxX&&(this._pos=maxX,changed=!0)));return changed}}setVisible(visible){if(super.setVisible(visible),visible&&this._rulers){var n=this._rulers.rulerId(this);0==n&&this._rulers.ruler(1).isVisible()||1==n&&this._rulers.ruler(0).isVisible()}else this._pos=Number.MAX_VALUE,this._rulers.updateWatchesAndTable()}setLockAt(val){this.setPosition(val),this.setLock(!0),Static.trigger("positionChanged",[this,val])}}class MRulerH extends RulerH{constructor(plot,name,rulerGroup){super(plot,name,rulerGroup),this.rulers=function(){return this._rulers},this.validatePosition=function(){var plot=this.plot(),intv=plot.axisInterval(this.yAxis()),min=intv.minValue(),max=intv.maxValue(),minVal=plot.transform(this.yAxis(),min),maxVal=plot.transform(this.yAxis(),max),rulerPosVal=plot.transform(this.yAxis(),this._pos),minY=this._rulers.minY(),maxY=this._rulers.maxY(),space=2;Static.isMobile()&&(space=12);var separationY=.5*(this.rulers().ruler(2).linePen().width+this.rulers().ruler(3).linePen().width)+space,n=this._rulers.rulerId(this),val,val;2==n&&(this._rulers.ruler(3).isVisible()?(rulerPosVal<=(val=plot.transform(this.yAxis(),this._rulers.ruler(3)._pos))+separationY&&(this._pos=plot.invTransform(this.yAxis(),val+separationY)),rulerPosVal>minVal&&(this._pos=plot.invTransform(this.yAxis(),minVal)),this._rulers._curve&&this._pos<minY&&(this._pos=minY)):(rulerPosVal<maxVal&&(this._pos=plot.invTransform(this.yAxis(),maxVal)),rulerPosVal>minVal&&(this._pos=plot.invTransform(this.yAxis(),minVal)),this._rulers._curve&&this._pos<minY&&(this._pos=minY),this._rulers._curve&&this._pos>maxY&&(this._pos=maxY)));3==n&&(this._rulers.ruler(2).isVisible()?(rulerPosVal>=(val=plot.transform(this.yAxis(),this._rulers.ruler(2)._pos))-separationY&&(this._pos=plot.invTransform(this.yAxis(),val-separationY)),rulerPosVal<maxVal&&(this._pos=plot.invTransform(this.yAxis(),maxVal)),this._rulers._curve&&this._pos>maxY&&(this._pos=maxY)):(rulerPosVal>minVal&&(this._pos=plot.invTransform(this.yAxis(),minVal)),rulerPosVal<maxVal&&(this._pos=plot.invTransform(this.yAxis(),maxVal)),this._rulers._curve&&this._pos<minY&&(this._pos=minY),this._rulers._curve&&this._pos>maxY&&(this._pos=maxY)))}}setVisible(visible){if(super.setVisible(visible),visible&&this._rulers){var n=this._rulers.rulerId(this);2==n&&this._rulers.ruler(3).isVisible()||3==n&&this._rulers.ruler(2).isVisible()}else this._pos=Number.MAX_VALUE,this._rulers.updateWatchesAndTable()}setLockAt(val){this.setPosition(val),this.setLock(!0),Static.trigger("positionChanged",[this,val])}}function Rulers(plot,flags){var self=this,_menu=[{name:"hide...",img:"images/hide.png",title:"hide the ruler.",fun:function(){plot.rv.currentRuler.setVisible(!1),plot.rv.currentRuler._picker.clearDragCursor(),plot.rv.hasVisibleRuler()}},{name:"lock...",img:"images/lock.png",title:"lock the ruler in its current position.",fun:function(){plot.rv.currentRuler.setLock(!0),plot.rv.hasLockedRuler()}},{name:"lock at...",img:"images/lockAt.png",title:"lock the ruler at a specific position.",fun:function(){var currentRulerPosition=0;currentRulerPosition=plot.rv.currentRuler instanceof RulerH?plot.rv.currentRuler.yValue():plot.rv.currentRuler.xValue(),Static.prompt("Enter a position",currentRulerPosition,(function(val){return plot.rv.currentRuler.setLockAt(parseFloat(val)),!0}),"small")}}],rulerDeselectMenu=[{name:"Hide rulers",img:"images/hide.png",title:"Hide all rulers",fun:function(){plot.rv.setVisible(!1)}},{name:"Show rulers",img:"images/show.png",title:"Show any hidden rulers",fun:function(){plot.rv.setVisible(!0)}},{name:"Unlock rulers",img:"images/unlock.png",title:"Unlock any locked rulers",fun:function(){plot.rv.unlockAllRulers()}}];if(this.setRulerDeselectMenu=function(menu){rulerDeselectMenu=menu||[]},this._curve=0,this._watchTable=new WatchTable(this),this._editor=0,this._curveShapeItem=0,this._watchSetter=0,this._rulerList=null,this._watchList=[],this.sidebarVisible=!1,plot.setAutoReplot(!0),this._rulerList=[new MRulerV(plot,"v_ruler1",self),new MRulerV(plot,"v_ruler2",self),new MRulerH(plot,"h_ruler1",self),new MRulerH(plot,"h_ruler2",self)],Static.isMobile())for(var i=0;i<4;++i){var p=this._rulerList[i].linePen();p.width=2*p.width}this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this.minX=function(){return this._minX},this.maxX=function(){return this._maxX},this.minY=function(){return this._minY},this.maxY=function(){return this._maxY},this.currentRuler=null;var el=plot.getLayout().getCentralDiv(),menuAppended=!1;Static.bind("rulerSelected",(function(e,ruler){self.currentRuler=ruler,menuAppended&&el.contextMenu("destroy"),menuAppended=!0,el.contextMenu(_menu,{triggerOn:"contextmenu",zIndex:1})})),Static.bind("rulerDeselected",(function(){menuAppended&&el.contextMenu("destroy"),menuAppended=!0,el.contextMenu(rulerDeselectMenu,{triggerOn:"contextmenu",zIndex:1})})),this.init(plot),this.position=function(rulerId){return rulerId>-1&&rulerId<4&&this._rulerList[rulerId].isVisible()?this._rulerList[rulerId]._pos:Number.MAX_VALUE},this.watch=function(id){return id>=0&&id<this._watchList.length?this._watchList[id]:null},this.addToWatchList=function(watch){return this._watchList.push(watch),this._watchList.length-1},this.setWatchEnabled=function(id,set){if(id>=0&&id<this._watchList.length){if(this._watchList[id].isEnable()==set)return;this._watchList[id].setEnable(set),set&&this.updateWatch(this._watchList[id]),this._watchTable.updateWatchTable()}},this.isWatchEnabled=function(id){return id>=0&&id<this._watchList.length&&this._watchList[id].isEnable()},Static.bind("showSidebar",(function(e,anchorPosition,on){"right"==anchorPosition&&(self.sidebarVisible=on)})),this.updateWatchesAndTable=function(){self.sidebarVisible&&this._curve&&(this.updateWatches(),this._watchTable&&this._watchTable.updateWatchTable())},this.setVisible=function(on){this._rulerList.forEach((function(ruler){ruler.setVisible(on)})),on&&Static.trigger("curveAdjusted"),this.refresh()},this.hasVisibleRuler=function(){for(var i=0;i<4;++i)if(this._rulerList[i].isVisible())return!0;return!1},this.hasLockedRuler=function(){for(var i=0;i<4;++i)if(this._rulerList[i].lock())return!0;return!1},this.updateWatch=function(w){if(w.isEnable()){var doReplot=plot.autoReplot();plot.setAutoReplot(!1),w.setCurveName(this._curve.title()),w.setRulerLeft(this.position(0)),w.setRulerRight(this.position(1)),w.setRulerBottom(this.position(2)),w.setRulerTop(this.position(3)),this._curve&&w.setCurve(this._curve),plot.setAutoReplot(doReplot),plot.autoRefresh(),w.computeWatch()}},this.updateWatches=function(){var doReplot=plot.autoReplot();plot.setAutoReplot(!1),this._watchList.forEach((function(w){self.updateWatch(w)})),plot.setAutoReplot(doReplot),plot.autoRefresh()},this.setEnabled=function(enable){this._rulerList.forEach((function(ruler){ruler._picker.setEnabled(enable)}))},this.setMouseTracking=function(enable){this._rulerList.forEach((function(ruler){ruler._picker.setMouseTracking(enable)}))},this.setZoomerSearch(!0),this.setPannerSearch(!0),this.setMouseTracking(!0),Static.bind("zoomerAdded",(function(e,zoomer){self.setZoomerSearch(self._rulerList[0]._picker.controlFlag(Static.ZoomerSearch)),self.setMouseTracking(!0)})),Static.bind("pannerAdded",(function(e,panner){self.setPannerSearch(self._rulerList[0]._picker.controlFlag(Static.PannerSearch)),self.setMouseTracking(!0)})),Static.bind("currentCurveChanged",(function(e,curve){self.setCurrentCurve(curve)})),plot.rv=this,Static.trigger("rulerDeselected")}Rulers.prototype.unlockAllRulers=function(){for(var i=0;i<this._rulerList.length;++i)this._rulerList[i].setLock(!1)},Rulers.prototype.setCurrentCurve=function(curve){this._curve!=curve&&this.doSetCurrentCurve(curve)},Rulers.prototype.refresh=function(){var p=this._rulerList[0].plot();if(p.replot(),this._curve&&this._curve.isVisible()){this._curve.isVisible()&&(this._minX=this._curve.minXValue(),this._maxX=this._curve.maxXValue(),this._minY=this._curve.minYValue(),this._maxY=this._curve.maxYValue());var axis=this._rulerList[0].xAxis(),intvX=p.axisInterval(this._rulerList[0].xAxis()),minX=intvX.minValue(),maxX=intvX.maxValue(),intvY=p.axisInterval(this._rulerList[0].yAxis()),minY=intvY.minValue(),maxY=intvY.maxValue();minX=this._minX<minX?minX:this._minX,this._rulerList[0].setPosition(minX),maxX=this._maxX<maxX?this._maxX:maxX,this._rulerList[1].setPosition(maxX),minY=this._minY<minY?minY:this._minY,this._rulerList[2].setPosition(minY),maxY=this._maxY<maxY?this._maxY:maxY,this._rulerList[3].setPosition(maxY),this.updateWatchesAndTable()}else this.resetXPositions(),this.resetYPositions()},Rulers.prototype.doSetRulersAxes=function(xAxis,yAxis){var plot=this._rulerList[0].plot(),doReplot=plot.autoReplot();plot.setAutoReplot(!1);for(var oldXAxis=this._rulerList[0].xAxis(),oldYAxis=this._rulerList[0].yAxis(),i=0;i<this._rulerList.length;++i)this._rulerList[i].setAxes(xAxis,yAxis),this._rulerList[i]._picker.setAxis(xAxis,yAxis);plot.setAutoReplot(doReplot),plot.autoRefresh()},Rulers.prototype.adjustToCurve=function(curve){this._curve=curve,this._curve&&(this.doSetRulersAxes(this._curve.xAxis(),this._curve.yAxis()),this._curveShapeItem),this.refresh()},Rulers.prototype.doSetCurrentCurve=function(curve){var oldCurve=this._curve;this.adjustToCurve(curve)},Rulers.prototype.setCurrentCurve=function(curve){this._curve!=curve&&this.doSetCurrentCurve(curve)},Rulers.prototype.currentCurve=function(){return this._curve},Rulers.prototype.init=function(plot){var self=this,_rulerList=this._rulerList;Static.bind("positionChanged decimalPlacesChanged calculationAccuracy",(function(e,ruler,rulerPos){self.updateWatchesAndTable()})),Static.bind("curveAdjusted",(function(){self.refresh()})),Static.bind("rescaled",(function(){Static.trigger("curveAdjusted")})),Static.bind("pointAdded pointRemoved",(function(e,curve){self.doSetCurrentCurve(curve)})),Static.bind("axisChanged",(function(e,axis,curve){self.currentCurve()===curve&&self.adjustToCurve(curve)})),this._rulerList[0].linePen().color="red",this._rulerList[2].linePen().color="red",this.resetXPositions(),this.resetYPositions()},Rulers.prototype.setZoomerSearch=function(on){this._rulerList.forEach((function(ruler){ruler.setZoomerSearch(on),ruler._picker.initZoomer()}))},Rulers.prototype.setPannerSearch=function(on){this._rulerList.forEach((function(ruler){ruler.setPannerSearch(on),ruler._picker.initPanner()}))},Rulers.prototype.setPosition=function(rulerId,pos){if(pos=parseFloat(pos),this._rulerList[rulerId]._pos==pos)return pos;var initialPos=this._rulerList[rulerId]._pos,changed;return this._rulerList[rulerId]._pos=pos,this._rulerList[rulerId].validatePosition(),this._rulerList[rulerId]._pos!==initialPos&&this._rulerList[rulerId].setPosition(this._rulerList[rulerId]._pos),this._rulerList[rulerId]._pos},Rulers.prototype.resetXPositions=function(){var plot=this._rulerList[0].plot(),doReplot=plot.autoReplot();plot.setAutoReplot(!1);var intv=plot.axisInterval(this._rulerList[0].xAxis());this._curve&&this._curve.isVisible()?(intv.minValue()>this._minX?this._rulerList[0].setPosition(intv.minValue()):this._rulerList[0].setPosition(this._minX),intv.maxValue()<this._maxX?this._rulerList[1].setPosition(intv.maxValue()):this._rulerList[1].setPosition(this._maxX)):(this._rulerList[0].setPosition(intv.minValue()),this._rulerList[1].setPosition(intv.maxValue())),plot.setAutoReplot(doReplot),plot.autoRefresh()},Rulers.prototype.resetYPositions=function(){var plot=this._rulerList[0].plot(),doReplot=plot.autoReplot();plot.setAutoReplot(!1);var intv=plot.axisInterval(this._rulerList[0].yAxis());this._curve&&this._curve.isVisible()?(this._rulerList[2].setPosition(this._minY),this._rulerList[3].setPosition(this._maxY),intv.minValue()>this._minY?this._rulerList[2].setPosition(intv.minValue()):this._rulerList[2].setPosition(this._minY),intv.maxValue()<this._maxY?this._rulerList[3].setPosition(intv.maxValue()):this._rulerList[3].setPosition(this._maxY)):(this._rulerList[2].setPosition(intv.minValue()),this._rulerList[3].setPosition(intv.maxValue())),plot.setAutoReplot(doReplot),plot.autoRefresh()},Rulers.prototype.ruler=function(rulerId){return rulerId<4&&rulerId>=0?this._rulerList[rulerId]:0},Rulers.prototype.rulerId=function(r){return r?this._rulerList.indexOf(r):-1},Rulers.prototype.preventDragging=function(on){for(var i=0;i<this._rulerList.length;++i)this._rulerList[i]._picker.preventDragging(on)},Rulers.prototype.setRulersXAxis=function(axis){var plot=this._rulerList[0].plot(),doReplot=plot.autoReplot();plot.setAutoReplot(!1);for(var i=0;i<this._rulerList.length;++i)this._rulerList[i].setXAxis(axis),this._rulerList[i]._picker.setAxis(axis,this._rulerList[i].yAxis());this._curveShapeItem&&this._curveShapeItem.setAxes(axis,this._rulerList[0].yAxis()),plot.setAutoReplot(doReplot),plot.autoRefresh()},Rulers.prototype.setRulersYAxis=function(axis){var plot=this._rulerList[0].plot(),doReplot=plot.autoReplot();plot.setAutoReplot(!1);for(var i=0;i<this._rulerList.length;++i)this._rulerList[i].setYAxis(axis),this._rulerList[i]._picker.setAxis(this._rulerList[i].xAxis(),axis);this._curveShapeItem&&this._curveShapeItem.setAxes(_rulerList[0].xAxis(),axis),plot.setAutoReplot(doReplot),plot.autoRefresh()};class WatchTable{constructor(_rulerGroup){function makeRow(watch){var watchVariable=watch.name(),value=watch.value();if("number"==watch.valueType||"text"==watch.valueType){for(var elemId=watchVariable;-1!=elemId.indexOf(" ");)elemId=elemId.replace(" ","");var row=$("<tr><td>"+watchVariable+"</td></tr>");$("#watchTableBody").append(row);var valueElem=$("<td><input id="+elemId+" type="+watch.valueType+'  style="width:100%" value='+value+" /></td>");row.append(valueElem),$("#"+elemId).on("change",watch.cb)}else $("#watchTableBody").append($("<tr><td>"+watchVariable+"</td><td>"+value+"</td></tr>"))}this.removeAllRows=function(){for(var rows=$("#watchTableBody").children(),i=0;i<rows.length;++i)$("#watchTableBody")[0].removeChild(rows[i])},this.insertInfoRow=function(watch){makeRow(watch)},this.updateWatchTable=function(){if(Static.watchUpdateError,this.removeAllRows(),_rulerGroup._curve&&_rulerGroup._curve.isVisible())for(var n=_rulerGroup._watchList.length,i=0;i<n;++i){var w=_rulerGroup.watch(i);w.isEnable()&&this.insertInfoRow(w)}Static.showWatchUpdateError&&Static.watchUpdateError&&confirm("The application encountered extremely small values that may affect the computation of one or more watches. This may be due to incorrect axes decimal places setup (Plot Property pane: Watch Settings -> Calculation accuracy -> Decimal places in calculation).\n\nWould you like to prevent this message ?")&&(Static.showWatchUpdateError=!1)}}}define("rulers",["static","mpicker","ruler"],(function(){}));class SideBar{constructor(parent,gridItems,anchorPosition){var self=this,sideBarWidth=20;self.sideBarVisible=!1;var m_anchorPosition=anchorPosition||"right",m_html=null,sideBarDlg=$('<div class="grid-container noprint" style="position: absolute; border: 1px solid lightgray;"/>');parent.append(sideBarDlg),sideBarDlg.css("bottom",0),sideBarDlg.css("top",0);class GridItem{constructor(){this.visible=!0,this.headerElement=null,this.bodyElement=null,this.element=null,this.anchorPosition=""}}for(var gridItemsList=[],numOfVisibleGridItems=0,i=0;i<gridItems;++i){var gridItem=new GridItem;gridItem.anchorPosition=m_anchorPosition,gridItem.element=$('<div class="grid-item"></div>'),sideBarDlg.append(gridItem.element),gridItem.headerElement=$('<div class="grid-item-header"></div>'),gridItem.element.append(gridItem.headerElement),gridItem.bodyElement=$('<div class="grid-item-body"></div>'),gridItem.element.append(gridItem.bodyElement),gridItemsList.push(gridItem),++numOfVisibleGridItems}this.hideAllGridItems=function(){for(var i=0;i<gridItems;++i)this.doShowGridItem(i,!1)},this.setHeaderElement=function(gridIndex,val){gridItemsList[gridIndex].headerElement.css("height",val+"px"),this.setGridItemHeigth()},this.setGridItemHeigth=function(){for(var availableHeight=parseInt(sideBarDlg.css("height")),gridItemHeightPercent=1/numOfVisibleGridItems*100,i=0;i<gridItemsList.length;++i)if(gridItemsList[i].visible){gridItemsList[i].element.css("height",gridItemHeightPercent+"%");var itemHeight=parseInt(gridItemsList[i].element.css("height")),headerHeight,gridItemBodyHeightPercent=100*(1-parseInt(gridItemsList[i].headerElement.css("height"))/itemHeight);gridItemsList[i].bodyElement.css("height",gridItemBodyHeightPercent+"%")}},this.doShowGridItem=function(gridIndex,on){if(gridItemsList[gridIndex].visible!=on)return on?(this.sideBarVisible||this.showSidebar(!0),gridItemsList[gridIndex].element.show(),++numOfVisibleGridItems):(gridItemsList[gridIndex].element.hide(),0===--numOfVisibleGridItems&&this.showSidebar(!1)),gridItemsList[gridIndex].visible=on,this.setGridItemHeigth(),Static.trigger("showGridItem",[m_anchorPosition,gridIndex,on]),numOfVisibleGridItems},this.gridItem=function(gridIndex){return gridIndex<gridItemsList.length?gridItemsList[gridIndex]:null},this.gridItemCount=function(){return gridItemsList.length},this.setGridItemHeigth(),sideBarDlg.css("width","20%"),this.isSideBarVisible=function(){return self.sideBarVisible},this.sideBarWidth=function(){return 20},this.setTop=function(top){sideBarDlg.css("top",top)},this.setBorderStyle=function(style){sideBarDlg.css("border-style",style)},this.setBorderWidth=function(width){sideBarDlg.css("border-width",width)},this.setBackgroundColor=function(color){sideBarDlg.css("background-color",color)},this.html=function(){return sideBarDlg};var visible=!1;Static.bind("beforePrint",(function(){})),Static.bind("afterPrint",(function(){})),this.anchorPosition=function(){return m_anchorPosition},this.getIndexFromHeaderElement=function(headerElement){for(var i=0;i<self.gridItemCount();++i)if(self.gridItem(i).headerElement[0].offsetTop==headerElement.offsetTop&&self.gridItem(i).headerElement[0].innerText==headerElement.innerText)return i;return-1},this.hideGridItemWithHeaderElement=function(headerElement){for(var i=0;i<self.gridItemCount();++i)if(self.gridItem(i).headerElement[0].offsetTop==headerElement.offsetTop&&self.gridItem(i).headerElement[0].innerText==headerElement.innerText)return self.showGridItem(i,!1);return-1};var tbarDiv=$("#toolBar1"),plotDiv=$("#plotDiv");Static.bind("resize",(function(){self.html().css("top",parseFloat(tbarDiv.css("height"))+2),"left"===m_anchorPosition&&self.isSideBarVisible()&&plotDiv.css("left",parseFloat(self.html().css("width")))})),this.hideAllGridItems(),sideBarDlg.hide()}showSidebar(on){if(this.isSideBarVisible()!=on){this.sideBarVisible=on,on?(this.html().show(),"right"==this.anchorPosition()?this.html().css("right","0.5%"):"left"==this.anchorPosition()&&this.html().css("left","0.5%")):this.html().hide();var plotDivWidthAsPercentage=parseFloat($("#plotDiv").css("width"))/parseFloat($("#plotDiv").parent().css("width"))*100;on?"right"==this.anchorPosition()?$("#plotDiv").css("width",plotDivWidthAsPercentage-this.sideBarWidth()+"%"):"left"==this.anchorPosition()&&($("#plotDiv").css("left",this.sideBarWidth()+"%"),$("#plotDiv").css("width",plotDivWidthAsPercentage-this.sideBarWidth()+"%")):($("#plotDiv").css("width",plotDivWidthAsPercentage+this.sideBarWidth()+"%"),"left"==this.anchorPosition()&&$("#plotDiv").css("left","0%")),Static.trigger("showSidebar",[this.anchorPosition(),on])}}showGridItem(gridIndex,on){this.doShowGridItem(gridIndex,on)}}define("sideBar",(function(){}));class InfoSideBar extends SideBar{constructor(plot){super($("#plotDiv").parent(),1,"right");var self=this,m_plot=plot;this.plot=function(){return m_plot},Static.bind("paneClose",(function(e,headerElement){self.hideGridItemWithHeaderElement(headerElement)})),this.setHeaderElement(0,40)}showGridItem(gridIndex,on){this.doShowGridItem(gridIndex,on)}showSidebar(on){this.isSideBarVisible()!=on&&(super.showSidebar(on),this.plot().autoRefresh())}}define("infoSidebar",["sideBar"],(function(){}));class Pane{constructor(_parent){var self=this;self.paneParent=$("<div/>"),_parent.append(self.paneParent),this.setPaneHeight=function(percent){self.paneParent.css("height",percent)},this.setHeader=function(headerElement,caption,close){var close=close||!1,_header=this.header(caption);if(close){var closeButton=$('<div><button style="position: absolute; right:1px">X</button></div>');headerElement.append(closeButton),closeButton.on("click",(function(){Static.trigger("paneClose",headerElement)}))}headerElement.append(_header)}}header(caption){var hdr=$('<div style="text-align:center; padding-top: 10px; border-style: solid; border-width:1px; border-color:#666666; font-size: 16px; color:#666666"/>');return hdr.append("<label>"+caption+"</label>"),hdr}}define("pane",(function(){}));class InfoPropertiesPane extends Pane{constructor(_parent,plot){super(_parent);var self=this;this.setHeader(plot.rightSidebar.gridItem(0).headerElement,"Sidebar",!0);var sideBarDlg=$('<div style="background-color:rgba(249, 251, 221, 0.8);  ">                <div style="margin:4px">                <select id="currentCurve" style="width:100%">                </select></div>                <div><input type="text" id="fnDisplay" style="width:100%; background-color:rgba(255, 255, 255, 0.8); padding-left:6px" readonly /></div>                <div><label style="padding-left:6px">onchcange: <input id="onchange" type="checkbox" readonly /> </label>\t\t\t\tdamp: <input id="damp" style="width:30%" type="number" min="1" value="30000" step="500"/>\t\t\t\t</div>                                <div style="height:30%; overflow: auto">                <div id="coeff_cont0" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff0">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val0" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                <br>                <div id="coeff_cont1" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff1">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val1" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                <br>                <div id="coeff_cont2" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff2">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val2" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                <br>                <div id="coeff_cont3" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff3">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val3" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                <br>                <div id="coeff_cont4" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff4">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val4" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                </div>                                <div style="text-align:center"><h4>Watches</h4></div>                <div class="table-responsive" style="height: 47%">                                                <table class="table table-bordered" id="watchTable">                <thead>                <tr>                <th>Watch</th>                <th>Value</th>                </tr>                </thead>                <tbody id="watchTableBody">                </tbody>                </table>                                                </div>                </div>');function initSidebarSelect(){for(var opts=$("#currentCurve").children(),i=0;i<opts.length;++i)$("#currentCurve")[0].removeChild(opts[i]);for(var curves=plot.itemList(Static.Rtti_PlotCurve),i=0;i<curves.length;++i)if(curves[i].isVisible()){var opt=$("<option>"+curves[i].title()+"</option>");opt.attr("value",curves[i].title()),$("#currentCurve").append(opt)}}function hideAllInputs(){for(var i=0;i<5;++i)$("#coeff_cont"+i).hide()}function initSidebarInput(){var curves=plot.itemList(Static.Rtti_PlotCurve);hideAllInputs();var curCurve=plot.findPlotCurve($("#currentCurve").val());if(curCurve){$("#fnDisplay").val(""),curCurve.fn&&$("#fnDisplay").val("f("+curCurve.variable+")="+curCurve.fn);for(var damp=3e4,step=(curCurve.upperX-curCurve.lowerX)/(damp/1e4),coeffs=curCurve.coeffs||[],numOfCoeffs=coeffs.length,i=0;i<numOfCoeffs;++i)$("#coeff_val"+i).attr("step",step);$("#damp").on("input",(function(){var val=parseInt($("#damp").val());!_.isFinite(val)||val<1?$("#damp").val(damp):damp=val,step=(curCurve.upperX-curCurve.lowerX)/(damp/1e4);for(var i=0;i<numOfCoeffs;++i)$("#coeff_val"+i).attr("step",step)})),numOfCoeffs>5&&(numOfCoeffs=5);for(var i=0;i<numOfCoeffs;++i)$("#coeff"+i).html(coeffs[i]),$("#coeff_val"+i).attr("step",step),$("#coeff_val"+i).val(curCurve.coeffsVal[i]),$("#coeff_cont"+i).show()}}function initSidebar(){initSidebarSelect(),initSidebarInput(),Static.trigger("currentCurveChanged",plot.findPlotCurve($("#currentCurve").val()))}this.paneParent.append(sideBarDlg),plot.sidebar=this,this.sidebarDlg=function(){return sideBarDlg};var m_sidebarReDisplay=!1;function initializeEventHandlers(){$("#currentCurve").change((function(){Static.total_volume=void 0,Static.total_area=void 0,Static.prevStart=void 0,Static.prevEnd=void 0,initSidebarInput(),Static.trigger("invalidateWatch"),Static.trigger("currentCurveChanged",plot.findPlotCurve($("#currentCurve").val()))})),$("#coeff_val0, #coeff_val1, #coeff_val2, #coeff_val3, #coeff_val4").on("input",(function(){$("#onchange")[0].checked||validateInput($(this))&&adjustCurve()})),$("#coeff_val0, #coeff_val1, #coeff_val2, #coeff_val3, #coeff_val4").on("change",(function(){validateInput($(this))?$("#onchange")[0].checked&&adjustCurve():$(this).val(getLastValidValue($(this)))}))}this.sidebarReDisplay=function(){return m_sidebarReDisplay},this.setSidebarReDisplay=function(on){m_sidebarReDisplay=on},this.setTop=function(topPosition){sideBarDlg.css("top",topPosition)};var initializeEventHandlersOnce=_.once(initializeEventHandlers);this.initSidebar=function(){initSidebar(),initializeEventHandlersOnce()},this.currentCurveName=function(){return $("#currentCurve").val()};var sideBarWidth=20;function adjustCurve(){for(var curCurve=plot.findPlotCurve($("#currentCurve").val()),coeffs=curCurve.coeffs,fn=curCurve.fn,i=0;i<coeffs.length;++i){for(;-1!=fn.indexOf(coeffs[i]);)fn=fn.replace(coeffs[i],$("#coeff_val"+i).val());curCurve.coeffsVal[i]=$("#coeff_val"+i).val()}curCurve.expandedFn=fn;var data=curCurve.data();curCurve.unboundedRange?data.setFn(fn):data.setSamples(Utility.makeSamples({fx:fn,lowerX:curCurve.lowerX,upperX:curCurve.upperX,numOfSamples:curCurve.numOfSamples})),Static.trigger("curveAdjusted"),plot.autoRefresh()}function getLastValidValue(input){var inputIds=["coeff_val0","coeff_val1","coeff_val2","coeff_val3","coeff_val4"],curCurve;return plot.findPlotCurve($("#currentCurve").val()).coeffsVal[inputIds.indexOf(input[0].id)]}function isValidNumber(val){return _.isFinite(parseFloat(val))}function validateInput(input){var inputIds=["coeff_val0","coeff_val1","coeff_val2","coeff_val3","coeff_val4"],curCurve,coeffsVal=plot.findPlotCurve($("#currentCurve").val()).coeffsVal,inputIdIndex=inputIds.indexOf(input[0].id);return!!isValidNumber(input.val())}Static.bind("titleChange",(function(){initSidebar()})),Static.bind("pointAdded pointRemoved",(function(e,curve){$("#currentCurve").val(curve.title)})),Static.bind("itemAttached",(function(e,plotItem,on){plotItem.rtti==Static.Rtti_PlotCurve&&(on||!plot.itemList(Static.Rtti_PlotCurve).length||plot.hasVisiblePlotCurve(),Static.trigger("visibilityChange",[plotItem,on]))})),this.initSidebar()}}define("infoPropertiesPane",["pane"],(function(){}));class PlotSideBar extends SideBar{constructor(plot){super($("#plotDiv").parent(),2,"left");var self=this,m_plot=plot;this.plot=function(){return m_plot},Static.bind("paneClose",(function(e,headerElement){self.hideGridItemWithHeaderElement(headerElement)}))}showSidebar(on){this.isSideBarVisible()!=on&&(super.showSidebar(on),this.plot().autoRefresh())}showGridItem(gridIndex,on){this.doShowGridItem(gridIndex,on)}}define("plotSideBar",["sideBar"],(function(){}));class PropertiesPane extends Pane{static fontsDisplay(){return["Arial","Arial Black","Comic Sans MS","Courier New","Georgia","Impact","Lucida Console","Lucida Sans Unicode","PalatinoLinotype","Tahoma","Times New Roman","Trebuchet MS","Verdana","Gill Sans"]}static fontGroup(displayIndex){var fontsGroup;return["Arial,Arial,Helvetica,sans-serif","Arial Black,Arial Black,Gadget,sans-serif","Comic Sans MS,Comic Sans MS,cursive","Courier New,Courier New,Courier,monospace","Georgia,Georgia,serif","Impact,Charcoal,sans-serif","Lucida Console,Monaco,monospace","Lucida Sans Unicode,Lucida Grande,sans-serif","Palatino Linotype,Book Antiqua,Palatino,serif","Tahoma,Geneva,sans-serif","Times New Roman,Times,serif","Trebuchet MS,Helvetica,sans-serif","Verdana,Geneva,sans-serif","Gill Sans,Geneva,sans-serif"][displayIndex]}constructor(_parent){super(_parent);var self=this,propertiesTable=$("<table/>");function makeRow(options){null==options.type&&(options.type="span");var disabled="";options.disabled&&(disabled="disabled");var checked="";options.checked&&(checked="checked");var _value="";void 0!==options.value&&(_value="value="+options.value);var row=null;if("text"==options.type)return $('<tr><td style="border: 1px solid grey;">'+options.name+'</td><td style="border: 1px solid grey;"><input type="text" '+disabled+" "+_value+' style="width:100%"/></td></tr>');if("button"==options.type)return $('<tr><td style="border: 1px solid grey;">'+options.name+'</td><td style="border: 1px solid grey;"><input type="button" '+disabled+' value="..." /></td></tr>');if("number"==options.type)return $('<tr><td style="border: 1px solid grey;">'+options.name+'</td><td style="border: 1px solid grey;"><input type="number" '+disabled+" step ="+options.step+" min ="+options.min+" max="+options.max+" "+_value+' style="width:100%"/></td></tr>');if("checkbox"==options.type)return $('<tr><td style="border: 1px solid grey;">'+options.name+'</td><td style="border: 1px solid grey;"><input '+disabled+' type="checkbox" style="width:100%" '+checked+"/></td></tr>");if("radio"==options.type)return $('<tr><td style="border: 1px solid grey;">'+options.name+'</td><td style="border: 1px solid grey;"><input '+disabled+' type="radio" name='+options.group+' style="width:100%" '+checked+"/></td></tr>");if("color"==options.type){var color="#000000";return options.value&&(color=Static.colorNameToHex(options.value)),$('<tr><td style="border: 1px solid grey;">'+options.name+'</td><td style="border: 1px solid grey;"><input '+disabled+' type="color" value='+color+" /></td></tr>")}if("span"==options.type)return $('<tr><td style="border: 1px solid grey;">'+options.name+'</td><td style="border: 1px solid grey;"><span style="width:100%"/></td></tr>');if("select"==options.type){var row=$('<tr><td style="border: 1px solid grey;">'+options.name+"</td></tr>"),select=$("<select "+disabled+" />");if(options.selectorOptions)for(var i=0;i<options.selectorOptions.length;++i)select.append($("<option>"+options.selectorOptions[i]+"</option>"));return row.append($("<td/>").append(select))}return row}this.paneParent.append(propertiesTable),this.table=function(){return propertiesTable},this.init=function(options){var _options=options||{expandable:!0,clickableNodeNames:!0};propertiesTable.treetable(_options)},this.hide=function(id){var node=propertiesTable.treetable("node",id);node?node.hide():console.error("invalid id: "+id)},this.show=function(id){var node=propertiesTable.treetable("node",id);node?node.show():console.error("invalid id: "+id)},this.getElementValueDataAttribute=function(id){for(var row=null,trElements=propertiesTable[0].getElementsByTagName("TR"),i=0;i<trElements.length;++i)if(trElements[i].getAttribute("data-tt-id")==id){row=trElements[i];break}if(row){var children=row.children;return 2!==children.length?null:$(children[1].children[0])}return null},this.getTableRowByPropertyName=function(name){for(var trElements=propertiesTable[0].getElementsByTagName("TR"),i=0;i<trElements.length;++i)if(trElements[i].cells[0].innerText==name)return $(trElements[i]);return null},this.getTableRowByPropertyId=function(id){for(var trElements=propertiesTable[0].getElementsByTagName("TR"),i=0;i<trElements.length;++i)if(trElements[i].getAttribute("data-tt-id")==id)return $(trElements[i]);return null},this.getElementValueDataByPropertyName=function(name){for(var row=null,trElements=propertiesTable[0].getElementsByTagName("TR"),i=0;i<trElements.length;++i)if(trElements[i].cells[0].innerText==name){row=trElements[i];break}if(row){var children=row.children;return 2!==children.length?null:$(children[1].children[0])}return null},this.setFontSize=function(sz){propertiesTable.css("font-size",sz)},this.addProperty=function(options){var row=makeRow(options);if(!row)return null;var selector=null;return row.attr("data-tt-id",options.id),void 0!==options.parentId&&row.attr("data-tt-parent-id",options.parentId),"text"!=options.type&&"number"!=options.type&&"color"!=options.type&&"checkbox"!=options.type&&"radio"!=options.type||(selector=$(row[0].getElementsByTagName("INPUT"))).on("change",(function(){options.fun&&("checkbox"==options.type?options.fun($(this)[0].checked):options.fun($(this).val()))})),"select"==options.type&&(selector=$(row[0].getElementsByTagName("SELECT"))).on("change",(function(){options.fun&&options.fun($(this)[0].selectedIndex)})),"button"==options.type&&(selector=$(row[0].getElementsByTagName("INPUT"))).on("click",(function(){options.fun&&options.fun()})),"span"==options.type&&(selector=$(row[0].getElementsByTagName("SPAN"))),propertiesTable.append(row),options.title&&row.attr("title",options.title),selector}}header(caption){var hdr=$("<table />");return hdr.append('<caption style="text-align:center; border-width:4px; color:black"><b>'+caption+"</b></caption>"),hdr.append('<thead style="background-color:lightgray">                <tr style="border-style:solid; border-width:1px">                <th style="border-style:none;"><label>Property</label></th>                <th style="border-style:none; text-align:right"><label style="margin-right:4px">Value</label></th>                </tr>                </thead>'),hdr}}define("propertiesPane",["pane"],(function(){}));class CurvePropertiesPane extends PropertiesPane{constructor(_parent,plot){super(_parent);var self=this;self.setHeader(plot.leftSidebar.gridItem(0).headerElement,"Curve Properties",!0);var curveSelectProp=this.addProperty({name:"Curve",id:"currentCurve",type:"select",title:"Curve being modified",fun:currentCurve});this.addProperty({name:"Rename",id:"renameCurve",type:"button",title:"Give the curve a different unique name",fun:renameCurve}),this.addProperty({name:"Remove",id:"removeCurve",type:"button",title:"Permanently remove the currently selected curve",fun:removeCurve}),this.addProperty({name:"Fit",id:"fitCurve",type:"button",title:"Assign a curve fitter to the currently selected curve",fun:fitCurve}),this.addProperty({name:"Legend Attributes",id:"legendAttributes",type:"button",title:"Configure how the curve is represented on the legend",fun:legendAttributes}),this.addProperty({name:"Orientation",id:"orientation",type:"select",selectorOptions:["Vertical","Horizontal"],title:"Set the orientation of the curve. This affect how the step and stick styles are displayed",fun:orientation});var curveStyleOptions=["Lines (Default)","Sticks","Steps","Dots","NoCurve"],curveSTyleSelector=this.addProperty({name:"Style",id:"curveStyle",type:"select",selectorOptions:curveStyleOptions,title:"Set the curve's drawing style",fun:curveStyle}),axisSpanElement=this.addProperty({name:"Axes",id:"curveAxes",title:"Set X and Y axis. The curve is drawn according to the coordinates of its Axes."}),axisHorizontalSelectElement=this.addProperty({name:"Horizontal",id:"horizontal",parentId:"curveAxes",type:"select",selectorOptions:["Bottom","Top"],title:"Set X axis.",fun:horizontal}),axisVerticalSelectElement=this.addProperty({name:"Vertical",id:"vertical",parentId:"curveAxes",type:"select",selectorOptions:["Left","Right"],title:"Set Y axis.",fun:vertical});this.addProperty({name:"Pen",title:"Build and assign a pen.",id:"curvePen"}),this.addProperty({name:"Color",id:"curvePenColor",parentId:"curvePen",type:"color",title:"Set the pen color",fun:curvePenColor}),this.addProperty({name:"Style",id:"curvePenStyle",parentId:"curvePen",type:"select",selectorOptions:["solid","dot","dash","dash-dot","dash-dot-dot"],title:"Set the pen style",fun:curvePenStyle}),this.addProperty({name:"Width",id:"curvePenWidth",parentId:"curvePen",type:"select",selectorOptions:[1,2,3,4,5],title:"Set the pen width",fun:curvePenWidth}),this.addProperty({name:"Curve Symbol",title:"Assign a symbol. Any previously set symbol is removed by setting a new one.",id:"curveSymbol"}),this.addProperty({name:"Pen",title:"Build and assign a pen.",id:"curveSymPen",parentId:"curveSymbol"}),this.addProperty({name:"Color",id:"curveSymbolPenColor",parentId:"curveSymPen",type:"color",title:"Set the pen color",fun:curveSymbolPenColor}),this.addProperty({name:"Width",id:"curveSymbolPenWidth",parentId:"curveSymPen",type:"select",selectorOptions:[1,2,3,4,5],title:"Set the pen width",fun:curveSymbolPenWidth}),this.addProperty({name:"Fill Brush",id:"curveSymbolBrushColor",parentId:"curveSymbol",type:"color",title:"Assign a brush. The brush is used to draw the interior of the symbol.",fun:curveSymbolBrushColor}),this.addProperty({name:"Style",id:"curveSymbolStyle",parentId:"curveSymbol",type:"select",selectorOptions:["None","Rectangle","Cross","Diamond","Ellipse","Diagonal cross"],title:"Specify the symbol style",fun:curveSymbolStyle}),this.addProperty({name:"Size",id:"curveSymbolSize",parentId:"curveSymbol",type:"select",selectorOptions:["5x5","6x6","8x8","10x10","12x12","15x15"],title:"Specify the symbol's size.",fun:curveSymbolSize}),this.addProperty({name:"Fill",title:"If the curve style is not equal to Sticks, the area between the curve and the baseline can be filled.",id:"curveFill"}),this.addProperty({name:"Brush",id:"curveFillBrushColor",parentId:"curveFill",type:"color",title:"Assign the brush used to fill the curve.",fun:curveFillBrushColor}),this.addProperty({name:"Fill Curve",id:"fillCurve",parentId:"curveFill",type:"checkbox",title:"If checked, curve filling is enabled.",fun:fillCurve}),this.addProperty({name:"Baseline",id:"baseline",type:"number",value:0,step:.5,title:"Set the value of the baseline. The baseline is required for filling the curve with a brush or the Sticks curve style.",fun:baseline}),this.addProperty({name:"Pen Width",id:"penWidth",type:"select",selectorOptions:[1,2,3,4,5],title:"Assign a pen width.",fun:curvePenWidth2}),this.addProperty({name:"Colormap",id:"colormap",type:"select",selectorOptions:["RGB-map","Indexed-map"],title:"Change the color map. Color Maps are used for mapping the intensity values to colors",fun:colormap}),this.addProperty({name:"Interpolation",id:"interpolation",type:"select",selectorOptions:["Bi-Linear","Bi-Cubic"],title:"Select the interpolation type.",fun:interpolation});var spectrogramElement=this.addProperty({name:"Spectrogram",title:"Configure how the spectrogram is drawn.",id:"spectrogram"});this.addProperty({name:"show",id:"showSpectrogram",parentId:"spectrogram",type:"checkbox",checked:!0,title:"If checked, the spectrogram is drawn.",fun:showSpectrogram}),this.addProperty({name:"alpha",id:"alpha",parentId:"spectrogram",type:"number",min:0,max:255,value:255,step:1,title:"Set an alpha value for the raster data.",fun:alpha});var contoursElement=this.addProperty({name:"Contours",title:"Configure contours.",id:"contours"});function initCurveSelect(){let opts=curveSelectProp.children();for(let i=0;i<opts.length;++i)curveSelectProp[0].removeChild(opts[i]);for(var itemList=plot.itemList(),curves=[],i=0;i<itemList.length;++i)itemList[i].rtti!==Static.Rtti_PlotCurve&&itemList[i].rtti!==Static.Rtti_PlotSpectroCurve&&itemList[i].rtti!==Static.Rtti_PlotSpectrogram||curves.push(itemList[i]);for(let i=0;i<curves.length;++i){let opt=$("<option>"+curves[i].title()+"</option>");opt.attr("value",curves[i].title()),curveSelectProp.append(opt)}return Static.trigger("currentCurveChangedViaPropertiesPane",curves[0]),null}function currentCurve(selectIndex){let curve=plot.findPlotCurve(curveSelectProp.val());initDlg(curve),Static.trigger("currentCurveChangedViaPropertiesPane",curve)}this.addProperty({name:"show",id:"showContours",parentId:"contours",type:"checkbox",title:"If checked, contours are drawn.",fun:showContours}),this.addProperty({name:"Number of planes",id:"numberOfPlanes",parentId:"contours",type:"number",min:0,max:20,value:10,step:1,title:"Set the number of contour planes.",fun:numberOfPlanes}),this.addProperty({name:"Color interval",title:"Set the color range.",id:"colorInterval"}),this.addProperty({name:"color1",id:"color1",parentId:"colorInterval",type:"color",title:"Color used for the minimum value of the value interval.",fun:color1}),this.addProperty({name:"color2",id:"color2",parentId:"colorInterval",type:"color",title:"Color used for the maximum value of the value interval.",fun:color2}),this.addProperty({name:"Color range",title:"Set the value interval, that corresponds to the color map.",id:"colorRange"}),this.addProperty({name:"minimum Z",id:"minimumZ",parentId:"colorRange",type:"number",title:"Lower limit of the interval.",fun:minimumZ}),this.addProperty({name:"maximum Z",id:"maximumZ",parentId:"colorRange",type:"number",title:"Upper limit of the interval.",fun:maximumZ}),this.init(),this.setFontSize("12px"),Static.bind("showGridItem",(function(e,m_anchorPosition,gridIndex,on){if("left"==m_anchorPosition&&0==gridIndex&&on){let curve;initDlg(plot.findPlotCurve(curveSelectProp.val()))}})),Static.bind("itemAttached",(function(e,plotItem,on){plotItem.rtti!=Static.Rtti_PlotCurve&&plotItem.rtti!=Static.Rtti_PlotSpectroCurve&&plotItem.rtti!=Static.Rtti_PlotSpectrogram||(on||(plot.hasVisiblePlotCurve()||plot.hasVisiblePlotSpectroCurve()||plot.hasVisiblePlotSpectrogram()||plot.leftSidebar.showGridItem(0,!1),plot.hasPlotCurve()),initCurveSelect(),initDlg(plot.findPlotCurve(curveSelectProp.val())))})),plot.leftSidebar.showGridItem(0,!1);var selectIndex=-1;function renameCurve(){selectIndex=curveSelectProp[0].selectedIndex,Utility.curveRenameDlg(curveSelectProp.val(),plot)}function removeCurve(){let curve;plot.findPlotCurve(curveSelectProp.val()).detach()}function fitCurve(){plot.curveFitDlg.curveFitCb(plot.findPlotCurve(curveSelectProp.val()))}function legendAttributes(){plot.curveAttributeDlg.curveAttributeCb(plot.findPlotCurve(curveSelectProp.val()))}function orientation(selectIndex){let curve=plot.findPlotCurve(curveSelectProp.val());1==selectIndex?curve.setOrientation(Horizontal):curve.setOrientation(Vertical)}Static.bind("curveRenamed",(function(){-1==selectIndex&&(selectIndex=curveSelectProp[0].selectedIndex),initCurveSelect(),curveSelectProp[0].selectedIndex=selectIndex;var curve=plot.findPlotCurve(curveSelectProp.val());selectIndex=-1}));var styleMap=[Lines,Sticks,Steps,Dots,NoCurve];function curveStyle(selectIndex){let curve;plot.findPlotCurve(curveSelectProp.val()).setStyle(styleMap[selectIndex])}function setContoursTd(curve){var visible="Visible";curve.testDisplayMode(Enum.DisplayMode.ContourMode)||(visible="Hidden"),contoursElement.html(visible+", planes:"+curve.contourLevels().length)}function setSpectrogramTd(curve){var visible="Visible";curve.testDisplayMode(Enum.DisplayMode.ImageMode)||(visible="Hidden"),spectrogramElement.html(visible+", alpha:"+curve.alpha())}function setCurveAxesTd(curve){var vertical="Left";curve.yAxis()==yRight&&(vertical="Right");var horizontal="Bottom";curve.xAxis()==xTop&&(horizontal="Top"),axisSpanElement.html(horizontal+", "+vertical)}function horizontal(selectIndex){let curve=plot.findPlotCurve(curveSelectProp.val());var axis=0==selectIndex?xBottom:xTop;curve.setXAxis(axis),setCurveAxesTd(curve),Static.trigger("curveAxisChangedViaPropertiesPane",[axis,curve])}function vertical(selectIndex){let curve=plot.findPlotCurve(curveSelectProp.val());var axis=0==selectIndex?yLeft:yRight;curve.setYAxis(axis),setCurveAxesTd(curve),Static.trigger("curveAxisChangedViaPropertiesPane",[axis,curve])}Static.bind("curveStyleChanged",(function(e,curve){initDlg(curve)})),Static.bind("axisChanged",(function(e,axis,curve){initDlg(curve)})),this.penIcon=function(curve){if(!curve)return null;var height=16,width=50,graphic=new Graphic(null,50,16),painter=new PaintUtil.Painter(graphic);if(curve.pen().color!=Static.NoPen){var pn=curve.pen();painter.setPen(pn);var y=8;painter.drawLine(0,8,50,8)}return painter=null,graphic},this.spanElem=null;var curvePenSpanElementParent=this.getElementValueDataAttribute("curvePen").parent();this.setPenIcon=function(){var plotItem=plot.findPlotCurve(curveSelectProp.val()),tdElem=curvePenSpanElementParent,icon=this.penIcon(plotItem);this.spanElem&&this.spanElem.remove(),this.spanElem=$('<span id="spanElem" />'),icon&&icon.setParent(this.spanElem),this.spanElem.appendTo(tdElem)};var curvePenColorElement=this.getElementValueDataAttribute("curvePenColor");function curvePenColor(color){let curve=plot.findPlotCurve(curveSelectProp.val()),pen=curve.pen();pen.color=color,curve.setPen(pen),initDlg(curve)}Static.bind("penAttributeChanged",(function(e,curve){initDlg(curve)}));var curvePenStyles=["solid","dot","dash","dashDot","dashDotDot"],curvePenStyleElement=this.getElementValueDataAttribute("curvePenStyle");function curvePenStyle(selectIndex){let curve=plot.findPlotCurve(curveSelectProp.val()),pen=curve.pen();pen.style=curvePenStyles[selectIndex],curve.setPen(pen),initDlg(curve)}var curvePenWidthElement=this.getElementValueDataAttribute("curvePenWidth");function curvePenWidth(selectIndex){let curve=plot.findPlotCurve(curveSelectProp.val()),pen=curve.pen();pen.width=selectIndex+1,curve.setPen(pen),initDlg(curve)}function minimumZ(val){let curve;plot.findPlotCurve(curveSelectProp.val()).colorRange().setMinValue(val),plot.autoRefresh()}function maximumZ(val){let curve;plot.findPlotCurve(curveSelectProp.val()).colorRange().setMaxValue(val),plot.autoRefresh()}function color1(color){let curve=plot.findPlotCurve(curveSelectProp.val());curve.setColorInterval(color,Static.RGB2HTML(curve.color2()))}function color2(color){let curve=plot.findPlotCurve(curveSelectProp.val());curve.setColorInterval(Static.RGB2HTML(curve.color1()),color)}function numberOfPlanes(val){let curve=plot.findPlotCurve(curveSelectProp.val());curve.setNumberOfContourPlanes(parseInt(val)),setContoursTd(curve)}function showContours(on){let curve=plot.findPlotCurve(curveSelectProp.val());curve.showContour(on),setContoursTd(curve)}function showSpectrogram(on){let curve=plot.findPlotCurve(curveSelectProp.val());curve.showSpectrogram(on),setSpectrogramTd(curve)}function alpha(val){let curve=plot.findPlotCurve(curveSelectProp.val());curve.setAlpha(val),setSpectrogramTd(curve)}function colormap(selectIndex){let curve=plot.findPlotCurve(curveSelectProp.val());0==selectIndex?curve.setSpectrogramColorMap(Enum.ColorMap.RGBMap):curve.setSpectrogramColorMap(Enum.ColorMap.IndexMap)}function interpolation(selectIndex){let curve=plot.findPlotCurve(curveSelectProp.val());var data=curve.data();data.hasOwnProperty("_interpolationType")&&(0==selectIndex?data.setInterpolaionType(Enum.InterpolationType.linear):data.setInterpolaionType(Enum.InterpolationType.cubic),curve.invalidateCache(),curve.itemChanged())}function curvePenWidth2(selectIndex){let curve;plot.findPlotCurve(curveSelectProp.val()).setPenWidth(selectIndex+1)}var curveSymbolSizeElement=this.getElementValueDataAttribute("curveSymbolSize");this.symbolIcon=function(curve){if(!curve)return null;var val=10,size=new Misc.Size(10,10),height=10,width=10,graphic=new Graphic(null,10,10),painter=new PaintUtil.Painter(graphic);if(curve.symbol()){var sh=5;curve.symbol().style(),painter.setPen(curve.symbol().pen()),curve.symbol().drawGraphicSymbol(painter,new Misc.Point(5,5),size)}return painter=null,graphic},this.spanElem2=null;var curveSymbolSpanElementParent=this.getElementValueDataAttribute("curveSymbol").parent();this.setSymbolIcon=function(){var plotItem=plot.findPlotCurve(curveSelectProp.val()),tdElem=curveSymbolSpanElementParent,icon=this.symbolIcon(plotItem);this.spanElem2&&this.spanElem2.remove(),this.spanElem2=$('<span id="spanElem2" />'),icon&&icon.setParent(this.spanElem2),this.spanElem2.appendTo(tdElem)},Static.bind("symbolAdded symbolAttributeChanged",(function(e,curve){initDlg(curve)}));var curveSymbolPenColorElement=this.getElementValueDataAttribute("curveSymbolPenColor");function curveSymbolPenColor(color){let curve=plot.findPlotCurve(curveSelectProp.val()),sym=curve.symbol();if(!sym)return;let pen=sym.pen();pen.color=color,sym.setPen(pen),initDlg(curve),curve.plot().autoRefresh(),curve.plot().updateLegend(curve)}var curveSymbolPenWidthElement=this.getElementValueDataAttribute("curveSymbolPenWidth");function curveSymbolPenWidth(selectIndex){let curve=plot.findPlotCurve(curveSelectProp.val());Utility.setSymbolPenWidth(curve,selectIndex+1),self.setSymbolIcon()}var curveSymbolBrushColorElement=this.getElementValueDataAttribute("curveSymbolBrushColor");function curveSymbolBrushColor(color){let curve=plot.findPlotCurve(curveSelectProp.val()),sym=curve.symbol();if(!sym)return;let brush=sym.brush();brush.color=color,sym.setBrush(brush),curve.plot().autoRefresh(),curve.plot().updateLegend(curve),self.setSymbolIcon()}function addSymbol(curve,style){let _style=NoSymbol;"MRect"==style&&(_style=MRect),"Cross"==style&&(_style=Cross),"Diamond"==style&&(_style=Diamond),"Ellipse"==style&&(_style=Ellipse),"XCross"==style&&(_style=XCross),Utility.addSymbol(curve,_style)}var curveSymbolSizeElement=this.getElementValueDataAttribute("curveSymbolSize"),curveSymbolStyleElement=this.getElementValueDataAttribute("curveSymbolStyle"),symbolStyles=["None","MRect","Cross","Diamond","Ellipse","XCross"],symbolStylesInt=[MRect,Cross,Diamond,Ellipse,XCross];function curveSymbolStyle(selectIndex){let curve=plot.findPlotCurve(curveSelectProp.val());"None"==symbolStyles[selectIndex]&&(curveSymbolPenWidthElement.val(1),curveSymbolPenColorElement.val(Static.colorNameToHex("black")),curveSymbolBrushColorElement.val(Static.colorNameToHex("transparent")),curveSymbolSizeElement.val(10)),addSymbol(curve,symbolStyles[selectIndex])}var symbolSizes=[5,6,8,10,12,15];function curveSymbolSize(selectIndex){let curve=plot.findPlotCurve(curveSelectProp.val());Utility.setSymbolSize(curve,symbolSizes[selectIndex]),self.setSymbolIcon()}var curveFillElement,curveFillElementParent=this.getElementValueDataAttribute("curveFill").parent();this.brushIcon=function(curve,color){if(!curve)return null;var val=12,size=new Misc.Size(12,12),height=12,width=12,graphic=new Graphic(null,12,12),painter=new PaintUtil.Painter(graphic);if("noBrush"==curve.brush().color)return null;painter.setBrush(curve.brush());var rc=new Misc.Rect(new Misc.Point,new Misc.Size(12,12));return rc.moveCenter(new Misc.Point(6,6)),painter.drawRect(rc.left(),rc.top(),rc.width(),rc.height()),painter=null,graphic},this.spanElem3=null;var curveFillBrushColorElement=this.getElementValueDataAttribute("curveFillBrushColor"),curveFillBrushColorElementParent=curveFillBrushColorElement.parent();function curveFillBrushColor(color){var curve=plot.findPlotCurve(curveSelectProp.val());if(curve.fill){let brush=curve.brush();brush.color=color,curve.setBrush(brush)}self.setBrushIcon()}this.setBrushIcon=function(){var plotItem=plot.findPlotCurve(curveSelectProp.val()),tdElem=curveFillElementParent,icon=self.brushIcon(plotItem);this.spanElem3&&this.spanElem3.remove(),this.spanElem3=$('<span id="spanElem" />'),icon&&icon.setParent(this.spanElem3),this.spanElem3.appendTo(tdElem)};var fillCurveElement=this.getElementValueDataAttribute("fillCurve");function fillCurve(checked){var curve=plot.findPlotCurve(curveSelectProp.val());if(curve.fill=checked,checked){let brush=curve.brush();brush.color=curveFillBrushColorElement.val(),curve.setBrush(brush)}else Utility.removeCurveBrush(curve);self.setBrushIcon()}Static.bind("curveBrushChanged",(function(e,curve){initDlg(curve)}));var baselineElement=this.getElementValueDataAttribute("baseline");function baseline(val){let curve;plot.findPlotCurve(curveSelectProp.val()).setBaseline(val)}var showContoursElement=self.getElementValueDataAttribute("showContours"),numberOfPlanesElement=self.getElementValueDataAttribute("numberOfPlanes"),showSpectrogramElement=self.getElementValueDataAttribute("showSpectrogram"),alphaElement=self.getElementValueDataAttribute("alpha"),penWidthElement=self.getElementValueDataAttribute("penWidth"),color1Element=self.getElementValueDataAttribute("color1"),color2Element=self.getElementValueDataAttribute("color2"),minimumZElement=self.getElementValueDataAttribute("minimumZ"),maximumZElement=self.getElementValueDataAttribute("maximumZ");function initDlg(curve){if(curve&&curve.title()===curveSelectProp.val()){if(curve.rtti===Static.Rtti_PlotSpectroCurve){self.show("penWidth"),self.show("colorInterval"),self.show("colorRange"),penWidthElement[0].selectedIndex=curve.penWidth()-1,color1Element.val(Static.RGB2HTML(curve.color1())),color2Element.val(Static.RGB2HTML(curve.color2()));var intv=curve.colorRange();minimumZElement.val(intv.minValue()),maximumZElement.val(intv.maxValue())}else self.hide("penWidth"),self.hide("colorInterval"),self.hide("colorRange");if(curve.rtti===Static.Rtti_PlotSpectrogram){curve.isVisible()?(self.show("spectrogram"),self.show("contours")):(self.hide("spectrogram"),self.hide("contours")),self.show("colormap"),curve.data().hasOwnProperty("_interpolationType")?self.show("interpolation"):self.hide("interpolation");var on=curve.testDisplayMode(Enum.DisplayMode.ImageMode);showSpectrogramElement[0].checked=curve.testDisplayMode(Enum.DisplayMode.ImageMode),alphaElement.val(curve.alpha()),showContoursElement[0].checked=curve.testDisplayMode(Enum.DisplayMode.ContourMode),numberOfPlanesElement.val(curve.contourLevels().length),setSpectrogramTd(curve),setContoursTd(curve)}else self.hide("spectrogram"),self.hide("contours"),self.hide("interpolation"),self.hide("colormap");if(curve.rtti===Static.Rtti_PlotSpectroCurve||curve.rtti===Static.Rtti_PlotSpectrogram?(self.hide("fitCurve"),self.hide("curveSymbol"),self.hide("legendAttributes"),self.hide("orientation"),self.hide("curveStyle"),self.hide("curveFill"),self.hide("baseline"),self.hide("curvePen")):(self.show("fitCurve"),self.show("curveSymbol"),self.show("legendAttributes"),self.show("orientation"),self.show("curveStyle"),self.show("curveFill"),self.show("baseline"),self.show("curvePen")),curve.rtti===Static.Rtti_PlotCurve)if(curvePenColorElement.val(Static.colorNameToHex(curve.pen().color)),curvePenStyleElement[0].selectedIndex=curvePenStyles.indexOf(curve.pen().style),curvePenWidthElement[0].selectedIndex=curve.pen().width-1,curve.symbol()){curveSymbolPenColorElement.val(Static.colorNameToHex(curve.symbol().pen().color)),curveSymbolPenWidthElement[0].selectedIndex=curve.symbol().pen().width-1,curveSymbolBrushColorElement.val(Static.colorNameToHex(curve.symbol().brush().color));var index=-1,style;index="None"==curve.symbol().style()?0:symbolStylesInt.indexOf(curve.symbol().style())+1,curveSymbolStyleElement[0].selectedIndex=index,curveSymbolSizeElement[0].selectedIndex=symbolSizes.indexOf(curve.symbol().size().height)}else curveSymbolPenColorElement.val(Static.colorNameToHex("black")),curveSymbolPenWidthElement[0].selectedIndex=0,curveSymbolBrushColorElement.val(Static.colorNameToHex("black")),curveSymbolStyleElement[0].selectedIndex=0,curveSymbolSizeElement[0].selectedIndex=3;if(curve.rtti===Static.Rtti_PlotCurve&&(curveSTyleSelector[0].selectedIndex=_.keys(styleMap)[_.values(styleMap).indexOf(curve.style())]),axisHorizontalSelectElement[0].selectedIndex=curve.xAxis()==xBottom?0:1,axisVerticalSelectElement[0].selectedIndex=curve.yAxis()==yLeft?0:1,setCurveAxesTd(curve),curve.rtti===Static.Rtti_PlotCurve){self.setPenIcon(),self.setSymbolIcon(),fillCurveElement[0].checked=curve.fill,curveFillBrushColorElement.val(curve.brush().color),self.setBrushIcon(),baselineElement.val(curve.baseline());var orientationElement=self.getElementValueDataAttribute("orientation");curve.orientation()==Vertical?orientationElement[0].selectedIndex=0:orientationElement[0].selectedIndex=1}}}Static.bind("visibilityChange",(function(e,curve,on){curve.rtti==Static.Rtti_PlotSpectrogram&&curve.title()==curveSelectProp.val()&&curve.rtti===Static.Rtti_PlotSpectrogram&&(on?(self.show("spectrogram"),self.show("contours")):(self.hide("spectrogram"),self.hide("contours")))}))}}define("curvePropertiesPane",["propertiesPane"],(function(){}));class PlotPropertiesPane extends PropertiesPane{constructor(_parent,plot){super(_parent);var self=this;self.setHeader(plot.leftSidebar.gridItem(1).headerElement,"Plot Properties",!0),this.shadeWatchArea=!0,this.addProperty({name:"General Settings",title:"General properties",id:"generalSettings"}),this.addProperty({name:"Plot Title",title:"Configure plot title",id:"plotTitle",parentId:"generalSettings"});var plotTitleTitleSelector=this.addProperty({name:"Title",id:"plotTitleTitle",parentId:"plotTitle",type:"text",title:"Set a plot title",fun:plotTitleTitle});this.addProperty({name:"Font",id:"plotTitleFont",parentId:"plotTitle",type:"select",selectorOptions:PropertiesPane.fontsDisplay(),title:"Set plot title font type",fun:plotTitleFont}),this.addProperty({name:"Point",id:"plotTitlePoint",parentId:"plotTitle",type:"number",value:"20",min:"6",max:"32",title:"Set plot title font size",fun:plotTitlePoint}),this.addProperty({name:"Color",id:"plotTitleColor",parentId:"plotTitle",type:"color",title:"Set plot title font color",title:"Set plot title font color",fun:plotTitleColor}),this.addProperty({name:"Bold",id:"plotTitleBold",parentId:"plotTitle",type:"checkbox",checked:!0,title:"Set plot title font weight",fun:plotTitleBold}),this.addProperty({name:"Plot Footer",title:"Configure plot footer",id:"plotFooter",parentId:"generalSettings"}),this.addProperty({name:"Footer",id:"plotFooterFooter",parentId:"plotFooter",type:"text",value:"Footer",title:"Set a plot footer",fun:plotFooterFooter}),this.addProperty({name:"Font",id:"plotFooterFont",parentId:"plotFooter",type:"select",selectorOptions:PropertiesPane.fontsDisplay(),title:"Set plot footer font type",fun:plotFooterFont}),this.addProperty({name:"Point",id:"plotFooterPoint",parentId:"plotFooter",type:"number",value:"20",min:"6",max:"32",title:"Set plot footer font size",fun:plotFooterPoint}),this.addProperty({name:"Color",id:"plotFooterColor",parentId:"plotFooter",type:"color",title:"Set plot footer font color",fun:plotFooterColor}),this.addProperty({name:"Bold",id:"plotFooterBold",parentId:"plotFooter",type:"checkbox",checked:!0,title:"Set plot footer font weight",fun:plotFooterBold}),this.addProperty({name:"Background",id:"plotBackground",parentId:"generalSettings",type:"color",value:"#ffffc8",title:"Set plot background color",fun:plotBackground}),this.addProperty({name:"Legend",title:"Configure legend",id:"plotLegend",parentId:"generalSettings"}),this.addProperty({name:"Background",id:"plotLegendBackground",parentId:"plotLegend",type:"color",value:"#ffffff",title:"Set legend background color",fun:plotLegendBackground}),this.addProperty({name:"Show Line",id:"plotLegendShowLine",parentId:"plotLegend",type:"checkbox",title:"If checked, curve is represented by a line on the legend",fun:plotLegendShowLine}),this.addProperty({name:"Show Symbol",id:"plotLegendShowSymbol",parentId:"plotLegend",type:"checkbox",title:"If checked, attached symbols are represented on the legend",fun:plotLegendShowSymbol}),this.addProperty({name:"Scale Settings",title:"Configure scales",id:"scaleSettings"}),this.addProperty({name:"Title",title:"Configure scale title",id:"scaleTitle",parentId:"scaleSettings"});var bottomScaleTitle=this.addProperty({name:"Bottom",id:"bottomScaleTitle",parentId:"scaleTitle",type:"text",value:"Bottom-Scale",title:"Set bottom scale title",fun:bottomScaleTitle}),topScaleTitle=this.addProperty({name:"Top",id:"topScaleTitle",parentId:"scaleTitle",type:"text",value:"Top-Scale",title:"Set top scale title",fun:topScaleTitle}),leftScaleTitle=this.addProperty({name:"Left",id:"leftScaleTitle",parentId:"scaleTitle",type:"text",value:"Left-Scale",title:"Set left scale title",fun:leftScaleTitle}),rightScaleTitle=this.addProperty({name:"Right",id:"rightScaleTitle",parentId:"scaleTitle",type:"text",value:"Right-Scale",title:"Set right scale title",fun:rightScaleTitle});this.addProperty({name:"Font",id:"scaleTitleFont",parentId:"scaleTitle",type:"select",selectorOptions:PropertiesPane.fontsDisplay(),title:"Set scale title font type",fun:scaleTitleFont}),this.addProperty({name:"Point",id:"scaleTitlePoint",parentId:"scaleTitle",type:"number",value:"20",min:"6",max:"32",title:"Set scale title font size",fun:scaleTitlePoint}),this.addProperty({name:"Color",id:"scaleTitleColor",parentId:"scaleTitle",type:"color",title:"Set scale title font color",fun:scaleTitleColor}),this.addProperty({name:"Bold",id:"scaleTitleBold",parentId:"scaleTitle",type:"checkbox",title:"Set scale title font weight",fun:scaleTitleBold}),this.addProperty({name:"Type & precision",title:"Configure scale type and precision",id:"scalePosition",parentId:"scaleSettings"}),this.addProperty({name:"Bottom",title:"Configure bottom scale type",id:"scalePositionBottom",parentId:"scalePosition"});var bottom_linear=this.addProperty({name:"Linear",title:"Linear scale",id:"scalePositionBottomLinear",parentId:"scalePositionBottom",type:"radio",checked:!0,group:"scalePositionBottomGroup"}),bottom_log=this.addProperty({name:"Log",title:"Log scale",id:"scalePositionBottomLog",parentId:"scalePositionBottom",type:"radio",group:"scalePositionBottomGroup"}),bottom_logBase=this.addProperty({name:"Base",title:"Set the base of Log scale",id:"scalePositionBottomBase",parentId:"scalePositionBottom",disabled:!0,type:"number",value:"10",min:"2",max:"10"}),bottom_precision=this.addProperty({name:"Precision",title:"Display scale labels either as exponential or fixed-point notation with the specified number of digits.",id:"scalePositionBottomBottom",parentId:"scalePositionBottom",type:"number",value:"4",min:"2",max:"10"});this.addProperty({name:"Top",title:"Configure top scale type",id:"scalePositionTop",parentId:"scalePosition"});var top_linear=this.addProperty({name:"Linear",title:"Linear scale",id:"scalePositionTopLinear",parentId:"scalePositionTop",type:"radio",checked:!0,group:"scalePositionTopGroup"}),top_log=this.addProperty({name:"Log",title:"Log scale",id:"scalePositionTopLog",parentId:"scalePositionTop",type:"radio",group:"scalePositionTopGroup"}),top_logBase=this.addProperty({name:"Base",title:"Set the base of Log scale",id:"scalePositionTopBase",parentId:"scalePositionTop",disabled:!0,type:"number",value:"10",min:"2",max:"10"}),top_precision=this.addProperty({name:"Precision",title:"Display scale labels either as exponential or fixed-point notation with the specified number of digits.",id:"scalePositionTopTop",parentId:"scalePositionTop",type:"number",value:"4",min:"2",max:"10"});this.addProperty({name:"Left",title:"Configure left scale type",id:"scalePositionLeft",parentId:"scalePosition"});var left_linear=this.addProperty({name:"Linear",title:"Linear scale",id:"scalePositionLeftLinear",parentId:"scalePositionLeft",type:"radio",checked:!0,group:"scalePositionLeftGroup"}),left_log=this.addProperty({name:"Log",title:"Log scale",id:"scalePositionLeftLog",parentId:"scalePositionLeft",type:"radio",group:"scalePositionLeftGroup"}),left_logBase=this.addProperty({name:"Base",title:"Set the base of Log scale",id:"scalePositionLeftBase",parentId:"scalePositionLeft",disabled:!0,type:"number",value:"10",min:"2",max:"10"}),left_precision=this.addProperty({name:"Precision",title:"Display scale labels either as exponential or fixed-point notation with the specified number of digits.",id:"scalePositionLeftLeft",parentId:"scalePositionLeft",type:"number",value:"4",min:"2",max:"10"});this.addProperty({name:"Right",title:"Configure right scale type",id:"scalePositionRight",parentId:"scalePosition"});var right_linear=this.addProperty({name:"Linear",title:"Linear scale",id:"scalePositionRightLinear",parentId:"scalePositionRight",type:"radio",checked:!0,group:"scalePositionRightGroup"}),right_log=this.addProperty({name:"Log",title:"Log scale",id:"scalePositionRightLog",parentId:"scalePositionRight",type:"radio",group:"scalePositionRightGroup"}),right_logBase=this.addProperty({name:"Base",title:"Set the base of Log scale",id:"scalePositionRightBase",parentId:"scalePositionRight",disabled:!0,type:"number",value:"10",min:"2",max:"10"}),right_precision=this.addProperty({name:"Precision",title:"Display scale labels either as exponential or fixed-point notation with the specified number of digits.",id:"scalePositionRightRight",parentId:"scalePositionRight",type:"number",value:"4",min:"2",max:"10"});this.addProperty({name:"Limits",title:"Configure scale limits",id:"scaleLimits",parentId:"scaleSettings"});var enableUserScale=this.addProperty({name:"Enable user scale",id:"limitsEnableUserScale",parentId:"scaleLimits",type:"checkbox"});this.addProperty({name:"Bottom",id:"limitsBottom",parentId:"scaleLimits"});var bottom_min=this.addProperty({name:"minimum",id:"limitsBottomMinimum",parentId:"limitsBottom",type:"number",value:"0",disabled:!0}),bottom_max=this.addProperty({name:"maximum",id:"limitsBottomMaximum",parentId:"limitsBottom",type:"number",value:"0",disabled:!0});this.addProperty({name:"Left",id:"limitsLeft",parentId:"scaleLimits"});var left_min=this.addProperty({name:"minimum",id:"limitsLeftMinimum",parentId:"limitsLeft",type:"number",value:"0",disabled:!0}),left_max=this.addProperty({name:"maximum",id:"limitsLeftMaximum",parentId:"limitsLeft",type:"number",value:"0",disabled:!0});this.addProperty({name:"Top",id:"limitsTop",parentId:"scaleLimits"});var top_min=this.addProperty({name:"minimum",id:"limitsTopMinimum",parentId:"limitsTop",type:"number",value:"0",disabled:!0}),top_max=this.addProperty({name:"maximum",id:"limitsTopMaximum",parentId:"limitsTop",type:"number",value:"0",disabled:!0});this.addProperty({name:"Right",id:"limitsRight",parentId:"scaleLimits"});var right_min=this.addProperty({name:"minimum",id:"limitsRightMinimum",parentId:"limitsRight",type:"number",value:"0",disabled:!0}),right_max=this.addProperty({name:"maximum",id:"limitsRightMaximum",parentId:"limitsRight",type:"number",value:"0",disabled:!0});this.addProperty({name:"Margins",title:"Set scale margins",id:"scaleMargins",parentId:"scaleSettings"});var margin_left=this.addProperty({name:"Left axis",id:"scaleMarginsLeftAxis",parentId:"scaleMargins",type:"number",min:"0",value:"0.0"}),margin_right=this.addProperty({name:"Right axis",id:"scaleMarginsRightAxis",parentId:"scaleMargins",type:"number",min:"0",value:"0.0"}),margin_bottom=this.addProperty({name:"Bottom axis",id:"scaleMarginsBottomAxis",parentId:"scaleMargins",type:"number",min:"0",value:"0.0"}),margin_top=this.addProperty({name:"Top axis",id:"scaleMarginsTopAxis",parentId:"scaleMargins",type:"number",min:"0",value:"0.0"});this.addProperty({name:"Components",title:"Configure plot components",id:"scaleComponents",parentId:"scaleSettings"});var show_backbone=this.addProperty({name:"Show backbone",id:"scaleComponentsShowBackbone",parentId:"scaleComponents",type:"checkbox",checked:!0}),show_labels=this.addProperty({name:"Show labels",id:"scaleComponentsShowLabels",parentId:"scaleComponents",type:"checkbox",checked:!0}),show_ticks=this.addProperty({name:"Show ticks",id:"scaleComponentsShowTicks",parentId:"scaleComponents",type:"checkbox",checked:!0}),tick_length=this.addProperty({name:"Tick length",id:"scaleComponentsTickLength",parentId:"scaleComponents",type:"select",selectorOptions:["Small","Medium","Large"]});this.addProperty({name:"Error Settings",title:"Configure error handling",id:"errorSettings"});var errorResponse=this.addProperty({name:"When an error occurs",id:"errorResponse",parentId:"errorSettings",type:"select",selectorOptions:["Stop and warn","Silently ignore","Allow for ignore"]}),zoomerSettings=this.addProperty({name:"Zoomer Settings",title:"Configure zoomer",id:"zoomerSettings"}),zoomerAxes=this.addProperty({name:"Zoom according to the current curve axes",id:"zoomerAxes",parentId:"zoomerSettings",type:"checkbox",checked:!0}),zoomAxisHorizontal=this.addProperty({name:"Horizontal",id:"zoomerHorizontalAxes",parentId:"zoomerSettings",type:"select",selectorOptions:["Bottom","Top"],disabled:!0}),zoomAxisVertical=this.addProperty({name:"Vertical",id:"zoomerVerticalAxes",parentId:"zoomerSettings",type:"select",selectorOptions:["Left","Right"],disabled:!0}),magnifierSettings=this.addProperty({name:"Magnifier Settings",title:"Configure magnifier",id:"magnifierSettings"}),magnifierLeftAxis=this.addProperty({name:"Left axis enabled",id:"magnifierLeftAxis",parentId:"magnifierSettings",type:"checkbox",checked:!0}),magnifierRightAxis=this.addProperty({name:"Right axis enabled",id:"magnifierRightAxis",parentId:"magnifierSettings",type:"checkbox"}),magnifierBottomAxis=this.addProperty({name:"Bottom axis enabled",id:"magnifierBottomAxis",parentId:"magnifierSettings",type:"checkbox",checked:!0}),magnifierTopAxis=this.addProperty({name:"Top axis enabled",id:"magnifierTopAxis",parentId:"magnifierSettings",type:"checkbox"}),watchSettings=this.addProperty({name:"Watch Settings",title:"Configure watch",id:"watchSettings"}),watchCalculationAccuracy=this.addProperty({name:"Calculation accuracy",id:"watchCalculationAccuracy",parentId:"watchSettings"}),watchCalculationAccuracyLow=this.addProperty({name:"Low",id:"watchCalculationAccuracyLow",parentId:"watchCalculationAccuracy",type:"radio",group:"watchCalculationAccuracyGroup"}),watchCalculationAccuracyModerate=this.addProperty({name:"Moderate",id:"watchCalculationAccuracyModerate",parentId:"watchCalculationAccuracy",type:"radio",group:"watchCalculationAccuracyGroup",checked:!0}),watchCalculationAccuracyHigh=this.addProperty({name:"High",id:"watchCalculationAccuracyHigh",parentId:"watchCalculationAccuracy",type:"radio",group:"watchCalculationAccuracyGroup"}),decimalPlacesForCalculation=this.addProperty({name:"Decimal places in calculation",title:"Set the maximum decimal places used in calculations for an axis",id:"decimalPlacesForCalculationy",parentId:"watchCalculationAccuracy"}),bottom_decimalPlaces=this.addProperty({name:"Bottom axis",title:"Set the maximum decimal places used in calculations",id:"scalePositionBottomBottom",parentId:"decimalPlacesForCalculationy",type:"number",value:"2",min:"0"}),left_decimalPlaces=this.addProperty({name:"Left axis",title:"Set the maximum decimal places used in calculations",id:"scalePositionBottomBottom",parentId:"decimalPlacesForCalculationy",type:"number",value:"2",min:"0"}),top_decimalPlaces=this.addProperty({name:"Top axis",title:"Set the maximum decimal places used in calculations",id:"scalePositionBottomBottom",parentId:"decimalPlacesForCalculationy",type:"number",value:"2",min:"0"}),right_decimalPlaces=this.addProperty({name:"Right axis",title:"Set the maximum decimal places used in calculations",id:"scalePositionBottomBottom",parentId:"decimalPlacesForCalculationy",type:"number",value:"2",min:"0"}),watchShading=this.addProperty({name:"Shading",id:"watchShading",parentId:"watchSettings"}),watchShadeWatchArea=this.addProperty({name:"Shade watch area",id:"watchShadeWatchArea",parentId:"watchShading",type:"checkbox",checked:!0}),watchShadeAutoScale=this.addProperty({name:"Scale shaded area",id:"watchShadeAutoScale",parentId:"watchShading",type:"checkbox",checked:!0}),watchShadeColor=this.addProperty({name:"Shade color",id:"watchShadeColor",parentId:"watchShading",value:"#006464",type:"color"}),watchCentroidWithArea=this.addProperty({name:"Watch centroid with area",id:"watchCentroidWithArea",parentId:"watchSettings",type:"checkbox",checked:!0});this.addProperty({name:"Grid Settings",title:"Configure grid",id:"gridSettings"}),this.addProperty({name:"Minor Lines",id:"gridMinorLines",parentId:"gridSettings"});var minor_gridLines=this.addProperty({name:"Show",id:"gridMinorLinesShow",parentId:"gridMinorLines",type:"checkbox",checked:!0}),minor_divisions=this.addProperty({name:"Minors per major",id:"gridMinorsPerMajor",parentId:"gridMinorLines",type:"number",value:"5",min:"2",max:"20"}),minor_line_color=this.addProperty({name:"Color",id:"gridMinorLinesColor",parentId:"gridMinorLines",type:"color"});this.addProperty({name:"Major Lines",id:"gridMajorLines",parentId:"gridSettings"});var major_gridLines=this.addProperty({name:"Show",id:"gridMajorLinesShow",parentId:"gridMajorLines",type:"checkbox",checked:!0}),major_divisions=this.addProperty({name:"Majors",id:"gridMajorMajors",parentId:"gridMajorLines",type:"number",value:"8",min:"1",max:"40"}),major_line_color=this.addProperty({name:"Color",id:"gridMajorLinesColor",parentId:"gridMajorLines",type:"color"}),gridSettings=this.addProperty({name:"Grid Axes",id:"gridAxes",parentId:"gridSettings"}),gridAxes=this.addProperty({name:"According to current curve",id:"gridAxesAccordingToCurve",parentId:"gridAxes",type:"checkbox",checked:!0}),gridAxisHorizontal=this.addProperty({name:"Horizontal",id:"gridHorizontalAxes",parentId:"gridAxes",type:"select",selectorOptions:["Bottom","Top"],disabled:!0}),gridAxisVertical=this.addProperty({name:"Vertical",id:"gridVerticalAxes",parentId:"gridAxes",type:"select",selectorOptions:["Left","Right"],disabled:!0}),point_selection=this.addProperty({name:"When a point is selected",title:"Set what happens to selected point",id:"pointSelected",type:"select",selectorOptions:["Display data","remove it","Modify it"]}),addRemovePoint=this.addProperty({name:"Add/Remove Point",title:"If checked, point addition/removal with Shift-Left click is enabled.",id:"addRemovePoint",type:"checkbox"});function plotTitleTitle(title){plot.setTitle(title)}function plotTitleFont(index){var font=plot.titleFont();font.name=PropertiesPane.fontGroup(index),plot.setTitleFont(font)}function plotTitlePoint(val){var font=plot.titleFont();font.th=val,plot.setTitleFont(font)}function plotTitleColor(color){var font=plot.titleFont();font.fontColor=color,plot.setTitleFont(font)}function plotTitleBold(checked){var font=plot.titleFont();font.weight=checked?"bold":"normal",plot.setTitleFont(font)}function plotFooterFooter(footer){plot.setFooter(footer)}function plotFooterFont(index){var font=plot.footerFont();font.name=PropertiesPane.fontGroup(index),plot.setFooterFont(font)}function plotFooterPoint(val){var font=plot.footerFont();font.th=val,plot.setFooterFont(font)}function plotFooterColor(color){var font=plot.footerFont();font.fontColor=color,plot.setFooterFont(font)}function plotFooterBold(checked){var font=plot.footerFont();font.weight=checked?"bold":"normal",plot.setFooterFont(font)}function plotBackground(color){plot.setPlotBackground(color)}function plotLegendBackground(color){var table=plot.getLayout().getLegendDiv().children()[0];$(table).css("background-color",color)}function plotLegendShowLine(checked){Static.showline=checked}function plotLegendShowSymbol(checked){Static.showsymbol=checked}function setAxisTitleFont(){var axisLabelFont=plot.axisLabelFont(xBottom),axisTitleFont=plot.axisTitleFont(xBottom);axisLabelFont.th=.86*axisTitleFont.th,setAxisLabelFont(),plot.setAxisTitleFont(xBottom,axisTitleFont),plot.setAxisTitleFont(xTop,axisTitleFont),plot.setAxisTitleFont(yLeft,axisTitleFont),plot.setAxisTitleFont(yRight,axisTitleFont)}function setAxisLabelFont(){plot.setAxisLabelFont(xBottom,axisLabelFont),plot.setAxisLabelFont(xTop,axisLabelFont),plot.setAxisLabelFont(yLeft,axisLabelFont),plot.setAxisLabelFont(yRight,axisLabelFont)}function bottomScaleTitle(title){plot.setAxisTitle(xBottom,title)}function topScaleTitle(title){plot.setAxisTitle(xTop,title)}function leftScaleTitle(title){plot.setAxisTitle(yLeft,title)}function rightScaleTitle(title){plot.setAxisTitle(yRight,title)}function scaleTitleFont(index){var font=plot.axisTitleFont(xBottom);font.name=PropertiesPane.fontGroup(index),plot.setAxisTitleFont(xBottom,font),plot.setAxisTitleFont(xTop,font),plot.setAxisTitleFont(yLeft,font),plot.setAxisTitleFont(yRight,font)}function scaleTitlePoint(val){var font=plot.axisTitleFont(xBottom);font.th=.86*val,plot.setAxisTitleFont(xBottom,font),plot.setAxisTitleFont(xTop,font),plot.setAxisTitleFont(yLeft,font),plot.setAxisTitleFont(yRight,font)}function scaleTitleColor(color){var font=plot.axisTitleFont(xBottom);font.fontColor=color,plot.setAxisTitleFont(xBottom,font),plot.setAxisTitleFont(xTop,font),plot.setAxisTitleFont(yLeft,font),plot.setAxisTitleFont(yRight,font)}function scaleTitleBold(checked){var font=plot.axisTitleFont(xBottom);font.weight=checked?"bold":"normal",plot.setAxisTitleFont(xBottom,font),plot.setAxisTitleFont(xTop,font),plot.setAxisTitleFont(yLeft,font),plot.setAxisTitleFont(yRight,font)}function setReadonly(on){bottom_min.attr("disabled",on),bottom_max.attr("disabled",on),left_min.attr("disabled",on),left_max.attr("disabled",on),top_min.attr("disabled",on),top_max.attr("disabled",on),right_min.attr("disabled",on),right_max.attr("disabled",on)}this.init(),bottom_log.change((function(){bottom_logBase.attr("disabled",!1),Static.trigger("invalidateWatch"),plot.setAxisScaleEngine(xBottom,new LogScaleEngine)})),bottom_logBase.change((function(){Static.trigger("invalidateWatch"),plot.axisScaleEngine(yLeft).setBase($(this).val()),plot.autoRefresh()})),bottom_linear.change((function(){bottom_logBase.attr("disabled",!0),Static.trigger("invalidateWatch"),plot.setAxisScaleEngine(xBottom,new LinearScaleEngine)})),left_log.change((function(){left_logBase.attr("disabled",!1),Static.trigger("invalidateWatch"),plot.setAxisScaleEngine(yLeft,new LogScaleEngine)})),$("#left_logBase").change((function(){Static.trigger("invalidateWatch"),m_plot.axisScaleEngine(yLeft).setBase($(this).val()),m_plot.autoRefresh()})),left_linear.change((function(){left_logBase.attr("disabled",!0),Static.trigger("invalidateWatch"),plot.setAxisScaleEngine(yLeft,new LinearScaleEngine)})),top_log.change((function(){top_logBase.attr("disabled",!1),Static.trigger("invalidateWatch"),plot.setAxisScaleEngine(xTop,new LogScaleEngine)})),top_logBase.change((function(){Static.trigger("invalidateWatch"),plot.axisScaleEngine(yLeft).setBase($(this).val()),plot.autoRefresh()})),top_linear.change((function(){$("#top_logBase").attr("disabled",!0),Static.trigger("invalidateWatch"),plot.setAxisScaleEngine(xTop,new LinearScaleEngine)})),right_log.change((function(){right_logBase.attr("disabled",!1),Static.trigger("invalidateWatch"),plot.setAxisScaleEngine(yRight,new LogScaleEngine)})),right_logBase.change((function(){Static.trigger("invalidateWatch"),plot.axisScaleEngine(yLeft).setBase($(this).val()),plot.autoRefresh()})),right_linear.change((function(){$("#right_logBase").attr("disabled",!0),Static.trigger("invalidateWatch"),plot.setAxisScaleEngine(yRight,new LinearScaleEngine)})),bottom_precision.change((function(){plot.setAxisPrecision(xBottom,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")})),top_precision.change((function(){plot.setAxisPrecision(xTop,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")})),left_precision.change((function(){plot.setAxisPrecision(yLeft,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")})),right_precision.change((function(){plot.setAxisPrecision(yRight,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")})),bottom_decimalPlaces.val(plot.axisDecimalPlaces(xBottom)),bottom_decimalPlaces.change((function(){plot.setAxisDecimalPlaces(xBottom,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")})),top_decimalPlaces.val(plot.axisDecimalPlaces(xTop)),top_decimalPlaces.change((function(){plot.setAxisDecimalPlaces(xTop,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")})),left_decimalPlaces.val(plot.axisDecimalPlaces(yLeft)),left_decimalPlaces.change((function(){plot.setAxisDecimalPlaces(yLeft,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")})),right_decimalPlaces.val(plot.axisDecimalPlaces(yRight)),right_decimalPlaces.change((function(){plot.setAxisDecimalPlaces(yRight,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")})),enableUserScale.change((function(){setReadonly(!this.checked),left_min.val()!==left_max.val()&&plot.setAxisScale(yLeft,parseFloat(left_min.val()),parseFloat(left_max.val())),bottom_min.val()!==bottom_max.val()&&plot.setAxisScale(xBottom,parseFloat(bottom_min.val()),parseFloat(bottom_max.val())),right_min.val()!==right_max.val()&&plot.setAxisScale(yRight,parseFloat(right_min.val()),parseFloat(right_max.val())),top_min.val()!==top_max.val()&&plot.setAxisScale(xTop,parseFloat(top_min.val()),parseFloat(top_max.val()))})),Static.bind("autoScaleChanged",(function(e,on){setReadonly(on),enableUserScale.prop("checked",!on)}));var curve=null;function initLimitsInput(){var intv=plot.axisInterval(xBottom);bottom_min.val(intv.minValue()),bottom_max.val(intv.maxValue()),intv=plot.axisInterval(yLeft),left_min.val(intv.minValue()),left_max.val(intv.maxValue()),intv=plot.axisInterval(xTop),top_min.val(intv.minValue()),top_max.val(intv.maxValue()),intv=plot.axisInterval(yRight),right_min.val(intv.minValue()),right_max.val(intv.maxValue())}function zoomerAxisControlsDisabled(on){zoomAxisHorizontal.attr("disabled",on),zoomAxisVertical.attr("disabled",on)}function setZoomerAxesInfo(){var horizontal="",vertical="",zoomer=plot.zm;zoomerAxes[0].checked&&curve?(curve.yAxis()==yRight?(vertical="Right",zoomAxisVertical[0].selectedIndex=1):(vertical="Left",zoomAxisVertical[0].selectedIndex=0),curve.xAxis()==xTop?(horizontal="Top",zoomAxisHorizontal[0].selectedIndex=1):(horizontal="Bottom",zoomAxisHorizontal[0].selectedIndex=0)):(horizontal=1==zoomAxisHorizontal[0].selectedIndex?"Top":"Bottom",vertical=1==zoomAxisVertical[0].selectedIndex?"Right":"Left"),zoomerSettings.html(horizontal+", "+vertical)}function setMagnifierAxesInfo(){var info="",left="",right="",bottom="",top="",magnifier=plot.magnifier;magnifier.isAxisEnabled(yLeft)&&(left="Left"),magnifier.isAxisEnabled(yRight)&&(right="Right"),magnifier.isAxisEnabled(xBottom)&&(bottom="Bottom"),magnifier.isAxisEnabled(xTop)&&(top="Top");var previousInfoLength=0;(info+=left).length>previousInfoLength&&(right.length||bottom.length||top.length)&&(info+=", "),previousInfoLength=info.length,(info+=right).length>previousInfoLength&&(bottom.length||top.length)&&(info+=", "),previousInfoLength=info.length,(info+=bottom).length>previousInfoLength&&top.length&&(info+=", "),""==(info+=top)&&(info="No axis enabled"),magnifierSettings.html(info)}function watchShadeIcon(color){var val=12,size=new Misc.Size(12,12),height=12,width=12,graphic=new Graphic(null,12,12),painter=new PaintUtil.Painter(graphic);painter.setBrush(new Misc.Brush(color));var rc=new Misc.Rect(new Misc.Point,new Misc.Size(12,12));return rc.moveCenter(new Misc.Point(6,6)),painter.drawRect(rc.left(),rc.top(),rc.width(),rc.height()),painter=null,graphic}function setBrushIcon(color){var icon=watchShadeIcon(color);watchShading[0].children&&$(watchShading[0].children[0]).remove(),icon&&watchShadeWatchArea[0].checked&&icon.setParent(watchShading)}function setWatchInfo(){var info="",accuracy="",shade="No shade";Static.accuracyMaxSteps==.5*Static.accuracyBase*.5&&(accuracy="Low"),Static.accuracyMaxSteps==.5*Static.accuracyBase&&(accuracy="Moderate"),Static.accuracyMaxSteps==Static.accuracyBase&&(accuracy="High"),watchShadeWatchArea[0].checked&&(shade="Shade "),watchCalculationAccuracy.html(accuracy),watchSettings.html(accuracy+"; "+shade),watchShadeWatchArea[0].checked&&watchShadeIcon(watchShadeColor.val()).setParent(watchSettings)}function gridAxisControlsDisabled(on){gridAxisHorizontal.attr("disabled",on),gridAxisVertical.attr("disabled",on)}function setGridAxesInfo(){var horizontal="",vertical="",grid=plot.itemList(Static.Rtti_PlotGrid)[0];gridAxes[0].checked&&curve?(curve.yAxis()==yRight?(vertical="Right",gridAxisVertical[0].selectedIndex=1):(vertical="Left",gridAxisVertical[0].selectedIndex=0),curve.xAxis()==xTop?(horizontal="Top",gridAxisHorizontal[0].selectedIndex=1):(horizontal="Bottom",gridAxisHorizontal[0].selectedIndex=0)):(horizontal=1==gridAxisHorizontal[0].selectedIndex?"Top":"Bottom",vertical=1==gridAxisVertical[0].selectedIndex?"Right":"Left"),gridSettings.html(horizontal+", "+vertical)}function initControls(){zoomerAxisControlsDisabled(!0),setZoomerAxesInfo(),setGridAxesInfo(),setMagnifierAxesInfo(),setWatchInfo(),setBrushIcon(watchShadeColor.val()),plotTitleTitleSelector.val(plot.title()),initLimitsInput();var grid=plot.itemList(Static.Rtti_PlotGrid)[0];minor_gridLines[0].checked=grid.xMinEnabled(),major_gridLines[0].checked=grid.xEnabled(),bottomScaleTitle.val(plot.axisTitle(xBottom)),topScaleTitle.val(plot.axisTitle(xTop)),leftScaleTitle.val(plot.axisTitle(yLeft)),rightScaleTitle.val(plot.axisTitle(yRight)),minor_line_color.val(Static.colorNameToHex(grid.minorPen())),major_line_color.val(Static.colorNameToHex(grid.majorPen())),self.hide("pointSelected")}Static.bind("itemAttached",(function(e,plotItem,on){plotItem.rtti==Static.Rtti_PlotCurve&&initLimitsInput()})),bottom_min.change((function(){bottom_min.val()!==bottom_max.val()&&plot.setAxisScale(xBottom,parseFloat(bottom_min.val()),parseFloat(bottom_max.val()))})),bottom_max.change((function(){bottom_min.val()!==bottom_max.val()&&plot.setAxisScale(xBottom,parseFloat(bottom_min.val()),parseFloat(bottom_max.val()))})),top_min.change((function(){top_min.val()!==top_max.val()&&plot.setAxisScale(xTop,parseFloat(top_min.val()),parseFloat(top_max.val()))})),top_max.change((function(){top_min.val()!==top_max.val()&&plot.setAxisScale(xTop,parseFloat(top_min.val()),parseFloat(top_max.val()))})),left_min.change((function(){left_min.val()!==left_max.val()&&plot.setAxisScale(yLeft,parseFloat(left_min.val()),parseFloat(left_max.val()))})),left_max.change((function(){left_min.val()!==left_max.val()&&plot.setAxisScale(yLeft,parseFloat(left_min.val()),parseFloat(left_max.val()))})),right_min.change((function(){right_min.val()!==right_max.val()&&plot.setAxisScale(yRight,parseFloat(right_min.val()),parseFloat(right_max.val()))})),right_max.change((function(){right_min.val()!==right_max.val()&&plot.setAxisScale(yRight,parseFloat(right_min.val()),parseFloat(right_max.val()))})),margin_left.change((function(){var margin=0,scaleEngine=plot.axisScaleEngine(yLeft);if(scaleEngine instanceof LogScaleEngine){var scaleDiv=plot.axisScaleDiv(yLeft);margin=Static.mLog(scaleEngine.base(),$(this).val())}else{var intvY=plot.axisInterval(yLeft);margin=$(this).val()}plot.axisScaleEngine(yLeft).setMargins(margin,margin),plot.autoRefresh()})),margin_right.change((function(){var margin=0,scaleEngine=plot.axisScaleEngine(yRight);if(scaleEngine instanceof LogScaleEngine){var scaleDiv=plot.axisScaleDiv(yRight);margin=Static.mLog(scaleEngine.base(),$(this).val())}else{var intvY=plot.axisInterval(yRight);margin=$(this).val()}plot.axisScaleEngine(yRight).setMargins(margin,margin),plot.autoRefresh()})),margin_bottom.change((function(){var margin=0,scaleEngine=plot.axisScaleEngine(xBottom);if(scaleEngine instanceof LogScaleEngine){var scaleDiv=plot.axisScaleDiv(xBottom);margin=Static.mLog(scaleEngine.base(),$(this).val())}else{var intvY=plot.axisInterval(xBottom);margin=$(this).val()}plot.axisScaleEngine(xBottom).setMargins(margin,margin),plot.autoRefresh()})),margin_top.change((function(){var margin=0,scaleEngine=plot.axisScaleEngine(xTop);if(scaleEngine instanceof LogScaleEngine){var scaleDiv=plot.axisScaleDiv(xTop);margin=Static.mLog(scaleEngine.base(),$(this).val())}else{var intvY=plot.axisInterval(xTop);margin=$(this).val()}plot.axisScaleEngine(xTop).setMargins(margin,margin),plot.autoRefresh()})),show_backbone.change((function(){Utility.enableComponent(plot,Enum.ScaleComponent.Backbone,this.checked)})),show_ticks.change((function(){Utility.enableComponent(plot,Enum.ScaleComponent.Ticks,this.checked),tickLengthRow.toggle(this.checked)})),tick_length.change((function(){var map=["small","medium","large"];Utility.setTickLength(plot,map[$(this)[0].selectedIndex])})),show_labels.change((function(){Utility.enableComponent(plot,Enum.ScaleComponent.Labels,this.checked)})),point_selection.change((function(){var index=$(this)[0].selectedIndex;1==index?plot.curveClosestPoint.setCb((function(curve,point){curve.removePoint(point)})):2==index?plot.curveClosestPoint.setCb((function(curve,point){plot.pointEntryDlg.pointEntryCb("Modify/Remove Point",plot,curve.title(),point)})):plot.curveClosestPoint.setCb(null)})),addRemovePoint.change((function(){plot.addRemovePoint.activate(this.checked),this.checked?plot.zm.setTrackerMode(Static.AlwaysOff):plot.zm.setTrackerMode(Static.ActiveOnly)})),errorResponse.change((function(){var index=$(this)[0].selectedIndex;1==index?(console.log("Static.silentIgnore"),Static.errorResponse=Static.silentIgnore):2==index?(console.log("Static.warnIgnore"),Static.errorResponse=Static.warnIgnore):(console.log("Static.warn"),Static.errorResponse=Static.warn)})),Static.bind("currentCurveChanged",(function(e,_curve){if(curve=_curve){var zoomer=plot.zm;if(zoomerAxes[0].checked)zoomer.setAxis(curve.xAxis(),curve.yAxis());else{var h=xBottom;1==zoomAxisHorizontal[0].selectedIndex&&(h=xTop);var v=yLeft;1==zoomAxisVertical[0].selectedIndex&&(v=yRight),zoomer.setAxis(h,v)}}setZoomerAxesInfo()})),Static.bind("curveAxisChangedViaPropertiesPane axisChanged",(function(e,axis,curve){var zoomer=plot.zm;zoomerAxes[0].checked?zoomer.setAxis(curve.xAxis(),curve.yAxis()):(0==zoomAxisHorizontal[0].selectedIndex?zoomer.setAxis(xBottom,zoomer.yAxis()):zoomer.setAxis(xTop,zoomer.yAxis()),0==zoomAxisVertical[0].selectedIndex?zoomer.setAxis(zoomer.xAxis(),yLeft):zoomer.setAxis(zoomer.xAxis(),yRight)),setZoomerAxesInfo()})),zoomAxisVertical.change((function(){var zoomer=plot.zm;0==$(this)[0].selectedIndex?zoomer.setAxis(zoomer.xAxis(),yLeft):zoomer.setAxis(zoomer.xAxis(),yRight),setZoomerAxesInfo()})),zoomAxisHorizontal.change((function(){var zoomer=plot.zm;0==$(this)[0].selectedIndex?zoomer.setAxis(xBottom,zoomer.yAxis()):zoomer.setAxis(xTop,zoomer.yAxis()),setZoomerAxesInfo()})),zoomerAxes.click((function(){if($(this)[0].checked)zoomerAxisControlsDisabled(!0);else{zoomerAxisControlsDisabled(!1);var zoomer=plot.zm;0==zoomAxisHorizontal[0].selectedIndex?zoomer.setAxis(xBottom,zoomer.yAxis()):zoomer.setAxis(xTop,zoomer.yAxis()),0==zoomAxisVertical[0].selectedIndex?zoomer.setAxis(zoomer.xAxis(),yLeft):zoomer.setAxis(zoomer.xAxis(),yRight)}setZoomerAxesInfo(),Static.trigger("zoomAccordingToCurve",$(this)[0].checked)})),magnifierLeftAxis.change((function(){plot.magnifier.setAxisEnabled(yLeft,this.checked),setMagnifierAxesInfo()})),magnifierRightAxis.change((function(){plot.magnifier.setAxisEnabled(yRight,this.checked),setMagnifierAxesInfo()})),magnifierBottomAxis.change((function(){plot.magnifier.setAxisEnabled(xBottom,this.checked),setMagnifierAxesInfo()})),magnifierTopAxis.change((function(){plot.magnifier.setAxisEnabled(xTop,this.checked),setMagnifierAxesInfo()})),watchCalculationAccuracyLow.change((function(){Static.accuracyFactor=1.5*Static.accuracyFactorModerate,setWatchInfo(),Static.trigger("invalidateWatch"),Static.trigger("calculationAccuracy")})),watchCalculationAccuracyModerate.change((function(){Static.accuracyFactor=Static.accuracyFactorModerate,setWatchInfo(),Static.trigger("invalidateWatch"),Static.trigger("calculationAccuracy")})),watchCalculationAccuracyHigh.change((function(){Static.accuracyFactor=.5*Static.accuracyFactorModerate,setWatchInfo(),Static.trigger("invalidateWatch"),Static.trigger("calculationAccuracy")})),watchShadeWatchArea.change((function(){self.shadeWatchArea=watchShadeWatchArea[0].checked,self.shadeWatchArea?watchShadeColor.attr("disabled",!1):watchShadeColor.attr("disabled",!0),setWatchInfo(),setBrushIcon(watchShadeColor.val()),Static.trigger("shadeWatchArea",self.shadeWatchArea)})),watchShadeColor.change((function(){setBrushIcon($(this).val()),setWatchInfo(),Static.trigger("curveShapeColorChanged",$(this).val())})),watchShadeAutoScale.change((function(){Static.trigger("autoScaleCurveShapeItem",$(this)[0].checked)})),watchCentroidWithArea.change((function(){Static.trigger("watchCentroidWithArea",$(this)[0].checked)})),minor_divisions.change((function(){var value=Math.min(Math.max(2,$(this).val()),20);minor_divisions.val(value),plot.setAxisMaxMinor(yLeft,value),plot.setAxisMaxMinor(yRight,value),plot.setAxisMaxMinor(xTop,value),plot.setAxisMaxMinor(xBottom,value)})),major_divisions.change((function(){var value=Math.min(Math.max(1,$(this).val()),40);major_divisions.val(value),plot.setAxisMaxMajor(yLeft,$(this).val()),plot.setAxisMaxMajor(yRight,$(this).val()),plot.setAxisMaxMajor(xTop,$(this).val()),plot.setAxisMaxMajor(xBottom,$(this).val())})),minor_line_color.change((function(){var grid;plot.itemList(Static.Rtti_PlotGrid)[0].setMinorPen(minor_line_color[0].value)})),major_line_color.change((function(){var grid;plot.itemList(Static.Rtti_PlotGrid)[0].setMajorPen(major_line_color[0].value)})),major_gridLines.change((function(){var grid=plot.itemList(Static.Rtti_PlotGrid)[0];Utility.majorGridLines(grid,$(this)[0].checked),minor_gridLines.attr("disabled",!$(this)[0].checked)})),Static.bind("majorGridLines",(function(e,grid,on){major_gridLines[0].checked=on,minor_gridLines.attr("disabled",!on)})),minor_gridLines.change((function(){var grid=plot.itemList(Static.Rtti_PlotGrid)[0];Utility.minorGridLines(grid,$(this)[0].checked)})),Static.bind("minorGridLines",(function(e,grid,on){minor_gridLines[0].checked=on})),Static.bind("currentCurveChanged",(function(e,_curve){if(curve=_curve){var grid=plot.itemList(Static.Rtti_PlotGrid)[0];if(gridAxes[0].checked)grid.setAxes(curve.xAxis(),curve.yAxis());else{var h=xBottom;1==gridAxisHorizontal[0].selectedIndex&&(h=xTop);var v=yLeft;1==gridAxisVertical[0].selectedIndex&&(v=yRight),grid.setAxes(h,v)}}setGridAxesInfo()})),Static.bind("curveAxisChangedViaPropertiesPane axisChanged",(function(e,axis,curve){var grid=plot.itemList(Static.Rtti_PlotGrid)[0];gridAxes[0].checked?grid.setAxes(curve.xAxis(),curve.yAxis()):(0==gridAxisHorizontal[0].selectedIndex?grid.setAxes(xBottom,grid.yAxis()):grid.setAxes(xTop,grid.yAxis()),0==zoomAxisVertical[0].selectedIndex?grid.setAxes(grid.xAxis(),yLeft):grid.setAxes(grid.xAxis(),yRight)),setGridAxesInfo()})),Static.bind("pSel",(function(e,on){on?self.show("pointSelected"):self.hide("pointSelected")})),gridAxisVertical.change((function(){var grid=plot.itemList(Static.Rtti_PlotGrid)[0];0==$(this)[0].selectedIndex?grid.setAxes(grid.xAxis(),yLeft):grid.setAxes(grid.xAxis(),yRight),setGridAxesInfo()})),gridAxisHorizontal.change((function(){var grid=plot.itemList(Static.Rtti_PlotGrid)[0];0==$(this)[0].selectedIndex?grid.setAxes(xBottom,grid.yAxis()):grid.setAxes(xTop,grid.yAxis()),setGridAxesInfo()})),gridAxes.click((function(){if($(this)[0].checked)gridAxisControlsDisabled(!0);else{gridAxisControlsDisabled(!1);var grid=plot.itemList(Static.Rtti_PlotGrid)[0];0==gridAxisHorizontal[0].selectedIndex?grid.setAxes(xBottom,grid.yAxis()):grid.setAxes(xTop,grid.yAxis()),0==gridAxisVertical[0].selectedIndex?grid.setAxes(grid.xAxis(),yLeft):grid.setAxes(grid.xAxis(),yRight)}setGridAxesInfo(),Static.trigger("gridlinesAccordingToCurve",$(this)[0].checked)})),initControls()}}define("plotPropertiesPane",["propertiesPane"],(function(){}));class MyOverlay extends WidgetOverlay{constructor(widget,eventObject){super(widget);var self=this;this.eventObject=eventObject,this.curve=null,this.toString=function(){return"[MyOverlay]"}}drawOverlay(painter){let xMap=this.curve.plot().canvasMap(this.curve.xAxis()),yMap=this.curve.plot().canvasMap(this.curve.yAxis()),cx=xMap.transform(this.eventObject.p.x),cy=yMap.transform(this.eventObject.p.y);painter.setBrush(new Misc.Brush("lightGrey")),painter.drawCircle(cx,cy,8)}}class MyObject extends HObject{constructor(plot,cb){super();var self=this;function setAlignment(pt){var curve=self.selectorWidgetOverlay.curve,xs=plot.axisScaleDiv(curve.xAxis()),ys=plot.axisScaleDiv(curve.yAxis()),rect=new Misc.Rect(xs.lowerBound(),ys.lowerBound(),xs.range(),ys.range());rect=rect.normalized();var alignment=0;alignment|=pt.x<rect.left()+.3*rect.width()?Static.AlignRight:Static.AlignLeft,alignment|=pt.y-.3*rect.height()>rect.top()?Static.AlignBottom:Static.AlignTop,self.mPos.setLabelAlignment(alignment)}this._plot=plot,this._dmin=10,this._cb,this.selected=!1,this.button=Static.LeftButton,this.modifiers=Static.NoModifier,void 0!==cb&&(this._cb=cb),this.selectorWidgetOverlay=new MyOverlay(plot.getCentralWidget(),this),Static.bind("visibilityChange",(function(e,curve,on){self.selectorWidgetOverlay.curve===curve&&(on||(self.selectorWidgetOverlay.clearCanvas(),this.selected=!1))})),this.toString=function(){return"[MyObject]"},this.mouseDown=function(event){return event.button==this.button&&Utility.modifiers(event)==this.modifiers&&this.selected&&(null==this._cb?alert("Curve: "+this.selectorWidgetOverlay.curve.title()+"; point: ("+this.p.x+", "+this.p.y+")"):this._cb(this.selectorWidgetOverlay.curve,this.p)),!0},this.showMarker=function(point){var doReplot=plot.autoReplot();plot.setAutoReplot(!1);var curve=this.selectorWidgetOverlay.curve;self.mPos.setAxes(curve.xAxis(),curve.yAxis()),setAlignment(point),self.mPos.setVisible(!0),self.mPos.setValue(point);var xVal=Static.toPrecision(point.x,plot.axisPrecision(curve.xAxis())),yVal=Static.toPrecision(point.y,plot.axisPrecision(curve.yAxis()));self.mPos.setLabel("("+xVal.toString()+", "+yVal.toString()+")"),plot.setAutoReplot(doReplot),plot.autoRefresh()},this.hideMarker=function(){self.mPos.setVisible(!1)}}eventFilter(watched,event){if(!Static.isMobile()){if("mousedown"==event.type)this.mouseDown(event);else if("mouseleave"==event.type)this.selected&&(this.selectorWidgetOverlay.clearCanvas(),this.selected=!1);else if("mousemove"==event.type){event.preventDefault();let curves=this._plot.itemList(Static.Rtti_PlotCurve);if(!curves.length)return;var pt=watched.mapToElement({x:event.clientX,y:event.clientY});let dist={distance:-1},curvePointIndex=-1,curvePointIndexAtDmin=-1,dmin=1e10,indexInCurvesListAtDmin=-1;for(var i=0;i<curves.length;++i)(curves[i].isVisible()||"[SyntheticPointData]"!=curves[i].data().toString())&&(curvePointIndex=curves[i].closestPoint(pt,dist),dist.distance<dmin&&(dmin=dist.distance,indexInCurvesListAtDmin=i,curvePointIndexAtDmin=curvePointIndex));if(-1==curvePointIndexAtDmin)return;if("[SyntheticPointData]"==curves[indexInCurvesListAtDmin].data().toString())return;this.p=curves[indexInCurvesListAtDmin].data().samples()[curvePointIndexAtDmin],this.selected||this.selectorWidgetOverlay.clearCanvas(),dmin<this._dmin?(this.selectorWidgetOverlay.curve=curves[indexInCurvesListAtDmin],this.selected||(this.selectorWidgetOverlay.draw(),this.selected=!0,this.showMarker(this.p),Static.trigger("pointSelected"))):(this.selected=!1,this.hideMarker(),Static.trigger("pointNotSelected"))}return!0}if("touchstart"==event.type){let curves=this._plot.itemList(Static.Rtti_PlotCurve);if(!curves.length)return;var pt=watched.mapToElement({x:event.originalEvent.touches[0].clientX,y:event.originalEvent.touches[0].clientY});let dist={distance:-1},curvePointIndex=-1,curvePointIndexAtDmin=-1,dmin=1e10,indexInCurvesListAtDmin=-1;for(var i=0;i<curves.length;++i)(curves[i].isVisible()||"[SyntheticPointData]"!=curves[i].data().toString())&&(curvePointIndex=curves[i].closestPoint(pt,dist),dist.distance<dmin&&(dmin=dist.distance,indexInCurvesListAtDmin=i,curvePointIndexAtDmin=curvePointIndex));if(-1==curvePointIndexAtDmin)return;this.p=curves[indexInCurvesListAtDmin].data().samples()[curvePointIndexAtDmin],dmin<this._dmin&&(null==this._cb?alert("Curve: "+curves[indexInCurvesListAtDmin].title()+"; point: ("+this.p.x+", "+this.p.y+")"):this._cb(curves[indexInCurvesListAtDmin],this.p))}}}class CurveClosestPoint{constructor(plot,cb){this.eventHandlingObject=new MyObject(plot,cb),void 0!==cb&&(this.eventHandlingObject.cb=cb),this.cw=plot.getCentralWidget(),this.cw.setEnabled_1(!0),this.eventHandlingObject.mPos=new PlotMarker("ClosestPointMarker123@###");var labelFont=this.eventHandlingObject.mPos.labelFont();labelFont.th=14,labelFont.fontColor="red",this.eventHandlingObject.mPos.setLabelFont(labelFont),this.eventHandlingObject.mPos.setLabel("AAAAAb"),this.eventHandlingObject.mPos.attach(plot),this.eventHandlingObject.mPos.setVisible(!1)}setDistance(dist){this.eventHandlingObject._dmin=dist}setEnabled(on){on?this.cw.installEventFilter(this.eventHandlingObject):(this.cw.removeEventFilter(this.eventHandlingObject),this.eventHandlingObject.selectorWidgetOverlay.clearCanvas())}setCb(cb){this.eventHandlingObject._cb=cb}setMousePattern(button,modifiers){this.eventHandlingObject.button=button,this.eventHandlingObject.modifiers=modifiers}}define("curveClosestPoint",["static","widgetOverlay","plotMarker"],(function(){}));class ScaleWidget extends Widget{constructor(plot,domDivElem,align){super(domDivElem);var m_domDiv=this.getElement(),m_scaleDraw=null,m_title="",m_plot=plot,minBorderDist=[],borderDist=[],m_titleFont=new Misc.Font(14),m_scaleFont=new Misc.Font(12);
/*!
	  Specify distances of the scale's endpoints from the
	  widget's borders. The actual borders will never be less
	  than minimum border distance.
	  \param dist1 Left or top Distance
	  \param dist2 Right or bottom distance
	  \sa borderDist()
	*/
this.setBorderDist=function(dist1,dist2){dist1==borderDist[0]&&dist2==borderDist[1]||(borderDist[0]=dist1,borderDist[1]=dist2)}
/*!
	  \brief Calculate a hint for the border distances.

	  This member function calculates the distance
	  of the scale's endpoints from the widget borders which
	  is required for the mark labels to fit into the widget.
	  The maximum of this distance an the minimum border distance
	  is returned.

	  \param start Return parameter for the border width at 
	               the beginning of the scale
	  \param end Return parameter for the border width at the 
	             end of the scale

	  \warning
	  <ul> <li>The minimum border distance depends on the font.</ul>
	  \sa setMinBorderDist(), getMinBorderDist(), setBorderDist()
	*/,this.getBorderDistHint=function(startAndEndObj){m_scaleDraw.getBorderDistHint(m_scaleFont,startAndEndObj),startAndEndObj.start<minBorderDist[0]&&(startAndEndObj.start=minBorderDist[0]),startAndEndObj.end<minBorderDist[1]&&(startAndEndObj.end=minBorderDist[1])},this.setLabelFont=function(fontObj){fontObj.th<0||""===fontObj.name||""===fontObj.style||(m_scaleFont=fontObj,m_plot.getLayout().adjustLayout(domDivElem,fontObj.th))},this.labelFont=function(){return m_scaleFont},this.setTitleFont=function(fontObj){fontObj.th<0||""===fontObj.name||""===fontObj.style||(m_titleFont=fontObj,m_plot.getLayout().adjustLayout(domDivElem,fontObj.th))},this.titleFont=function(){return m_titleFont}
/*!
	Set a scale draw

	scaleDraw has to be created with new and will be deleted in
	~QwtScaleWidget() or the next call of setScaleDraw().
	scaleDraw will be initialized with the attributes of
	the previous scaleDraw object.

	\param scaleDraw ScaleDraw object
	\sa scaleDraw()
	 */,this.setScaleDraw=function(scaleDraw){if(void 0!==scaleDraw&&scaleDraw!=m_scaleDraw){var sd;if(m_scaleDraw){scaleDraw.setScaleDiv(m_scaleDraw.scaleDiv());var transform=null;m_scaleDraw.scaleMap().transformation()&&(transform=m_scaleDraw.scaleMap().transformation().copy()),scaleDraw.setTransformation(transform)}m_scaleDraw=scaleDraw}}
/*!
	\return scaleDraw of this scale
	\sa setScaleDraw(), QwtScaleDraw::setScaleDraw()
	 */,this.scaleDraw=function(){return m_scaleDraw},this.initScale=function(align){(m_scaleDraw=new ScaleDraw).setAlignment(align);var linearScaleEngine=new LinearScaleEngine;m_scaleDraw.setScaleDiv(linearScaleEngine.divideScale(0,100,10,5))},void 0===align?this.initScale(LeftScale):this.initScale(align)
/*!
	Give title new text contents

	\param title New title
	\sa title(), setTitle(const QwtText &);
	 */,this.setTitle=function(title){m_title!==title&&(""!==title?(""===m_title&&(this.alignment()===LeftScale||this.alignment()===RightScale?m_plot.getLayout().adjustLayout(m_domDiv,parseFloat(m_domDiv.css("width"))+m_titleFont.th):m_plot.getLayout().adjustLayout(m_domDiv,parseFloat(m_domDiv.css("height"))+m_titleFont.th),Static.trigger("axisTitleAdded",!0)),m_title=title):(this.alignment()===LeftScale||this.alignment()===RightScale?m_plot.getLayout().adjustLayout(m_domDiv,parseFloat(m_domDiv.css("width"))-m_titleFont.th):m_plot.getLayout().adjustLayout(m_domDiv,parseFloat(m_domDiv.css("height"))-m_titleFont.th),m_title="",Static.trigger("axisTitleAdded",!1)),m_plot.getLayout().updateLayout())},this.title=function(){return m_title}
/*!
	Change the alignment

	\param alignment New alignment
	\sa alignment()
	 */,this.setAlignment=function(alignment){m_scaleDraw&&m_scaleDraw.setAlignment(alignment)}
/*!
	\return position
	\sa setPosition()
	 */,this.alignment=function(){return null==m_scaleDraw?LeftScale:m_scaleDraw.alignment()}
/*!
	Recalculate the scale's geometry and layout based on
	the current geometry and fonts.

	\param update_geometry Notify the layout system and call update
	to redraw the scale
	 */,this.labelWidth=function(str){return m_scaleFont.textSize(str).width}
/*!
	\brief draw the scale
	 */,this.draw=function(){var longestTick=m_scaleDraw.maxTickLength(),spacingBetweenLabelAndTick=m_scaleDraw.spacing(),spacingBetweenTitleAndLabel=10,margin=10;if(m_scaleDraw.orientation()===Vertical){var longestLbl,titleWidth,widgetWidth=longestTick+spacingBetweenLabelAndTick+this.labelWidth(m_scaleDraw.longestLabel())+10+(""!==m_title?m_titleFont.th:0)+10;m_plot.getLayout().adjustLayout(m_domDiv,widgetWidth)}if(m_scaleDraw.orientation()===Horizontal){var titleHeight,widgetHeight=longestTick+spacingBetweenLabelAndTick+10+(""!==m_title?m_titleFont.th:0)+10;m_plot.getLayout().adjustLayout(m_domDiv,widgetHeight)}m_plot.getLayout().updateLayout();var painter=new PaintUtil.Painter(this);painter.setFont(m_scaleFont),m_scaleDraw.draw(painter),""!==m_title&&(painter.setFont(m_titleFont),this.drawTitle(painter)),painter=null}
/*!
	Rotate and paint a title according to its position into a given rectangle.

	\param painter Painter
	\param align Alignment
	\param rect Bounding rectangle
	 */,this.drawTitle=function(painter){var canvasWidth=painter.canvasWidth(),canvasHeight=painter.canvasHeight();painter.save(),painter.setFont(m_titleFont),m_scaleDraw.alignment()===LeftScale?""!==m_title&&painter.drawVerticalText(m_title,m_titleFont.th,canvasHeight/2):m_scaleDraw.alignment()===RightScale?""!==m_title&&painter.drawVerticalText(m_title,canvasWidth-m_titleFont.th,canvasHeight/2,!0):m_scaleDraw.alignment()===BottomScale?""!==m_title&&painter.drawText(m_title,canvasWidth/2,canvasHeight-2,"center"):m_scaleDraw.alignment()===TopScale&&""!==m_title&&painter.drawText(m_title,canvasWidth/2,m_titleFont.th,"center"),painter.restore()}
/*!
	\brief Assign a scale division

	The scale division determines where to set the tick marks.

	\param scaleDiv Scale Division
	\sa For more information about scale divisions, see QwtScaleDiv.
	 */,this.setScaleDiv=function(scaleDiv){m_scaleDraw.scaleDiv()!==scaleDiv&&(m_scaleDraw.setScaleDiv(scaleDiv),Static.trigger("scaleDivChanged"))},Static.bind("scaleDivChanged",this.scaleChange)
/*!
	Set the transformation

	\param transformation Transformation
	\sa QwtAbstractScaleDraw::scaleDraw(), QwtScaleMap
	 */,this.setTransformation=function(trans){m_scaleDraw.setTransformation(trans)},this.toString=function(){return"[ScaleWidget]"}}}ScaleWidget.prototype.scaleChange=function(){},define("scaleWidget",["static","widget"],(function(){}));class Utility{static BicubicInterpolation(values,x,y){function TERP(t,a,b,c,d){return.5*(c-a+(2*a-5*b+4*c-d+(3*(b-c)+d-a)*t)*t)*t+b}var i0,i1,i2,i3;return i0=TERP(x,values[0][0],values[1][0],values[2][0],values[3][0]),i1=TERP(x,values[0][1],values[1][1],values[2][1],values[3][1]),i2=TERP(x,values[0][2],values[1][2],values[2][2],values[3][2]),i3=TERP(x,values[0][3],values[1][3],values[2][3],values[3][3]),TERP(y,i0,i1,i2,i3)}static bicubicInterpolate(data,x,y){for(var numberOfColumns=data.length,numberOfRows=data[0].length,rightColumn,bottomRow,colSpacing=(data[data.length-1][0].x-data[0][0].x)/(data.length-1),colIndex,i=Math.floor((x-data[0][0].x)/colSpacing);i<numberOfColumns;i++)if(data[i][0].x>x){rightColumn=i;break}null==rightColumn&&(rightColumn=numberOfColumns-1);for(var col0=data[0],rowSpacing=(col0[col0.length-1].y-col0[0].y)/(col0.length-1),rowIndex,i=Math.floor((y-col0[0].y)/rowSpacing);i<numberOfRows;i++)if(col0[i].y>y){bottomRow=i;break}if(null==bottomRow&&(bottomRow=numberOfRows-1),x>data[rightColumn][0].x||x<data[0][0].x)throw"x out of range";if(y>data[0][bottomRow].y||y<data[0][0].y)throw"y out of range";var leftBoundary=rightColumn-2,topBoundary=bottomRow-2;if(leftBoundary>=0&&topBoundary>=0&&rightColumn+1<numberOfColumns&&bottomRow+1<numberOfRows){var p0=[data[rightColumn-2][bottomRow-2].z,data[rightColumn-2][bottomRow-1].z,data[rightColumn-2][bottomRow].z,data[rightColumn-2][bottomRow+1].z],p1=[data[rightColumn-1][bottomRow-2].z,data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow].z,data[rightColumn-1][bottomRow+1].z],p2=[data[rightColumn][bottomRow-2].z,data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow].z,data[rightColumn][bottomRow+1].z],p3=[data[rightColumn+1][bottomRow-2].z,data[rightColumn+1][bottomRow-1].z,data[rightColumn+1][bottomRow].z,data[rightColumn+1][bottomRow+1].z];return Utility.BicubicInterpolation([p0,p1,p2,p3],(x-data[rightColumn-1][0].x)/(data[rightColumn][0].x-data[rightColumn-1][0].x),(y-col0[bottomRow-1].y)/(col0[bottomRow].y-col0[bottomRow-1].y))}if(leftBoundary<0&&topBoundary>=0&&rightColumn+1<numberOfColumns&&bottomRow+1<numberOfRows){var p0=[data[rightColumn-1][bottomRow-2].z,data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow].z,data[rightColumn-1][bottomRow+1].z],p1=[data[rightColumn-1][bottomRow-2].z,data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow].z,data[rightColumn-1][bottomRow+1].z],p2=[data[rightColumn][bottomRow-2].z,data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow].z,data[rightColumn][bottomRow+1].z],p3=[data[rightColumn+1][bottomRow-2].z,data[rightColumn+1][bottomRow-1].z,data[rightColumn+1][bottomRow].z,data[rightColumn+1][bottomRow+1].z];return Utility.BicubicInterpolation([p0,p1,p2,p3],(x-data[rightColumn-1][0].x)/(data[rightColumn][0].x-data[rightColumn-1][0].x),(y-col0[bottomRow-1].y)/(col0[bottomRow].y-col0[bottomRow-1].y))}if(leftBoundary>=0&&topBoundary<0&&rightColumn+1<numberOfColumns&&bottomRow<numberOfRows){var p0=[data[rightColumn-2][bottomRow-1].z,data[rightColumn-2][bottomRow-1].z,data[rightColumn-2][bottomRow].z,data[rightColumn-2][bottomRow+1].z],p1=[data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow].z,data[rightColumn-1][bottomRow+1].z],p2=[data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow].z,data[rightColumn][bottomRow+1].z],p3=[data[rightColumn+1][bottomRow-1].z,data[rightColumn+1][bottomRow-1].z,data[rightColumn+1][bottomRow].z,data[rightColumn+1][bottomRow+1].z];return Utility.BicubicInterpolation([p0,p1,p2,p3],(x-data[rightColumn-1][0].x)/(data[rightColumn][0].x-data[rightColumn-1][0].x),(y-col0[bottomRow-1].y)/(col0[bottomRow].y-col0[bottomRow-1].y))}if(leftBoundary>=0&&topBoundary>=0&&rightColumn+1>=numberOfColumns&&bottomRow+1<numberOfRows){var p0=[data[rightColumn-2][bottomRow-2].z,data[rightColumn-2][bottomRow-1].z,data[rightColumn-2][bottomRow].z,data[rightColumn-2][bottomRow+1].z],p1=[data[rightColumn-1][bottomRow-2].z,data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow].z,data[rightColumn-1][bottomRow+1].z],p2=[data[rightColumn][bottomRow-2].z,data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow].z,data[rightColumn][bottomRow+1].z],p3=[data[rightColumn][bottomRow-2].z,data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow].z,data[rightColumn][bottomRow+1].z];return Utility.BicubicInterpolation([p0,p1,p2,p3],(x-data[rightColumn-1][0].x)/(data[rightColumn][0].x-data[rightColumn-1][0].x),(y-col0[bottomRow-1].y)/(col0[bottomRow].y-col0[bottomRow-1].y))}if(leftBoundary>=0&&topBoundary>=0&&rightColumn+1<numberOfColumns&&bottomRow+1>=numberOfRows){var p0=[data[rightColumn-2][bottomRow-2].z,data[rightColumn-2][bottomRow-1].z,data[rightColumn-2][bottomRow].z,data[rightColumn-2][bottomRow].z],p1=[data[rightColumn-1][bottomRow-2].z,data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow].z,data[rightColumn-1][bottomRow].z],p2=[data[rightColumn][bottomRow-2].z,data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow].z,data[rightColumn][bottomRow].z],p3=[data[rightColumn+1][bottomRow-2].z,data[rightColumn+1][bottomRow-1].z,data[rightColumn+1][bottomRow].z,data[rightColumn+1][bottomRow].z];return Utility.BicubicInterpolation([p0,p1,p2,p3],(x-data[rightColumn-1][0].x)/(data[rightColumn][0].x-data[rightColumn-1][0].x),(y-col0[bottomRow-1].y)/(col0[bottomRow].y-col0[bottomRow-1].y))}if(leftBoundary<0&&topBoundary<0&&rightColumn+1<numberOfColumns&&bottomRow<numberOfRows){var p0=[data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow].z,data[rightColumn-1][bottomRow+1].z],p1=[data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow].z,data[rightColumn-1][bottomRow+1].z],p2=[data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow].z,data[rightColumn][bottomRow+1].z],p3=[data[rightColumn+1][bottomRow-1].z,data[rightColumn+1][bottomRow-1].z,data[rightColumn+1][bottomRow].z,data[rightColumn+1][bottomRow+1].z];return Utility.BicubicInterpolation([p0,p1,p2,p3],(x-data[rightColumn-1][0].x)/(data[rightColumn][0].x-data[rightColumn-1][0].x),(y-col0[bottomRow-1].y)/(col0[bottomRow].y-col0[bottomRow-1].y))}if(leftBoundary>=0&&topBoundary<0&&rightColumn+1>=numberOfColumns&&bottomRow<numberOfRows){var p0=[data[rightColumn-2][bottomRow-1].z,data[rightColumn-2][bottomRow-1].z,data[rightColumn-2][bottomRow].z,data[rightColumn-2][bottomRow+1].z],p1=[data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow].z,data[rightColumn-1][bottomRow+1].z],p2=[data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow].z,data[rightColumn][bottomRow+1].z],p3=[data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow].z,data[rightColumn][bottomRow+1].z];return Utility.BicubicInterpolation([p0,p1,p2,p3],(x-data[rightColumn-1][0].x)/(data[rightColumn][0].x-data[rightColumn-1][0].x),(y-col0[bottomRow-1].y)/(col0[bottomRow].y-col0[bottomRow-1].y))}if(leftBoundary<0&&topBoundary>=0&&rightColumn+1<numberOfColumns&&bottomRow+1>=numberOfRows){var p0=[data[rightColumn-1][bottomRow-2].z,data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow].z,data[rightColumn-1][bottomRow].z],p1=[data[rightColumn-1][bottomRow-2].z,data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow].z,data[rightColumn-1][bottomRow].z],p2=[data[rightColumn][bottomRow-2].z,data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow].z,data[rightColumn][bottomRow].z],p3=[data[rightColumn+1][bottomRow-2].z,data[rightColumn+1][bottomRow-1].z,data[rightColumn+1][bottomRow].z,data[rightColumn+1][bottomRow].z];return Utility.BicubicInterpolation([p0,p1,p2,p3],(x-data[rightColumn-1][0].x)/(data[rightColumn][0].x-data[rightColumn-1][0].x),(y-col0[bottomRow-1].y)/(col0[bottomRow].y-col0[bottomRow-1].y))}if(leftBoundary>=0&&topBoundary>=0&&rightColumn+1>=numberOfColumns&&bottomRow+1>=numberOfRows){var p0=[data[rightColumn-2][bottomRow-2].z,data[rightColumn-2][bottomRow-1].z,data[rightColumn-2][bottomRow].z,data[rightColumn-2][bottomRow].z],p1=[data[rightColumn-1][bottomRow-2].z,data[rightColumn-1][bottomRow-1].z,data[rightColumn-1][bottomRow].z,data[rightColumn-1][bottomRow].z],p2=[data[rightColumn][bottomRow-2].z,data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow].z,data[rightColumn][bottomRow].z],p3=[data[rightColumn][bottomRow-2].z,data[rightColumn][bottomRow-1].z,data[rightColumn][bottomRow].z,data[rightColumn][bottomRow].z];return Utility.BicubicInterpolation([p0,p1,p2,p3],(x-data[rightColumn-1][0].x)/(data[rightColumn][0].x-data[rightColumn-1][0].x),(y-col0[bottomRow-1].y)/(col0[bottomRow].y-col0[bottomRow-1].y))}}static BilinearInterpolation(q11,q12,q21,q22,x1,x2,y1,y2,x,y){return 1/((x2-x1)*(y2-y1))*(q11*(x2-x)*(y2-y)+q21*(x-x1)*(y2-y)+q12*(x2-x)*(y-y1)+q22*(x-x1)*(y-y1))}static bilinearInterpolate(data,x,y){for(var numberOfColumns=data.length,numberOfRows=data[0].length,rightColumn,bottomRow,colSpacing=(data[data.length-1][0].x-data[0][0].x)/(data.length-1),colIndex,i=Math.floor((x-data[0][0].x)/colSpacing);i<numberOfColumns;i++)if(data[i][0].x>x){rightColumn=i;break}null==rightColumn&&(rightColumn=numberOfColumns-1);for(var col0=data[0],rowSpacing=(col0[col0.length-1].y-col0[0].y)/(col0.length-1),rowIndex,i=Math.floor((y-col0[0].y)/rowSpacing);i<numberOfRows;i++)if(col0[i].y>y){bottomRow=i;break}if(null==bottomRow&&(bottomRow=numberOfRows-1),x>data[rightColumn][0].x||x<data[0][0].x)throw"x out of range";if(y>data[0][bottomRow].y||y<data[0][0].y)throw"y out of range";var leftBoundary=rightColumn-1,topBoundary=bottomRow-1,x1,y1,x2,y2,q11,q12,q21,q22;return x1=data[leftBoundary][0].x,x2=data[rightColumn][0].x,y1=data[0][bottomRow].y,y2=data[0][topBoundary].y,q11=data[leftBoundary][bottomRow].z,q12=data[leftBoundary][topBoundary].z,q21=data[rightColumn][bottomRow].z,q22=data[rightColumn][topBoundary].z,Utility.BilinearInterpolation(q11,q12,q21,q22,x1,x2,y1,y2,x,y)}static generateCurveName(plot,prefix){let postFix=1,preFix=prefix||"curve_",curveName=preFix.concat(postFix);for(;plot.findPlotCurve(curveName);)curveName=preFix.concat(++postFix);return curveName}static modifiers(event){var _modifiers=Static.NoModifier;return event.altKey&&event.ctrlKey&&event.shiftKey?_modifiers|Static.AltModifier|Static.ControlModifier|Static.ShiftModifier:event.altKey&&event.ctrlKey?_modifiers|Static.AltModifier|Static.ControlModifier:event.altKey&&event.shiftKey?_modifiers|Static.AltModifier|Static.ShiftModifier:event.ctrlKey&&event.shiftKey?_modifiers|Static.ControlModifier|Static.ShiftModifier:event.altKey?_modifiers|Static.AltModifier:event.ctrlKey?_modifiers|Static.ControlModifier:event.shiftKey?_modifiers|Static.ShiftModifier:_modifiers}static button(event){return null!=event&&event.button}static colorList(){return["black","red","green","blue","yellow","brown"]}static makePoints(arrayOfTwoMemberArrays){var res=[];return arrayOfTwoMemberArrays.forEach((function(arrayOfTwoMembers){res.push(new Misc.Point(parseFloat(arrayOfTwoMembers[0]),parseFloat(arrayOfTwoMembers[1])))})),res}static makeSpectrocurvePoints(arrayOfThreeMemberArrays){var res=[],minZ=Number.MAX_VALUE,maxZ=Number.MIN_VALUE;return arrayOfThreeMemberArrays.forEach((function(arrayOfThreeMembers){var zVal=parseFloat(arrayOfThreeMembers[2]);zVal<minZ&&(minZ=arrayOfThreeMembers[2]),zVal>maxZ&&(maxZ=arrayOfThreeMembers[2]),res.push({x:parseFloat(arrayOfThreeMembers[0]),y:parseFloat(arrayOfThreeMembers[1]),z:zVal})})),{points:res,zMin:minZ,zMax:maxZ}}static pointsToXYObjectArray(points){var res=[];return points.forEach((function(pt){res.push({x:pt.x,y:pt.y})})),res}static pointsFromXYObjectArray(XYpoints){var res=[];return XYpoints.forEach((function(pt){res.push(new Misc.Point(pt.x,pt.y))})),res}static linearEquationFromPoints(p1,p2){var m=(p2.y-p1.y)/(p2.x-p1.x),c=-m*p1.x+p1.y,fn=m.toString();return fn+="x+",fn+=c.toString()}static toArrays(csvContent){var _minZ=Number.MAX_VALUE,_maxZ=Number.MIN_VALUE,type=null,arr=csvContent.split("\n"),keyword=arr[0].toLowerCase();keyword.includes("curve")?type="curve":keyword.includes("spectrocurve")?type="spectrocurve":keyword.includes("spectrogram")&&(type="spectrogram");for(var result=[],i=0;i<arr.length;++i){var pt=arr[i].split(",");isNaN(parseFloat(pt))||(3==(pt=pt.map((function(item){return parseFloat(item)}))).length?(result.push({x:pt[0],y:pt[1],z:pt[2]}),result[result.length-1].z<_minZ&&(_minZ=result[result.length-1].z),result[result.length-1].z>_maxZ&&(_maxZ=result[result.length-1].z)):result.push(pt))}return{array:result,dataType:type,minZ:_minZ,maxZ:_maxZ}}static setAutoScale(plot,auto){plot.setAxisAutoScale(xBottom,auto),plot.setAxisAutoScale(yLeft,auto),plot.setAxisAutoScale(xTop,auto),plot.setAxisAutoScale(yRight,auto),Static.trigger("rescaled",auto)}static majorGridLines(grid,on){grid.enableX(on),grid.enableY(on),Static.trigger("majorGridLines",[grid,on])}static minorGridLines(grid,on){grid.enableXMin(on),grid.enableYMin(on),Static.trigger("minorGridLines",[grid,on])}static randomColor(brightness=0){var rgb=[256*Math.random(),256*Math.random(),256*Math.random()],mix=[51*brightness,51*brightness,51*brightness],mixedrgb;return"rgb("+[rgb[0]+mix[0],rgb[1]+mix[1],rgb[2]+mix[2]].map((function(x){return Math.round(x/2)})).join(",")+")"}static setCurveBrush(curve,successCb){var colorSelector=$('<input type="color" style="opacity:0;">');curve&&curve.rtti===Static.Rtti_PlotCurve&&(curve.brush().color==Static.NoBrush?colorSelector.val(Static.colorNameToHex("rgb(255, 255, 254)")):colorSelector.val(Static.colorNameToHex(curve.brush().color)),colorSelector.change((function(){var brush=curve.brush();brush.color=$(this).val(),curve.setBrush(brush),void 0!==successCb&&successCb(curve)})),colorSelector.trigger("click"))}static removeCurveBrush(curve){var brush=curve.brush();brush.color=Static.NoBrush,curve.setBrush(brush)}static setSymbolPenWidth(curve,width){var sym=curve.symbol(),pen;sym&&(sym.pen().width=width,curve.plot().autoRefresh(),Utility.updateLegendIconSize(curve),curve.plot().updateLegend(curve),Static.trigger("symbolAttributeChanged",curve))}static updateLegendIconSize(curve){var sz=curve.getLegendIconSize();if(curve.symbol()&&(sz=curve.symbol().boundingRect().size()),curve.symbol()&&curve.testLegendAttribute(Static.LegendShowSymbol)){if(curve.testLegendAttribute(Static.LegendShowLine)){var w=Math.ceil(1.5*sz.width);w%2&&w++,sz.width=Math.max(40,w)}curve.setLegendIconSize(sz)}else curve.testLegendAttribute(Static.LegendShowLine)&&(sz.width=40,curve.setLegendIconSize(sz))}static setSymbolSize(curve,value){var sym=curve.symbol();if(sym){var sz=sym.size();sz.width=value,sz.height=value,sym.setSize(sz),curve.plot().autoRefresh(),Utility.updateLegendIconSize(curve),curve.plot().updateLegend(curve),Static.trigger("symbolAttributeChanged",curve)}}static addSymbol(curve,style){if(curve&&curve.rtti===Static.Rtti_PlotCurve){style==NoSymbol&&curve.setSymbol(null);var sym=curve.symbol();null==sym&&((sym=new Symbol).setBrush(new Misc.Brush(Static.NoBrush)),sym.setSize(new Misc.Size(10,10)),curve.setSymbol(sym)),sym.size().width<=0&&sym.setSize(new Misc.Size(10,10)),sym.setStyle(style),curve.itemChanged(),curve.legendChanged(),Static.trigger("symbolAdded",curve)}}static curveRenameDlg(existingName,plot,successCb){Static.prompt('Enter a new name for "'+existingName+'"',existingName,(function(newName){if(existingName==newName)return Static.alert("You did not change the name!"),!1;var curve=plot.findPlotCurve(existingName);return plot.findPlotCurve(newName)?(Static.alert(newName+" already exist"),!1):(curve.setTitle(newName),void 0!==successCb&&successCb(newName,curve),Static.trigger("curveRenamed",curve),!0)}),"small")}static setLegendAttribute(curve,attribute,defaultIconSize){return"line"==attribute?(curve.setLegendIconSize(new Misc.Size(defaultIconSize)),curve.setLegendAttribute(Static.LegendShowSymbol,!1),void curve.setLegendAttribute(Static.LegendShowLine,!0)):"symbol"==attribute?(curve.setLegendIconSize(new Misc.Size(defaultIconSize)),curve.setLegendAttribute(Static.LegendShowLine,!1),void curve.setLegendAttribute(Static.LegendShowSymbol,!0)):"lineAndSymbol"==attribute?(curve.setLegendIconSize(new Misc.Size(defaultIconSize)),curve.setLegendAttribute(Static.LegendShowLine,!0),void curve.setLegendAttribute(Static.LegendShowSymbol,!0)):(curve.setLegendAttribute(Static.LegendShowLine,!1),void curve.setLegendAttribute(Static.LegendShowSymbol,!1))}static enableComponent(plot,component,on){for(var scaleDraw=null,axisId=0;axisId<axisCnt;++axisId)(scaleDraw=plot.axisScaleDraw(axisId)).enableComponent(component,on);plot.autoRefresh()}static setTickLength(plot,length){for(var scaleDraw=null,axisId=0;axisId<axisCnt;++axisId)scaleDraw=plot.axisScaleDraw(axisId),"small"==length?(scaleDraw.setTickLength(MajorTick,6),scaleDraw.setTickLength(MinorTick,3)):"medium"==length?(scaleDraw.setTickLength(MajorTick,8),scaleDraw.setTickLength(MinorTick,4)):"large"==length&&(scaleDraw.setTickLength(MajorTick,12),scaleDraw.setTickLength(MinorTick,6));plot.autoRefresh()}static mVerifyRange(size,i1,i2){if(size<1)return 0;if((i1=Math.max(0,Math.min(i1,size-1)))>(i2=Math.max(0,Math.min(i2,size-1)))){var temp=i1;i1=i2,i2=temp}return i2-i1+1}static makeSamples(obj){var fx=obj.fx,lowerX=obj.lowerX,upperX=obj.upperX,lowerY,upperY,numOfSamples=obj.numOfSamples,indepVarIsDegree=obj.indepVarIsDegree,indepVar=obj.variable||findIndepVar(fx),indepVarY=obj.variableY;if(void 0===numOfSamples&&(numOfSamples=_numOfSamples),"x"!==indepVar)for(;-1!=fx.indexOf(indepVar);)fx=fx.replace(indepVar,"x");if(obj.threeD&&"y"!==indepVarY){for(;-1!=fx.indexOf(indepVarY);)fx=fx.replace(indepVarY,"y");lowerY=obj.lowerY;var upperY=obj.upperY}obj.threeD&&(lowerY=obj.lowerY,upperY=obj.upperY);var samples=[],parser=new EvaluateExp(fx);if(parser.error)return Static.alert(parser.errorMessage),null;var step=(upperX-lowerX)/(numOfSamples-1),stepY,yVal,zVal;obj.threeD&&(stepY=(upperY-lowerY)/(numOfSamples-1));for(var zMin=Number.MAX_VALUE,zMax=Number.MIN_VALUE,i=0;i<=numOfSamples-1;++i){var xVal=lowerX+i*step;if(obj.threeD?(yVal=lowerY+i*stepY,(zVal=parser.eval({x:xVal,y:yVal}))<zMin&&(zMin=zVal),zVal>zMax&&(zMax=zVal)):yVal=parser.eval({x:xVal}),isFinite(yVal))if(!obj.threeD||isFinite(zVal)){if(parser.error)return Static.alert(parser.errorMessage),null;obj.threeD?samples.push({x:xVal,y:yVal,z:zVal}):samples.push(new Misc.Point(xVal,yVal))}else{if(Static.errorResponse==Static.warn)return Static.alert("f("+xVal+","+yVal+'): yields infinity. Probably a "divide by zero" error. Try changing the limits or adjusting number of points.'),null;if(Static.errorResponse==Static.warnIgnore){Static.alertYesNo("Error found!!! Do you want to silently ignore errors?",(function(answer){return answer==Static.Cancel?(console.log("C"),null):answer==Static.Yes?(console.log("Y"),Static.errorResponse=Static.silentIgnore,Static.errorResponseChanged=!0,null):answer==Static.No?(console.log("N"),null):void 0})),samples=[];break}}else{if(Static.errorResponse==Static.warn)return Static.alert("f("+xVal+'): yields infinity. Probably a "divide by zero" error. Try changing the limits or adjusting number of points.'),null;if(Static.errorResponse==Static.warnIgnore){Static.alertYesNo("Error found!!! Do you want to silently ignore errors?",(function(answer){return answer==Static.Cancel?(console.log("C"),null):answer==Static.Yes?(console.log("Y"),Static.errorResponse=Static.silentIgnore,Static.errorResponseChanged=!0,null):answer==Static.No?(console.log("N"),null):void 0})),samples=[];break}}}return Static.errorResponseChanged&&(Static.errorResponseChanged=!1,Static.errorResponse=Static.warnIgnore),obj.threeD?{data:samples,zLimits:{min:zMin,max:zMax}}:samples}}function PaintUtil(){function ContextPainter(ctx){var m_ctx=ctx,penStyle="",m_font=null;class Transform{constructor(){var trans=m_ctx.getTransform();this.dx=function(){return trans.m41},this.dy=function(){return trans.m42},this.mapRect=function(rect){var x=rect.left(),y=rect.top();return new Misc.Rect(trans.m11*x+trans.m21*y+this.dx(),trans.m22*y+trans.m12*x+this.dy(),rect.width(),rect.height())},this.map=function(pt){var x=pt.x,y=pt.y;return new Misc.Point(trans.m11*x+trans.m21*y+this.dx(),trans.m22*y+trans.m12*x+this.dy())}}}function adjustedText(text,maxTextLength){for(var txt=text,textLength=m_font.textSize(txt).width;textLength>maxTextLength&&txt.substring;)txt=txt.substring(0,txt.length-1),textLength=m_font.textSize(txt).width;return txt}this.getTransform=function(x,y){return new Transform},this.textSize=function(str){m_ctx.save(),m_ctx.font=m_font.weight+" "+m_font.style+" "+m_font.th+"px "+m_font.name;var w=m_ctx.measureText(str).width,h=m_ctx.measureText("M").width;return m_ctx.restore(),new Misc.Size(w,h)},this.context=function(){return m_ctx},this.canvasWidth=function(){return m_ctx.canvas.width},this.canvasHeight=function(){return m_ctx.canvas.height},this.save=function(){m_ctx.save()},this.restore=function(){m_ctx.restore()},this.translate=function(x,y){m_ctx.translate(x,y)},this.rotate=function(rot){m_ctx.rotate(rot*Math.PI/180)},this.scale=function(x,y){m_ctx.scale(x,y)},this.setPen=function(pen){this.style==Static.NoPen?m_ctx.strokeStyle="transparent":m_ctx.strokeStyle=pen.color,m_ctx.lineWidth=pen.width,"dash"===pen.style?m_ctx.setLineDash([10,5]):"dot"===pen.style?m_ctx.setLineDash([3,8]):"dashDot"===pen.style?m_ctx.setLineDash([12,5,3,5]):"dashDotDot"===pen.style&&m_ctx.setLineDash([12,5,3,5,3,5]),penStyle=pen.style},this.pen=function(){var color="";return color="transparent"==m_ctx.strokeStyle?NoPen:m_ctx.strokeStyle,new Misc.Pen(color,m_ctx.lineWidth,penStyle)},this.setBrush=function(brush){void 0===brush.color||brush.color===Static.NoBrush?m_ctx.fillStyle="transparent":m_ctx.fillStyle=brush.color},this.brush=function(){return m_ctx.fillStyle},this.setFont=function(font){m_ctx.font=font.weight+" "+font.style+" "+font.th+"px "+font.name,""!=typeof font.fontColor&&(m_ctx.fillStyle=font.fontColor),m_font=font},this.font=function(){return m_font},this.fillRect=function(rect,brush){brush.style!==NoBrush&&(this.setBrush(brush),m_ctx.rect(rect.left(),rect.top(),rect.width(),rect.height()),m_ctx.fill())},this.drawPath=function(path){m_ctx.beginPath();for(var i=0;i<path.elementCount();i++){var element=path.elementAt(i),x=element.x,y=element.y;switch(element.type){case MoveToElement:m_ctx.moveTo(x,y);break;case LineToElement:m_ctx.lineTo(x,y);break;case CurveToElement:var element1=path.elementAt(++i),x1=element1.x,y1=element1.y,element2=path.elementAt(++i),x2=element2.x,y2=element2.y;m_ctx.bezierCurveTo(x,y,x1,y1,x2,y2)}}m_ctx.stroke(),m_ctx.fill()},this.drawPoint=function(pt){var pw=this.pen().width;m_ctx.fillStyle=this.pen().color,m_ctx.fillRect(pt.x-1*pw,pt.y-1*pw,1.9*pw,2*pw)},this.drawPoints=function(points){m_ctx.fillStyle=this.pen().color;for(var pw=this.pen().width,i=0;i<points.length;++i)m_ctx.fillRect(points[i].x-1*pw,points[i].y-1*pw,1.9*pw,2*pw)},this.drawLine=function(param1,param2,param3,param4){m_ctx.beginPath(),void 0!==param4&&void 0!==param3?(m_ctx.moveTo(param1,param2),m_ctx.lineTo(param3,param4)):(m_ctx.moveTo(param1.x,param1.y),m_ctx.lineTo(param2.x,param2.y)),m_ctx.stroke()},this.drawImage=function(image,param1,param2,param3,param4){var x=0,y=0,w=image.width(),h=image.height();"object"==typeof param1&&(x=param1.left(),y=param1.top(),w=param1.width(),h=param1.height()),"number"==typeof param1&&"number"==typeof param2&&(x=param1,y=param2),"number"==typeof param3&&"number"==typeof param4&&(w=param3,h=param4),image.width()>0&&image.height()>0&&m_ctx.putImageData(image.imageData(),x,y,0,0,w,h)},this.drawPolyline=function(polyline){m_ctx.beginPath(),m_ctx.moveTo(polyline[0].x,polyline[0].y);for(var i=1;i<polyline.length;++i)m_ctx.lineTo(polyline[i].x,polyline[i].y);m_ctx.stroke()},this.drawPolygon=function(polyline){polyline[0].x===polyline[polyline.length-1].x&&polyline[0].y===polyline[polyline.length-1].y||polyline.push(polyline[0]),m_ctx.beginPath(),this.drawPolyline(polyline),m_ctx.closePath(),m_ctx.fill()},this.drawRect=function(x,y,width,height){if(m_ctx.beginPath(),"number"==typeof x)m_ctx.rect(x,y,width,height);else{var rect=x;m_ctx.rect(rect.left(),rect.top(),rect.width(),rect.height())}m_ctx.stroke(),m_ctx.fill(),m_ctx.closePath()},this.drawCircle=function(x,y,radius){if(m_ctx.beginPath(),"number"==typeof x)m_ctx.arc(x,y,radius,0,2*Math.PI,!1);else{var pt=x;radius=y,m_ctx.arc(pt.x,pt.y,radius,0,2*Math.PI,!1)}m_ctx.stroke(),m_ctx.fill(),m_ctx.closePath()},this.drawEllipse=function(rect){var centerX=(rect.left()+rect.right())/2,centerY=(rect.top()+rect.bottom())/2,width=rect.width(),height=rect.height();m_ctx.beginPath(),m_ctx.moveTo(centerX,centerY-height/2),m_ctx.bezierCurveTo(centerX+width/2,centerY-height/2,centerX+width/2,centerY+height/2,centerX,centerY+height/2),m_ctx.bezierCurveTo(centerX-width/2,centerY+height/2,centerX-width/2,centerY-height/2,centerX,centerY-height/2),m_ctx.stroke(),m_ctx.fill(),m_ctx.closePath(),m_ctx.closePath()},this.drawVerticalText=function(txt,tx,ty,topDown){var bottomUp=-1;void 0!==topDown&&!0===topDown&&(bottomUp=1);var size=m_ctx.measureText(txt);m_ctx.save();var x=tx,y=ty-bottomUp*size.width/2;m_ctx.translate(x,y),m_ctx.rotate(bottomUp*Math.PI/2),m_ctx.translate(-x,-y),-1===bottomUp&&(m_ctx.textAlign="left"),m_ctx.fillText(txt,x,y),m_ctx.restore()},this.drawText=function(text,x,y,alignment,maxTextLength){void 0!==maxTextLength&&(text=adjustedText(text,maxTextLength)),void 0!==alignment&&(m_ctx.textAlign=alignment),m_ctx.fillText(text,x,y)},this.toString=function(){return"[Painter: "+m_ctx+"]"}}function GraphicPainter(graphic){var svgNS="http://www.w3.org/2000/svg",m_graphic=graphic,m_pen=new Misc.Pen;m_pen.style=Static.NoPen;var m_brush=new Misc.Brush,m_font=new Misc.Font,elem=null;function doSetPen(){m_pen.style===Static.NoPen?elem.attr("stroke","transparent"):elem.attr("stroke",m_pen.color),elem.attr("stroke-Width",m_pen.width),"dash"===m_pen.style?elem.attr("stroke-dasharray",[10,5]):"dot"===m_pen.style?elem.attr("stroke-dasharray",[3,8]):"dashDot"===m_pen.style?elem.attr("stroke-dasharray",[12,5,3,5]):"dashDotDot"===m_pen.style&&elem.attr("stroke-dasharray",[12,5,3,5,3,5])}function doSetBrush(){m_brush.color===Static.NoBrush?elem.attr("fill","transparent"):elem.attr("fill",m_brush.color)}function doSetFont(){elem.attr("font-size",m_font.th),elem.attr("font-family",m_font.name),elem.attr("font-weight",m_font.weight),elem.attr("font-style",m_font.style)}this.setBrush=function(b){m_brush=b},this.setPen=function(p){m_pen=p},this.pen=function(){return m_pen},this.rotate=function(rotation,x,y){xCenter=x||0,yCenter=y||0,rotation&&elem.attr("transform"," rotate("+rotation+" "+xCenter+" "+yCenter+")")},this.transform=function(obj){var xTrans=obj.translateX||0,yTrans=obj.translateY||0,xScale=obj.scaleX||1,yScale=obj.scaleY||1,rotation=obj.rotation||0,xCenter=obj.rotationX||0,yCenter=obj.rotationY||0,transformStr="";1==xScale&&1==yScale||(transformStr+=" scale("+xScale+" "+yScale+")"),rotation&&(transformStr+=" rotate("+rotation+" "+xCenter+" "+yCenter+")"),1==xTrans&&1==yTrans||(transformStr+=" translate("+xTrans+" "+yTrans+")"),elem.attr("transform",transformStr)},this.drawRect=function(x,y,w,h){(elem=$(document.createElementNS(svgNS,"rect"))).attr("x",x),elem.attr("y",y),elem.attr("width",w),elem.attr("height",h),doSetBrush(),doSetPen(),elem.appendTo($(m_graphic.svg()))},this.drawPath=function(path){elem=$(document.createElementNS(svgNS,"path"));for(var data=path.data,d="",i=0;i<path.elementCount();i++){var element=path.elementAt(i),x=element.x+data.xOffset,y=element.y+data.yOffset;switch(element.type){case MoveToElement:d+="M"+x+" "+y+" ";break;case LineToElement:d+="L"+x+" "+y+" ";break;case CurveToElement:var element1=path.elementAt(++i),x1=element1.x+data.xOffset,y1=element1.y+data.yOffset,element2=path.elementAt(++i),x2,y2;d+="C "+x+" "+y+" "+x1+" "+y1+" "+(element2.x+data.xOffset)+" "+(element2.y+data.yOffset)+" "}}elem.attr("d",d),elem.attr("transform"," scale("+data.scale+") rotate("+data.rotation+" "+data.xCenter+" "+data.yCenter+")"),doSetBrush(),doSetPen(),elem.appendTo($(m_graphic.svg()))},this.fillRect=function(rect,brush){(elem=$(document.createElementNS(svgNS,"rect"))).attr("x",rect.left),elem.attr("y",rect.top),elem.attr("width",rect.width),elem.attr("height",rect.height),elem.attr("fill",brush.color),doSetPen(),elem.appendTo($(m_graphic.svg()))},this.drawCircle=function(x,y,radius){(elem=$(document.createElementNS(svgNS,"circle"))).attr("cx",x),elem.attr("cy",y),elem.attr("r",radius),doSetBrush(),doSetPen(),elem.appendTo($(m_graphic.svg()))},this.drawLine=function(x1,y1,x2,y2){(elem=$(document.createElementNS(svgNS,"line"))).attr("x1",x1),elem.attr("y1",y1),elem.attr("x2",x2),elem.attr("y2",y2),doSetPen(),elem.appendTo($(m_graphic.svg()))},this.drawText=function(text,x,y){(elem=$(document.createElementNS(svgNS,"text"))).attr("x",x),elem.attr("y",y),doSetFont(),doSetPen(),doSetBrush(),elem[0].textContent=text,elem.appendTo($(m_graphic.svg()))},this.textSize=function(text){return m_font.textSize(text)},this.setFont=function(font){m_font=font},this.font=function(){return m_font},this.toString=function(){return"[GraphicPainter]"}}PaintUtil.Painter=function Painter(param){var m_painter=null,m_graphicPainter=!1;"[Graphic]"===param.toString()?(m_graphicPainter=!0,m_painter=new GraphicPainter(param)):m_painter="[object CanvasRenderingContext2D]"===param.toString()?new ContextPainter(param):new ContextPainter(param.getContext()),this.isGraphicPainter=function(){return m_graphicPainter},this.textSize=function(str){return m_painter.textSize(str)},this.context=function(){if(!m_graphicPainter)return m_painter.context()},this.canvasWidth=function(){if(!m_graphicPainter)return m_painter.canvasWidth()},this.canvasHeight=function(){if(!m_graphicPainter)return m_painter.canvasHeight()},this.save=function(){m_graphicPainter||m_painter.save()},this.restore=function(){m_graphicPainter||m_painter.restore()},this.translate=function(x,y){m_graphicPainter||m_painter.translate(x,y)},this.scale=function(x,y){m_graphicPainter||m_painter.scale(x,y)},this.rotate=function(rot,x,y){m_graphicPainter||m_painter.rotate(rot,x,y)},this.transform=function(obj){if(null==obj)return m_painter.getTransform();m_graphicPainter&&m_painter.transform(obj)},this.setPen=function(pen){m_painter.setPen(pen)},this.pen=function(){return m_painter.pen()},this.setBrush=function(brush){m_painter.setBrush(brush)},this.brush=function(){return m_painter.brush()},this.setFont=function(font){m_painter.setFont(font)},this.font=function(){return m_painter.font()},this.fillRect=function(rect,brush){m_painter.fillRect(rect,brush)},this.drawPath=function(path){m_painter.drawPath(path)},this.drawPoint=function(pt){m_graphicPainter||m_painter.drawPoint(pt)},this.drawPoints=function(points){m_graphicPainter||m_painter.drawPoints(points)},this.drawLine=function(param1,param2,param3,param4){m_painter.drawLine(param1,param2,param3,param4)},this.drawImage=function(image,param1,param2,param3,param4){m_painter.drawImage(image,param1,param2,param3,param4)},this.drawPolyline=function(polyline){m_graphicPainter||m_painter.drawPolyline(polyline)},this.drawPolygon=function(polyline){m_graphicPainter||m_painter.drawPolygon(polyline)},this.drawRect=function(x,y,width,height){m_painter.drawRect(x,y,width,height)},this.drawVerticalText=function(txt,tx,ty,topDown){m_graphicPainter||m_painter.drawVerticalText(txt,tx,ty,topDown)},this.drawText=function(text,x,y,alignment,maxTextLength){m_painter.drawText(text,x,y,alignment,maxTextLength)},this.drawCircle=function(x,y,radius){m_painter.drawCircle(x,y,radius)},this.drawEllipse=function(rect){m_painter.drawEllipse(rect)},this.toString=function(){return m_painter.toString()}}}define("utility",(function(){})),PaintUtil(),define("painter",(function(){}));
/*!
Construct a division without ticks
lowerBound First boundary
upperBound Second boundary
lowerBound might be greater than upperBound for inverted scales
 */
var ScaleDiv=function(arg1,arg2,arg3,arg4,arg5){var d_lowerBound=0,d_upperBound=0,d_ticks=[];if(void 0===arg1||void 0===arg2);else if(void 0===arg3&&"object"==typeof arg1&&"object"==typeof arg2){var interval=arg1,ticks=arg2;d_lowerBound=interval.minValue(),d_upperBound=interval.maxValue();for(var i=0;i<NTickTypes;i++)d_ticks[i]=ticks[i]}else if(void 0===arg4)for(lowerBound=arg1,upperBound=arg2,ticks=arg3,d_lowerBound=lowerBound,d_upperBound=upperBound,i=0;i<NTickTypes;i++)d_ticks[i]=ticks[i];else void 0===arg1&&void 0===arg2&&void 0===arg3&&void 0===arg4&&void 0===arg5&&(lowerBound=arg1,upperBound=arg2,minorTicks=arg3,mediumTicks=arg4,majorTicks=arg5,d_lowerBound=lowerBound,d_upperBound=upperBound,d_ticks[MinorTick]=minorTicks,d_ticks[MediumTick]=mediumTicks,d_ticks[MajorTick]=majorTicks)
/*!
	Change the interval
	lowerBound First boundary
	upperBound Second boundary
	lowerBound might be greater than upperBound for inverted scales
	 */;this.setInterval=function(arg1,arg2){"number"==typeof arg1&&"number"==typeof arg2?(lowerBound=arg1,upperBound=arg2,d_lowerBound=lowerBound,d_upperBound=upperBound):"object"==typeof arg1&&void 0===arg2&&(d_lowerBound=(interval=arg1).minValue(),d_upperBound=interval.maxValue())},
/*!
	lowerBound -> upperBound
	 */
this.interval=function(){return new Interval(d_lowerBound,d_upperBound)},
/*!
	Set the first boundary
	lowerBound First boundary
	 */
this.setLowerBound=function(lowerBound){d_lowerBound=lowerBound},
/*!
	First boundary
	 */
this.lowerBound=function(){return d_lowerBound},
/*!
	Set the second boundary
	upperBound Second boundary
	 */
this.setUpperBound=function(upperBound){d_upperBound=upperBound},
/*!
	upper bound
	 */
this.upperBound=function(){return d_upperBound},this.range=function(){return d_upperBound-d_lowerBound},this.isEmpty=function(){return d_lowerBound==d_upperBound},this.isIncreasing=function(){return d_lowerBound<=d_upperBound},
/*!
	Return if a value is between lowerBound() and upperBound()
	value Value
	return true/false
	 */
this.contains=function(value){var min=Math.min(d_lowerBound,d_upperBound),max=Math.max(d_lowerBound,d_upperBound);return value>=min&&value<=max}
/*!
	Invert the scale division
	 */,this.invert=function(){var temp=d_lowerBound;d_lowerBound=d_upperBound,d_upperBound=temp;for(var i=0;i<NTickTypes;i++){for(var ticks=d_ticks[i],size=ticks.length,size2=size/2,j=0;j<size2;j++)temp=ticks[j],ticks[j]=ticks[size-1-j],ticks[size-1-j]=temp;d_ticks[i]=ticks}},
/*!
	A scale division with inverted boundaries and ticks
	 */
this.inverted=function(){var other=new ScaleDiv(d_lowerBound,d_upperBound,d_ticks);return other.invert(),other},
/*!
	Return a scale division with an interval [lowerBound, upperBound]
	where all ticks outside this interval are removed
	param lowerBound Lower bound
	param upperBound Upper bound
	return Scale division with all ticks inside of the given interval
	note lowerBound might be greater than upperBound for inverted scales
	 */
this.bounded=function(lowerBound,upperBound){var min=Math.min(lowerBound,upperBound),max=Math.max(lowerBound,upperBound),sd=new ScaleDiv;for(sd.setInterval(lowerBound,upperBound),tickType=0;tickType<NTickTypes;tickType++){var ticks=d_ticks[tickType],boundedTicks=[];for(i=0;i<ticks.size();i++){var tick=ticks[i];tick>=min&&tick<=max&&boundedTicks.push(tick)}sd.setTicks(tickType,boundedTicks)}return sd},
/*!
	Assign ticks
	param type MinorTick, MediumTick or MajorTick
	param ticks Values of the tick positions
	 */
this.setTicks=function(type,ticks){type>=0&&type<NTickTypes&&(d_ticks[type]=ticks)},
/*!
	Return a list of ticks
	param type MinorTick, MediumTick or MajorTick
	return Tick list
	 */
this.ticks=function(type){return type>=0&&type<NTickTypes?d_ticks[type]:[]}};ScaleDiv.prototype.toString=function(){return"[ScaleDiv]"},define("scaleDiv",(function(){}));class Interval{constructor(minValue,maxValue,borderFlags){var d_minValue=0,d_maxValue=-1,d_borderFlags=IncludeBorders;void 0!==minValue&&void 0!==maxValue&&(d_minValue=minValue,d_maxValue=maxValue),void 0!==borderFlags&&(d_borderFlags=borderFlags)
/*!
        Change the border flags

        \param borderFlags Or'd BorderMode flags
        \sa borderFlags()
         */,this.setBorderFlags=function(borderFlags){d_borderFlags=borderFlags}
/*!
        \return Border flags
        \sa setBorderFlags()
         */,this.borderFlags=function(){return d_borderFlags}
/*!
        Assign the lower limit of the interval

        \param minValue Minimum value
         */,this.setMinValue=function(minValue){d_minValue=minValue}
/*!
        Assign the upper limit of the interval

        \param maxValue Maximum value
         */,this.setMaxValue=function(maxValue){d_maxValue=maxValue},this.minValue=function(){return d_minValue},this.maxValue=function(){return d_maxValue}}toString(){return"[Interval]"}
/*!
    Assign the limits of the interval

    \param minValue Minimum value
    \param maxValue Maximum value
    \param borderFlags Include/Exclude borders
     */
setInterval(minValue,maxValue,borderFlags){this.setMinValue(minValue),this.setMaxValue(maxValue),this.setBorderFlags(borderFlags)}
/*!
    A interval is valid when minValue() <= maxValue().
    In case of QwtInterval::ExcludeBorders it is true
    when minValue() < maxValue()

    \return True, when the interval is valid
     */isValid(){return 0==(this.borderFlags()&ExcludeBorders)?this.minValue()<=this.maxValue():this.minValue()<this.maxValue()}
/*!
    \brief Return the width of an interval

    The width of invalid intervals is 0.0, otherwise the result is
    maxValue() - minValue().

    \return Interval width
    \sa isValid()
     */width(){return this.isValid()?this.maxValue()-this.minValue():0}isNull(){return this.isValid()&&this.minValue()>=this.maxValue()}
/*!
    Invalidate the interval

    The limits are set to interval [0.0, -1.0]
    \sa isValid()
     */invalidate(){this.setMinValue(0),this.setMaxValue(-1)}
/*!
    \brief Normalize the limits of the interval

    If maxValue() < minValue() the limits will be inverted.
    \return Normalized interval

    \sa isValid(), inverted()
     */normalized(){return this.minValue()>this.maxValue()?this.inverted():this.minValue()==this.maxValue()&&this.borderFlags()==ExcludeMinimum?this.inverted():this}
/*!
    Invert the limits of the interval
    \return Inverted interval
    \sa normalized()
     */inverted(){var borderFlags=IncludeBorders;return this.borderFlags()&ExcludeMinimum&&(borderFlags|=ExcludeMaximum),this.borderFlags()&ExcludeMaximum&&(borderFlags|=ExcludeMinimum),new Interval(this.maxValue(),this.minValue(),borderFlags)}
/*!
    Test if a value is inside an interval

    \param value Value
    \return true, if value >= minValue() && value <= maxValue()
     */contains(value){return!!this.isValid()&&(!(value<this.minValue()||value>this.maxValue())&&(!(value==this.minValue()&&this.borderFlags()&ExcludeMinimum)&&!(value==this.maxValue()&&this.borderFlags()&ExcludeMaximum)))}
/*!
    Limit the interval, keeping the border modes

    \param lowerBound Lower limit
    \param upperBound Upper limit

    \return Limited interval
     */limited(lowerBound,upperBound){if(!this.isValid()||lowerBound>upperBound)return new Interval;var minValue=Math.max(this.minValue(),lowerBound);minValue=Math.min(minValue,upperBound);var maxValue=Math.max(this.maxValue(),lowerBound);return maxValue=Math.min(maxValue,upperBound),new Interval(minValue,maxValue,this.borderFlags())}}define("interval",(function(){}));class Transform{constructor(){}toString(){return"[Transform]"}
/*!
	value Value to be bounded
	return value unmodified
	*/bounded(value){return value}}class NullTransform extends Transform{constructor(){super()}toString(){return"[NullTransform]"}
/*!
	value Value to be transformed
	return value unmodified
	*/transform(value){return value}
/*!
	value Value to be transformed
	return value unmodified
	*/invTransform(value){return value}copy(){return new NullTransform}}class LogTransform extends Transform{constructor(){super()}toString(){return"[LogTransform]"}
/*!
	value Value to be transformed
	return log( value )
	*/transform(value){return Math.log(value)}
/*!
	param value Value to be transformed
	return exp( value )
	*/invTransform(value){return Math.exp(value)}
/*!
	value Value to be bounded
	return qBound( LogMin, value, LogMax )
	*/bounded(value){return value>Number.MAX_VALUE?Number.MAX_VALUE:value<Number.MIN_VALUE?Number.MIN_VALUE:value}copy(){return new LogTransform}}class PowerTransform extends Transform{constructor(exponent){super(),this.d_exponent=exponent}toString(){return"[PowerTransform]"}
/*!
	value Value to be transformed
	return Exponentiation preserving the sign
	 */transform(value){return value<0?-Math.pow(-value,1/this.d_exponent):Math.pow(value,1/this.d_exponent)}
/*!
	value Value to be transformed
	return Inverse exponentiation preserving the sign
	 */invTransform(value){return value<0?-Math.pow(-value,this.d_exponent):Math.pow(value,this.d_exponent)}copy(){return new PowerTransform(this.d_exponent)}}define("transform",(function(){}));
/*!
\brief A scale map

QwtScaleMap offers transformations from the coordinate system
of a scale into the linear coordinate system of a paint device
and vice versa.
 */
class ScaleMap{static invTransform_Rect(xMap,yMap,rect){var x1=xMap.invTransform(rect.left()),x2=xMap.invTransform(rect.right()-1),y1=yMap.invTransform(rect.top()),y2=yMap.invTransform(rect.bottom()-1),r;return new Misc.Rect(new Misc.Point(x1,y1),x2-x1,y2-y1).normalized()}static transform_Rect(xMap,yMap,rect){var x1=xMap.transform(rect.left()),x2=xMap.transform(rect.right()),y1=yMap.transform(rect.top()),y2=yMap.transform(rect.bottom()),r;return new Misc.Rect(new Misc.Point(x1,y1),x2-x1,y2-y1).normalized()}
/*!
    Transform a point from paint to scale coordinates
    xMap X map
    yMap Y map
    pos Position in paint coordinates
    Position in scale coordinates
     */static invTransform(xMap,yMap,pos){return new Misc.Point(xMap.invTransform1(pos.x),yMap.invTransform1(pos.y))}
/*!
    Transform a point from scale to paint coordinates
    xMap X map
    yMap Y map
    pos Position in scale coordinates
    Position in paint coordinates
     */static transform(xMap,yMap,pos){return new Misc.Point(xMap.transform1(pos.x),yMap.transform1(pos.y))}static transformPath(xMap,yMap,path,doAlign){for(var shape=new Misc.MPath,i=0;i<path.elementCount();i++){var element=path.elementAt(i),x=xMap.transform(element.x),y=yMap.transform(element.y);switch(element.type){case MoveToElement:doAlign&&(x=Math.round(x),y=Math.round(y)),shape.moveTo(x,y);break;case LineToElement:doAlign&&(x=Math.round(x),y=Math.round(y)),shape.lineTo(x,y);break;case CurveToElement:var element1=path.elementAt(++i),x1=xMap.transform(element1.x),y1=yMap.transform(element1.y),element2=path.elementAt(++i),x2=xMap.transform(element2.x),y2=yMap.transform(element2.y);shape.cubicTo(x,y,x1,y1,x2,y2)}}return shape}constructor(){var d_s1=0,d_s2=1,d_p1=0,d_p2=1,d_cnv=1,d_ts1=0,d_transform=null;this.setd_cnv=function(val){d_cnv=val},this.setd_ts1=function(val){d_ts1=val}
/*!
        Initialize the map with a transformation
         */,this.setTransformation=function(trans){trans!==d_transform&&(d_transform=trans),this.setScaleInterval(d_s1,d_s2)},this.transformation=function(){return d_transform},this.setScaleInterval=function(s1,s2){d_s1=s1,d_s2=s2,d_transform&&(d_s1=d_transform.bounded(d_s1),d_s2=d_transform.bounded(d_s2)),this.updateFactor()}
/*!
        Specify the borders of the paint device interval
        p1 first border
        p2 second border
         */,this.setPaintInterval=function(p1,p2){d_p1=p1,d_p2=p2,this.updateFactor()},this.copy=function(){var cpy=new ScaleMap;return cpy.setScaleInterval(this.s1(),this.s2()),cpy.setPaintInterval(this.p1(),this.p2()),cpy},this.updateFactor=function(){d_ts1=d_s1;var ts2=d_s2;d_transform&&(d_ts1=d_transform.transform(d_ts1),ts2=d_transform.transform(ts2)),d_cnv=1,d_ts1!=ts2&&(d_cnv=(d_p2-d_p1)/(ts2-d_ts1))}
/*!
        Transform a point from paint to scale coordinates
        xMap X map
        yMap Y map
        pos Position in paint coordinates
        Position in scale coordinates
         */,this.invTransform=function(p){return this.invTransform1(p)}
/*!
        Transform a point from scale to paint coordinates
        xMap X map
        yMap Y map
        pos Position in scale coordinates
        Position in paint coordinates
         */,this.transform=function(s){return this.transform1(s)}
/*!
        Transform a point related to the scale interval into an point
        related to the interval of the paint device

        \param s Value relative to the coordinates of the scale
        \return Transformed value

        \sa invTransform()
         */,this.transform1=function(s){return d_transform&&(s=d_transform.transform(s)),d_p1+(s-d_ts1)*d_cnv}
/*!
        Transform an paint device value into a value in the
        interval of the scale.

        \param p Value relative to the coordinates of the paint device
        \return Transformed value

        \sa transform()
         */,this.invTransform1=function(p){var s=d_ts1+(p-d_p1)/d_cnv;return d_transform&&(s=d_transform.invTransform(s)),s}
/*!
		\return First border of the scale interval
		*/,this.s1=function(){return d_s1}
/*!
			\return Second border of the scale interval
		*/,this.s2=function(){return d_s2}
/*!
			\return First border of the paint interval
		*/,this.p1=function(){return d_p1}
/*!
			\return Second border of the paint interval
		*/,this.p2=function(){return d_p2},this.copy=function(){var cpy=new ScaleMap;return cpy.setScaleInterval(d_s1,d_s2),cpy.setPaintInterval(d_p1,d_p2),cpy.setd_cnv(d_cnv),cpy.setd_ts1(d_ts1),this.transformation()&&cpy.setTransformation(this.transformation().copy()),cpy},this.isInverting=function(){return d_p1<d_p2!=d_s1<d_s2},this.toString=function(){return'[ScaleMap "'+d_cnv+'"]'}}}define("scaleMap",["static","transform"],(function(){}));class Layout{constructor(plotDiv,plot){var plt=plot,leftOfLeftScaleDiv=0,topOfCentralDiv=0,bottomOfCentralDiv=0,rightOfCentralDiv=0,leftOfCentralDiv=0,rightOfRightScaleDiv=0,rightOfLegendDiv=0,bottomOfBottomScaleDiv=0,bottomOfFooterDiv=0,topOfTopScaleDiv=0;if(plotDiv){plotDiv.parent()[0]===document.body&&plotDiv.css("position","absolute");var titleDiv=$("<div />").attr({id:"titleDiv"});plotDiv.append(titleDiv);var topScaleDiv=$("<div />").attr({id:"topScaleDiv"});plotDiv.append(topScaleDiv),"auto"!==topScaleDiv.css("top")&&(topOfTopScaleDiv=parseFloat(topScaleDiv.css("top")));var leftScaleDiv=$("<div />").attr({id:"leftScaleDiv"});plotDiv.append(leftScaleDiv),"auto"!==leftScaleDiv.css("left")&&(leftOfLeftScaleDiv=parseFloat(leftScaleDiv.css("left")));var centralDiv=$("<div />").attr({id:"centralDiv"});plotDiv.append(centralDiv),"auto"!==centralDiv.css("top")&&(topOfCentralDiv=parseFloat(centralDiv.css("top"))),"auto"!==centralDiv.css("bottom")&&(bottomOfCentralDiv=parseFloat(centralDiv.css("bottom"))),"auto"!==centralDiv.css("right")&&(rightOfCentralDiv=parseFloat(centralDiv.css("right"))),"auto"!==centralDiv.css("left")&&(leftOfCentralDiv=parseFloat(centralDiv.css("left"))),this.getCentralDiv=function(){return centralDiv};var rightScaleDiv=$("<div />").attr({id:"rightScaleDiv"});plotDiv.append(rightScaleDiv),"auto"!==rightScaleDiv.css("right")&&(rightOfRightScaleDiv=parseFloat(rightScaleDiv.css("right")));var legendDiv=$("<div/>").attr({id:"legendDiv"});plotDiv.append(legendDiv),"auto"!==legendDiv.css("right")&&(rightOfLegendDiv=parseFloat(legendDiv.css("right")));var bottomScaleDiv=$("<div />").attr({id:"bottomScaleDiv"});plotDiv.append(bottomScaleDiv),"auto"!==bottomScaleDiv.css("bottom")&&(bottomOfBottomScaleDiv=parseFloat(bottomScaleDiv.css("bottom")));var footerDiv=$("<div />").attr({id:"footerDiv"});plotDiv.append(footerDiv),"auto"!==footerDiv.css("bottom")&&(bottomOfFooterDiv=parseFloat(footerDiv.css("bottom"))),this.getPlotDiv=function(){return plotDiv},this.getLegendDiv=function(){return legendDiv},this.getTitleDiv=function(){return titleDiv},this.getFooterDiv=function(){return footerDiv};var scaleDivElement=[leftScaleDiv,rightScaleDiv,bottomScaleDiv,topScaleDiv];this.getScaleDivElement=function(type){return type<0||type>=axisCnt?null:scaleDivElement[type]},this.adjustLayout=function(domElement,newValue){var dim="width";"footerDiv"!==domElement[0].id&&"titleDiv"!==domElement[0].id&&"topScaleDiv"!==domElement[0].id&&"bottomScaleDiv"!==domElement[0].id||(dim="height"),domElement.css(dim,newValue)},this.updateLayout=function(){void 0!==plt&&(adjustForTitle(),adjustForTopScale(),adjustForFooter(),adjustForBottomScale(),adjustForLegend(),adjustForRightScale(),adjustForLeftScale())},this.isLegendDivVisible=function(){return"block"===legendDiv[0].style.display},this.setPlot=function(plot){plt=plot},this.toString=function(){return"[Layout]"}}function topScaleAndTitle(){var titleHeight=parseFloat(titleDiv.css("height")),topScaleHeight=parseFloat(topScaleDiv.css("height"));legendDiv.css("top",titleHeight),topScaleDiv.css("top",titleHeight),centralDiv.css("top",titleHeight+topScaleHeight),leftScaleDiv.css("top",titleHeight+topScaleHeight),rightScaleDiv.css("top",titleHeight+topScaleHeight)}function topScaleAndNotTitle(){var topScaleHeight=parseFloat(topScaleDiv.css("height"));legendDiv.css("top",0),topScaleDiv.css("top",0),centralDiv.css("top",topScaleHeight),leftScaleDiv.css("top",topScaleHeight),rightScaleDiv.css("top",topScaleHeight)}function titleAndNotTopScale(){var titleHeight=parseFloat(titleDiv.css("height"));legendDiv.css("top",titleHeight),centralDiv.css("top",titleHeight),leftScaleDiv.css("top",titleHeight),rightScaleDiv.css("top",titleHeight)}function notTitleAndNotTopScale(){legendDiv.css("top",0),centralDiv.css("top",0),leftScaleDiv.css("top",0),rightScaleDiv.css("top",0)}function adjustForTitle(){var titleVisible="none"==titleDiv.css("display");plt.axisEnabled(xTop)?titleVisible?topScaleAndTitle():topScaleAndNotTitle():titleVisible?titleAndNotTopScale():notTitleAndNotTopScale()}function adjustForTopScale(){var titleVisible;"none"!==titleDiv.css("display")?plt.axisEnabled(xTop)?topScaleAndTitle():titleAndNotTopScale():plt.axisEnabled(xTop)?topScaleAndNotTitle():notTitleAndNotTopScale()}function bottomScaleAndFooter(){var footerHeight=parseFloat(footerDiv.css("height")),bottomScaleHeight=parseFloat(bottomScaleDiv.css("height"));legendDiv.css("bottom",footerHeight),bottomScaleDiv.css("bottom",footerHeight),centralDiv.css("bottom",footerHeight+bottomScaleHeight),leftScaleDiv.css("bottom",footerHeight+bottomScaleHeight),rightScaleDiv.css("bottom",footerHeight+bottomScaleHeight)}function bottomScaleAndNotFooter(){var bottomScaleHeight=parseFloat(bottomScaleDiv.css("height"));legendDiv.css("bottom",0),bottomScaleDiv.css("bottom",0),centralDiv.css("bottom",bottomScaleHeight),leftScaleDiv.css("bottom",bottomScaleHeight),rightScaleDiv.css("bottom",bottomScaleHeight)}function footerAndNotBottomtScale(){var footerHeight=parseFloat(footerDiv.css("height"));legendDiv.css("bottom",footerHeight),centralDiv.css("bottom",footerHeight),leftScaleDiv.css("bottom",footerHeight),rightScaleDiv.css("bottom",footerHeight)}function notFooterAndNotBottomScale(){legendDiv.css("bottom",0),centralDiv.css("bottom",0),leftScaleDiv.css("bottom",0),rightScaleDiv.css("bottom",0)}function adjustForFooter(){var footerVisible="none"==footerDiv.css("display");plt.axisEnabled(xBottom)?footerVisible?bottomScaleAndFooter():bottomScaleAndNotFooter():footerVisible?footerAndNotBottomtScale():notFooterAndNotBottomScale()}function adjustForBottomScale(){var footerVisible;"none"!=footerDiv.css("display")?plt.axisEnabled(xBottom)?bottomScaleAndFooter():footerAndNotBottomtScale():plt.axisEnabled(xBottom)?bottomScaleAndNotFooter():notFooterAndNotBottomScale()}function rightScaleAndLegend(){var legendWidth=parseFloat(legendDiv.css("width")),rightScaleWidth=parseFloat(rightScaleDiv.css("width"));titleDiv.css("right",legendWidth+rightScaleWidth+14+3),topScaleDiv.css("right",legendWidth+rightScaleWidth+14+3),footerDiv.css("right",legendWidth+rightScaleWidth+14+3),bottomScaleDiv.css("right",legendWidth+rightScaleWidth+14+3),legendDiv.css("right",3),centralDiv.css("right",legendWidth+rightScaleWidth+14+3),rightScaleDiv.css("right",legendWidth+14+3)}function rightScaleAndNotLegend(){var rightScaleWidth=parseFloat(rightScaleDiv.css("width"));titleDiv.css("right",rightScaleWidth),topScaleDiv.css("right",rightScaleWidth),footerDiv.css("right",rightScaleWidth),bottomScaleDiv.css("right",rightScaleWidth),centralDiv.css("right",rightScaleWidth),rightScaleDiv.css("right",0)}function legendAndNotRightScale(){var legendWidth=parseFloat(legendDiv.css("width"));centralDiv.css("right",legendWidth+3+14),titleDiv.css("right",legendWidth+3+14),topScaleDiv.css("right",legendWidth+3+14),footerDiv.css("right",legendWidth+3+14),bottomScaleDiv.css("right",legendWidth+3+14),legendDiv.css("right",3)}function notLegendAndNotRightScale(){titleDiv.css("right",0),topScaleDiv.css("right",0),footerDiv.css("right",0),bottomScaleDiv.css("right",0),centralDiv.css("right",0)}function adjustForLegend(){plt.legend()&&legendDiv.css("width",plt.legend().legendDivWidth()),plt.axisEnabled(yRight)?plt.isLegendEnabled()?rightScaleAndLegend():rightScaleAndNotLegend():plt.isLegendEnabled()?legendAndNotRightScale():notLegendAndNotRightScale()}function adjustForRightScale(){plt.isLegendEnabled()?plt.axisEnabled(yRight)?rightScaleAndLegend():legendAndNotRightScale():plt.axisEnabled(yRight)?rightScaleAndNotLegend():notLegendAndNotRightScale()}function adjustForLeftScale(){var leftScaleWidth=parseFloat(leftScaleDiv.css("width"));plt.axisEnabled(yLeft)?(titleDiv.css("left",leftScaleWidth),topScaleDiv.css("left",leftScaleWidth),footerDiv.css("left",leftScaleWidth),bottomScaleDiv.css("left",leftScaleWidth),centralDiv.css("left",leftScaleWidth)):(titleDiv.css("left",0),topScaleDiv.css("left",0),footerDiv.css("left",0),bottomScaleDiv.css("left",0),centralDiv.css("left",0))}}}define("layout",(function(){}));
/*!
  \brief A abstract base class for drawing scales

  AbstractScaleDraw can be used to draw linear or logarithmic scales.

  After a scale division has been specified as a ScaleDiv object, 
  using setScaleDiv(), the scale can be drawn with the draw() member.
*/
/*!
       Components of a scale
       \sa enableComponent(), hasComponent
    */
class AbstractScaleDraw{constructor(){Static.makeAbstract(this,AbstractScaleDraw);
/*!
		   Components of a scale
		   \sa enableComponent(), hasComponent
		*/
var m_components=Enum.ScaleComponent.Backbone|Enum.ScaleComponent.Ticks|Enum.ScaleComponent.Labels,m_tickLength=[];m_tickLength[MinorTick]=4,m_tickLength[MediumTick]=6,m_tickLength[MajorTick]=8;var m_map=new ScaleMap,m_scaleDiv=null,m_decimalPlaces=4,m_precision=4,m_spacing=4,m_penWidth=1;this.data={},this.precision=function(){return m_precision},this.setPrecision=function(numberOfDigits){m_precision=numberOfDigits},this.decimalPlaces=function(){return m_decimalPlaces},this.setDecimalPlaces=function(places){m_decimalPlaces=places},this.longestLabel=function(){var m_longestLabel="",majorTicks=m_scaleDiv.ticks(MajorTick);return majorTicks.forEach((function(tick,i){0!==i&&i!==majorTicks.length-1&&m_scaleDiv.contains(tick)&&(tick=Static.toPrecision(tick,m_precision)).toString().length>m_longestLabel.length&&(m_longestLabel=tick.toString())})),m_longestLabel}
/*!
        En/Disable a component of the scale

        \param component Scale component
        \param enable On/Off

        \sa hasComponent()
         */,this.enableComponent=function(component,enable){enable?m_components|=component:m_components&=~component}
/*!
        Check if a component is enabled

        \param component Component type
        \return true, when component is enabled
        \sa enableComponent()
         */,this.hasComponent=function(component){return m_components&component}
/*!
        Change the scale division
        \param scaleDiv New scale division
         */,this.setScaleDiv=function(scaleDiv){m_scaleDiv=scaleDiv,m_map.setScaleInterval(m_scaleDiv.lowerBound(),m_scaleDiv.upperBound())}
/*!
        Change the transformation of the scale
        \param transformation New scale transformation
         */,this.setTransformation=function(trans){m_map.setTransformation(trans)},this.scaleMap=function(){return m_map},this.scaleDiv=function(){return m_scaleDiv}
/*!
        \brief Specify the width of the scale pen
        \param width Pen width
        \sa penWidth()
         */,this.setPenWidth=function(width){width<=0&&(width=1),width!==m_penWidth&&(m_penWidth=width)}
/*!
        \return Scale pen width
        \sa setPenWidth()
         */,this.penWidth=function(){return m_penWidth}
/*!
        \brief Draw the scale

        \param painter    The painter

        \param palette    Palette, text color is used for the labels,
        foreground color for ticks and backbone
         */,this.draw=function(painter){if(this.orientation()===Horizontal?m_map.setPaintInterval(0,painter.canvasWidth()):m_map.setPaintInterval(painter.canvasHeight(),0),this.hasComponent(Enum.ScaleComponent.Labels))for(var majorTicks=m_scaleDiv.ticks(MajorTick),i=0;i<majorTicks.length;i++){var v=majorTicks[i];m_scaleDiv.contains(v)&&this.drawLabel(painter,v)}if(this.hasComponent(Enum.ScaleComponent.Ticks)){painter.save(),painter.setPen(new Misc.Pen("grey",m_penWidth));for(var tickType=MinorTick;tickType<NTickTypes;tickType++){var ticks=m_scaleDiv.ticks(tickType);for(i=0;i<ticks.length;i++){var v=ticks[i];m_scaleDiv.contains(v)&&this.drawTick(painter,v,m_tickLength[tickType])}}painter.restore()}this.hasComponent(Enum.ScaleComponent.Backbone)&&(painter.save(),painter.setPen(new Misc.Pen("grey",m_penWidth)),this.drawBackbone(painter),painter.restore())}
/*!
        \brief Set the spacing between tick and labels

        The spacing is the distance between ticks and labels.
        The default spacing is 4 pixels.

        \param spacing Spacing

        \sa spacing()
         */,this.setSpacing=function(spacing){spacing<0&&(spacing=0),m_spacing=spacing}
/*!
        \brief Get the spacing

        The spacing is the distance between ticks and labels.
        The default spacing is 4 pixels.

        \return Spacing
        \sa setSpacing()
         */,this.spacing=function(){return m_spacing}
/*!
        Set the length of the ticks

        \param tickType Tick type
        \param length New length

        \warning the length is limited to [0..1000]
         */,this.setTickLength=function(tickType,length){if(!(tickType<MinorTick||tickType>MajorTick)){length<0&&(length=0);var maxTickLen=1e3;length>1e3&&(length=1e3),m_tickLength[tickType]=length}}
/*!
        \return Length of the ticks
        \sa setTickLength(), maxTickLength()
         */,this.tickLength=function(tickType){return tickType<MinorTick||tickType>MajorTick?0:m_tickLength[tickType]}
/*!
        \return Length of the longest tick

        Useful for layout calculations
        \sa tickLength(), setTickLength()
         */,this.maxTickLength=function(){for(var length=0,i=0;i<NTickTypes;i++)length=Math.max(length,m_tickLength[i]);return length}
/*!
        \brief Convert a value into its representing label

        The value is converted to a plain text using
        QLocale().toString(value).
        This method is often overloaded by applications to have individual
        labels.

        \param value Value
        \return Label string.
         */,this.label=function(value){return Static.mFuzzyCompare(value,_eps)&&(value=0),value.toString()},this.toString=function(){return"[AbstractScaleDraw]"}}}define("abstractScaleDraw",(function(){}));class ScaleDraw extends AbstractScaleDraw{constructor(){super();var m_alignment=BottomScale;
/*!
        Return the orientation

        TopScale, BottomScale are horizontal (Qt::Horizontal) scales,
        LeftScale, RightScale are vertical (Qt::Vertical) scales.

        \return Orientation of the scale

        \sa alignment()
         */this.orientation=function(){return m_alignment===TopScale||m_alignment===BottomScale?Horizontal:Vertical}
/*!
        Return alignment of the scale
        \sa setAlignment()
        \return Alignment of the scale
         */,this.alignment=function(){return m_alignment}
/*!
        Set the alignment of the scale

        \param align Alignment of the scale

        The default alignment is QwtScaleDraw::BottomScale
        \sa alignment()
         */,this.setAlignment=function(align){m_alignment=align}
/*!
        \brief Determine the minimum border distance

        This member function returns the minimum space
        needed to draw the mark labels at the scale's endpoints.

        \param font Font
        \param start Start border distance
        \param end End border distance
         */,this.getBorderDistHint=function(font,startAndEndObj){},this.toString=function(){return"[ScaleDraw]"}
/*!
        Draw a tick

        \param painter Painter
        \param value Value of the tick
        \param len Length of the tick

        \sa drawBackbone(), drawLabel()
         */,this.drawTick=function(painter,value,len){if(!(len<=0)){var bwAdjust=0,tval=this.scaleMap().transform(value)+0,bb=this.hasComponent(Enum.ScaleComponent.Backbone);switch(this.alignment()){case LeftScale:var x1=painter.canvasWidth();bb&&(x1-=2);var x2=x1-len;painter.drawLine(x1,tval,x2,tval);break;case RightScale:var x1=0;bb&&(x1+=2);var x2=x1+len;painter.drawLine(x1,tval,x2,tval);break;case BottomScale:var y1=0;bb&&(y1+=2);var y2=y1+len;painter.drawLine(tval,y1,tval,y2);break;case TopScale:var y1=painter.canvasHeight();bb&&(y1-=2);var y2=y1-len;painter.drawLine(tval,y1,tval,y2)}}}
/*!
        Draws the baseline of the scale
        \param painter Painter

        \sa drawTick(), drawLabel()
         */,this.drawBackbone=function(painter){var off=.5*painter.pen().width,bb=this.hasComponent(Enum.ScaleComponent.Backbone);switch(this.alignment()){case LeftScale:var x=painter.canvasWidth()-off;bb&&(x-=2),painter.drawLine(x,0,x,painter.canvasHeight());break;case RightScale:var x=off;bb&&(x+=2),painter.drawLine(x,0,x,painter.canvasHeight());break;case TopScale:var y=painter.canvasHeight()-off;bb&&(y-=2),painter.drawLine(0,y,painter.canvasWidth(),y);break;case BottomScale:var y=off;bb&&(y+=2),painter.drawLine(0,y,painter.canvasWidth(),y)}}
/*!
        Find the position, where to paint a label

        The position has a distance that depends on the length of the ticks
        in direction of the alignment().

        \param value Value
        \return Position, where to paint a label
         */,this.labelPosition=function(ctx,value){ctx.save();var tval=this.scaleMap().transform(value),dist=this.spacing();this.hasComponent(Enum.ScaleComponent.Backbone)&&(dist+=1),this.hasComponent(Enum.ScaleComponent.Ticks)&&(dist+=this.tickLength(MajorTick));var bwAdjust=0,px=0,py=0,th=ctx.measureText("M").width;switch(this.alignment()){case RightScale:px=dist,py=tval+.5*th+0;break;case LeftScale:px=ctx.canvas.width-dist,py=tval+.5*th+0;break;case BottomScale:px=tval+0,py=dist+th;break;case TopScale:px=tval+0,py=ctx.canvas.height-dist}return ctx.restore(),new Misc.Point(px,py)}
/*!
        Draws the label for a major scale tick

        \param painter Painter
        \param value Value

        \sa drawTick(), drawBackbone(), boundingLabelRect()
         */,this.drawLabel=function(painter,value){value=Static.toPrecision(value,this.precision());var lbl=this.label(value);if(""!==lbl){var pos=this.labelPosition(painter.context(),value);if(this.orientation()!=Horizontal||0!==pos.x&&pos.x!=painter.canvasWidth()){var tsz=painter.textSize(lbl),th=tsz.height;if(this.orientation()!=Vertical||!(Math.abs(pos.y-.5*th-0)<th||Math.abs(pos.y-.5*th-painter.canvasHeight())<th)){var alignment="center",maxTextLength="undefined";if(this.alignment()===LeftScale)alignment="right",maxTextLength="undefined";else if(this.alignment()===RightScale)alignment="left",maxTextLength="undefined";else{maxTextLength=painter.canvasWidth()/(this.scaleDiv().ticks(MajorTick).length-1)-5;var textWidth=tsz.width;if(textWidth>maxTextLength&&(textWidth=maxTextLength),pos.x-textWidth/2<0||pos.x+textWidth/2>painter.canvasWidth())return}painter.drawText(lbl,pos.x,pos.y,alignment,maxTextLength)}}}}}}
/*!
Ceil a value, relative to an interval

param value Value to be ceiled
param intervalSize Interval size

return Rounded value

floorEps()
 */
function ceilEps(value,intervalSize){var eps;return value=(value-_eps*intervalSize)/intervalSize,Math.ceil(value)*intervalSize}
/*!
Floor a value, relative to an interval

param value Value to be floored
param intervalSize Interval size

return Rounded value
sa floorEps()
 */function floorEps(value,intervalSize){var eps;return value=(value+_eps*intervalSize)/intervalSize,Math.floor(value)*intervalSize}
/*!
Divide an interval into steps

stepSize = (intervalSize - intervalSize * 10e^{-6}) / numSteps\f$

param intervalSize Interval size
param numSteps Number of steps
return Step size
 */function divideEps(intervalSize,numSteps){return 0===numSteps||0===intervalSize?0:(intervalSize-_eps*intervalSize)/numSteps}define("scaleDraw",["static","abstractScaleDraw"],(function(){})),Static.mLog=function(base,value){return Math.log(value)/Math.log(base)},Static.mLogInterval=function(base,interval){return new Interval(Static.mLog(base,interval.minValue()),Static.mLog(base,interval.maxValue()))},Static.mPowInterval=function(base,interval){return new Interval(Math.pow(base,interval.minValue()),Math.pow(base,interval.maxValue()))},Static.mStepSize=function(intervalSize,maxSteps,base){if(maxSteps<=0)return 0;if(maxSteps>2)for(var numSteps=maxSteps;numSteps>1;numSteps--)for(var stepSize=intervalSize/numSteps,p=Math.floor(Math.log(stepSize)/Math.log(base)),fraction=Math.pow(base,p),n=base;n>1;n/=2){if(Static.mFuzzyCompare(stepSize,n*fraction))return stepSize;if(3===n&&base%2==0&&Static.mFuzzyCompare(stepSize,2*fraction))return stepSize}return.5*intervalSize},Static.divideInterval=function(intervalSize,numSteps,base){if(numSteps<=0)return 0;var v=divideEps(intervalSize,numSteps);if(0===v)return 0;for(var lx=Static.mLog(base,Math.abs(v)),p=Math.floor(lx),fraction=Math.pow(base,lx-p),n=base;n>1&&fraction<=n/2;)n/=2;var stepSize=n*Math.pow(base,p);return v<0&&(stepSize=-stepSize),stepSize};class ScaleEngine{constructor(bs){var m_base=10,m_lowerMargin=0,m_upperMargin=0;void 0!==bs&&(m_base=bs);var m_transform=null,m_referenceValue=0;
/*!
		\return the margin at the lower end of the scale
		The default margin is 0.

		\sa setMargins()
		 */
this.lowerMargin=function(){return m_lowerMargin}
/*!
		\return the margin at the upper end of the scale
		The default margin is 0.

		\sa setMargins()
		 */,this.upperMargin=function(){return m_upperMargin}
/*!
		\brief Specify margins at the scale's endpoints
		\param lower minimum distance between the scale's lower boundary and the
		smallest enclosed value
		\param upper minimum distance between the scale's upper boundary and the
		greatest enclosed value

		Margins can be used to leave a minimum amount of space between
		the enclosed intervals and the boundaries of the scale.

		\warning
		\li QwtLogScaleEngine measures the margins in decades.

		\sa upperMargin(), lowerMargin()
		 */,this.setMargins=function(lower,upper){m_lowerMargin=Math.max(lower,0),m_upperMargin=Math.max(upper,0)}
/*!
		Assign a transformation

		param transform Transformation

		The transformation object is used as factory for clones
		that are returned by transformation()

		The scale engine takes ownership of the transformation.

		QwtTransform::copy(), transformation()

		 */,this.setTransformation=function(transform){transform!==m_transform&&(m_transform=transform)}
/*!
		Create and return a clone of the transformation
		of the engine. When the engine has no special transformation
		NULL is returned, indicating no transformation.

		return A clone of the transfomation
		setTransformation()
		 */,this.transformation=function(){var transform=null;return m_transform&&(transform=m_transform.copy()),transform}
/*!
		Calculate a step size for an interval size

		param intervalSize Interval size
		param numSteps Number of steps

		return Step size
		 */,this.divideInterval=function(intervalSize,numSteps){return Static.divideInterval(intervalSize,numSteps,m_base)}
/*!
		Check if an interval "contains" a value

		param interval Interval
		param value Value

		return True, when the value is inside the interval
		 */,this.contains=function(interval,value){return!!interval.isValid()&&(!(Static.m3FuzzyCompare(value,interval.minValue(),interval.width())<0)&&!(Static.m3FuzzyCompare(value,interval.maxValue(),interval.width())>0))}
/*!
		Remove ticks from a list, that are not inside an interval

		param ticks Tick list
		param interval Interval

		return Stripped tick list
		 */,this.strip=function(ticks,interval){if(!interval.isValid()||0===ticks.length)return[];if(this.contains(interval,ticks[0])&&this.contains(interval,ticks[ticks.length-1]))return ticks;for(var strippedTicks=[],i=0;i<ticks.length;i++)this.contains(interval,ticks[i])&&strippedTicks.push(ticks[i]);return strippedTicks}
/*!
		brief Build an interval around a value

		In case of v == 0.0 the interval is [-0.5, 0.5],
		otherwide it is [0.5 * v, 1.5 * v]

		param value Initial value
		return Calculated interval
		 */,this.buildInterval=function(value){var delta=0===value?.5:Math.abs(.5*value);return Number.MAX_VALUE-delta<value?new Interval(Number.MAX_VALUE-delta,Number.MAX_VALUE):-Number.MAX_VALUE+delta>value?new Interval(-Number.MAX_VALUE,-Number.MAX_VALUE+delta):new Interval(value-delta,value+delta)}
/*!
		Set the base of the scale engine

		While a base of 10 is what 99.9% of all applications need
		certain scales might need a different base: f.e 2

		The default setting is 10

		param base Base of the engine

		base()
		 */,this.setBase=function(base){m_base=Math.max(base,2)}
/*!
		return base Base of the scale engine
		setBase()
		 */,this.base=function(){return m_base}
/*!
		\brief Specify a reference point
		\param r new reference value

		The reference point is needed if options IncludeReference or
		Symmetric are active. Its default value is 0.0.

		\sa Attribute
		 */,this.setReference=function(r){m_referenceValue=r}
/*!
		\return the reference value
		\sa setReference(), setAttribute()
		 */,this.reference=function(){return m_referenceValue}}toString(){return"[ScaleEngine]"}}class LinearScaleEngine extends ScaleEngine{constructor(bs){super(bs),
/*!
	Align and divide an interval

	\param maxNumSteps Max. number of steps
	\param x1 First limit of the interval (In/Out)
	\param x2 Second limit of the interval (In/Out)
	\param stepSize Step size (Out)

	\sa setAttribute()
	 */
this.autoScale=function(maxNumSteps,xValueObject,stepSize){var interval=new Interval(xValueObject.x1,xValueObject.x2);(interval=interval.normalized()).setMinValue(interval.minValue()-this.lowerMargin()),interval.setMaxValue(interval.maxValue()+this.upperMargin()),0===interval.width()&&(interval=this.buildInterval(interval.minValue())),stepSize=Static.divideInterval(interval.width(),Math.max(maxNumSteps,1),this.base()),xValueObject.x1=interval.minValue(),xValueObject.x2=interval.maxValue()}
/*!
	\brief Calculate a scale division for an interval

	\param x1 First interval limit
	\param x2 Second interval limit
	\param maxMajorSteps Maximum for the number of major steps
	\param maxMinorSteps Maximum number of minor steps
	\param stepSize Step size. If stepSize == 0, the engine
	calculates one.

	\return Calculated scale division
	 */,this.divideScale=function(x1,x2,maxMajorSteps,maxMinorSteps,stepSize){void 0===stepSize&&(stepSize=0);var interval=new Interval(x1,x2).normalized();if(interval.width()<=0)return new ScaleDiv;0===(stepSize=Math.abs(stepSize))&&(maxMajorSteps<1&&(maxMajorSteps=1),stepSize=Static.divideInterval(interval.width(),maxMajorSteps,this.base()));var scaleDiv=new ScaleDiv;if(0!==stepSize){var ticks=[];this.buildTicks(interval,stepSize,maxMinorSteps,ticks),scaleDiv=new ScaleDiv(interval,ticks)}return x1>x2&&scaleDiv.invert(),scaleDiv}
/*!
	\brief Calculate ticks for an interval

	\param interval Interval
	\param stepSize Step size
	\param maxMinorSteps Maximum number of minor steps
	\param ticks Arrays to be filled with the calculated ticks

	\sa buildMajorTicks(), buildMinorTicks
	 */,this.buildTicks=function(interval,stepSize,maxMinorSteps,ticks){var boundingInterval=this.align(interval,stepSize);if(ticks[MajorTick]=this.buildMajorTicks(boundingInterval,stepSize),maxMinorSteps>0){var minorTicks=[],mediumTicks=[];this.buildMinorTicks(ticks[MajorTick],maxMinorSteps,stepSize,minorTicks,mediumTicks),ticks[MinorTick]=minorTicks,ticks[MediumTick]=mediumTicks}for(var i=0;i<NTickTypes;i++){var obj=this.strip(ticks[i],interval);ticks[i]=[],ticks[i]=obj;for(var j=0;j<ticks[i].length;j++)0===Static.m3FuzzyCompare(ticks[i][j],0,stepSize)&&(ticks[i][j]=0)}}
/*!
	\brief Calculate major ticks for an interval

	\param interval Interval
	\param stepSize Step size

	\return Calculated ticks
	 */,this.buildMajorTicks=function(interval,stepSize){var numTicks=Math.round(interval.width()/stepSize)+1;numTicks>1e4&&(numTicks=1e4);var ticks=[];ticks.push(interval.minValue());for(var i=1;i<numTicks-1;i++)ticks.push(interval.minValue()+i*stepSize);return ticks.push(interval.maxValue()),ticks}
/*!
	\brief Calculate minor/medium ticks for major ticks

	\param majorTicks Major ticks
	\param maxMinorSteps Maximum number of minor steps
	\param stepSize Step size
	\param minorTicks Array to be filled with the calculated minor ticks
	\param mediumTicks Array to be filled with the calculated medium ticks

	 */,this.buildMinorTicks=function(majorTicks,maxMinorSteps,stepSize,minorTicks,mediumTicks){var minStep=Static.mStepSize(stepSize,maxMinorSteps,this.base());if(0!==minStep){var numTicks=Math.ceil(Math.abs(stepSize/minStep))-1,medIndex=-1;numTicks%2&&(medIndex=numTicks/2);for(var i=0;i<majorTicks.length;i++)for(var val=majorTicks[i],k=0;k<numTicks;k++){var alignedValue=val+=minStep;0===Static.m3FuzzyCompare(val,0,stepSize)&&(alignedValue=0),k==medIndex?mediumTicks.push(alignedValue):minorTicks.push(alignedValue)}}}
/*!
	\brief Align an interval to a step size

	The limits of an interval are aligned that both are integer
	multiples of the step size.

	\param interval Interval
	\param stepSize Step size

	\return Aligned interval
	 */,this.align=function(interval,stepSize){var x1=interval.minValue(),x2=interval.maxValue();if(-Number.MAX_VALUE+stepSize<=x1){var x=floorEps(x1,stepSize);0!==Static.m3FuzzyCompare(x1,x,stepSize)&&(x1=x)}if(Number.MAX_VALUE-stepSize>=x2){var x=ceilEps(x2,stepSize);0!==Static.m3FuzzyCompare(x2,x,stepSize)&&(x2=x)}return new Interval(x1,x2)}}toString(){return"[LinearScaleEngine]"}}class LogScaleEngine extends ScaleEngine{constructor(bs){super(bs),this.setTransformation(new LogTransform),
/*!
	Align and divide an interval

	\param maxNumSteps Max. number of steps
	\param x1 First limit of the interval (In/Out)
	\param x2 Second limit of the interval (In/Out)
	\param stepSize Step size (Out)

	\sa QwtScaleEngine::setAttribute()
	 */
this.autoScale=function(maxNumSteps,xValueObject,stepSize){var logBase=this.base(),interval=new Interval(xValueObject.x1/Math.pow(logBase,this.lowerMargin()),xValueObject.x2*Math.pow(logBase,this.upperMargin()));if(interval.maxValue()/interval.minValue()<logBase){var linearScaler=new LinearScaleEngine;linearScaler.setReference(this.reference()),linearScaler.setMargins(this.lowerMargin(),this.upperMargin()),linearScaler.autoScale(maxNumSteps,xValueObject,stepSize);var linearInterval=new Interval(xValueObject.x1,xValueObject.x2);if(linearInterval.normalized(),(linearInterval=linearInterval.limited(1e-100,1e100)).maxValue()/linearInterval.minValue()<logBase)return void(stepSize=stepSize<0?-Static.mLog(logBase,Math.abs(stepSize)):Static.mLog(logBase,stepSize))}var logRef=1;this.reference()>5e-101&&(logRef=Math.min(this.reference(),5e99)),0==(interval=interval.limited(1e-100,1e100)).width()&&(interval=this.buildInterval(interval.minValue())),(stepSize=Static.divideInterval(Static.mLogInterval(logBase,interval).width(),Math.max(maxNumSteps,1)))<1&&(stepSize=1),xValueObject.x1=interval.minValue(),xValueObject.x2=interval.maxValue()}
/*!
	\brief Calculate a scale division for an interval

	\param x1 First interval limit
	\param x2 Second interval limit
	\param maxMajorSteps Maximum for the number of major steps
	\param maxMinorSteps Maximum number of minor steps
	\param stepSize Step size. If stepSize == 0, the engine
	calculates one.

	\return Calculated scale division
	 */,this.divideScale=function(x1,x2,maxMajorSteps,maxMinorSteps,stepSize){var interval=new Interval(x1,x2);if(interval.normalized(),(interval=interval.limited(1e-100,1e100)).width()<=0)return new ScaleDiv;var logBase=this.base();if(interval.maxValue()/interval.minValue()<logBase){var linearScaler=new LinearScaleEngine;return linearScaler.setReference(this.reference()),linearScaler.setMargins(this.lowerMargin(),this.upperMargin()),0!=stepSize&&(stepSize=stepSize<0?-Math.pow(logBase,-stepSize):Math.pow(logBase,stepSize)),linearScaler.divideScale(x1,x2,maxMajorSteps,maxMinorSteps,stepSize)}0==(stepSize=Math.abs(stepSize))&&(maxMajorSteps<1&&(maxMajorSteps=1),(stepSize=Static.divideInterval(Static.mLogInterval(logBase,interval).width(),maxMajorSteps,this.base()))<1&&(stepSize=1));var scaleDiv=new ScaleDiv;if(0!=stepSize){var ticks=[];this.buildTicks(interval,stepSize,maxMinorSteps,ticks),scaleDiv=new ScaleDiv(interval,ticks)}return x1>x2&&scaleDiv.invert(),scaleDiv}
/*!
	\brief Calculate ticks for an interval

	\param interval Interval
	\param maxMinorSteps Maximum number of minor steps
	\param stepSize Step size
	\param ticks Arrays to be filled with the calculated ticks

	\sa buildMajorTicks(), buildMinorTicks
	 */,this.buildTicks=function(interval,stepSize,maxMinorSteps,ticks){var boundingInterval=this.align(interval,stepSize);if(ticks[MajorTick]=this.buildMajorTicks(boundingInterval,stepSize),maxMinorSteps>0){var minorTicks=[],mediumTicks=[];this.buildMinorTicks(ticks[MajorTick],maxMinorSteps,stepSize,minorTicks,mediumTicks),ticks[MinorTick]=minorTicks,ticks[MediumTick]=mediumTicks}for(var i=0;i<NTickTypes;i++){var obj=this.strip(ticks[i],interval);ticks[i]=[],ticks[i]=obj;for(var j=0;j<ticks[i].length;j++)0===Static.m3FuzzyCompare(ticks[i][j],0,stepSize)&&(ticks[i][j]=0)}}
/*!
	\brief Calculate major ticks for an interval

	\param interval Interval
	\param stepSize Step size

	\return Calculated ticks
	 */,this.buildMajorTicks=function(interval,stepSize){var width=Static.mLogInterval(this.base(),interval).width(),numTicks=Math.round(width/stepSize)+1;numTicks>1e4&&(numTicks=1e4);var lxmin=Math.log(interval.minValue()),lxmax,lstep=(Math.log(interval.maxValue())-lxmin)/(numTicks-1),ticks=[];ticks.push(interval.minValue());for(var i=1;i<numTicks-1;i++)ticks.push(Math.exp(lxmin+i*lstep));return ticks.push(interval.maxValue()),ticks}
/*!
	\brief Calculate minor/medium ticks for major ticks

	\param majorTicks Major ticks
	\param maxMinorSteps Maximum number of minor steps
	\param stepSize Step size
	\param minorTicks Array to be filled with the calculated minor ticks
	\param mediumTicks Array to be filled with the calculated medium ticks
	 */,this.buildMinorTicks=function(majorTicks,maxMinorSteps,stepSize,minorTicks,mediumTicks){var logBase=this.base();if(stepSize<1.1){var minStep;if(0==(minStep=this.divideInterval(stepSize,maxMinorSteps+1)))return;var numSteps=Math.round(stepSize/minStep),mediumTickIndex=-1;for(numSteps>2&&numSteps%2==0&&(mediumTickIndex=numSteps/2),i=0;i<majorTicks.length-1;i++){var v=majorTicks[i],s=logBase/numSteps;if(s>=1)for(j=2;j<numSteps;j++)minorTicks.push(v*j*s);else for(j=1;j<numSteps;j++){var tick=v+j*v*(logBase-1)/numSteps;j==mediumTickIndex?mediumTicks.push(tick):minorTicks.push(tick)}}}else{var minStep;if(0==(minStep=this.divideInterval(stepSize,maxMinorSteps)))return;minStep<1&&(minStep=1);var numTicks=Math.round(stepSize/minStep)-1;if(Static.m3FuzzyCompare((numTicks+1)*minStep,stepSize,stepSize)>0&&(numTicks=0),numTicks<1)return;var mediumTickIndex=-1;numTicks>2&&numTicks%2&&(mediumTickIndex=numTicks/2);for(var minFactor=Math.max(Math.pow(logBase,minStep),logBase),i=0;i<majorTicks.length;i++)for(var tick=majorTicks[i],j=0;j<numTicks;j++)tick*=minFactor,j==mediumTickIndex?mediumTicks.push(tick):minorTicks.push(tick)}}
/*!
	\brief Align an interval to a step size

	The limits of an interval are aligned that both are integer
	multiples of the step size.

	\param interval Interval
	\param stepSize Step size

	\return Aligned interval
	 */,this.align=function(interval,stepSize){var intv=Static.mLogInterval(this.base(),interval),x1=floorEps(intv.minValue(),stepSize);0==Static.m3FuzzyCompare(interval.minValue(),x1,stepSize)&&(x1=interval.minValue());var x2=ceilEps(intv.maxValue(),stepSize);return 0==Static.m3FuzzyCompare(interval.maxValue(),x2,stepSize)&&(x2=interval.maxValue()),Static.mPowInterval(this.base(),new Interval(x1,x2))}}toString(){return"[LogScaleEngine]"}}function PointMapper(){var m_flags=0,m_boundingRect=new Misc.Rect;
/*!
	Set a bounding rectangle for the point mapping algorithm

	A valid bounding rectangle can be used for optimizations

	\param rect Bounding rectangle
	\sa boundingRect()
	 */
this.setBoundingRect=function(rect){m_boundingRect=rect}
/*!
	\return Bounding rectangle
	\sa setBoundingRect()
	 */,this.boundingRect=function(){return m_boundingRect}
/*!
	Modify a flag affecting the transformation process

	\param flag Flag type
	\param on Value

	\sa flag(), setFlags()
	 */,this.setFlag=function(flag,on){on?m_flags|=flag:m_flags&=~flag}
/*!
	\return True, when the flag is set
	\param flag Flag type
	\sa setFlag(), setFlags()
	 */,this.testFlag=function(flag){return m_flags&flag}
/*!
	\brief Translate a series of points into a QPolygonF

	When the WeedOutPoints flag is enabled consecutive points,
	that are mapped to the same position will be one point.

	When RoundPoints is set all points are rounded to integers
	but returned as PolygonF - what only makes sense
	when the further processing of the values need a QPolygonF.

	\param xMap x map
	\param yMap y map
	\param series Series of points to be mapped
	\param from Index of the first point to be painted
	\param to Index of the last point to be painted

	\return Translated polygon
	 */,this.toPolygonF=function(xMap,yMap,series,from,to){var polyline=[];return polyline=m_flags&WeedOutPoints?m_flags&RoundPoints?mToPolylineFiltered(xMap,yMap,series,from,to,!0):mToPolylineFiltered(xMap,yMap,series,from,to,!1):m_flags&RoundPoints?Static.mToPoints(new Misc.Rect(0,0,-1,-1),xMap,yMap,series,from,to,!0):Static.mToPoints(new Misc.Rect(0,0,-1,-1),xMap,yMap,series,from,to,!1)}
/*!
	\brief Translate a series into a QPolygonF

	- WeedOutPoints & RoundPoints & boundingRect().isValid()
	All points that are mapped to the same position
	will be one point. Points outside of the bounding
	rectangle are ignored.

	- WeedOutPoints & RoundPoints & !boundingRect().isValid()
	All consecutive points that are mapped to the same position
	will one point

	- WeedOutPoints & !RoundPoints
	All consecutive points that are mapped to the same position
	will one point

	- !WeedOutPoints & boundingRect().isValid()
	Points outside of the bounding rectangle are ignored.

	When RoundPoints is set all points are rounded to integers
	but returned as PolygonF - what only makes sense
	when the further processing of the values need a QPolygonF.

	\param xMap x map
	\param yMap y map
	\param series Series of points to be mapped
	\param from Index of the first point to be painted
	\param to Index of the last point to be painted

	\return Translated polygon
	 */,this.toPointsF=function(xMap,yMap,series,from,to){var points;return points=m_flags&WeedOutPoints?m_flags&RoundPoints?m_boundingRect.left()<=m_boundingRect.right()&&m_boundingRect.top()<=m_boundingRect.bottom()?Static.mToPointsFiltered(m_boundingRect,xMap,yMap,series,from,to):mToPolylineFiltered(xMap,yMap,series,from,to,!0):Static.mToPolylineFiltered(xMap,yMap,series,from,to,!1):m_flags&RoundPoints?Static.mToPoints(m_boundingRect,xMap,yMap,series,from,to,!0):Static.mToPoints(m_boundingRect,xMap,yMap,series,from,to,!1)}}define("scaleEngine",["static"],(function(){})),Static.mToPolylineFiltered=function(xMap,yMap,series,from,to,round){var points=[],sample0=series.sample(from);points[0]=new Misc.Point(Math.round(xMap.transform(sample0.x)),Math.round(yMap.transform(sample0.y)));for(var pos=0,i=from+1;i<=to;i++){var sample=series.sample(i),p;p=round?new Misc.Point(Math.round(xMap.transform(sample.x)),Math.round(yMap.transform(sample.y))):new Misc.Point(xMap.transform(sample.x),yMap.transform(sample.y)),points[pos].x===p.x&&points[pos].y===p.y||(points[++pos]=p)}return points},Static.mToPoints=function(boundingRect,xMap,yMap,series,from,to,round){var points=[],numPoints=0;if(boundingRect.left()<=boundingRect.right()&&boundingRect.top()<=boundingRect.bottom())for(i=from;i<=to;i++){var sample=series.sample(i),x=xMap.transform(sample.x),y=yMap.transform(sample.y);x>=boundingRect.left()&&x<=boundingRect.right()&&y>=boundingRect.top()&&y<=boundingRect.bottom()&&(round?points.push(new Misc.Point(Math.round(x),Math.round(y))):points.push(new Misc.Point(x,y)),numPoints++)}else for(var i=from;i<=to;i++){var sample=series.sample(i),x=xMap.transform(sample.x)-1,y=yMap.transform(sample.y)-1;round?points.push(new Misc.Point(Math.round(x),Math.round(y))):points.push(new Misc.Point(x,y)),numPoints++}return points},PointMapper.prototype.toString=function(){return"[PointMapper]"},define("pointMapper",["static"],(function(){}));class AxisData{constructor(){this.axisName="",this.isEnabled=!1,this.doAutoScale=!0,this.minValue,this.maxValue,this.stepSize,this.maxMajor,this.maxMinor,this.isValid=!0,this.scaleDiv=null,this.scaleEngine=null,this.scaleWidget=null,this.scaleDomDiv=null,this.canvas=null}toString(){return"[AxisData]"}}class Plot{constructor(_plotDiv,pTitle){var plotDiv;plotDiv=_plotDiv||$("#plotDiv");var self=this,m_plotItemStore=[],d_axisData=[],m_sidebarVisible=!1,_title="",m_footer="",legendEnable=!1,m_cursor="",m_defaultCursor="",m_autoReplot=!1,m_legend=null,m_legendFont=new Misc.Font;this.zoomer=null,this.panner=null,this.isSidebarVisible=function(){return m_sidebarVisible},Static.bind("showSidebar",(function(e,on){m_sidebarVisible=on})),this.setLegendFont=function(font){m_legendFont=font},this.legendFont=function(){return m_legendFont},this.autoRefresh=function(){m_autoReplot&&this.replot()},
/*!
        \brief Set or reset the autoReplot option

        If the autoReplot option is set, the plot will be
        updated implicitly by manipulating member functions.
        Since this may be time-consuming, it is recommended
        to leave this option switched off and call replot()
        explicitly if necessary.

        The autoReplot option is set to false by default, which
        means that the user has to call replot() in order to make
        changes visible.
        \param tf \c true or \c false. Defaults to \c true.
        \sa replot()
         */
this.setAutoReplot=function(tf){m_autoReplot=tf},
/*!
        \return true if the autoReplot option is set.
        \sa setAutoReplot()
         */
this.autoReplot=function(){return m_autoReplot},this.plotItemStore=function(){return m_plotItemStore};var m_titleFont=new Misc.Font(12),m_footerFont=new Misc.Font(12),layout=new Layout(plotDiv,this);this.getLayout=function(){return layout},
/*!
        \brief Return the current interval of the specified axis

        This is only a convenience function for axisScaleDiv( axisId )->interval();

        \param axisId Axis index
        \return Scale interval

        \sa QwtScaleDiv, axisScaleDiv()
         */
this.axisInterval=function(axisId){return this.axisValid(axisId)?d_axisData[axisId].scaleDiv.interval():new Interval},this.setAxisPrecision=function(axisId,places){this.axisValid(axisId)&&(this.axisScaleDraw(axisId).setPrecision(places),this.autoRefresh())},this.setAxisDecimalPlaces=function(axisId,places){this.axisValid(axisId)&&(this.axisScaleDraw(axisId).setDecimalPlaces(places),this.autoRefresh())},this.axisPrecision=function(axisId){return this.axisValid(axisId)?this.axisScaleDraw(axisId).precision():3},this.axisDecimalPlaces=function(axisId){return this.axisValid(axisId)?this.axisScaleDraw(axisId).decimalPlaces():3};var centralWidget=new Widget(layout.getCentralDiv()),titleWidget=new Widget(layout.getTitleDiv()),footerWidget=new Widget(layout.getFooterDiv());centralWidget.setEnabled_1(!0),centralWidget.plot=this,this.getCentralWidget=function(){return centralWidget},this.getTitleWidget=function(){return titleWidget},this.getFooterWidget=function(){return footerWidget},this.initAxesData=function(){var axisId;for(axisId=0;axisId<axisCnt;axisId++)d_axisData[axisId]=new AxisData;for(d_axisData[yLeft].axisName="AxisYLeft",d_axisData[yRight].axisName="AxisYRight",d_axisData[xTop].axisName="AxisXTop",d_axisData[xBottom].axisName="AxisXBottom",d_axisData[yLeft].scaleWidget=new ScaleWidget(this,layout.getScaleDivElement(yLeft),LeftScale),d_axisData[yRight].scaleWidget=new ScaleWidget(this,layout.getScaleDivElement(yRight),RightScale),d_axisData[xTop].scaleWidget=new ScaleWidget(this,layout.getScaleDivElement(xTop),TopScale),d_axisData[xBottom].scaleWidget=new ScaleWidget(this,layout.getScaleDivElement(xBottom),BottomScale),axisId=0;axisId<axisCnt;axisId++){var d=d_axisData[axisId];d.scaleEngine=new LinearScaleEngine,d.scaleWidget.setTransformation(d.scaleEngine.transformation()),d.doAutoScale=!0,d.minValue=0,d.maxValue=1e3,d.stepSize=0,d.maxMinor=5,d.maxMajor=8,d.isValid=!1}d_axisData[yLeft].isEnabled=!0,d_axisData[yRight].isEnabled=!0,d_axisData[xBottom].isEnabled=!0,d_axisData[xTop].isEnabled=!0},this.axisMaxMinor=function(axisId){return this.axisValid(axisId)?d_axisData[axisId].maxMinor:0},this.axisMaxMajor=function(axisId){return this.axisValid(axisId)?d_axisData[axisId].maxMajor:0},
/*!
        Set the maximum number of minor scale intervals for a specified axis

        \param axisId Axis index
        \param maxMinor Maximum number of minor steps

        \sa axisMaxMinor()
         */
this.setAxisMaxMinor=function(axisId,maxMinor){if(this.axisValid(axisId)){var maxMinor=Static.qBound(0,maxMinor,100),d=d_axisData[axisId];maxMinor!=d.maxMinor&&(d.maxMinor=maxMinor,d.isValid=!1,this.autoRefresh())}},
/*!
        Set the maximum number of major scale intervals for a specified axis

        \param axisId Axis index
        \param maxMajor Maximum number of major steps

        \sa axisMaxMajor()
         */
this.setAxisMaxMajor=function(axisId,maxMajor){if(this.axisValid(axisId)){var maxMajor=Static.qBound(1,maxMajor,1e4),d=d_axisData[axisId];maxMajor!=d.maxMajor&&(d.maxMajor=maxMajor,d.isValid=!1,this.autoRefresh())}},
/*!
        \return \c true if the specified axis exists, otherwise \c false
        \param axisId axis index
         */
this.axisValid=function(axisId){return axisId>=yLeft&&axisId<axisCnt},
/*!
        Change the scale engine for an axis

        \param axisId Axis index
        \param scaleEngine Scale engine

        \sa axisScaleEngine()
         */
this.setAxisScaleEngine=function(axisId,engine){if(this.axisValid(axisId)&&null!==engine){var d=d_axisData[axisId];d.scaleEngine=engine,d_axisData[axisId].scaleWidget.setTransformation(engine.transformation()),d.isValid=!1,this.autoRefresh()}},
/*!
        \return the plot's legend
        \sa insertLegend()
         */
this.legend=function(){return m_legend},this.setLegend=function(legend){m_legend!==legend&&(m_legend=legend).setPlot(this)},this.insertLegend=function(legend){(m_legend=legend).setLegendDiv(layout.getLegendDiv()),m_legend.setPlot(this);for(var i=0;i<m_plotItemStore.length;++i)this.insertLegendItem(m_plotItemStore[i]);Static.trigger("legendInserted",m_legend)},this.insertLegendItem=function(plotItem,rowNumber){null!==m_legend&&null!=plotItem&&(plotItem.testItemAttribute(Legend)&&m_legend.addItem(plotItem,rowNumber),m_legend.isEmpty()||legendEnable&&m_legend.legendDiv().show())},this.removeLegendItem=function(plotItem){if(null!==m_legend){var rowNumber=m_legend.removeItem(plotItem);return m_legend.isEmpty()&&m_legend.legendDiv().hide(),rowNumber}},
/*!
        Emit legendDataChanged() for a plot item

        \param plotItem Plot item
        \sa QwtPlotItem::legendData(), legendDataChanged()
         */
this.updateLegend=function(plotItem){if(null!=plotItem&&plotItem.testItemAttribute(Legend)){var rowNumber=this.removeLegendItem(plotItem);this.insertLegendItem(plotItem,rowNumber)}},
/*!
        \param axisId Axis index
        \return Scale engine for a specific axis
         */
this.axisScaleEngine=function(axisId){return this.axisValid(axisId)?d_axisData[axisId].scaleEngine:null},
/*!
        \brief Enable autoscaling for a specified axis

        This member function is used to switch back to autoscaling mode
        after a fixed scale has been set. Autoscaling is enabled by default.

        \param axisId Axis index
        \param on On/Off
        \sa setAxisScale(), setAxisScaleDiv(), updateAxes()

        \note The autoscaling flag has no effect until updateAxes() is executed
        ( called by replot() ).
         */
this.setAxisAutoScale=function(axisId,on){this.axisValid(axisId)&&d_axisData[axisId].doAutoScale!==on&&(d_axisData[axisId].doAutoScale=on,Static.trigger("autoScaleChanged",on),this.autoRefresh())},
/*!
        \return \c True, if autoscaling is enabled
        \param axisId Axis index
         */
this.axisAutoScale=function(axisId){return!!this.axisValid(axisId)&&d_axisData[axisId].doAutoScale},
/*!
        \brief Disable autoscaling and specify a fixed scale for a selected axis.

        In updateAxes() the scale engine calculates a scale division from the
        specified parameters, that will be assigned to the scale widget. So
        updates of the scale widget usually happen delayed with the next replot.

        \param axisId Axis index
        \param min Minimum of the scale
        \param max Maximum of the scale
        \param stepSize Major step size. If <code>step == 0</code>, the step size is
        calculated automatically using the maxMajor setting.

        \sa setAxisMaxMajor(), setAxisAutoScale(), axisStepSize(), QwtScaleEngine::divideScale()
         */
this.setAxisScale=function(axisId,min,max,stepSize){var step=0;if(void 0!==stepSize&&(step=stepSize),this.axisValid(axisId)){var d=d_axisData[axisId];d.doAutoScale=!1,d.isValid=!1,d.minValue=min,d.maxValue=max,d.stepSize=step,Static.trigger("rescaled"),this.autoRefresh()}},
/*!
        \brief Enable or disable a specified axis

        When an axis is disabled, this only means that it is not
        visible on the screen. Curves, markers and can be attached
        to disabled axes, and transformation of screen coordinates
        into values works as normal.

        Only xBottom and yLeft are enabled by default.

        \param axisId Axis index
        \param tf \c true (enabled) or \c false (disabled)
         */
this.enableAxis=function(axisId,tf){this.axisValid(axisId)&&tf!==d_axisData[axisId].isEnabled&&(d_axisData[axisId].isEnabled=tf,tf?d_axisData[axisId].scaleWidget.show():d_axisData[axisId].scaleWidget.hide(),this.autoRefresh())},
/*!
        \return \c True, if a specified axis is enabled
        \param axisId Axis index
         */
this.axisEnabled=function(axisId){return!!this.axisValid(axisId)&&d_axisData[axisId].isEnabled},
/*!
        \brief Change the title of a specified axis

        \param axisId Axis index
        \param title Axis title
         */
this.setAxisTitle=function(axisId,title){this.axisValid(axisId)&&(d_axisData[axisId].scaleWidget.setTitle(title),this.autoRefresh())},
/*!
        \return Title of a specified axis
        \param axisId Axis index
         */
this.axisTitle=function(axisId){return this.axisValid(axisId)?d_axisData[axisId].scaleWidget.title():""},
/*!
        \brief Return the scale division of a specified axis

        axisScaleDiv(axisId).lowerBound(), axisScaleDiv(axisId).upperBound()
        are the current limits of the axis scale.

        \param axisId Axis index
        \return Scale division

        \sa QwtScaleDiv, setAxisScaleDiv(), QwtScaleEngine::divideScale()
         */
this.axisScaleDiv=function(axisId){return d_axisData[axisId].scaleDiv},
/*!
        \brief Disable autoscaling and specify a fixed scale for a selected axis.

        The scale division will be stored locally only until the next call
        of updateAxes(). So updates of the scale widget usually happen delayed with
        the next replot.

        \param axisId Axis index
        \param scaleDiv Scale division

        \sa setAxisScale(), setAxisAutoScale()
         */
this.setAxisScaleDiv=function(axisId,scaleDiv){if(this.axisValid(axisId)){var d=d_axisData[axisId];d.doAutoScale=!1,d.scaleDiv=scaleDiv,d.isValid=!0,this.autoRefresh()}},
/*!
        \brief Return the scale draw of a specified axis

        \param axisId Axis index
        \return Specified scaleDraw for axis, or NULL if axis is invalid.
         */
this.axisScaleDraw=function(axisId){return this.axisValid(axisId)?this.axisWidget(axisId).scaleDraw():null},
/*!
        \brief Change the font of an axis

        \param axisId Axis index
        \param font Font
        \warning This function changes the font of the tick labels,
        not of the axis title.
         */
this.setAxisLabelFont=function(axisId,fontObj){this.axisValid(axisId)&&(this.axisWidget(axisId).setLabelFont(fontObj),this.autoRefresh())},this.axisLabelFont=function(axisId){return this.axisValid(axisId)?this.axisWidget(axisId).labelFont():null},this.setAxisTitleFont=function(axisId,fontObj){this.axisValid(axisId)&&(this.axisWidget(axisId).setTitleFont(fontObj),this.autoRefresh())},this.axisTitleFont=function(axisId){return this.axisValid(axisId)?this.axisWidget(axisId).titleFont():null},this.initAxesData(),this.isCursorSet=function(){return""!==m_cursor},this.cursor=function(cursor){return m_cursor},this.setCursor=function(cursor){if(cursor!=m_cursor){var previousCursor=m_cursor;return m_cursor=cursor,layout.getCentralDiv().css("cursor",m_cursor),previousCursor}},this.setDefaultCursor=function(cursor){m_defaultCursor!=cursor&&(m_defaultCursor=cursor)},this.unsetCursor=function(){m_defaultCursor!=m_cursor&&(m_cursor=m_defaultCursor,layout.getCentralDiv[0].style.cursor=m_cursor)},this.title=function(){return _title},this.hideTitle=function(){""!=_title&&(layout.getTitleDiv().hide(),layout.updateLayout(),this.autoRefresh())},this.showTitle=function(){""!=_title&&(layout.getTitleDiv().show(),layout.updateLayout(),this.autoRefresh())},this.setTitle=function(ttl){_title!==ttl&&(_title=ttl,0==ttl.trim(" ").length&&(_title=""),""!==_title?(layout.getTitleDiv().show(),Static.trigger("titleAdded",!0)):(layout.getTitleDiv().hide(),Static.trigger("titleAdded",!1)),layout.updateLayout(),this.autoRefresh())},this.setTitleFont=function(fontObj){fontObj.th<0||""===fontObj.name||""===fontObj.style||(m_titleFont=fontObj,layout.adjustLayout(layout.getTitleDiv(),2*fontObj.th),this.autoRefresh())},this.setTitleFont(new Misc.Font(20,"Arial","normal","bold")),this.titleFont=function(){return m_titleFont},this.footer=function(){return m_footer},this.hideFooter=function(){""!=m_footer&&(layout.getFooterDiv().hide(),layout.updateLayout(),this.autoRefresh())},this.showFooter=function(){""!=m_footer&&(layout.getFooterDiv().show(),layout.updateLayout(),this.autoRefresh())},this.setFooter=function(ftr){m_footer!==ftr&&(m_footer=ftr,0==ftr.trim(" ").length&&(m_footer=""),""!==m_footer?(layout.getFooterDiv().show(),Static.trigger("footerAdded",!0)):(layout.getFooterDiv().hide(),Static.trigger("footerAdded",!1)),layout.updateLayout(),this.autoRefresh())},this.setFooterFont=function(fontObj){fontObj.th<0||""===fontObj.name||""===fontObj.style||(m_footerFont=fontObj,layout.adjustLayout(layout.getFooterDiv(),2*fontObj.th),this.autoRefresh())},this.setFooterFont(new Misc.Font(15,"Arial","normal","bold")),this.footerFont=function(){return m_footerFont},this.enableLegend=function(on){legendEnable=on,m_legend&&!m_legend.isEmpty()&&(on?m_legend.legendDiv().show():m_legend.legendDiv().hide(),this.autoRefresh())},this.isLegendEnabled=function(on){return!!m_legend&&!("none"==m_legend.legendDiv()[0].style.display)},
/*!
        Transform the x or y coordinate of a position in the
        drawing region into a value.

        \param axisId Axis index
        \param pos position

        \return Position as axis coordinate

        \warning The position can be an x or a y coordinate,
        depending on the specified axis.
         */
this.invTransform=function(axisId,pos){return this.axisValid(axisId)?this.canvasMap(axisId).invTransform(pos):0},
/*!
        \brief Transform a value into a coordinate in the plotting region

        \param axisId Axis index
        \param value value
        \return X or Y coordinate in the plotting region corresponding
        to the value.
         */
this.transform=function(axisId,value){return this.axisValid(axisId)?this.canvasMap(axisId).transform(value):0};var _plotBackGround="";this.setPlotBackground=function(color){this.getCentralWidget().getElement().css("background-color",color)},this.setPlotBackground("rgb(255, 255, 200)"),this.plotBackground=function(brush){return this.getCentralWidget().getElement().css("background-color")},this.setBorderRadius=function(radius){var cw;this.getCentralWidget().getCanvas().css("border-radius",radius)},this.borderRadius=function(radius){return m_borderRadius},this.findPlotCurve=function(title){for(var list=this.itemList(Static.Rtti_PlotCurve),i=0;i<list.length;++i)if(list[i].title()===title)return list[i];list=this.itemList(Static.Rtti_PlotSpectroCurve);for(var i=0;i<list.length;++i)if(list[i].title()===title)return list[i];list=this.itemList(Static.Rtti_PlotSpectrogram);for(var i=0;i<list.length;++i)if(list[i].title()===title)return list[i];return null},this.findPlotMarker=function(title){for(var list=this.itemList(Static.Rtti_PlotMarker),i=0;i<list.length;++i)if(list[i].title()===title)return list[i];return null},this.hasVisiblePlotCurve=function(){for(var list=this.itemList(Static.Rtti_PlotCurve),i=0;i<list.length;++i)if(list[i].isVisible())return!0;return!1},this.hasVisiblePlotSpectroCurve=function(){for(var list=this.itemList(Static.Rtti_PlotSpectroCurve),i=0;i<list.length;++i)if(list[i].isVisible())return!0;return!1},this.hasVisiblePlotSpectrogram=function(){for(var list=this.itemList(Static.Rtti_PlotSpectrogram),i=0;i<list.length;++i)if(list[i].isVisible())return!0;return!1},this.hasPlotCurve=function(){return this.itemList(Static.Rtti_PlotCurve).length>0},this.hasPlotSpectroCurve=function(){return this.itemList(Static.Rtti_PlotSpectroCurve).length>0},this.hasPlotSpectrogram=function(){return this.itemList(Static.Rtti_PlotSpectrogram).length>0},this.drawBackGround=function(){var painter=new PaintUtil.Painter(centralWidget);painter.fillRect(new Misc.Rect(0,0,centralWidget.width(),centralWidget.height()),""),painter=null},this.drawTitle=function(){if(""!==_title){var painter=new PaintUtil.Painter(titleWidget);painter.setFont(m_titleFont),painter.drawText(_title,titleWidget.width()/2,2.6*m_titleFont.th/2,"center"),painter=null}},this.drawFooter=function(){if(""!==m_footer){var painter=new PaintUtil.Painter(footerWidget);painter.setFont(m_footerFont),painter.drawText(m_footer,footerWidget.width()/2,2.6*m_footerFont.th/2,"center"),painter=null}},this.itemList=function(type){return void 0===type?m_plotItemStore:_.filter(m_plotItemStore,(function(item){return item.rtti===type}))},this.insertItem=function(item){m_plotItemStore.push(item)},this.removeItem=function(item){var index=m_plotItemStore.indexOf(item);index>-1&&m_plotItemStore.splice(index,1)},
/*!
        \param axisId Axis
        \return Map for the axis on the canvas. With this map pixel coordinates can
        translated to plot coordinates and vice versa.
        \sa QwtScaleMap, transform(), invTransform()

         */
this.canvasMap=function(axisId){var map=new ScaleMap;map.setTransformation(this.axisScaleEngine(axisId).transformation());var sd=this.axisScaleDiv(axisId);map.setScaleInterval(sd.lowerBound(),sd.upperBound());var s=this.axisWidget(axisId);if(axisId==yLeft||axisId==yRight){var h=s.height();map.setPaintInterval(h,0)}else{var w=s.width();map.setPaintInterval(0,w)}return map},
/*!
        \return Scale widget of the specified axis, or NULL if axisId is invalid.
        \param axisId Axis index
         */
this.axisWidget=function(axisId){return this.axisValid(axisId)?d_axisData[axisId].scaleWidget:null},
/*!
        \brief Rebuild the axes scales

        In case of autoscaling the boundaries of a scale are calculated
        from the bounding rectangles of all plot items, having the
        QwtPlotItem::AutoScale flag enabled ( QwtScaleEngine::autoScale() ).
        Then a scale division is calculated ( QwtScaleEngine::didvideScale() )
        and assigned to scale widget.

        When the scale boundaries have been assigned with setAxisScale() a
        scale division is calculated ( QwtScaleEngine::didvideScale() )
        for this interval and assigned to the scale widget.

        When the scale has been set explicitly by setAxisScaleDiv() the
        locally stored scale division gets assigned to the scale widget.

        The scale widget indicates modifications by emitting a
        QwtScaleWidget::scaleDivChanged() signal.

        updateAxes() is usually called by replot().

        \sa setAxisAutoScale(), setAxisScale(), setAxisScaleDiv(), replot()
        QwtPlotItem::boundingRect()
         */
this.updateAxes=function(){for(var intv=[new Interval(Number.MAX_VALUE,-Number.MAX_VALUE),new Interval(Number.MAX_VALUE,-Number.MAX_VALUE),new Interval(Number.MAX_VALUE,-Number.MAX_VALUE),new Interval(Number.MAX_VALUE,-Number.MAX_VALUE)],i=0;i<m_plotItemStore.length;++i){var item=m_plotItemStore[i];if(item.testItemAttribute(AutoScale)&&(item.isVisible()&&(this.axisAutoScale(item.xAxis())||this.axisAutoScale(item.yAxis())))){var rect=item.boundingRect();rect.width()>=0&&(rect.left()<intv[item.xAxis()].minValue()&&intv[item.xAxis()].setMinValue(rect.left()),rect.right()>intv[item.xAxis()].maxValue()&&intv[item.xAxis()].setMaxValue(rect.right())),rect.height()>=0&&(rect.top()<intv[item.yAxis()].minValue()&&intv[item.yAxis()].setMinValue(rect.top()),rect.bottom()>intv[item.yAxis()].maxValue()&&intv[item.yAxis()].setMaxValue(rect.bottom()))}}for(var axisId=0;axisId<axisCnt;axisId++){var d=d_axisData[axisId],minValue=d.minValue,maxValue=d.maxValue,stepSize=d.stepSize;if(d.doAutoScale&&intv[axisId].isValid()){d.isValid=!1,minValue=intv[axisId].minValue(),maxValue=intv[axisId].maxValue(),Static.mFuzzyCompare(maxValue,minValue)&&(minValue-=_eps);var xValues={x1:minValue,x2:maxValue};d.scaleEngine.autoScale(d.maxMajor,xValues,stepSize),minValue=xValues.x1,maxValue=xValues.x2}d.isValid||(d.scaleDiv=d.scaleEngine.divideScale(minValue,maxValue,d.maxMajor,d.maxMinor,stepSize),d.isValid=!0);var scaleWidget=this.axisWidget(axisId);scaleWidget.setScaleDiv(d.scaleDiv);var startAndEndObj={start:void 0,end:void 0};scaleWidget.getBorderDistHint(startAndEndObj),scaleWidget.setBorderDist(startAndEndObj.start,startAndEndObj.end)}m_plotItemStore.forEach((function(item){item.testItemInterest(ScaleInterest)&&item.updateScaleDiv(self.axisScaleDiv(item.xAxis()),self.axisScaleDiv(item.yAxis()))}))},
/*!
        \brief Attach/Detach a plot item

        \param plotItem Plot item
        \param on When true attach the item, otherwise detach it
         */
this.attachItem=function(plotItem,on){on?(this.insertItem(plotItem),plotItem.testItemAttribute(Legend)&&this.insertLegendItem(plotItem)):(plotItem.testItemAttribute(Legend)&&this.removeLegendItem(plotItem),this.removeItem(plotItem)),Static.trigger("itemAttached",[plotItem,on]),on||(plotItem=null),this.autoRefresh()},this.replot=function(){var doAutoReplot=this.autoReplot();this.setAutoReplot(!1),this.updateAxes();for(var axisId=0;axisId<axisCnt;axisId++){var axisWidget=d_axisData[axisId].scaleWidget;axisWidget.scaleDraw().data.plotBorderWidth=parseFloat(this.getLayout().getCentralDiv().css("border-width")),axisWidget.draw()}this.drawTitle(),this.drawFooter();for(var i=0;i<m_plotItemStore.length;++i)m_plotItemStore[i].isVisible()&&m_plotItemStore[i].draw(this.axisScaleDraw(m_plotItemStore[i].xAxis()).scaleMap(),this.axisScaleDraw(m_plotItemStore[i].yAxis()).scaleMap());Static.trigger("replot"),this.setAutoReplot(doAutoReplot)},this.setAutoReplot(!0),layout.getTitleDiv().hide(),void 0!==pTitle&&this.setTitle(pTitle),m_defaultCursor=layout.getCentralDiv().css("cursor"),this.setCursor("crosshair"),this.enableAxis(yRight,!1),this.enableAxis(xTop,!1),layout.getFooterDiv().hide(),m_legend?m_legend.legendDiv().hide():layout.getLegendDiv().hide(),Static.bind("resize",(function(){self.replot()})),this.setAutoReplot(!1),this.toString=function(){return'[Plot "'+_title+'"]'},Static.bind("beforePrint",(function(){}))}}define("plot",["static","widget","scaleWidget","utility","miscObjects","painter","scaleDiv","interval","scaleMap","scaleWidget","transform","layout","scaleDraw","scaleEngine","pointMapper"],(function(){}));
/*!
\brief Abstract interface for iterating over samples

Qwt offers several implementations of the QwtSeriesData API,
but in situations, where data of an application specific format
needs to be displayed, without having to copy it, it is recommended
to implement an individual data access.

A subclass of QwtSeriesData<QPointF> must implement:

- size()\n
Should return number of data points.

- sample()\n
Should return values x and y values of the sample at specific position
as QPointF object.

- boundingRect()\n
Should return the bounding rectangle of the data series.
It is used for autoscaling and might help certain algorithms for displaying
the data. You can use qwtBoundingRect() for an implementation
but often it is possible to implement a more efficient algorithm
depending on the characteristics of the series.
The member d_boundingRect is intended for caching the calculated rectangle.

 */
class SeriesData{constructor(){this.d_boundingRect=new Misc.Rect,Static.mBoundingRectPoint=function(sample){return new Misc.Rect(sample.x,sample.y,0,0)},Static.mBoundingRect=function(series,from,to){var boundingRect=new Misc.Rect,i;if(void 0===from&&(from=0),void 0===to&&(to=series.size()-1),to<from)return boundingRect;for(i=from;i<=to;i++){var rect;if((rect=Static.mBoundingRectPoint(series.sample(i))).width()>=0&&rect.height()>=0){boundingRect=rect,i++;break}}for(;i<=to;i++){var rect;(rect=Static.mBoundingRectPoint(series.sample(i))).width()>=0&&rect.height()>=0&&boundingRect.setRect(Math.min(boundingRect.left(),rect.left()),Math.min(boundingRect.top(),rect.top()),Math.max(boundingRect.right(),rect.right())-Math.min(boundingRect.left(),rect.left()),Math.max(boundingRect.bottom(),rect.bottom())-Math.min(boundingRect.top(),rect.top()))}return boundingRect},this.setRectOfInterest=function(rect){},this.toString=function(){return"[SeriesData]"}}}class ArraySeriesData extends SeriesData{constructor(samples){super();var d_samples=[];void 0!==samples&&(d_samples=samples),this.setSamples=function(samples){this.d_boundingRect=new Misc.Rect,d_samples=samples},this.samples=function(){return d_samples},this.size=function(){return d_samples.length},this.sample=function(i){return d_samples[i]},this.toString=function(){return"[ArraySeriesData]"}}}class PointSeriesData extends ArraySeriesData{constructor(samples){super(samples),
/*!
        \brief Calculate the bounding rectangle

        The bounding rectangle is calculated once by iterating over all
        points and is stored for all following requests.

        \return Bounding rectangle
         */
this.boundingRect=function(){return this.d_boundingRect.width()<0&&(this.d_boundingRect=Static.mBoundingRect(this)),this.d_boundingRect},this.toString=function(){return"[PointSeriesData]"}}}
/*!
Constructor
\param samples Samples
 */class Point3DSeriesData extends ArraySeriesData{constructor(samples){super(samples),
/*!
        \brief Calculate the bounding rectangle

        The bounding rectangle is calculated once by iterating over all
        points and is stored for all following requests.

        \return Bounding rectangle
         */
this.boundingRect=function(){return this.d_boundingRect.width()<0&&(this.d_boundingRect=Static.mBoundingRect(this)),this.d_boundingRect},this.toString=function(){return"[Point3DSeriesData]"}}}class PlotSeriesItem extends PlotItem{constructor(tle){super(tle);var d_series=null,m_orientation=Vertical;
/*!
        Set the orientation of the item.

        The orientation() might be used in specific way by a plot item.
        F.e. a QwtPlotCurve uses it to identify how to display the curve
        int QwtPlotCurve::Steps or QwtPlotCurve::Sticks style.

        \sa orientation()
         */
this.setOrientation=function(orientation){m_orientation!=orientation&&(m_orientation=orientation,this.itemChanged())}
/*!
        \return Orientation of the plot item
        \sa setOrientation()
         */,this.orientation=function(){return m_orientation}
/*!
        \brief Draw the complete series

        \param painter Painter
        \param xMap Maps x-values into pixel coordinates.
        \param yMap Maps y-values into pixel coordinates.
        \param canvasRect Contents rectangle of the canvas
         */,this.draw=function(xMap,yMap){this.drawSeries(xMap,yMap,0,-1)},this.updateScaleDiv=function(xScaleDiv,yScaleDiv){var rect=new Misc.Rect(new Misc.Point(xScaleDiv.lowerBound(),yScaleDiv.lowerBound()),xScaleDiv.range(),yScaleDiv.range());this.setRectOfInterest(rect)},this.data=function(){return d_series},this.sample=function(index){return d_series?d_series.sample(index):null},this.setData=function(series){d_series!=series&&(d_series=series)},this.dataSize=function(){return null==d_series?0:d_series.size()},this.dataRect=function(){return null==d_series?new Misc.Rect:d_series.boundingRect()},this.setRectOfInterest=function(rect){d_series&&d_series.setRectOfInterest(rect)},this.swapData=function(series){var swappedSeries=d_series;return d_series=series,swappedSeries},this.toString=function(){return"[PlotSeriesItem]"}}boundingRect(){return this.dataRect()}}define("seriesData",["static","plotItem"],(function(){}));
/*!
Constructor

\param size Number of points
\param interval Bounding interval for the points

\sa setInterval(), setSize()
 */
class SyntheticPointData extends SeriesData{constructor(size,interval){super();var d_size=size,d_interval=interval||new Interval,d_rectOfInterest,d_intervalOfInterest=new Interval(0,10);this.setSize=function(size){d_size=size},this.size=function(){return d_size}
/*!
        Set the bounding interval

        \param interval Interval
        \sa interval(), setSize()
         */,this.setInterval=function(interval){d_interval=interval.normalized()}
/*!
        \return Bounding interval
        \sa setInterval(), size()
         */,this.interval=function(){return d_interval}
/*!
        Set a the "rectangle of interest"

        QwtPlotSeriesItem defines the current area of the plot canvas
        as "rect of interest" ( QwtPlotSeriesItem::updateScaleDiv() ).

        If interval().isValid() == false the x values are calculated
        in the interval rect.left() -> rect.right().

        \sa rectOfInterest()
         */,this.setRectOfInterest=function(rect){d_rectOfInterest=rect,d_intervalOfInterest=new Interval(rect.left(),rect.right()).normalized()}
/*!
        \return "rectangle of interest"
        \sa setRectOfInterest()
         */,this.rectOfInterest=function(){return d_rectOfInterest}
/*!
        \brief Calculate the bounding rectangle

        This implementation iterates over all points, what could often
        be implemented much faster using the characteristics of the series.
        When there are many points it is recommended to overload and
        reimplement this method using the characteristics of the series
        ( if possible ).

        \return Bounding rectangle
         */,this.boundingRect=function(){return 0==d_size||!d_interval.isValid()&&!d_intervalOfInterest.isValid()?new Misc.Rect(1,1,-2,-2):Static.mBoundingRect(this)},this.y=function(_x){throw'subclass must implement "this.y"'}
/*!
        Calculate the point from an index

        \param index Index
        \return QPointF(x(index), y(x(index)));

        \warning For invalid indices ( index < 0 || index >= size() )
        (0, 0) is returned.
         */,this.sample=function(index){if(index>=d_size)return new Misc.Point(0,0);var xValue=this.x(index),yValue=this.y(xValue);return new Misc.Point(xValue,yValue)}
/*!
        Calculate a x-value from an index

        x values are calculated by dividing an interval into
        equidistant steps. If !interval().isValid() the
        interval is calculated from the "rectangle of interest".

        \param index Index of the requested point
        \return Calculated x coordinate

        \sa interval(), rectOfInterest(), y()
         */,this.x=function(index){var interval=d_interval.isValid()?d_interval:d_intervalOfInterest;if(!interval.isValid()||0==d_size||index>=d_size)return 0;var dx=interval.width()/d_size;return interval.minValue()+index*dx},this.toString=function(){return"[SyntheticPointData]"}}}define("pointData",["static","seriesData"],(function(){}));class FunctionData extends SyntheticPointData{constructor(yCb,numOfPoints){super(numOfPoints);var d_y=yCb,parser=new EvaluateExp(d_y);this.setFn=function(fn){d_y=fn,parser.setExpString(d_y)},this.y=function(_x){return parser.error?0:parser.eval({x:_x})}}}define("functionData",["pointData"],(function(){}));class PlotGrid extends PlotItem{constructor(tle){super(tle),this.setItemAttribute(AutoScale,!0);var xEnabled=!0,yEnabled=!0,xMinEnabled=!1,yMinEnabled=!1,xScaleDiv=null,yScaleDiv=null,_majorPen="grey",_minorPen="lightGrey";this.rtti=Static.Rtti_PlotGrid,this.setMajorPen=function(penColor){_majorPen!==penColor&&(_majorPen=penColor,this.itemChanged())},this.majorPen=function(){return _majorPen},this.setMinorPen=function(penColor){_minorPen!==penColor&&(_minorPen=penColor,this.itemChanged())},this.minorPen=function(){return _minorPen},this.enableX=function(on){xEnabled!=on&&(xEnabled=on,this.itemChanged(),Static.trigger("itemChanged",[this,on]))},this.xEnabled=function(){return xEnabled},this.enableY=function(on){yEnabled!=on&&(yEnabled=on,this.itemChanged(),Static.trigger("itemChanged",[this,on]))},this.yEnabled=function(){return yEnabled},this.enableXMin=function(on){xMinEnabled!=on&&(xMinEnabled=on,this.itemChanged())},this.xMinEnabled=function(){return xMinEnabled},this.enableYMin=function(on){yMinEnabled!=on&&(yMinEnabled=on,this.itemChanged())},this.yMinEnabled=function(){return yMinEnabled},this.setXDiv=function(scaleDiv){xScaleDiv!==scaleDiv&&(xScaleDiv=scaleDiv)},this.xDiv=function(){return xScaleDiv}
/*!
	Assign a y axis division
	scaleDiv Scale division
	 */,this.setYDiv=function(scaleDiv){yScaleDiv!==scaleDiv&&(yScaleDiv=scaleDiv)},this.yDiv=function(){return yScaleDiv},this.draw=function(xMap,yMap){var p=this.plot(),xScaleDiv=p.axisScaleDiv(this.xAxis()),yScaleDiv=p.axisScaleDiv(this.yAxis()),ctx=this.getContext();ctx.strokeStyle=_minorPen,xEnabled&&xMinEnabled&&(this.drawLines(ctx,"vertical",xMap,xScaleDiv.ticks(MinorTick)),this.drawLines(ctx,"vertical",xMap,xScaleDiv.ticks(MediumTick))),yEnabled&&yMinEnabled&&(this.drawLines(ctx,"horizontal",yMap,yScaleDiv.ticks(MinorTick)),this.drawLines(ctx,"horizontal",yMap,yScaleDiv.ticks(MediumTick))),ctx.strokeStyle=_majorPen,xEnabled&&this.drawLines(ctx,"vertical",xMap,xScaleDiv.ticks(MajorTick)),yEnabled&&this.drawLines(ctx,"horizontal",yMap,yScaleDiv.ticks(MajorTick))},this.drawLines=function(context,orientation,scaleMap,values){for(var x1=0,x2=context.canvas.width-1,y1=0,y2=context.canvas.height-1,painter=new PaintUtil.Painter(context),lineThickness=painter.pen().width,i=0;i<values.length;i++){var value=scaleMap.transform(values[i]);"horizontal"===orientation?painter.drawLine(0,value-lineThickness,x2,value-lineThickness):painter.drawLine(value-lineThickness,0,value-lineThickness,y2)}painter=null}
/*!
       Update the grid to changes of the axes scale division

       \param xScaleDiv Scale division of the x-axis
       \param yScaleDiv Scale division of the y-axis

       \sa QwtPlot::updateAxes()
    */,this.updateScaleDiv=function(xScale_div,yScale_div){this.setXDiv(xScale_div),this.setYDiv(yScale_div)},this.toString=function(){return"[PlotGrid]"}}}define("plotGrid",["static","plotItem"],(function(){}));var Conrec=function(){var EPSILON=1e-20,pointsEqual=function(a,b){var x=a.x-b.x,y=a.y-b.y;return x*x+y*y<1e-20},reverseList=function(list){for(var pp=list.head;pp;){var temp=pp.next;pp.next=pp.prev,pp.prev=temp,pp=temp}var temp=list.head;list.head=list.tail,list.tail=temp},ContourBuilder=function(level){this.level=level,this.s=null,this.count=0};ContourBuilder.prototype.remove_seq=function(list){list.prev?list.prev.next=list.next:this.s=list.next,list.next&&(list.next.prev=list.prev),--this.count},ContourBuilder.prototype.addSegment=function(a,b){for(var ss=this.s,ma=null,mb=null,prependA=!1,prependB=!1;ss&&(null==ma&&(pointsEqual(a,ss.head.p)?(ma=ss,prependA=!0):pointsEqual(a,ss.tail.p)&&(ma=ss)),null==mb&&(pointsEqual(b,ss.head.p)?(mb=ss,prependB=!0):pointsEqual(b,ss.tail.p)&&(mb=ss)),null==mb||null==ma);)ss=ss.next;var c;switch((null!=ma?1:0)|(null!=mb?2:0)){case 0:var aa={p:a,prev:null},bb={p:b,next:null};aa.next=bb,bb.prev=aa,ma={head:aa,tail:bb,next:this.s,prev:null,closed:!1},this.s&&(this.s.prev=ma),this.s=ma,++this.count;break;case 1:var pp={p:b};prependA?(pp.next=ma.head,pp.prev=null,ma.head.prev=pp,ma.head=pp):(pp.next=null,pp.prev=ma.tail,ma.tail.next=pp,ma.tail=pp);break;case 2:var pp={p:a};prependB?(pp.next=mb.head,pp.prev=null,mb.head.prev=pp,mb.head=pp):(pp.next=null,pp.prev=mb.tail,mb.tail.next=pp,mb.tail=pp);break;case 3:if(ma===mb){var pp={p:ma.tail.p,next:ma.head,prev:null};ma.head.prev=pp,ma.head=pp,ma.closed=!0;break}switch((prependA?1:0)|(prependB?2:0)){case 0:reverseList(ma);case 1:mb.tail.next=ma.head,ma.head.prev=mb.tail,mb.tail=ma.tail,this.remove_seq(ma);break;case 3:reverseList(ma);case 2:ma.tail.next=mb.head,mb.head.prev=ma.tail,ma.tail=mb.tail,this.remove_seq(mb)}}};var Conrec=function(drawContour){if(drawContour)this.drawContour=drawContour;else{var c=this;c.contours={},this.drawContour=function(startX,startY,endX,endY,contourLevel,k){var cb=c.contours[k];cb||(cb=c.contours[k]=new ContourBuilder(contourLevel)),cb.addSegment({x:startX,y:startY},{x:endX,y:endY})},this.contourList=function(){var l=[],a=c.contours;for(var k in a)for(var s=a[k].s,level=a[k].level;s;){var h=s.head,l2=[];for(l2.level=level,l2.k=k;h&&h.p;)l2.push(h.p),h=h.next;l.push(l2),s=s.next}return l.sort((function(a,b){return b.k-a.k})),l}}this.h=new Array(5),this.sh=new Array(5),this.xh=new Array(5),this.yh=new Array(5)};return Conrec.prototype.contour=function(d,ilb,iub,jlb,jub,x,y,nc,z){var h=this.h,sh=this.sh,xh=this.xh,yh=this.yh,drawContour=this.drawContour;this.contours={};for(var xsect=function(p1,p2){return(h[p2]*xh[p1]-h[p1]*xh[p2])/(h[p2]-h[p1])},ysect=function(p1,p2){return(h[p2]*yh[p1]-h[p1]*yh[p2])/(h[p2]-h[p1])},m1,m2,m3,case_value,dmin,dmax,x1=0,x2=0,y1=0,y2=0,im=[0,1,1,0],jm=[0,0,1,1],castab=[[[0,0,8],[0,2,5],[7,6,9]],[[0,3,4],[1,3,1],[4,3,0]],[[9,6,7],[5,2,0],[8,0,0]]],j=jub-1;j>=jlb;j--)for(var i=ilb;i<=iub-1;i++){var temp1,temp2;if(temp1=Math.min(d[i][j],d[i][j+1]),temp2=Math.min(d[i+1][j],d[i+1][j+1]),dmin=Math.min(temp1,temp2),temp1=Math.max(d[i][j],d[i][j+1]),temp2=Math.max(d[i+1][j],d[i+1][j+1]),(dmax=Math.max(temp1,temp2))>=z[0]&&dmin<=z[nc-1])for(var k=0;k<nc;k++)if(z[k]>=dmin&&z[k]<=dmax){for(var m=4;m>=0;m--)m>0?(h[m]=d[i+im[m-1]][j+jm[m-1]]-z[k],xh[m]=x[i+im[m-1]],yh[m]=y[j+jm[m-1]]):(h[0]=.25*(h[1]+h[2]+h[3]+h[4]),xh[0]=.5*(x[i]+x[i+1]),yh[0]=.5*(y[j]+y[j+1])),h[m]>0?sh[m]=1:h[m]<0?sh[m]=-1:sh[m]=0;for(m=1;m<=4;m++)if(m2=0,m3=4!=m?m+1:1,0!=(case_value=castab[sh[m1=m]+1][sh[0]+1][sh[m3]+1])){switch(case_value){case 1:x1=xh[m1],y1=yh[m1],x2=xh[0],y2=yh[0];break;case 2:x1=xh[0],y1=yh[0],x2=xh[m3],y2=yh[m3];break;case 3:x1=xh[m3],y1=yh[m3],x2=xh[m1],y2=yh[m1];break;case 4:x1=xh[m1],y1=yh[m1],x2=xsect(0,m3),y2=ysect(0,m3);break;case 5:x1=xh[0],y1=yh[0],x2=xsect(m3,m1),y2=ysect(m3,m1);break;case 6:x1=xh[m3],y1=yh[m3],x2=xsect(m1,0),y2=ysect(m1,0);break;case 7:x1=xsect(m1,0),y1=ysect(m1,0),x2=xsect(0,m3),y2=ysect(0,m3);break;case 8:x1=xsect(0,m3),y1=ysect(0,m3),x2=xsect(m3,m1),y2=ysect(m3,m1);break;case 9:x1=xsect(m3,m1),y1=ysect(m3,m1),x2=xsect(m1,0),y2=ysect(m1,0)}drawContour(x1,y1,x2,y2,z[k],k)}}}},Conrec}();"undefined"!=typeof exports&&(exports.Conrec=Conrec),define("conrec",(function(){}));class PlotRasterItem extends PlotItem{static useCache(policy,painter){var doCache=!1;return policy==Enum.CachePolicy.PaintCache&&(doCache=!0),doCache}static qwtToRgba(from,alpha){var alphaImage=from.copy();return alphaImage.setAlpha(alpha),alphaImage}constructor(tle){super(tle),Enum.CachePolicy={
/*!
            renderImage() is called each time the item has to be repainted
             */
NoCache:0,
/*!
            renderImage() is called, whenever the image cache is not valid,
            or the scales, or the size of the canvas has changed.

            This type of cache is useful for improving the performance
            of hide/show operations or manipulations of the alpha value.
            All other situations are handled by the canvas backing store.
             */
PaintCache:1},
/*!
        When the image is rendered according to the data pixels
        ( QwtRasterData::pixelHint() ) it can be expanded to paint
        device resolution before it is passed to QPainter.
        The expansion algorithm rounds the pixel borders in the same
        way as the axis ticks, what is usually better than the
        scaling algorithm implemented in Qt.
        Disabling this flag might make sense, to reduce the size of a
        document/file. If this is possible for a document format
        depends on the implementation of the specific QPaintEngine.
         */
Enum.PaintAttribute={PaintInDeviceResolution:1};class PrivateData{constructor(){this.cache={policy:null,area:null,size:null,image:null},this.alpha=-1,this.paintAttributes=Enum.PaintAttribute.PaintInDeviceResolution,this.cache.policy=Enum.CachePolicy.NoCache}}var d_data=null,m_pixelSize=new Misc.Size(1,1);this.init=function(){d_data=new PrivateData,this.setItemAttribute(AutoScale,!0),this.setItemAttribute(Legend,!1),this.setZ(8)}
/*!
        Specify an attribute how to draw the raster item

        \param attribute Paint attribute
        \param on On/Off
        /sa PaintAttribute, testPaintAttribute()
         */,this.setPaintAttribute=function(attribute,on){on?d_data.paintAttributes|=attribute:d_data.paintAttributes&=~attribute}
/*!
        \return True, when attribute is enabled
        \sa PaintAttribute, setPaintAttribute()
         */,this.testPaintAttribute=function(attribute){return d_data.paintAttributes&attribute}
/*!
        \brief Set an alpha value for the raster data

        Often a plot has several types of raster data organized in layers.
        ( f.e a geographical map, with weather statistics ).
        Using setAlpha() raster items can be stacked easily.

        The alpha value is a value [0, 255] to
        control the transparency of the image. 0 represents a fully
        transparent color, while 255 represents a fully opaque color.

        \param alpha Alpha value

        - alpha >= 0\n
        All alpha values of the pixels returned by renderImage() will be set to
        alpha, beside those with an alpha value of 0 (invalid pixels).
        - alpha < 0
        The alpha values returned by renderImage() are not changed.

        The default alpha value is -1.

        \sa alpha()
         */,this.setAlpha=function(alpha){alpha<0&&(alpha=-1),alpha>255&&(alpha=255),alpha!=d_data.alpha&&(d_data.alpha=alpha,this.itemChanged())}
/*!
        \return Alpha value of the raster item
        \sa setAlpha()
         */,this.alpha=function(){return d_data.alpha}
/*!
        Change the cache policy

        The default policy is NoCache

        \param policy Cache policy
        \sa CachePolicy, cachePolicy()
         */,this.setCachePolicy=function(policy){d_data.cache.policy!=policy&&(d_data.cache.policy=policy,this.invalidateCache(),this.itemChanged())}
/*!
        \return Cache policy
        \sa CachePolicy, setCachePolicy()
         */,this.cachePolicy=function(){return d_data.cache.policy}
/*!
        Invalidate the paint cache
        \sa setCachePolicy()
         */,this.invalidateCache=function(){d_data.cache.image=new Misc.Image,d_data.cache.area=new Misc.Rect,d_data.cache.size=new Misc.Size}
/*!
        \return Bounding interval for an axis

        This method is intended to be reimplemented by derived classes.
        The default implementation returns an invalid interval.

        \param axis X, Y, or Z axis
         */,this.interval=function(axis){return new Interval},this.pixelSize=function(){return m_pixelSize},this.setPixelSize=function(sz){m_pixelSize=sz},this.compose=function(xMap,yMap,imageArea,paintRect,imageSize,doCache){var image=new Misc.Image;if(imageArea.isEmpty()||paintRect.isEmpty()||imageSize.isEmpty())return image;if(doCache&&!d_data.cache.image.isNull()&&d_data.cache.area.isEqual(imageArea)&&d_data.cache.size.isEqual(paintRect.size())&&(image=d_data.cache.image),image.isNull()){var xxMap=this.imageMap(Horizontal,xMap,imageArea,imageSize),yyMap=this.imageMap(Vertical,yMap,imageArea,imageSize);image=this.renderImage(xxMap,yyMap,imageArea,imageSize),doCache&&(d_data.cache.area=imageArea.copy(),d_data.cache.size=paintRect.size().copy(),d_data.cache.image=image.copy())}return d_data.alpha>=0&&d_data.alpha<255&&(image=PlotRasterItem.qwtToRgba(image,d_data.alpha)),image}
/*!
        \brief Calculate a scale map for painting to an image

        \param orientation Orientation, Qt::Horizontal means a X axis
        \param map Scale map for rendering the plot item
        \param area Area to be painted on the image
        \param imageSize Image size
        \param pixelSize Width/Height of a data pixel

        \return Calculated scale map
         */,this.imageMap=function(orientation,map,area,imageSize){var p1,p2,s1,s2;if(orientation==Horizontal?(p1=0,p2=imageSize.width,s1=area.left(),s2=area.right()):(p1=0,p2=imageSize.height,s1=area.top(),s2=area.bottom()),map.isInverting()&&s1<s2){var temp=s1;s1=s2,s2=temp}var newMap=map.copy();return newMap.setPaintInterval(p1,p2),newMap.setScaleInterval(s1,s2),newMap},this.dataRasterItemPrivateData=function(){return d_data},this.init()}
/*!
    \return Bounding rectangle of the data
    \sa QwtPlotRasterItem::interval()
     */boundingRect(){var intervalX=this.interval(XAxis),intervalY=this.interval(YAxis);if(!intervalX.isValid()&&!intervalY.isValid())return new Misc.Rect;var r=new Misc.Rect;return intervalX.isValid()?(r.setLeft(intervalX.minValue()),r.setRight(intervalX.maxValue())):(r.setLeft(-.5*Number.MAX_VALUE),r.setWidth(Number.MAX_VALUE)),intervalY.isValid()?(r.setTop(intervalY.minValue()),r.setBottom(intervalY.maxValue())):(r.setTop(-.5*Number.MAX_VALUE),r.setHeight(Number.MAX_VALUE)),r.normalized()}
/*!
    \brief Draw the raster data
    \param painter Painter
    \param xMap X-Scale Map
    \param yMap Y-Scale Map
    \param canvasRect Contents rectangle of the plot canvas
     */draw(painter,xMap,yMap,canvasRect){var d_data=this.dataRasterItemPrivateData();if(!canvasRect.isEmpty()&&0!=d_data.alpha){var doCache=PlotRasterItem.useCache(d_data.cache.policy,painter),area=ScaleMap.invTransform_Rect(xMap,yMap,canvasRect),paintRectAsSize=new Misc.Size(canvasRect.width(),canvasRect.height()),image=this.compose(xMap,yMap,area,canvasRect,paintRectAsSize,doCache);image.isNull()||(painter.save(),painter.drawImage(image,canvasRect),painter.restore())}}}define("plotRasterItem",["static","plotItem"],(function(){}));class PlotSpectrogram extends PlotRasterItem{
/*!
    Sets the following item attributes:
    - QwtPlotItem::AutoScale: true
    - QwtPlotItem::Legend:    false

    The z value is initialized by 8.0.

    \param title Title

    \sa QwtPlotItem::setItemAttribute(), QwtPlotItem::setZ()
     */
constructor(tle){super(tle),
/*!
        The display mode controls how the raster data will be represented.
        \sa setDisplayMode(), testDisplayMode()
         */
Enum.DisplayMode={ImageMode:1,ContourMode:2};class PrivateData{constructor(){this.data=null,this.colorMap=new LinearColorMap,this.displayMode=Enum.DisplayMode.ImageMode,this.contourLevels=[],this.defaultContourPen=new Misc.Pen,this.numberOfContourPlanes=10}}var self=this,gridSzX=80,gridSzY=80,d_data=new PrivateData;this.privateData=function(){return d_data},this.setItemAttribute(AutoScale,!0),this.setItemAttribute(Legend,!1),this.setZ(8),this.rtti=Static.Rtti_PlotSpectrogram,
/*!
        The display mode controls how the raster data will be represented.

        \param mode Display mode
        \param on On/Off

        The default setting enables ImageMode.

        \sa DisplayMode, displayMode()
         */
this.setDisplayMode=function(mode,on){on!=(mode&d_data.displayMode)&&(on?d_data.displayMode|=mode:d_data.displayMode&=~mode,this.legendChanged(),this.itemChanged())}
/*!
        The display mode controls how the raster data will be represented.

        \param mode Display mode
        \return true if mode is enabled
         */,this.testDisplayMode=function(mode){return d_data.displayMode&mode}
/*!
        Change the color map

        Often it is useful to display the mapping between intensities and
        colors as an additional plot axis, showing a color bar.

        \param colorMap Color Map

        \sa colorMap(), QwtScaleWidget::setColorBarEnabled(),
        QwtScaleWidget::setColorMap()
         */,this.setColorMap=function(colorMap){d_data.colorMap!=colorMap&&(d_data.colorMap=colorMap),this.invalidateCache(),this.legendChanged(),this.itemChanged()}
/*!
        \return Color Map used for mapping the intensity values to colors
        \sa setColorMap()
         */,this.colorMap=function(){return d_data.colorMap}
/*!
        Build and assign the default pen for the contour lines

        In Qt5 the default pen width is 1.0 ( 0.0 in Qt4 ) what makes it
        non cosmetic ( see QPen::isCosmetic() ). This method has been introduced
        to hide this incompatibility.

        \param color Pen color
        \param width Pen width
        \param style Pen style

        \sa pen(), brush()
         */,this.setDefaultContourPen=function(color,width,style){var pen=color;"object"!=typeof pen&&(pen=new Misc.Pen(color,width,style)),this.doSetDefaultContourPen(pen)}
/*!
        \brief Set the default pen for the contour lines

        If the spectrogram has a valid default contour pen
        a contour line is painted using the default contour pen.
        Otherwise (pen.style() == Qt::NoPen) the pen is calculated
        for each contour level using contourPen().

        \sa defaultContourPen(), contourPen()
         */,this.doSetDefaultContourPen=function(pen){pen.isEqual(d_data.defaultContourPen)||(d_data.defaultContourPen=pen,this.legendChanged(),this.itemChanged())}
/*!
        \return Default contour pen
        \sa setDefaultContourPen()
         */,this.defaultContourPen=function(){return d_data.defaultContourPen}
/*!
        \brief Calculate the pen for a contour line

        The color of the pen is the color for level calculated by the color map

        \param level Contour level
        \return Pen for the contour line
        \note contourPen is only used if defaultContourPen().style() == Qt::NoPen

        \sa setDefaultContourPen(), setColorMap(), setContourLevels()
         */,this.contourPen=function(level){if(null==d_data.data||null==d_data.colorMap)return new Misc.Pen;var intensityRange=d_data.data.interval(ZAxis),c=d_data.colorMap.rgb(intensityRange,level);return new Misc.Pen(c.toString())}
/*!
        Calculate the levels of the contour lines

        \param numberOfPlanes of contour planes
        \param minZ lowest point
        \param maxZ highest point
        \return array of levels
        \sa contourLevels(), renderContourLines(),
        QwtRasterData::contourLines()

        \note contourLevels returns the same levels but sorted.
         */,this.calculateContourLevels=function(numberOfPlanes,minZ,maxZ){if(numberOfPlanes<1)return[];var zInterval=d_data.data.interval(ZAxis);null==minZ&&(minZ=zInterval.minValue(),maxZ=zInterval.maxValue());for(var cI=(maxZ-minZ)/numberOfPlanes,contourLevels=[],level=minZ+.5*cI;level<maxZ;level+=cI)contourLevels.push(level);return contourLevels};let numberOfContourPlanes=10;this.numberOfContourPlanes=function(){return numberOfContourPlanes},this.setNumberOfContourPlanes=function(numberOfPlanes){numberOfContourPlanes=numberOfPlanes,this.setContourLevels(this.calculateContourLevels(numberOfPlanes))}
/*!
        Set the levels of the contour lines

        \param levels Values of the contour levels
        \sa contourLevels(), renderContourLines(),
        QwtRasterData::contourLines()

        \note contourLevels returns the same levels but sorted.
         */,this.setContourLevels=function(levels){d_data.contourLevels=levels,_.sortBy(d_data.contourLevels),this.legendChanged(),this.itemChanged()}
/*!
        \return Levels of the contour lines.

        The levels are sorted in increasing order.

        \sa contourLevels(), renderContourLines(),
        QwtRasterData::contourLines()
         */,this.contourLevels=function(){return d_data.contourLevels}
/*!
        Set the data to be displayed

        \param data Spectrogram Data
        \sa data()
         */,this.setData=function(data){data!=d_data.data&&(d_data.data=data,this.invalidateCache(),this.itemChanged())}
/*!
        \return Spectrogram data
        \sa setData()
         */,this.data=function(){return d_data.data}
/*!
        \return Bounding interval for an axis

        The default implementation returns the interval of the
        associated raster data object.

        \param axis X, Y, or Z axis
        \sa QwtRasterData::interval()
         */,this.interval=function(axis){return null==d_data.data?new Interval:d_data.data.interval(axis)}
/*!
        \brief Render an image from data and color map.

        For each pixel of area the value is mapped into a color.

        \param xMap X-Scale Map
        \param yMap Y-Scale Map
        \param area Requested area for the image in scale coordinates
        \param imageSize Size of the requested image

        \return An Image.

        \sa QwtRasterData::value(), QwtColorMap::rgb(),
        QwtColorMap::colorIndex()
         */,this.renderImage=function(xMap,yMap,area,imageSize){if(imageSize.isEmpty()||null==d_data.data||null==d_data.colorMap)return new Misc.Image;var intensityRange=d_data.data.interval(ZAxis);if(!intensityRange.isValid())return new Misc.Image;var image=new Misc.Image(imageSize);d_data.colorMap.format()==Enum.Format.Indexed&&image.setColorTable(d_data.colorMap.colorTable(intensityRange)),d_data.data.initRaster(area,image.size());var tile=new Misc.Rect(0,0,imageSize.width,imageSize.height);return this.renderTile(xMap,yMap,tile,image),d_data.data.discardRaster(),image}
/*!
        \brief Render a tile of an image.

        Rendering in tiles can be used to composite an image in parallel
        threads.
        We always use the default alpha value of 255

        \param xMap X-Scale Map
        \param yMap Y-Scale Map
        \param tile Geometry of the tile in image coordinates
        \param image Image to be rendered
         */,this.renderTile=function(xMap,yMap,tile,image){var range=d_data.data.interval(ZAxis);if(range.isValid()){var extraPixelW=this.pixelSize().width-1,extraPixelH=this.pixelSize().height-1,incrementW=extraPixelW+1,incrementH=extraPixelH+1,y,x,top=tile.top()+extraPixelH,bottom=tile.bottom(),left=tile.left()+extraPixelW,right=tile.right();if(d_data.colorMap.format()==Enum.Format.RGB)for(y=top;y<bottom;y+=incrementH){var ty=yMap.invTransform(y);for(x=left;x<right;x+=incrementW)for(var tx=xMap.invTransform(x),rgba=d_data.colorMap.rgb(range,d_data.data.value(tx,ty)),yy=extraPixelH;yy>=0;--yy)for(var xx=extraPixelW;xx>=0;--xx)image.setPixel(x+xx-extraPixelW,y+yy-extraPixelH,rgba)}else if(d_data.colorMap.format()==Enum.Format.Indexed)for(y=top;y<bottom;y+=incrementH){var ty=yMap.invTransform(y);for(x=left;x<right;x+=incrementW)for(var tx=xMap.invTransform(x),rgba=image.pixel(d_data.colorMap.colorIndex(range,d_data.data.value(tx,ty))),yy=extraPixelH;yy>=0;--yy)for(var xx=extraPixelW;xx>=0;--xx)image.setPixel(x+xx-extraPixelW,y+yy-extraPixelH,rgba)}}}
/*!
        Calculate and draw contour lines

        \param rect Rectangle, where to calculate the contour lines

        \sa contourLevels(), setConrecFlag(),
        QwtRasterData::contourLines()
         */,this.renderContourLines=function(painter,xMap,yMap,rect){function drawContour(startX,startY,endX,endY,contourLevel,k){var pen=self.defaultContourPen();pen.style==Static.NoPen&&(pen=self.contourPen(contourLevel)),pen.style!=Static.NoPen&&(painter.setPen(pen),painter.drawLine(xMap.transform(startX),yMap.transform(startY),xMap.transform(endX),yMap.transform(endY)))}if(null!=d_data.data){var levels=d_data.contourLevels,data=d_data.data.contourLinesData(levels,80,80),c;new Conrec(drawContour).contour(data.d,0,data.x.length-1,0,data.y.length-1,data.x,data.y,levels.length,levels)}}}
/*!
    \brief Draw the spectrogram

    \param painter Painter
    \param xMap Maps x-values into pixel coordinates.
    \param yMap Maps y-values into pixel coordinates.
    \param canvasRect Contents rectangle of the canvas in painter coordinates

    \sa setDisplayMode(), renderImage(),
    QwtPlotRasterItem::draw(), drawContourLines()
     */draw(xMap,yMap){var d_data=this.privateData(),canvasRect=this.getCanvasRect(),painter=new PaintUtil.Painter(this);if(d_data.displayMode&Enum.DisplayMode.ImageMode&&super.draw(painter,xMap,yMap,canvasRect),d_data.displayMode&Enum.DisplayMode.ContourMode){var area=ScaleMap.invTransform_Rect(xMap,yMap,canvasRect),br=this.boundingRect();if(br.isValid()&&(area.united(br),area.isEmpty()))return;this.renderContourLines(painter,xMap,yMap,canvasRect)}}}define("plotSpectrogram",["static","conrec","plotRasterItem"],(function(){}));class ColorStop{constructor(p,c){this.pos,this.m_rgb,null==p?(this.pos=0,this.m_rgb=0):(this.pos=p,this.m_rgb=c,-1!==c.indexOf("#")&&(this.m_rgb=Static.HTMLToRGB(c)),this.r=this.m_rgb.r,this.g=this.m_rgb.g,this.b=this.m_rgb.b,this.a=this.m_rgb.a,void 0===this.a&&(this.a=255),this.r0=this.r+.5,this.g0=this.g+.5,this.b0=this.b+.5,this.a0=this.a+.5,this.rStep=0,this.gStep=0,this.bStep=0,this.aStep=0,this.posStep=0),this.updateSteps=function(nextStop){this.rStep=nextStop.r-this.r,this.gStep=nextStop.g-this.g,this.bStep=nextStop.b-this.b,this.aStep=nextStop.a-this.a,this.posStep=nextStop.pos-this.pos}}}class ColorStops{constructor(){var m_doAlpha=!1,m_stops=[];this.findUpper=function(pos){for(var index=0,n=m_stops.length;n>0;){var half=n>>1,middle=index+half;m_stops[middle].pos<=pos?(index=middle+1,n-=half+1):n=half}return index},this.insert=function(pos,color){if("#"!==color[0]&&(color=Static.colorNameToHex(color)),!(pos<0||pos>1)){var index;if(0==m_stops.length)index=0,m_stops.resize(1);else if((index=this.findUpper(pos))==m_stops.length||Math.abs(m_stops[index].pos-pos)>=.001){m_stops.resize(m_stops.length+1);for(var i=m_stops.length-1;i>index;i--)m_stops[i]=m_stops[i-1]}m_stops[index]=new ColorStop(pos,color),255!=color.alpha&&(m_doAlpha=!0),index>0&&m_stops[index-1].updateSteps(m_stops[index]),index<m_stops.length-1&&m_stops[index].updateSteps(m_stops[index+1])}},this.rgb=function(mode,pos){if(pos<=0)return m_stops[0].m_rgb;if(pos>=1)return m_stops[m_stops.length-1].m_rgb;var index=this.findUpper(pos);if(mode==Enum.Mode.FixedColors)return m_stops[index-1].m_rgb;var s1=m_stops[index-1],ratio=(pos-s1.pos)/s1.posStep,r=Math.round(s1.r0+ratio*s1.rStep),g=Math.round(s1.g0+ratio*s1.gStep),b=Math.round(s1.b0+ratio*s1.bStep);if(m_doAlpha){if(s1.aStep){var a=s1.a0+ratio*s1.aStep;return Static.mRgba(r,g,b,a)}return Static.mRgba(r,g,b,s1.a)}return Static.mRgb(r,g,b)},this.stops=function(){for(var positions=new Array(m_stops.length),i=0;i<m_stops.length;i++)positions[i]=m_stops[i].pos;return positions}}}class ColorMap{constructor(format){var m_format=format;this.format=function(){return m_format}
/*!
        Build and return a color map of 256 colors

        The color table is needed for rendering indexed images in combination
        with using colorIndex().

        \param interval Range for the values
        \return A color table, that can be used for a QImage
         */,this.colorTable=function(interval){var table=new Array(256);if(interval.isValid())for(var step=interval.width()/(table.length-1),i=0;i<table.length;i++)table[i]=this.rgb(interval,interval.minValue()+step*i);return table}
/*!
        Map a value of a given interval into a RGB value.

        \param interval Range for the values
        \param value Value
        \return RGB value, corresponding to value
         */,this.rgb=function(interval,value){return{r:0,g:0,b:0,a:0}}}}
/*!
Constructor
\param format
 */
/*!
Build a color map with two stops at 0.0 and 1.0. The color
at 0.0 is Qt::blue, at 1.0 it is Qt::yellow.

\param format Preferred format of the color map
 */
/*!
Build a color map with two stops at 0.0 and 1.0.

\param color1 Color used for the minimum value of the value interval
\param color2 Color used for the maximum value of the value interval
\param format Preferred format for the color map
 */class LinearColorMap extends ColorMap{constructor(color1,color2,format){var singleParam=null==format,m_colorStops;singleParam&&(format=color1),super(format),this.m_mode=Enum.Mode.ScaledColors,
/*!
        Set the color range

        Add stops at 0.0 and 1.0.

        \param color1 Color used for the minimum value of the value interval
        \param color2 Color used for the maximum value of the value interval

        \sa color1(), color2()
         */
this.setColorInterval=function(color1,color2){(m_colorStops=new ColorStops).insert(0,color1),m_colorStops.insert(1,color2)},singleParam?this.setColorInterval("#0000FF","#FFFF00"):this.setColorInterval(color1,color2),
/*!
        \brief Set the mode of the color map

        FixedColors means the color is calculated from the next lower
        color stop. ScaledColors means the color is calculated
        by interpolating the colors of the adjacent stops.

        \sa mode()
         */
this.setMode=function(mode){this.m_mode=mode}
/*!
        \return Mode of the color map
        \sa setMode()
         */,this.mode=function(){return this.m_mode}
/*!
        Add a color stop

        The value has to be in the range [0.0, 1.0].
        F.e. a stop at position 17.0 for a range [10.0,20.0] must be
        passed as: (17.0 - 10.0) / (20.0 - 10.0)

        \param value Value between [0.0, 1.0]
        \param color Color stop
         */,this.addColorStop=function(value,color){value>=0&&value<=1&&m_colorStops.insert(value,color)}
/*!
        \return Positions of color stops in increasing order
         */,this.colorStops=function(){return m_colorStops.stops()}
/*!
        \return the first color of the color range
        \sa setColorInterval()
         */,this.color1=function(){return m_colorStops.rgb(this.m_mode,0)}
/*!
        \return the second color of the color range
        \sa setColorInterval()
         */,this.color2=function(){return m_colorStops.rgb(this.m_mode,1)}
/*!
        Map a value of a given interval into a RGB value

        \param interval Range for all values
        \param value Value to map into a RGB value

        \return RGB value for value
         */,this.rgb=function(interval,value){if(isNaN(value))return 0;var width=interval.width();if(width<=0)return 0;var ratio=(value-interval.minValue())/width;return m_colorStops.rgb(this.m_mode,ratio)}
/*!
        \brief Map a value of a given interval into a color index

        \param interval Range for all values
        \param value Value to map into a color index

        \return Index, between 0 and 255
         */,this.colorIndex=function(interval,value){var width=interval.width();if(isNaN(value)||width<=0||value<=interval.minValue())return 0;if(value>=interval.maxValue())return 255;var ratio=(value-interval.minValue())/width,index;return index=this.m_mode==Enum.Mode.FixedColors?255*ratio:255*ratio+.5}}}define("colorMap",["static"],(function(){}));
/*!
  \brief QwtRasterData defines an interface to any type of raster data.

  QwtRasterData is an abstract interface, that is used by
  QwtPlotRasterItem to find the values at the pixels of its raster.

  Often a raster item is used to display values from a matrix. Then the
  derived raster data class needs to implement some sort of resampling,
  that maps the raster of the matrix into the requested raster of
  the raster item ( depending on resolution and scales of the canvas ).
*/
class RasterData{constructor(){var d_intervals=[null,null,null];
/*!
		   Set the bounding interval for the x, y or z coordinates.

		   \param axis Axis
		   \param interval Bounding interval

		   \sa interval()
		*/this.setInterval=function(axis,interval){d_intervals[axis]=interval},this.interval=function(axis){return d_intervals[axis]}
/*!
		  \brief Initialize a raster

		  Before the composition of an image QwtPlotSpectrogram calls initRaster(),
		  announcing the area and its resolution that will be requested.

		  The default implementation does nothing, but for data sets that
		  are stored in files, it might be good idea to reimplement initRaster(),
		  where the data is resampled and loaded into memory.

		  \param area Area of the raster
		  \param raster Number of horizontal and vertical pixels

		  \sa initRaster(), value()
		*/,this.initRaster=function(area,raster){}
/*!
		  \brief Discard a raster

		  After the composition of an image QwtPlotSpectrogram calls discardRaster().

		  The default implementation does nothing, but if data has been loaded
		  in initRaster(), it could deleted now.

		  \sa initRaster(), value()
		*/,this.discardRaster=function(){},this.contourLinesData=function(levels,gridSizeX,gridSizeY){for(var gridSzX=gridSizeX||100,gridSzY=gridSizeY||100,intervalX=this.interval(XAxis),intervalY=this.interval(YAxis),dx=intervalX.width()/(gridSzX-1),dy=intervalY.width()/(gridSzY-1),x=[],xMin=intervalX.minValue(),y=[],yMin=intervalY.minValue(),i=0;i<gridSzX;i++)x.push(xMin+i*dx);for(var i=0;i<gridSzY;i++)y.push(yMin+i*dy);x[gridSzX-1]=intervalX.maxValue(),y[gridSzY-1]=intervalY.maxValue();for(var d=[],xi=0;xi<x.length;xi++){for(var col=[],yi=0;yi<y.length;yi++)col.push(this.value(x[xi],y[yi]));d.push(col)}return{d:d,x:x,y:y}}}value(x,y){}}define("rasterData",(function(){}));class RasterFileData extends RasterData{constructor(fileData){Enum.InterpolationType={cubic:0,linear:1},super(),this._interpolationType=Enum.InterpolationType.linear;var arr=fileData.array,columnX;this.samples3D=[];var columnLen=0,i,n=arr.length;for(i=0;i<n;i++)if(0!=i){if(columnX!==arr[i].x)break;columnLen++}else columnX=arr[i].x,columnLen++;this.samples3D=_.chunk(arr,columnLen),this.minX=this.samples3D[0][0].x,this.maxX=this.samples3D[this.samples3D.length-1][0].x;var col0=this.samples3D[0];this.minY=col0[0].y,this.maxY=col0[col0.length-1].y,this.setInterval(XAxis,new Interval(this.minX,this.maxX)),this.setInterval(YAxis,new Interval(this.minY,this.maxY)),this.setInterval(ZAxis,new Interval(fileData.minZ,fileData.maxZ))}interpolaionType(){return this._interpolationType}setInterpolaionType(type){type<Enum.InterpolationType.cubic||type>Enum.InterpolationType.linear||(this._interpolationType=type)}value(x,y){return x>this.maxX&&(x=this.maxX),x<this.minX&&(x=this.minX),y>this.maxY&&(y=this.maxY),y<this.minY&&(y=this.minY),this.interpolaionType()==Enum.InterpolationType.cubic?Utility.bicubicInterpolate(this.samples3D,x,y):this.interpolaionType()==Enum.InterpolationType.linear?Utility.bilinearInterpolate(this.samples3D,x,y):void 0}}define("rasterFileData",["rasterData"],(function(){}));class RasterFunctionData extends RasterData{constructor(functionData){super();var fn=functionData.fx,parser=new EvaluateExp(fn=(fn=fn.replaceAll(functionData.variable,"_x")).replaceAll(functionData.variableY,"_y"));if(parser.error)return Static.alert(parser.errorMessage),null;this.minX=functionData.minX,this.maxX=functionData.maxX,this.minY=functionData.minY,this.maxY=functionData.maxY,this.setInterval(XAxis,new Interval(this.minX,this.maxX)),this.setInterval(YAxis,new Interval(this.minY,this.maxY)),this.setInterval(ZAxis,new Interval(functionData.minZ,functionData.maxZ)),this.getValue=function(xx,yy){return parser.eval({_x:xx,_y:yy})}}value(x,y){return x>=this.maxX&&(x=this.maxX),x<this.minX&&(x=this.minX),y>=this.maxY&&(y=this.maxY),y<this.minY&&(y=this.minY),this.getValue(x,y)}}define("rasterFunctionData",["rasterData"],(function(){}));class LinearColorMapRGB extends LinearColorMap{constructor(){super(Enum.Format.RGB),this.setColorInterval("darkCyan","red"),this.addColorStop(.1,"cyan"),this.addColorStop(.6,"green"),this.addColorStop(.95,"yellow")}}class LinearColorMapIndexed extends LinearColorMap{constructor(){super(Enum.Format.Indexed),this.setColorInterval("darkCyan","red"),this.addColorStop(.1,"cyan"),this.addColorStop(.6,"green"),this.addColorStop(.95,"yellow")}}class Spectrogram extends PlotSpectrogram{constructor(title){super(title);var self=this;Enum.ColorMap={RGBMap:0,IndexMap:1,HueMap:2,AlphaMap:3};var d_alpha=255,d_mapType;this.setColorMap(new LinearColorMapRGB),this.setAlpha(d_alpha),this.setCachePolicy(Enum.CachePolicy.PaintCache);for(var contourLevels=[],level=.5;level<10;level+=1)contourLevels.push(level);this.setContourLevels(contourLevels),this.setItemAttribute(Legend,!0),this.showContour=function(on){this.setDisplayMode(Enum.DisplayMode.ContourMode,on),this.plot().replot()},this.showSpectrogram=function(on){this.setDisplayMode(Enum.DisplayMode.ImageMode,on),this.setDefaultContourPen(on?new Misc.Pen("black",0):new Misc.Pen(Static.NoPen))},this.setSpectrogramColorMap=function(type){var plot=this.plot(),axis=plot.axisWidget(yRight),zInterval=this.data().interval(ZAxis);d_mapType=type;var alpha=d_alpha;switch(type){case Enum.ColorMap.HueMap:case Enum.ColorMap.AlphaMap:case Enum.ColorMap.IndexMap:{const oldColorMap=this.colorMap(),colorMap=new LinearColorMapIndexed;colorMap.setColorInterval(oldColorMap.color1(),oldColorMap.color2()),colorMap.addColorStop(.1,"cyan"),colorMap.addColorStop(.6,"green"),colorMap.addColorStop(.95,"yellow"),this.setColorMap(colorMap);break}case Enum.ColorMap.RGBMap:default:{const oldColorMap=this.colorMap(),colorMap=new LinearColorMapRGB;colorMap.setColorInterval(oldColorMap.color1(),oldColorMap.color2()),colorMap.addColorStop(.1,"cyan"),colorMap.addColorStop(.6,"green"),colorMap.addColorStop(.95,"yellow"),this.setColorMap(colorMap)}}this.setSpectrogramAlpha(alpha),plot.replot()},this.setSpectrogramAlpha=function(alpha){var plot=this.plot();d_alpha=alpha,d_mapType!=Enum.ColorMap.AlphaMap&&(this.setAlpha(alpha),plot.replot())}}}class SpectrogramFileData extends RasterFileData{constructor(fileData){super(fileData),this.setInterval(ZAxis,new Interval(0,10))}}class SpectrogramFunctionData extends RasterFunctionData{constructor(functionData){super(functionData)}}define("spectrogram",["static","plotSpectrogram","colorMap","rasterFileData","rasterFunctionData"],(function(){}));class MyPlot extends Plot{constructor(plotDiv,plotTitle){super(plotDiv,plotTitle);var self=this,m_curveShapeEnabledByPlotSettings=!0;function getCoffsVal(){for(var result=[],coeffs=self._functionDlg.coeffs||[],i=0;i<coeffs.length;++i)result.push(1);return result}function addCurve(title,samples,upload,fn){if(!samples||0==samples.length)return null;if(self.findPlotCurve(title))return Static.alert(title+" already exist"),null;var curve=new MyCurve(title);curve.expandedFn=fn,upload||self.addCurveInit(curve),curve.setSamples(samples),curve.setPen(new Misc.Pen(Utility.randomColor())),self.curveAttributeDlg.defaultIconSize=new Misc.Size(curve.getLegendIconSize());var attribute="";return Static.showline&&Static.showsymbol?attribute="lineAndSymbol":Static.showline?attribute="line":Static.showsymbol&&(attribute="symbol"),Utility.setLegendAttribute(curve,attribute,curve.getLegendIconSize()),curve.attach(self),self.rv.setCurrentCurve(curve),self.sidebar&&(self.sidebar.initSidebar(),self.rv.refresh()),curve}function addSpectrocurve(title,color1,color2,_data,upload){var samples,minZ,maxZ;if(upload?(samples=_data.array,minZ=_data.minZ,maxZ=_data.maxZ):(samples=_data.data,minZ=_data.zLimits.min,maxZ=_data.zLimits.max),!samples||0==samples.length)return null;if(self.findPlotCurve(title))return Static.alert(title+" already exist"),null;var curve=new SpectroCurve(title);return curve.minZ=minZ,curve.maxZ=maxZ,curve.setSamples(samples),curve.setPenWidth(4),curve.setColorInterval(color1,color2),curve.setColorRange(new Interval(minZ,maxZ)),curve.attach(self),curve}function addSpectrogram(title,color1,color2,data,upload){var sgram=new Spectrogram(title);sgram.upload=upload,sgram.spectrogramData=data,upload?sgram.setData(new SpectrogramFileData(data)):sgram.setData(new SpectrogramFunctionData(data)),sgram.setNumberOfContourPlanes(10);const colorMap=sgram.colorMap();return colorMap.setColorInterval(color1,color2),colorMap.addColorStop(.1,"cyan"),colorMap.addColorStop(.6,"green"),colorMap.addColorStop(.95,"yellow"),sgram.attach(self),Static.bind("alphaChanged",(function(e,alpha){sgram.setAlpha(alpha)})),Static.bind("showSpectrogram",(function(e,on){sgram.setDisplayMode(Enum.DisplayMode.ImageMode,on),sgram.setDefaultContourPen(on?new Misc.Pen("black",0):new Misc.Pen(Static.NoPen))})),Static.bind("showContour",(function(e,on){sgram.setDisplayMode(Enum.DisplayMode.ContourMode,on)})),Static.bind("numberOfPlanes",(function(e,val){console.log(4441),sgram.setContourLevels(sgram.calculateContourLevels(val))})),sgram}function addUnboundedCurve(title,fn,numOfPoints){if(self.findPlotCurve(title))return Static.alert(title+" already exist"),null;self.setAxisScale(xBottom,1,10);let curve=new MyCurve(title);return self.addCurveInit(curve),curve.functionData=new FunctionData(fn,numOfPoints),curve.setData(curve.functionData),curve.setPen(new Misc.Pen(Utility.randomColor())),self.curveAttributeDlg.defaultIconSize=new Misc.Size(curve.getLegendIconSize()),Static.showline&&curve.setLegendAttribute(LegendShowLine,!0),Static.showsymbol&&curve.setLegendAttribute(LegendShowSymbol,!0),curve.attach(self),curve}function getFunctionDlgData(rtti){let functionDlgData={};return functionDlgData.rtti=rtti,rtti==Static.Rtti_PlotCurve&&(functionDlgData.coeffs=self._functionDlg.coeffs,functionDlgData.expandedFn=self._functionDlg.expandedFn,functionDlgData.fn=self._functionDlg.fn,functionDlgData.lowerLimit=self._functionDlg.lowerLimit,functionDlgData.numOfPoints=self._functionDlg.numOfPoints,functionDlgData.threeD=self._functionDlg.threeD,functionDlgData.title=self._functionDlg.title,functionDlgData.unboundedRange=self._functionDlg.unboundedRange,functionDlgData.upperLimit=self._functionDlg.upperLimit,functionDlgData.variable=self._functionDlg.variable),rtti==Static.Rtti_PlotSpectroCurve&&(functionDlgData.color1=self._functionDlg.color1,functionDlgData.color2=self._functionDlg.color2,functionDlgData.expandedFn=self._functionDlg.expandedFn,functionDlgData.fn=self._functionDlg.fn,functionDlgData.lowerLimit=self._functionDlg.lowerLimit,functionDlgData.lowerLimitFxy=self._functionDlg.lowerLimitFxy,functionDlgData.lowerLimitY=self._functionDlg.lowerLimitY,functionDlgData.numOfPoints=self._functionDlg.numOfPoints,functionDlgData.threeD=self._functionDlg.threeD,functionDlgData.threeDType=self._functionDlg.threeDType,functionDlgData.title=self._functionDlg.title,functionDlgData.upperLimit=self._functionDlg.upperLimit,functionDlgData.upperLimitFxy=self._functionDlg.upperLimitFxy,functionDlgData.upperLimitY=self._functionDlg.upperLimitY,functionDlgData.variable=self._functionDlg.variable,functionDlgData.variableY=self._functionDlg.variableY),rtti==Static.Rtti_PlotSpectrogram&&(functionDlgData.color1=self._functionDlg.color1,functionDlgData.color2=self._functionDlg.color2,functionDlgData.expandedFn=self._functionDlg.expandedFn,functionDlgData.fn=self._functionDlg.fn,functionDlgData.lowerLimit=self._functionDlg.lowerLimit,functionDlgData.lowerLimitFxy=self._functionDlg.lowerLimitFxy,functionDlgData.lowerLimitY=self._functionDlg.lowerLimitY,functionDlgData.numOfPoints=self._functionDlg.numOfPoints,functionDlgData.threeD=self._functionDlg.threeD,functionDlgData.threeDInterpolationType=self._functionDlg.threeDInterpolationType,functionDlgData.threeDType=self._functionDlg.threeDType,functionDlgData.title=self._functionDlg.title,functionDlgData.upperLimit=self._functionDlg.upperLimit,functionDlgData.upperLimitFxy=self._functionDlg.upperLimitFxy,functionDlgData.upperLimitY=self._functionDlg.upperLimitY,functionDlgData.variable=self._functionDlg.variable,functionDlgData.variableY=self._functionDlg.variableY),functionDlgData}function setFunctionDlgData(functionDlgData){functionDlgData.rtti==Static.Rtti_PlotCurve&&(self._functionDlg.coeffs=functionDlgData.coeffs,self._functionDlg.expandedFn=functionDlgData.expandedFn,self._functionDlg.lowerLimit=functionDlgData.lowerLimit,self._functionDlg.numOfPoints=functionDlgData.numOfPoints,self._functionDlg.threeD=functionDlgData.threeD,self._functionDlg.title=functionDlgData.title,self._functionDlg.unboundedRange=functionDlgData.unboundedRange,self._functionDlg.upperLimit=functionDlgData.upperLimit,self._functionDlg.variable=functionDlgData.variable),functionDlgData.rtti==Static.Rtti_PlotSpectroCurve&&(self._functionDlg.color1=functionDlgData.color1,self._functionDlg.color2=functionDlgData.color2,self._functionDlg.expandedFn=functionDlgData.expandedFn,self._functionDlg.fn=functionDlgData.fn,self._functionDlg.lowerLimit=functionDlgData.lowerLimit,self._functionDlg.lowerLimitFxy=functionDlgData.lowerLimitFxy,self._functionDlg.lowerLimitY=functionDlgData.lowerLimitY,self._functionDlg.numOfPoints=functionDlgData.numOfPoints,self._functionDlg.threeD=functionDlgData.threeD,self._functionDlg.threeDType=functionDlgData.threeDType,self._functionDlg.title=functionDlgData.title,self._functionDlg.upperLimit=functionDlgData.upperLimit,self._functionDlg.upperLimitFxy=functionDlgData.upperLimitFxy,self._functionDlg.upperLimitY=functionDlgData.upperLimitY,self._functionDlg.variable=functionDlgData.variable,self._functionDlg.variableY=functionDlgData.variableY),functionDlgData.rtti==Static.Rtti_PlotSpectrogram&&(self._functionDlg.color1=functionDlgData.color1,self._functionDlg.color2=functionDlgData.color2,self._functionDlg.expandedFn=functionDlgData.expandedFn,self._functionDlg.fn=functionDlgData.fn,self._functionDlg.lowerLimit=functionDlgData.lowerLimit,self._functionDlg.lowerLimitFxy=functionDlgData.lowerLimitFxy,self._functionDlg.lowerLimitY=functionDlgData.lowerLimitY,self._functionDlg.numOfPoints=functionDlgData.numOfPoints,self._functionDlg.threeD=functionDlgData.threeD,self._functionDlg.threeDInterpolationType=functionDlgData.threeDInterpolationType,self._functionDlg.threeDType=functionDlgData.threeDType,self._functionDlg.title=functionDlgData.title,self._functionDlg.upperLimit=functionDlgData.upperLimit,self._functionDlg.upperLimitFxy=functionDlgData.upperLimitFxy,self._functionDlg.upperLimitY=functionDlgData.upperLimitY,self._functionDlg.variable=functionDlgData.variable,self._functionDlg.variableY=functionDlgData.variableY)}this.grid=new PlotGrid,this.fileSystemServices=null,Static.curvePropPane=0,Static.plotPropPane=1,Static.infoPropPane=2,this.grid.attach(this),Utility.minorGridLines(this.grid,!0),this.insertLegend(new MLegend),this.enableLegend(!0),this.file=new MFile(this),this.markerDlg=new MMarkerDlg,this.pointEntryDlg=new MPointEntryDlg,this._functionDlg=new MFunctionDlg,this.curveFitDlg=new MCurveFitDlg,this.curveStyleDlg=new MCurveStyleDlg,this.axisDlg=new MAxisDlg,this.curveAttributeDlg=new MCurveLegendAttributeDlg,this.addCurveInit=function(curve){curve.coeffs=self._functionDlg.coeffs,curve.variable=self._functionDlg.variable,curve.coeffsVal=getCoffsVal(),curve.fn=self._functionDlg.expandedFn,curve.unboundedRange=self._functionDlg.unboundedRange,curve.lowerX=parseFloat(self._functionDlg.lowerLimit),curve.upperX=parseFloat(self._functionDlg.upperLimit),curve.numOfSamples=self._functionDlg.numOfPoints},Static.bind("addSpectrocurve",(function(e,fileName,samples,upload){addSpectrocurve(fileName,"red","green",samples,upload)})),this.uploadSpectrogram=function(displayData,spectrogramData,upload){const sgram=addSpectrogram(displayData.title,displayData.color1,displayData.color2,spectrogramData,upload);return sgram.setNumberOfContourPlanes(displayData.numberOfContourPlanes),sgram.showContour(displayData.showContour),sgram.showSpectrogram(displayData.showSpectrogram),sgram},Static.bind("addSpectrogram",(function(e,fileName,samples,upload){addSpectrogram(fileName,"#008b8b","#ff0000",samples,upload)})),Static.bind("addCurve",(function(e,title,samples,upload,result){let curve=addCurve(title,samples,upload)})),this.createCurve=function(rtti,title){return rtti==Static.Rtti_PlotCurve?new MyCurve(title):rtti==Static.Rtti_PlotMarker?new PlotMarker(title):rtti==Static.Rtti_PlotSpectroCurve?new SpectroCurve(title):void 0},this.functionDlgCb=function(functionDlgData=null){let newCurve=null;functionDlgData&&setFunctionDlgData(functionDlgData);var title=self._functionDlg.title,fn=self._functionDlg.expandedFn,lowerLimit=self._functionDlg.lowerLimit,upperLimit=self._functionDlg.upperLimit,numOfPoints=self._functionDlg.numOfPoints;if(self._functionDlg.threeD){if("spectrocurve"===self._functionDlg.threeDType)return newCurve=addSpectrocurve(title,self._functionDlg.color1,self._functionDlg.color2,Utility.makeSamples({fx:fn,threeD:!0,variable:self._functionDlg.variable,variableY:self._functionDlg.variableY,lowerX:parseFloat(self._functionDlg.lowerLimit),upperX:parseFloat(self._functionDlg.upperLimit),lowerY:parseFloat(self._functionDlg.lowerLimitY),upperY:parseFloat(self._functionDlg.upperLimitY),numOfSamples:self._functionDlg.numOfPoints,ok_fn:self._functionDlg.ok})),newCurve.fn=fn,newCurve.functionDlgData=getFunctionDlgData(newCurve.rtti),newCurve&&self._functionDlg.close&&self._functionDlg.close(),newCurve;if("spectrogram"===self._functionDlg.threeDType){var fnData={fx:fn,variable:self._functionDlg.variable,variableY:self._functionDlg.variableY,minX:parseFloat(self._functionDlg.lowerLimit),maxX:parseFloat(self._functionDlg.upperLimit),minY:parseFloat(self._functionDlg.lowerLimitY),maxY:parseFloat(self._functionDlg.upperLimitY),minZ:parseFloat(self._functionDlg.lowerLimitFxy),maxZ:parseFloat(self._functionDlg.upperLimitFxy)};newCurve=addSpectrogram(title,self._functionDlg.color1,self._functionDlg.color2,fnData),newCurve.fn=fn,newCurve.functionDlgData=getFunctionDlgData(newCurve.rtti),newCurve&&self._functionDlg.close&&self._functionDlg.close()}return newCurve}let coeffs=self._functionDlg.coeffs;if(coeffs&&self._functionDlg.coeffs.length)for(var i=0;i<coeffs.length;++i)for(;-1!=fn.indexOf(coeffs[i]);)fn=fn.replace(coeffs[i],1);if(!self._functionDlg.unboundedRange){let makeSamplesData={fx:fn,variable:self._functionDlg.variable,lowerX:parseFloat(self._functionDlg.lowerLimit),upperX:parseFloat(self._functionDlg.upperLimit),numOfSamples:self._functionDlg.numOfPoints,ok_fn:self._functionDlg.ok};const samples=Utility.makeSamples(makeSamplesData);return newCurve=addCurve(title,samples,!1,fn),newCurve.functionDlgData=getFunctionDlgData(newCurve.rtti),newCurve&&self._functionDlg.close&&self._functionDlg.close(),newCurve}newCurve=addUnboundedCurve(title,fn,numOfPoints),newCurve&&self._functionDlg.close&&self._functionDlg.close()},this._functionDlg.init(self.functionDlgCb),this.addRemovePoint=new AddRemovePointPicker(this),this.addRemovePoint.setAddRemoveMousePattern(Enum.MousePatternCode.MouseSelect1,Static.LeftButton,Static.ShiftModifier);var rulers=new Rulers(this);Static.watchCentroidWithArea=!0,Static.bind("watchCentroidWithArea",(function(e,on){Static.watchCentroidWithArea=on,Static.trigger("invalidateWatch"),rulers.updateWatchesAndTable()})),this.tbar=new MToolBar(this,{zIndex:1003}),this.curveClosestPoint=new CurveClosestPoint(this),this.curveClosestPoint.setMousePattern(Static.LeftButton,Static.AltModifier),this.cs=new CurveShapeItem(this),this.curveShapeEnabledByPlotSettings=function(){return m_curveShapeEnabledByPlotSettings},this.setCurveShapeEnabledByPlotSettings=function(on){m_curveShapeEnabledByPlotSettings=on},this.setAxisTitle(xBottom,"Bottom scale"),this.setAxisTitle(xTop,"Top scale"),this.setAxisTitle(yLeft,"Left scale"),this.setAxisTitle(yRight,"Right scale"),this.magnifier=new Magnifier(this),this.pan=new Panner(this),this.pan.setCursor("move"),this.pan.setEnabled(!1),this.zm=new MyPlotZoomer(this);var m_settings=null;this.leftSidebar=new PlotSideBar(this),this.leftSidebar.setTop(parseInt($("#toolBar1").css("height"))+2);var pp=new CurvePropertiesPane(this.leftSidebar.gridItem(0).bodyElement,this,Static.curvePropPane);m_settings=new PlotPropertiesPane(this.leftSidebar.gridItem(1).bodyElement,this,Static.plotPropPane),this.leftSidebar.showGridItem(1,!0),this.rightSidebar=new InfoSideBar(this),this.rightSidebar.setTop(parseInt($("#toolBar1").css("height"))+2);var pp=new InfoPropertiesPane(this.rightSidebar.gridItem(0).bodyElement,this,Static.infoPropPane);this.rightSidebar.showSidebar(!1),this.settings=function(){return m_settings},this.setFooter("Footer");var legendMenu=new LegendMenu(this);legendMenu.modifyMenu(null,{pos:2,name:"axis",img:"images/axis.png",title:"Sets the axes associated with the curve.",fun:function(){var curve=legendMenu.getCurve();curve&&self.axisDlg.axisCb(curve)}}),legendMenu.setMenuModificationCb((function(){var curve=legendMenu.getCurve();curve.rtti===Static.Rtti_PlotSpectroCurve||curve.rtti===Static.Rtti_PlotSpectrogram?(legendMenu.modifyMenu("curve brush",{}),legendMenu.modifyMenu("curve style",{}),legendMenu.modifyMenu("legend attribute",{}),legendMenu.modifyMenu("fit",{}),legendMenu.modifyMenu("symbol",{}),legendMenu.modifyMenu("pen",{})):legendMenu.modifyMenu(null,[{pos:0,name:"curve brush",img:"images/brush.png",title:"Set the fill color.",fun:function(){Utility.setCurveBrush(m_curve,(function(curve){Static.trigger("curveBrushChanged",curve)}))}},{pos:1,name:"curve style",img:"images/style.png",title:"Sets the style of the curve.",fun:function(){var curve=legendMenu.getCurve();curve&&self.curveStyleDlg.curveStyleCb(curve)}},{pos:3,name:"legend attribute",img:"images/attribute.png",title:"Sets how the curve is represented on the legend.",fun:function(){var curve=legendMenu.getCurve();curve&&self.curveAttributeDlg.curveAttributeCb(curve)}},{pos:6,name:"fit",img:"images/fit.png",title:"Defines a curve fitter.",fun:function(){var curve=legendMenu.getCurve();curve&&self.curveFitDlg.curveFitCb(curve)}},{pos:7,name:"symbol",img:"images/symbol.png",title:"attach/modify curve symbol",subMenu:null},{pos:8,name:"pen",img:"images/pen.png",title:"modify/change curve pen",subMenu:legendMenu.getPenSubMenu()}]),curve.rtti===Static.Rtti_PlotSpectroCurve?legendMenu.modifyMenu(null,{name:"pen width",subMenu:legendMenu.getPenWidthSubMenu()}):legendMenu.modifyMenu("pen width",{}),legendMenu.getCurve().fitType?legendMenu.modifyMenu(null,{pos:100,name:"fit info...",title:"Displays information associated with curve fitting.",fun:function(){var curve=legendMenu.getCurve();if(curve){var info=self.curveFitDlg.curveFitInfoCb(curve);info.length?Static.alert(info):Static.alert('No curve fitting equation found for "'+curve.title()+'."')}}}):legendMenu.modifyMenu("fit info...",{})})),this.file.setInputElement($("#fileInput")),this.replot(),this.setAutoReplot(!0),Static.bind("visibilityChange",(function(e,plotItem,on){plotItem.rtti==Static.Rtti_PlotCurve&&(self.hasVisiblePlotCurve()?self.watchAreaBelowCurve.setEnable(self.tbar.isDropdownItemChecked("Watch",6)):self.watchAreaBelowCurve.setEnable(!1))}));var el=self.getLayout().getCentralDiv(),menu=[{name:"Hide rulers",img:"images/hide.png",title:"Hide all rulers",fun:function(){self.rv.setVisible(!1)}},{name:"Show rulers",img:"images/show.png",title:"Show any hidden rulers",fun:function(){self.rv.setVisible(!0)}},{name:"Unlock rulers",img:"images/unlock.png",title:"Unlock any locked rulers",fun:function(){self.rv.unlockAllRulers()}},{name:"Remove all curves",title:"Permanently remove all curves",img:"images/scissors.png",fun:function(){var L=self.itemList(Static.Rtti_PlotCurve);L.forEach((function(curve){curve.detach()})),(L=self.itemList(Static.Rtti_PlotSpectroCurve)).forEach((function(curve){curve.detach()})),(L=self.itemList(Static.Rtti_PlotSpectrogram)).forEach((function(curve){curve.detach()}))}}];Static.bind("rulerDeselected",(function(){el.contextMenu(menu,{triggerOn:"contextmenu",zIndex:1})})),el.contextMenu(menu,{triggerOn:"contextmenu",zIndex:1});var m_gridlinesAccordingToCurve=!0;Static.bind("gridlinesAccordingToCurve",(function(e,gridlinesAccordingToCurve){m_gridlinesAccordingToCurve=gridlinesAccordingToCurve;var currentCurve=rulers.currentCurve();currentCurve&&m_gridlinesAccordingToCurve&&self.grid.setAxes(currentCurve.xAxis(),currentCurve.yAxis())})),Static.bind("currentCurveChanged",(function(e,newCurve){newCurve&&m_gridlinesAccordingToCurve&&self.grid.setAxes(newCurve.xAxis(),newCurve.yAxis()),newCurve&&m_zoomAccordingToCurve&&self.zm.setAxis(newCurve.xAxis(),newCurve.yAxis())})),Static.bind("axisChanged",(function(e,axis,curve){var c=self.rv.currentCurve();curve&&m_gridlinesAccordingToCurve&&self.grid.setAxes(c.xAxis(),c.yAxis()),curve&&m_zoomAccordingToCurve&&self.zm.setAxis(c.xAxis(),c.yAxis())}));var m_zoomAccordingToCurve=!0;Static.bind("zoomAccordingToCurve",(function(e,zoomAccordingToCurve){m_zoomAccordingToCurve=zoomAccordingToCurve;var currentCurve=rulers.currentCurve();currentCurve&&m_zoomAccordingToCurve&&self.zm.setAxis(currentCurve.xAxis(),currentCurve.yAxis())}));const fsOptions={fsServerUrl:"https://grapher-file-system.herokuapp.com",sameDomain:!1,listOfFileTypes:[{display:"Grapher plot (*.plt)",ext:".plt",defaultFilename:"Grapher Plot"},{display:"Data table (*.tbl)",ext:".tbl",defaultFilename:"Data table"},{display:"Defines (*.def)",ext:".def",defaultFilename:"Defines"},{display:"Image (*.png)",ext:".png",defaultFilename:"PNG Image"},{display:"Excel (*.xls)",ext:".xls",defaultFilename:"Excel Worksheet"}],listOfOpenWithTypes:[{name:"Text Editor",options:{encoding:"utf8",flag:"r"}},{name:"Grapher",options:{encoding:"utf8",flag:"r"}}]};function p(params){return new Promise((resolve,reject)=>{resolve(localStorage.getItem("RefreshToken"))})}class FileServices extends FileSystemServices{constructor(options){super(options);const self=this;$(window).on("beforeSave",()=>{}),$(window).on("afterSave",()=>{$("#myText").focus()}),$("#myText").on("input",()=>{self.currentFileModified()})}setData(data,filename,fileExt,editor){alert(`Do not know how to open files with extension "${fileExt}".`)}getRefreshToken(){return super.getRefreshToken()}}const fileSystemServices=self.fileSystemServices=new FileServices(fsOptions);class GrapherEditor extends Editor{constructor(options){super(options);const self=this;options.fs.addSaveMenuItem(self),options.fs.addSaveAsMenuItem(self),options.fs.registerEditor({name:"Grapher",editor:self}),Static.bind("replot",(function(){self.currentFileModified(!0)}))}getData(){return self.file.getPlotData()}setData(data,filename,ext,editorName){".tbl"!=ext&&".txt"!=ext&&".plt"!=ext&&"Grapher"!=editorName||(".plt"!==ext&&".txt"!==ext&&".tbl"!==ext||self.file.setPlotData({content:data,fileName:filename}),".plt"===ext&&this.currentFilename(filename))}}class DefinesEditor extends Editor{constructor(options){super(options);const self=this;options.fs.registerEditor({name:"Defines",editor:this})}}const options={};options.fs=fileSystemServices,options.editorName="Grapher",options.fileExtensions=[".plt",".tbl",".txt"],self.grapherEditor=new GrapherEditor(options);const definesOptions={};definesOptions.fs=fileSystemServices,definesOptions.editorName="Defines",definesOptions.fileExtensions=[".def",".txt"],self.definesEditor=new DefinesEditor(definesOptions),fileSystemServices.enableNotepad();var plotDivContainer=plotDiv.parent(),plotDivContainerWidth=parseFloat(plotDivContainer.css("width")),leftSidebarPercentW=0,rightSidebarPercentW=0;Static.bind("beforePrint",(function(){leftSidebarPercentW=parseFloat(self.leftSidebar.html().css("width")),rightSidebarPercentW=parseFloat(self.rightSidebar.html().css("width")),!self.rightSidebar.isSideBarVisible()&&self.leftSidebar.isSideBarVisible()&&(plotDiv.css("left",0),plotDiv.css("width","98%")),self.rightSidebar.isSideBarVisible()&&!self.leftSidebar.isSideBarVisible()&&plotDiv.css("width","98%"),self.rightSidebar.isSideBarVisible()&&self.leftSidebar.isSideBarVisible()&&(plotDiv.css("left",0),plotDiv.css("width","98%")),self.replot()})),Static.bind("afterPrint",(function(){!self.rightSidebar.isSideBarVisible()&&self.leftSidebar.isSideBarVisible()&&(plotDiv.css("left",plotDivContainerWidth*leftSidebarPercentW/100),plotDiv.css("width",98-leftSidebarPercentW+"%")),self.rightSidebar.isSideBarVisible()&&!self.leftSidebar.isSideBarVisible()&&plotDiv.css("width",98-rightSidebarPercentW+"%"),self.rightSidebar.isSideBarVisible()&&self.leftSidebar.isSideBarVisible()&&(plotDiv.css("left",plotDivContainerWidth*leftSidebarPercentW/100),plotDiv.css("width",98-rightSidebarPercentW-leftSidebarPercentW+"%")),self.replot()}));var tbarDiv=self.tbar.html();Static.bind("resize",(function(){plotDivContainerWidth=parseFloat(plotDivContainer.css("width")),self.replot()})),Static.trigger("resize")}}define("myPlot",["curveClosestPoint","plot","functionData","plotGrid","spectrogram"],(function(){}));class Curve extends PlotSeriesItem{constructor(tle){super(tle),Static.LegendNoAttribute=0,Static.LegendShowLine=1,Static.LegendShowSymbol=2,Static.LegendShowBrush=4;var m_style=Lines,c_attributes=0,m_baseline=0,m_paintAttributes=FilterPoints,m_legendAttributes=Static.LegendNoAttribute,m_brush=new Misc.Brush,m_pen=new Misc.Pen,m_curveFitter=null,m_symbol=null;function qwtSqr(x){return x*x}
/*!
        Find the closest curve point for a specific position

        \param pos Position, where to look for the closest curve point
        \param dist If dist != NULL, closestPoint() returns the distance between
        the position and the closest curve point
        \return Index of the closest curve point, or -1 if none can be found
        ( f.e when the curve has no points )
        \note closestPoint() implements a dumb algorithm, that iterates
        over all points
         */this.rtti=Static.Rtti_PlotCurve,this.setItemInterest(ScaleInterest,!0),this.minXValue=function(){return this.boundingRect().left()},this.maxXValue=function(){return this.boundingRect().right()},this.minYValue=function(){return this.boundingRect().top()},this.maxYValue=function(){return this.boundingRect().bottom()}
/*!
        Specify an attribute how to draw the legend icon

        \param attribute Attribute
        \param on On/Off
        /sa testLegendAttribute(). legendIcon()
         */,this.setLegendAttribute=function(attribute,on){on!=this.testLegendAttribute(attribute)&&(on?m_legendAttributes|=attribute:m_legendAttributes&=~attribute,Utility.updateLegendIconSize(this),this.plot()&&this.plot().updateLegend(this))}
/*!
        \return True, when attribute is enabled
        \sa setLegendAttribute()
         */,this.testLegendAttribute=function(attribute){return m_legendAttributes&attribute},this.legendAttributes=function(){return m_legendAttributes}
/*!
        \brief Assign a symbol

        The curve will take the ownership of the symbol, hence the previously
        set symbol will be delete by setting a new one. If \p symbol is
        \c NULL no symbol will be drawn.

        \param symbol Symbol
        \sa symbol()
         */,this.setSymbol=function(symbol){symbol!==m_symbol&&(m_symbol=symbol,Utility.updateLegendIconSize(this),this.legendChanged(),this.itemChanged())}
/*!
        \return Current symbol or NULL, when no symbol has been assigned
        \sa setSymbol()
         */,this.symbol=function(){return m_symbol},this.setBrush=function(brush){"string"==typeof brush&&(brush=new Misc.Brush(brush)),m_brush=brush,this.legendChanged(),this.itemChanged()},this.brush=function(){return m_brush},this.setPen=function(pen){"object"==typeof pen&&(m_pen=pen,this.legendChanged(),this.itemChanged())},this.pen=function(){return m_pen}
/*!
        Specify an attribute how to draw the curve

        \param attribute Paint attribute
        \param on On/Off
        \sa testPaintAttribute()
         */,this.setPaintAttribute=function(attribute,on){on?m_paintAttributes|=attribute:m_paintAttributes&=~attribute}
/*!
        \return True, when attribute is enabled
        \sa setPaintAttribute()
         */,this.testPaintAttribute=function(attribute){return m_paintAttributes&attribute}
/*!
        Initialize data with an array of points.

        \param samples Vector of points
        \note QVector is implicitly shared
        \note QPolygonF is derived from QVector<QPointF>
         */,this.setSamples=function(samples){this.setData(new PointSeriesData(samples))}
/*!
        Specify an attribute for drawing the curve

        \param attribute Curve attribute
        \param on On/Off

        /sa testCurveAttribute(), setCurveFitter()
         */,this.setCurveAttribute=function(attribute,on){void 0===on&&(on=!0),(c_attributes&attribute)!=on&&(on?c_attributes|=attribute:c_attributes&=~attribute,this.itemChanged())}
/*!
        \return true, if attribute is enabled
        \sa setCurveAttribute()
         */,this.curveAttributes=function(){return c_attributes}
/*!
        \return true, if attribute is enabled
        \sa setCurveAttribute()
         */,this.testCurveAttribute=function(attribute){return c_attributes&attribute},this.init=function(){this.setItemAttribute(Legend,!0),this.setItemAttribute(AutoScale,!0),this.setData(new PointSeriesData),this.setCurveAttribute(Fitted,!0),this.setZ(20)}
/*!
        Set the curve's drawing style

        \param style Curve style
        \sa style()
         */,this.setStyle=function(style){style!=m_style&&(m_style=style,this.legendChanged(),this.itemChanged())}
/*!
        \return Style of the curve
        \sa setStyle()
         */,this.style=function(){return m_style}
/*!
        Draw an interval of the curve

        \param painter Painter
        \param xMap Maps x-values into pixel coordinates.
        \param yMap Maps y-values into pixel coordinates.
        \param canvasRect Contents rectangle of the canvas
        \param from Index of the first point to be painted
        \param to Index of the last point to be painted. If to < 0 the
        curve will be painted to its last point.

        \sa drawCurve(), drawSymbols(),
         */,this.drawSeries=function(xMap,yMap,from,to){var ctx=this.getContext(),painter=new PaintUtil.Painter(ctx),numSamples=this.dataSize();numSamples<=0||(to<0&&(to=numSamples-1),Utility.mVerifyRange(numSamples,from,to)>0&&(painter.save(),painter.setPen(m_pen),painter.setBrush(m_brush),this.drawCurve(painter,m_style,xMap,yMap,from,to),painter.restore(),m_symbol&&m_symbol.style()!==NoSymbol&&(painter.save(),painter.setPen(m_symbol.pen()),painter.setBrush(m_symbol.brush()),this.drawSymbols(ctx,m_symbol,xMap,yMap,from,to),painter.restore())),painter=null)}
/*!
        Draw symbols

        \param painter Painter
        \param symbol Curve symbol
        \param xMap x map
        \param yMap y map
        \param canvasRect Contents rectangle of the canvas
        \param from Index of the first point to be painted
        \param to Index of the last point to be painted

        \sa setSymbol(), drawSeries(), drawCurve()
         */,this.drawSymbols=function(ctx,symbol,xMap,yMap,from,to){var mapper=new PointMapper;mapper.setFlag(WeedOutPoints,this.testPaintAttribute(FilterPoints));for(var chunkSize=500,i=from;i<=to;i+=500){var n=Math.min(500,to-i+1),points=mapper.toPointsF(xMap,yMap,this.data(),i,i+n-1);points.length>0&&symbol.drawSymbols(ctx,points)}}
/*!
        \brief Set the value of the baseline

        The baseline is needed for filling the curve with a brush or
        the Sticks drawing style.

        The interpretation of the baseline depends on the orientation().
        With Qt::Horizontal, the baseline is interpreted as a horizontal line
        at y = baseline(), with Qt::Vertical, it is interpreted as a vertical
        line at x = baseline().

        The default value is 0.0.

        \param value Value of the baseline
        \sa baseline(), setBrush(), setStyle(), QwtPlotAbstractSeriesItem::orientation()
         */,this.setBaseline=function(value){m_baseline!=value&&(m_baseline=value,this.itemChanged())}
/*!
        \return Value of the baseline
        \sa setBaseline()
         */,this.baseline=function(){return m_baseline}
/*!
        \brief Draw the line part (without symbols) of a curve interval.
        \param painter Painter
        \param style curve style, see QwtPlotCurve::CurveStyle
        \param xMap x map
        \param yMap y map
        \param canvasRect Contents rectangle of the canvas
        \param from index of the first point to be painted
        \param to index of the last point to be painted
        \sa draw(), drawDots(), drawLines(), drawSteps(), drawSticks()
         */,this.drawCurve=function(painter,style,xMap,yMap,from,to){switch(style){case Lines:this.testCurveAttribute(Fitted)&&(from=0,to=this.dataSize()-1),this.drawLines(painter,xMap,yMap,from,to);break;case Sticks:this.drawSticks(painter,xMap,yMap,from,to);break;case Steps:this.drawSteps(painter,xMap,yMap,from,to);break;case Dots:this.drawDots(painter,xMap,yMap,from,to)}}
/*!
        \brief Draw lines

        If the CurveAttribute Fitted is enabled a QwtCurveFitter tries
        to interpolate/smooth the curve, before it is painted.

        \param painter Painter
        \param xMap x map
        \param yMap y map
        \param canvasRect Contents rectangle of the canvas
        \param from index of the first point to be painted
        \param to index of the last point to be painted

        \sa setCurveAttribute(), setCurveFitter(), draw(),
        drawLines(), drawDots(), drawSteps(), drawSticks()
         */
/*!
        Assign a curve fitter

        The curve fitter "smooths" the curve points, when the Fitted
        CurveAttribute is set. setCurveFitter(NULL) also disables curve fitting.

        The curve fitter operates on the translated points ( = widget coordinates)
        to be functional for logarithmic scales. Obviously this is less performant
        for fitting algorithms, that reduce the number of points.

        For situations, where curve fitting is used to improve the performance
        of painting huge series of points it might be better to execute the fitter
        on the curve points once and to cache the result in the QwtSeriesData object.

        \param curveFitter() Curve fitter
        \sa Fitted
         */,this.setCurveFitter=function(curveFitter){m_curveFitter=curveFitter,this.itemChanged()}
/*!
        Get the curve fitter. If curve fitting is disabled NULL is returned.

        \return Curve fitter
        \sa setCurveFitter(), Fitted
         */,this.curveFitter=function(){return m_curveFitter},this.closestPoint=function(pos,dist){let numSamples=this.dataSize();if(null==this.plot()||numSamples<=0)return-1;let series=this.data(),xMap=this.plot().canvasMap(this.xAxis()),yMap=this.plot().canvasMap(this.yAxis()),index=-1,dmin=1e10;for(var i=0;i<numSamples;i++){let sample=series.sample(i),cx=xMap.transform(sample.x)-pos.x,cy=yMap.transform(sample.y)-pos.y,f=qwtSqr(cx)+qwtSqr(cy);f<dmin&&(index=i,dmin=f)}return dist&&(dist.distance=Math.sqrt(dmin)),index}
/*!
        Fill the area between the curve and the baseline with
        the curve brush

        \param painter Painter
        \param xMap x map
        \param yMap y map
        \param canvasRect Contents rectangle of the canvas
        \param polygon Polygon - will be modified !

        \sa setBrush(), setBaseline(), setStyle()
         */,this.fillCurve=function(painter,xMap,yMap,polygon){m_brush.color!=Static.NoBrush&&(this.closePolyline(xMap,yMap,polygon),polygon.length<=2||(painter.setPen(new Misc.Pen(m_brush.color)),painter.drawPolygon(polygon)))}
/*!
        \brief Complete a polygon to be a closed polygon including the
        area between the original polygon and the baseline.

        \param painter Painter
        \param xMap X map
        \param yMap Y map
        \param polygon Polygon to be completed
         */,this.closePolyline=function(xMap,yMap,polygon){if(!(polygon.length<2)){var baseline=m_baseline;if(this.orientation()==Vertical){yMap.transformation()&&(baseline=yMap.transformation().bounded(baseline));var refY=yMap.transform(baseline);polygon.push(new Misc.Point(polygon[polygon.length-1].x,refY)),polygon.push(new Misc.Point(polygon[0].x,refY))}else{xMap.transformation()&&(baseline=xMap.transformation().bounded(baseline));var refX=xMap.transform(baseline);polygon.push(new Misc.Point(refX,polygon[polygon.length-1].y)),polygon.push(new Misc.Point(refX,polygon[0].y))}}}
/*!
        Draw step function

        The direction of the steps depends on Inverted attribute.

        \param painter Painter
        \param xMap x map
        \param yMap y map
        \param canvasRect Contents rectangle of the canvas
        \param from index of the first point to be painted
        \param to index of the last point to be painted

        \sa CurveAttribute, setCurveAttribute(),
        draw(), drawCurve(), drawDots(), drawLines(), drawSticks()
         */,this.drawSteps=function(painter,xMap,yMap,from,to){for(var points=[],sz=2*(to-from)+1,i=0;i<sz;++i)points.push(new Misc.Point);var inverted=this.orientation()==Vertical;c_attributes&Inverted&&(inverted=!inverted);var series=this.data(),i,ip;for(i=from,ip=0;i<=to;i++,ip+=2){var sample=series.sample(i),xi=xMap.transform(sample.x),yi=yMap.transform(sample.y);if(ip>0){var p0=points[ip-2],p=points[ip-1];inverted?(p.x=p0.x,p.y=yi):(p.x=xi,p.y=p0.y)}points[ip].x=xi,points[ip].y=yi}painter.drawPolyline(points),"noBrush"!=this.brush()&&this.fillCurve(painter,xMap,yMap,points)}
/*!
        Draw sticks

        \param painter Painter
        \param xMap x map
        \param yMap y map
        \param canvasRect Contents rectangle of the canvas
        \param from index of the first point to be painted
        \param to index of the last point to be painted

        \sa draw(), drawCurve(), drawDots(), drawLines(), drawSteps()
         */,this.drawSticks=function(painter,xMap,yMap,from,to){for(var x0=xMap.transform(m_baseline),y0=yMap.transform(m_baseline),o=this.orientation(),series=this.data(),i=from;i<=to;i++){var sample=series.sample(i),xi=xMap.transform(sample.x),yi=yMap.transform(sample.y);o==Horizontal?painter.drawLine(x0,yi,xi,yi):painter.drawLine(xi,y0,xi,yi)}}
/*!
        Draw dots

        \param painter Painter
        \param xMap x map
        \param yMap y map
        \param canvasRect Contents rectangle of the canvas
        \param from index of the first point to be painted
        \param to index of the last point to be painted

        \sa draw(), drawCurve(), drawSticks(), drawLines(), drawSteps()
         */,this.drawDots=function(painter,xMap,yMap,from,to){var mapper=new PointMapper;if(m_paintAttributes&FilterPoints&&mapper.setFlag(WeedOutPoints,!0),m_paintAttributes&MinimizeMemory)for(var series=this.data(),i=from;i<=to;i++){var sample=series.sample(i),xi=xMap.transform(sample.x),yi=yMap.transform(sample.y);painter.drawPoint(new Misc.Point(xi,yi))}else{var points=mapper.toPointsF(xMap,yMap,this.data(),from,to);painter.drawPoints(points)}}
/*!
        \return Icon representing the curve on the legend

        \param index Index of the legend entry
        ( ignored as there is only one )
        \param size Icon size

        \sa QwtPlotItem::setLegendIconSize(), QwtPlotItem::legendData()
         */,this.legendIcon=function(index,size){if(0===size.width&&0===size.height)return null;var graphic=new Graphic(null,size.width,size.height),painter=new PaintUtil.Painter(graphic);if(0==this.legendAttributes()||this.legendAttributes()&Static.LegendShowBrush){var brush=this.brush();if(brush.color==Static.NoBrush&&0==this.legendAttributes()&&(this.style()!=NoCurve?brush=new Misc.Brush(this.pen().color):this.symbol()&&this.symbol().style()!=NoSymbol&&(brush=new Misc.Brush(this.symbol().pen().color))),brush.color!=Static.NoBrush){var r=new Misc.Rect(0,0,size.width,size.height);painter.fillRect(r,brush)}}if(this.legendAttributes()&Static.LegendShowLine&&this.pen().color!=Static.NoPen){var pn=this.pen();painter.setPen(pn);var y=.5*size.height;painter.drawLine(0,y,size.width,y)}if(this.legendAttributes()&Static.LegendShowSymbol&&this.symbol()){var sh=size.height/2;this.symbol().style()==Ellipse&&(sh-=1),painter.setPen(this.symbol().pen()),this.symbol().drawGraphicSymbol(painter,new Misc.Point(size.width/2,sh),size)}return painter=null,graphic},this.removePoint=function(point,always){null==always&&(always=!1);var samples=this.data().samples();if(1!=samples.length||always){for(var newSamples=[],i=0;i<samples.length;++i)samples[i].isEqual(point)||newSamples.push(samples[i]);newSamples.length!==samples.length||always?(this.setSamples(newSamples),this.itemChanged(),Static.trigger("pointRemoved",this)):Static.alert("The point selected for removal does not exist.")}else Static.alert("You cannot remove the only point in the curve. Remove the entire curve.")},this.toString=function(){return"[Curve]"},this.init()}
/*!
    \brief Draw lines

    If the CurveAttribute Fitted is enabled a QwtCurveFitter tries
    to interpolate/smooth the curve, before it is painted.

    \param painter Painter
    \param xMap x map
    \param yMap y map
    \param canvasRect Contents rectangle of the canvas
    \param from index of the first point to be painted
    \param to index of the last point to be painted

    \sa setCurveAttribute(), setCurveFitter(), draw(),
    drawLines(), drawDots(), drawSteps(), drawSticks()
     */drawLines(painter,xMap,yMap,from,to){if(!(from>to)){var doFit=this.curveAttributes()&Fitted&&this.curveFitter(),doFill=this.brush().color!==Static.NoBrush,doIntegers=!1,mapper,polyline=(new PointMapper).toPolygonF(xMap,yMap,this.data(),from,to);doFit&&(polyline=this.curveFitter().fitCurve(polyline)),painter.drawPolyline(polyline),doFill&&this.fillCurve(painter,xMap,yMap,polyline)}}}define("plotcurve",["static","seriesData"],(function(){}));class MyCurve extends Curve{constructor(tle){super(tle)}}define("myCurve",["plotcurve"],(function(){}));
/*!
Constructor
\param title Title of the curve
 */
/*!
Constructor
\param tle Title of the curve
 */
class SpectroCurve extends PlotSeriesItem{constructor(tle){super(tle),this.rtti=Static.Rtti_PlotSpectroCurve;var m_colorMap=new LinearColorMap(Enum.Format.Indexed),m_colorRange=new Interval(0,1e3),m_penWidth=0,m_colorTable=[];this.init=function(){this.setItemAttribute(Legend,!0),this.setItemAttribute(AutoScale,!0),this.setData(new Point3DSeriesData)}
/*!
        Specify an attribute how to draw the curve

        \param attribute Paint attribute
        \param on On/Off
        \sa testPaintAttribute()
         */,this.setPaintAttribute=function(attribute,on){on?m_paintAttributes|=attribute:m_paintAttributes&=~attribute}
/*!
        \return True, when attribute is enabled
        \sa setPaintAttribute()
         */,this.testPaintAttribute=function(attribute){return m_paintAttributes&attribute}
/*!
        Initialize data with an array of samples.
        \param samples Vector of points
         */,this.setSamples=function(samples){this.setData(new Point3DSeriesData(samples))}
/*!
        Change the color map
        Often it is useful to display the mapping between intensities and
        colors as an additional plot axis, showing a color bar.
        \param colorMap Color Map

        \sa colorMap(), setColorRange(), QwtColorMap::color(),
        QwtScaleWidget::setColorBarEnabled(), QwtScaleWidget::setColorMap()
         */,this.setColorMap=function(colorMap){colorMap!=m_colorMap&&(m_colorMap=colorMap),itemChanged()}
/*!
        \return Color Map used for mapping the intensity values to colors
        \sa setColorMap(), setColorRange(), QwtColorMap::color()
         */,this.colorMap=function(){return m_colorMap}
/*!
        Set the value interval, that corresponds to the color map

        \param interval interval.minValue() corresponds to 0.0,
        interval.maxValue() to 1.0 on the color map.

        \sa colorRange(), setColorMap(), QwtColorMap::color()
         */,this.setColorRange=function(interval){interval!=m_colorRange&&(m_colorRange=interval,this.itemChanged())}
/*!
        \return Value interval, that corresponds to the color map
        \sa setColorRange(), setColorMap(), QwtColorMap::color()
         */,this.colorRange=function(){return m_colorRange}
/*!
        Assign a pen width

        \param penWidth New pen width
        \sa penWidth()
         */,this.setPenWidth=function(penWidth){penWidth<0&&(penWidth=0),m_penWidth!=penWidth&&(m_penWidth=penWidth,this.itemChanged())}
/*!
        \return Pen width used to draw a dot
        \sa setPenWidth()
         */,this.penWidth=function(){return m_penWidth},this.setColorInterval=function(color1,color2){m_colorMap.setColorInterval(color1,color2),this.itemChanged()},this.color1=function(){return m_colorMap.color1()},this.color2=function(){return m_colorMap.color2()}
/*!
        Draw a subset of the points

        \param painter Painter
        \param xMap Maps x-values into pixel coordinates.
        \param yMap Maps y-values into pixel coordinates.
        \param canvasRect Contents rectangle of the canvas
        \param from Index of the first sample to be painted
        \param to Index of the last sample to be painted. If to < 0 the
        series will be painted to its last sample.

        \sa drawDots()
         */,this.drawSeries=function(xMap,yMap,from,to){var ctx=this.getContext(),painter=new PaintUtil.Painter(ctx);this.dataSize()<=0||(to<0&&(to=this.dataSize()-1),from<0&&(from=0),from>to||(this.drawDots(painter,xMap,yMap,from,to),painter=null))}
/*!
        Draw a subset of the points

        \param painter Painter
        \param xMap Maps x-values into pixel coordinates.
        \param yMap Maps y-values into pixel coordinates.
        \param canvasRect Contents rectangle of the canvas
        \param from Index of the first sample to be painted
        \param to Index of the last sample to be painted. If to < 0 the
        series will be painted to its last sample.

        \sa drawSeries()
         */,this.drawDots=function(painter,xMap,yMap,from,to){if(m_colorRange.isValid()){var format=m_colorMap.format();format==Enum.Format.Indexed&&(m_colorTable=m_colorMap.colorTable(m_colorRange));for(var series=this.data(),i=from;i<=to;i++){var sample=series.sample(i),xi=xMap.transform(sample.x),yi=yMap.transform(sample.y);if(format==Enum.Format.RGB){var rgb=m_colorMap.rgb(m_colorRange,sample.z);painter.setPen(new Misc.Pen(Static.RGB2HTML(rgb),m_penWidth)),painter.setBrush(new Misc.Brush(Static.RGB2HTML(rgb)))}else{var index=parseInt(m_colorMap.colorIndex(m_colorRange,sample.z)),color=m_colorTable[index];painter.setPen(new Misc.Pen(Static.RGB2HTML(color),m_penWidth)),painter.setBrush(new Misc.Brush(Static.RGB2HTML(color)))}painter.drawPoint(new Misc.Point(xi,yi))}m_colorTable=[]}},this.init()}}
/*!
Assign a series of samples

setSamples() is just a wrapper for setData() without any additional
value - beside that it is easier to find for the developer.

\param data Data
\warning The item takes ownership of the data object, deleting
it when its not used anymore.
 */define("plotSpectroCurve",["static","colorMap","plotItem","seriesData"],(function(){}));class LegendData{constructor(){var m_map={},m_empty=!0;function contains(role){return void 0!==m_map[role]}this.title=function(){return this.value(Static.TitleRole)},this.icon=function(){return this.value(Static.IconRole)},this.mode=function(){return this.hasRole(Static.ModeRole)?this.value(Static.ModeRole):Static.ReadOnly},this.setValue=function(role,val){m_map[role]=val,m_empty=!1},this.isValid=function(){return!m_empty}
/*!
        \param role Attribute role
        \return True, when the internal map has an entry for role
         */,this.hasRole=function(role){return contains(role)},this.value=function(role){return contains(role)?m_map[role]:null},this.toString=function(){return"[LegendData]"}}}class AbstractLegend{constructor(){Static.makeAbstract(this,AbstractLegend);var m_plot=null,m_checked=!1,m_legendDiv=null,m_maxChar="",m_iconWidth=0,m_maxWidth=100,margin=8,m_checkChangeFn=function(plotItem,check){plotItem.setVisible(!check),m_plot.autoReplot()||m_plot.replot()};"undefined"!=typeof checkChangeFn&&(m_checkChangeFn=checkChangeFn);var m_itemList=[],tbl=$("<table/>").attr({});function removeElementAt(index){index>-1&&m_itemList.splice(index,1)}this.setLegendDiv=function(div){m_legendDiv||((m_legendDiv=div).append(tbl),m_legendDiv.css("overflow","auto"))},this.legendDiv=function(){return m_legendDiv},this.setPlot=function(plot){m_plot=plot,m_legendDiv!==$("#legendDiv")&&plot.getLayout().getPlotDiv().append(m_legendDiv)},this.isEmpty=function(){return!(tbl[0].rows.length>=1)},this.setMaxWidth=function(width){m_maxWidth=width},this.maxWidth=function(){return m_maxWidth},this.legendDivWidth=function(){var w=m_plot.legendFont().textSize(m_maxChar).width+m_iconWidth+8;return w<this.maxWidth()?w:this.maxWidth()},this.addItem=function(plotItem,rowNumber){var font=plotItem.plot().legendFont(),itemData=plotItem.legendData()[0];if(itemData.isValid()){var title=itemData.title(),icon=itemData.icon();icon&&icon.width()>m_iconWidth&&(m_iconWidth=icon.width());var row=$("<tr />"),tdElem=$('<td class="unchecked"></td>'),textLabel=$("<label />");textLabel.css("color",font.fontColor),textLabel.css("font-size",font.th),textLabel.text(" "+title);var spanElem=$("<span/>");icon&&icon.setParent(spanElem),textLabel.appendTo(spanElem),spanElem.appendTo(tdElem),row.append(tdElem),tbl.append(row),void 0!==rowNumber&&rowNumber>-1?(m_itemList.splice(rowNumber,0,plotItem),Static.setElementIndex(row,rowNumber)):m_itemList.push(plotItem),tdElem.on("click",plotItem,(function(event){"unchecked"===$(this).attr("class")?($(this).removeClass("unchecked"),$(this).addClass("checked"),m_checked=!0):($(this).removeClass("checked"),$(this).addClass("unchecked"),m_checked=!1),m_checkChangeFn&&m_checkChangeFn(event.data,m_checked)})),plotItem.title().length>m_maxChar.length&&(m_maxChar=plotItem.title())}},this.removeItem=function(plotItem){var rowNumber=m_itemList.indexOf(plotItem);if(!(rowNumber<0))return removeElementAt(rowNumber),tbl[0].deleteRow(rowNumber),parseInt(tbl.css("height"))<parseInt(m_legendDiv.css("height"))&&m_legendDiv.css("overflow-y","auto"),parseInt(tbl.css("width"))<parseInt(m_legendDiv.css("width"))&&m_legendDiv.css("overflow-x","auto"),rowNumber},this.clearLegend=function(){for(var numRows=tbl[0].rows.length,i=0;i<numRows;++i)tbl[0].deleteRow(0)},this.rowNumberFromName=function(name){for(var Rows=tbl[0].rows,i=0;i<Rows.length;++i)if(Rows[i].cells[0].innerText===name)return i;return-1}}toString(){return"[AbstractLegend]"}
/*!
    Render the legend into a given rectangle.

    \param painter Painter
    \param rect Bounding rectangle
    \param fillBackground When true, fill rect with the widget background

    \sa renderLegend() is used by QwtPlotRenderer
     */
renderLegend(painter,rect,fillBackground){return!0}
/*!
    \brief Update the entries for a plot item

    \param itemInfo Info about an item
    \param data List of legend entry attributes for the  item
     */
updateLegend(itemInfo,data){}}class MLegend extends AbstractLegend{constructor(){super(),this.toString=function(){return"[MLegend]"}}}define("legend",["static"],(function(){}));class Magnifier extends HObject{constructor(plot){super(plot);for(var m_plot=null,m_isEnabled=!0,m_wheelFactor=1.9,m_wheelModifiers=Static.NoModifier,m_mouseFactor=.95,m_mouseButton=Static.RightButton,m_mouseButtonModifiers=Static.NoModifier,m_keyFactor=.9,m_zoomInKey=107,m_zoomInKeyModifiers=Static.Key_Shift,m_zoomOutKey=109,m_zoomOutKeyModifiers=Static.Key_Shift,m_mousePressed=!1,m_zoomInKeyModifiersEnabled=!1,m_zoomOutKeyModifiersEnabled=!1,initialPosX=0,initialPosY=0,tm=0,m_isAxisEnabled=[],axis=0;axis<axisCnt;axis++)m_isAxisEnabled[axis]=!0;m_isAxisEnabled[1]=!1,m_isAxisEnabled[3]=!1,
/*!
		\brief En/Disable an axis

		Only Axes that are enabled will be zoomed.
		All other axes will remain unchanged.

		\param axis Axis, see QwtPlot::Axis
		\param on On/Off

		\sa isAxisEnabled()
		 */
this.setAxisEnabled=function(axis,on){axis>=0&&axis<axisCnt&&(m_isAxisEnabled[axis]=on)}
/*!
		Test if an axis is enabled

		\param axis Axis, see QwtPlot::Axis
		\return True, if the axis is enabled

		\sa setAxisEnabled()
		 */,this.isAxisEnabled=function(axis){return!(axis>=0&&axis<axisCnt)||m_isAxisEnabled[axis]},void 0!==plot&&(plot.magnifier=this,m_plot=plot,this.setElement(m_plot.getLayout().getCentralDiv())),this.plot=function(){return m_plot}
/*!
		\brief Change the wheel factor

		The wheel factor defines the ratio between the current range
		on the parent widget and the zoomed range for each step of the wheel.

		Use values > 1 for magnification (i.e. 2.0) and values < 1 for
		scaling down (i.e. 1/2.0 = 0.5). You can use this feature for
		inverting the direction of the wheel.

		The default value is 0.9.

		\param factor Wheel factor
		\sa wheelFactor(), setWheelButtonState(),
		setMouseFactor(), setKeyFactor()
		 */,this.setWheelFactor=function(factor){m_wheelFactor=factor}
/*!
		\return Wheel factor
		\sa setWheelFactor()
		 */,this.wheelFactor=function(){return m_wheelFactor}
/*!
		Assign keyboard modifiers for zooming in/out using the wheel.
		The default modifiers are Qt::NoModifiers.

		\param modifiers Keyboard modifiers
		\sa wheelModifiers()
		 */,this.setWheelModifiers=function(modifiers){m_wheelModifiers=modifiers}
/*!
		\return Wheel modifiers
		\sa setWheelModifiers()
		 */,this.wheelModifiers=function(){return m_wheelModifiers}
/*!
		\brief Change the mouse factor

		The mouse factor defines the ratio between the current range
		on the parent widget and the zoomed range for each vertical mouse movement.
		The default value is 0.95.

		\param factor Wheel factor
		\sa mouseFactor(), setMouseButton(), setWheelFactor(), setKeyFactor()
		 */,this.setMouseFactor=function(factor){m_mouseFactor=factor}
/*!
		\return Mouse factor
		\sa setMouseFactor()
		 */,this.mouseFactor=function(){return m_mouseFactor}
/*!
		Assign the mouse button, that is used for zooming in/out.
		The default value is Qt::RightButton.

		\param button Button
		\param modifiers Keyboard modifiers

		\sa getMouseButton()
		 */,this.setMouseButton=function(button,modifiers){m_mouseButton=button,m_mouseButtonModifiers=modifiers},this.getMouseButton=function(){return{button:m_mouseButton,modifiers:m_mouseButtonModifiers}}
/*!
		\brief Change the key factor

		The key factor defines the ratio between the current range
		on the parent widget and the zoomed range for each key press of
		the zoom in/out keys. The default value is 0.9.

		\param factor Key factor
		\sa keyFactor(), setZoomInKey(), setZoomOutKey(),
		setWheelFactor, setMouseFactor()
		 */,this.setKeyFactor=function(factor){m_keyFactor=factor}
/*!
		\return Key factor
		\sa setKeyFactor()
		 */,this.keyFactor=function(){return m_keyFactor}
/*!
		Assign the key, that is used for zooming in.
		The default combination is Qt::Key_Plus + Qt::NoModifier.

		\param key
		\param modifiers
		\sa getZoomInKey(), setZoomOutKey()
		 */,this.setZoomInKey=function(key,modifiers){m_zoomInKey=key,m_zoomInKeyModifiers=modifiers}
/*!
		\brief Retrieve the settings of the zoom in key

		\param key Key code, see Qt::Key
		\param modifiers Keyboard modifiers

		\sa setZoomInKey()
		 */,this.getZoomInKey=function(){return{key:m_zoomInKey,modifiers:m_zoomInKeyModifiers}}
/*!
		Assign the key, that is used for zooming out.
		The default combination is Qt::Key_Minus + Qt::NoModifier.

		\param key
		\param modifiers
		\sa getZoomOutKey(), setZoomOutKey()
		 */,this.setZoomOutKey=function(key,modifiers){m_zoomOutKey=key,m_zoomOutKeyModifiers=modifiers}
/*!
		\brief Retrieve the settings of the zoom out key

		\param key Key code, see Qt::Key
		\param modifiers Keyboard modifiers

		\sa setZoomOutKey()
		 */,this.getZoomOutKey=function(){return{key:m_zoomOutKey,modifiers:m_zoomOutKeyModifiers}},this.setEnabled=function(on){m_isEnabled=on},this.isEnabled=function(on){return m_isEnabled},this.event=function(event){if(m_isEnabled)switch(event.type){case"mousedown":return null==this.plot()||(event.button!==m_mouseButton||(initialPosX=event.clientX,initialPosY=event.clientY,m_mousePressed=!0,!0));case"mouseup":event.button===m_mouseButton&&m_mousePressed&&this.plot()&&(m_mousePressed=!1);break;case"mousemove":if(!m_mousePressed)return;var dy=event.clientY-initialPosY;if(0!=dy){var f=m_mouseFactor;dy<0&&(f=1/f),this.rescale(f)}initialPosX=event.clientX,initialPosY=event.clientY;break;case"keydown":event.keyCode==m_zoomInKeyModifiers&&(m_zoomInKeyModifiersEnabled=!0),event.keyCode==m_zoomOutKeyModifiers&&(m_zoomOutKeyModifiersEnabled=!0),event.keyCode==m_zoomInKey&&m_zoomInKeyModifiersEnabled?this.rescale(m_keyFactor):event.keyCode==m_zoomOutKey&&m_zoomOutKeyModifiersEnabled&&this.rescale(1/m_keyFactor);break;case"keyup":event.keyCode==m_zoomInKeyModifiers&&(m_zoomInKeyModifiersEnabled=!1),event.keyCode==m_zoomOutKeyModifiers&&(m_zoomOutKeyModifiersEnabled=!1);break;case"mousewheel":if(0!=m_wheelFactor){var f=Math.pow(m_wheelFactor,Math.abs(event.deltaY/15));event.deltaY>0&&(f=1/f),this.rescale(f)}}}
/*!
		Zoom in/out the axes scales
		\param factor A value < 1.0 zooms in, a value > 1.0 zooms out.
		 */,this.rescale=function(factor){var plt=this.plot();if(null!=plt&&1!=(factor=Math.abs(factor))&&0!=factor){var doReplot=!1,autoReplot=plt.autoReplot();plt.setAutoReplot(!1),clearTimeout(tm),Static.trigger("magnifyingStart");for(var axisId=0;axisId<axisCnt;axisId++){var scaleDiv=this.plot().axisScaleDiv(axisId);if(this.isAxisEnabled(axisId)){var scaleEngine=this.plot().axisScaleEngine(axisId),center,width_2,lower,upper;scaleEngine instanceof LogScaleEngine?(center=(Static.mLog(scaleEngine.base(),scaleDiv.lowerBound())+Static.mLog(scaleEngine.base(),scaleDiv.upperBound()))/2,width_2=(Static.mLog(scaleEngine.base(),scaleDiv.upperBound())-Static.mLog(scaleEngine.base(),scaleDiv.lowerBound()))/2*factor,lower=Math.pow(scaleEngine.base(),center-width_2),upper=Math.pow(scaleEngine.base(),center+width_2)):(lower=(center=scaleDiv.lowerBound()+scaleDiv.range()/2)-(width_2=scaleDiv.range()/2*factor),upper=center+width_2),plt.setAxisScale(axisId,lower,upper),doReplot=!0}}return tm=setTimeout((function(){Static.trigger("magnifyingEnd")}),100),plt.setAutoReplot(autoReplot),doReplot&&plt.replot(),!1}},this.setEnabled_1(!0),this.toString=function(){return"[Magnifier]"}}}define("magnifier",["static","hObject"],(function(){}));
/*!
\brief QwtPlotZoomer provides stacked zooming for a plot widget

QwtPlotZoomer selects rectangles from user inputs ( mouse or keyboard )
translates them into plot coordinates and adjusts the axes to them.
The selection is supported by a rubber band and optionally by displaying
the coordinates of the current mouse position.

Zooming can be repeated as often as possible, limited only by
maxStackDepth() or minZoomSize().  Each rectangle is pushed on a stack.

The default setting how to select rectangles is
a QwtPickerDragRectMachine with the following bindings:

- QwtEventPattern::MouseSelect1\n
The first point of the zoom rectangle is selected by a mouse press,
the second point from the position, where the mouse is released.

- QwtEventPattern::KeySelect1\n
The first key press selects the first, the second key press
selects the second point.

- QwtEventPattern::KeyAbort\n
Discard the selection in the state, where the first point
is selected.

To traverse the zoom stack the following bindings are used:

- QwtEventPattern::MouseSelect3, QwtEventPattern::KeyUndo\n
Zoom out one position on the zoom stack

- QwtEventPattern::MouseSelect6, QwtEventPattern::KeyRedo\n
Zoom in one position on the zoom stack

- QwtEventPattern::MouseSelect2, QwtEventPattern::KeyHome\n
Zoom to the zoom base

The setKeyPattern() and setMousePattern() functions can be used
to configure the zoomer actions. The following example
shows, how to configure the 'I' and 'O' keys for zooming in and out
one position on the zoom stack. The "Home" key is used to
"unzoom" the plot.

\code
zoomer = new QwtPlotZoomer( plot );
zoomer->setKeyPattern( QwtEventPattern::KeyRedo, Qt::Key_I, Qt::ShiftModifier );
zoomer->setKeyPattern( QwtEventPattern::KeyUndo, Qt::Key_O, Qt::ShiftModifier );
zoomer->setKeyPattern( QwtEventPattern::KeyHome, Qt::Key_Home );
\endcode

QwtPlotZoomer is tailored for plots with one x and y axis, but it is
allowed to attach a second QwtPlotZoomer ( without rubber band and tracker )
for the other axes.

\note The realtime example includes an derived zoomer class that adds
scrollbars to the plot canvas.

\sa QwtPlotPanner, QwtPlotMagnifier
 */
class PrivateData_2{constructor(){this.zoomRectIndex,this.zoomStack=[],this.maxStackDepth}}class PlotZoomer extends PlotPicker{constructor(xAxis,yAxis,canvas,doReplot=!0){"number"!=typeof xAxis?super(canvas=xAxis):super(xAxis,yAxis,canvas);var self=this,d_data;this.getZoomerData=function(){return d_data},this.init=function(doReplot){(d_data=new PrivateData_2).maxStackDepth=-1,this.setTrackerMode(Static.ActiveOnly),this.setRubberBand(Static.RectRubberBand),this.setStateMachine(new PickerDragRectMachine),this.plot().zoomer=this,Static.trigger("zoomerAdded",this),doReplot&&this.plot()&&this.plot().replot(),this.setZoomBase(this.scaleRect())}
/*!
		Reinitialized the zoom stack with scaleRect() as base.

		\param doReplot Call QwtPlot::replot() for the attached plot before initializing
		the zoomer with its scales. This might be necessary,
		when the plot is in a state with pending scale changes.

		\sa zoomBase(), scaleRect() QwtPlot::autoReplot(), QwtPlot::replot().
		 */,this.setZoomBase=function(doReplot=!0){if("object"==typeof doReplot){var base=doReplot,plt;if(!(plt=this.plot()))return;var sRect=this.scaleRect(),bRect=base|sRect,bRect=null;bRect=base||sRect,d_data.zoomStack=[],d_data.zoomStack.push(bRect),d_data.zoomRectIndex=0,base.isEqual(sRect)||(d_data.zoomStack.push(sRect),d_data.zoomRectIndex++),this.rescale()}else{var plt;if(null==(plt=this.plot()))return;doReplot&&plt.replot(),d_data.zoomStack=[],d_data.zoomStack.push(this.scaleRect()),d_data.zoomRectIndex=0,this.rescale()}}
/*!
		\return Initial rectangle of the zoomer
		\sa setZoomBase(), zoomRect()
		 */,this.zoomBase=function(){return d_data.zoomStack[0]}
/*!
		\return Rectangle at the current position on the zoom stack.
		\sa zoomRectIndex(), scaleRect().
		 */,this.zoomRect=function(){return d_data.zoomStack[d_data.zoomRectIndex]}
/*!
		\brief Limit the number of recursive zoom operations to depth.

		A value of -1 set the depth to unlimited, 0 disables zooming.
		If the current zoom rectangle is below depth, the plot is unzoomed.

		\param depth Maximum for the stack depth
		\sa maxStackDepth()
		\note depth doesn't include the zoom base, so zoomStack().count() might be
		maxStackDepth() + 1.
		 */,this.setMaxStackDepth=function(depth){if(d_data.maxStackDepth=depth,depth>=0){var zoomOut=d_data.zoomStack.length-1-depth;if(zoomOut>0){this.zoom(-zoomOut);for(var i=d_data.zoomStack.length-1;i>d_data.zoomRectIndex;i--)d_data.zoomStack.pop()}}}
/*!
		\return Maximal depth of the zoom stack.
		\sa setMaxStackDepth()
		 */,this.maxStackDepth=function(){return d_data.maxStackDepth}
/*!
		\return The zoom stack. zoomStack()[0] is the zoom base,
		zoomStack()[1] the first zoomed rectangle.

		\sa setZoomStack(), zoomRectIndex()

		/*QStack<QRectF>*/,this.zoomStack=function(){return d_data.zoomStack}
/*!
		\brief Assign a zoom stack

		In combination with other types of navigation it might be useful to
		modify to manipulate the complete zoom stack.

		\param zoomStack New zoom stack
		\param zoomRectIndex Index of the current position of zoom stack.
		In case of -1 the current position is at the top
		of the stack.

		\note The zoomed signal might be emitted.
		\sa zoomStack(), zoomRectIndex()
		 */,this.setZoomStack=function(zoomStack,zoomRectIndex=-1){if(0!=this.zoomStack.length&&!(d_data.maxStackDepth>=0&&this.zoomStack.length>d_data.maxStackDepth)){(zoomRectIndex<0||zoomRectIndex>this.zoomStack.length)&&(zoomRectIndex=zoomStack.length-1);var doRescale=this.zoomStack[zoomRectIndex]!=this.zoomRect();d_data.zoomStack=zoomStack,d_data.zoomRectIndex=zoomRectIndex,doRescale&&(this.rescale(),Static.trigger("zoomed",this.zoomRect()))}}
/*!
		\return Index of current position of zoom stack.
		 */,this.zoomRectIndex=function(){return d_data.zoomRectIndex}
/*!
		Move the current zoom rectangle.

		\param dx X offset
		\param dy Y offset

		\note The changed rectangle is limited by the zoom base
		 */,this.moveBy=function(dx,dy){var rect=d_data.zoomStack[d_data.zoomRectIndex];moveTo(new Misc.Point(rect.left()+dx,rect.top()+dy))}
/*!
		Move the the current zoom rectangle.

		\param pos New position

		\sa QRectF::moveTo()
		\note The changed rectangle is limited by the zoom base
		 */,this.moveTo=function(pos){var x=pos.x,y=pos.y;x<this.zoomBase().left()&&(x=this.zoomBase().left()),x>this.zoomBase().right()-this.zoomRect().width()&&(x=this.zoomBase().right()-this.zoomRect().width()),y<this.zoomBase().top()&&(y=this.zoomBase().top()),y>this.zoomBase().bottom()-this.zoomRect().height()&&(y=this.zoomBase().bottom()-this.zoomRect().height()),x==this.zoomRect().left()&&y==this.zoomRect().top()||(d_data.zoomStack[d_data.zoomRectIndex].moveTo(x,y),this.rescale())}
/*!
		\brief Zoom in

		Clears all rectangles above the current position of the
		zoom stack and pushes the normalized rectangle on it.

		\note If the maximal stack depth is reached, zoom is ignored.
		\note The zoomed signal is emitted.
		 */,this.zoom=function(rect){if("number"==typeof rect){var offset=rect;if(0==offset)d_data.zoomRectIndex=0;else{var newIndex=d_data.zoomRectIndex+offset;newIndex=Math.max(0,newIndex),newIndex=Math.min(d_data.zoomStack.length-1,newIndex),d_data.zoomRectIndex=newIndex}this.rescale(),Static.trigger("zoomed",this.zoomRect())}else{if(d_data.maxStackDepth>=0&&d_data.zoomRectIndex>=d_data.maxStackDepth)return;var zoomRect=rect.normalized();if(!zoomRect.isEqual(d_data.zoomStack[d_data.zoomRectIndex])){for(var i=d_data.zoomStack.length-1;i>d_data.zoomRectIndex;i--)d_data.zoomStack.pop();d_data.zoomStack.push(zoomRect),d_data.zoomRectIndex++,this.rescale(),Static.trigger("zoomed",zoomRect)}}}
/*!
		A signal emitting the zoomRect(), when the plot has been
		zoomed in or out.

		\param rect Current zoom rectangle.
		 */
/*!
		Adjust the observed plot to zoomRect()

		\note Initiates QwtPlot::replot()
		 */,this.rescale=function(){var plt=this.plot();if(plt){var rect=d_data.zoomStack[d_data.zoomRectIndex];if(!rect.isEqual(this.scaleRect())){var doReplot=plt.autoReplot();plt.setAutoReplot(!1);var x1=rect.left(),x2=rect.right();if(!plt.axisScaleDiv(this.xAxis()).isIncreasing()){var temp=x1;x2=x1=x2}plt.setAxisScale(this.xAxis(),x1,x2);var y1=rect.top(),y2=rect.bottom();if(!plt.axisScaleDiv(this.yAxis()).isIncreasing()){var temp=y1;y2=y1=y2}plt.setAxisScale(this.yAxis(),y1,y2),plt.setAutoReplot(doReplot),plt.replot()}}}
/*!
		\brief Limit zooming by a minimum rectangle

		\return zoomBase().width() / 10e4, zoomBase().height() / 10e4
		 */,this.minZoomSize=function(){return new Misc.Size(d_data.zoomStack[0].width()/1e5,d_data.zoomStack[0].height()/1e5)}
/*!
		\brief Check and correct a selected rectangle

		Reject rectangles with a height or width < 2, otherwise
		expand the selected rectangle to a minimum size of 11x11
		and accept it.

		\return true If the rectangle is accepted, or has been changed
		to an accepted one.
		 */,this.accept=function(pa){if(pa.length<2)return!1;var rect=new Misc.Rect(pa[0],pa[pa.length-1]),minSize=2;if((rect=rect.normalized()).width()<2&&rect.height()<2)return!1;var minZoomSize=11,center=rect.center();return rect.setSize(rect.size().expandedTo(new Misc.Size(11,11))),rect.moveCenter(center),pa.resize(2),pa[0]=rect.topLeft(),pa[1]=rect.bottomRight(),!0},canvas&&this.init(doReplot)}
/*!
	Qt::Key_Plus zooms in, Qt::Key_Minus zooms out one position on the
	zoom stack, Qt::Key_Escape zooms out to the zoom base.

	Changes the current position on the stack, but doesn't pop
	any rectangle.

	\note The keys codes can be changed, using
	QwtEventPattern::setKeyPattern: 3, 4, 5
	 */widgetKeyPressEvent(ke){this.isActive()||(this.keyMatch(Enum.KeyPatternCode.KeyUndo,ke)?this.zoom(-1):this.keyMatch(Enum.KeyPatternCode.KeyRedo,ke)?this.zoom(1):this.keyMatch(Enum.KeyPatternCode.KeyHome,ke)&&this.zoom(0)),super.widgetKeyPressEvent(ke)}
/*!
	Qt::MidButton zooms out one position on the zoom stack,
	Qt::RightButton to the zoom base.

	Changes the current position on the stack, but doesn't pop
	any rectangle.

	\note The mouse events can be changed, using
	QwtEventPattern::setMousePattern: 2, 1
	 */widgetMouseReleaseEvent(me){this.mouseMatch(Enum.MousePatternCode.MouseSelect2,me)||(this.mouseMatch(Enum.MousePatternCode.MouseSelect3,me)?this.zoom(-1):this.mouseMatch(Enum.MousePatternCode.MouseSelect6,me)?this.zoom(1):super.widgetMouseReleaseEvent(me))}
/*!
	Expand the selected rectangle to minZoomSize() and zoom in
	if accepted.

	\param ok If true, complete the selection and emit selected signals
	otherwise discard the selection.

	\sa accept(), minZoomSize()
	\return True if the selection has been accepted, false otherwise
	 */end(ok=!0){if(!(ok=super.end(ok)))return!1;var plot;if(!this.plot())return!1;var pa=this.selection();if(pa.length<2)return!1;var rect=new Misc.Rect(pa[0],pa[pa.length-1]);rect=rect.normalized();var zoomRect=this.invTransform(rect).normalized(),minSize;if(this.minZoomSize().isValid()){var center=zoomRect.center();zoomRect.setSize(zoomRect.size().expandedTo(this.minZoomSize())),zoomRect.moveCenter(center)}return this.zoom(zoomRect),!0}
/*!
	Rejects selections, when the stack depth is too deep, or
	the zoomed rectangle is minZoomSize().

	\sa minZoomSize(), maxStackDepth()
	 */begin(){var d=this.getZoomerData();if(!(d.maxStackDepth>=0&&d.zoomRectIndex>=d.maxStackDepth)){var minSize=this.minZoomSize();if(minSize.isValid()){var sz=new Misc.Size(.9999*d.zoomStack[d.zoomRectIndex].width(),.9999*d.zoomStack[d.zoomRectIndex].height());if(minSize.width>=sz.width&&minSize.height>=sz.height)return}super.begin()}}
/*!
	Reinitialize the axes, and set the zoom base to their scales.

	\param xAxis X axis
	\param yAxis Y axis
	 */setAxis(xAxis,yAxis){xAxis==super.xAxis()&&yAxis==super.yAxis()||(super.setAxis(xAxis,yAxis),void 0!==this.setZoomBase&&this.setZoomBase(this.scaleRect()))}}define("plotzoomer",["plotpicker"],(function(){}));class MyPlotZoomer extends PlotZoomer{constructor(plot){super(plot),this.setEnabled(!1),this.setTrackerMode(Static.AlwaysOff),this.setTrackerPen(new Misc.Pen("blue"))}trackerText(pos){var plot=this.plot(),label;pos=this.invTransform(pos);var decimalPlacesX=0;decimalPlacesX=plot.axisEnabled(xBottom)?plot.axisDecimalPlaces(xBottom):plot.axisEnabled(xTop)?plot.axisDecimalPlaces(xTop):plot.axisDecimalPlaces(xBottom);var decimalPlacesY=0;switch(decimalPlacesY=plot.axisEnabled(yLeft)?plot.axisDecimalPlaces(yLeft):plot.axisEnabled(yRight)?plot.axisDecimalPlaces(yRight):plot.axisDecimalPlaces(yLeft),this.rubberBand()){case Static.HLineRubberBand:label=Static.adjustForDecimalPlaces(pos.y,decimalPlacesY).toString();break;case Static.VLineRubberBand:label=Static.adjustForDecimalPlaces(pos.x,decimalPlacesX).toString();break;default:label=Static.adjustForDecimalPlaces(pos.x,decimalPlacesX).toString()+", "+Static.adjustForDecimalPlaces(pos.y,decimalPlacesY).toString()}return label}}define("myZoomer",["plotzoomer"],(function(){}));class CurveFitter{constructor(){
/*!
        Find a curve which has the best fit to a series of data points

        \param polygon Series of data points
        \return Curve points
        subclass must reimplement
     */
this.fitCurve=function(polygon){throw'"fitCurve()" not reimplemented in subclass'}}}
/*!
Spline type
The default setting is Auto
\sa setFitMode(), FitMode()
*/
/*!
Use the default spline algorithm for polygons with
increasing x values ( p[i-1] < p[i] ), otherwise use
a parametric spline algorithm.
*/
/*!
  \brief A curve fitter using cubic splines
*/
class SplineCurveFitter extends CurveFitter{constructor(){super();var m_fitMode=Enum.FitMode.Auto,m_spline=new Spline,m_splineSize=100;function fitSpline(points){if(m_spline.setPoints(points),!m_spline.isValid())return points;for(var fittedPoints=new Array(m_splineSize),x1=points[0].x,x2,dx,delta=(points[points.length-1].x-x1)/(m_splineSize-1),i=0;i<m_splineSize;i++){var v=x1+i*delta,sv=m_spline.value(v);fittedPoints[i]=new Misc.Point(v,sv)}return m_spline.reset(),fittedPoints}function fitParametric(points){for(var i,size=points.length,fittedPoints=[],i=0;i<m_splineSize;i++)fittedPoints.push(new Misc.Point(-1,-1));for(var splinePointsX=[],splinePointsY=[],i=0;i<size;i++)splinePointsX.push(new Misc.Point(-1,-1)),splinePointsY.push(new Misc.Point(-1,-1));var p=points,spX=splinePointsX,spY=splinePointsY,param=0;for(i=0;i<size;i++){var x=p[i].x,y=p[i].y;if(i>0){var delta=Math.sqrt(Static.sqr(x-spX[i-1].y)+Static.sqr(y-spY[i-1].y));param+=Math.max(delta,1)}spX[i].x=param,spX[i].y=x,spY[i].x=param,spY[i].y=y}if(m_spline.setPoints(splinePointsX),!m_spline.isValid())return points;var deltaX=splinePointsX[size-1].x/(m_splineSize-1);for(i=0;i<m_splineSize;i++){var dtmp=i*deltaX;fittedPoints[i].x=m_spline.value(dtmp)}if(m_spline.setPoints(splinePointsY),!m_spline.isValid())return points;var deltaY=splinePointsY[size-1].x/(m_splineSize-1);for(i=0;i<m_splineSize;i++){var dtmp=i*deltaY;fittedPoints[i].y=m_spline.value(dtmp)}return fittedPoints}this.setFitMode=function(mode){},this.fitMode=function(){},this.setSpline=function(spline){(m_spline=spline).reset()},this.spline=function(){return m_spline},this.setSplineSize=function(splineSize){m_splineSize=Math.max(splineSize,10)},this.splineSize=function(){return m_splineSize},this.fitCurve=function(points){var size=points.length;if(size<=2)return points;var fitMode=m_fitMode;if(fitMode==Enum.FitMode.Auto){fitMode=Enum.FitMode.Spline;for(var p=points,i=1;i<size;i++)if(p[i].x<=p[i-1].x){fitMode=Enum.FitMode.ParametricSpline;break}}return fitMode==Enum.FitMode.ParametricSpline?fitParametric(points):fitSpline(points)}}}class WC_PrivateData{constructor(){this.tolerance=1,this.chunkSize=0}}class WC_Line{constructor(i1=0,i2=0){this.from=i1,this.to=i2}}
/*!
  \brief A curve fitter implementing Douglas and Peucker algorithm

  The purpose of the Douglas and Peucker algorithm is that given a 'curve'
  composed of line segments to find a curve not too dissimilar but that
  has fewer points. The algorithm defines 'too dissimilar' based on the
  maximum distance (tolerance) between the original curve and the
  smoothed curve.

  The runtime of the algorithm increases non linear ( worst case O( n*n ) )
  and might be very slow for huge polygons. To avoid performance issues
  it might be useful to split the polygon ( setChunkSize() ) and to run the algorithm
  for these smaller parts. The disadvantage of having no interpolation
  at the borders is for most use cases irrelevant.

  The smoothed curve consists of a subset of the points that defined the
  original curve.

  In opposite to QwtSplineCurveFitter the Douglas and Peucker algorithm reduces
  the number of points. By adjusting the tolerance parameter according to the
  axis scales QwtSplineCurveFitter can be used to implement different
  level of details to speed up painting of curves of many points.
*/
class WeedingCurveFitter extends CurveFitter{constructor(tolerance){var d_data;super();var simplify=function(points){var toleranceSqr=d_data.tolerance*d_data.tolerance,stack=[],p=points,nPoints=points.length,usePoint=[];for(usePoint.resize(nPoints,!1),stack.push(new WC_Line(0,nPoints-1));stack.length;){for(var r=stack.pop(),vecX=p[r.to].x-p[r.from].x,vecY=p[r.to].y-p[r.from].y,vecLength=Math.sqrt(vecX*vecX+vecY*vecY),unitVecX=0!=vecLength?vecX/vecLength:0,unitVecY=0!=vecLength?vecY/vecLength:0,maxDistSqr=0,nVertexIndexMaxDistance=r.from+1,i=r.from+1;i<r.to;i++){var fromVecX=p[i].x-p[r.from].x,fromVecY=p[i].y-p[r.from].y,distToSegmentSqr;if(fromVecX*unitVecX+fromVecY*unitVecY<0)distToSegmentSqr=fromVecX*fromVecX+fromVecY*fromVecY;else{var toVecX=p[i].x-p[r.to].x,toVecY=p[i].y-p[r.to].y,toVecLength=toVecX*toVecX+toVecY*toVecY,s=toVecX*-unitVecX+toVecY*-unitVecY;distToSegmentSqr=s<0?toVecLength:Math.abs(toVecLength-s*s)}maxDistSqr<distToSegmentSqr&&(maxDistSqr=distToSegmentSqr,nVertexIndexMaxDistance=i)}maxDistSqr<=toleranceSqr?(usePoint[r.from]=!0,usePoint[r.to]=!0):(stack.push(new WC_Line(r.from,nVertexIndexMaxDistance)),stack.push(new WC_Line(nVertexIndexMaxDistance,r.to)))}for(var stripped=[],i=0;i<nPoints;i++)usePoint[i]&&stripped.push(p[i]);return stripped}
/*!
		 Assign the tolerance

		 The tolerance is the maximum distance, that is acceptable
		 between the original curve and the smoothed curve.

		 Increasing the tolerance will reduce the number of the resulting points.

		 \param tolerance Tolerance

		 \sa tolerance()
		*/;this.setTolerance=function(tolerance){d_data.tolerance=Math.max(tolerance,0)}
/*!
		  \return Tolerance
		  \sa setTolerance()
		*/,this.tolerance=function(){return d_data.tolerance}
/*!
		 Limit the number of points passed to a run of the Douglas Peucker algorithm

		 The runtime of the Douglas Peucker algorithm increases non linear
		 with the number of points. For a chunk size > 0 the polygon
		 is split into pieces passed to the algorithm one by one.

		 \param numPoints Maximum for the number of points passed to the algorithm

		 \sa chunkSize()
		*/,this.setChunkSize=function(numPoints){numPoints>0&&(numPoints=Math.max(numPoints,3)),d_data.chunkSize=numPoints}
/*!
  
		  \return Maximum for the number of points passed to a run 
				  of the algorithm - or 0, when unlimited
		  \sa setChunkSize()
		*/,this.chunkSize=function(){return d_data.chunkSize}
/*!
		  \param points Series of data points
		  \return Curve points
		*/,this.fitCurve=function(points){var fittedPoints=[];if(0==d_data.chunkSize)fittedPoints=simplify(points);else for(var i=0;i<points.length;i+=d_data.chunkSize){var p=points.mid(i,d_data.chunkSize);fittedPoints=fittedPoints.concat(simplify(p))}return fittedPoints},d_data=new WC_PrivateData,this.setTolerance(tolerance)}}function Spline(){var m_points=null,m_a=[],m_b=[],m_c=[],m_splineType=Static.SplineType.Natural;this.setSplineType=function(splineType){m_splineType=splineType},this.splineType=function(){return m_splineType}
/*!
      \brief Calculate the spline coefficients

      Depending on the value of \a periodic, this function
      will determine the coefficients for a natural or a periodic
      spline and store them internally.

      \param points Points
      \return true if successful
      \warning The sequence of x (but not y) values has to be strictly monotone
               increasing, which means <code>points[i].x() < points[i+1].x()</code>.
           If this is not the case, the function will return false
    */,this.setPoints=function(points){var size=points.length,ok;return size<=2?(this.reset(),!1):(m_points=points,m_a.resize(size-1),m_b.resize(size-1),m_c.resize(size-1),(ok=m_splineType==Static.SplineType.Periodic?this.buildPeriodicSpline(points):this.buildNaturalSpline(points))||this.reset(),ok)},this.points=function(){return m_points},this.reset=function(){m_a.resize(0),m_b.resize(0),m_c.resize(0),m_points.resize(0)},this.isValid=function(){return m_a.length>0}
/*!
      Calculate the interpolated function value corresponding
      to a given argument x.

      \param x Coordinate
      \return Interpolated coordinate
    */,this.value=function(x){if(0==m_a.length)return 0;var i=Static.lookup(x,m_points),delta=x-m_points[i].x;return((m_a[i]*delta+m_b[i])*delta+m_c[i])*delta+m_points[i].y},this.coefficientsA=function(){return m_a},this.coefficientsB=function(){return m_b},this.coefficientsC=function(){return m_c},this.buildNaturalSpline=function(points){var i,p=points,size=points.length,a=m_a,b=m_b,c=m_c,h=new Array(size-1);for(i=0;i<size-1;i++)if(h[i]=p[i+1].x-p[i].x,h[i]<=0)return!1;var d=new Array(size-1),dy1=(p[1].y-p[0].y)/h[0];for(i=1;i<size-1;i++){b[i]=c[i]=h[i],a[i]=2*(h[i-1]+h[i]);var dy2=(p[i+1].y-p[i].y)/h[i];d[i]=6*(dy1-dy2),dy1=dy2}for(i=1;i<size-2;i++)c[i]/=a[i],a[i+1]-=b[i]*c[i];var s=new Array(size);for(s[1]=d[1],i=2;i<size-1;i++)s[i]=d[i]-c[i-1]*s[i-1];for(s[size-2]=-s[size-2]/a[size-2],i=size-3;i>0;i--)s[i]=-(s[i]+b[i]*s[i+1])/a[i];for(s[size-1]=s[0]=0,i=0;i<size-1;i++)a[i]=(s[i+1]-s[i])/(6*h[i]),b[i]=.5*s[i],c[i]=(p[i+1].y-p[i].y)/h[i]-(s[i+1]+2*s[i])*h[i]/6;return!0},this.buildPeriodicSpline=function(points){var i,p=points,size=points.length,a=m_a,b=m_b,c=m_c,d=new Array(size-1),h=new Array(size-1),s=new Array(size);for(i=0;i<size-1;i++)if(h[i]=p[i+1].x-p[i].x,h[i]<=0)return!1;var imax=size-2,htmp=h[imax],dy1=(p[0].y-p[imax].y)/htmp;for(i=0;i<=imax;i++){b[i]=c[i]=h[i],a[i]=2*(htmp+h[i]);var dy2=(p[i+1].y-p[i].y)/h[i];d[i]=6*(dy1-dy2),dy1=dy2,htmp=h[i]}a[0]=Math.sqrt(a[0]),c[0]=h[imax]/a[0];var sum=0;for(i=0;i<imax-1;i++)b[i]/=a[i],i>0&&(c[i]=-c[i-1]*b[i-1]/a[i]),a[i+1]=Math.sqrt(a[i+1]-Static.sqr(b[i])),sum+=Static.sqr(c[i]);for(b[imax-1]=(b[imax-1]-c[imax-2]*b[imax-2])/a[imax-1],a[imax]=Math.sqrt(a[imax]-Static.sqr(b[imax-1])-sum),s[0]=d[0]/a[0],sum=0,i=1;i<imax;i++)s[i]=(d[i]-b[i-1]*s[i-1])/a[i],sum+=c[i-1]*s[i-1];for(s[imax]=(d[imax]-b[imax-1]*s[imax-1]-sum)/a[imax],s[imax]=-s[imax]/a[imax],s[imax-1]=-(s[imax-1]+b[imax-1]*s[imax])/a[imax-1],i=imax-2;i>=0;i--)s[i]=-(s[i]+b[i]*s[i+1]+c[i]*s[imax])/a[i];for(s[size-1]=s[0],i=0;i<size-1;i++)a[i]=(s[i+1]-s[i])/(6*h[i]),b[i]=.5*s[i],c[i]=(p[i+1].y-p[i].y)/h[i]-(s[i+1]+2*s[i])*h[i]/6;return!0}}define("curveFitter",["static"],(function(){})),
/*!
  \brief A class for spline interpolation

  The QwtSpline class is used for cubical spline interpolation.
  Two types of splines, natural and periodic, are supported.

  \par Usage:
  <ol>
  <li>First call setPoints() to determine the spline coefficients
      for a tabulated function y(x).
  <li>After the coefficients have been set up, the interpolated
      function value for an argument x can be determined by calling
      QwtSpline::value().
  </ol>

  \par Example:
  \code
#include <qwt_spline.h>

QPolygonF interpolate(const QPolygonF& points, int numValues)
{
    QwtSpline spline;
    if ( !spline.setPoints(points) )
        return points;

    QPolygonF interpolatedPoints(numValues);

    const double delta =
        (points[numPoints - 1].x() - points[0].x()) / (points.size() - 1);
    for(i = 0; i < points.size(); i++)  / interpolate
    {
        const double x = points[0].x() + i * delta;
        interpolatedPoints[i].setX(x);
        interpolatedPoints[i].setY(spline.value(x));
    }
    return interpolatedPoints;
}
  \endcode
*/
Static.SplineType={},Static.SplineType.Natural=0,Static.SplineType.Periodic=1,Static.lookup=function(x,values){var i1,size=values.length;if(x<=values[0].x)i1=0;else if(x>=values[size-2].x)i1=size-2;else{i1=0;for(var i2=size-2,i3=0;i2-i1>1;)values[i3=i1+(i2-i1>>1)].x>x?i2=i3:i1=i3}return i1},define("spline",["static"],(function(){}));class Panner extends HObject{constructor(plot){super();var self=this,m_plot=null,m_mouseButton=Static.LeftButton,buttonModifiers=Static.NoModifier,abortKey=Static.Key_Escape,abortKeyModifiers=Static.NoModifier,initialPosX=0,initialPosY=0,posX=0,posY=0,m_enabled=!1,m_canvas=null,m_mouseDown=!1,m_cursor="",m_restoreCursor="",m_hasCursor=!1,m_orientations=Vertical|Horizontal,deltaX=0,deltaY=0;function movePlotItems(){for(var itemStore=self.plot().plotItemStore(),i=0;i<itemStore.length;++i){var c=itemStore[i].getCanvas();c.css("left",deltaX),c.css("top",deltaY)}}void 0!==plot&&(plot.panner=this,m_plot=plot),this.plot=function(){return m_plot}
/*!
   Change the mouse button and modifiers used for panning
   The defaults are Qt::LeftButton and Qt::NoModifier
*/,this.setMouseButton=function(btn,modifiers=Static.NoModifier){m_mouseButton=btn,buttonModifiers=modifiers},this.getMouseButton=function(){return{button:m_mouseButton,modifiers:buttonModifiers}},this.setOrientation=function(orientation){m_orientations=orientation},this.rescaleAndRedraw=function(_deltaX,_deltaY){for(var itemStore=self.plot().plotItemStore(),i=0;i<itemStore.length;++i){var c=itemStore[i].getCanvas();c.css("left",0),c.css("top",0)}var doReplot=!1,autoReplot=m_plot.autoReplot();m_plot.setAutoReplot(!1);for(var rescaled=!1,axis=0;axis<axisCnt;axis++){var map=self.plot().canvasMap(axis),p1=map.transform(self.plot().axisScaleDiv(axis).lowerBound()),p2=map.transform(self.plot().axisScaleDiv(axis).upperBound()),d1,d2;axis==xBottom||axis==xTop?(d1=map.invTransform(p1-_deltaX),d2=map.invTransform(p2-_deltaX)):(d1=map.invTransform(p1-_deltaY),d2=map.invTransform(p2-_deltaY)),this.setAxisScale(axis,d1,d2),doReplot=!0}m_plot.setAutoReplot(autoReplot),doReplot&&m_plot.replot()},this.showCursor=function(on){on!=m_hasCursor&&null!=this.plot()&&""!=m_cursor&&(m_hasCursor=on,on?(this.plot().isCursorSet()&&(m_restoreCursor=this.plot().cursor()),this.plot().setCursor(m_cursor)):""!==m_restoreCursor?(this.plot().setCursor(m_restoreCursor),m_restoreCursor=""):this.plot().unsetCursor())},this.setCursor=function(cursor){m_cursor=cursor}
/*!
       \return Cursor that is active while panning
       \sa setCursor()
    */,this.cursor=function(){return""!=m_cursor?m_cursor:null!=this.plot()?this.plot().cursor():""},this.plot()&&this.setEnabled_1(!0),
/*!
        \brief En/disable the panner

        When enabled is true an event filter is installed for
        the observed widget, otherwise the event filter is removed.

        \param enabled true or false
        \sa isEnabled(), eventFilter()
         */
this.setEnabled=function(enabled){if(m_enabled!=enabled){m_enabled=enabled;var w=plot.getCentralWidget();w&&(enabled?w.installEventFilter(this):w.removeEventFilter(this))}},this.isEnabled=function(enabled){return m_enabled},this.widgetMousePressEvent=function(event){var isMobile=Static.isMobile();return!(isMobile||event.button==m_mouseButton&&Utility.modifiers(event)===buttonModifiers)||(isMobile?(initialPosX=event.originalEvent.touches[0].clientX,initialPosY=event.originalEvent.touches[0].clientY,m_mouseDown=!0):(initialPosX=event.clientX,initialPosY=event.clientY,m_mouseDown=!0),this.showCursor(!0),!0)},this.widgetMouseUpEvent=function(event){m_mouseDown&&(m_mouseDown=!1,self.showCursor(!1),0==deltaX&&0==deltaY||(self.rescaleAndRedraw(deltaX,deltaY),deltaX=0,deltaY=0))},this.widgetMouseMoveEvent=function(event){if(m_mouseDown){if(Static.isMobile()){var touchobj=event.originalEvent.changedTouches[0];deltaX=parseInt(touchobj.clientX)-initialPosX,deltaY=parseInt(touchobj.clientY)-initialPosY}else deltaX=event.clientX-initialPosX,deltaY=event.clientY-initialPosY;m_orientations==Vertical&&(deltaX=0),m_orientations==Horizontal&&(deltaY=0),movePlotItems()}},Static.trigger("pannerAdded",this),this.setEnabled(!0)}setAxisScale(axis,d1,d2){this.plot().setAxisScale(axis,d1,d2)}eventFilter(watched,event){if(this.isEnabled()){var mt=!1;switch(event.type){case"mousedown":case"touchstart":this.widgetMousePressEvent(event);break;case"mousemove":case"touchmove":this.widgetMouseMoveEvent(event);break;case"mouseleave":this.widgetMouseUpEvent(event);break;case"mouseup":case"touchend":this.widgetMouseUpEvent(event)}}}}Panner.prototype.toString=function(){return"[Panner]"},define("panner",["static","hObject"],(function(){}));class PlotShapeItem extends PlotItem{constructor(){super("Shape");var m_renderTolerance=0,m_boundingRect=super.boundingRect(),m_pen=new Misc.Pen("black",1,Static.NoPen),m_brush=new Misc.Brush("#006464"),m_shape=new Misc.MPath;this.setItemAttribute(AutoScale,!0),this.setItemAttribute(Legend,!1),this.setZ(8),this.rtti=Static.Rtti_PlotShape,this.getBoundingRect=function(){return m_boundingRect}
/*!
        \brief Set a path built from a rectangle

        \param rect Rectangle
        \sa setShape(), setPolygon(), shape()
         */,this.setRect=function(rect){var path=new Misc.MPath;path.addRect(rect),this.setShape(path)}
/*!
        \brief Set a path built from a polygon

        \param polygon Polygon
        \sa setShape(), setRect(), shape()
         */,this.setPolygon=function(polygon){var shape=new Misc.MPath;shape.addPolygon(polygon),this.setShape(shape)}
/*!
        \brief Set the shape to be displayed

        \param shape Shape
        \sa setShape(), shape()
         */,this.setShape=function(shape){m_shape=shape,m_boundingRect=shape.isEmpty()?PlotItem.prototype.boundingRect.call(this):m_shape.boundingRect()},this.setBrush=function(brush){m_brush=brush,this.itemChanged()},this.brush=function(){return m_brush},this.setPen=function(pen){m_pen=pen,this.itemChanged()},this.pen=function(){return m_pen}
/*!
        Draw the shape item

        \param painter Painter
        \param xMap X-Scale Map
        \param yMap Y-Scale Map
        \param canvasRect Contents rect of the plot canvas
         */,this.draw=function(xMap,yMap){if(this.clearCanvas(),!m_shape.isEmpty()&&(m_pen.style!=Static.NoPen||m_brush!=Static.NoBrush)){var canvasRect=this.getCanvasRect(),cRect=ScaleMap.invTransform_Rect(xMap,yMap,canvasRect);if(m_boundingRect.intersects(cRect)){var ctx=this.getContext(),doAlign=!1,path=ScaleMap.transformPath(xMap,yMap,m_shape,!1),painter=new PaintUtil.Painter(ctx);painter.setBrush(m_brush),painter.setPen(m_pen),painter.drawPath(path),painter=null}}},this.boundingRect=function(){return this.getBoundingRect()},this.toString=function(){return"[PlotShapeItem]"}}}define("plotShapeItem",["static","plotItem"],(function(){}));class CurveShapeItem extends PlotShapeItem{constructor(plot){super();var _curve=null,_poly=null,_lowerLimit=void 0,_upperLimit=void 0,_enabled=!0,self=this;function polygonBelowCurve(){var samples=null,poly=[];if("[SyntheticPointData]"==_curve.data().toString()){let sz=_curve.functionData.size(),smpls=[];for(var i=0;i<sz-1;++i)smpls.push(_curve.functionData.sample(i));samples=smpls}else samples=_curve.data().samples();if(samples&&!(samples.length<2)){if(_lowerLimit<samples[0].x||_upperLimit>samples[samples.length-1].x||_lowerLimit>=_upperLimit)return null;null==_lowerLimit&&(_lowerLimit=samples[0].x),null==_upperLimit&&(_upperLimit=samples[samples.length-1].x);for(var lowerIndex=-1,upperIndex=-1,poly=[],i=1,lowerInterpolatedPt,upperInterpolatedPt;i<samples.length;i++)samples[i].x>_lowerLimit&&-1==lowerIndex&&(lowerIndex=i-1,poly.push(samples[lowerIndex])),samples[i-1].x<_upperLimit&&(upperIndex=i,-1!=lowerIndex&&poly.push(samples[upperIndex]));var axisScaleEngine=_curve.plot().axisScaleEngine(_curve.xAxis()).toString();return"[LinearScaleEngine]"==axisScaleEngine?(lowerInterpolatedPt=samples[lowerIndex].interpolatedPoint(samples[lowerIndex+1],_lowerLimit),upperInterpolatedPt=samples[upperIndex-1].interpolatedPoint(samples[upperIndex],_upperLimit)):"[LogScaleEngine]"==axisScaleEngine&&(lowerInterpolatedPt=samples[lowerIndex].logInterpolatedPoint(samples[lowerIndex+1],_lowerLimit),upperInterpolatedPt=samples[upperIndex-1].logInterpolatedPoint(samples[upperIndex],_upperLimit)),poly.length&&poly[0].x!==lowerInterpolatedPt.x&&poly.splice(0,1,lowerInterpolatedPt),poly.length&&poly[poly.length-1].x!==upperInterpolatedPt.x&&(poly.pop(),poly.push(upperInterpolatedPt)),poly.splice(0,0,new Misc.Point(poly[0].x,Number.MIN_VALUE)),poly.push(new Misc.Point(poly[poly.length-1].x,Number.MIN_VALUE)),poly}}function adjustCurveShape(ruler,pos){ruler&&("v_ruler1"!=ruler.title()&&"v_ruler2"!=ruler.title()||("v_ruler1"==ruler.title()?self.setLowerLimit(pos):self.setUpperLimit(pos)))}this.setEnabled=function(on){(_enabled=on)&&_curve&&_curve.isVisible()?(this.setVisible(!0),this.refresh()):this.setVisible(!1)},this.enabled=function(on){return _enabled},this.setCurve=function(curve){curve&&_curve==curve||(_curve=curve,this.setLimits(),_enabled&&_curve&&_curve.isVisible()&&(this.setVisible(!0),this.refresh()))},this.curve=function(){return _curve},this.refresh=function(){_poly=this.isVisible()&&_curve?polygonBelowCurve():null,this.setPolygon(_poly),_curve&&_poly&&(self.setAxes(_curve.xAxis(),_curve.yAxis()),_curve.plot().autoRefresh())},this.setLimits=function(lowerLimit,upperLimit){_lowerLimit=lowerLimit,_upperLimit=upperLimit,this.refresh()},this.setLowerLimit=function(lowerLimit){_lowerLimit=lowerLimit,this.refresh()},this.setUpperLimit=function(upperLimit){_upperLimit=upperLimit,this.refresh()},Static.bind("visibilityChange",(function(e,curve,on){curve.rtti==Static.Rtti_PlotCurve&&(_curve&&curve==_curve&&_enabled&&on?self.setVisible(!0):(self.plot().curveShapeEnabledByPlotSettings()&&self.setEnabled(self.plot().tbar.isDropdownItemChecked("Watch",6)),curve==_curve&&(self.setVisible(!1),self.setLimits()))),Static.trigger("curveAdjusted")})),Static.bind("axisChanged",(function(e,axis,curve){curve.rtti==Static.Rtti_PlotCurve&&_curve&&curve===_curve&&self.setLimits()}));var prevRulerPos=Number.MAX_VALUE,prevRuler=Number.MAX_VALUE;Static.bind("positionChanging",(function(e,ruler,pos){if(prevRuler!==ruler||prevRulerPos!==pos){var plot=ruler.plot(),doReplot=plot.autoReplot();plot.setAutoReplot(!1),adjustCurveShape(ruler,pos),prevRuler=ruler,prevRulerPos=pos,plot.setAutoReplot(doReplot),plot.autoRefresh()}})),Static.bind("positionChanged",(function(e,ruler,pos){if(ruler&&(prevRuler!==ruler||prevRulerPos!==pos)){var plot=ruler.plot(),doReplot=plot.autoReplot();plot.setAutoReplot(!1),adjustCurveShape(ruler,pos),prevRuler=ruler,prevRulerPos=pos,plot.setAutoReplot(doReplot),plot.autoRefresh()}})),Static.bind("currentCurveChanged",(function(e,newCurve){newCurve&&self.setCurve(newCurve)})),Static.bind("curveShapeColorChanged",(function(e,color){var brush=self.brush();brush.color=color,self.setBrush(brush);var pen=self.pen();pen.color=color,self.setPen(pen)})),Static.bind("watchEnabled",(function(e,watch,on){plot.settings()&&plot.settings().shadeWatchArea&&"Area below curve"==watch.name()&&self.setEnabled(on)})),Static.bind("shadeWatchArea",(function(e,on){plot.setCurveShapeEnabledByPlotSettings(on),!on&&plot.watchAreaBelowCurve.isEnable()||!on&&!plot.watchAreaBelowCurve.isEnable()?self.setEnabled(!1):on&&plot.watchAreaBelowCurve.isEnable()&&self.setEnabled(!0)})),Static.bind("itemAttached",(function(e,plotItem,on){plotItem.rtti==Static.Rtti_PlotCurve&&(on?self.curve():plot.itemList(Static.Rtti_PlotCurve).length&&plot.hasVisiblePlotCurve()||self.setCurve(null),Static.trigger("visibilityChange",[plotItem,on]),1==plot.itemList(Static.Rtti_PlotCurve).length&&Static.trigger("currentCurveChanged",plotItem))})),Static.bind("curveAdjusted",(function(){self.isVisible()&&self.setLimits()})),Static.bind("autoScaleCurveShapeItem",(function(e,on){self.setItemAttribute(AutoScale,on)})),this.attach(plot),this.setEnabled(!1)}}define("curveShapeItem",["plotShapeItem"],(function(){}));class Watches{constructor(plot){var _watchElements=[];function addwatch(watch,options,disabled){plot.rv.addToWatchList(watch),_watchElements.push(options),disabled&&watch.setEnable(!1)}this.watchElements=function(){return _watchElements},addwatch(new WatchCurveName,{text:"Curve name",tooltip:"Name of the curve that is the subject of watches.",checkboxState:"checked"}),addwatch(new WatchLeftRulerPosition(plot.rv),{text:"Left ruler position",tooltip:"Current position of the left ruler.",checkboxState:"checked"}),addwatch(new WatchRightRulerPosition(plot.rv),{text:"Right ruler position",tooltip:"Current position of the right ruler.",checkboxState:"checked"}),addwatch(new WatchBottomRulerPosition(plot.rv),{text:"Bottom ruler position",tooltip:"Current position of the bottom ruler."},!0),addwatch(new WatchTopRulerPosition(plot.rv),{text:"Top ruler position",tooltip:"Current position of the top ruler."},!0),addwatch(new WatchSlope,{text:"Slope at left ruler",tooltip:"Slope (gradient) in the curve at the point where the left ruler intersects the curve."},!0),plot.watchAreaBelowCurve=new WatchAreaBelowCurve,addwatch(plot.watchAreaBelowCurve,{text:"Area below curve",tooltip:"Area bounded by the curve, right ruler, x-axis and left ruler."},!0),addwatch(new WatchVolumeOfRevolution,{text:"Volume of revolution(X)",tooltip:"Volume generated by a 360 degrees rotation about the x-axis of the area bounded by the curve, right ruler, x-axis and left ruler."},!0)}}define("watches",["basicWatch"],(function(){}));class AddRemovePointPicker extends PlotPicker{constructor(plot){super(xBottom,yLeft,Static.NoRubberBand,Static.AlwaysOn,plot);var self=this,curve=null,m_activated=!1;this.setStateMachine(new PickerClickPointMachine);var cp=new CurveClosestPoint(plot,(function(curve,p){m_activated&&(curve.removePoint(p),Static.trigger("curveAdjusted"))}));function enterPoint(p){if(!m_activated)return;if(!curve){(curve=new MyCurve(Utility.generateCurveName(plot))).attach(plot);let color=Utility.randomColor();curve.setPen(new Misc.Pen(color));let sym=new Symbol(MRect,new Misc.Brush(Static.invert(color)),new Misc.Pen(color),new Misc.Size(8,8));curve.setSymbol(sym);let attribute="";Static.showline&&Static.showsymbol?attribute="lineAndSymbol":Static.showline?attribute="line":Static.showsymbol&&(attribute="symbol"),Utility.setLegendAttribute(curve,attribute,curve.getLegendIconSize())}let samples=curve.data().samples();samples.containsPoint(p)||samples.push(p),samples.sort((function(a,b){return a.x-b.x})),curve.setSamples(samples),plot.autoRefresh(),Static.trigger("pointAdded",curve),Static.trigger("curveAdjusted")}this.setEnabled(!1),this.activate=function(on){m_activated=on,this.setEnabled(on),cp.setEnabled(on)},this.setAddRemoveMousePattern=function(pattern,button,modifiers=Static.NoModifier){this.setMousePattern(pattern,button,modifiers),cp.setMousePattern(button,modifiers)},Static.bind("currentCurveChanged",(function(e,_curve){curve!==_curve&&(curve=_curve||null)&&self.setAxis(curve.xAxis(),curve.yAxis())})),Static.bind("pointSelected",(function(){m_activated&&self.setEnabled(!1)})),Static.bind("pointNotSelected",(function(){m_activated&&self.setEnabled(!0)}));var prevPoint=new Misc.Point(Number.MAX_VALUE,Number.MAX_VALUE);Static.bind("selected",(function(e,pickedPoints){var selection=self.selection()[0];selection&&(prevPoint.isEqual(selection)||(prevPoint=selection,enterPoint(curve?ScaleMap.invTransform(plot.axisScaleDraw(curve.xAxis()).scaleMap(),plot.axisScaleDraw(curve.yAxis()).scaleMap(),selection):ScaleMap.invTransform(plot.axisScaleDraw(xBottom).scaleMap(),plot.axisScaleDraw(yLeft).scaleMap(),selection))))}));var f=this.trackerFont();f.fontColor="blue",this.setTrackerFont(f)}trackerText(pos){var plot=this.plot(),label;pos=this.invTransform(pos);var numberOfDigitsX=1;numberOfDigitsX=plot.axisEnabled(xBottom)?plot.axisPrecision(xBottom):plot.axisEnabled(xTop)?plot.axisPrecision(xTop):plot.axisPrecision(xBottom);var numberOfDigitsY=1;numberOfDigitsY=plot.axisEnabled(yLeft)?plot.axisPrecision(yLeft):plot.axisEnabled(yRight)?plot.axisPrecision(yRight):plot.axisPrecision(yLeft);var yVal=Static.toPrecision(pos.y,numberOfDigitsY),xVal=Static.toPrecision(pos.x,numberOfDigitsX);switch(this.rubberBand()){case Static.HLineRubberBand:label=yVal.toString();break;case Static.VLineRubberBand:label=xVal.toString();break;default:label=xVal.toString()+", "+yVal.toString()}return label}}define("addRemovePointPicker",["plot","curveClosestPoint","plotpicker","plotcurve","symbol"],(function(){}));class MFontPickerDlg{constructor(){var self=this,_curve=null;self.labelFont=null;var buildDlg=_.once((function(){$("body").append($('                        <div class="modal fade" id="fontPickerModal" role="dialog">                        <div class="modal-dialog modal-sm">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal">&times;</button>                        <h4 class="modal-title">Font Picker</h4>                        </div>                        <div class="modal-body">                        <div class="row">                        <div class="col-sm-2">Font:</div>                        <div class="col-sm-7">                        <select id="fontPickerFont">                        <option value="Arial">Arial</option>\t\t\t\t\t\t<option value="Arial Black">Arial Black</option>\t\t\t\t\t\t<option value="Comic Sans MS">Comic Sans MS</option>\t\t\t\t\t\t<option value="Courier New">Courier New</option>\t\t\t\t\t\t<option value="Georgia">Georgia</option>\t\t\t\t\t\t<option value="Impact">Impact</option>\t\t\t\t\t\t<option value="Lucida Console">Lucida Console</option>\t\t\t\t\t\t<option value="Lucida Sans Unicode">Lucida Sans Unicode</option>\t\t\t\t\t\t<option value="PalatinoLinotype">PalatinoLinotype</option>\t\t\t\t\t\t<option value="Tahoma">Tahoma</option>\t\t\t\t\t\t<option value="Times New Roman">Times New Roman</option>\t\t\t\t\t\t<option value="Trebuchet MS">Trebuchet MS</option>\t\t\t\t\t\t<option value="Verdana">Verdana</option>\t\t\t\t\t\t<option value="Gill Sans">Gill Sans</option>                        </select>                        </div>                        </div>                        <br>                        <div class="row">                        <div class="col-sm-2">Point:</div>                        <div class="col-sm-4">                        <input id="fontPickerPoint" type="number" min=6 max=40 value=12>                        </div>\t\t\t\t\t\t<div class="col-sm-2">Bold:</div>                        <div class="col-sm-1">                        <input id="fontPickerBold" type="checkbox" >                        </div>                        </div>\t\t\t\t\t\t<br>                        <div class="row">                        <div class="col-sm-2">Color:</div>                        <div class="col-sm-4">                        <input id="fontPickerColor" type="color" >                        </div>\t\t\t\t\t\t</div>                        <br>                        <div class="modal-footer">                        <button id="axisDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Ok</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#fontPickerFont").change((function(){self.labelFont.name=$(this).val()})),$("#fontPickerColor").change((function(){self.labelFont.fontColor=$(this).val()})),$("#fontPickerPoint").change((function(){self.labelFont.th=$(this).val()})),$("#fontPickerBold").change((function(){self.labelFont.weight=$(this)[0].checked?"bold":"normal"}))}));function fontDlgInit(){$("#fontPickerColor").val(self.labelFont.fontColor),$("#fontPickerFont").val(self.labelFont.name),$("#fontPickerPoint").val(self.labelFont.th),"bold"==self.labelFont.weight?$("#fontPickerBold")[0].checked=!0:$("#fontPickerBold")[0].checked=!1}function showDlg(){$("#fontPickerModal").modal({backdrop:"static"})}this.fontPickerCb=function(){buildDlg(),fontDlgInit(),showDlg()}}}define("fontPicker",(function(){}));class MMarkerDlg{constructor(){const self=this;var fontDlg=null;let buildDlg=_.once((function(){fontDlg=new MFontPickerDlg,$("#markerModal").remove(),$("body").append($('                        <div class="modal fade" id="markerModal" role="dialog">                        <div class="modal-dialog modal-md">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class= "close" id="closeMarkerDlg">&times;</button>                        <h4 id="markerTitle" class="modal-title">Marker</h4>                        </div>                        <div class="modal-body">  \x3c!--div class="panel panel-default">    <div class="panel-heading">Panel Heading</div>    <div class="panel-body">    Panel Content    </div>  </div--\x3e  <div class="panel panel-default">    <div class="panel-heading">General</div>    <div class="panel-body">    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">Name</div>    <div class="col-sm-4"><input id="marker_name" type="text"      value="marker_1"></div>    <div class="col-sm-3">Show on legend</div><div class="col-sm-1"><input id="marker_legend" type="checkbox"></div>    </div>\x3c!--row end--\x3e    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">Horizontal axis:</div>    <div class="col-sm-4">       <select id="markerHorizontalAxis">         <option value="markerAxisBottom">Bottom</option>         <option value="markerAxisTop">Top</option>\t </select>    </div>    <div class="col-sm-3">Vertical axis:</div>    <div class="col-sm-2">       <select id="markerVerticalAxis">         <option value="markerAxisLeft">Left</option>         <option value="markerAxisRight">Right</option>       </select>     </div>    </div>\x3c!--row end--\x3e    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">X-value</div>    <div class="col-sm-4"><input id="marker_xValue" type="text"  value=0.0 size="6"></div>    <div class="col-sm-3">Y-value</div><div class="col-sm-2"><input id="marker_yValue" type="text" value=0.0 size="6"></div>    </div>\x3c!--row end--\x3e    </div>  </div><div class="panel panel-default">    <div class="panel-heading">Label</div>    <div class="panel-body">    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">Text</div>    <div class="col-sm-3"><input id="marker_label" type="text"  value="Marker 1" size=12></div>    <div class="col-sm-1">Font</div><div class="col-sm-1"><input id="marker_labelFont" type="button" value="//"></div>    <div class="col-sm-1">Space</div><div class="col-sm-1"><input id="marker_labelSpace" type="number" value=2 min=2 max=40></div>    </div>\x3c!--row end--\x3e    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">Alignment:</div>    <div class="col-sm-3">       <select id="markerLabelAlignment">        <option value="markerAlignmentLeftTop">Left-Top</option>\t\t<option value="markerAlignmentLeftCenter">Left-Center</option>        <option value="markerAlignmentLeftBottom">Left-Bottom </option>        <option value="markerAlignmentRightTop">Right-Top</option>\t\t<option value="markerAlignmentRightCenter">Right-Center</option>        <option value="markerAlignmentRightBottom">Right-Bottom</option>\t    <option value="markerAlignmentCenterTop">Center-Top</option>\t\t<option value="markerAlignmentCenterCenter">Center-Center</option>        <option value="markerAlignmentCenterBottom">Center-Bottom</option>       </select>    </div>    <div class="col-sm-3">Orientation:</div>    <div class="col-sm-3">       <select id="markerLabelOrientation">         <option value="markerLabelHorizontal">Horizontal</option>         <option value="markerLabelVertical">Vertical</option>       </select>    </div>    </div>\x3c!--row end--\x3e    </div>  </div><div class="panel panel-default">    <div class="panel-heading">Line</div>    <div class="panel-body">    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-1">Style:</div>    <div class="col-sm-3">      <select id="markerLineStyle">\t   <option value=NoLine>No line</option>        <option value=VLine>Vertical line</option>        <option value=HLine>Horizontal line</option>\t   <option value=Cross>Cross line</option>      </select>    </div>    <div class="col-sm-2">Pen color</div>    <div class="col-sm-1"><input id="marker_lineColor" type="color"></div>    <div class="col-sm-2">Pen type:</div>    <div class="col-sm-3">      <select id="markerLineType">\t   <option value=solid>solid</option>        <option value=dot>dot</option>        <option value=dash>dash</option>\t   <option value=dashDot>dash-dot</option>\t   <option value=dashDotDot>dash-dot-dot</option>\t </select>    </div>    </div>\x3c!--row end--\x3e    </div>  </div><div class="panel panel-default">    <div class="panel-heading">Symbol</div>    <div class="panel-body">    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-1">Style:</div>                        <div class="col-sm-3">                        <select id="markerSymbol">\t\t\t\t\t\t<option value=none>No symbol</option>                        <option value=arrow>Arrow</option>                        <option value=dotOnLine>Dot-on-line</option>\t\t\t\t\t\t</select>                        </div>\t\t\t\t\t\t<div class="col-sm-1">Angle:</div>                        <div class="col-sm-2"><input id="marker_symbolAngle" type="number" style="width:100%" value=0.0></div><div class="col-sm-3">Size(widthXheight)</div>                        <div class="col-sm-1" title="width x height">                        <select id="markerSymbolSize">\t\t\t\t\t<option value="6x6">6x6</option>                        \t<option value="6x8">6x8</option>                        \t<option value="6x10">6x10</option>\t\t\t\t\t<option value="6x12">6x12</option>                        \t<option value="6x14">6x14</option>\t\t\t\t\t<option value="8x6">8x6</option>                        \t<option value="8x8">8x8</option>                        \t<option value="8x10">8x10</option>\t\t\t\t\t<option value="8x12">8x12</option>                        \t<option value="8x14">8x14</option>\t\t\t\t\t<option value="10x6">10x6</option>                        \t<option value="10x8">10x8</option>                        \t<option value="10x10">10x10</option>\t\t\t\t\t<option value="10x12">10x12</option>                        \t<option value="10x14">10x14</option>\t\t\t\t\t<option value="12x6">12x6</option>                        \t<option value="12x8">12x8</option>                        \t<option value="12x10">12x10</option>\t\t\t\t\t<option value="12x12">12x12</option>                        \t<option value="12x14">12x14</option>\t\t\t\t\t<option value="14x6">14x6</option>                        \t<option value="14x8">14x8</option>                        \t<option value="14x10">14x10</option>\t\t\t\t\t<option value="14x12">14x12</option>                        \t<option value="14x14">14x14</option>\t\t\t\t  </select>                        </div>    </div>\x3c!--row end--\x3e    </div>  </div><div class="modal-footer">                        <button id="markerDlg_cancel" type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>\t\t\t\t\t\t<button id="markerDlg_remove" type="button" class="btn btn-default">Remove</button>                        <button id="markerDlg_ok" type="button" class="btn btn-default">Ok</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#markerSymbolSize").val("14x14"),$("#markerDlg_ok").click(okCb),$("#markerDlg_remove").click(removeCb),$("#closeMarkerDlg").click(closeCb),$("#marker_name").keyup(keyupCb),$("#marker_labelFont").click(labelFontCb),$("#markerLineStyle").click((function(){"NoLine"==$(this).val()?($("#marker_lineColor").attr("disabled",!0),$("#markerLineType").attr("disabled",!0)):($("#marker_lineColor").attr("disabled",!1),$("#markerLineType").attr("disabled",!1))})),$("#markerModal").on("shown.bs.modal",(function(){$("#markerDlg_ok").trigger("focus")}))}));function removeCb(){var marker=self.plot.findPlotMarker($("#marker_name").val());marker&&(marker.detach(),closeCb())}function initDlg(){var marker=self.plot.findPlotMarker($("#marker_name").val());if(marker){fontDlg.labelFont=marker.labelFont(),$("#markerDlg_remove").attr("disabled",!1),$("#marker_label").val(marker.label()),$("#marker_xValue").val(marker.xValue()),$("#marker_yValue").val(marker.yValue()),$("#marker_labelSpace").val(marker.spacing()),marker.labelAlignment()&Static.AlignLeft&&marker.labelAlignment()&Static.AlignTop?$("#markerLabelAlignment").val("markerAlignmentLeftTop"):marker.labelAlignment()&Static.AlignLeft&&marker.labelAlignment()&Static.AlignCenter?$("#markerLabelAlignment").val("markerAlignmentLeftCenter"):marker.labelAlignment()&Static.AlignLeft&&marker.labelAlignment()&Static.AlignBottom?$("#markerLabelAlignment").val("markerAlignmentLeftBottom"):marker.labelAlignment()&Static.AlignRight&&marker.labelAlignment()&Static.AlignTop?$("#markerLabelAlignment").val("markerAlignmentRightTop"):marker.labelAlignment()&Static.AlignRight&&marker.labelAlignment()&Static.AlignCenter?$("#markerLabelAlignment").val("markerAlignmentRightCenter"):marker.labelAlignment()&Static.AlignRight&&marker.labelAlignment()&Static.AlignBottom?$("#markerLabelAlignment").val("markerAlignmentRightBottom"):marker.labelAlignment()&Static.AlignCenter&&marker.labelAlignment()&Static.AlignTop?$("#markerLabelAlignment").val("markerAlignmentCenterTop"):marker.labelAlignment()&Static.AlignCenter&&marker.labelAlignment()&Static.AlignBottom?$("#markerLabelAlignment").val("markerAlignmentCenterBottom"):marker.labelAlignment()&Static.AlignCenter&&$("#markerLabelAlignment").val("markerAlignmentCenterCenter"),marker.labelOrientation()==Horizontal?$("#markerLabelOrientation").val("markerLabelHorizontal"):$("#markerLabelOrientation").val("markerLabelVertical"),marker.testItemAttribute(Legend)?$("#marker_legend")[0].checked=!0:$("#marker_legend")[0].checked=!1,marker.xAxis()===xBottom?$("#markerHorizontalAxis").val("markerAxisBottom"):$("#markerHorizontalAxis").val("markerAxisTop"),marker.yAxis()===yLeft?$("#markerVerticalAxis").val("markerAxisLeft"):$("#markerVerticalAxis").val("markerAxisRight");var mstyle="NoLine",lineStyle=marker.lineStyle();lineStyle==VLine?mstyle="VLine":lineStyle==HLine?mstyle="HLine":lineStyle==Cross&&(mstyle="Cross"),$("#markerLineStyle").val(mstyle),$("#marker_lineColor").val(marker.linePen().color),$("#markerLineType").val(marker.linePen().style);var symbol=marker.symbol();if(symbol){"arrow"===symbol.type?$("#markerSymbol").val("arrow"):"dotOnLine"===symbol.type&&$("#markerSymbol").val("dotOnLine");var path=symbol.path();path&&$("#marker_symbolAngle").val(parseFloat(path.data.rotation))}}else $("#markerDlg_remove").attr("disabled",!0);"NoLine"==$("#markerLineStyle").val()?($("#marker_lineColor").attr("disabled",!0),$("#markerLineType").attr("disabled",!0)):($("#marker_lineColor").attr("disabled",!1),$("#markerLineType").attr("disabled",!1)),symbol&&(6==symbol.size().width&&6==symbol.size().height?$("#markerSymbolSize").val("6x6"):6==symbol.size().width&&8==symbol.size().height?$("#markerSymbolSize").val("6x8"):6==symbol.size().width&&10==symbol.size().height?$("#markerSymbolSize").val("6x10"):6==symbol.size().width&&12==symbol.size().height?$("#markerSymbolSize").val("6x12"):6==symbol.size().width&&14==symbol.size().height?$("#markerSymbolSize").val("6x14"):8==symbol.size().width&&6==symbol.size().height?$("#markerSymbolSize").val("8x6"):8==symbol.size().width&&8==symbol.size().height?$("#markerSymbolSize").val("8x8"):8==symbol.size().width&&10==symbol.size().height?$("#markerSymbolSize").val("8x10"):8==symbol.size().width&&12==symbol.size().height?$("#markerSymbolSize").val("8x12"):8==symbol.size().width&&14==symbol.size().height?$("#markerSymbolSize").val("8x14"):10==symbol.size().width&&6==symbol.size().height?$("#markerSymbolSize").val("10x6"):10==symbol.size().width&&8==symbol.size().height?$("#markerSymbolSize").val("10x8"):10==symbol.size().width&&10==symbol.size().height?$("#markerSymbolSize").val("10x10"):10==symbol.size().width&&12==symbol.size().height?$("#markerSymbolSize").val("10x12"):10==symbol.size().width&&14==symbol.size().height?$("#markerSymbolSize").val("10x14"):12==symbol.size().width&&6==symbol.size().height?$("#markerSymbolSize").val("12x6"):12==symbol.size().width&&8==symbol.size().height?$("#markerSymbolSize").val("12x8"):12==symbol.size().width&&10==symbol.size().height?$("#markerSymbolSize").val("12x10"):12==symbol.size().width&&12==symbol.size().height?$("#markerSymbolSize").val("12x12"):12==symbol.size().width&&14==symbol.size().height?$("#markerSymbolSize").val("12x14"):14==symbol.size().width&&6==symbol.size().height?$("#markerSymbolSize").val("14x6"):14==symbol.size().width&&8==symbol.size().height?$("#markerSymbolSize").val("14x8"):14==symbol.size().width&&10==symbol.size().height?$("#markerSymbolSize").val("14x10"):14==symbol.size().width&&12==symbol.size().height?$("#markerSymbolSize").val("14x12"):14==symbol.size().width&&14==symbol.size().height&&$("#markerSymbolSize").val("14x14"))}function keyupCb(){initDlg()}function labelFontCb(){var marker=self.plot.findPlotMarker($("#marker_name").val()),font;fontDlg.labelFont=marker?marker.labelFont():new Misc.Font,fontDlg.fontPickerCb()}function closeCb(){$("#markerDlg_cancel").click()}function okCb(){var marker=self.plot.findPlotMarker($("#marker_name").val());marker&&marker.detach(),(marker=new PlotMarker($("#marker_name").val())).setSpacing(parseInt($("#marker_labelSpace").val())),fontDlg.labelFont||(fontDlg.labelFont=new Misc.Font),marker.setLabelFont(fontDlg.labelFont),"markerAxisBottom"===$("#markerHorizontalAxis").val()?marker.setXAxis(xBottom):marker.setXAxis(xTop),"markerAxisLeft"===$("#markerVerticalAxis").val()?marker.setYAxis(yLeft):marker.setYAxis(yRight),"arrow"===$("#markerSymbol").val()?marker.setSymbol(new ArrowSymbol(parseFloat($("#marker_symbolAngle").val()))):"dotOnLine"===$("#markerSymbol").val()&&marker.setSymbol(new DotOnLineSymbol(parseFloat($("#marker_symbolAngle").val()))),marker.setLinePen(new Misc.Pen($("#marker_lineColor").val(),1,$("#markerLineType").val())),"HLine"===$("#markerLineStyle").val()?marker.setLineStyle(HLine):"VLine"===$("#markerLineStyle").val()?marker.setLineStyle(VLine):"Cross"===$("#markerLineStyle").val()?marker.setLineStyle(Cross):marker.setLineStyle(NoLine),$("#marker_legend")[0].checked?marker.setItemAttribute(Legend,!0):marker.setItemAttribute(Legend,!1),marker.setLegendIconSize(new Misc.Size(20,20));var xVal=math.evaluate(Static.expandDefines($("#marker_xValue").val())),yVal=math.evaluate(Static.expandDefines($("#marker_yValue").val()));marker.setValue(new Misc.Point(xVal,yVal)),marker.setLabel($("#marker_label").val()),"markerAlignmentLeftTop"==$("#markerLabelAlignment").val()?marker.setLabelAlignment(Static.AlignLeft|Static.AlignTop):"markerAlignmentLeftCenter"==$("#markerLabelAlignment").val()?marker.setLabelAlignment(Static.AlignLeft|Static.AlignCenter):"markerAlignmentLeftBottom"==$("#markerLabelAlignment").val()?marker.setLabelAlignment(Static.AlignLeft|Static.AlignBottom):"markerAlignmentRightTop"==$("#markerLabelAlignment").val()?marker.setLabelAlignment(Static.AlignRight|Static.AlignTop):"markerAlignmentRightCenter"==$("#markerLabelAlignment").val()?marker.setLabelAlignment(Static.AlignRight|Static.AlignCenter):"markerAlignmentRightBottom"==$("#markerLabelAlignment").val()?marker.setLabelAlignment(Static.AlignRight|Static.AlignBottom):"markerAlignmentCenterTop"==$("#markerLabelAlignment").val()?marker.setLabelAlignment(Static.AlignCenter|Static.AlignTop):"markerAlignmentCenterCenter"==$("#markerLabelAlignment").val()?marker.setLabelAlignment(Static.AlignCenter):"markerAlignmentCenterBottom"==$("#markerLabelAlignment").val()&&marker.setLabelAlignment(Static.AlignCenter|Static.AlignBottom),"markerLabelHorizontal"==$("#markerLabelOrientation").val()?marker.setLabelOrientation(Horizontal):"markerLabelVertical"==$("#markerLabelOrientation").val()&&marker.setLabelOrientation(Vertical);var m_symbol=marker.symbol();m_symbol&&("6x6"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(6,6)):"6x10"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(6,12)):"6x12"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(6,12)):"6x14"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(6,14)):"8x6"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(8,6)):"8x8"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(8,8)):"8x10"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(8,10)):"8x12"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(8,12)):"8x14"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(8,14)):"10x6"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(10,6)):"10x8"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(10,8)):"10x10"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(10,10)):"10x12"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(10,12)):"10x14"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(10,14)):"12x6"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(12,6)):"12x8"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(12,8)):"12x10"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(12,10)):"12x12"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(12,12)):"12x14"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(12,14)):"14x6"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(14,6)):"14x8"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(14,8)):"14x10"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(14,10)):"14x12"===$("#markerSymbolSize").val()?m_symbol.setSize(new Misc.Size(14,12)):"14x14"===$("#markerSymbolSize").val()&&m_symbol.setSize(new Misc.Size(14,14))),marker.attach(self.plot),closeCb(),self.plot.autoRefresh()}function showDlg(){initDlg(),$("#markerModal").modal({backdrop:"static"})}this.markerCb=function(plot){buildDlg(),self.plot=plot,showDlg()}}}define("markerDlg",["fontPicker"],(function(){})),define("app/main",["curveLegendAttributeDlg","functionDlg","curveFitDlg","curveStyleDlg","axisDlg","pointEntryDlg","mtoolBar","file","watch","basicWatch","legendMenu","rulers","infoSidebar","infoPropertiesPane","plotSideBar","curvePropertiesPane","plotPropertiesPane","myPlot","myCurve","plotSpectroCurve","plotRasterItem","plotSpectrogram","rasterFileData","rasterFunctionData","pointData","symbol","legend","magnifier","plotGrid","widgetOverlay","myZoomer","curveFitter","spline","panner","contextMenu","plotMarker","curveClosestPoint","curveShapeItem","underscore","widgetOverlay","functionData","watches","addRemovePointPicker","markerDlg","fontPicker"],(function(){Static.alert('This application is design to run in "chrome browser". While it may run in other browsers, some features may not behave as expected.',"small");var plot=new MyPlot($("#plotDiv"),"Plot")})),requirejs.config({baseUrl:"lib",paths:{app:"../app",underscore:"https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min",addRemovePointPicker:"../app/src/addRemovePointPicker",axisDlg:"../app/src/axisDlg",basicWatch:"../app/src/basicWatch",curveClosestPoint:"../app/src/curveClosestPoint",curveFitDlg:"../app/src/curveFitDlg",curveLegendAttributeDlg:"../app/src/curveLegendAttributeDlg",curvePropertiesPane:"../app/src/curvePropertiesPane",curveSettings:"../app/src/curveSettings",curveShapeItem:"../app/src/curveShapeItem",curveStyleDlg:"../app/src/curveStyleDlg",fontPicker:"../app/src/fontPicker",functionData:"../app/src/functionData",functionDlg:"../app/src/functionDlg",infoPropertiesPane:"../app/src/infoPropertiesPane",infoSidebar:"../app/src/infoSidebar",legendMenu:"../app/src/legendMenu",markerDlg:"../app/src/markerDlg",mpicker:"../app/src/mpicker",mtoolBar:"../app/src/mtoolBar",myCurve:"../app/src/myCurve",myPlot:"../app/src/myPlot",myZoomer:"../app/src/myZoomer",pane:"../app/src/pane",plotPropertiesPane:"../app/src/plotPropertiesPane",plotSideBar:"../app/src/plotSideBar",pointEntryDlg:"../app/src/pointEntryDlg",propertiesPane:"../app/src/propertiesPane",rasterFileData:"../app/src/rasterFileData",rasterFunctionData:"../app/src/rasterFunctionData",ruler:"../app/src/ruler",rulers:"../app/src/rulers",settings:"../app/src/settings",sideBar:"../app/src/sideBar",spectrogram:"../app/src/spectrogram",toolBar:"../app/src/toolBar",watch:"../app/src/watch",watches:"../app/src/watches"},shim:{underscore:{exports:"_"},static:{deps:["miscObjects"]},file:{deps:["xlsx","upload"]},plot:{deps:["static","widget","scaleWidget","utility","miscObjects","painter","scaleDiv","interval","scaleMap","scaleWidget","transform","layout","scaleDraw","scaleEngine","pointMapper"]},plotItem:{deps:["static"]},scaleMap:{deps:["static","transform"]},canvas:{deps:["static"]},curveFitter:{deps:["static"]},spline:{deps:["static"]},symbol:{deps:["static","graphic"]},seriesData:{deps:["static","plotItem"]},pointMapper:{deps:["static"]},pointData:{deps:["static","seriesData"]},scaleEngine:{deps:["static"]},scaleDraw:{deps:["static","abstractScaleDraw"]},widget:{deps:["static","hObject"]},widgetOverlay:{deps:["static","widget"]},scaleWidget:{deps:["static","widget"]},picker:{deps:["static","widgetOverlay","pickermachine"]},plotpicker:{deps:["static","picker"]},plotzoomer:{deps:["plotpicker"]},plotGrid:{deps:["static","plotItem"]},plotZoneItem:{deps:["static"]},plotSpectrogram:{deps:["static","conrec","plotRasterItem"]},plotRasterItem:{deps:["static","plotItem"]},plotSpectroCurve:{deps:["static","colorMap","plotItem","seriesData"]},colorMap:{deps:["static"]},plotcurve:{deps:["static","seriesData"]},panner:{deps:["static","hObject"]},magnifier:{deps:["static","hObject"]},plotShapeItem:{deps:["static","plotItem"]},plotMarker:{deps:["static","plotItem"]},legend:{deps:["static"]},pickermachine:{deps:["static","eventpattern"]},widget:{deps:["static","hObject"]},addRemovePointPicker:{deps:["plot","curveClosestPoint","plotpicker","plotcurve","symbol"]},axisDlg:{deps:[]},basicWatch:{deps:["static","watch","plotMarker","symbol"]},curveClosestPoint:{deps:["static","widgetOverlay","plotMarker"]},curveFitDlg:{deps:[]},curveLegendAttributeDlg:{deps:[]},curvePropertiesPane:{deps:["propertiesPane"]},curveSettings:{deps:[]},curveShapeItem:{deps:["plotShapeItem"]},curveStyleDlg:{deps:[]},fontPicker:{deps:[]},functionData:{deps:["pointData"]},functionDlg:{deps:[]},infoPropertiesPane:{deps:["pane"]},infoSidebar:{deps:["sideBar"]},legendMenu:{deps:["static","contextMenu"]},markerDlg:{deps:["fontPicker"]},mpicker:{deps:["static","plotpicker"]},mtoolBar:{deps:["toolBar","curveSettings"]},myCurve:{deps:["plotcurve"]},myPlot:{deps:["curveClosestPoint","plot","functionData","plotGrid","spectrogram"]},myZoomer:{deps:["plotzoomer"]},pane:{deps:[]},plotPropertiesPane:{deps:["propertiesPane"]},plotSideBar:{deps:["sideBar"]},pointEntryDlg:{deps:[]},propertiesPane:{deps:["pane"]},rasterFileData:{deps:["rasterData"]},rasterFunctionData:{deps:["rasterData"]},ruler:{deps:["static","plotMarker"]},rulers:{deps:["static","mpicker","ruler"]},settings:{deps:[]},sideBar:{deps:[]},spectrogram:{deps:["static","plotSpectrogram","colorMap","rasterFileData","rasterFunctionData"]},toolBar:{deps:[]},watch:{deps:[]},watches:{deps:["basicWatch"]}}}),requirejs(["app/main"]),define("app",(function(){}));