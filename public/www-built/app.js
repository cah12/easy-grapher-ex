class MCurveLegendAttributeDlg{constructor(){var t=this,n=!1;function i(e){"small"==e?t.curve.setLegendIconSize(new Misc.Size(t.defaultIconSize.height-4,t.defaultIconSize.height-4)):"medium"==e?t.curve.setLegendIconSize(new Misc.Size(t.defaultIconSize.height,t.defaultIconSize.height)):t.curve.setLegendIconSize(new Misc.Size(t.defaultIconSize.height+4,t.defaultIconSize.height+4))}this.curveAttributeCb=function(e){n||($("body").append($('                    <div class="modal fade" id="curveLegendAttributeModal" role="dialog">                    <div class="modal-dialog modal-sm">                    <div class="modal-content">                    <div class="modal-header">                    <button type="button" class="close" data-dismiss="modal">&times;</button>                    <h4 class="modal-title">Curve Legend Attribute</h4>                    </div>                    <div class="modal-body">                    <div class="row">                    <div class="col-sm-5">Attribute:</div>                    <div class="col-sm-7">                    <select id="curveAttribute">                    <option value="default">Brush color(Default)</option>                    <option value="line">Line</option>                    <option value="symbol">Symbol</option>                    <option value="lineAndSymbol">Line and Symbol</option>                    </select>                    </div>                    </div>                    <br>                    <div class="row" id="iconSizeRow">                    <div class="col-sm-5">Icon size:</div>                    <div class="col-sm-7">                    <select id="iconSize">                    <option value="small">Small</option>                    <option value="medium">Medium</option>                    <option value="large">Large</option>                    </select>                    </div>                    </div>                    <br>                    <div class="modal-footer">                    <button id="curveAttributeDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Ok</button>                    </div>                    </div>                    </div>                    </div>                    </div>                    ')),t.init(),t.defaultIconSize=new Misc.Size(e.getLegendIconSize()),n=!0),t.curve=e,t.curveAttributeDlg(),"line"==$("#curveAttribute").val()||"symbol"==$("#curveAttribute").val()||"lineAndSymbol"==$("#curveAttribute").val()?$("#iconSizeRow").hide():$("#iconSizeRow").show()},this.init=function(){var e=this;$("#curveLegendAttributeModal").on("shown.bs.modal",function(){$("#curveAttributeDlg_ok").trigger("focus")}),$("#curveAttribute").change(function(){Utility.setLegendAttribute(e.curve,$(this).val(),e.defaultIconSize),"line"==$(this).val()||"symbol"==$(this).val()||"lineAndSymbol"==$(this).val()?$("#iconSizeRow").hide():(i($("#iconSize").val()),$("#iconSizeRow").show())}),$("#iconSize").change(function(){i($(this).val())})},this.curveAttributeDlg=function(){t.curve&&t.curve.rtti===Static.Rtti_PlotCurve&&(t.curve.testLegendAttribute(Static.LegendShowLine)&&t.curve.testLegendAttribute(Static.LegendShowSymbol)?$("#curveAttribute").val("lineAndSymbol"):t.curve.testLegendAttribute(Static.LegendShowSymbol)?$("#curveAttribute").val("symbol"):t.curve.testLegendAttribute(Static.LegendShowLine)?$("#curveAttribute").val("line"):$("#curveAttribute").val("default"),$("#curveLegendAttributeModal").modal({backdrop:"static"}),t.curve.getLegendIconSize().width==t.defaultIconSize.width-4?$("#iconSize").val("small"):t.curve.getLegendIconSize().width==t.defaultIconSize.width?$("#iconSize").val("medium"):t.curve.getLegendIconSize().width==t.defaultIconSize.width+4&&$("#iconSize").val("large"))}}}define("curveLegendAttributeDlg",function(){});class MFunctionDlg{constructor(){var e=$('                <div class="modal fade" id="functionModal" role="dialog">                <div class="modal-dialog modal-md">                <div class="modal-content">                <div class="modal-header">                \x3c!--button type="button" class="close" data-dismiss="modal">&times;</button--\x3e                <h4 class="modal-title">Curve Function</h4>                </div>                <div class="modal-body">                <div class="row">                <div class="col-sm-2">Three D:</div>                <div class="col-sm-1"><input id="fnDlg_threeD" type="checkbox"/></div>                <div id="threedTypeContainer">                <div class="col-sm-1">Type:</div>                <div class="col-sm-3"><select id="threeDType">                <option value="spectrocurve">Spectrocurve</option>                <option value="spectrogram">Spectrogram</option>                </select>                </div>                <div id="interpolationContainer">                <div class="col-sm-2">Interpolation:</div>                <div class="col-sm-3"><select id="interpolationType">                <option value="biLinear">Bi-linear</option>                <option value="biCubic">Bi-cubic</option>                </select>                </div>                </div>                </div>                </div>                <br>                <div class="row">                <div class="col-sm-2">Curve title:</div>                <div class="col-sm-4"><input id="fnDlg_title" style="width:100%" type="text" value="curve_1"/></div>                <div id="fx" class="col-sm-1">f(x):</div>                <div class="col-sm-5"><input id="fnDlg_function" style="width:100%" type="text" value="x^2"/></div>                </div>                <br>                <div id="limits" class="row">                <div class="col-sm-3">Lower limit(x):</div>                <div class="col-sm-3"><input id="fnDlg_lowerLimit" style="width:100%" type="text" value="-10.0"/></div>                <div class="col-sm-3">Upper limit(x):</div>                <div class="col-sm-3"><input id="fnDlg_upperLimit" style="width:100%" type="text" value="10.0"/></div>                </div>                <br>                <div id="limitsY" class="row">                <div class="col-sm-3">Lower limit(y):</div>                <div class="col-sm-3"><input id="fnDlg_lowerLimitY" style="width:100%" type="text" value="-10.0"/></div>                <div class="col-sm-3">Upper limit(y):</div>                <div class="col-sm-3"><input id="fnDlg_upperLimitY" style="width:100%" type="text" value="10.0"/></div>                </div>                <br>                <div id="limitsFxy" class="row">                <div class="col-sm-3">Lower limit(f(xy)):</div>                <div class="col-sm-3"><input id="fnDlg_lowerLimitFxy" style="width:100%" type="text" value="0"/></div>                <div class="col-sm-3">Upper limit(f(xy)):</div>                <div class="col-sm-3"><input id="fnDlg_upperLimitFxy" style="width:100%" type="text" value="10.0"/></div>                </div>                <br>                <div id="colorInterval" class="row">                <div class="col-sm-3">Color1(min):</div>                <div class="col-sm-3"><input id="fnDlg_color1" type="color" value="#008b8b"/></div>                <div class="col-sm-3">Color2(max):</div>                <div class="col-sm-3"><input id="fnDlg_color2" type="color" value="#ff0000"/></div>                </div>                <br>                <div class="row">                <div id="unboundedContainer">                <div class="col-sm-3">Unbounded range:</div>                <div class="col-sm-3"><input id="fnDlg_unboundedRange" type="checkbox"/></div>                </div>                <div class="col-sm-3">Number of points:</div>                <div class="col-sm-3"><input id="fnDlg_numberOfPoints" style="width:100%" type="number" min="2" max="200" value="100"/></div>                </div>                <br>                <div id="cont_variable" class="row">                <div class="col-sm-3">Enter variable(x):</div>                <div class="col-sm-1"><input id="fnDlg_variable" style="width:100%" type="text" value="x" /></div>                </div>                <div id="cont_variableY" class="row">                <div class="col-sm-3">Enter variable(y):</div>                <div class="col-sm-1"><input id="fnDlg_variableY" style="width:100%" type="text" value="y" /></div>                </div>                <br>                <div class="modal-footer">                <button id="fnDlg_ok" type="button" class="btn btn-default" >Ok</button>                <button id="fnDlg_cancel" type="button" class="btn btn-default"  data-dismiss="modal">Cancel</button>                </div>                </div>                </div>                </div>                </div>                ');function a(e){var t=[];e=purgeKewords(e);for(var n=0;n<e.length;++n)Static.isAlpha(e[n])&&-1==t.indexOf(e[n])&&t.push(e[n]);return t}function s(e){if(function(e){for(var t=0;t<keywords.length;++t)if(-1!=e.indexOf(keywords[t]))return 1}(e))return e;var t="";t+=e[0];for(var n=1;n<e.length;++n)Static.isAlpha(e[n-1])&&Static.isAlpha(e[n])&&(t+="*"),_.isFinite(e[n-1])&&Static.isAlpha(e[n])&&(t+="*"),t+=e[n];return t}this.init=function(i){var r=this;$("body").append(e),$("#functionModal").on("shown.bs.modal",function(){$("#fnDlg_ok").trigger("focus")}),$("#cont_variable").hide(),$("#cont_variableY").hide(),$("#threedTypeContainer").hide(),$("#colorInterval").hide(),$("#limitsY").hide(),$("#limitsFxy").hide(),$("#interpolationContainer").hide(),r.threeD=!1,$("#fnDlg_unboundedRange").change(function(){$(this)[0].checked?$("#limits").hide():$("#limits").show()}),$("#fnDlg_threeD").change(function(){r.threeD=$(this)[0].checked,r.threeD?($("#threedTypeContainer").show(),$("#limitsY").show(),$("#limitsFxy").show(),$("#unboundedContainer").hide(),$("#fx").html("f(x,y):"),$("#fnDlg_function").val("x^2 + y^2"),$("#colorInterval").show()):($("#threedTypeContainer").hide(),$("#limitsY").hide(),$("#limitsFxy").hide(),$("#unboundedContainer").show(),$("#fx").html("f(x):"),$("#fnDlg_function").val("x^2"),$("#colorInterval").hide()),$("#cont_variable").hide(),$("#cont_variableY").hide(),$("#fnDlg_variable").val("x"),$("#fnDlg_variableY").val("y")}),$("#threeDType").change(function(){"spectrogram"==$(this).val()?$("#interpolationContainer").show():$("#interpolationContainer").hide()}),$("#fnDlg_ok").click(function(){if(200<$("#fnDlg_numberOfPoints").val()||$("#fnDlg_numberOfPoints").val()<2)$("#fnDlg_numberOfPoints").val(60),Static.alert('"Number of points" cannot be \nless than 2 or greater than 200');else{var e=Static.expandDefines($("#fnDlg_function").val());try{r.lowerLimit=math.evaluate(Static.expandDefines($("#fnDlg_lowerLimit").val()));var t=Math.abs(r.lowerLimit);if(0<r.lowerLimit&&t<Math.cbrt(_eps))return void Static.alert(`Absolute value of lower(x) limit must not be less than ${Math.cbrt(_eps)}.`)}catch(e){return void Static.alert("Please enter a valid lower(x) limit.")}try{r.upperLimit=math.evaluate(Static.expandDefines($("#fnDlg_upperLimit").val()));var n=Math.abs(r.upperLimit);if(0<r.upperLimit&&n<Math.cbrt(_eps))return void Static.alert(`Absolute value of upper(x) limit must not be less than ${Math.cbrt(_eps)}.`)}catch(e){return void Static.alert("Please enter a valid upper(x) limit.")}if(r.title=$("#fnDlg_title").val(),r.variable=$("#fnDlg_variable").val(),r.fn=$("#fnDlg_function").val(),r.expandedFn=s(e),r.numOfPoints=parseInt($("#fnDlg_numberOfPoints").val()),r.threeD){r.threeDType=$("#threeDType").val(),"spectrogram"===r.threeDType&&(r.threeDInterpolationType=$("#interpolationType").val());try{r.lowerLimitY=math.evaluate($("#fnDlg_lowerLimitY").val())}catch(e){return void Static.alert("Please enter a valid lower(y) limit.")}try{r.upperLimitY=math.evaluate($("#fnDlg_upperLimitY").val())}catch(e){return void Static.alert("Please enter a valid upper(y) limit.")}try{r.lowerLimitFxy=math.evaluate($("#fnDlg_lowerLimitFxy").val())}catch(e){return void Static.alert("Please enter a valid lower(f(xy)) limit.")}try{r.upperLimitFxy=math.evaluate($("#fnDlg_upperLimitFxy").val())}catch(e){return void Static.alert("Please enter a valid upper(f(xy)) limit.")}r.variableY=$("#fnDlg_variableY").val(),r.color1=$("#fnDlg_color1").val(),r.color2=$("#fnDlg_color2").val()}else{var e=a(r.expandedFn);if(0<e.length&&-1==e.indexOf($("#fnDlg_variable").val()))return Static.alert("Please enter a valid variable."),void $("#cont_variable").show();if(e=parseFloat(r.lowerLimit),parseFloat(r.upperLimit)<=e&&Static.alert("Upper limit is less than Lower limit. Scale will be inverted."),0,r.unboundedRange=$("#fnDlg_unboundedRange")[0].checked,r.coeffs=function(e){for(var t=[],n=purgeKewords(n=e||$("#fnDlg_function").val()),i=$("#fnDlg_variable").val();-1!=n.indexOf(i);)n=n.replace(i,"");for(var r=0;r<n.length;++r)Static.isAlpha(n[r])&&-1==t.indexOf(n[r])&&t.push(n[r]);return t}(r.expandedFn),r.expandedFn=e=(e=r.expandedFn).includes("ln")?e.replace("ln","log"):e,5<r.coeffs.length)return Static.alert("Number of unknown coefficient cannot be greater than 5."),void $("#cont_variable").show()}i()}}),$("#fnDlg_function").on("input",function(){var e=$(this).val();r.threeD?2<a(e).length||-1==e.indexOf("x")||-1==e.indexOf("y")?($("#cont_variable").show(),$("#cont_variableY").show()):($("#cont_variable").hide(),$("#cont_variableY").hide()):1<a(e).length||-1==e.indexOf("x")?$("#cont_variable").show():$("#cont_variable").hide()})},this.functionDlg=function(e){$("#functionModal").modal({backdrop:"static"}),$("#fnDlg_title").val(e)},this.close=function(){$("#fnDlg_cancel").click()}}}define("functionDlg",function(){});class MCurveFitDlg{constructor(){var f=this,p="",m=!1,g=!1,v="",b="",S=-1,y=!1,x=-1,w=-1,_=null,C=null,E={precision:2},e=$('                <div class="modal fade" id="curveFitModal" role="dialog">                <div class="modal-dialog modal-sm">                <div class="modal-content">                <div class="modal-header">                <button type="button" class="close" data-dismiss="modal">&times;</button>                <h4 class="modal-title">Curve Fitter</h4>                </div>                <div class="modal-body">                <div class="row">                <div class="col-sm-5">Fitter type:</div>                <div class="col-sm-7">                <select id="curveFitDlg_type">                <option value="natural">Natural spline</option>                <option value="periodic">Periodic spline</option>                <option value="weeding">Weeding</option>                <option value="linear">Linear</option>                <option value="polynomial">Polynomial</option>                <option value="noFitting">No fitting</option>                </select>                </div>                </div>                <br>                                                <div id="cont_origin">                <div class="row">                <div class="col-sm-7">Through origin:</div>                <div class="col-sm-2"><input id="origin" type="checkbox"/></div>                </div>                <br>                </div>                                <div id="cont_order">                <div class="row">                <div class="col-sm-2">Order:</div>                <div class="col-sm-3"><input id="order" type="number" style="width:100%" value="2" min="1" max="20"/></div><div>Precision: <input id="curveFitDlg_precision" type="number" min="1" max="100" value="2" /></div>                <br>                                               </div>                <br>                </div>                                <div id="cont_tolerance">                <div class="row">                <div class="col-sm-5">Tolerance:</div>                <div class="col-sm-4"><input id="tolerance" type="number" style="width:100%" value="10.0" min="0.0" max="200.0"/></div>                </div>                <br>                </div>                                <div id="cont_chunksize">                <div class="row">                <div class="col-sm-5">Chunk size:</div>                <div class="col-sm-4"><input id="chunksize" type="number" style="width:100%" value="0" min="0" /></div>                </div>                <br>                </div>                \t\t\t\t<div id="cont_retain">                <div class="row">                <div class="col-sm-7">Retain original curve:</div>                <div class="col-sm-2"><input id="curveFitDlg_retain" type="checkbox"/></div>                </div>                <br>\t\t\t\t</div>                                <div id="cont_generate">\t\t\t\t<div class="row">                <div class="col-sm-7">Generate points:</div>                <div class="col-sm-2"><input id="curveFitDlg_generate" type="checkbox" checked/></div>                </div>                <br>\t\t\t\t</div>                                                <div id="attributes">                <div class="row">                <div class="col-sm-6">Fitted curve name:</div>                <div class="col-sm-6"><input id="curveFitDlg_name" type="text" style="width:100%"/></div>                </div>                <br>                <div class="row">                <div class="col-sm-6">Fitted curve color:</div>                <div class="col-sm-2"><input id="curveFitDlg_color" type="color"/></div>                </div>                <br>                </div>                </div>                <div class="modal-footer">                <button id="curveFitDlg_ok" type="button" class="btn btn-default" >Ok</button>                </div>                </div>                </div>                </div>                </div>                ');$("body").append(e),$("#cont_origin").hide(),$("#cont_order").hide(),$("#cont_tolerance").hide(),$("#cont_chunksize").hide(),$("#curveFitModal").on("shown.bs.modal",function(){$("#curveFitDlg_ok").trigger("focus")}),$("#curveFitDlg_type").change(function(){"linear"==$(this).val()?$("#cont_origin").show():$("#cont_origin").hide(),"polynomial"==$(this).val()?($("#order").val(C.dataSize()-1),$("#cont_order").show()):$("#cont_order").hide(),"natural"==$(this).val()||"periodic"==$(this).val()||"weeding"==$(this).val()?$("#cont_generate").show():$("#cont_generate").hide(),"weeding"==$(this).val()?($("#cont_tolerance").show(),$("#cont_chunksize").show()):($("#cont_tolerance").hide(),$("#cont_chunksize").hide()),"noFitting"!==$(this).val()?($("#cont_retain").show(),$("#cont_retain").show()):($("#curveFitDlg_retain").prop("checked",!1),$("#cont_retain").hide(),$("#attributes").hide())}),$("#attributes").hide(),$("#curveFitDlg_retain")[0].checked=!1,$("#curveFitDlg_retain").change(function(){$(this)[0].checked?$("#attributes").show():$("#attributes").hide()}),this.curveFitCb=function(e){return $("#curveFitModal").css("zIndex",$("#curveSettingsModal").css("zIndex")+1),f.curveFitDlgInit,null==f.curveFitDlgInit&&(f.init(),f.curveFitDlgInit=!0),_=e.plot(),C=e,f.curveFitDlg(),f},this.cb=function(){if(m){var t=v;if(_.findPlotCurve(t))return void Static.alert(t+" already exist")}var e=_.autoReplot();_.setAutoReplot(!1);var n=new MyCurve;if(n.setPen(new Misc.Pen(b)),n.fn=C.fn,n.variable=C.variable,n.setAxes(C.xAxis(),C.yAxis()),n.origin=y,n.setStyle(C.style()),"natural"==p||"periodic"==p){n.setData(C.data());var i=new SplineCurveFitter,r=i.spline();if("periodic"==p?r.setSplineType(Static.SplineType.Periodic):r.setSplineType(Static.SplineType.Natural),n.setCurveFitter(i),g){for(var a=_.axisScaleDraw(C.xAxis()).scaleMap(),s=_.axisScaleDraw(C.yAxis()).scaleMap(),o=C.data().samples(),l=[],c=0;c<o.length;c++)l.push(new Misc.Point(a.transform(o[c].x),s.transform(o[c].y)));l=i.fitCurve(l),n.setCurveFitter(null);for(var u=[],c=0;c<l.length;c++)u.push(new Misc.Point(a.invTransform(l[c].x),s.invTransform(l[c].y)));n.setSamples(u)}else n.setSamples(C.data().samples())}else if("weeding"==p){n.setData(C.data());var h=new WeedingCurveFitter(10);if(h.setChunkSize(parseInt(w)),h.setTolerance(parseInt(x)),n.setCurveFitter(h),g){for(a=_.axisScaleDraw(C.xAxis()).scaleMap(),s=_.axisScaleDraw(C.yAxis()).scaleMap(),o=C.data().samples(),l=[],c=0;c<o.length;c++)l.push(new Misc.Point(a.transform(o[c].x),s.transform(o[c].y)));l=h.fitCurve(l),n.setCurveFitter(null);for(u=[],c=0;c<l.length;c++)u.push(new Misc.Point(a.invTransform(l[c].x),s.invTransform(l[c].y)));n.setSamples(u)}else n.setSamples(C.data().samples())}else if("noFitting"==p)n.setData(C.data()),n.setCurveFitter(null);else{for(var i=regress(C,p,parseInt(S),y,E),h=C.data().boundingRect(),d=i.string;-1!=d.indexOf("+ -");)d=d.replace("+ -","- ");d=function(e){for(e=(e=e.replace(/\s/g,"")).replace("y=",""),e=math.simplify(e,{},{exactFractions:!1}).toString();-1!=e.indexOf("+ -");)e=e.replace("+ -","- ");return e}(d),n.equation="y="+d,n.expandedFn=n.fn=d,n.variable="x";let e={};e.rtti=Static.Rtti_PlotCurve,e.coeffs=[],e.expandedFn=n.expandedFn,e.fn=n.expandedFn,e.lowerLimit=h.left(),e.numOfPoints=100,e.threeD=!1,e.title=1==m?t:C.title(),e.unboundedRange=!1,e.upperLimit=h.right(),e.variable="x",n.functionDlgData=e,n.setSamples(Utility.makeSamples({fx:d,lowerX:h.left(),upperX:h.right(),numOfSamples:100}))}m?n.setTitle(t):(n.setTitle(C.title()),C.detach()),n.fitType=p,n.attach(_),_.setAutoReplot(e),_.autoRefresh(),f.close()},this.init=function(){var e=this;$("#curveFitDlg_ok").click(function(){p=$("#curveFitDlg_type").val(),m=$("#curveFitDlg_retain")[0].checked,g=$("#curveFitDlg_generate")[0].checked,v=$("#curveFitDlg_name").val(),b=$("#curveFitDlg_color").val(),S=$("#order").val()||1,E={precision:parseInt($("#curveFitDlg_precision").val())},y=$("#origin")[0].checked,x=$("#tolerance").val(),w=$("#chunksize").val(),e.cb()})},this.curveFitDlg=function(){C&&C.rtti===Static.Rtti_PlotCurve&&($("#curveFitDlg_name").val(Utility.generateCurveName(_,C.title()+"_fit")),$("#curveFitDlg_color").val(Static.colorNameToHex(C.pen().color)),$("#curveFitModal").modal({backdrop:"static"}))},this.curveFitInfoCb=function(e){var t="";return"natural"==e.fitType?t+="Fit type:Natural Spline":"periodic"==e.fitType?t+="Fit type:Periodic Spline":"polynomial"==e.fitType?(t+="Fit type:Polynomial",t+="; Equation:"+e.equation):"weeding"==e.fitType?(t+="Fit type:Weeding",t+="; Tolerance:"+x):"linear"==e.fitType&&(e.origin?t+="Fit type:Linear Through Origin":t+="Fit type:Linear",t+="; Equation:"+e.equation),t},this.close=function(){$(".close").click()}}}define("curveFitDlg",function(){});class MCurveStyleDlg{constructor(){var t=this,n={Lines:Lines,Sticks:Sticks,Steps:Steps,Dots:Dots,NoCurve:NoCurve},e=_.invert(n);this.curveStyleCb=function(e){t.curveStyleDlgInit,null==t.curveStyleDlgInit&&($("body").append($('                    <div class="modal fade" id="curveStyleModal" role="dialog">                    <div class="modal-dialog modal-sm">                    <div class="modal-content">                    <div class="modal-header">                    <button type="button" class="close" data-dismiss="modal">&times;</button>                    <h4 class="modal-title">Curve Style</h4>                    </div>                    <div class="modal-body">                    <div class="row">                    <div class="col-sm-5">Curve style:</div>                    <div class="col-sm-7">                    <select id="curveStyleDlgStyle">                    <option value="Lines">Lines (Default)</option>                    <option value="Sticks">Sticks</option>                    <option value="Steps">Steps</option>                    <option value="Dots">Dots</option>                    <option value="NoCurve">NoCurve</option>                    </select>                    </div>                    </div>                    <br>                    <div class="row">                    <div class="col-sm-7">                    </div>                    </div>                    <br>                    <div class="modal-footer">                    <button id="curveStyleDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Ok</button>                    </div>                    </div>                    </div>                    </div>                    </div>                    ')),$("#curveStyleModal").on("shown.bs.modal",function(){$("#curveStyleDlg_ok").trigger("focus")}),t.init(),t.curveStyleDlgInit=!0),t.curve=e,t.curveStyleDlg()},this.init=function(){$("#curveStyleDlgStyle").change(function(){var e=n[$(this).val()];t.curve.setStyle(e),Static.trigger("curveStyleChanged",t.curve)})},this.curveStyleDlg=function(){t.curve&&t.curve.rtti===Static.Rtti_PlotCurve&&($("#curveStyleDlgStyle").val(e[t.curve.style()]),$("#curveStyleModal").modal({backdrop:"static"}))}}}define("curveStyleDlg",function(){});class MAxisDlg{constructor(){var t=null,n=_.once(function(){$("body").append($('                        <div class="modal fade" id="axisModal" role="dialog">                        <div class="modal-dialog modal-sm">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal">&times;</button>                        <h4 class="modal-title">Curve Axis</h4>                        </div>                        <div class="modal-body">                        <div class="row">                        <div class="col-sm-5">Horizontal:</div>                        <div class="col-sm-7">                        <select id="axisHorizontal1">                        <option value="bottomAxis">Bottom axis</option>                        <option value="topAxis">Top axis</option>                        </select>                        </div>                        </div>                        <br>                        <div class="row">                        <div class="col-sm-5">Vertical:</div>                        <div class="col-sm-7">                        <select id="axisVertical1">                        <option value="leftAxis">Left axis</option>                        <option value="rightAxis">Right axis</option>                        </select>                        </div>                        </div>                        <br>                        <div class="modal-footer">                        <button id="axisDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Ok</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#axisModal").on("shown.bs.modal",function(){$("#axisDlg_ok").trigger("focus")}),$("#axisHorizontal1").change(function(){"bottomAxis"==$(this).val()?(t.setXAxis(xBottom),Static.trigger("axisChanged",[xBottom,t])):(t.setXAxis(xTop),Static.trigger("axisChanged",[xTop,t]))}),$("#axisVertical1").change(function(){"leftAxis"==$(this).val()?(t.setYAxis(yLeft),Static.trigger("axisChanged",[yLeft,t])):(t.setYAxis(yRight),Static.trigger("axisChanged",[yRight,t]))})});this.axisCb=function(e){n(),(t=e).xAxis()==xBottom?$("#axisHorizontal1").val("bottomAxis"):$("#axisHorizontal1").val("topAxis"),t.yAxis()==yLeft?$("#axisVertical1").val("leftAxis"):$("#axisVertical1").val("rightAxis"),$("#axisModal").modal({backdrop:"static"})}}}define("axisDlg",function(){});class MPointEntryDlg{constructor(){const r=this;let a=_.once(function(){$("#pointEntryModal").remove(),$("body").append($('                        <div class="modal fade" id="pointEntryModal" role="dialog">                        <div class="modal-dialog modal-sm">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class= "close" id="closePointEntryDlg">&times;</button>                        <h4 id="pointEntryTitle" class="modal-title">Add/Romve Point</h4>                        </div>                        <div class="modal-body">                        <div class="row">                        <div class="col-sm-4">Name:</div>                        <input id="curve_name" type="text" value="curve_1">                        </div>                        <br>                        <div class="row">                        <div class="col-sm-4">Abscissa(X):</div>                        <input id="abscissa" type="text" value="0.0">                        </div>                        <br>                        <div class="row">                        <div class="col-sm-4">Ordinate(Y):</div>                        <input id="ordinate" type="text" value="0.0">                        </div>                        <br>                        <div class="modal-footer">                        <button id="pointEntryDlg_enter" type="button" class="btn btn-default" >Add</button>                        <button id="pointEntryDlg_remove" type="button" class="btn btn-default" >Remove</button>                        <button id="pointEntryDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Finish</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#pointEntryDlg_enter").click(i),$("#pointEntryDlg_remove").click(n),$("#closePointEntryDlg").click(t),$("#curve_name, #abscissa, #ordinate").keyup(e),$("#pointEntryDlg_remove").attr("disabled",!1),$("#pointEntryDlg_enter").attr("disabled",!0),$("#pointEntryModal").on("shown.bs.modal",function(){$("#pointEntryDlg_enter").trigger("focus")})});function s(e){var t=r.plot.findPlotCurve($("#curve_name").val());if(t){var n=t.data().samples();if(0<n.length)for(var i=0;i<n.length;++i)if(e.x==n[i].x&&e.y==n[i].y)return 1}}function e(){var e,t,n,i=r.plot.findPlotCurve($("#curve_name").val());if(i&&(e=i.data().samples()),"-"==$("#abscissa").val())return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0);try{t=math.evaluate(Static.expandDefines($("#abscissa").val()))}catch(e){return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0)}if("-"==$("#ordinate").val())return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0);try{n=math.evaluate(Static.expandDefines($("#ordinate").val()))}catch(e){return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0)}if(null==n||null==t)return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0);s(new Misc.Point(t,n))?(1<e.length&&$("#pointEntryDlg_remove").attr("disabled",!1),$("#pointEntryDlg_enter").attr("disabled",!0)):($("#pointEntryDlg_remove").attr("disabled",!0),$("#pointEntryDlg_enter").attr("disabled",!1))}function t(){$("#pointEntryDlg_ok").click()}function n(){let e=r.plot.findPlotCurve($("#curve_name").val());e.removePoint(new Misc.Point(parseFloat($("#abscissa").val()),parseFloat($("#ordinate").val()))),$("#pointEntryDlg_remove").attr("disabled",!0),$("#pointEntryDlg_enter").attr("disabled",!1),Static.trigger("curveAdjusted")}function i(){let t=r.plot.findPlotCurve($("#curve_name").val());if(t)"Modify/Remove Point"==r.dlgTitle()&&(t.removePoint(r.point,!0),Static.trigger("curveAdjusted"));else{t=new MyCurve($("#curve_name").val()),t.attach(r.plot);var n=Utility.randomColor();t.setPen(new Misc.Pen(n));var i=new Symbol(MRect,new Misc.Brush(Static.invert(n)),new Misc.Pen(n),new Misc.Size(8,8));t.setSymbol(i);let e="";Static.showline&&Static.showsymbol?e="lineAndSymbol":Static.showline?e="line":Static.showsymbol&&(e="symbol"),Utility.setLegendAttribute(t,e,t.getLegendIconSize())}let e=t.data().samples();n=math.evaluate(Static.expandDefines($("#abscissa").val())),Math.abs(Math.abs(n)-_eps),i=math.evaluate(Static.expandDefines($("#ordinate").val())),i=new Misc.Point(n,i);r.point=i,e.containsPoint(i)||e.push(i),e.sort(function(e,t){return e.x-t.x}),t.setSamples(e),r.plot.autoRefresh(),Static.trigger("pointAdded",t),Static.trigger("curveAdjusted"),$("#pointEntryDlg_enter").attr("disabled",!0),1<e.length&&$("#pointEntryDlg_remove").attr("disabled",!1)}this.setDlgTitle=function(e){$("#pointEntryTitle").html(e),"Modify/Remove Point"==e?$("#pointEntryDlg_enter").html("Modify"):$("#pointEntryDlg_enter").html("Add")},this.dlgTitle=function(e){return $("#pointEntryTitle").html()},this.pointEntryCb=function(e,t,n,i){r.curveName=n,r.point=i,a(),r.setDlgTitle(e),void 0!==n&&$("#curve_name").val(n),void 0!==i&&($("#abscissa").val(i.x),$("#ordinate").val(i.y)),r.plot=t,function(){var e=r.plot.findPlotCurve($("#curve_name").val());e&&1<e.data().samples().length?$("#pointEntryDlg_remove").attr("disabled",!1):$("#pointEntryDlg_remove").attr("disabled",!0)}(),$("#pointEntryModal").modal({backdrop:"static"}),"Modify/Remove Point"==e?($("#curve_name").attr("disabled",!0),$("#pointEntryDlg_enter").attr("disabled",!0)):($("#curve_name").attr("disabled",!1),s(new Misc.Point($("#abscissa").val(),$("#ordinate").val()))||$("#pointEntryDlg_enter").attr("disabled",!1))}}}define("pointEntryDlg",function(){});class ToolBar{constructor(t,n){var i=this;i.tbarHeight=0;var o=[];function r(){console.log("No callback defined for button")}t=t||{};var l=$('<div id="toolBar1" class="noprint" style="position:relative; border-style: ridge; background-color: lightBlue"></div>');function a(e){for(var t=0;t<o.length;++t)if(o[t][0].innerText.trim().split(" ")[0]==e)return t;return-1}void 0!==t.zIndex&&l.css("zIndex",t.zIndex),l.insertBefore(n),n.removeClass("noToolBar"),n.addClass("toolBar");this.html=function(){return l},this.disable=function(e){"string"==typeof e&&(e=a(e)),o[e].attr("disabled",!0)},this.enable=function(e){"string"==typeof e&&(e=a(e)),o[e].attr("disabled",!1)},this.hide=function(e){-1<(e=null==(e="string"==typeof e?a(e):e)?-1:e)&&e<o.length?o[e].hide():(l.hide(),n.removeClass("toolBar"),n.addClass("noToolBar")),t.refreshCb&&refreshCb()},this.show=function(e){-1<(e=null==(e="string"==typeof e?a(e):e)?-1:e)&&e<o.length?o[e].show():(l.show(),n.removeClass("noToolBar"),n.addClass("toolBar")),t.refreshCb&&refreshCb()};function s(n){n.label,n.text=n.text||"Button",n.innerHtmlId=n.innerHtmlId||"elem_"+o.length;var e=$('<span data-toggle="tooltip" class="dropdown">                              <button id='+n.innerHtmlId+' class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">'+n.text+'                              <span class="caret"></span></button>                              <ul class="dropdown-menu">'+function(e){for(var t="",n=e.hasCheckbox||!1,i=e.listElements||[],r=0;r<i.length;++r)i[r].icon=i[r].icon||"",i[r].checked=i[r].checked||"unchecked",n&&!i[r].icon.length&&(i[r].tooltip?t+='<li title="'+i[r].tooltip+'"><a href="#"><label><input type="checkbox" '+i[r].checkboxState+" value="+r+">"+i[r].text+"</label></a></li>":t+='<li><a href="#"><label><input type="checkbox" '+i[r].checkboxState+" value="+r+">"+i[r].text+"</label></a></li>"),!n&&i[r].icon.length&&(i[r].tooltip?t+='<li title="'+i[r].tooltip+'"><a href="#"><label><img src='+i[r].icon+' alt="Img" width=20px> '+i[r].text+"</label></a></li>":t+='<li><a href="#"><label>'+i[r].icon+i[r].text+"</label></a></li>"),n&&i[r].icon.length&&(i[r].tooltip?t+='<li title="'+i[r].tooltip+'"><a href="#"><label><img src='+i[r].icon+' alt="Img" width=20px><input type="checkbox" '+i[r].checkboxState+' value="">'+i[r].text+"</label></a></li>":t+='<li><a href="#"><label><input type="checkbox" '+i[r].checkboxState+' value="">'+i[r].icon+i[r].text+"</label></a></li>"),n||i[r].icon.length||(i[r].tooltip?t+='<li title="'+i[r].tooltip+'"><a href="#"><label>'+i[r].text+"</label></a></li>":t+='<li><a href="#"><label>'+i[r].text+"</label></a></li>");return t}(n)+"</ul>                          </span>");return e.css("marginLeft",n.marginLeft||0),e.css("marginRight",n.marginRight||0),e.addClass(n.class),e.attr("title",n.tooltip),l.append(e),n.cb=n.cb||r,e.on("click",function(e){var t;return!$(e.target).parent().parent().parent().hasClass("disabled")&&void(n.hasCheckbox||-1!=(t=$(e.target).closest("li").index())&&n.cb(e,t))}),e.on("change",function(e){var t=$(e.target);t.prop("checked");n.cb(e,t.closest("li").index(),t.prop("checked"))}),o.push(e),o.length-1}this.addToolButton=function(e,t){return"pushbutton"==e?function(t){t.text=t.text,t.class=t.class||"btn btn-primary",t.innerHtmlId=t.innerHtmlId||"elem_"+o.length,t.duration=t.duration||40;var n=$("<button id="+t.innerHtmlId+' type="button" data-toggle="tooltip">');n.addClass(t.class),void 0!==t.icon?(void 0!==t.text&&t.text.length&&n.text(t.text+" "),a=$("<img src="+t.icon+' alt="Img" width=18px>'),n.append(a)):n.text(t.text),l.append(n),n.attr("title",t.tooltip);var i=t.cb||function(){console.log("No callback defined for button")},e="click",r="mousedown",a="mouseup";return Static.isMobile()&&(e="tap",r="touchstart",a="touchend"),t.repeat?(n.interval=null,n.bind(r,function(e){"mousedown"==r&&0!=e.button||(n.interval=setInterval(i,t.duration))}),n.bind(a+" mouseleave",function(){clearInterval(n.interval)})):n.bind(e,i),o.push(n),o.length-1}(t):"checkbox"==e?function(e){var t=e.label||"Option 1",n="";e.checked&&(n="checked"),e.innerHtmlId=e.innerHtmlId||"elem_"+o.length;t=$('<label data-toggle="tooltip" class="checkbox-inline">                                    <input id='+e.innerHtmlId+'  type="checkbox" value="" '+n+">"+t+"                                  </label>");t.css("marginLeft",e.marginLeft||8),t.css("marginRight",e.marginRight||8),l.append(t),e.disabled&&$("#"+e.innerHtmlId).attr("disabled",!0),t.attr("title",e.tooltip);var i=e.cb||function(){console.log("No callback defined for button")};return t.click(function(){i($("#"+e.innerHtmlId).is(":checked"))}),o.push($("#"+e.innerHtmlId)),o.length-1}(t):"toggleSwitch"==e?function(e){var t=e.label||"Option 1",n="";e.checked&&(n="checked"),e.innerHtmlId=e.innerHtmlId||"elem_"+o.length;t=$('<label data-toggle="tooltip" class="checkbox-inline switch">                                    <input id='+e.innerHtmlId+'  type="checkbox" value="" '+n+'>                                    <span class="slider round" style="width:48px"></span>                                    <span style="margin-left:30px">'+t+"</span>                                  </label>");t.css("marginLeft",e.marginLeft||4),t.css("marginRight",e.marginRight||2),l.append(t),t.attr("title",e.tooltip);var i=e.cb||function(){console.log("No callback defined for button")};return $("#"+e.innerHtmlId).on("change",function(){i($(this)[0].checked)}),o.push(t),o.length-1}(t):"radio"==e?function(e){var t=e.label||"Option 1";e.value=e.value||t,e.innerHtmlId=e.innerHtmlId||"elem_"+o.length;var n=e.name||"optradio";e.checked;var i=null,i=e.checked?$("<input id="+e.innerHtmlId+' type="radio" checked value='+e.value+" name="+n+">"):$("<input id="+e.innerHtmlId+' type="radio" value='+e.value+" name="+n+">"),t=$('<label data-toggle="tooltip" class="checkbox-inline">                                    '+t+"                                  </label>");t.append(i),t.css("marginLeft",e.marginLeft||0),t.css("marginRight",e.marginRight||0),l.append(t),t.attr("title",e.tooltip),t.addClass(e.class);e=e.cb||r;return t.click(e),o.push(t),o.length-1}(t):"dropdown"==e?s(t):"select"==e?function(e){e.label=e.label||"Select One",e.innerHtmlId=e.innerHtmlId||"elem_"+o.length;var t=$("<select/>"),n=$('<span data-toggle="tooltip"><label for='+e.innerHtmlId+">"+e.label+":</label>                            </span>");n.append(t);for(var i=e.selections||[],r=0;r<i.length;++r)t.append($("<option>"+i[r]+"</option>"));n.css("marginLeft",e.marginLeft||8),n.css("marginRight",e.marginRight||8),n.addClass(e.class),n.attr("title",e.tooltip),l.append(n);var a=e.cb||function(){console.log("No callback defined for button")};return t.on("change",function(){a($(this)[0].selectedIndex)}),o.push(n),o.length-1}(t):"slider"==e?function(e){var t=e.label||"Option 1",n="";void 0!==e.min&&(n=' min="'+e.min+'"');var i="";void 0!==e.max&&(i=' max="'+e.max+'"');var r="";void 0!==e.value&&(r=" value="+e.value+" ");var a=" width:100px ";void 0!==e.width&&(a=" width:"+e.width+"px "),e.innerHtmlId=e.innerHtmlId||"elem_"+o.length;r=$('<input style="position:absolute; '+a+'" id='+e.innerHtmlId+" "+r+'  type="range" '+n+" "+i+"/>"),n=$("<label for="+e.innerHtmlId+'data-toggle="tooltip">'+t+"</label>");n.append(r),n.css("marginLeft",e.marginLeft||8),n.css("marginRight",e.marginRight||8),r.css("marginLeft",e.marginLeft||8),r.css("marginTop",e.marginTop||2),l.append(n),r.css("top",l.css("top"));i=$("#"+e.innerHtmlId).parent()[0],t=i.offsetLeft+i.offsetWidth;r.css("left",t),n.css("width",i.offsetWidth+parseInt(r.css("width"))),n.attr("title",e.tooltip);var s=e.cb||function(){console.log("No callback defined for button")};return r.on("change",function(){s(parseInt($(this).val()))}),o.push(n),o.length-1}(t):"number"==e?function(e){e.label=e.label||"Select One",e.innerHtmlId=e.innerHtmlId||"elem_"+o.length,e.min=e.min||-1e6,e.max=e.max||1e6,e.value=e.value||e.min,e.value>e.max&&(e.value=e.max),e.value<e.min&&(e.value=e.min);var t=$('<span data-toggle="tooltip"><label for="sel1">'+e.label+":</label>                                   </span>"),n=$("<input id="+e.innerHtmlId+'  type="number"                            value="10" name="some-name"/>');t.append(n),l.append(t),n.attr({width:200,min:e.min,max:e.max,step:e.step,value:e.value}),t.attr("title",e.tooltip),t.css("marginLeft",e.marginLeft||8),t.css("marginRight",e.marginRight||8),t.addClass(e.class);var i=e.cb||function(){console.log("No callback defined for button")};return n.on("change",function(){i(parseFloat($(this).val()))}),o.push(t),o.length-1}(t):"upload"==e?function(e){e.label=e.label||"Select One",e.innerHtmlId=e.innerHtmlId||"elem_"+o.length;var t=$("<input id="+e.innerHtmlId+'  type="file" name="files[]" multiple />'),n=$('<button data-toggle="tooltip"></button>');t.css("marginLeft",-8),t.css("marginRight",-8),t.css("marginTop",-3),t.css("marginBottom",-3),n.append(t),n.css("marginLeft",e.marginLeft||8),n.css("marginRight",e.marginRight||8),n.addClass(e.class),n.attr("title",e.tooltip),l.append(n),o.push(n);var i=!1;return n.click(function(){if(!i)return i=!0,t.trigger("click"),!1}),o.length-1}(t):"link"==e?function(e){e.text=e.text||"Button",e.innerHtmlId=e.innerHtmlId||"elem_"+o.length;var t=$("<A HREF="+e.href+"></a>");t.text(e.text),l.append(t),t.addClass(e.class),t.attr("title",e.tooltip),t.attr("target",e.target);e=e.cb||function(){console.log("No callback defined for button")};return t.click(e),o.push(t),o.length-1}(t):void 0},this.setButtonCheck=function(e,t){"string"==typeof e&&(e=a(e)),o[e][0].children[0]?o[e][0].children[0].checked=t:o[e][0].checked=t},this.isDropdownItemChecked=function(e,t){return"string"==typeof e&&(e=a(e)),$($(o[e].children()[1]).children()[t]).children().children().children().prop("checked")},this.setDropdownItemCheck=function(e,t,n){"string"==typeof e&&(e=a(e)),$($(o[e].children()[1]).children()[t]).children().children().children().prop("checked",n)},this.hideDropdownItem=function(e,t){"string"==typeof e&&(e=a(e)),$($(o[e].children()[1]).children()[t]).hide()},this.showDropdownItem=function(e,t){"string"==typeof e&&(e=a(e)),$($(o[e].children()[1]).children()[t]).show()},this.enableDropdownItem=function(e,t,n){"string"==typeof e&&(e=a(e));t=$($(o[e].children()[1]).children()[t]).addClass("disabled");n?t.removeClass("disabled"):t.addClass("disabled")};var c=parseFloat(l.css("height"));Static.onHtmlElementResize(l[0],function(){var e=parseFloat(l.css("height"))-c;c=parseFloat(l.css("height")),i.tbarHeight=parseFloat(l.css("height")),n.css("height",parseFloat(n.css("height"))-e),Static.trigger("toolBarResized",[l,e])})}}define("toolBar",function(){});class MCurveSettings{constructor(i){let e=null,n=null,t=null,r=null,a=null;function s(){var t=$("#curveSelect").children();for(let e=0;e<t.length;++e)$("#curveSelect")[0].removeChild(t[e]);let n=i.itemList(Static.Rtti_PlotCurve);for(let t=0;t<n.length;++t)if(n[t].isVisible()){let e=$("<option>"+n[t].title()+"</option>");e.attr("value",n[t].title()),$("#curveSelect").append(e)}return $("#sizeSymbol").val(10),n.length?n[0]:null}function o(e){e.brush().color==Static.NoBrush?$("#clearBrush").hide():$("#clearBrush").show()}function l(t){if(t){$("#penColor").val(Static.colorNameToHex(t.pen().color)),$("#penWidth")[0].selectedIndex=t.pen().width-1,$("#penStyle")[0].selectedIndex=["solid","dot","dash","dashDot","dashDotDot"].indexOf(t.pen().style),$("#horizontalAxis")[0].selectedIndex=t.xAxis()-2,$("#verticalAxis")[0].selectedIndex=t.yAxis(),t.fitType?$("#fitInfo").show():$("#fitInfo").hide(),o(t);let e=t.symbol();e?((t=e.style())==MRect&&$("#symbolType").val("MRect"),t==Cross&&$("#symbolType").val("Cross"),t==Diamond&&$("#symbolType").val("Diamond"),t==Ellipse&&$("#symbolType").val("Ellipse"),t==XCross&&$("#symbolType").val("XCross")):$("#symbolType").val("None"),"None"==$("#symbolType").val()?$("#symbolContainer").hide():($("#symbolContainer").show(),$("#penColorSymbol").val(e.pen().color),$("#penWidthSymbol").val(e.pen().width),$("#fillBrushSymbol").val(e.brush().color),$("#sizeSymbol").val(e.size().width))}}$("body").append($('                \x3c!-- Modal --\x3e                <div class="modal fade" id="curveSettingsModal" role="dialog">                <div class="modal-dialog">                                \x3c!-- Modal content--\x3e                <div class="modal-content">                <div class="modal-header">                \x3c!--button type="button" class="close" data-dismiss="modal">&times;</button--\x3e                <h4 class="modal-title">Curve attributes</h4>                </div>                <div class="modal-body">                                                <div class="row">                <div class="col-sm-3">Curve name:</div>                <div class="col-sm-5"><select id="curveSelect" style="width:100%"></select></div>                <div class="col-sm-2"><button id="remove">Remove</button></div>                <div class="col-sm-2"><button id="rename">Rename</button></div>                </div>                                <br>                <div class="row">                <div class="col-sm-3">Pen color:<input id="penColor" type="color"/></div>                <div class="col-sm-4">Pen width:<select id="penWidth" style="width:50%"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>                <div class="col-sm-5">Pen style:<select id="penStyle" style="width:60%"><option>solid</option><option>dot</option><option>dash</option><option>dashDot</option><option>dashDotDot</option></select></div>                </div>                                <br>                <div class="row">                <div class="col-sm-6">Horizontal axis:<select id="horizontalAxis" style="width:50%"><option value="2">Bottom</option><option value="3">Top</option></select></div>                <div class="col-sm-5">Vertical axis:<select id="verticalAxis" style="width:60%"><option value="0">Left</option><option value="1">Right</option></select></div>                </div>                                <br>                <div class="row">                <div class="col-sm-1"><button id="fit">Fit</button></div><div class="col-sm-3"><button id="legendAttribute">Legend attribute</button></div><div class="col-sm-3"><button id="curveStyle">Curve style</button></div><div class="col-sm-2"><button id="curveBrush"> Brush</button></div><div class="col-sm-3"><button id="clearBrush">No brush</button></div>\x3c!--div class="col-sm-2"><button id="curveAxis">Axis</button></div--\x3e                <div class="col-sm-3"><button id="fitInfo">Curve Fit Info...</button></div>                </div>                                <br>                <div class="row">                <div class="col-sm-2">Symbols</div>                <div class="col-sm-8"><select id="symbolType"><option value="None">None</option><option value="MRect">Rectangle</option><option value="Cross">Cross</option><option value="Diamond">Diamond</option><option value="Ellipse">Ellipse</option><option value="XCross">Diagonal cross</option></select></div>                </div>                                <br>                <div id="symbolContainer">                <div class="row">                <div class="col-sm-6">Symbol pen color:<input id="penColorSymbol" type="color"/></div>                <div class="col-sm-6">Symbol pen width:<select id="penWidthSymbol" style="width:50%"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>                </div>                <br>                <div class="row">                <div class="col-sm-6">Symbol fill brush:<input id="fillBrushSymbol" type="color"/></div>                <div class="col-sm-6">Symbol size:<select id="sizeSymbol" style="width:50%"><option value="5">5x5</option><option value="6">6x6</option><option value="8">8x8</option><option value="10">10x10</option><option value="12">12x12</option><option value="15">15x15</option></select></div>                </div>                </div>                                                </div>                <div class="modal-footer">                <button id="cancelAxisDlg" type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>                <button type="button" class="btn btn-default" data-dismiss="modal">Ok</button>                </div>                </div>                                </div>                </div>                ')),$("#curveSelect").change(function(){l(i.findPlotCurve($("#curveSelect").val()))}),$("#remove").click(function(){let e=i.findPlotCurve($("#curveSelect").val());var t;e.detach(),i.hasPlotCurve()?(t=$("#curveSelect").children(),$("#curveSelect")[0].removeChild(t[$("#curveSelect")[0].selectedIndex]),l(i.findPlotCurve($("#curveSelect").val()))):$("#cancelAxisDlg").click()}),$("#rename").click(function(){return Utility.curveRenameDlg($("#curveSelect").val(),i,function(){var e=$("#curveSelect")[0].selectedIndex;return s(),$("#curveSelect")[0].selectedIndex=e,!0}),!0}),$("#fit").click(function(){e(i.findPlotCurve($("#curveSelect").val()))}),$("#legendAttribute").click(function(){t(i.findPlotCurve($("#curveSelect").val()))}),$("#clearBrush").click(function(){Utility.removeCurveBrush(i.findPlotCurve($("#curveSelect").val())),o(i.findPlotCurve($("#curveSelect").val()))}),$("#curveBrush").click(function(){Utility.setCurveBrush(i.findPlotCurve($("#curveSelect").val()),o)}),$("#curveStyle").click(function(){r(i.findPlotCurve($("#curveSelect").val()))}),$("#curveAxis").click(function(){a(i.findPlotCurve($("#curveSelect").val()))}),$("#fitInfo").click(function(){let e=i.findPlotCurve($("#curveSelect").val());var t=n(e);t.length?Static.alert(t):Static.alert('No curve fitting equation found for "'+e.title()+'."')}),$("#penColor").change(function(){let e=i.findPlotCurve($("#curveSelect").val()),t=e.pen();t.color=$(this).val(),e.setPen(t)}),$("#penWidth").change(function(){let e=i.findPlotCurve($("#curveSelect").val()),t=e.pen();t.width=$(this).val(),e.setPen(t)}),$("#penStyle").change(function(){let e=i.findPlotCurve($("#curveSelect").val()),t=e.pen();t.style=$(this).val(),e.setPen(t)}),$("#horizontalAxis").change(function(){let e=i.findPlotCurve($("#curveSelect").val());e.setXAxis($(this).val()),Static.trigger("axisChanged",[$(this).val(),e])}),$("#verticalAxis").change(function(){let e=i.findPlotCurve($("#curveSelect").val());e.setYAxis($(this).val()),Static.trigger("axisChanged",[$(this).val(),e])}),$("#symbolType").change(function(){var e=i.findPlotCurve($("#curveSelect").val());"None"==$("#symbolType").val()?($("#symbolContainer").hide(),$("#penWidthSymbol").val(1),$("#penColorSymbol").val(Static.colorNameToHex("black")),$("#fillBrushSymbol").val(Static.colorNameToHex("transparent")),$("#sizeSymbol").val(10)):$("#symbolContainer").show(),function(t,n){if("None"!=n){let e="XCross"==n?XCross:"Ellipse"==n?Ellipse:"Diamond"==n?Diamond:"Cross"==n?Cross:"MRect"==n?MRect:-1;Utility.addSymbol(t,e)}else t.setSymbol(null)}(e,$(this).val())}),$("#penColorSymbol").change(function(){let t=i.findPlotCurve($("#curveSelect").val()),n=t.symbol();if(n){let e=n.pen();e.color=$(this).val(),n.setPen(e),t.plot().autoRefresh(),t.plot().updateLegend(t)}}),$("#penWidthSymbol").change(function(){var e,t=i.findPlotCurve($("#curveSelect").val());e=t,t=parseInt($(this).val()),Utility.setSymbolPenWidth(e,t)}),$("#fillBrushSymbol").change(function(){let t=i.findPlotCurve($("#curveSelect").val()),n=t.symbol();if(n){let e=n.brush();e.color=$(this).val(),n.setBrush(e),t.plot().autoRefresh(),t.plot().updateLegend(t)}}),$("#sizeSymbol").change(function(){var e,t=i.findPlotCurve($("#curveSelect").val());e=t,t=parseInt($(this).val()),Utility.setSymbolSize(e,t)}),this.init=function(){e=i.curveFitDlg.curveFitCb,n=i.curveFitDlg.curveFitInfoCb,t=i.curveAttributeDlg.curveAttributeCb,r=i.curveStyleDlg.curveStyleCb,a=i.axisDlg.axisCb},this.curveSettingsDlg=function(){i.itemList(Static.Rtti_PlotCurve).length?(l(s()),$("#curveSettingsModal").modal({backdrop:"static"})):Static.alert("No curves found","small")},this.init()}}define("curveSettings",function(){});class MToolBar extends ToolBar{constructor(r,e,t){super(e,t);var a=this,t=new Watches(r).watchElements();function n(){var e=$("input[name=optradio]").filter(":checked").val();"Zoom"==e&&(r.pan.setEnabled(!1),Utility.setAutoScale(r,!1),r.zm.setEnabled(!0),r.zm.setZoomBase(r.zm.scaleRect())),"Pan"==e&&(r.zm.setEnabled(!1),r.pan.setEnabled(!0),Utility.setAutoScale(r,!1)),"Auto"==e&&(r.pan.setEnabled(!1),r.zm.setEnabled(!1),Utility.setAutoScale(r,!0))}var i=[function(e){r.enableAxis(yLeft,e)},function(e){r.enableAxis(xBottom,e)},function(e){r.enableAxis(yRight,e)},function(e){r.enableAxis(xTop,e)},function(e){Utility.majorGridLines(r.grid,e),a.enableDropdownItem("View",5,e)},function(e){Utility.minorGridLines(r.grid,e)},function(e){e?r.showTitle():r.hideTitle()},function(e){e?r.showFooter():r.hideFooter()},function(e){r.enableLegend(e)}];Static.bind("majorGridLines",function(e,t,n){a.setDropdownItemCheck("View",4,n),a.enableDropdownItem("View",5,n)}),Static.bind("minorGridLines",function(e,t,n){a.setDropdownItemCheck("View",5,n)});var s=[r.file.save,function(){r._functionDlg.functionDlg(Utility.generateCurveName(r))},function(){r.pointEntryDlg.pointEntryCb("Add/Romve Point",r)},function(){window.open("Calculator:///")},function(e){Static.defines(r)},function(e){r.markerDlg.markerCb(r)},r.print];this.addToolButton("dropdown",{text:"File",cb:function(e,t){s[t]()},listElements:[{text:"Save",icon:"images/save.png",tooltip:"Save the current graph."},{text:"Function",icon:"images/function.png",tooltip:"Launches the function dialog."},{text:"Point entry",icon:"images/pointEntry.png",tooltip:"Launches the point entry dialog."},{text:"Calculator",icon:"images/calculator.png",tooltip:"Launches the calculator."},{text:"Defines",icon:"images/defines.png",tooltip:"Launches the defines dialog."},{text:"Marker",icon:"images/marker.png",tooltip:"Launches the marker dialog."},{text:"Print",icon:"images/print.png",tooltip:"Print the current graph."}]});var o=this.addToolButton("checkbox",{label:"C-Prop",cb:function(e){r.leftSidebar.showGridItem(0,e)},tooltip:"Show/Hide curve properties pane",disabled:!0}),l=this.addToolButton("checkbox",{label:"P-Prop",checked:!0,cb:function(e){r.leftSidebar.showGridItem(1,e)},tooltip:"Show/Hide plot properties pane"});Static.bind("showGridItem",function(e,t,n,i){"left"==t&&(0==n?a.setButtonCheck(o,i):a.setButtonCheck(l,i))}),this.addToolButton("upload",{innerHtmlId:"fileInput",class:"btn btn-primary",tooltip:"Upload data files"}),this.addToolButton("radio",{label:"Zoom",tooltip:"Enable zooming. Press the mouse left button and drag.",cb:n}),this.addToolButton("radio",{label:"Pan",tooltip:"Allow dragging of all plot items to new positions. Press the mouse left button and drag.",cb:n}),this.addToolButton("radio",{label:"Auto",tooltip:"Determine and and apply the scale that\nallows the extent of all curves to be shown.",cb:n,checked:!0}),this.addToolButton("dropdown",{text:"View",hasCheckbox:!0,cb:function(e,t,n){i[t](n)},listElements:[{text:"Left axis",icon:"images/axis.png",tooltip:"Enable left axis",checkboxState:"checked"},{text:"Bottom axis",icon:"images/axis.png",tooltip:"Enable bottom axis",checkboxState:"checked"},{text:"Right axis",icon:"images/axis.png",tooltip:"Enable right axis"},{text:"Top axis",icon:"images/axis.png",tooltip:"Enable top axis"},{text:"Major gridlines",icon:"images/major_grid.png",tooltip:"Enable major gridlines",checkboxState:"checked"},{text:"Minor gridlines",icon:"images/minor_grid.png",tooltip:"Enable minor gridlines",checkboxState:"checked"},{text:"Title",icon:"images/title.png",tooltip:"Enable title",checkboxState:"checked"},{text:"Footer",icon:"images/footer.png",tooltip:"Enable footor",checkboxState:"checked"},{text:"Legend",icon:"images/legend.png",tooltip:"Enable the legend (at least one curve should be present)",checkboxState:"checked"}]});var c=this.addToolButton("checkbox",{label:"S-Bar",cb:function(e){r.itemList(Static.Rtti_PlotCurve).length&&(r.rightSidebar.showGridItem(0,e),r.rv.updateWatchesAndTable()),e||r.sidebar.setSidebarReDisplay(!1)},tooltip:"Show/Hide sidbar",disabled:!0});this.addToolButton("checkbox",{label:"P-Sel",cb:function(e){r.curveClosestPoint.setEnabled(e),Static.trigger("pSel",e)},tooltip:"Turn on point selection. This may affect response."});this.addToolButton("pushbutton",{text:"+",icon:"images/zoom_in.png",repeat:!0,tooltip:"Zoom in.",cb:function(e){r.magnifier.rescale(.98)}}),this.addToolButton("pushbutton",{text:"-",icon:"images/zoom_out.png",repeat:!0,tooltip:"Zoom out",cb:function(e){r.magnifier.rescale(1/.98)}}),this.addToolButton("dropdown",{text:"Watch",tooltip:"Enable/disable watches.",hasCheckbox:!0,cb:function(e,t,n){r.rv.watch(t).setEnable(n),r.rv.updateWatchesAndTable(),Static.trigger("curveAdjusted")},listElements:t}),this.addToolButton("pushbutton",{text:"Mongo-Filesystem",class:"mongo-fs-login-logout-register btn btn-primary",cb:function(){}}),this.addToolButton("link",{text:"Help",cb:function(){},href:"grapherHelp/Grapher.html",target:"_blank",class:"noSelect",tooltip:"Launches online help."}),Static.bind("showGridItem",function(e,t,n,i){"right"==t&&(i||(a.setButtonCheck(c,!1),r.sidebar&&r.sidebar.setSidebarReDisplay(!1)))}),Static.bind("visibilityChange",function(e,t,n){t.rtti==Static.Rtti_PlotCurve&&(r.sidebar&&r.sidebar.initSidebar(),r.hasVisiblePlotCurve()?(a.enable(c),r.sidebar&&r.sidebar.sidebarReDisplay()&&(r.rightSidebar.showSidebar(!0),r.sidebar.setSidebarReDisplay(!1))):(a.disable(c),r.tbar.hideDropdownItem("View",10),r.rightSidebar&&r.rightSidebar.isSideBarVisible()&&(Static.alert("Ooops!! No visible curves to watch."),r.rightSidebar.showSidebar(!1),r.sidebar.setSidebarReDisplay(!0))))}),Static.bind("itemChanged",function(e,t,n){t.rtti==Static.Rtti_PlotGrid&&(n?r.tbar.showDropdownItem("View",6):r.tbar.hideDropdownItem("View",6))}),Static.bind("rescaled",function(e,t){t||a.setButtonCheck("Auto",!1)}),""==r.title()&&a.hideDropdownItem("View",7),Static.bind("titleAdded",function(e,t){t?a.showDropdownItem("View",7):a.hideDropdownItem("View",7)}),""==r.footer()&&a.hideDropdownItem("View",8),Static.bind("footerAdded",function(e,t){t?a.showDropdownItem("View",8):a.hideDropdownItem("View",8)}),Static.bind("itemAttached",function(e,t,n){t.rtti!=Static.Rtti_PlotCurve&&t.rtti!=Static.Rtti_PlotSpectroCurve&&t.rtti!=Static.Rtti_PlotSpectrogram||(n?(t.rtti==Static.Rtti_PlotCurve&&a.enable(c),a.enable(o)):(0==r.itemList(Static.Rtti_PlotCurve).length&&0==r.itemList(Static.Rtti_PlotSpectroCurve).length&&0==r.itemList(Static.Rtti_PlotSpectrogram).length&&a.disable(o),r.itemList(Static.Rtti_PlotCurve).length&&r.hasVisiblePlotCurve()||(a.disable(c),a.setButtonCheck(c,!1))),Static.trigger("visibilityChange",[t,n]))}),Static.bind("showSidebar",function(e,t,n){"right"===t&&(a.setButtonCheck(c,n),n&&r.tbar.isDropdownItemChecked("Watch",6)?r.cs.setEnabled(!0):r.cs.setEnabled(!1))}),r.sidebar}}function make_xlsx_lib(i){function c(){Xr(1200),Ur(1252)}function ee(e){for(var t=[],n=0,i=e.length;n<i;++n)t[n]=e.charCodeAt(n);return t}function Y(e){return Qr?Buffer.alloc(e):new Array(e)}function K(e){return Qr?Buffer.allocUnsafe(e):new Array(e)}function r(e){if("undefined"==typeof ArrayBuffer)return ta(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i!=e.length;++i)n[i]=255&e.charCodeAt(i);return t}function a(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function u(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return u(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}function s(e){return"string"==typeof e?r(e):Array.isArray(e)?function(e){if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function o(e,t,n){if(void 0!==ha&&ha.writeFileSync)return n?ha.writeFileSync(e,t,n):ha.writeFileSync(e,t);n="utf8"==n?Fa(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(n,e);if("undefined"!=typeof Blob){n=new Blob([s(n)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if("undefined"!=typeof saveAs)return saveAs(n,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});n=document.createElement("a");if(null!=n.download)return n.download=e,n.href=i,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var r=File(e);return r.open("w"),r.encoding="binary",Array.isArray(t)&&(t=a(t)),r.write(t),r.close(),t}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("cannot save file "+e)}function ce(e){for(var t=Object.keys(e),n=[],i=0;i<t.length;++i)e.hasOwnProperty(t[i])&&n.push(t[i]);return n}function e(e,t){for(var n=[],i=ce(e),r=0;r!==i.length;++r)null==n[e[i[r]][t]]&&(n[e[i[r]][t]]=i[r]);return n}function t(e){for(var t=[],n=ce(e),i=0;i!==n.length;++i)t[e[n[i]]]=n[i];return t}function x(e){for(var t=[],n=ce(e),i=0;i!==n.length;++i)t[e[n[i]]]=parseInt(n[i],10);return t}function G(e,t){e=e.getTime();return t&&(e-=1263168e5),(e-ma)/864e5}function F(e){var t=new Date;return t.setTime(24*e*60*60*1e3+ma),t}function te(e,t){var n=new Date(e);if(va)return 0<t?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==ga.getFullYear()&&!isNaN(n.getFullYear())){t=n.getFullYear();return-1<e.indexOf(""+t)||n.setFullYear(n.getFullYear()+100),n}n=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return n=-1<e.indexOf("Z")?new Date(n.getTime()-60*n.getTimezoneOffset()*1e3):n}function h(e){for(var t="",n=0;n!=e.length;++n)t+=String.fromCharCode(e[n]);return t}function ne(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=ne(e[t]));return n}function M(e,t){for(var n="";n.length<t;)n+=e;return n}function _(e){var t=Number(e);if(!isNaN(t))return t;var n=1,e=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return isNaN(t=Number(e))?(e=e.replace(/[(](.*)[)]/,function(e,t){return n=-n,t}),isNaN(t=Number(e))?t:t/n):t/n}function C(e){var t=new Date(e),n=new Date(NaN),i=t.getYear(),r=t.getMonth(),a=t.getDate();return isNaN(a)||i<0||8099<i||(!(0<r||1<a)||101==i)&&!e.toLowerCase().match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)&&e.match(/[^-0-9:,\/\\]/)?n:t}function l(e){return e?e.data?Gr(e.data):e.asNodeBuffer&&Qr?Gr(e.asNodeBuffer().toString("binary")):e.asBinary?Gr(e.asBinary()):e._data&&e._data.getContent?Gr(h(Array.prototype.slice.call(e._data.getContent(),0))):e.content&&e.type?Gr(h(e.content)):null:null}function d(e){return(e&&".bin"===e.name.slice(-4)?function(e){if(!e)return null;if(e.data)return ee(e.data);if(e.asNodeBuffer&&Qr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?ee(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}:l)(e)}function A(e,t){for(var n=e.FullPaths||ce(e.files),i=t.toLowerCase(),r=i.replace(/\//g,"\\"),a=0;a<n.length;++a){var s=n[a].toLowerCase();if(i==s||r==s)return e.files[n[a]]}return null}function f(e,t){e=A(e,t);if(null==e)throw new Error("Cannot find file "+t+" in zip");return e}function T(e,t,n){if(!n)return d(f(e,t));if(!t)return null;try{return T(e,t)}catch(e){return null}}function B(e,t,n){if(!n)return l(f(e,t));if(!t)return null;try{return B(e,t)}catch(e){return null}}function w(e,t,n){e.FullPaths?da.utils.cfb_add(e,t,n):e.file(t,n)}function E(){return fa?new fa:da.utils.cfb_new()}function k(e,t){if("/"==e.charAt(0))return e.slice(1);var n=t.split("/");"/"!=t.slice(-1)&&n.pop();for(var i=e.split("/");0!==i.length;){var r=i.shift();".."===r?n.pop():"."!==r&&n.push(r)}return n.join("/")}function ie(e,t,n){for(var i={},r=0,a=0;r!==e.length&&32!==(a=e.charCodeAt(r))&&10!==a&&13!==a;++r);if(t||(i[0]=e.slice(0,r)),r===e.length)return i;var s,o,l,c=e.match(ya),u=0,h=0,d="",f="";if(c)for(h=0;h!=c.length;++h){for(f=c[h],a=0;a!=f.length&&61!==f.charCodeAt(a);++a);for(d=f.slice(0,a).trim();32==f.charCodeAt(a+1);)++a;for(o=34==(r=f.charCodeAt(a+1))||39==r?1:0,s=f.slice(a+1+o,f.length-o),u=0;u!=d.length&&58!==d.charCodeAt(u);++u);u===d.length?(i[d=0<d.indexOf("_")?d.slice(0,d.indexOf("_")):d]=s,n||(i[d.toLowerCase()]=s)):i[l=(5===u&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(u+1)]&&"ext"==d.slice(u-3,u)||(i[l]=s,n||(i[l.toLowerCase()]=s))}return i}function p(e){return e.replace(ka,"<$1")}function P(e){return(e+"").replace(Ta,function(e){return Ra[e]}).replace(Ba,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function m(e){return P(e).replace(/ /g,"_x0020_")}function O(e){return(e+"").replace(Ta,function(e){return Ra[e]}).replace(/\n/g,"<br/>").replace(Ma,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function re(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function g(e,t){var n=ie(e),e=e.match(Xa(n.baseType))||[],i=[];if(e.length==n.size)return e.forEach(function(e){e=e.replace(Ga,"").match(ja);e&&i.push({v:La(e[2]),t:e[1]})}),i;if(t.WTF)throw new Error("unexpected vector length "+e.length+" != "+n.size);return i}function R(e,t){return"<"+e+(t.match(Ya)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function D(t){return ce(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function I(e,t,n){return"<"+e+(null!=n?D(n):"")+(null!=t?(t.match(Ya)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function L(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function Z(e,t){var n,i,r,a,s,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,Qr&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(ys(this,o)),o+=2;e*=2;break;case"utf8":l=is(this,this.l,this.l+e);break;case"utf16le":l=Ja(this,this.l,this.l+(e*=2));break;case"wstr":if("undefined"==typeof cptable)return Z.call(this,e,"dbcs");l=cptable.utils.decode(zr,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=as(this,this.l),e=4+ws(this,this.l);break;case"lpstr-cp":l=os(this,this.l),e=4+ws(this,this.l);break;case"lpwstr":l=cs(this,this.l),e=4+2*ws(this,this.l);break;case"lpp4":e=4+ws(this,this.l),l=hs(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+ws(this,this.l),l=ds(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(r=Ss(this,this.l+e++));)c.push(jr(r));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(r=ys(this,this.l+e));)c.push(jr(r)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return r=Ss(this,o),this.l=o+1,a=Z.call(this,e-s,r?"dbcs-cont":"sbcs-cont"),c.join("")+a;c.push(jr(ys(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!=typeof cptable){l=cptable.utils.decode(zr,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return r=Ss(this,o),this.l=o+1,a=Z.call(this,e-s,r?"dbcs-cont":"sbcs-cont"),c.join("")+a;c.push(jr(Ss(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return n=Ss(this,this.l),this.l++,n;case 2:return n=("i"===t?xs:ys)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0==(128&this[this.l+3])?(n=(0<e?_s:Cs)(this,this.l),this.l+=4,n):(i=ws(this,this.l),this.l+=4,i);case 8:case-8:if("f"===t)return i=8==e?ps(this,this.l):ps([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:l=ts(this,this.l,e)}}return this.l+=e,l}function n(e,t,n){var i=0,r=0;if("dbcs"===n){for(r=0;r!=t.length;++r)bs(this,t.charCodeAt(r),this.l+2*r);i=2*t.length}else if("sbcs"===n){if("undefined"!=typeof cptable&&874==Wr)for(r=0;r!=t.length;++r){var a=cptable.utils.encode(Wr,t.charAt(r));this[this.l+r]=a[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=t.length;++r)this[this.l+r]=255&t.charCodeAt(r);i=t.length}else{if("hex"===n){for(;r<e;++r)this[this.l++]=parseInt(t.slice(2*r,2*r+2),16)||0;return this}if("utf16le"===n){for(var s=Math.min(this.l+e,this.length),r=0;r<Math.min(t.length,e);++r){var o=t.charCodeAt(r);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:i=1,this[this.l]=255&t;break;case 2:i=2,this[this.l]=255&t,this[this.l+1]=255&(t>>>=8);break;case 3:i=3,this[this.l]=255&t,this[this.l+1]=255&(t>>>=8),this[this.l+2]=255&(t>>>=8);break;case 4:i=4,gs(this,t,this.l);break;case 8:if(i=8,"f"===n){!function(e,t,n){var i=(t<0||1/t==-1/0?1:0)<<7,r=0,a=0,s=i?-t:t;isFinite(s)?0==s?r=a=0:(r=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-r),r<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?r=-1022:(a-=Math.pow(2,52),r+=1023)):(r=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[n+o]=255&a;e[n+6]=(15&r)<<4|15&a,e[n+7]=r>>4|i}(this,t,this.l);break}case 16:break;case-4:i=4,vs(this,t,this.l)}}return this.l+=i,this}function q(e,t){var n=ts(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function ue(e,t){e.l=t,e._R=Z,e.chk=q,e._W=n}function v(e,t){e.l+=t}function Q(e){e=Y(e);return ue(e,0),e}function N(e,t,n){if(e){ue(e,e.l||0);for(var i=e.length,r=0;e.l<i;){128&(r=e._R(1))&&(r=(127&r)+((127&e._R(1))<<7));for(var a,s=Ru[r]||Ru[65535],o=127&(a=e._R(1)),l=1;l<4&&128&a;++l)o+=(127&(a=e._R(1)))<<7*l;var c=e.l+o,u=(s.f||v)(e,o,n);if(e.l=c,t(u,s.n,r))return}}}function y(){function t(e){return ue(e=Q(e),0),e}function n(){a&&(a.length>a.l&&((a=a.slice(0,a.l)).l=a.length),0<a.length&&e.push(a),a=null)}function i(e){return a&&e<a.length-a.l?a:(n(),a=t(Math.max(e+1,r)))}var e=[],r=Qr?256:2048,a=t(r);return{next:i,push:function(e){n(),null==(a=e).l&&(a.l=a.length),i(r)},end:function(){return n(),qa([e])},_bufs:e}}function b(e,t,n,i){var r=+Au[t];if(!isNaN(r)){t=1+(128<=r?1:0)+1,128<=(i=i||(Ru[r].p||(n||[]).length||0))&&++t,16384<=i&&++t,2097152<=i&&++t;var a=e.next(t);r<=127?a._W(1,r):(a._W(1,128+(127&r)),a._W(1,r>>7));for(var s=0;4!=s;++s){if(!(128<=i)){a._W(1,i);break}a._W(1,128+(127&i)),i>>=7}0<i&&ms(n)&&e.push(n)}}function z(e,t,n){var i=ne(e);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!n||n.biff<12){for(;256<=i.c;)i.c-=256;for(;65536<=i.r;)i.r-=65536}return i}function W(e,t,n){e=ne(e);return e.s=z(e.s,t.s,n),e.e=z(e.e,t.s,n),e}function V(e,t){if(e.cRel&&e.c<0)for(e=ne(e);e.c<0;)e.c+=8<t?16384:256;if(e.rRel&&e.r<0)for(e=ne(e);e.r<0;)e.r+=8<t?1048576:5<t?65536:16384;var n=he(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),n=!e.rRel&&null!=e.rRel?n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2"):n}function U(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(12<=t.biff?1048575:8<=t.biff?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(12<=t.biff?65535:255)||e.e.cRel?V(e.s,t.biff)+":"+V(e.e,t.biff):(e.s.rRel?"":"$")+ae(e.s.r)+":"+(e.e.rRel?"":"$")+ae(e.e.r):(e.s.cRel?"":"$")+se(e.s.c)+":"+(e.e.cRel?"":"$")+se(e.e.c)}function S(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function ae(e){return""+(e+1)}function H(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,i=0;i!==t.length;++i)n=26*n+t.charCodeAt(i)-64;return n-1}function se(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function X(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function j(e){e=X(e);return{c:H(e[0]),r:S(e[1])}}function he(e){return se(e.c)+ae(e.r)}function J(e){e=e.split(":").map(j);return{s:e[0],e:e[e.length-1]}}function de(e,t){return void 0===t||"number"==typeof t?de(e.s,e.e):(e="string"!=typeof e?he(e):e)==(t="string"!=typeof t?he(t):t)?e:e+":"+t}function oe(e){for(var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,i=0,r=0,a=e.length,n=0;i<a&&!((r=e.charCodeAt(i)-64)<1||26<r);++i)n=26*n+r;for(t.s.c=--n,n=0;i<a&&!((r=e.charCodeAt(i)-48)<0||9<r);++i)n=10*n+r;if(t.s.r=--n,i===a||58===e.charCodeAt(++i))return t.e.c=t.s.c,t.e.r=t.s.r,t;for(n=0;i!=a&&!((r=e.charCodeAt(i)-64)<1||26<r);++i)n=26*n+r;for(t.e.c=--n,n=0;i!=a&&!((r=e.charCodeAt(i)-48)<0||9<r);++i)n=10*n+r;return t.e.r=--n,t}function le(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=aa.format(e.z,n?G(t):t)}catch(e){}try{return e.w=aa.format((e.XF||{}).numFmtId||(n?14:0),n?G(t):t)}catch(e){return""+t}}function fe(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),le(e,null==t?e.v:t))}function pe(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",t={};return t[n]=e,{SheetNames:[n],Sheets:t}}function me(e,t,n){var i=n||{},r=e?Array.isArray(e):i.dense;null!=Zr&&null==r&&(r=Zr);var a=e||(r?[]:{}),s=0,o=0;a&&null!=i.origin&&("number"==typeof i.origin?s=i.origin:(s=(l="string"==typeof i.origin?j(i.origin):i.origin).r,o=l.c));var l,c={s:{c:1e7,r:1e7},e:{c:0,r:0}};a["!ref"]&&(l=oe(a["!ref"]),c.s.c=l.s.c,c.s.r=l.s.r,c.e.c=Math.max(c.e.c,l.e.c),c.e.r=Math.max(c.e.r,l.e.r),-1==s&&(c.e.r=s=l.e.r+1));for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if(void 0!==t[u][h]){var d={v:t[u][h]},f=s+u,p=o+h;if(c.s.r>f&&(c.s.r=f),c.s.c>p&&(c.s.c=p),c.e.r<f&&(c.e.r=f),c.e.c<p&&(c.e.c=p),!t[u][h]||"object"!=typeof t[u][h]||Array.isArray(t[u][h])||t[u][h]instanceof Date)if(Array.isArray(d.v)&&(d.f=t[u][h][1],d.v=d.v[0]),null===d.v)if(d.f)d.t="n";else{if(!i.sheetStubs)continue;d.t="z"}else"number"==typeof d.v?d.t="n":"boolean"==typeof d.v?d.t="b":d.v instanceof Date?(d.z=i.dateNF||aa._table[14],i.cellDates?(d.t="d",d.w=aa.format(d.z,G(d.v))):(d.t="n",d.v=G(d.v),d.w=aa.format(d.z,d.v))):d.t="s";else d=t[u][h];r?(a[f]||(a[f]=[]),a[f][p]&&a[f][p].z&&(d.z=a[f][p].z),a[f][p]=d):(a[f=he({c:p,r:f})]&&a[f].z&&(d.z=a[f].z),a[f]=d)}}return c.s.c<1e7&&(a["!ref"]=de(c)),a}function ge(e,t){return me(null,e,t)}function ve(e,t){return(t=t||Q(4))._W(4,e),t}function be(e){var t=e._R(4);return 0===t?"":e._R(t,"dbcs")}function Se(e,t){var n=!1;return null==t&&(n=!0,t=Q(4+2*e.length)),t._W(4,e.length),0<e.length&&t._W(0,e,"dbcs"),n?t.slice(0,t.l):t}function ye(e,t){var n,i=e.l,r=e._R(1),a=be(e),s=[],a={t:a,h:a};if(0!=(1&r)){for(var o=e._R(4),l=0;l!=o;++l)s.push({ich:(n=e)._R(2),ifnt:n._R(2)});a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=i+t,a}function xe(e,t){var n,i=!1;return null==t&&(i=!0,t=Q(23+4*e.t.length)),t._W(1,1),Se(e.t,t),t._W(4,1),n={ich:0,ifnt:0},(e=(e=t)||Q(4))._W(2,n.ich||0),e._W(2,n.ifnt||0),i?t.slice(0,t.l):t}function we(e){var t=e._R(4),n=e._R(2);return n+=e._R(1)<<16,e.l++,{c:t,iStyleRef:n}}function _e(e,t){return(t=null==t?Q(8):t)._W(-4,e.c),t._W(3,e.iStyleRef||e.s),t._W(1,0),t}function Ce(e){var t=e._R(4);return 0===t||4294967295===t?"":e._R(t,"dbcs")}function Ee(e,t){var n=!1;return null==t&&(n=!0,t=Q(127)),t._W(4,0<e.length?e.length:4294967295),0<e.length&&t._W(0,e,"dbcs"),n?t.slice(0,t.l):t}function ke(e){var t=e.slice(e.l,e.l+4),n=1&t[0],i=2&t[0];e.l+=4,t[0]&=252;t=0==i?ps([0,0,0,0,t[0],t[1],t[2],t[3]],0):_s(t,0)>>2;return n?t/100:t}function Pe(e){var t={s:{},e:{}};return t.s.r=e._R(4),t.e.r=e._R(4),t.s.c=e._R(4),t.e.c=e._R(4),t}function Re(e){return e._R(8,"f")}function Ae(e,t){return(t||Q(8))._W(8,e,"f")}function Te(e,t){if(t=t||Q(8),!e||e.auto)return t._W(4,0),t._W(4,0),t;null!=e.index?(t._W(1,2),t._W(1,e.index)):null!=e.theme?(t._W(1,6),t._W(1,e.theme)):(t._W(1,5),t._W(1,0));var n=e.tint||0;return 0<n?n*=32767:n<0&&(n*=32768),t._W(2,n),e.rgb&&null==e.theme?("number"==typeof(e=e.rgb||"FFFFFF")&&(e=("000000"+e.toString(16)).slice(-6)),t._W(1,parseInt(e.slice(0,2),16)),t._W(1,parseInt(e.slice(2,4),16)),t._W(1,parseInt(e.slice(4,6),16)),t._W(1,255)):(t._W(2,0),t._W(1,0),t._W(1,0)),t}function Be(e,t){var n=e._R(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e._R(4)]||""}if(400<n)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e._R(0,1==t?"lpstr":"lpwstr")}function Me(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],TODO:[],xmlns:""}}function De(n,i){var t;(s=[])[s.length]=Sa,s[s.length]=Ks;function e(e){n[e]&&0<n[e].length&&(t=n[e][0],s[s.length]=I("Override",null,{PartName:("/"==t[0]?"":"/")+t,ContentType:js[e][i.bookType||"xlsx"]}))}function r(t){(n[t]||[]).forEach(function(e){s[s.length]=I("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:js[t][i.bookType||"xlsx"]})})}function a(t){(n[t]||[]).forEach(function(e){s[s.length]=I("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Ys[t][0]})})}var s=s.concat(Zs);return e("workbooks"),r("sheets"),r("charts"),a("themes"),["strs","styles"].forEach(e),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("drawings"),2<s.length&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}function Ie(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Le(e,i){var r={"!id":{}};if(!e)return r;"/"!==i.charAt(0)&&(i="/"+i);var a={};return(e.match(xa)||[]).forEach(function(e){var t,n=ie(e);"<Relationship"===n[0]&&((t={}).Type=n.Type,t.Target=n.Target,t.Id=n.Id,t.TargetMode=n.TargetMode,e="External"===n.TargetMode?n.Target:k(n.Target,i),r[e]=t,a[n.Id]=t)}),r["!id"]=a,r}function Fe(t){var n=[Sa,Js];return ce(t["!id"]).forEach(function(e){n[n.length]=I("Relationship",null,t["!id"][e])}),2<n.length&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function Oe(e,t,n,i,r,a){if(r=r||{},e["!id"]||(e["!id"]={}),t<0)for(t=1;e["!id"]["rId"+t];++t);if(r.Id="rId"+t,r.Type=i,r.Target=n,a?r.TargetMode=a:-1<eo.indexOf(r.Type)&&(r.TargetMode="External"),e["!id"][r.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][r.Id]=r,e[("/"+r.Target).replace("//","/")]=r,t}function Ne(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function ze(e){var t={};e=La(e);for(var n=0;n<io.length;++n){var i=io[n],r=e.match(ro[n]);null!=r&&0<r.length&&(t[i[1]]=Aa(r[1])),"date"===i[2]&&t[i[1]]&&(t[i[1]]=te(t[i[1]]))}return t}function We(e,t,n,i,r){null==r[e]&&null!=t&&""!==t&&(t=P(r[e]=t),i[i.length]=n?I(e,t,n):R(e,t))}function Ve(e,t,n,i){var r=[];if("string"==typeof e)r=g(e,i);else for(var a=0;a<e.length;++a)r=r.concat(e[a].map(function(e){return{v:e}}));var s,o="string"==typeof t?g(t,i).map(function(e){return e.v}):t,l=0;if(0<o.length)for(var c=0;c!==r.length;c+=2){switch(s=+r[c+1].v,r[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":n.Worksheets=s,n.SheetNames=o.slice(l,l+s);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":n.NamedRanges=s,n.DefinedNames=o.slice(l,l+s);break;case"Charts":case"Diagramme":n.Chartsheets=s,n.ChartNames=o.slice(l,l+s)}l+=s}}function $e(t){var n=[Sa,uo];if(!t)return n.join("");var i=1;return ce(t).forEach(function(e){++i,n[n.length]=I("property",function(e){switch(typeof e){case"string":return I("vt:lpwstr",P(e));case"number":return I((0|e)==e?"vt:i4":"vt:r8",P(String(e)));case"boolean":return I("vt:bool",e?"true":"false")}if(e instanceof Date)return I("vt:filetime",L(e));throw new Error("Unable to serialize "+e)}(t[e]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:i,name:P(e)})}),2<n.length&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}function Ue(e){var t=e._R(4),e=e._R(4);return new Date(1e3*(e/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function He(e,t,n){var i=e.l,r=e._R(0,"lpstr-cp");if(n)for(;e.l-i&3;)++e.l;return r}function Xe(e,t,n){var i=e._R(0,"lpwstr");return n&&(e.l+=4-(i.length+1&3)&3),i}function Ge(e,t,n){return 31===t?Xe(e):He(e,0,n)}function je(e,t,n){return Ge(e,t,!1===n?0:4)}function Ye(e){return function(e){for(var t=e._R(4),n=[],i=0;i!=t;++i)n[i]=e._R(0,"lpstr-cp").replace(ia,"");return n}(e)}function Ke(e){for(var t,n=e._R(4),i=[],r=0;r!=n/2;++r)i.push([Qe(t=e,81),Qe(t,3)]);return i}function Ze(e,t){for(var n=e._R(4),i={},r=0;r!=n;++r){var a=e._R(4),s=e._R(4);i[a]=e._R(s,1200===t?"utf16le":"utf8").replace(ia,"").replace(ra,"!"),1200===t&&s%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),i}function qe(e){var t=e._R(4),n=e.slice(e.l,e.l+t);return e.l+=t,0<(3&t)&&(e.l+=4-(3&t)&3),n}function Qe(e,t,n){var i,r,a=e._R(2),s=n||{};if(e.l+=2,t!==Ls&&a!==t&&-1===Fs.indexOf(t))throw new Error("Expected type "+t+" saw "+a);switch(t===Ls?a:t){case 2:return i=e._R(2,"i"),s.raw||(e.l+=2),i;case 3:return e._R(4,"i");case 11:return 0!==e._R(4);case 19:return e._R(4);case 30:return He(e,0,4).replace(ia,"");case 31:return Xe(e);case 64:return Ue(e);case 65:return qe(e);case 71:return(r={}).Size=(i=e)._R(4),i.l+=r.Size+3-(r.Size-1)%4,r;case 80:return je(e,a,!s.raw).replace(ia,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Ge(e,t,0)}(e,a).replace(ia,"");case 4108:return Ke(e);case 4126:return Ye(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Je(e,t){var n,i,r,a=Q(4),s=Q(4);switch(a._W(4,80==e?31:e),e){case 3:s._W(-4,t);break;case 5:(s=Q(8))._W(8,t,"f");break;case 11:s._W(4,t?1:0);break;case 64:i=("string"==typeof(n=t)?new Date(Date.parse(n)):n).getTime()/1e3+11644473600,r=i%Math.pow(2,32),n=(i-r)/Math.pow(2,32),n*=1e7,0<(i=(r*=1e7)/Math.pow(2,32)|0)&&(r%=Math.pow(2,32),n+=i),(i=Q(8))._W(4,r),i._W(4,n),s=i;break;case 31:case 80:for((s=Q(4+2*(t.length+1)+(t.length%2?0:2)))._W(4,t.length+1),s._W(0,t,"dbcs");s.l!=s.length;)s._W(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return na([a,s])}function et(e,t){for(var n=e.l,i=e._R(4),r=e._R(4),a=[],s=0,o=0,l=-1,c={},s=0;s!=r;++s){var u=e._R(4),h=e._R(4);a[s]=[u,h+n]}a.sort(function(e,t){return e[1]-t[1]});var d={};for(s=0;s!=r;++s){if(e.l!==a[s][1]){var f=!0;if(0<s&&t)switch(t[a[s-1][0]].t){case 2:e.l+2===a[s][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=a[s][1]&&(e.l=a[s][1],f=!1)}if((!t||0==s)&&e.l<=a[s][1]&&(f=!1,e.l=a[s][1]),f)throw new Error("Read Error: Expected address "+a[s][1]+" at "+e.l+" :"+s)}if(t){var p=t[a[s][0]];if(d[p.n]=Qe(e,p.t,{raw:!0}),"version"===p.p&&(d[p.n]=String(d[p.n]>>16)+"."+("0000"+String(65535&d[p.n])).slice(-4)),"CodePage"==p.n)switch(d[p.n]){case 0:d[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Xr(o=d[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[p.n])}}else if(1===a[s][0]){o=d.CodePage=Qe(e,2);Xr(o),-1!==l&&(g=e.l,e.l=a[l][1],c=Ze(e,o),e.l=g)}else if(0===a[s][0])0!==o?c=Ze(e,o):(l=s,e.l=a[s+1][1]);else{var m,g=c[a[s][0]];switch(e[e.l]){case 65:e.l+=4,m=qe(e);break;case 30:case 31:e.l+=4,m=je(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,m=e._R(4,"i");break;case 19:e.l+=4,m=e._R(4);break;case 5:e.l+=4,m=e._R(8,"f");break;case 11:e.l+=4,m=at(e,4);break;case 64:e.l+=4,m=te(Ue(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[g]=m}}return e.l=n+i,d}function tt(e,t,n){var i,r,a,s,o=Q(8),l=[],c=[],u=8,h=0,d=Q(8),f=Q(8);if(d._W(4,2),d._W(4,1200),f._W(4,1),c.push(d),l.push(f),u+=8+d.length,!t){(f=Q(8))._W(4,0),l.unshift(f);var p=[Q(4)];for(p[0]._W(4,e.length),h=0;h<e.length;++h){var m=e[h][0];for((d=Q(8+2*(m.length+1)+(m.length%2?0:2)))._W(4,h+2),d._W(4,m.length+1),d._W(0,m,"dbcs");d.l!=d.length;)d._W(1,0);p.push(d)}d=na(p),c.unshift(d),u+=8+d.length}for(h=0;h<e.length;++h)t&&!t[e[h][0]]||-1<po.indexOf(e[h][0])||null==e[h][1]||(a=e[h][1],i=0,d=t?("version"==(s=n[i=+t[e[h][0]]]).p&&"string"==typeof a&&(a=(+(r=a.split("."))[0]<<16)+(+r[1]||0)),Je(s.t,a)):(-1==(s=function(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}(a))&&(s=31,a=String(a)),Je(s,a)),c.push(d),(f=Q(8))._W(4,t?i:2+h),l.push(f),u+=8+d.length);for(var g=8*(c.length+1),h=0;h<c.length;++h)l[h]._W(4,g),g+=c[h].length;return o._W(4,u),o._W(4,c.length),na([o].concat(l).concat(c))}function nt(e,t,n){var i=e.content;if(!i)return{};ue(i,0);var r,a,s=0;i.chk("feff","Byte Order: "),i._R(2);var o=i._R(4),l=i._R(16);if(l!==da.utils.consts.HEADER_CLSID&&l!==n)throw new Error("Bad PropertySet CLSID "+l);if(1!==(r=i._R(4))&&2!==r)throw new Error("Unrecognized #Sets: "+r);if(n=i._R(16),l=i._R(4),1===r&&l!==i.l)throw new Error("Length mismatch: "+l+" !== "+i.l);2===r&&(a=i._R(16),s=i._R(4));var c,u,h=et(i,t),d={SystemIdentifier:o};for(c in h)d[c]=h[c];if(d.FMTID=n,1===r)return d;if(s-i.l==2&&(i.l+=2),i.l!==s)throw new Error("Length mismatch 2: "+i.l+" !== "+s);try{u=et(i,null)}catch(e){}for(c in u)d[c]=u[c];return d.FMTID=[n,a],d}function it(e,t,n,i,r,a){var s=Q(r?68:48),o=[s];s._W(2,65534),s._W(2,0),s._W(4,842412599),s._W(16,da.utils.consts.HEADER_CLSID,"hex"),s._W(4,r?2:1),s._W(16,t,"hex"),s._W(4,r?68:48);i=tt(e,n,i);return o.push(i),r&&(r=tt(r,null,null),s._W(16,a,"hex"),s._W(4,68+i.length),o.push(r)),na(o)}function rt(e,t){return e._R(t),null}function at(e,t){return 1===e._R(t)}function st(e,t){return(t=t||Q(2))._W(2,+!!e),t}function ot(e){return e._R(2,"u")}function lt(e,t){return(t=t||Q(2))._W(2,e),t}function ct(e,t){return function(e,t,n){for(var i=[],r=e.l+t;e.l<r;)i.push(n(e,r-e.l));if(r!==e.l)throw new Error("Slurp error");return i}(e,t,ot)}function ut(e,t,n){var i=e._R(n&&12<=n.biff?2:1),r="sbcs-cont",a=zr;n&&8<=n.biff&&(zr=1200),n&&8!=n.biff?12==n.biff&&(r="wstr"):e._R(1)&&(r="dbcs-cont"),2<=n.biff&&n.biff<=5&&(r="cpstr");r=i?e._R(i,r):"";return zr=a,r}function ht(e,t,n){if(n){if(2<=n.biff&&n.biff<=5)return e._R(t,"cpstr");if(12<=n.biff)return e._R(t,"dbcs-cont")}return 0===e._R(1)?e._R(t,"sbcs-cont"):e._R(t,"dbcs-cont")}function dt(e,t,n){var i=e._R(n&&2==n.biff?1:2);return 0===i?(e.l++,""):ht(e,i,n)}function ft(e,t,n){if(5<n.biff)return dt(e,0,n);var i=e._R(1);return 0===i?(e.l++,""):e._R(i,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function pt(e,t,n){return(n=n||Q(3+2*e.length))._W(2,e.length),n._W(1,1),n._W(31,e,"utf16le"),n}function mt(e){var t,n,i,r,a=e._R(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return n=(t=e)._R(4),i=t.l,r=!1,24<n&&(t.l+=n-24,"795881f43b1d7f48af2c825dc4852763"===t._R(16)&&(r=!0),t.l=i),n=t._R((r?n-24:n)>>1,"utf16le").replace(ia,""),r&&(t.l+=24),n;case"0303000000000000c000000000000046":return function(e){e.l+=2;var t=e._R(0,"lpstr-ansi");if(e.l+=2,57005!=e._R(2))throw new Error("Bad FileMoniker");if(0===e._R(4))return t.replace(/\\/g,"/");if(t=e._R(4),3!=e._R(2))throw new Error("Bad FileMoniker");return e._R(t>>1,"utf16le").replace(ia,"")}(e);default:throw new Error("Unsupported Moniker "+a)}}function gt(e){var t=e._R(4);return 0<t?e._R(t,"utf16le").replace(ia,""):""}function vt(e){return[e._R(1),e._R(1),e._R(1),e._R(1)]}function bt(e){e=vt(e);return e[3]=0,e}function St(e){return{r:e._R(2),c:e._R(2),ixfe:e._R(2)}}function yt(e,t,n,i){return(i=i||Q(6))._W(2,e),i._W(2,t),i._W(2,n||0),i}function xt(e){return[e._R(2),ke(e)]}function wt(e){var t=e._R(2),n=e._R(2);return{s:{c:e._R(2),r:t},e:{c:e._R(2),r:n}}}function _t(e,t){return(t=t||Q(8))._W(2,e.s.r),t._W(2,e.e.r),t._W(2,e.s.c),t._W(2,e.e.c),t}function Ct(e){var t=e._R(2),n=e._R(2);return{s:{c:e._R(1),r:t},e:{c:e._R(1),r:n}}}function Et(e){e.l+=4;var t=e._R(2),n=e._R(2),i=e._R(2);return e.l+=12,[n,t,i]}function kt(e){e.l+=2,e.l+=e._R(2)}function Pt(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e._R(2),2<=(t-=2)&&(n.dt=e._R(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(6<t)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e._R(t),n}function Rt(e,t,n){var i=1536,r=16;switch(n.bookType){case"biff8":break;case"biff5":i=1280,r=8;break;case"biff4":i=4,r=6;break;case"biff3":i=3,r=6;break;case"biff2":i=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}n=Q(r);return n._W(2,i),n._W(2,t),4<r&&n._W(2,29282),6<r&&n._W(2,1997),8<r&&(n._W(2,49161),n._W(2,1),n._W(2,1798),n._W(2,0)),n}function At(e,t,n){var i=0;n&&2==n.biff||(i=e._R(2));e=e._R(2);return n&&2==n.biff&&(i=1-(e>>15),e&=32767),[{Unsynced:1&i,DyZero:(2&i)>>1,ExAsc:(4&i)>>2,ExDsc:(8&i)>>3},e]}function Tt(e,t,n){var i=e.l+t,r=8!=n.biff&&n.biff?2:4,a=e._R(r),t=e._R(r),n=e._R(2),r=e._R(2);return e.l=i,{s:{r:a,c:n},e:{r:t,c:r}}}function Bt(e,t,n,i){n=n&&5==n.biff;return(i=i||Q(n?16:20))._W(2,0),e.style?(i._W(2,e.numFmtId||0),i._W(2,65524)):(i._W(2,e.numFmtId||0),i._W(2,t<<4)),i._W(4,0),i._W(4,0),n||i._W(4,0),i._W(2,0),i}function Mt(e,t,n){var i=St(e);2==n.biff&&++e.l;e=(n=e)._R(1),e=1===n._R(1)?e:1===e;return i.val=e,i.t=!0===e||!1===e?"b":"e",i}function Dt(e,t,n,i,r,a){var s=Q(8);return yt(e,t,i,s),i=n,n=a,(a=(a=s)||Q(2))._W(1,+i),a._W(1,"e"==n?1:0),s}function It(e,t,n){var i,r=e._R(2),r={fBuiltIn:1&r,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return 14849===n.sbcch&&(i=function(e,t,n){e.l+=4;var i=e.l+(t-=4),t=ut(e,0,n);if((n=e._R(2))!==(i-=e.l))throw new Error("Malformed AddinUdf: padding = "+i+" != "+n);return e.l+=n,t}(e,t-2,n)),r.body=i||e._R(t-2),"string"==typeof i&&(r.Name=i),r}function Lt(e,t,n){var i=e.l+t,r=e._R(2),a=e._R(1),s=e._R(1),o=e._R(n&&2==n.biff?1:2),t=0;(!n||5<=n.biff)&&(5!=n.biff&&(e.l+=2),t=e._R(2),5==n.biff&&(e.l+=2),e.l+=4);s=ht(e,s,n);32&r&&(s=bo[s.charCodeAt(0)]);var l,r=i-e.l;return n&&2==n.biff&&--r,{chKey:a,Name:s,itab:t,rgce:i==e.l||0===o?[]:(r=r,n=n,o=o,r=(e=e).l+r,o=Vn(e,o,n),r!==e.l&&(l=Wn(e,r-e.l,o,n)),[o,l])}}function Ft(e,t,n){if(n.biff<8)return function(e,t){3==e[e.l+1]&&e[e.l]++;t=ut(e,0,t);return 3==t.charCodeAt(0)?t.slice(1):t}(e,n);for(var i,r,a=[],t=e.l+t,s=e._R(8<n.biff?4:2);0!=s--;)a.push((i=e,n.biff,r=8<(r=n).biff?4:2,[i._R(r),i._R(r,"i"),i._R(r,"i")]));if(e.l!=t)throw new Error("Bad ExternSheet: "+e.l+" != "+t);return a}function Ot(e,t,n){var i=mo(e,6);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[i,function(e,t,n){var i,r=e.l+t,a=2==n.biff?1:2,s=e._R(a);if(65535==s)return[[],v(e,t-2)];var o=Vn(e,s,n);return t!==s+a&&(i=Wn(e,t-s-a,o,n)),e.l=r,[o,i]}(e,t,n)]}function Nt(e){var t=Q(24),n=j(e[0]);t._W(2,n.r),t._W(2,n.r),t._W(2,n.c),t._W(2,n.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)t._W(1,parseInt(i[r],16));return na([t,function(e){var t=Q(512),n=0,i=e.Target,r=-1<i.indexOf("#")?31:23;switch(i.charAt(0)){case"#":r=28;break;case".":r&=-3}t._W(4,2),t._W(4,r);for(var a=[8,6815827,6619237,4849780,83],n=0;n<a.length;++n)t._W(4,a[n]);if(28==r){for(i=i.slice(1),t._W(4,i.length+1),n=0;n<i.length;++n)t._W(2,i.charCodeAt(n));t._W(2,0)}else if(2&r){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<a.length;++n)t._W(1,parseInt(a[n],16));for(t._W(4,2*(i.length+1)),n=0;n<i.length;++n)t._W(2,i.charCodeAt(n));t._W(2,0)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<a.length;++n)t._W(1,parseInt(a[n],16));for(var s=0;"../"==i.slice(3*s,3*s+3)||"..\\"==i.slice(3*s,3*s+3);)++s;for(t._W(2,s),t._W(4,i.length+1),n=0;n<i.length;++n)t._W(1,255&i.charCodeAt(n));for(t._W(1,0),t._W(2,65535),t._W(2,57005),n=0;n<6;++n)t._W(4,0)}return t.slice(0,t.l)}(e[1])])}function zt(e,t,n){if(!n.cellStyles)return v(e,t);var i=n&&12<=n.biff?4:2,r=e._R(i),a=e._R(i),s=e._R(i),o=e._R(i),t=e._R(2);2==i&&(e.l+=2);o={s:r,e:a,w:s,ixfe:o,flags:t};return(5<=n.biff||!n.biff)&&(o.level=t>>8&7),o}function Wt(e,t){var n=!t||t.cellHTML,t={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(t.t=Aa(La(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),t.r=La(e),n&&(t.h=O(t.t))):e.match(Qo)&&(t.r=La(e),t.t=Aa(La((e.replace(Jo,"").match(qo)||[]).join("").replace(xa,""))),n&&(t.h=Zo(Ko(t.r)))),t):null}function Vt(e,t){if(!t.bookSST)return"";var n=[Sa];n[n.length]=I("sst",null,{xmlns:Ka.main[0],count:e.Count,uniqueCount:e.Unique});for(var i,r,a=0;a!=e.length;++a)null!=e[a]&&(r="<si>",(i=e[a]).r?r+=i.r:(r+="<t",i.t||(i.t=""),i.t.match(Dl)&&(r+=' xml:space="preserve"'),r+=">"+P(i.t)+"</t>"),r+="</si>",n[n.length]=r);return 2<n.length&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function $t(e){var t,n,i=y();b(i,"BrtBeginSst",(t=e,(n=n||Q(8))._W(4,t.Count),n._W(4,t.Unique),n));for(var r=0;r<e.length;++r)b(i,"BrtSSTItem",Il(e[r]));return b(i,"BrtEndSst"),i.end()}function Ut(e){if("undefined"!=typeof cptable)return cptable.utils.encode(Wr,e);for(var t=[],n=e.split(""),i=0;i<n.length;++i)t[i]=n[i].charCodeAt(0);return t}function Ht(e,t){var n={};return n.Major=e._R(2),n.Minor=e._R(2),4<=t&&(e.l+=t-4),n}function Xt(e){var t=[];e.l+=4;for(var n=e._R(4);0<n--;)t.push(function(e){for(var t=e._R(4),n=e.l+t-4,t={},i=e._R(4),r=[];0<i--;)r.push({t:e._R(4),v:e._R(0,"lpp4")});if(t.name=e._R(0,"lpp4"),t.comps=r,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return t}(e));return t}function Gt(e){var t,n,n=(n={},(t=e)._R(4),t.l+=4,n.id=t._R(0,"lpp4"),n.name=t._R(0,"lpp4"),n.R=Ht(t,4),n.U=Ht(t,4),n.W=Ht(t,4),n);if(n.ename=e._R(0,"8lpp4"),n.blksz=e._R(4),n.cmode=e._R(4),4!=e._R(4))throw new Error("Bad !Primary record");return n}function jt(e,t){var t=e.l+t,n={};n.Flags=63&e._R(4),e.l+=4,n.AlgID=e._R(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=36==n.Flags;break;case 26625:i=4==n.Flags;break;case 0:i=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e._R(4),n.KeySize=e._R(4),n.ProviderType=e._R(4),e.l+=8,n.CSPName=e._R(t-e.l>>1,"utf16le"),e.l=t,n}function Yt(e,t){var n={},t=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e._R(4),n.VerifierHash=e.slice(e.l,t),e.l=t,n}function Kt(e){var t=Ht(e);switch(t.Minor){case 2:return[t.Minor,function(e){if(36!=(63&e._R(4)))throw new Error("EncryptionInfo mismatch");return{t:"Std",h:jt(e,e._R(4)),v:Yt(e,e.length-e.l)}}(e)];case 3:return[t.Minor,function(){throw new Error("File is password-protected: ECMA-376 Extensible")}()];case 4:return[t.Minor,function(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var e=e._R(e.length-e.l,"utf8"),i={};return e.replace(xa,function(e){var t=ie(e);switch(p(t[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(e){i[e]=t[e]});break;case"<dataIntegrity":i.encryptedHmacKey=t.encryptedHmacKey,i.encryptedHmacValue=t.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=t.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(t);break;default:throw t[0]}}),i}(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Zt(e){var t,n=0,i=Ut(e),r=i.length+1,a=Y(r);for(a[0]=i.length,t=1;t!=r;++t)a[t]=i[t-1];for(t=r-1;0<=t;--t)n=((0==(16384&n)?0:1)|n<<1&32767)^a[t];return 52811^n}function qt(e,t,n){n=n||{};return n.Info=e._R(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},n=t.EncryptionVersionInfo=Ht(e,4);if(1!=n.Major||1!=n.Minor)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e._R(16),t.EncryptedVerifier=e._R(16),t.EncryptedVerifierHash=e._R(16),t}(e):n.Data=function(e,t){var n={},i=n.EncryptionVersionInfo=Ht(e,4);if(t-=4,2!=i.Minor)throw new Error("unrecognized minor version code: "+i.Minor);if(4<i.Major||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);return n.Flags=e._R(4),t-=4,i=e._R(4),t-=4,n.EncryptionHeader=jt(e,i),n.EncryptionVerifier=Yt(e,t-=i),n}(e,t),n}function Qt(e){for(var t=0,n=1;3!=t;++t)n=256*n+(255<e[t]?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function Jt(e,t){if(0===t)return e;e=function(e){var t=e[0]/255,n=e[1]/255,i=e[2]/255,r=Math.max(t,n,i),a=Math.min(t,n,i),s=r-a;if(0==s)return[0,0,t];var o=0,e=0,e=s/(1<(a=r+a)?2-a:a);switch(r){case t:o=((n-i)/s+6)%6;break;case n:o=(i-t)/s+2;break;case i:o=(t-n)/s+4}return[o/6,e,a/2]}((e=(e=e).slice("#"===e[0]?1:0).slice(0,6),[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]));return e[2]=t<0?e[2]*(1+t):1-(1-e[2])*(1-t),Qt(function(e){var t,n=e[0],i=e[1],e=e[2],r=2*i*(e<.5?e:1-e),a=[e=e-r/2,e,e],s=6*n;if(0!==i)switch(0|s){case 0:case 6:t=r*s,a[0]+=r,a[1]+=t;break;case 1:a[0]+=t=r*(2-s),a[1]+=r;break;case 2:t=r*(s-2),a[1]+=r,a[2]+=t;break;case 3:a[1]+=t=r*(4-s),a[2]+=r;break;case 4:t=r*(s-4),a[2]+=r,a[0]+=t;break;case 5:a[2]+=t=r*(6-s),a[0]+=r}for(var o=0;3!=o;++o)a[o]=Math.round(255*a[o]);return a}(e))}function en(e){return Math.floor((e+Math.round(128/Vl)/256)*Vl)}function tn(e){return Math.floor((e-5)/Vl*100+.5)/100}function nn(e){return Math.round((e*Vl+5)/Vl*256)/256}function rn(e){return nn(tn(en(e)))}function an(e){var t=Math.abs(e-rn(e)),n=Vl;if(.005<t)for(Vl=Wl;Vl<zl;++Vl)Math.abs(e-rn(e))<=t&&(t=Math.abs(e-rn(e)),n=Vl);Vl=n}function sn(e){e.width?(e.wpx=en(e.width),e.wch=tn(e.wpx),e.MDW=Vl):e.wpx?(e.wch=tn(e.wpx),e.width=nn(e.wch),e.MDW=Vl):"number"==typeof e.wch&&(e.width=nn(e.wch),e.wpx=en(e.width),e.MDW=Vl),e.customWidth&&delete e.customWidth}function on(e){return 96*e/$l}function ln(e){return e*$l/96}function cn(e,t){var n,i,r,a,s=[Sa,jl];return e.SSF&&null!=(r=e.SSF,a=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)null!=r[t]&&(a[a.length]=I("numFmt",null,{numFmtId:t,formatCode:P(r[t])}))}),n=1===a.length?"":(a[a.length]="</numFmts>",a[0]=I("numFmts",null,{count:a.length-2}).replace("/>",">"),a.join("")))&&(s[s.length]=n),s[s.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',s[s.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',s[s.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',s[s.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',t=t.cellXfs,(i=[])[i.length]="<cellXfs/>",t.forEach(function(e){i[i.length]=I("xf",null,e)}),i[i.length]="</cellXfs>",(n=2===i.length?"":(i[0]=I("cellXfs",null,{count:i.length-2}).replace("/>",">"),i.join("")))&&(s[s.length]=n),s[s.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',s[s.length]='<dxfs count="0"/>',s[s.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<s.length&&(s[s.length]="</styleSheet>",s[1]=s[1].replace("/>",">")),s.join("")}function un(e,t){var n;(t=t||Q(153))._W(2,20*e.sz),n=e,i=(i=t)||Q(2),n=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0),i._W(1,n),i._W(1,0),t._W(2,e.bold?700:400);var i=0;"superscript"==e.vertAlign?i=1:"subscript"==e.vertAlign&&(i=2),t._W(2,i),t._W(1,e.underline||0),t._W(1,e.family||0),t._W(1,e.charset||0),t._W(1,0),Te(e.color,t);i=0;return"major"==e.scheme&&(i=1),"minor"==e.scheme&&(i=2),t._W(1,i),Se(e.name,t),t.length>t.l?t.slice(0,t.l):t}function hn(e,t){t=t||Q(84);e=ql[e.patternType];t._W(4,e=null==e?40:e);var n=0;if(40!=e)for(Te({auto:1},t),Te({auto:1},t);n<12;++n)t._W(4,0);else{for(;n<4;++n)t._W(4,0);for(;n<12;++n)t._W(4,0)}return t.length>t.l?t.slice(0,t.l):t}function dn(e,t,n){return(n=n||Q(16))._W(2,t||0),n._W(2,e.numFmtId||0),n._W(2,0),n._W(2,0),n._W(2,0),n._W(1,0),n._W(1,0),n._W(1,0),n._W(1,0),n._W(1,0),n._W(1,0),n}function fn(e,t){return(t=t||Q(10))._W(1,0),t._W(1,0),t._W(4,0),t._W(4,0),t}function pn(a,s){var n;s&&(n=0,[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)null!=s[t]&&++n}),0!=n&&(b(a,"BrtBeginFmts",ve(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t,n,i,r=e[0];r<=e[1];++r)null!=s[r]&&b(a,"BrtFmt",(n=s[t=r],(i=(i=void 0)||Q(6+4*n.length))._W(2,t),Se(n,i),n=i.length>i.l?i.slice(0,i.l):i,null==i.l&&(i.l=i.length),n))}),b(a,"BrtEndFmts")))}function mn(e){var t;b(e,"BrtBeginBorders",ve(1)),b(e,"BrtBorder",((t=t||Q(51))._W(1,0),fn(0,t),fn(0,t),fn(0,t),fn(0,t),fn(0,t),t.length>t.l?t.slice(0,t.l):t)),b(e,"BrtEndBorders")}function gn(e){var t,n;b(e,"BrtBeginStyles",ve(1)),b(e,"BrtStyle",(t={xfId:0,builtinId:0,name:"Normal"},(n=n||Q(52))._W(4,t.xfId),n._W(2,1),n._W(1,+t.builtinId),n._W(1,0),Ee(t.name||"",n),n.length>n.l?n.slice(0,n.l):n)),b(e,"BrtEndStyles")}function vn(e){var t,n,i,r;b(e,"BrtBeginTableStyles",(t=0,n="TableStyleMedium9",i="PivotStyleMedium4",(r=Q(2052))._W(4,t),Ee(n,r),Ee(i,r),r.length>r.l?r.slice(0,r.l):r)),b(e,"BrtEndTableStyles")}function bn(e,t){var n,i=y();return b(i,"BrtBeginStyleSheet"),pn(i,e.SSF),b(e=i,"BrtBeginFonts",ve(1)),b(e,"BrtFont",un({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),b(e,"BrtEndFonts"),b(e=i,"BrtBeginFills",ve(2)),b(e,"BrtFill",hn({patternType:"none"})),b(e,"BrtFill",hn({patternType:"gray125"})),b(e,"BrtEndFills"),mn(i),b(e=i,"BrtBeginCellStyleXFs",ve(1)),b(e,"BrtXF",dn({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),b(e,"BrtEndCellStyleXFs"),n=i,t=t.cellXfs,b(n,"BrtBeginCellXFs",ve(t.length)),t.forEach(function(e){b(n,"BrtXF",dn(e,0))}),b(n,"BrtEndCellXFs"),gn(i),b(t=i,"BrtBeginDXFs",ve(0)),b(t,"BrtEndDXFs"),vn(i),b(i,"BrtEndStyleSheet"),i.end()}function Sn(e,n,i){n.themeElements.clrScheme=[];var r={};(e[0].match(xa)||[]).forEach(function(e){var t=ie(e);switch(t[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=t.val;break;case"<a:sysClr":r.rgb=t.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===t[0].charAt(1)?(n.themeElements.clrScheme.push(r),r={}):r.name=t[0].slice(3,t[0].length-1);break;default:if(i&&i.WTF)throw new Error("Unrecognized "+t[0]+" in clrScheme")}})}function yn(){}function xn(){}function wn(e,t){if(!e||0===e.length)return wn(_n());var n,i,r,a,s,o={};if(!(n=e.match(ic)))throw new Error("themeElements not found in theme");return i=n[0],a=t,(r=o).themeElements={},[["clrScheme",ec,Sn],["fontScheme",tc,yn],["fmtScheme",nc,xn]].forEach(function(e){if(!(s=i.match(e[1])))throw new Error(e[0]+" not found in themeElements");e[2](s,r,a)}),o.raw=e,o}function _n(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;e=[Sa];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function Cn(e){var t={};switch(t.xclrType=e._R(2),t.nTintShade=e._R(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=v(e,4);break;case 2:t.xclrValue=vt(e);break;case 3:t.xclrValue=e._R(4);break;case 4:e.l+=4}return e.l+=8,t}function En(e){var t=e._R(2),n=e._R(2)-4,i=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=Cn(e);break;case 6:i[1]=v(e,n);break;case 14:case 15:i[1]=e._R(1==n?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return i}function kn(e){var n=[Sa,ac],i=[];return n.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){e=P(e.a);-1<i.indexOf(e)||(i.push(e),n.push("<author>"+e+"</author>"))})}),n.push("</authors>"),n.push("<commentList>"),e.forEach(function(t){t[1].forEach(function(e){n.push('<comment ref="'+t[0]+'" authorId="'+i.indexOf(P(e.a))+'"><text>'),n.push(R("t",null==e.t?"":P(e.t))),n.push("</text></comment>")})}),n.push("</commentList>"),2<n.length&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function Pn(e){var r=y(),a=[];return b(r,"BrtBeginComments"),b(r,"BrtBeginCommentAuthors"),e.forEach(function(e){e[1].forEach(function(e){-1<a.indexOf(e.a)||(a.push(e.a.slice(0,54)),b(r,"BrtCommentAuthor",Se(e.a.slice(0,54))))})}),b(r,"BrtEndCommentAuthors"),b(r,"BrtBeginCommentList"),e.forEach(function(i){i[1].forEach(function(e){e.iauthor=a.indexOf(e.a);var t,n={s:j(i[0]),e:j(i[0])};b(r,"BrtBeginComment",(n=[n,e],(t=null==t?Q(36):t)._W(4,n[1].iauthor),Ms(n[0],t),t._W(4,0),t._W(4,0),t._W(4,0),t._W(4,0),t)),e.t&&0<e.t.length&&b(r,"BrtCommentText",xe(e)),b(r,"BrtEndComment"),delete e.iauthor})}),b(r,"BrtEndCommentList"),b(r,"BrtEndComments"),r.end()}function Rn(e,t,n){var s,t=J(t).s,n=j(n);return s={r:n.r-t.r,c:n.c-t.c},e.replace(dc,function(e,t,n,i,r,a){return t+("$"==n?n+i:se(H(i)+s.c))+("$"==r?r+a:ae(S(a)+s.r))})}function An(e){return e.replace(/_xlfn\./g,"")}function Tn(e){e.l+=1}function Bn(e,t){t=e._R(1==t?1:2);return[16383&t,t>>14&1,t>>15&1]}function Mn(e,t,n){var i=2;if(n){if(2<=n.biff&&n.biff<=5)return Dn(e);12==n.biff&&(i=4)}var r=e._R(i),n=e._R(i),i=Bn(e,2),e=Bn(e,2);return{s:{r:r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:e[0],cRel:e[1],rRel:e[2]}}}function Dn(e){var t=Bn(e,2),n=Bn(e,2),i=e._R(1),e=e._R(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:n[0],c:e,cRel:n[1],rRel:n[2]}}}function In(e,t,n){if(n&&2<=n.biff&&n.biff<=5)return r=Bn(i=e,2),i=i._R(1),{r:r[0],c:i,cRel:r[1],rRel:r[2]};var i,r,n=e._R(n&&12==n.biff?4:2),e=Bn(e,2);return{r:n,c:e[0],cRel:e[1],rRel:e[2]}}function Ln(e){return[e._R(1),e._R(1)]}function Fn(e,t,n){var i=0,r=0;12==n.biff?(i=e._R(4),r=e._R(4)):(r=1+e._R(1),i=1+e._R(2)),2<=n.biff&&n.biff<8&&(--i,0==--r&&(r=256));for(var a=0,s=[];a!=i&&(s[a]=[]);++a)for(var o=0;o!=r;++o)s[a][o]=function(e,t){var n=[e._R(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=at(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=Ds[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Re(e);break;case 2:n[1]=ft(e,0,{biff:0<t&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}(e,n.biff);return s}function On(e,t,n){return e.l+=2,[(e=(i=e)._R(2),i=i._R(2),{r:e,c:255&i,fQuoted:!!(16384&i),cRel:i>>15,rRel:i>>15})];var i}function Nn(e){return e.l+=6,[]}function zn(e){return e.l+=2,[ot(e),1&e._R(2)]}function Wn(e,t,n,i){if(i.biff<8)return v(e,t);for(var r=e.l+t,a=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=Fn(e,0,i),a.push(n[s][1]);break;case"PtgMemArea":n[s][2]=function(e,t){for(var n=e._R(12==t.biff?4:2),i=[],r=0;r!=n;++r)i.push((12==t.biff?Bs:wt)(e,8));return i}(e,(n[s][1],i)),a.push(n[s][2]);break;case"PtgExp":i&&12==i.biff&&(n[s][1][1]=e._R(4),a.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return 0!==(t=r-e.l)&&a.push(v(e,t)),a}function Vn(e,t,n){for(var i,r,a=e.l+t,s=[];a!=e.l;)t=a-e.l,r=e[e.l],i=wc[r],(i=24===r||25===r?(24===r?Ec:kc)[e[e.l+1]]:i)&&i.f?s.push([i.n,i.f(e,t,n)]):v(e,t);return s}function $n(e,t,n){if(!e)return"SH33TJSERR0";if(8<n.biff&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var i=e.XTI[t];if(n.biff<8)return 1e4<t&&(t-=65536),0==(t=t<0?-t:t)?"":e.XTI[t-1];if(!i)return"SH33TJSERR1";var r="";if(8<n.biff)switch(e[i[0]][0]){case 357:return r=-1==i[1]?"#REF":e.SheetNames[i[1]],i[1]==i[2]?r:r+":"+e.SheetNames[i[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[i[0]][0];default:return"SH33TJSSRC"+e[i[0]][0]}switch(e[i[0]][0][0]){case 1025:return r=-1==i[1]?"#REF":e.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?r:r+":"+e.SheetNames[i[2]];case 14849:return e[i[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[i[0]][0][3]?(r=-1==i[1]?"#REF":e[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?r:r+":"+e[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function Un(e,t,n){return function(e,t){if(!(e||t&&t.biff<=5&&2<=t.biff))throw new Error("empty sheet name");return-1<e.indexOf(" ")?"'"+e+"'":e}($n(e,t,n),n)}function Hn(e,t,n,i,r){var a,s,o=r&&r.biff||8,l={s:{c:0,r:0},e:{c:0,r:0}},c=[],u=0,h=0,d="";if(!e[0]||!e[0][0])return"";for(var f=-1,p="",m=0,g=e[0].length;m<g;++m){switch((T=e[0][m])[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(A=c.pop(),a=c.pop(),0<=f){switch(e[0][f][1][0]){case 0:p=M(" ",e[0][f][1][1]);break;case 1:p=M("\r",e[0][f][1][1]);break;default:if(p="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}a+=p,f=-1}c.push(a+Pc[T[0]]+A);break;case"PtgIsect":A=c.pop(),a=c.pop(),c.push(a+" "+A);break;case"PtgUnion":A=c.pop(),a=c.pop(),c.push(a+","+A);break;case"PtgRange":A=c.pop(),a=c.pop(),c.push(a+":"+A);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":k=z(T[1][1],l,r),c.push(V(k,o));break;case"PtgRefN":k=n?z(T[1][1],n,r):T[1][1],c.push(V(k,o));break;case"PtgRef3d":u=T[1][1],k=z(T[1][2],l,r),d=Un(i,u,r),c.push(d+"!"+V(k,o));break;case"PtgFunc":case"PtgFuncVar":var v=T[1][0],b=T[1][1],v=v||0,S=0==(v&=127)?[]:c.slice(-v);c.length-=v,"User"===b&&(b=S.shift()),c.push(b+"("+S.join(",")+")");break;case"PtgBool":c.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(T[1]);break;case"PtgNum":c.push(String(T[1]));break;case"PtgStr":c.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(T[1]);break;case"PtgAreaN":s=W(T[1][1],n?{s:n}:l,r),c.push(U(s,r));break;case"PtgArea":s=W(T[1][1],l,r),c.push(U(s,r));break;case"PtgArea3d":u=T[1][1],s=T[1][2],d=Un(i,u,r),c.push(d+"!"+U(s,r));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":var h=T[1][2],y=(i.names||[])[h-1]||(i[0]||[])[h],x=y?y.Name:"SH33TJSNAME"+String(h);x in Lc&&(x=Lc[x]),c.push(x);break;case"PtgNameX":var w,_=T[1][1];if(h=T[1][2],!(r.biff<=5)){y="";14849==((i[_]||[])[0]||[])[0]||(1025==((i[_]||[])[0]||[])[0]?i[_][h]&&0<i[_][h].itab&&(y=i.SheetNames[i[_][h].itab-1]+"!"):y=i.SheetNames[h-1]+"!"),i[_]&&i[_][h]?y+=i[_][h].Name:i[0]&&i[0][h]?y+=i[0][h].Name:(x=$n(i,_,r).split(";;"))[h-1]?y=x[h-1]:y+="SH33TJSERRX",c.push(y);break}i[_=_<0?-_:_]&&(w=i[_][h]),c.push((w=w||{Name:"SH33TJSERRY"}).Name);break;case"PtgParen":var C="(",E=")";if(0<=f){switch(p="",e[0][f][1][0]){case 2:C=M(" ",e[0][f][1][1])+C;break;case 3:C=M("\r",e[0][f][1][1])+C;break;case 4:E=M(" ",e[0][f][1][1])+E;break;case 5:E=M("\r",e[0][f][1][1])+E;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}f=-1}c.push(C+c.pop()+E);break;case"PtgRefErr":case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":var k={c:T[1][1],r:T[1][0]},P={c:n.c,r:n.r};if(i.sharedf[he(k)]){_=i.sharedf[he(k)];c.push(Hn(_,0,P,i,r))}else{for(var R=!1,A=0;A!=i.arrayf.length;++A)if(a=i.arrayf[A],!(k.c<a[0].s.c||k.c>a[0].e.c||k.r<a[0].s.r||k.r>a[0].e.r)){c.push(Hn(a[1],0,P,i,r)),R=!0;break}R||c.push(T[1])}break;case"PtgArray":c.push("{"+function(e){for(var t=[],n=0;n<e.length;++n){for(var i=e[n],r=[],a=0;a<i.length;++a){var s=i[a];s?2===s[0]?r.push('"'+s[1].replace(/"/g,'""')+'"'):r.push(s[1]):r.push("")}t.push(r.join(","))}return t.join(";")}(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=m;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(T))}if(3!=r.biff&&0<=f&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][m][0])){var T,B=!0;switch((T=e[0][f])[1][0]){case 4:B=!1;case 0:p=M(" ",T[1][1]);break;case 5:B=!1;case 1:p=M("\r",T[1][1]);break;default:if(p="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}c.push((B?p:"")+c.pop()+(B?"":p)),f=-1}}if(1<c.length&&r.WTF)throw new Error("bad formula stack");return c[0]}function Xn(e,t,n){var i=e.l+t,r=St(e);2==n.biff&&++e.l;var a=function(e){var t;if(65535!==ys(e,e.l+6))return[Re(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),t=e._R(1);2!=n.biff&&(e._R(1),5<=n.biff&&e._R(4));n=function(e,t,n){var i,r=e.l+t,a=2==n.biff?1:2,s=e._R(a);if(65535==s)return[[],v(e,t-2)];var o=Vn(e,s,n);return t!==s+a&&(i=Wn(e,t-s-a,o,n)),e.l=r,[o,i]}(e,i-e.l,n);return{cell:r,val:a[0],formula:n,shared:t>>3&1,tt:a[1]}}function Gn(e,t,n,i,r){t=yt(t,n,r),r=null!=(n=e.v)?Ae("number"==typeof n?n:0):((n=Q(8))._W(1,3),n._W(1,0),n._W(2,0),n._W(2,0),n._W(2,65535),n),n=Q(6);n._W(2,33),n._W(4,0);for(var a=Q(e.bf.length),s=0;s<e.bf.length;++s)a[s]=e.bf[s];return na([t,r,n,a])}function jn(e,t,n){var i=e._R(4),r=Vn(e,i,n),i=e._R(4);return[r,0<i?Wn(e,i,r,n):null]}function Yn(e){return 61==(e="of:"==e.slice(0,3)?e.slice(3):e).charCodeAt(0)&&(61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1))),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Kn(e){e=e.split(":");return[e[0].split(".")[0],e[0].split(".")[1]+(1<e.length?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function Zn(e,t,n){var i=0,r=e.length;if(n){if(Xc?n.has(t):n.hasOwnProperty(t))for(var a=Xc?n.get(t):n[t];i<a.length;++i)if(e[a[i]].t===t)return e.Count++,a[i]}else for(;i<r;++i)if(e[i].t===t)return e.Count++,i;return e[r]={t:t},e.Count++,e.Unique++,n&&(Xc?(n.has(t)||n.set(t,[]),n.get(t).push(r)):(n.hasOwnProperty(t)||(n[t]=[]),n[t].push(r))),r}function qn(e,t){var n={min:e+1,max:e+1},e=-1;return t.MDW&&(Vl=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?e=tn(t.wpx):null!=t.wch&&(e=t.wch),-1<e?(n.width=nn(e),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),n}function Qn(e,t){e&&(t="xlml"==t?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],null==e.left&&(e.left=t[0]),null==e.right&&(e.right=t[1]),null==e.top&&(e.top=t[2]),null==e.bottom&&(e.bottom=t[3]),null==e.header&&(e.header=t[4]),null==e.footer&&(e.footer=t[5]))}function Jn(e,t,n){var i=n.revssf[null!=t.z?t.z:"General"],r=60,a=e.length;if(null==i&&n.ssf)for(;r<392;++r)if(null==n.ssf[r]){aa.load(t.z,r),n.ssf[r]=t.z,n.revssf[t.z]=i=r;break}for(r=0;r!=a;++r)if(e[r].numFmtId===i)return r;return e[a]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function ei(e,t,n,i,r,a){try{i.cellNF&&(e.z=aa._table[t])}catch(e){if(i.WTF)throw e}if("z"!==e.t){if("d"===e.t&&"string"==typeof e.v&&(e.v=te(e.v)),!i||!1!==i.cellText)try{if(null==aa._table[t]&&aa.load(ca[t]||"General",t),"e"===e.t)e.w=e.w||Ds[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=aa._general_int(e.v):e.w=aa._general_num(e.v);else if("d"===e.t){var s=G(e.v);e.w=(0|s)===s?aa._general_int(s):aa._general_num(s)}else{if(void 0===e.v)return;e.w=aa._general(e.v,Oc)}else"d"===e.t?e.w=aa.format(t,G(e.v),Oc):e.w=aa.format(t,e.v,Oc)}catch(e){if(i.WTF)throw e}if(i.cellStyles&&null!=n)try{e.s=a.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Jt(r.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),i.WTF&&(e.s.fgColor.raw_rgb=r.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Jt(r.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),i.WTF&&(e.s.bgColor.raw_rgb=r.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(e){if(i.WTF&&a.Fills)throw e}}}function ti(e,t,n,i,r,a,s){if(!e)return e;i=i||{"!id":{}},null!=Zr&&null==t.dense&&(t.dense=Zr);var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(jc);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;e=c.match(Jc);e&&ni(e[0],0,r,n);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;0<d&&((e=c.slice(d,d+50).match(Kc))&&(n=o,(p=oe(p=e[1])).s.r<=p.e.r&&p.s.c<=p.e.c&&0<=p.s.r&&0<=p.s.c&&(n["!ref"]=de(p))));var f,p=c.match(eu);p&&p[1]&&(g=p[1],(f=r).Views||(f.Views=[{}]),(g.match(iu)||[]).forEach(function(e,t){e=ie(e);f.Views[t]||(f.Views[t]={}),re(e.rightToLeft)&&(f.Views[t].RTL=!0)}));var m,g=[];t.cellStyles&&(m=c.match(Zc))&&function(e,t){for(var n=!1,i=0;i!=t.length;++i){var r=ie(t[i],!0);r.hidden&&(r.hidden=re(r.hidden));var a=parseInt(r.min,10)-1,s=parseInt(r.max,10)-1;for(delete r.min,delete r.max,r.width=+r.width,!n&&r.width&&(n=!0,an(r.width)),sn(r);a<=s;)e[a++]=ne(r)}}(g,m),h&&ru(h[1],o,t,l,a,s);s=u.match(qc);s&&(o["!autofilter"]={ref:(s[0].match(/ref="([^"]*)"/)||[])[1]});var v=[],b=u.match(Gc);if(b)for(d=0;d!=b.length;++d)v[d]=oe(b[d].slice(b[d].indexOf('"')+1));s=u.match(Yc);s&&function(e,t,n){for(var i=Array.isArray(e),r=0;r!=t.length;++r){var a=ie(La(t[r]),!0);if(!a.ref)return;var s=((n||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+a.location)):(a.Target="#"+a.location,s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=oe(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=he({c:c,r:l});i?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=a):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=a)}}}(o,s,i);var S,y,u=u.match(Qc);return u&&(o["!margins"]=(S=ie(u[0]),y={},["left","right","top","bottom","header","footer"].forEach(function(e){S[e]&&(y[e]=parseFloat(S[e]))}),y)),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=de(l)),0<t.sheetRows&&o["!ref"]&&(u=oe(o["!ref"]),t.sheetRows<=+u.e.r&&(u.e.r=t.sheetRows-1,u.e.r>l.e.r&&(u.e.r=l.e.r),u.e.r<u.s.r&&(u.s.r=u.e.r),u.e.c>l.e.c&&(u.e.c=l.e.c),u.e.c<u.s.c&&(u.s.c=u.e.c),o["!fullref"]=o["!ref"],o["!ref"]=de(u))),0<g.length&&(o["!cols"]=g),0<v.length&&(o["!merges"]=v),o}function ni(e,t,n,i){e=ie(e);n.Sheets[i]||(n.Sheets[i]={}),e.codeName&&(n.Sheets[i].CodeName=e.codeName)}function ii(e,t){for(var n,i,r,a=[],s=[],o=oe(e["!ref"]),l=[],c=0,u=0,h=e["!rows"],d=Array.isArray(e),f={r:""},p=-1,u=o.s.c;u<=o.e.c;++u)l[u]=se(u);for(c=o.s.r;c<=o.e.r;++c){for(s=[],r=ae(c),u=o.s.c;u<=o.e.c;++u){var m=l[u]+r,g=d?(e[c]||[])[u]:e[m];void 0!==g&&null!=(i=function(e,t,n,i){if(void 0===e.v&&void 0===e.f||"z"===e.t)return"";var r="",a=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":r=e.v?"1":"0";break;case"n":r=""+e.v;break;case"e":r=Ds[e.v];break;case"d":r=i&&i.cellDates?te(e.v,-1).toISOString():((e=ne(e)).t="n",""+(e.v=G(te(e.v)))),void 0===e.z&&(e.z=aa._table[14]);break;default:r=e.v}var o=R("v",P(r)),l={r:t},c=Jn(i.cellXfs,e,i);switch(0!==c&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(null==e.v){delete e.t;break}if(i&&i.bookSST){o=R("v",""+Zn(i.Strings,e.v,i.revStrings)),l.t="s";break}l.t="str"}return e.t!=a&&(e.t=a,e.v=s),e.f&&(s=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null,o=I("f",P(e.f),s)+(null!=e.v?o:"")),e.l&&n["!links"].push([t,e.l]),e.c&&n["!comments"].push([t,e.c]),I("c",o,l)}(g,m,e,t))&&s.push(i)}(0<s.length||h&&h[c])&&(f={r:r},h&&h[c]&&((n=h[c]).hidden&&(f.hidden=1),p=-1,n.hpx?p=on(n.hpx):n.hpt&&(p=n.hpt),-1<p&&(f.ht=p,f.customHeight=1),n.level&&(f.outlineLevel=n.level)),a[a.length]=I("row",s.join(""),f))}if(h)for(;c<h.length;++c)h&&h[c]&&(f={r:c+1},(n=h[c]).hidden&&(f.hidden=1),p=-1,n.hpx?p=on(n.hpx):n.hpt&&(p=n.hpt),-1<p&&(f.ht=p,f.customHeight=1),n.level&&(f.outlineLevel=n.level),a[a.length]=I("row","",f));return a.join("")}function ri(e,t,n,i){var r,a,s=[Sa,au],o=n.SheetNames[e],l=n.Sheets[o],c=(l=null==l?{}:l)["!ref"]||"A1",u=oe(c);if(16383<u.e.c||1048575<u.e.r){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=de(u)}i=i||{},l["!comments"]=[];var h,d,f=[];(function(e,t,n,i){var r=!1,a={};if("xlsx"!==n.bookType&&e.vbaraw){n=e.SheetNames[t];try{e.Workbook&&(n=e.Workbook.Sheets[t].CodeName||n)}catch(e){}r=!0,a.codeName=P(n)}r&&(i[i.length]=I("sheetPr",null,a))})(n,e,t,s),s[s.length]=I("dimension",null,{ref:c}),s[s.length]=(o={workbookViewId:"0"},((((u=n)||{}).Workbook||{}).Views||[])[0]&&(o.rightToLeft=u.Workbook.Views[0].RTL?"1":"0"),I("sheetViews",I("sheetView",null,o),{})),t.sheetFormat&&(s[s.length]=I("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&0<l["!cols"].length&&(s[s.length]=function(e){for(var t,n=["<cols>"],i=0;i!=e.length;++i)(t=e[i])&&(n[n.length]=I("col",null,qn(i,t)));return n[n.length]="</cols>",n.join("")}(l["!cols"])),s[r=s.length]="<sheetData/>",l["!links"]=[],null==l["!ref"]||0<(a=ii(l,t)).length&&(s[s.length]=a),s.length>r+1&&(s[s.length]="</sheetData>",s[r]=s[r].replace("/>",">")),null!=l["!protect"]&&(s[s.length]=(h=l["!protect"],d={sheet:1},tu.forEach(function(e){null!=h[e]&&h[e]&&(d[e]="1")}),nu.forEach(function(e){null==h[e]||h[e]||(d[e]="0")}),h.password&&(d.password=Zt(h.password).toString(16).toUpperCase()),I("sheetProtection",null,d))),null!=l["!autofilter"]&&(s[s.length]=function(e,t,n,i){var r="string"==typeof e.ref?e.ref:de(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var a=n.Workbook.Names;(e=J(r)).s.r==e.e.r&&(e.e.r=J(t["!ref"]).e.r,r=de(e));for(var s=0;s<a.length;++s){var o=a[s];if("_xlnm._FilterDatabase"==o.Name&&o.Sheet==i){o.Ref="'"+n.SheetNames[i]+"'!"+r;break}}return s==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+n.SheetNames[i]+"'!"+r}),I("autoFilter",null,{ref:r})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&0<l["!merges"].length&&(s[s.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+de(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var p,m,g=-1;return 0<l["!links"].length&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(p={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(g=Oe(i,-1,P(e[1].Target).replace(/#.*$/,""),qs.HLINK),p["r:id"]="rId"+g),-1<(m=e[1].Target.indexOf("#"))&&(p.location=P(e[1].Target.slice(m+1))),e[1].Tooltip&&(p.tooltip=P(e[1].Tooltip)),s[s.length]=I("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(s[s.length]=(Qn(n=l["!margins"]),I("pageMargins",null,n))),t&&!t.ignoreEC&&null!=t.ignoreEC||(s[s.length]=R("ignoredErrors",I("ignoredError",null,{numberStoredAsText:1,sqref:c}))),0<f.length&&(g=Oe(i,-1,"../drawings/drawing"+(e+1)+".xml",qs.DRAW),s[s.length]=I("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=f),0<l["!comments"].length&&(g=Oe(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",qs.VML),s[s.length]=I("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),1<s.length&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function ai(e,t,n,i){n=function(e,t,n){var i=Q(145),r=(n["!rows"]||[])[e]||{};i._W(4,e),i._W(4,0);var a=320;r.hpx?a=20*on(r.hpx):r.hpt&&(a=20*r.hpt),i._W(2,a),i._W(1,0),a=0,r.level&&(a|=r.level),r.hidden&&(a|=16),(r.hpx||r.hpt)&&(a|=32),i._W(1,a),i._W(1,0);var s=0,a=i.l;i.l+=4;for(var o={r:e,c:0},l=0;l<16;++l)if(!(t.s.c>l+1<<10||t.e.c<l<<10)){for(var c=-1,u=-1,h=l<<10;h<l+1<<10;++h)o.c=h,(Array.isArray(n)?(n[o.r]||[])[o.c]:n[he(o)])&&(c<0&&(c=h),u=h);c<0||(++s,i._W(4,c),i._W(4,u))}return e=i.l,i.l=a,i._W(4,s),i.l=e,i.length>i.l?i.slice(0,i.l):i}(i,n,t);(17<n.length||(t["!rows"]||[])[i])&&b(e,"BrtRowHdr",n)}function si(e,t,n){return _e(t,n=null==n?Q(12):n),function(e,t){null==t&&(t=Q(4));var n=0,i=0,r=100*e;if(e==(0|e)&&-(1<<29)<=e&&e<1<<29?i=1:r==(0|r)&&-(1<<29)<=r&&r<1<<29&&(n=i=1),!i)throw new Error("unsupported RkNumber "+e);t._W(-4,((n?r:e)<<2)+(n+2))}(e.v,n),n}function oi(e,t,n,i,r,a){if(void 0!==t.v){var s="";switch(t.t){case"b":s=t.v?"1":"0";break;case"d":(t=ne(t)).z=t.z||aa._table[14],t.v=G(te(t.v)),t.t="n";break;case"n":case"e":s=""+t.v;break;default:s=t.v}var o={r:n,c:i};switch(o.s=Jn(r.cellXfs,t,r),t.l&&a["!links"].push([he(o),t.l]),t.c&&a["!comments"].push([he(o),t.c]),t.t){case"s":case"str":return r.bookSST?(s=Zn(r.Strings,t.v,r.revStrings),o.t="s",o.v=s,b(e,"BrtCellIsst",(_e(f=o,p=null==p?Q(12):p),p._W(4,f.v),p))):(o.t="str",b(e,"BrtCellSt",(f=t,_e(o,d=null==d?Q(12+4*f.v.length):d),Se(f.v,d),d.length>d.l?d.slice(0,d.l):d))),0;case"n":return t.v==(0|t.v)&&-1e3<t.v&&t.v<1e3?b(e,"BrtCellRk",si(t,o)):b(e,"BrtCellReal",(u=t,_e(o,h=null==h?Q(16):h),Ae(u.v,h),h)),0;case"b":return o.t="b",b(e,"BrtCellBool",(u=t,_e(o,c=null==c?Q(9):c),c._W(1,u.v?1:0),c)),0;case"e":o.t="e"}b(e,"BrtCellBlank",_e(o,l=null==l?Q(8):l))}var l,c,u,h,d,f,p}function li(t,e){var n,i;e&&e["!merges"]&&(b(t,"BrtBeginMergeCells",(n=e["!merges"].length,(i=null==i?Q(4):i)._W(4,n),i)),e["!merges"].forEach(function(e){b(t,"BrtMergeCell",ou(e))}),b(t,"BrtEndMergeCells"))}function ci(n,e){e&&e["!cols"]&&(b(n,"BrtBeginColInfos"),e["!cols"].forEach(function(e,t){e&&b(n,"BrtColInfo",function(e,t,n){null==n&&(n=Q(18));var i=qn(e,t);return n._W(-4,e),n._W(-4,e),n._W(4,256*(i.width||10)),n._W(4,0),e=0,t.hidden&&(e|=1),"number"==typeof i.width&&(e|=2),t.level&&(e|=t.level<<8),n._W(2,e),n}(t,e))}),b(n,"BrtEndColInfos"))}function ui(e,t){var n;t&&t["!ref"]&&(b(e,"BrtBeginCellIgnoreECs"),b(e,"BrtCellIgnoreEC",(n=oe(t["!ref"]),(t=Q(24))._W(4,4),t._W(4,1),Ms(n,t),t)),b(e,"BrtEndCellIgnoreECs"))}function hi(i,e,r){e["!links"].forEach(function(e){var t,n;e[1].Target&&(t=Oe(r,-1,e[1].Target.replace(/#.*$/,""),qs.HLINK),b(i,"BrtHLink",(n=t,e=Q(50+4*((t=e)[1].Target.length+(t[1].Tooltip||"").length)),Ms({s:j(t[0]),e:j(t[0])},e),Ts("rId"+n,e),Se((-1==(n=t[1].Target.indexOf("#"))?"":t[1].Target.slice(n+1))||"",e),Se(t[1].Tooltip||"",e),Se("",e),e.slice(0,e.l))))}),delete e["!links"]}function di(e,t,n){b(e,"BrtBeginWsViews"),b(e,"BrtBeginWsView",function(e,t){null==t&&(t=Q(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t._W(2,n),t._W(4,0),t._W(4,0),t._W(4,0),t._W(1,0),t._W(1,0),t._W(2,0),t._W(2,100),t._W(2,0),t._W(2,0),t._W(2,0),t._W(4,0),t}(n)),b(e,"BrtEndWsView"),b(e,"BrtEndWsViews")}function fi(e,t){var n,i;t["!protect"]&&b(e,"BrtSheetProtection",(n=t["!protect"],(i=null==i?Q(66):i)._W(2,n.password?Zt(n.password):0),i._W(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?i._W(4,null==n[e[0]]||n[e[0]]?0:1):i._W(4,null!=n[e[0]]&&n[e[0]]?0:1)}),i))}function pi(e,t,n,i){var r=y(),a=n.SheetNames[e],s=n.Sheets[a]||{},o=a;try{n&&n.Workbook&&(o=n.Workbook.Sheets[e].CodeName||o)}catch(e){}var l,c,a=oe(s["!ref"]||"A1");if(16383<a.e.c||1048575<a.e.r){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");a.e.c=Math.min(a.e.c,16383),a.e.r=Math.min(a.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],b(r,"BrtBeginSheet"),n.vbaraw&&b(r,"BrtWsProp",function(e,t){null==t&&(t=Q(84+4*e.length));for(var n=0;n<3;++n)t._W(1,0);return Te({auto:1},t),t._W(-4,-1),t._W(-4,-1),Ps(e,t),t.slice(0,t.l)}(o)),b(r,"BrtWsDim",su(a)),di(r,0,n.Workbook),ci(r,s),function(e,t,n){var i,r=oe(t["!ref"]||"A1"),a=[];b(e,"BrtBeginSheetData");var s=Array.isArray(t),o=r.e.r;t["!rows"]&&(o=Math.max(r.e.r,t["!rows"].length-1));for(var l=r.s.r;l<=o;++l)if(i=ae(l),ai(e,t,r,l),l<=r.e.r)for(var c=r.s.c;c<=r.e.c;++c){l===r.s.r&&(a[c]=se(c));var u=a[c]+i,u=s?(t[l]||[])[c]:t[u];u&&oi(e,u,l,c,n,t)}b(e,"BrtEndSheetData")}(r,s,t),fi(r,s),function(e,t,n,i){if(t["!autofilter"]){var r=t["!autofilter"],a="string"==typeof r.ref?r.ref:de(r.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,r=J(a);r.s.r==r.e.r&&(r.e.r=J(t["!ref"]).e.r,a=de(r));for(var o=0;o<s.length;++o){var l=s[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==i){l.Ref="'"+n.SheetNames[i]+"'!"+a;break}}o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+n.SheetNames[i]+"'!"+a}),b(e,"BrtBeginAFilter",Ms(oe(a))),b(e,"BrtEndAFilter")}}(r,s,n,e),li(r,s),hi(r,s,i),s["!margins"]&&b(r,"BrtMargins",(l=s["!margins"],null==c&&(c=Q(48)),Qn(l),lu.forEach(function(e){Ae(l[e],c)}),c)),t&&!t.ignoreEC&&null!=t.ignoreEC||ui(r,s),n=r,t=e,i=i,0<(s=s)["!comments"].length&&(t=Oe(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",qs.VML),b(n,"BrtLegacyDrawing",Ts("rId"+t)),s["!legacy"]=t),b(r,"BrtEndSheet"),r.end()}function mi(e,t,n,i,r,a){var s=a||{"!type":"chart"};if(!e)return a;var o,l=0,c=0,u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var n=function(e){var t,n=[],i=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){e=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);e&&(n[+e[1]]=i?+e[2]:e[2])});var r=Aa((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[n,r,t]}(e);u.s.r=u.s.c=0,u.e.c=l,o=se(l),n[0].forEach(function(e,t){s[o+ae(t)]={t:"n",v:e,z:n[1]},c=t}),u.e.r<c&&(u.e.r=c),++l}),0<l&&(s["!ref"]=de(u)),s}function gi(e,t){for(var n=0;n!=e.length;++n)for(var i=e[n],r=0;r!=t.length;++r){var a=t[r];if(null==i[a[0]])i[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof i[a[0]]&&(i[a[0]]=re(i[a[0]]));break;case"int":"string"==typeof i[a[0]]&&(i[a[0]]=parseInt(i[a[0]],10))}}}function vi(e,t){for(var n=0;n!=t.length;++n){var i=t[n];if(null==e[i[0]])e[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof e[i[0]]&&(e[i[0]]=re(e[i[0]]));break;case"int":"string"==typeof e[i[0]]&&(e[i[0]]=parseInt(e[i[0]],10))}}}function bi(e){vi(e.WBProps,vu),vi(e.CalcPr,yu),gi(e.WBView,bu),gi(e.Sheets,Su),Oc.date1904=re(e.WBProps.date1904)}function Si(t,n){if(31<t.length){if(n)return;throw new Error("Sheet names cannot exceed 31 chars")}var i=!0;return xu.forEach(function(e){if(-1!=t.indexOf(e)){if(!n)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");i=!1}}),i}function yi(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r,a,s,t=e.Workbook&&e.Workbook.Sheets||[];r=e.SheetNames,a=t,s=!!e.vbaraw,r.forEach(function(e,t){Si(e);for(var n=0;n<t;++n)if(e==r[n])throw new Error("Duplicate Sheet Name: "+e);if(s){var i=a&&a[t]&&a[t].CodeName||e;if(95==i.charCodeAt(0)&&22<i.length)throw new Error("Bad Code Name: Worksheet"+i)}});for(var n=0;n<e.SheetNames.length;++n)!function(e,t){if(e&&e["!ref"]){var n=oe(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}(e.Sheets[e.SheetNames[n]],(e.SheetNames[n],n))}function xi(t){var n=[Sa];n[n.length]=_u;var e=t.Workbook&&0<(t.Workbook.Names||[]).length,i={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(vu.forEach(function(e){null!=t.Workbook.WBProps[e[0]]&&t.Workbook.WBProps[e[0]]!=e[1]&&(i[e[0]]=t.Workbook.WBProps[e[0]])}),t.Workbook.WBProps.CodeName&&(i.codeName=t.Workbook.WBProps.CodeName,delete i.CodeName)),n[n.length]=I("workbookPr",null,i);var r=t.Workbook&&t.Workbook.Sheets||[],a=0;for(n[n.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var s={name:P(t.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),r[a])switch(r[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}n[n.length]=I("sheet",null,s)}return n[n.length]="</sheets>",e&&(n[n.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(e){var t={name:e.Name};e.Comment&&(t.comment=e.Comment),null!=e.Sheet&&(t.localSheetId=""+e.Sheet),e.Hidden&&(t.hidden="1"),e.Ref&&(n[n.length]=I("definedName",String(e.Ref).replace(/</g,"&lt;").replace(/>/g,"&gt;"),t))}),n[n.length]="</definedNames>"),2<n.length&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function wi(e,t){b(e,"BrtBeginBundleShs");for(var n,i,r=0;r!=t.SheetNames.length;++r)b(e,"BrtBundleSh",(n={Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]},(i=(i=void 0)||Q(127))._W(4,n.Hidden),i._W(4,n.iTabID),Ts(n.strRelID,i),Se(n.name.slice(0,31),i),i.length>i.l?i.slice(0,i.l):i));b(e,"BrtEndBundleShs")}function _i(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n=t.Workbook.Sheets,i=0,r=-1,a=-1;i<n.length;++i)!n[i]||!n[i].Hidden&&-1==r?r=i:1==n[i].Hidden&&-1==a&&(a=i);r<a||(b(e,"BrtBeginBookViews"),b(e,"BrtBookView",(t=r,(s=s||Q(29))._W(-4,0),s._W(-4,460),s._W(4,28800),s._W(4,17600),s._W(4,500),s._W(4,t),s._W(4,t),s._W(1,120),s.length>s.l?s.slice(0,s.l):s)),b(e,"BrtEndBookViews"))}var s}function Ci(e,t){var n=y();return b(n,"BrtBeginBook"),b(n,"BrtFileVersion",function(e){e=e||Q(127);for(var t=0;4!=t;++t)e._W(4,0);return Se("SheetJS",e),Se(i.version,e),Se(i.version,e),Se("7262",e),e.length=e.l,e.length>e.l?e.slice(0,e.l):e}()),b(n,"BrtWbProp",function(e,t){t=t||Q(72);var n=0;return e&&e.filterPrivacy&&(n|=8),t._W(4,n),t._W(4,0),Ps(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),_i(n,e),wi(n,e),b(n,"BrtEndBook"),n.end()}function Ei(e,t,n){return(".bin"===t.slice(-4)?function(e,i){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;(i=i||{}).biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],N(e,function(e,t,n){switch(n){case 156:l.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(i.SID=e.Sheet),e.Ref=Hn(e.Ptg,0,null,l,i),delete i.SID,delete e.Ptg,o.push(e);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([n,e]):l[0]=[n,e],l[l.length-1].XTI=[];break;case 362:0===l.length&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(e),l.XTI=l.XTI.concat(e);break;case 361:break;case 3072:case 3073:case 2071:case 534:case 677:case 158:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(t),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(t),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!(0<(t||"").indexOf("Begin"))&&!(0<(t||"").indexOf("End"))&&(!s||i.WTF&&"BrtACBegin"!=a[a.length-1]&&"BrtFRTBegin"!=a[a.length-1]))throw new Error("Unexpected record "+n+" "+t)}},i),bi(r),r.Names=o,r.supbooks=l,r}:function(i,r){if(!i)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,o="xmlns",l={},c=0;if(i.replace(xa,function(e,t){var n=ie(e);switch(p(n[0])){case"<?xml":break;case"<workbook":e.match(wu)&&(o="xmlns"+e.match(/<(\w+):/)[1]),a.xmlns=n[o];break;case"</workbook>":break;case"<fileVersion":delete n[0],a.AppVersion=n;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":vu.forEach(function(e){if(null!=n[e[0]])switch(e[2]){case"bool":a.WBProps[e[0]]=re(n[e[0]]);break;case"int":a.WBProps[e[0]]=parseInt(n[e[0]],10);break;default:a.WBProps[e[0]]=n[e[0]]}}),n.codeName&&(a.WBProps.CodeName=n.codeName);break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete n[0],a.WBView.push(n);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(n.state){case"hidden":n.Hidden=1;break;case"veryHidden":n.Hidden=2;break;default:n.Hidden=0}delete n.state,n.name=Aa(La(n.name)),delete n[0],a.Sheets.push(n);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":(l={}).Name=La(n.name),n.comment&&(l.Comment=n.comment),n.localSheetId&&(l.Sheet=+n.localSheetId),re(n.hidden||"0")&&(l.Hidden=!0),c=t+e.length;break;case"</definedName>":l.Ref=Aa(La(i.slice(c,t))),a.Names.push(l);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete n[0],a.CalcPr=n;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&r.WTF)throw new Error("unrecognized "+n[0]+" in workbook")}return e}),-1===Ka.main.indexOf(a.xmlns))throw new Error("Unknown Namespace: "+a.xmlns);return bi(a),a})(e,n)}function ki(e,t,n,i,r,a,s,o){return(".bin"===t.slice(-4)?function(e,t,a,s,o,l,c){if(!e)return e;var u=t||{};s=s||{"!id":{}},null!=Zr&&null==u.dense&&(u.dense=Zr);var h,d,f,p,m,g,v,b,S,y,x=u.dense?[]:{},w={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=[],C=!1,E=!1,k=[];u.biff=12;var P=u["!row"]=0,R=!1,A=[],T={},B=u.supbooks||o.supbooks||[[]];if(B.sharedf=T,B.arrayf=A,B.SheetNames=o.SheetNames||o.Sheets.map(function(e){return e.name}),!u.supbooks&&(u.supbooks=B,o.Names))for(var n=0;n<o.Names.length;++n)B[0][n+1]=o.Names[n];var M=[],D=[],I=!1;return N(e,function(e,t,n){if(!E)switch(n){case 148:h=e;break;case 0:d=e,u.sheetRows&&u.sheetRows<=d.r&&(E=!0),S=ae(m=d.r),u["!row"]=d.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=ln(e.hpt)),D[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:switch(f={t:e[2]},e[2]){case"n":f.v=e[1];break;case"s":b=Fc[e[1]],f.v=b.t,f.r=b.r;break;case"b":f.v=!!e[1];break;case"e":f.v=e[1],!1!==u.cellText&&(f.w=Ds[f.v]);break;case"str":f.t="s",f.v=e[1]}if((p=c.CellXf[e[0].iStyleRef])&&ei(f,p.numFmtId,null,u,l,c),g=e[0].c,u.dense?(x[m]||(x[m]=[]),x[m][g]=f):x[se(g)+S]=f,u.cellFormula){for(R=!1,P=0;P<A.length;++P){var i=A[P];d.r>=i[0].s.r&&d.r<=i[0].e.r&&g>=i[0].s.c&&g<=i[0].e.c&&(f.F=de(i[0]),R=!0)}!R&&3<e.length&&(f.f=e[3])}w.s.r>d.r&&(w.s.r=d.r),w.s.c>g&&(w.s.c=g),w.e.r<d.r&&(w.e.r=d.r),w.e.c<g&&(w.e.c=g),u.cellDates&&p&&"n"==f.t&&aa.is_date(aa._table[p.numFmtId])&&(r=aa.parse_date_code(f.v))&&(f.t="d",f.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u));break;case 1:if(!u.sheetStubs||C)break;f={t:"z",v:void 0},g=e[0].c,u.dense?(x[m]||(x[m]=[]),x[m][g]=f):x[se(g)+S]=f,w.s.r>d.r&&(w.s.r=d.r),w.s.c>g&&(w.s.c=g),w.e.r<d.r&&(w.e.r=d.r),w.e.c<g&&(w.e.c=g);break;case 176:k.push(e);break;case 494:var r=s["!id"][e.relId];for(r?(e.Target=r.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=r):""==e.relId&&(e.Target="#"+e.loc),m=e.rfx.s.r;m<=e.rfx.e.r;++m)for(g=e.rfx.s.c;g<=e.rfx.e.c;++g)u.dense?(x[m]||(x[m]=[]),x[m][g]||(x[m][g]={t:"z",v:void 0}),x[m][g].l=e):(v=he({c:g,r:m}),x[v]||(x[v]={t:"z",v:void 0}),x[v].l=e);break;case 426:if(!u.cellFormula)break;A.push(e),(y=u.dense?x[m][g]:x[se(g)+S]).f=Hn(e[1],0,{r:d.r,c:g},B,u),y.F=de(e[0]);break;case 427:if(!u.cellFormula)break;T[he(e[0].s)]=e[1],(y=u.dense?x[m][g]:x[se(g)+S]).f=Hn(e[1],0,{r:d.r,c:g},B,u);break;case 60:if(!u.cellStyles)break;for(;e.e>=e.s;)M[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},I||(I=!0,an(e.w/256)),sn(M[e.e+1]);break;case 161:x["!autofilter"]={ref:de(e)};break;case 476:x["!margins"]=e;break;case 147:o.Sheets[a]||(o.Sheets[a]={}),e.name&&(o.Sheets[a].CodeName=e.name);break;case 137:o.Views||(o.Views=[{}]),o.Views[0]||(o.Views[0]={}),e.RTL&&(o.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 49:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 152:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:C=!0;break;case 36:C=!1;break;case 37:_.push(t),C=!0;break;case 38:_.pop(),C=!1;break;default:if(!(0<(t||"").indexOf("Begin"))&&!(0<(t||"").indexOf("End"))&&(!C||u.WTF))throw new Error("Unexpected record "+n+" "+t)}},u),delete u.supbooks,delete u["!row"],!x["!ref"]&&(w.s.r<2e6||h&&(0<h.e.r||0<h.e.c||0<h.s.r||0<h.s.c))&&(x["!ref"]=de(h||w)),u.sheetRows&&x["!ref"]&&(e=oe(x["!ref"]),u.sheetRows<=+e.e.r&&(e.e.r=u.sheetRows-1,e.e.r>w.e.r&&(e.e.r=w.e.r),e.e.r<e.s.r&&(e.s.r=e.e.r),e.e.c>w.e.c&&(e.e.c=w.e.c),e.e.c<e.s.c&&(e.s.c=e.e.c),x["!fullref"]=x["!ref"],x["!ref"]=de(e))),0<k.length&&(x["!merges"]=k),0<M.length&&(x["!cols"]=M),0<D.length&&(x["!rows"]=D),x}:ti)(e,i,n,r,a,s,o)}function Pi(e,t,n,i,r,a){return".bin"===t.slice(-4)?function(e,i,r,t,a){if(!e)return e;t=t||{"!id":{}};var s={"!type":"chart","!drawel":null,"!rel":""},o=[],l=!1;return N(e,function(e,t,n){switch(n){case 550:s["!rel"]=e;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(t);break;case 38:o.pop();break;default:if(0<(t||"").indexOf("Begin"))o.push(t);else if(0<(t||"").indexOf("End"))o.pop();else if(!l||i.WTF)throw new Error("Unexpected record "+n+" "+t)}},i),t["!id"][s["!rel"]]&&(s["!drawel"]=t["!id"][s["!rel"]]),s}(e,i,n,r,a):function(e,t,n,i){if(!e)return e;n=n||{"!id":{}};var r={"!type":"chart","!drawel":null,"!rel":""},a=e.match(Jc);return a&&ni(a[0],0,i,t),(e=e.match(/drawing r:id="(.*?)"/))&&(r["!rel"]=e[1]),n["!id"][r["!rel"]]&&(r["!drawel"]=n["!id"][r["!rel"]]),r}(e,n,r,a)}function Ri(e,t,n,i){return(".bin"===t.slice(-4)?function(e,i,r){var t,a={NumberFmt:[]};for(t in aa._table)a.NumberFmt[t]=aa._table[t];a.CellXf=[],a.Fonts=[];var s=[],o=!1;return N(e,function(e,t,n){switch(n){case 44:a.NumberFmt[e[0]]=e[1],aa.load(e[1],e[0]);break;case 43:a.Fonts.push(e),null!=e.color.theme&&i&&i.themeElements&&i.themeElements.clrScheme&&(e.color.rgb=Jt(i.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:break;case 47:"BrtBeginCellXFs"==s[s.length-1]&&a.CellXf.push(e);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(t),o=!0;break;case 38:s.pop(),o=!1;break;default:if(0<(t||"").indexOf("Begin"))s.push(t);else if(0<(t||"").indexOf("End"))s.pop();else if(!o||r.WTF&&"BrtACBegin"!=s[s.length-1])throw new Error("Unexpected record "+n+" "+t)}}),a}:Gl)(e,n,i)}function Ai(e,t,n){return".bin"===t.slice(-4)?(i=n,a=!(r=[]),N(e,function(e,t,n){switch(n){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return 1;case 35:a=!0;break;case 36:a=!1;break;default:if(0<t.indexOf("Begin")||t.indexOf("End"),!a||i.WTF)throw new Error("Unexpected record "+n+" "+t)}}),r):function(e,t){var n=[],i="";if(!e)return n;if(e=e.match(el)){for(var i=e[2].replace(tl,"").split(nl),r=0;r!=i.length;++r){var a=Wt(i[r].trim(),t);null!=a&&(n[n.length]=a)}e=ie(e[1]),n.Count=e.count,n.Unique=e.uniqueCount}return n}(e,n);var i,r,a}function Ti(e,t,n){return".bin"===t.slice(-4)?(i=n,r=[],a=[],o=!(s={}),N(e,function(e,t,n){switch(n){case 632:a.push(e);break;case 635:s=e;break;case 637:s.t=e.t,s.h=e.h,s.r=e.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,i.sheetRows&&s.rfx&&i.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:case 38:break;default:if(!(0<(t||"").indexOf("Begin"))&&!(0<(t||"").indexOf("End"))&&(!o||i.WTF))throw new Error("Unexpected record "+n+" "+t)}}),r):function(e,i){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],t=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);return t&&t[1]&&t[1].split(/<\/\w*:?author>/).forEach(function(e){""===e||""===e.trim()||(e=e.match(/<(?:\w+:)?author[^>]*>(.*)/))&&r.push(e[1])}),(e=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&e[1]&&e[1].split(/<\/\w*:?comment>/).forEach(function(e){var t,n;""===e||""===e.trim()||(t=e.match(/<(?:\w+:)?comment[^>]*>/))&&(t={author:(n=ie(t[0])).authorId&&r[n.authorId]||"sheetjsghost",ref:n.ref,guid:n.guid},n=j(n.ref),i.sheetRows&&i.sheetRows<=n.r||(e=!!(e=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!e[1]&&Wt(e[1])||{r:"",t:"",h:""},t.r=e.r,"<t></t>"==e.r&&(e.t=e.h=""),t.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),i.cellHTML&&(t.h=e.h),a.push(t)))}),a}(e,n);var i,r,a,s,o}function Bi(e,t){return".bin"===t.slice(-4)?(i=[],N(e,function(e,t,n){if(63===n)i.push(e);else if(!(0<(t||"").indexOf("Begin")||0<(t||"").indexOf("End")))throw new Error("Unexpected record "+n+" "+t)}),i):function(e){var n=[];if(!e)return n;var i=1;return(e.match(xa)||[]).forEach(function(e){var t=ie(e);switch(t[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete t[0],t.i?i=t.i:t.i=i,n.push(t)}}),n}(e);var i}function Mi(e,t,n,i){return".bin"===n.slice(-4)?function(e,t){if(!e)return e;var i=t||{},r=!1;N(e,function(e,t,n){switch(n){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:r=!0;break;case 36:r=!1;break;default:if(!(0<(t||"").indexOf("Begin"))&&!(0<(t||"").indexOf("End"))&&(!r||i.WTF))throw new Error("Unexpected record "+n.toString(16)+" "+t)}},i)}(e,i):void 0}function Di(e,t){var n=e.split(/\s+/),i=[];if(t||(i[0]=n[0]),1===n.length)return i;var r,a,s,o=e.match(Cu);if(o)for(s=0;s!=o.length;++s)-1===(a=(r=o[s].match(Eu))[1].indexOf(":"))?i[r[1]]=r[2].slice(1,r[2].length-1):i["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(a+1)]=r[2].slice(1,r[2].length-1);return i}function Ii(e,t,n){if("z"!==e.t){if(!n||!1!==n.cellText)try{"e"===e.t?e.w=e.w||Ds[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=aa._general_int(e.v):e.w=aa._general_num(e.v):e.w=aa._general(e.v):e.w=(a=t||"General",s=e.v,"General"===(a=la[a]||Aa(a))?aa._general(s):aa.format(a,s))}catch(e){if(n.WTF)throw e}try{var i,r=la[t]||t||"General";n.cellNF&&(e.z=r),n.cellDates&&"n"==e.t&&aa.is_date(r)&&(i=aa.parse_date_code(e.v))&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}catch(e){if(n.WTF)throw e}}var a,s}function Li(e){if(Qr&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return La(a(u(e)));throw new Error("Bad input format: expected Buffer or string")}function Fi(e,t){var n=t||{};sa(aa);var i=Gr(Li(e)),r=(i="binary"==n.type||"array"==n.type||"base64"==n.type?"undefined"!=typeof cptable?cptable.utils.decode(65001,ee(i)):La(i):i).slice(0,1024).toLowerCase(),a=!1;if(-1==r.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){0<=r.indexOf("<"+e)&&(a=!0)}),a)return Mu.to_workbook(i,n);var s,o,l=[];null!=Zr&&null==n.dense&&(n.dense=Zr);var c,u,h,d,f,p={},m=[],g=n.dense?[]:{},v="",b={},S={},y=Di('<Data ss:Type="String">'),x=0,w=0,_=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},k={},P="",R=0,A=[],T={},B={},M=0,D=[],I=[],L={},F=[],O=!1,N=[],z=[],W={},V=0,$=0,U={Sheets:[],WBProps:{date1904:!1}},H={};for(ku.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/gm,"");s=ku.exec(i);)switch(s[3]){case"Data":if(l[l.length-1][1])break;"/"===s[1]?function(e,t,n,i,r,a,s,o,l,c){var u="General",h=i.StyleID,d={};c=c||{};var f=[],p=0;for(void 0===(h=void 0===h&&o?o.StyleID:h)&&s&&(h=s.StyleID);void 0!==a[h]&&(a[h].nf&&(u=a[h].nf),a[h].Interior&&f.push(a[h].Interior),a[h].Parent);)h=a[h].Parent;switch(n.Type){case"Boolean":i.t="b",i.v=re(e);break;case"String":i.t="s",i.r=Da(Aa(e)),i.v=-1<e.indexOf("<")?Aa(t||e):i.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),i.v=(te(e)-new Date(Date.UTC(1899,11,30)))/864e5,i.v!=i.v?i.v=Aa(e):i.v<60&&(i.v=i.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===i.v&&(i.v=+e),i.t||(i.t="n");break;case"Error":i.t="e",i.v=Is[e],!1!==c.cellText&&(i.w=e);break;default:i.t="s",i.v=Da(t||e)}if(Ii(i,u,c),!1!==c.cellFormula)if(i.Formula){n=Aa(i.Formula);61==n.charCodeAt(0)&&(n=n.slice(1)),i.f=hc(n,r),delete i.Formula,"RC"==i.ArrayRange?i.F=hc("RC:RC",r):i.ArrayRange&&(i.F=hc(i.ArrayRange,r),l.push([oe(i.F),i.F]))}else for(p=0;p<l.length;++p)r.r>=l[p][0].s.r&&r.r<=l[p][0].e.r&&r.c>=l[p][0].s.c&&r.c<=l[p][0].e.c&&(i.F=l[p][1]);c.cellStyles&&(f.forEach(function(e){!d.patternType&&e.patternType&&(d.patternType=e.patternType)}),i.s=d),void 0!==i.StyleID&&(i.ixfe=i.StyleID)}(i.slice(x,s.index),P,y,"Comment"==l[l.length-1][0]?L:b,{c:w,r:_},E,F[w],S,N,n):(P="",y=Di(s[0]),x=s.index+s[0].length);break;case"Cell":if("/"===s[1])if(0<I.length&&(b.c=I),(!n.sheetRows||n.sheetRows>_)&&void 0!==b.v&&(n.dense?(g[_]||(g[_]=[]),g[_][w]=b):g[se(w)+ae(_)]=b),b.HRef&&(b.l={Target:b.HRef},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(V=w+(0|parseInt(b.MergeAcross,10)),$=_+(0|parseInt(b.MergeDown,10)),A.push({s:{c:w,r:_},e:{c:V,r:$}})),n.sheetStubs)if(b.MergeAcross||b.MergeDown){for(var X=w;X<=V;++X)for(var G=_;G<=$;++G)(w<X||_<G)&&(n.dense?(g[G]||(g[G]=[]),g[G][X]={t:"z"}):g[se(X)+ae(G)]={t:"z"});w=V+1}else++w;else b.MergeAcross?w=V+1:++w;else(w=(b=function(e){var t={};if(1===e.split(/\s+/).length)return t;var n,i,r,a=e.match(Cu);if(a)for(r=0;r!=a.length;++r)-1===(i=(n=a[r].match(Eu))[1].indexOf(":"))?t[n[1]]=n[2].slice(1,n[2].length-1):t["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(i+1)]=n[2].slice(1,n[2].length-1);return t}(s[0])).Index?+b.Index-1:w)<C.s.c&&(C.s.c=w),w>C.e.c&&(C.e.c=w),"/>"===s[0].slice(-2)&&++w,I=[];break;case"Row":"/"===s[1]||"/>"===s[0].slice(-2)?(_<C.s.r&&(C.s.r=_),_>C.e.r&&(C.e.r=_),"/>"===s[0].slice(-2)&&((S=Di(s[0])).Index&&(_=+S.Index-1)),w=0,++_):((S=Di(s[0])).Index&&(_=+S.Index-1),W={},"0"!=S.AutoFitHeight&&!S.Height||(W.hpx=parseInt(S.Height,10),W.hpt=on(W.hpx),z[_]=W),"1"==S.Hidden&&(W.hidden=!0,z[_]=W));break;case"Worksheet":if("/"===s[1]){if((o=l.pop())[0]!==s[3])throw new Error("Bad state: "+o.join("|"));m.push(v),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(g["!ref"]=de(C),n.sheetRows&&n.sheetRows<=C.e.r&&(g["!fullref"]=g["!ref"],C.e.r=n.sheetRows-1,g["!ref"]=de(C))),A.length&&(g["!merges"]=A),0<F.length&&(g["!cols"]=F),0<z.length&&(g["!rows"]=z),p[v]=g}else _=w=0,l.push([s[3],!(C={s:{r:2e6,c:2e6},e:{r:0,c:0}})]),o=Di(s[0]),v=Aa(o.Name),g=n.dense?[]:{},A=[],N=[],z=[],U.Sheets.push(H={name:v,Hidden:0});break;case"Table":if("/"===s[1]){if((o=l.pop())[0]!==s[3])throw new Error("Bad state: "+o.join("|"))}else{if("/>"==s[0].slice(-2))break;Di(s[0]),l.push([s[3],!1]),O=!(F=[])}break;case"Style":"/"===s[1]?(h=E,d=k,(f=n).cellStyles&&d.Interior&&((f=d.Interior).Pattern&&(f.patternType=Ul[f.Pattern]||f.Pattern)),h[d.ID]=d):k=Di(s[0]);break;case"NumberFormat":k.nf=Aa(Di(s[0]).Format||"General"),la[k.nf]&&(k.nf=la[k.nf]);for(var j=0;392!=j&&aa._table[j]!=k.nf;++j);if(392==j)for(j=57;392!=j;++j)if(null==aa._table[j]){aa.load(k.nf,j);break}break;case"Column":if("Table"!==l[l.length-1][0])break;if((c=Di(s[0])).Hidden&&(c.hidden=!0,delete c.Hidden),c.Width&&(c.wpx=parseInt(c.Width,10)),!O&&10<c.wpx){O=!0,Vl=Nl;for(var Y=0;Y<F.length;++Y)F[Y]&&sn(F[Y])}O&&sn(c),F[c.Index-1||F.length]=c;for(var K=0;K<+c.Span;++K)F[F.length]=ne(c);break;case"NamedRange":U.Names||(U.Names=[]);var Z=ie(s[0]),q={Name:Z.Name,Ref:hc(Z.RefersTo.slice(1),{r:0,c:0})};0<U.Sheets.length&&(q.Sheet=U.Sheets.length-1),U.Names.push(q);break;case"NamedCell":case"B":case"I":case"U":case"S":case"Sub":case"Sup":case"Span":case"Alignment":case"Borders":case"Border":break;case"Font":if("/>"===s[0].slice(-2))break;"/"===s[1]?P+=i.slice(R,s.index):R=s.index+s[0].length;break;case"Interior":if(!n.cellStyles)break;k.Interior=Di(s[0]);break;case"Protection":break;case"Author":case"Title":case"Description":case"Created":case"Keywords":case"Subject":case"Category":case"Company":case"LastAuthor":case"LastSaved":case"LastPrinted":case"Version":case"Revision":case"TotalTime":case"HyperlinkBase":case"Manager":case"ContentStatus":case"Identifier":case"Language":case"AppName":if("/>"===s[0].slice(-2))break;"/"===s[1]?(d=T,Z=s[3],q=i.slice(M,s.index),d[Z=fo[Z]||Z]=q):M=s.index+s[0].length;break;case"Paragraphs":break;case"Styles":case"Workbook":if("/"===s[1]){if((o=l.pop())[0]!==s[3])throw new Error("Bad state: "+o.join("|"))}else l.push([s[3],!1]);break;case"Comment":if("/"===s[1]){if((o=l.pop())[0]!==s[3])throw new Error("Bad state: "+o.join("|"));(u=L).t=u.v||"",u.t=u.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),u.v=u.w=u.ixfe=void 0,I.push(L)}else l.push([s[3],!1]),L={a:(o=Di(s[0])).Author};break;case"AutoFilter":if("/"===s[1]){if((o=l.pop())[0]!==s[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&(u=Di(s[0]),g["!autofilter"]={ref:hc(u.Range).replace(/\$/g,"")},l.push([s[3],!0]));break;case"Name":break;case"DataValidation":if("/"===s[1]){if((o=l.pop())[0]!==s[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&l.push([s[3],!0]);break;case"ComponentOptions":case"DocumentProperties":case"CustomDocumentProperties":case"OfficeDocumentSettings":case"PivotTable":case"PivotCache":case"Names":case"MapInfo":case"PageBreaks":case"QueryTable":case"Sorting":case"Schema":case"data":case"ConditionalFormatting":case"SmartTagType":case"SmartTags":case"ExcelWorkbook":case"WorkbookOptions":case"WorksheetOptions":if("/"===s[1]){if((o=l.pop())[0]!==s[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&l.push([s[3],!0]);break;default:if(0==l.length&&"document"==s[3])return ur(i,n);if(0==l.length&&"UOF"==s[3])return ur(i,n);var Q=!0;switch(l[l.length-1][0]){case"OfficeDocumentSettings":switch(s[3]){case"AllowPNG":case"RemovePersonalInformation":case"DownloadComponents":case"LocationOfComponents":case"Colors":case"Color":case"Index":case"RGB":case"PixelsPerInch":case"TargetScreenSize":case"ReadOnlyRecommended":break;default:Q=!1}break;case"ComponentOptions":switch(s[3]){case"Toolbar":case"HideOfficeLogo":case"SpreadsheetAutoFit":case"Label":case"Caption":case"MaxHeight":case"MaxWidth":case"NextSheetNumber":break;default:Q=!1}break;case"ExcelWorkbook":switch(s[3]){case"Date1904":U.WBProps.date1904=!0;break;case"WindowHeight":case"WindowWidth":case"WindowTopX":case"WindowTopY":case"TabRatio":case"ProtectStructure":case"ProtectWindow":case"ProtectWindows":case"ActiveSheet":case"DisplayInkNotes":case"FirstVisibleSheet":case"SupBook":case"SheetName":case"SheetIndex":case"SheetIndexFirst":case"SheetIndexLast":case"Dll":case"AcceptLabelsInFormulas":case"DoNotSaveLinkValues":case"Iteration":case"MaxIterations":case"MaxChange":case"Path":case"Xct":case"Count":case"SelectedSheets":case"Calculation":case"Uncalced":case"StartupPrompt":case"Crn":case"ExternName":case"Formula":case"ColFirst":case"ColLast":case"WantAdvise":case"Boolean":case"Error":case"Text":case"OLE":case"NoAutoRecover":case"PublishObjects":case"DoNotCalculateBeforeSave":case"Number":case"RefModeR1C1":case"EmbedSaveSmartTags":break;default:Q=!1}break;case"WorkbookOptions":switch(s[3]){case"OWCVersion":case"Height":case"Width":break;default:Q=!1}break;case"WorksheetOptions":switch(s[3]){case"Visible":if("/>"!==s[0].slice(-2))if("/"===s[1])switch(i.slice(M,s.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2}else M=s.index+s[0].length;break;case"Header":g["!margins"]||Qn(g["!margins"]={},"xlml"),g["!margins"].header=ie(s[0]).Margin;break;case"Footer":g["!margins"]||Qn(g["!margins"]={},"xlml"),g["!margins"].footer=ie(s[0]).Margin;break;case"PageMargins":var J=ie(s[0]);g["!margins"]||Qn(g["!margins"]={},"xlml"),J.Top&&(g["!margins"].top=J.Top),J.Left&&(g["!margins"].left=J.Left),J.Right&&(g["!margins"].right=J.Right),J.Bottom&&(g["!margins"].bottom=J.Bottom);break;case"DisplayRightToLeft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"FreezePanes":case"FrozenNoSplit":break;case"SplitHorizontal":case"SplitVertical":case"DoNotDisplayGridlines":case"TopRowBottomPane":case"LeftColumnRightPane":case"Unsynced":case"Print":case"Panes":case"Scale":case"Pane":case"Number":case"Layout":case"PageSetup":case"Selected":case"ProtectObjects":case"EnableSelection":case"ProtectScenarios":case"ValidPrinterInfo":case"HorizontalResolution":case"VerticalResolution":case"NumberofCopies":case"ActiveRow":case"ActiveCol":case"ActivePane":case"TopRowVisible":case"LeftColumnVisible":case"FitToPage":case"RangeSelection":case"PaperSizeIndex":case"PageLayoutZoom":case"PageBreakZoom":case"FilterOn":case"FitWidth":case"FitHeight":case"CommentsLayout":case"Zoom":case"LeftToRight":case"Gridlines":case"AllowSort":case"AllowFilter":case"AllowInsertRows":case"AllowDeleteRows":case"AllowInsertCols":case"AllowDeleteCols":case"AllowInsertHyperlinks":case"AllowFormatCells":case"AllowSizeCols":case"AllowSizeRows":case"NoSummaryRowsBelowDetail":case"TabColorIndex":case"DoNotDisplayHeadings":case"ShowPageLayoutZoom":case"NoSummaryColumnsRightDetail":case"BlackAndWhite":case"DoNotDisplayZeros":case"DisplayPageBreak":case"RowColHeadings":case"DoNotDisplayOutline":case"NoOrientation":case"AllowUsePivotTables":case"ZeroHeight":case"ViewableRange":case"Selection":case"ProtectContents":break;default:Q=!1}break;case"PivotTable":case"PivotCache":switch(s[3]){case"ImmediateItemsOnDrop":case"ShowPageMultipleItemLabel":case"CompactRowIndent":case"Location":case"PivotField":case"Orientation":case"LayoutForm":case"LayoutSubtotalLocation":case"LayoutCompactRow":case"Position":case"PivotItem":case"DataType":case"DataField":case"SourceName":case"ParentField":case"PTLineItems":case"PTLineItem":case"CountOfSameItems":case"Item":case"ItemType":case"PTSource":case"CacheIndex":case"ConsolidationReference":case"FileName":case"Reference":case"NoColumnGrand":case"NoRowGrand":case"BlankLineAfterItems":case"Hidden":case"Subtotal":case"BaseField":case"MapChildItems":case"Function":case"RefreshOnFileOpen":case"PrintSetTitles":case"MergeLabels":case"DefaultVersion":case"RefreshName":case"RefreshDate":case"RefreshDateCopy":case"VersionLastRefresh":case"VersionLastUpdate":case"VersionUpdateableMin":case"VersionRefreshableMin":case"Calculation":break;default:Q=!1}break;case"PageBreaks":switch(s[3]){case"ColBreaks":case"ColBreak":case"RowBreaks":case"RowBreak":case"ColStart":case"ColEnd":case"RowEnd":break;default:Q=!1}break;case"AutoFilter":switch(s[3]){case"AutoFilterColumn":case"AutoFilterCondition":case"AutoFilterAnd":case"AutoFilterOr":break;default:Q=!1}break;case"QueryTable":switch(s[3]){case"Id":case"AutoFormatFont":case"AutoFormatPattern":case"QuerySource":case"QueryType":case"EnableRedirections":case"RefreshedInXl9":case"URLString":case"HTMLTables":case"Connection":case"CommandText":case"RefreshInfo":case"NoTitles":case"NextId":case"ColumnInfo":case"OverwriteCells":case"DoNotPromptForFile":case"TextWizardSettings":case"Source":case"Number":case"Decimal":case"ThousandSeparator":case"TrailingMinusNumbers":case"FormatSettings":case"FieldType":case"Delimiters":case"Tab":case"Comma":case"AutoFormatName":case"VersionLastEdit":case"VersionLastRefresh":break;default:Q=!1}break;case"DataValidation":switch(s[3]){case"Range":case"Type":case"Min":case"Max":case"Sort":case"Descending":case"Order":case"CaseSensitive":case"Value":case"ErrorStyle":case"ErrorMessage":case"ErrorTitle":case"InputMessage":case"InputTitle":case"ComboHide":case"InputHide":case"Condition":case"Qualifier":case"UseBlank":case"Value1":case"Value2":case"Format":case"CellRangeList":break;default:Q=!1}break;case"Sorting":case"ConditionalFormatting":switch(s[3]){case"Range":case"Type":case"Min":case"Max":case"Sort":case"Descending":case"Order":case"CaseSensitive":case"Value":case"ErrorStyle":case"ErrorMessage":case"ErrorTitle":case"CellRangeList":case"InputMessage":case"InputTitle":case"ComboHide":case"InputHide":case"Condition":case"Qualifier":case"UseBlank":case"Value1":case"Value2":case"Format":break;default:Q=!1}break;case"MapInfo":case"Schema":case"data":switch(s[3]){case"Map":case"Entry":case"Range":case"XPath":case"Field":case"XSDType":case"FilterOn":case"Aggregate":case"ElementType":case"AttributeType":break;case"schema":case"element":case"complexType":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Q=!1}break;case"SmartTags":break;default:Q=!1}if(Q)break;if(s[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+s[3]+"|"+l.join("|");if("CustomDocumentProperties"===l[l.length-1][0]){if("/>"===s[0].slice(-2))break;"/"===s[1]?function(e,t,n,i){var r=i;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":r=re(i);break;case"i2":case"int":r=parseInt(i,10);break;case"r4":case"float":r=parseFloat(i);break;case"date":case"dateTime.tz":r=te(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[Aa(t)]=r}(B,s[3],D,i.slice(M,s.index)):M=(D=s).index+s[0].length;break}if(n.WTF)throw"Unrecognized tag: "+s[3]+"|"+l.join("|")}e={};return n.bookSheets||n.bookProps||(e.Sheets=p),e.SheetNames=m,e.Workbook=U,e.SSF=aa.get_table(),e.Props=T,e.Custprops=B,e}function Oi(e,t){switch(Xu(t=t||{}),t.type||"base64"){case"base64":return Fi(qr.decode(e),t);case"binary":case"buffer":case"file":return Fi(e,t);case"array":return Fi(a(e),t)}}function Ni(e,t){var r,i,a,s,n,o,l,c=[];return e.Props&&c.push((n=e.Props,o=t,l=[],ce(ho).map(function(e){for(var t=0;t<io.length;++t)if(io[t][1]==e)return io[t];for(t=0;t<so.length;++t)if(so[t][1]==e)return so[t];throw e}).forEach(function(e){var t;null!=n[e[1]]&&(t=(o&&o.Props&&null!=o.Props[e[1]]?o.Props:n)[e[1]],"number"==typeof(t="date"===e[2]?new Date(t).toISOString().replace(/\.\d*Z/,"Z"):t)?t=String(t):!0===t||!1===t?t=t?"1":"0":t instanceof Date&&(t=new Date(t).toISOString().replace(/\.\d*Z/,"")),l.push(R(ho[e[1]]||e[1],t)))}),I("DocumentProperties",l.join(""),{xmlns:Za.o}))),e.Custprops&&c.push((r=e.Props,i=e.Custprops,a=["Worksheets","SheetNames"],e="CustomDocumentProperties",s=[],r&&ce(r).forEach(function(e){if(r.hasOwnProperty(e)){for(var t=0;t<io.length;++t)if(e==io[t][1])return;for(t=0;t<so.length;++t)if(e==so[t][1])return;for(t=0;t<a.length;++t)if(e==a[t])return;var n="string",i="number"==typeof(i=r[e])?(n="float",String(i)):!0===i||!1===i?(n="boolean",i?"1":"0"):String(i);s.push(I(m(e),i,{"dt:dt":n}))}}),i&&ce(i).forEach(function(e){var t,n;!i.hasOwnProperty(e)||r&&r.hasOwnProperty(e)||(t="string",n="number"==typeof(n=i[e])?(t="float",String(n)):!0===n||!1===n?(t="boolean",n?"1":"0"):n instanceof Date?(t="dateTime.tz",n.toISOString()):String(n),s.push(I(m(e),n,{"dt:dt":t})))}),"<"+e+' xmlns="'+Za.o+'">'+s.join("")+"</"+e+">")),c.join("")}function zi(e){return I("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+fc(e.Ref,{r:0,c:0})})}function Wi(e,t,n,i,r,a,s){if(!e||null==e.v&&null==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+P(fc(e.f,s))),e.F&&e.F.slice(0,t.length)==t&&(t=j(e.F.slice(t.length+1)),o["ss:ArrayRange"]="RC:R"+(t.r==s.r?"":"["+(t.r-s.r)+"]")+"C"+(t.c==s.c?"":"["+(t.c-s.c)+"]")),e.l&&e.l.Target&&(o["ss:HRef"]=P(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=P(e.l.Tooltip))),n["!merges"])for(var l=n["!merges"],c=0;c!=l.length;++c)l[c].s.c==s.c&&l[c].s.r==s.r&&(l[c].e.c>l[c].s.c&&(o["ss:MergeAcross"]=l[c].e.c-l[c].s.c),l[c].e.r>l[c].s.r&&(o["ss:MergeDown"]=l[c].e.r-l[c].s.r));var u="",h="";switch(e.t){case"z":if(!i.sheetStubs)return"";break;case"n":u="Number",h=String(e.v);break;case"b":u="Boolean",h=e.v?"1":"0";break;case"e":u="Error",h=Ds[e.v];break;case"d":u="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||aa._table[14]);break;case"s":u="String",h=((e.v||"")+"").replace(Ta,function(e){return Ra[e]}).replace(Ma,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}n=Jn(i.cellXfs,e,i);o["ss:StyleID"]="s"+(21+n),o["ss:Index"]=s.c+1;n=null!=e.v?h:"",n="z"==e.t?"":'<Data ss:Type="'+u+'">'+n+"</Data>";return 0<(e.c||[]).length&&(n+=e.c.map(function(e){return I("Comment",I("ss:Data",Ia(e.t||""),{xmlns:"http://www.w3.org/TR/REC-html40"}),{"ss:Author":e.a})}).join("")),I("Cell",n,o)}function Vi(e,t){if(!e["!ref"])return"";var n=oe(e["!ref"]),i=e["!merges"]||[],r=0,a=[];e["!cols"]&&e["!cols"].forEach(function(e,t){sn(e);var n=!!e.width,i=qn(t,e),t={"ss:Index":t+1};n&&(t["ss:Width"]=en(i.width)),e.hidden&&(t["ss:Hidden"]="1"),a.push(I("Column",null,t))});for(var s,o,l=Array.isArray(e),c=n.s.r;c<=n.e.r;++c){for(var u=[(s=c,o=(e["!rows"]||[])[c],s='<Row ss:Index="'+(s+1)+'"',o&&(o.hpt&&!o.hpx&&(o.hpx=ln(o.hpt)),o.hpx&&(s+=' ss:AutoFitHeight="0" ss:Height="'+o.hpx+'"'),o.hidden&&(s+=' ss:Hidden="1"')),s+">")],h=n.s.c;h<=n.e.c;++h){for(var d,f,p,m=!1,r=0;r!=i.length;++r)if(!(i[r].s.c>h||i[r].s.r>c||i[r].e.c<h||i[r].e.r<c)){i[r].s.c==h&&i[r].s.r==c||(m=!0);break}m||(f=he(d={r:c,c:h}),p=l?(e[c]||[])[h]:e[f],u.push(Wi(p,f,e,t,0,0,d)))}u.push("</Row>"),2<u.length&&a.push(u.join(""))}return a.join("")}function $i(e,t,n){var i=[],r=n.SheetNames[e],a=n.Sheets[r],r=a?function(e,t,n){if(!e)return"";if(!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,r=[],a=0;a<i.length;++a){var s=i[a];s.Sheet==t&&(s.Name.match(/^_xlfn\./)||r.push(zi(s)))}return r.join("")}(a,e,n):"";return 0<r.length&&i.push("<Names>"+r+"</Names>"),0<(r=a?Vi(a,t):"").length&&i.push("<Table>"+r+"</Table>"),i.push(function(t,e,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(I("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(I("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(I("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[e])if(n.Workbook.Sheets[e].Hidden)i.push(I("Visible",1==n.Workbook.Sheets[e].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var r=0;r<e&&(!n.Workbook.Sheets[r]||n.Workbook.Sheets[r].Hidden);++r);r==e&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(R("ProtectContents","True")),t["!protect"].objects&&i.push(R("ProtectObjects","True")),t["!protect"].scenarios&&i.push(R("ProtectScenarios","True")),null==t["!protect"].selectLockedCells||t["!protect"].selectLockedCells?null==t["!protect"].selectUnlockedCells||t["!protect"].selectUnlockedCells||i.push(R("EnableSelection","UnlockedCells")):i.push(R("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(e){t["!protect"][e[0]]&&i.push("<"+e[1]+"/>")})),0==i.length?"":I("WorksheetOptions",i.join(""),{xmlns:Za.x})}(a,e,n)),i.join("")}function Ui(e,t){t=t||{},e.SSF||(e.SSF=aa.get_table()),e.SSF&&(sa(aa),aa.load_table(e.SSF),t.revssf=x(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Jn(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(Ni(e,t)),n.push(""),n.push(""),n.push("");for(var i,r=0;r<e.SheetNames.length;++r)n.push(I("Worksheet",$i(r,t,e),{"ss:Name":P(e.SheetNames[r])}));return n[2]=(i=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],t.cellXfs.forEach(function(e,t){var n=[];n.push(I("NumberFormat",null,{"ss:Format":P(aa._table[e.numFmtId])})),i.push(I("Style",n.join(""),{"ss:ID":"s"+(21+t)}))}),I("Styles",i.join(""))),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],i=0;i<t.length;++i){var r=t[i];null==r.Sheet&&(r.Name.match(/^_xlfn\./)||n.push(zi(r)))}return I("Names",n.join(""))}(e),Sa+I("Workbook",n.join(""),{xmlns:Za.ss,"xmlns:o":Za.o,"xmlns:x":Za.x,"xmlns:ss":Za.ss,"xmlns:dt":Za.dt,"xmlns:html":Za.html})}function Hi(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n._R(0,"lpstr-ansi"),t.AnsiClipboardFormat=Be(n,1),n.length-n.l<=4)return t;e=n._R(4);return 0==e||40<e?t:(n.l-=4,t.Reserved1=n._R(0,"lpstr-ansi"),n.length-n.l<=4||1907505652!==(e=n._R(4))?t:(t.UnicodeClipboardFormat=Be(n,2),0==(e=n._R(4))||40<e?t:(n.l-=4,void(t.Reserved2=n._R(0,"lpwstr")))))}function Xi(e,t,n){if("z"!==e.t&&e.XF){var i=0;try{i=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=aa._table[i])}catch(e){if(t.WTF)throw e}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Ds[e.v]:0===i||"General"==i?"n"===e.t?(0|e.v)===e.v?e.w=aa._general_int(e.v):e.w=aa._general_num(e.v):e.w=aa._general(e.v):e.w=aa.format(i,e.v,{date1904:!!n})}catch(e){if(t.WTF)throw e}t.cellDates&&i&&"n"==e.t&&aa.is_date(aa._table[i]||String(i))&&((i=aa.parse_date_code(e.v))&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)))}}function Gi(e,t,n){return{v:e,ixfe:t,t:n}}function ji(e,t){var n={opts:{}},i={};null!=Zr&&null==t.dense&&(t.dense=Zr);function r(e,t,n){if(!(1<L)&&(S=n.sheetRows&&e.r>=n.sheetRows?!1:S)){if(n.cellStyles&&t.XF&&t.XF.data&&(a=n,(s=(r=t).XF.data)&&s.patternType&&a&&a.cellStyles&&(r.s={},r.s.patternType=s.patternType,(a=Qt(C(s.icvFore)))&&(r.s.fgColor={rgb:a}),(a=Qt(C(s.icvBack)))&&(r.s.bgColor={rgb:a}))),delete t.ixfe,delete t.XF,o=e,g=he(e),h&&h.s&&h.e||(h={s:{r:0,c:0},e:{r:0,c:0}}),e.r<h.s.r&&(h.s.r=e.r),e.c<h.s.c&&(h.s.c=e.c),e.r+1>h.e.r&&(h.e.r=e.r+1),e.c+1>h.e.c&&(h.e.c=e.c+1),n.cellFormula&&t.f)for(var i=0;i<b.length;++i)if(!(b[i][0].s.c>e.c||b[i][0].s.r>e.r||b[i][0].e.c<e.c||b[i][0].e.r<e.r)){t.F=de(b[i][0]),b[i][0].s.c==e.c&&b[i][0].s.r==e.r||delete t.f,t.f&&(t.f=""+Hn(b[i][1],0,e,M,E));break}n.dense?(c[e.r]||(c[e.r]=[]),c[e.r][e.c]=t):c[g]=t}var r,a,s}var o,a,s,l,c=t.dense?[]:{},u={},h={},d=null,f=[],p="",m={},g="",v={},b=[],S=!0,y=[],x=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},_={},C=function(e){return!(e<8)&&e<64&&x[e-8]||Xs[e]},E={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(E.password=t.password);var k,P=[],R=[],A=[],T=[],B=!1,M=[];M.SheetNames=E.snames,M.sharedf=E.sharedf,M.arrayf=E.arrayf,M.names=[],M.XTI=[];var D,I="",L=0,F=0,O=[],N=[];E.codepage=1200,Xr(1200);for(var z=!1;e.l<e.length-1;){var W=e.l,V=e._R(2);if(0===V&&"EOF"===I)break;var $=e.l===e.length?0:e._R(2),U=Tu[V];if(U&&U.f){if(t.bookSheets&&"BoundSheet8"===I&&"BoundSheet8"!==U.n)break;if(I=U.n,2===U.r||12==U.r){var H=e._R(2);if($-=2,!E.enc&&H!==V&&((255&H)<<8|H>>8)!==V)throw new Error("rt mismatch: "+H+"!="+V);12==U.r&&(e.l+=10,$-=10)}var X,G,j,Y,K={},K="EOF"===U.n?U.f(e,$,E):function(e,t,n,i){var r=n,a=[],s=t.slice(t.l,t.l+r);if(i&&i.enc&&i.enc.insitu)switch(e.n){case"BOF":case"FilePass":case"FileLock":case"InterfaceHdr":case"RRDInfo":case"RRDHead":case"UsrExcl":break;default:if(0===s.length)break;i.enc.insitu(s)}a.push(s),t.l+=r;for(var o=Tu[ys(t,t.l)],l=0;null!=o&&"Continue"===o.n.slice(0,8);)r=ys(t,t.l+2),l=t.l+4,"ContinueFrt"==o.n?l+=4:"ContinueFrt"==o.n.slice(0,11)&&(l+=12),a.push(t.slice(l,t.l+4+r)),t.l+=4+r,o=Tu[ys(t,t.l)];var c=na(a);ue(c,0);var u=0;c.lens=[];for(var h=0;h<a.length;++h)c.lens.push(u),u+=a[h].length;return e.f(c,c.length,i)}(U,e,$,E),Z=U.n;if(0!=L||"BOF"==Z)switch(Z){case"Date1904":n.opts.Date1904=w.WBProps.date1904=K;break;case"WriteProtect":n.opts.WriteProtect=!0;break;case"FilePass":if(E.enc||(e.l=0),E.enc=K,!t.password)throw new Error("File is password-protected");if(null==K.valid)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case"WriteAccess":E.lastuser=K;break;case"FileSharing":break;case"CodePage":var q=Number(K);switch(q){case 21010:q=1200;break;case 32768:q=1e4;break;case 32769:q=1252}Xr(E.codepage=q),z=!0;break;case"RRTabId":E.rrtabid=K;break;case"WinProtect":E.winlocked=K;break;case"Template":case"BookBool":case"UsesELFs":case"MTRSettings":break;case"RefreshAll":case"CalcCount":case"CalcDelta":case"CalcIter":case"CalcMode":case"CalcPrecision":case"CalcSaveRecalc":n.opts[Z]=K;break;case"CalcRefMode":E.CalcRefMode=K;break;case"Uncalced":break;case"ForceFullCalculation":n.opts.FullCalc=K;break;case"WsBool":K.fDialog&&(c["!type"]="dialog");break;case"XF":y.push(K);break;case"ExtSST":case"BookExt":case"RichTextStream":case"BkHim":break;case"SupBook":M.push([K]),M[M.length-1].XTI=[];break;case"ExternName":M[M.length-1].push(K);break;case"Index":break;case"Lbl":D={Name:K.Name,Ref:Hn(K.rgce,0,null,M,E)},0<K.itab&&(D.Sheet=K.itab-1),M.names.push(D),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(K),"_xlnm._FilterDatabase"==K.Name&&0<K.itab&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&"PtgArea3d"==K.rgce[0][0][0]&&(N[K.itab-1]={ref:de(K.rgce[0][0][1][2])});break;case"ExternCount":E.ExternCount=K;break;case"ExternSheet":0==M.length&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(K),M.XTI=M.XTI.concat(K);break;case"NameCmt":if(E.biff<8)break;null!=D&&(D.Comment=K[1]);break;case"Protect":c["!protect"]=K;break;case"Password":0!==K&&E.WTF&&console.error("Password verifier: "+K);break;case"Prot4Rev":case"Prot4RevPass":break;case"BoundSheet8":u[K.pos]=K,E.snames.push(K.name);break;case"EOF":if(--L)break;h.e&&(0<h.e.r&&0<h.e.c&&(h.e.r--,h.e.c--,c["!ref"]=de(h),t.sheetRows&&t.sheetRows<=h.e.r&&(X=h.e.r,h.e.r=t.sheetRows-1,c["!fullref"]=c["!ref"],c["!ref"]=de(h),h.e.r=X),h.e.r++,h.e.c++),0<P.length&&(c["!merges"]=P),0<R.length&&(c["!objects"]=R),0<A.length&&(c["!cols"]=A),0<T.length&&(c["!rows"]=T),w.Sheets.push(_)),""===p?m=c:i[p]=c,c=t.dense?[]:{};break;case"BOF":if(8===E.biff&&(E.biff={9:2,521:3,1033:4}[V]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),8==E.biff&&0==K.BIFFVer&&16==K.dt&&(E.biff=2),L++)break;var Q,S=!0,c=t.dense?[]:{};E.biff<8&&!z&&(z=!0,Xr(E.codepage=t.codepage||1252)),E.biff<5?(""===p&&(p="Sheet1"),h={s:{r:0,c:0},e:{r:0,c:0}},Q={pos:e.l-$,name:p},u[Q.pos]=Q,E.snames.push(p)):p=(u[W]||{name:""}).name,32==K.dt&&(c["!type"]="chart"),64==K.dt&&(c["!type"]="macro"),P=[],R=[],E.arrayf=b=[],A=[],B=!(T=[]),_={Hidden:(u[W]||{hs:0}).hs,name:p};break;case"Number":case"BIFF2NUM":case"BIFF2INT":"chart"==c["!type"]&&(t.dense?(c[K.r]||[])[K.c]:c[he({c:K.c,r:K.r})])&&++K.c,te={ixfe:K.ixfe,XF:y[K.ixfe]||{},v:K.val,t:"n"},0<F&&(te.z=O[te.ixfe>>8&31]),Xi(te,t,n.opts.Date1904),r({c:K.c,r:K.r},te,t);break;case"BoolErr":te={ixfe:K.ixfe,XF:y[K.ixfe],v:K.val,t:K.t},0<F&&(te.z=O[te.ixfe>>8&31]),Xi(te,t,n.opts.Date1904),r({c:K.c,r:K.r},te,t);break;case"RK":te={ixfe:K.ixfe,XF:y[K.ixfe],v:K.rknum,t:"n"},0<F&&(te.z=O[te.ixfe>>8&31]),Xi(te,t,n.opts.Date1904),r({c:K.c,r:K.r},te,t);break;case"MulRk":for(var J=K.c;J<=K.C;++J){var ee=K.rkrec[J-K.c][0],te={ixfe:ee,XF:y[ee],v:K.rkrec[J-K.c][1],t:"n"};0<F&&(te.z=O[te.ixfe>>8&31]),Xi(te,t,n.opts.Date1904),r({c:J,r:K.r},te,t)}break;case"Formula":if("String"==K.val){d=K;break}(te=Gi(K.val,K.cell.ixfe,K.tt)).XF=y[te.ixfe],t.cellFormula&&(!((Q=K.formula)&&Q[0]&&Q[0][0]&&"PtgExp"==Q[0][0][0])||v[Y=he({r:G=Q[0][0][1][0],c:j=Q[0][0][1][1]})]?te.f=""+Hn(K.formula,0,K.cell,M,E):te.F=((t.dense?(c[G]||[])[j]:c[Y])||{}).F),0<F&&(te.z=O[te.ixfe>>8&31]),Xi(te,t,n.opts.Date1904),r(K.cell,te,t),d=K;break;case"String":if(!d)throw new Error("String record expects Formula");(te=Gi(d.val=K,d.cell.ixfe,"s")).XF=y[te.ixfe],t.cellFormula&&(te.f=""+Hn(d.formula,0,d.cell,M,E)),0<F&&(te.z=O[te.ixfe>>8&31]),Xi(te,t,n.opts.Date1904),r(d.cell,te,t),d=null;break;case"Array":b.push(K);var ne=he(K[0].s),ie=t.dense?(c[K[0].s.r]||[])[K[0].s.c]:c[ne];if(t.cellFormula&&ie){if(!d)break;if(!ne||!ie)break;ie.f=""+Hn(K[1],0,K[0],M,E),ie.F=de(K[0])}break;case"ShrFmla":if(!S)break;if(!t.cellFormula)break;if(g){if(!d)break;v[he(d.cell)]=K[0],((ie=t.dense?(c[d.cell.r]||[])[d.cell.c]:c[he(d.cell)])||{}).f=""+Hn(K[0],0,o,M,E)}break;case"LabelSst":te=Gi(f[K.isst].t,K.ixfe,"s"),f[K.isst].h&&(te.h=f[K.isst].h),te.XF=y[te.ixfe],0<F&&(te.z=O[te.ixfe>>8&31]),Xi(te,t,n.opts.Date1904),r({c:K.c,r:K.r},te,t);break;case"Blank":t.sheetStubs&&(te={ixfe:K.ixfe,XF:y[K.ixfe],t:"z"},0<F&&(te.z=O[te.ixfe>>8&31]),Xi(te,t,n.opts.Date1904),r({c:K.c,r:K.r},te,t));break;case"MulBlank":if(t.sheetStubs)for(var re=K.c;re<=K.C;++re){var ae=K.ixfe[re-K.c];te={ixfe:ae,XF:y[ae],t:"z"},0<F&&(te.z=O[te.ixfe>>8&31]),Xi(te,t,n.opts.Date1904),r({c:re,r:K.r},te,t)}break;case"RString":case"Label":case"BIFF2STR":(te=Gi(K.val,K.ixfe,"s")).XF=y[te.ixfe],0<F&&(te.z=O[te.ixfe>>8&31]),Xi(te,t,n.opts.Date1904),r({c:K.c,r:K.r},te,t);break;case"Dimensions":1===L&&(h=K);break;case"SST":f=K;break;case"Format":if(4==E.biff){O[F++]=K[1];for(var se=0;se<F+163&&aa._table[se]!=K[1];++se);163<=se&&aa.load(K[1],F+163)}else aa.load(K[1],K[0]);break;case"BIFF2FORMAT":O[F++]=K;for(var oe=0;oe<F+163&&aa._table[oe]!=K;++oe);163<=oe&&aa.load(K,F+163);break;case"MergeCells":P=P.concat(K);break;case"Obj":R[K.cmo[0]]=E.lastobj=K;break;case"TxO":E.lastobj.TxO=K;break;case"ImData":E.lastobj.ImData=K;break;case"HLink":for(s=K[0].s.r;s<=K[0].e.r;++s)for(a=K[0].s.c;a<=K[0].e.c;++a)(ie=t.dense?(c[s]||[])[a]:c[he({c:a,r:s})])&&(ie.l=K[1]);break;case"HLinkTooltip":for(s=K[0].s.r;s<=K[0].e.r;++s)for(a=K[0].s.c;a<=K[0].e.c;++a)(ie=t.dense?(c[s]||[])[a]:c[he({c:a,r:s})])&&ie.l&&(ie.l.Tooltip=K[1]);break;case"Note":if(E.biff<=5&&2<=E.biff)break;ie=t.dense?(c[K[0].r]||[])[K[0].c]:c[he(K[0])];var ne=R[K[2]];ie||(ie=t.dense?(c[K[0].r]||(c[K[0].r]=[]),c[K[0].r][K[0].c]={t:"z"}):c[he(K[0])]={t:"z"},h.e.r=Math.max(h.e.r,K[0].r),h.s.r=Math.min(h.s.r,K[0].r),h.e.c=Math.max(h.e.c,K[0].c),h.s.c=Math.min(h.s.c,K[0].c)),ie.c||(ie.c=[]),ne={a:K[1],t:ne.TxO.t},ie.c.push(ne);break;default:switch(U.n){case"ClrtClient":break;case"XFExt":y[K.ixfe],K.ext.forEach(function(e){e[0]});break;case"DefColWidth":break;case"DefaultRowHeight":K[1];break;case"ColInfo":if(!E.cellStyles)break;for(;K.e>=K.s;)A[K.e--]={width:K.w/256},B||(B=!0,an(K.w/256)),sn(A[K.e+1]);break;case"Row":var le={};null!=K.level&&((T[K.r]=le).level=K.level),K.hidden&&((T[K.r]=le).hidden=!0),K.hpt&&((T[K.r]=le).hpt=K.hpt,le.hpx=ln(K.hpt));break;case"LeftMargin":case"RightMargin":case"TopMargin":case"BottomMargin":c["!margins"]||Qn(c["!margins"]={}),c["!margins"][Z.slice(0,-6).toLowerCase()]=K;break;case"Setup":c["!margins"]||Qn(c["!margins"]={}),c["!margins"].header=K.header,c["!margins"].footer=K.footer;break;case"Window2":K.RTL&&(w.Views[0].RTL=!0);break;case"Header":case"Footer":case"HCenter":case"VCenter":case"Pls":case"GCW":case"LHRecord":case"DBCell":case"EntExU2":case"SxView":case"Sxvd":case"SXVI":case"SXVDEx":case"SxIvd":case"SXString":case"Sync":case"Addin":case"SXDI":case"SXLI":case"SXEx":case"QsiSXTag":case"Selection":case"Feat":break;case"FeatHdr":case"FeatHdr11":break;case"Feature11":case"Feature12":case"List12":break;case"Country":l=K;break;case"RecalcId":case"DxGCol":break;case"Fbi":case"Fbi2":case"GelFrame":case"Font":case"XFCRC":case"Style":case"StyleExt":break;case"Palette":x=K;break;case"Theme":k=K;break;case"ScenarioProtect":case"ObjProtect":case"CondFmt12":case"Table":case"TableStyles":case"TableStyle":case"TableStyleElement":case"SXStreamID":case"SXVS":case"DConRef":case"SXAddl":case"DConBin":case"DConName":case"SXPI":case"SxFormat":case"SxSelect":case"SxRule":case"SxFilt":case"SxItm":case"SxDXF":case"ScenMan":case"DCon":case"CellWatch":case"PrintRowCol":case"PrintGrid":case"PrintSize":case"XCT":case"CRN":case"Scl":case"SheetExt":case"SheetExtOptional":case"ObNoMacros":case"ObProj":break;case"CodeName":p?_.CodeName=K||_.name:w.WBProps.CodeName=K||"ThisWorkbook";break;case"GUIDTypeLib":case"WOpt":case"PhoneticInfo":case"OleObjectSize":break;case"DXF":case"DXFN":case"DXFN12":case"DXFN12List":case"DXFN12NoCB":break;case"Dv":case"DVal":break;case"BRAI":case"Series":case"SeriesText":case"DConn":case"DbOrParamQry":case"DBQueryExt":case"OleDbConn":case"ExtString":case"IFmtRecord":break;case"CondFmt":case"CF":case"CF12":case"CFEx":case"Excel9File":case"Units":break;case"InterfaceHdr":case"Mms":case"InterfaceEnd":case"DSF":case"BuiltInFnGroupCount":break;case"Window1":case"HideObj":case"GridSet":case"Guts":case"UserBView":case"UserSViewBegin":case"UserSViewEnd":case"Pane":break;default:switch(U.n){case"Dat":case"Begin":case"End":case"StartBlock":case"EndBlock":case"Frame":case"Area":case"Axis":case"AxisLine":case"Tick":break;case"AxesUsed":case"CrtLayout12":case"CrtLayout12A":case"CrtLink":case"CrtLine":case"CrtMlFrt":case"CrtMlFrtContinue":break;case"LineFormat":case"AreaFormat":case"Chart":case"Chart3d":case"Chart3DBarShape":case"ChartFormat":case"ChartFrtInfo":break;case"PlotArea":case"PlotGrowth":break;case"SeriesList":case"SerParent":case"SerAuxTrend":break;case"DataFormat":case"SerToCrt":case"FontX":break;case"CatSerRange":case"AxcExt":case"SerFmt":case"ShtProps":break;case"DefaultText":case"Text":case"CatLab":case"DataLabExtContents":break;case"Legend":case"LegendException":break;case"Pie":case"Scatter":break;case"PieFormat":case"MarkerFormat":break;case"StartObject":case"EndObject":break;case"AlRuns":case"ObjectLink":case"SIIndex":break;case"AttachedLabel":case"YMult":break;case"Line":case"Bar":case"Surf":case"AxisParent":case"Pos":case"ValueRange":case"SXViewEx9":case"SXViewLink":case"PivotChartBits":case"SBaseRef":case"TextPropsStream":case"LnExt":case"MkrExt":case"CrtCoopt":break;case"Qsi":case"Qsif":case"Qsir":case"QsiSXTag":case"TxtQry":case"FilterMode":break;case"AutoFilter":case"AutoFilterInfo":case"AutoFilter12":case"DropDownObjIds":case"Sort":case"SortData":case"ShapePropsStream":break;case"MsoDrawing":case"MsoDrawingGroup":case"MsoDrawingSelection":break;case"WebPub":case"AutoWebPub":break;case"HeaderFooter":case"HFPicture":case"PLV":case"HorizontalPageBreaks":case"VerticalPageBreaks":break;case"Backup":case"CompressPictures":case"Compat12":break;case"Continue":case"ContinueFrt12":break;case"FrtFontList":case"FrtWrapper":break;default:switch(U.n){case"TabIdConf":case"Radar":case"RadarArea":case"DropBar":case"Intl":case"CoordList":case"SerAuxErrBar":break;case"BIFF2FONTCLR":case"BIFF2FMTCNT":case"BIFF2FONTXTRA":break;case"BIFF2XF":case"BIFF3XF":case"BIFF4XF":break;case"BIFF4FMTCNT":case"BIFF2ROW":case"BIFF2WINDOW2":break;case"SCENARIO":case"DConBin":case"PicF":case"DataLabExt":case"Lel":case"BopPop":case"BopPopCustom":case"RealTimeData":case"Name":break;case"LHNGraph":case"FnGroupName":case"AddMenu":case"LPr":break;case"ListObj":case"ListField":case"RRSort":case"BigName":break;case"ToolbarHdr":case"ToolbarEnd":case"DDEObjName":case"FRTArchId$":break;default:if(t.WTF)throw"Unrecognized Record "+U.n}}}}}else e.l+=$}return n.SheetNames=ce(u).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return u[e].name}),t.bookSheets||(n.Sheets=i),n.Sheets&&N.forEach(function(e,t){n.Sheets[n.SheetNames[t]]["!autofilter"]=e}),n.Preamble=m,n.Strings=f,n.SSF=aa.get_table(),E.enc&&(n.Encryption=E.enc),k&&(n.Themes=k),n.Metadata={},void 0!==l&&(n.Metadata.Country=l),0<M.names.length&&(w.Names=M.names),n.Workbook=w,n}function Yi(e,t){var n,i,r,a,s;if(Xu(t=t||{}),c(),t.codepage&&Ur(t.codepage),e.FullPaths){if(da.find(e,"/encryption"))throw new Error("File is password-protected");n=da.find(e,"!CompObj"),r=da.find(e,"/Workbook")||da.find(e,"/Book")}else{switch(t.type){case"base64":e=ta(qr.decode(e));break;case"binary":e=ta(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}ue(e,0),r={content:e}}if(n&&Hi(n),t.bookProps&&!t.bookSheets)i={};else{var o=Qr?"buffer":"array";if(r&&r.content)i=ji(r.content,t);else if((r=da.find(e,"PerfectOffice_MAIN"))&&r.content)i=Yo.to_workbook(r.content,(t.type=o,t));else{if(!(r=da.find(e,"NativeContent_MAIN"))||!r.content)throw new Error("Cannot find Workbook stream");i=Yo.to_workbook(r.content,(t.type=o,t))}t.bookVBA&&e.FullPaths&&da.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=(a=e,s=da.utils.cfb_new({root:"R"}),a.FullPaths.forEach(function(e,t){"/"!==e.slice(-1)&&e.match(/_VBA_PROJECT_CUR/)&&(e=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,""),da.utils.cfb_add(s,e,a.FileIndex[t].content))}),da.write(s)))}o={};return e.FullPaths&&function(e,t,n){var i=da.find(e,"!DocumentSummaryInformation");if(i&&0<i.size)try{var r,a=nt(i,Os,Pu.DSI);for(r in a)t[r]=a[r]}catch(e){if(n.WTF)throw e}if((i=da.find(e,"!SummaryInformation"))&&0<i.size)try{var s,o=nt(i,Ns,Pu.SI);for(s in o)null==t[s]&&(t[s]=o[s])}catch(e){if(n.WTF)throw e}t.HeadingPairs&&t.TitlesOfParts&&(Ve(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}function Ki(e,t){var n,i,r=t||{},t=da.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return da.utils.cfb_add(t,a,sr(e,r)),8==r.biff&&(e.Props||e.Custprops)&&function(e,t){var n,i=[],r=[],a=[],s=0;if(e.Props)for(n=ce(e.Props),s=0;s<n.length;++s)(Vs.hasOwnProperty(n[s])?i:$s.hasOwnProperty(n[s])?r:a).push([n[s],e.Props[n[s]]]);if(e.Custprops)for(n=ce(e.Custprops),s=0;s<n.length;++s)(e.Props||{}).hasOwnProperty(n[s])||(Vs.hasOwnProperty(n[s])?i:$s.hasOwnProperty(n[s])?r:a).push([n[s],e.Custprops[n[s]]]);for(var o=[],s=0;s<a.length;++s)-1<po.indexOf(a[s][0])||null!=a[s][1]&&o.push(a[s]);r.length&&da.utils.cfb_add(t,"/SummaryInformation",it(r,Pu.SI,$s,Ns)),(i.length||o.length)&&da.utils.cfb_add(t,"/DocumentSummaryInformation",it(i,Pu.DSI,Vs,Os,o.length?o:null,Pu.UDI))}(e,t),8==r.biff&&e.vbaraw&&(n=t,(i=da.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})).FullPaths.forEach(function(e,t){0==t||"/"!==(e=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/")).slice(-1)&&da.utils.cfb_add(n,e,i.FileIndex[t].content)})),t}function Zi(e,t,n,i){var r=+t||+Bu[t];isNaN(r)||(t=i||(n||[]).length||0,(i=e.next(4))._W(2,r),i._W(2,t),0<t&&ms(n)&&e.push(n))}function qi(e,t,n){return(e=e||Q(7))._W(2,t),e._W(2,n),e._W(2,0),e._W(1,0),e}function Qi(e,t,n,i){if(null!=t.v)switch(t.t){case"d":case"n":var r="d"==t.t?G(te(t.v)):t.v;return r==(0|r)&&0<=r&&r<65536?Zi(e,2,(u=n,h=i,d=r,qi(f=Q(9),u,h),f._W(2,d),f)):Zi(e,3,(d=n,f=i,r=r,qi(c=Q(15),d,f),c._W(8,r,"f"),c)),0;case"b":case"e":return Zi(e,5,(c=n,a=i,s=t.v,o=t.t,qi(l=Q(9),c,a),"e"==o?(l._W(1,s),l._W(1,1)):(l._W(1,s?1:0),l._W(1,0)),l)),0;case"s":case"str":return Zi(e,4,(a=n,o=i,s=t.v,qi(l=Q(8+2*s.length),a,o),l._W(1,s.length),l._W(s.length,s,"sbcs"),l.l<l.length?l.slice(0,l.l):l)),0}var a,s,o,l,c,u,h,d,f;Zi(e,1,qi(null,n,i))}function Ji(e,t){var n=t||{};null!=Zr&&null==n.dense&&(n.dense=Zr);for(var t=y(),i=0,r=0;r<e.SheetNames.length;++r)e.SheetNames[r]==n.sheet&&(i=r);if(0==i&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Zi(t,9,Rt(0,16,n)),function(e,t,n){var i=Array.isArray(t),r=oe(t["!ref"]||"A1"),a=[];if(255<r.e.c||16383<r.e.r){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");r.e.c=Math.min(r.e.c,255),r.e.r=Math.min(r.e.c,16383),c=de(r)}for(var s=r.s.r;s<=r.e.r;++s)for(var o=ae(s),l=r.s.c;l<=r.e.c;++l){s===r.s.r&&(a[l]=se(l));var c=a[l]+o,u=i?(t[s]||[])[l]:t[c];u&&Qi(e,u,s,l)}}(t,e.Sheets[e.SheetNames[i]],n),Zi(t,10),t.end()}function er(e,t,n){var i,r;Zi(e,"Font",(r=(i={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(e=Q((n=(e=n)&&5==e.biff)?15+r.length:16+2*r.length))._W(2,20*(i.sz||12)),e._W(4,0),e._W(2,400),e._W(4,0),e._W(2,0),e._W(1,r.length),n||e._W(1,1),e._W((n?1:2)*r.length,r,n?"sbcs":"utf16le"),e))}function tr(s,o,l){o&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t,n,i,r,a=e[0];a<=e[1];++a)null!=o[a]&&Zi(s,"Format",(n=o[t=a],r=void 0,i=(i=l)&&5==i.biff,(r=r||Q(i?3+n.length:5+2*n.length))._W(2,t),r._W(i?1:2,n.length),i||r._W(1,1),r._W((i?1:2)*n.length,n,i?"sbcs":"utf16le"),null==(r=r.length>r.l?r.slice(0,r.l):r).l&&(r.l=r.length),r))})}function nr(e,t){for(var n=0;n<t["!links"].length;++n){var i=t["!links"][n];Zi(e,"HLink",Nt(i)),i[1].Tooltip&&Zi(e,"HLinkTooltip",function(e){var t=e[1].Tooltip,n=Q(10+2*(t.length+1));n._W(2,2048),e=j(e[0]),n._W(2,e.r),n._W(2,e.r),n._W(2,e.c),n._W(2,e.c);for(var i=0;i<t.length;++i)n._W(2,t.charCodeAt(i));return n._W(2,0),n}(i))}delete t["!links"]}function ir(e,t,n,i,r){var a,s,o,l,c,u,h=16+Jn(r.cellXfs,t,r);if(null==t.v&&!t.bf)return Zi(e,"Blank",yt(n,i,h)),0;if(t.bf)Zi(e,"Formula",Gn(t,n,i,0,h));else switch(t.t){case"d":case"n":Zi(e,"Number",(s=n,o=i,l="d"==t.t?G(te(t.v)):t.v,c=h,u=Q(14),yt(s,o,c,u),Ae(l,u),u));break;case"b":case"e":Zi(e,517,Dt(n,i,t.v,h,0,t.t));break;case"s":case"str":Zi(e,"Label",(a=n,s=i,o=t.v,c=h,l=Q(+(u=!(l=r)||8==l.biff)+8+(1+u)*o.length),yt(a,s,c,l),l._W(2,o.length),u&&l._W(1,1),l._W((1+u)*o.length,o,u?"utf16le":"sbcs"),l));break;default:Zi(e,"Blank",yt(n,i,h))}}function rr(e,t,n){var i=y(),r=n.SheetNames[e],a=n.Sheets[r]||{},s=(n||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(a),c=8==t.biff,u=[],h=oe(a["!ref"]||"A1"),d=c?65536:16384;if(255<h.e.c||h.e.r>=d){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,d-1)}Zi(i,2057,Rt(0,16,t)),Zi(i,"CalcMode",lt(1)),Zi(i,"CalcCount",lt(100)),Zi(i,"CalcRefMode",st(!0)),Zi(i,"CalcIter",st(!1)),Zi(i,"CalcDelta",Ae(.001)),Zi(i,"CalcSaveRecalc",st(!0)),Zi(i,"PrintRowCol",st(!1)),Zi(i,"PrintGrid",st(!1)),Zi(i,"GridSet",lt(1)),Zi(i,"Guts",(n=[0,0],(e=Q(8))._W(4,0),e._W(2,n[0]?n[0]+1:0),e._W(2,n[1]?n[1]+1:0),e)),Zi(i,"HCenter",st(!1)),Zi(i,"VCenter",st(!1)),Zi(i,512,(d=h,(n=Q(2*(e=8!=(n=t).biff&&n.biff?2:4)+6))._W(e,d.s.r),n._W(e,d.e.r+1),n._W(2,d.s.c),n._W(2,d.e.c+1),n._W(2,0),n)),c&&(a["!links"]=[]);for(var f=h.s.r;f<=h.e.r;++f)for(var p=ae(f),m=h.s.c;m<=h.e.c;++m){f===h.s.r&&(u[m]=se(m));var g=u[m]+p,v=l?(a[f]||[])[m]:a[g];v&&(ir(i,v,f,m,t),c&&v.l&&a["!links"].push([g,v.l]))}var b,S,r=o.CodeName||o.name||r;return c&&s.Views&&Zi(i,"Window2",(s=s.Views[0],b=Q(18),S=1718,s&&s.RTL&&(S|=64),b._W(2,S),b._W(4,0),b._W(4,64),b._W(4,0),b._W(4,0),b)),c&&(a["!merges"]||[]).length&&Zi(i,"MergeCells",function(e){var t=Q(2+8*e.length);t._W(2,e.length);for(var n=0;n<e.length;++n)_t(e[n],t);return t}(a["!merges"])),c&&nr(i,a),Zi(i,"CodeName",pt(r)),c&&(S=i,b=a,(r=Q(19))._W(4,2151),r._W(4,0),r._W(4,0),r._W(2,3),r._W(1,1),r._W(4,0),Zi(S,"FeatHdr",r),(r=Q(39))._W(4,2152),r._W(4,0),r._W(4,0),r._W(2,3),r._W(1,0),r._W(4,0),r._W(2,1),r._W(4,4),r._W(2,0),_t(oe(b["!ref"]||"A1"),r),r._W(4,4),Zi(S,"Feat",r)),Zi(i,"EOF"),i.end()}function ar(e,t,n){var i=y(),r=(e||{}).Workbook||{},a=r.Sheets||[],s=r.WBProps||{},o=8==n.biff,r=5==n.biff;Zi(i,2057,Rt(0,5,n)),"xla"==n.bookType&&Zi(i,"Addin"),Zi(i,"InterfaceHdr",o?lt(1200):null),Zi(i,"Mms",function(e,t){t=t||Q(e);for(var n=0;n<e;++n)t._W(1,0);return t}(2)),r&&Zi(i,"ToolbarHdr"),r&&Zi(i,"ToolbarEnd"),Zi(i,"InterfaceEnd"),Zi(i,"WriteAccess",function(e){var t=!e||8==e.biff,n=Q(t?112:54);for(n._W(8==e.biff?2:1,7),t&&n._W(1,0),n._W(4,859007059),n._W(4,5458548|(t?0:536870912));n.l<n.length;)n._W(1,t?0:32);return n}(n)),Zi(i,"CodePage",lt(o?1200:1252)),o&&Zi(i,"DSF",lt(0)),o&&Zi(i,"Excel9File"),Zi(i,"RRTabId",function(e){for(var t=Q(2*e),n=0;n<e;++n)t._W(2,n+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&Zi(i,"ObProj"),o&&e.vbaraw&&Zi(i,"CodeName",pt(s.CodeName||"ThisWorkbook")),Zi(i,"BuiltInFnGroupCount",lt(17)),Zi(i,"WinProtect",st(!1)),Zi(i,"Protect",st(!1)),Zi(i,"Password",lt(0)),o&&Zi(i,"Prot4Rev",st(!1)),o&&Zi(i,"Prot4RevPass",lt(0)),Zi(i,"Window1",((r=Q(18))._W(2,0),r._W(2,0),r._W(2,29280),r._W(2,17600),r._W(2,56),r._W(2,0),r._W(2,0),r._W(2,1),r._W(2,500),r)),Zi(i,"Backup",st(!1)),Zi(i,"HideObj",lt(0)),Zi(i,"Date1904",st("true"==((s=e).Workbook&&s.Workbook.WBProps&&re(s.Workbook.WBProps.date1904)?"true":"false"))),Zi(i,"CalcPrecision",st(!0)),o&&Zi(i,"RefreshAll",st(!1)),Zi(i,"BookBool",lt(0)),er(i,0,n),tr(i,e.SSF,n),function(t,n){for(var e=0;e<16;++e)Zi(t,"XF",Bt({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(e){Zi(t,"XF",Bt(e,0,n))})}(i,n),o&&Zi(i,"UsesELFs",st(!1));r=i.end(),s=y();o&&Zi(s,"Country",((g=g||Q(4))._W(2,1),g._W(2,1),g)),Zi(s,"EOF");for(var i=s.end(),l=y(),c=0,u=0,u=0;u<e.SheetNames.length;++u)c+=(o?12:11)+(o?2:1)*e.SheetNames[u].length;var h,d,f,p,m=r.length+c+i.length;for(u=0;u<e.SheetNames.length;++u)Zi(l,"BoundSheet8",(h={pos:m,hs:(a[u]||{}).Hidden||0,dt:0,name:e.SheetNames[u]},p=f=void 0,f=!(d=n)||8<=d.biff?2:1,(p=Q(8+f*h.name.length))._W(4,h.pos),p._W(1,h.hs||0),p._W(1,h.dt),p._W(1,h.name.length),8<=d.biff&&p._W(1,1),p._W(f*h.name.length,h.name,d.biff<8?"sbcs":"utf16le"),(d=p.slice(0,p.l)).l=p.l,d)),m+=t[u].length;var g=l.end();if(c!=g.length)throw new Error("BS8 "+c+" != "+g.length);s=[];return r.length&&s.push(r),g.length&&s.push(g),i.length&&s.push(i),qa([s])}function sr(e,t){var n=t||{};switch(n.biff||2){case 8:case 5:return function(e,t){var n=t||{},i=[];e&&!e.SSF&&(e.SSF=aa.get_table()),e&&e.SSF&&(sa(aa),aa.load_table(e.SSF),n.revssf=x(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Gu(n),n.cellXfs=[],Jn(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var r=0;r<e.SheetNames.length;++r)i[i.length]=rr(r,n,e);return i.unshift(ar(e,i,n)),qa([i])}(e,t);case 4:case 3:case 2:return Ji(e,t)}throw new Error("invalid type "+n.bookType+" for BIFF")}function or(e,t){var n=t||{};null!=Zr&&(n.dense=Zr);for(var i,r,a=n.dense?[]:{},s=e.getElementsByTagName("tr"),o=n.sheetRows||1e7,l={s:{r:0,c:0},e:{r:0,c:0}},c=[],u=0,h=[],d=0,f=0,p=0,m=0;d<s.length&&f<o;++d){var g=s[d];if(lr(g)){if(n.display)continue;h[f]={hidden:!0}}for(var v=g.children,p=m=0;p<v.length;++p){var b=v[p];if(!n.display||!lr(b)){for(var S=Ha(b.innerHTML),u=0;u<c.length;++u){var y=c[u];y.s.c==m&&y.s.r<=f&&f<=y.e.r&&(m=y.e.c+1,u=-1)}r=+b.getAttribute("colspan")||1,(0<(i=+b.getAttribute("rowspan"))||1<r)&&c.push({s:{r:f,c:m},e:{r:f+(i||1)-1,c:m+r-1}});var x={t:"s",v:S},b=b.getAttribute("t")||"";null!=S&&(0==S.length?x.t=b||"z":n.raw||0==S.trim().length||"s"==b||("TRUE"===S?x={t:"b",v:!0}:"FALSE"===S?x={t:"b",v:!1}:isNaN(_(S))?isNaN(C(S).getDate())||(x={t:"d",v:te(S)},(x=!n.cellDates?{t:"n",v:G(x.v)}:x).z=n.dateNF||aa._table[14]):x={t:"n",v:_(S)})),n.dense?(a[f]||(a[f]=[]),a[f][m]=x):a[he({c:m,r:f})]=x,l.e.c<m&&(l.e.c=m),m+=r}}++f}return c.length&&(a["!merges"]=c),h.length&&(a["!rows"]=h),l.e.r=f-1,a["!ref"]=de(l),o<=f&&(a["!fullref"]=de((l.e.r=s.length-d+f-1,l))),a}function lr(e){var t,n="",t=(t=e).ownerDocument.defaultView&&"function"==typeof t.ownerDocument.defaultView.getComputedStyle?t.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null;return"none"===(n=(n=t?t(e).getPropertyValue("display"):n)||e.style.display)}function cr(e,t){t=t||{};var n=!!A(e,"objectdata");n&&function(e,t){for(var n,i,r=Li(e);n=ku.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if("/"==(i=ie(n[0],!1)).path&&i.type!==to)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}(T(e,"META-INF/manifest.xml"),t);var i=B(e,"content.xml");if(!i)throw new Error("Missing content.xml in "+(n?"ODS":"UOF")+" file");t=Du(n?i:La(i),t);return A(e,"meta.xml")&&(t.Props=ze(T(e,"meta.xml"))),t}function ur(e,t){return Du(e,t)}function hr(e,t){if("fods"==t.bookType)return Lu(e,t);var n=E(),i=[],r=[];return w(n,"mimetype","application/vnd.oasis.opendocument.spreadsheet"),w(n,"content.xml",Lu(e,t)),i.push(["content.xml","text/xml"]),r.push(["content.xml","ContentFile"]),w(n,"styles.xml",Iu(e,t)),i.push(["styles.xml","text/xml"]),r.push(["styles.xml","StylesFile"]),w(n,"meta.xml",no()),i.push(["meta.xml","text/xml"]),r.push(["meta.xml","MetadataFile"]),w(n,"manifest.rdf",function(e){var t=[Sa];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var n=0;n!=e.length;++n)t.push(Ne(e[n][0],e[n][1])),t.push(['  <rdf:Description rdf:about="">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e[n][0]+'"/>\n',"  </rdf:Description>\n"].join(""));return t.push(Ne("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(r)),i.push(["manifest.rdf","application/rdf+xml"]),w(n,"META-INF/manifest.xml",function(e){var t=[Sa];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(i)),n}function dr(i){return function(e,t){var n=function(e,t){if(!t)return 0;if(-1==(e=e.SheetNames.indexOf(t)))throw new Error("Sheet not found: "+t);return e}(e,t.sheet);return i.from_sheet(e.Sheets[e.SheetNames[n]],t,e)}}function fr(i){return function(e){for(var t=0;t!=i.length;++t){var n=i[t];void 0===e[n[0]]&&(e[n[0]]=n[1]),"n"===n[2]&&(e[n[0]]=Number(e[n[0]]))}}}function pr(t,e){if(!t)return 0;try{t=e.map(function(e){return e.id||(e.id=e.strRelID),[e.name,t["!id"][e.id].Target,(e=t["!id"][e.id].Type,-1<qs.WS.indexOf(e)?"sheet":qs.CS&&e==qs.CS?"chart":qs.DS&&e==qs.DS?"dialog":qs.MS&&e==qs.MS?"macro":e&&e.length?e:"sheet")]})}catch(t){return null}return t&&0!==t.length?t:null}function mr(t,n,e,s,i,o,r,a,l,c,u,h){try{o[s]=Le(B(t,e,!0),n);var d=T(t,n);switch(a){case"sheet":v=ki(d,n,i,l,o[s],c,u,h);break;case"chart":if(!(v=Pi(d,n,i,l,o[s],c))||!v["!drawel"])break;var f=k(v["!drawel"].Target,n),p=Ie(f),m=k((S=B(t,f,!0),y=Le(B(t,p,!0),f),S?(S=(S.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],y["!id"][S].Target):"??"),f),g=Ie(m),v=mi(B(t,m,!0),0,0,Le(B(t,g,!0),m),0,v);break;case"macro":o[s],n.slice(-4),v={"!type":"macro"};break;case"dialog":o[s],n.slice(-4),v={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+a)}r[s]=v;var b;o&&o[s]&&ce(o[s]).forEach(function(e){var i,r,a;o[s][e].Type==qs.CMNT&&(e=k(o[s][e].Target,n),(b=Ti(T(t,e,!0),e,l))&&b.length&&(i=v,e=b,a=Array.isArray(i),e.forEach(function(e){var t=j(e.ref);(r=a?(i[t.r]||(i[t.r]=[]),i[t.r][t.c]):i[e.ref])||(r={t:"z"},a?i[t.r][t.c]=r:i[e.ref]=r,(n=oe(i["!ref"]||"BDWGO1000001:A1")).s.r>t.r&&(n.s.r=t.r),n.e.r<t.r&&(n.e.r=t.r),n.s.c>t.c&&(n.s.c=t.c),n.e.c<t.c&&(n.e.c=t.c),(n=de(n))!==i["!ref"]&&(i["!ref"]=n)),r.c||(r.c=[]);var n={a:e.author,t:e.t,r:e.r};e.h&&(n.h=e.h),r.c.push(n)})))})}catch(t){if(l.WTF)throw t}var S,y}function gr(e){return"/"==e.charAt(0)?e.slice(1):e}function vr(t,n){if(sa(aa),Xu(n=n||{}),A(t,"META-INF/manifest.xml"))return cr(t,n);if(A(t,"objectdata.xml"))return cr(t,n);if(A(t,"Index/Document.iwa"))throw new Error("Unsupported NUMBERS file");var e=function(e){for(var t=e.FullPaths||ce(e.files),n=[],i=0;i<t.length;++i)"/"!=t[i].slice(-1)&&n.push(t[i]);return n.sort()}(t),i=function(e){var n=Me();if(!e||!e.match)return n;var i={};if((e.match(xa)||[]).forEach(function(e){var t=ie(e);switch(t[0].replace(Ea,"<")){case"<?xml":break;case"<Types":n.xmlns=t["xmlns"+(t[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":i[t.Extension]=t.ContentType;break;case"<Override":void 0!==n[Gs[t.ContentType]]&&n[Gs[t.ContentType]].push(t.PartName)}}),n.xmlns!==Ka.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=0<n.calcchains.length?n.calcchains[0]:"",n.sst=0<n.strs.length?n.strs[0]:"",n.style=0<n.styles.length?n.styles[0]:"",n.defaults=i,delete n.calcchains,n}(B(t,"[Content_Types].xml")),r=!1;if(0===i.workbooks.length&&(T(t,d="xl/workbook.xml",!0)&&i.workbooks.push(d)),0===i.workbooks.length){if(!T(t,d="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(d),r=!0}"bin"==i.workbooks[0].slice(-3)&&(r=!0);var a={},s={};if(!n.bookSheets&&!n.bookProps){if(Fc=[],i.sst)try{Fc=Ai(T(t,gr(i.sst)),i.sst,n)}catch(t){if(n.WTF)throw t}n.cellStyles&&i.themes.length&&(f=B(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],a=wn(f,n)),i.style&&(s=Ri(T(t,gr(i.style)),i.style,a,n))}i.links.map(function(e){try{Le(B(t,Ie(gr(e))),e);return Mi(T(t,gr(e)),0,e,n)}catch(e){}});var o,l,c,u=Ei(T(t,gr(i.workbooks[0])),i.workbooks[0],n),h={},d="";i.coreprops.length&&((d=T(t,gr(i.coreprops[0]),!0))&&(h=ze(d)),0!==i.extprops.length&&(d=T(t,gr(i.extprops[0]),!0))&&(p=n,c={},l=(l=h)||{},o=La(o=d),so.forEach(function(e){var t=(o.match(Ua(e[0]))||[])[1];switch(e[2]){case"string":l[e[1]]=Aa(t||"");break;case"bool":l[e[1]]="true"===t;break;case"raw":var n=o.match(new RegExp("<"+e[0]+"[^>]*>([\\s\\S]*?)</"+e[0]+">"));n&&0<n.length&&(c[e[1]]=n[1])}}),c.HeadingPairs&&c.TitlesOfParts&&Ve(c.HeadingPairs,c.TitlesOfParts,l,p)));var f={};n.bookSheets&&!n.bookProps||0!==i.custprops.length&&(d=B(t,gr(i.custprops[0]),!0))&&(f=function(e,t){var n={},i="",r=e.match(co);if(r)for(var a=0;a!=r.length;++a){var s=r[a],o=ie(s);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":i=Aa(o.name);break;case"</property>":i=null;break;default:if(0===s.indexOf("<vt:")){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":n[i]=Aa(u);break;case"bool":n[i]=re(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[i]=parseInt(u,10);break;case"r4":case"r8":case"decimal":n[i]=parseFloat(u);break;case"filetime":case"date":n[i]=te(u);break;case"cy":case"error":n[i]=Aa(u);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",s,c,l)}}else if("</"!==s.slice(0,2)&&t.WTF)throw new Error(s)}}return n}(d,n));var p={};if((n.bookSheets||n.bookProps)&&(u.Sheets?m=u.Sheets.map(function(e){return e.name}):h.Worksheets&&0<h.SheetNames.length&&(m=h.SheetNames),n.bookProps&&(p.Props=h,p.Custprops=f),n.bookSheets&&void 0!==m&&(p.SheetNames=m),n.bookSheets?p.SheetNames:n.bookProps))return p;var m={},d={};n.bookDeps&&i.calcchain&&(d=Bi(T(t,gr(i.calcchain)),i.calcchain));var g,v,b=0,S={},y=u.Sheets;h.Worksheets=y.length,h.SheetNames=[];for(var x=0;x!=y.length;++x)h.SheetNames[x]=y[x].name;var w=r?"bin":"xml",r=i.workbooks[0].lastIndexOf("/"),_=(i.workbooks[0].slice(0,r+1)+"_rels/"+i.workbooks[0].slice(r+1)+".rels").replace(/^\//,"");A(t,_)||(_="xl/_rels/workbook."+w+".rels");var C=(C=Le(B(t,_,!0),_))&&pr(C,u.Sheets),E=T(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=h.Worksheets;++b){var k="sheet";if(C&&C[b]?(g="xl/"+C[b][1].replace(/[\/]?xl\//,""),A(t,g)||(g=C[b][1]),A(t,g)||(g=_.replace(/_rels\/.*$/,"")+C[b][1]),k=C[b][2]):g=(g="xl/worksheets/sheet"+(b+1-E)+"."+w).replace(/sheet0\./,"sheet."),v=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&null!=n.sheets)switch(typeof n.sheets){case"number":if(b!=n.sheets)continue e;break;case"string":if(h.SheetNames[b].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var P=!1,R=0;R!=n.sheets.length;++R)"number"==typeof n.sheets[R]&&n.sheets[R]==b&&(P=1),"string"==typeof n.sheets[R]&&n.sheets[R].toLowerCase()==h.SheetNames[b].toLowerCase()&&(P=1);if(!P)continue e}}mr(t,g,v,h.SheetNames[b],b,S,m,k,n,u,a,s)}return p={Directory:i,Workbook:u,Props:h,Custprops:f,Deps:d,Sheets:m,SheetNames:h.SheetNames,Strings:Fc,Styles:s,Themes:a,SSF:aa.get_table()},n&&n.bookFiles&&(p.keys=e,p.files=t.files),n&&n.bookVBA&&(0<i.vba.length?p.vbaraw=T(t,gr(i.vba[0]),!0):i.defaults&&i.defaults.bin===oc&&(p.vbaraw=T(t,"xl/vbaProject.bin",!0))),p}function br(e,t){var n,i,r=t||{},a="Workbook",t=da.find(e,a);try{if(a="/!DataSpaces/Version",!(t=da.find(e,a))||!t.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(n=t.content,(i={}).id=n._R(0,"lpp4"),i.R=Ht(n,4),i.U=Ht(n,4),i.W=Ht(n,4),a="/!DataSpaces/DataSpaceMap",!(t=da.find(e,a))||!t.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=Xt(t.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(t=da.find(e,a))||!t.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=function(e){var t=[];e.l+=4;for(var n=e._R(4);0<n--;)t.push(e._R(0,"lpp4"));return t}(t.content);if(1!=o.length||"StrongEncryptionTransform"!=o[0])throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(t=da.find(e,a))||!t.content)throw new Error("ECMA-376 Encrypted file missing "+a);Gt(t.content)}catch(e){}if(!(t=da.find(e,a="/EncryptionInfo"))||!t.content)throw new Error("ECMA-376 Encrypted file missing "+a);o=Kt(t.content),a="/EncryptedPackage";if(!(t=da.find(e,a))||!t.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(4==o[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(o[1],t.content,r.password||"",r);if(2==o[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(o[1],t.content,r.password||"",r);throw new Error("File is password-protected")}function Sr(e,t){if(rc=1024,"ods"==t.bookType)return hr(e,t);e&&!e.SSF&&(e.SSF=aa.get_table()),e&&e.SSF&&(sa(aa),aa.load_table(e.SSF),t.revssf=x(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",i=-1<lc.indexOf(t.bookType),r=Me();Gu(t=t||{});var a,s,o,l,c,u,h=E(),d="",f=0;if(t.cellXfs=[],Jn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),w(h,d="docProps/core.xml",function(e,t){var n=t||{},i=[Sa,ao],r={};if(!e&&!n.Props)return i.join("");e&&(null!=e.CreatedDate&&We("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:L(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r),null!=e.ModifiedDate&&We("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:L(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r));for(var a=0;a!=io.length;++a){var s=io[a],o=n.Props&&null!=n.Props[s[1]]?n.Props[s[1]]:e?e[s[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&We(s[0],o,null,i,r)}return 2<i.length&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}(e.Props,t)),r.coreprops.push(d),Oe(t.rels,2,d,qs.CORE_PROPS),d="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var p=[],m=0;m<e.SheetNames.length;++m)2!=(e.Workbook.Sheets[m]||{}).Hidden&&p.push(e.SheetNames[m]);e.Props.SheetNames=p}else e.Props.SheetNames=e.SheetNames;for(e.Props.Worksheets=e.Props.SheetNames.length,w(h,d,(s=e.Props,o=[],l=I,(s=s||{}).Application="SheetJS",o[o.length]=Sa,o[o.length]=oo,so.forEach(function(e){if(void 0!==s[e[1]]){var t;switch(e[2]){case"string":t=P(String(s[e[1]]));break;case"bool":t=s[e[1]]?"true":"false"}void 0!==t&&(o[o.length]=l(e[0],t))}}),o[o.length]=l("HeadingPairs",l("vt:vector",l("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+l("vt:variant",l("vt:i4",String(s.Worksheets))),{size:2,baseType:"variant"})),o[o.length]=l("TitlesOfParts",l("vt:vector",s.SheetNames.map(function(e){return"<vt:lpstr>"+P(e)+"</vt:lpstr>"}).join(""),{size:s.Worksheets,baseType:"lpstr"})),2<o.length&&(o[o.length]="</Properties>",o[1]=o[1].replace("/>",">")),o.join(""))),r.extprops.push(d),Oe(t.rels,3,d,qs.EXT_PROPS),e.Custprops!==e.Props&&0<ce(e.Custprops||{}).length&&(w(h,d="docProps/custom.xml",$e(e.Custprops)),r.custprops.push(d),Oe(t.rels,4,d,qs.CUST_PROPS)),f=1;f<=e.SheetNames.length;++f){var g,v,b,S={"!id":{}},y=e.Sheets[e.SheetNames[f-1]];(y||{})["!type"],w(h,d="xl/worksheets/sheet"+f+"."+n,(v=f-1,g=t,b=e,a=S,(".bin"===d.slice(-4)?pi:ri)(v,g,b,a))),r.sheets.push(d),Oe(t.wbrels,-1,"worksheets/sheet"+f+"."+n,qs.WS[0]),y&&(v=!1,(g=y["!comments"])&&0<g.length&&(w(h,b="xl/comments"+f+"."+n,(a=g,g=t,(".bin"===b.slice(-4)?Pn:kn)(a,g))),r.comments.push(b),Oe(S,-1,"../comments"+f+"."+n,qs.CMNT),v=!0),y["!legacy"]&&v&&w(h,"xl/drawings/vmlDrawing"+f+".vml",function(e,t){for(var n=[21600,21600],i=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),r=[I("xml",null,{"xmlns:v":Za.v,"xmlns:o":Za.o,"xmlns:x":Za.x,"xmlns:mv":Za.mv}).replace(/\/>/,">"),I("o:shapelayout",I("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),I("v:shapetype",[I("v:stroke",null,{joinstyle:"miter"}),I("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:i})];rc<1e3*e;)rc+=1e3;return t.forEach(function(e){var t=j(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var i="gradient"==n.type?I("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,n=I("v:fill",i,n);++rc,r=r.concat(["<v:shape"+D({id:"_x0000_s"+rc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",n,I("v:shadow",null,{on:"t",obscured:"t"}),I("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",R("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),R("x:AutoFill","False"),R("x:Row",String(t.r)),R("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}(f,y["!comments"])),delete y["!comments"],delete y["!legacy"]),S["!id"].rId1&&w(h,Ie(d),Fe(S))}return null!=t.Strings&&0<t.Strings.length&&(w(h,d="xl/sharedStrings."+n,(c=t.Strings,u=t,(".bin"===d.slice(-4)?$t:Vt)(c,u))),r.strs.push(d),Oe(t.wbrels,-1,"sharedStrings."+n,qs.SST)),w(h,d="xl/workbook."+n,(c=e,u=t,(".bin"===d.slice(-4)?Ci:xi)(c,u))),r.workbooks.push(d),Oe(t.rels,1,d,qs.WB),w(h,d="xl/theme/theme1.xml",_n(e.Themes,t)),r.themes.push(d),Oe(t.wbrels,-1,"theme/theme1.xml",qs.THEME),w(h,d="xl/styles."+n,(c=e,u=t,(".bin"===d.slice(-4)?bn:cn)(c,u))),r.styles.push(d),Oe(t.wbrels,-1,"styles."+n,qs.STY),e.vbaraw&&i&&(w(h,d="xl/vbaProject.bin",e.vbaraw),r.vba.push(d),Oe(t.wbrels,-1,"vbaProject.bin",qs.VBA)),w(h,"[Content_Types].xml",De(r,t)),w(h,"_rels/.rels",Fe(t.rels)),w(h,"xl/_rels/workbook."+n+".rels",Fe(t.wbrels)),delete t.revssf,delete t.ssf,h}function yr(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3]];case"base64":n=qr.decode(e.slice(0,24));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3)]}function xr(e,t){var n=e,t=t||{};return t.type||(t.type=Qr&&Buffer.isBuffer(e)?"buffer":"base64"),vr(function(e,t){var n;if(fa)switch(t.type){case"base64":n=new fa(e,{base64:!0});break;case"binary":case"array":n=new fa(e,{base64:!1});break;case"buffer":n=new fa(e);break;default:throw new Error("Unrecognized type "+t.type)}else switch(t.type){case"base64":n=da.read(e,{type:"base64"});break;case"binary":n=da.read(e,{type:"binary"});break;case"buffer":case"array":n=da.read(e,{type:"buffer"});break;default:throw new Error("Unrecognized type "+t.type)}return n}(n,t),t)}function wr(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return Oi(e.slice(n),t);default:break e}return jo.to_workbook(e,t)}function _r(e,t,n,i){return i?(n.type="string",jo.to_workbook(e,n)):jo.to_workbook(t,n)}function Cr(e,t){if(c(),"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return Cr(new Uint8Array(e),t);var n,i,r,a=e,s=!1,o=t||{};if(o.cellStyles&&(o.cellNF=!0),Oc={},o.dateNF&&(Oc.dateNF=o.dateNF),o.type||(o.type=Qr&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==o.type&&(o.type=Qr?"buffer":"binary",a=function(e){if(void 0!==ha)return ha.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("Cannot access file "+e)}(e)),"string"==o.type&&(s=!0,o.type="binary",o.codepage=65001,a=(l=e).match(/[^\x00-\x7F]/)?Fa(l):l),"array"==o.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var l=new ArrayBuffer(3),l=new Uint8Array(l);if(l.foo="bar",!l.foo)return(o=ne(o)).type="array",Cr(u(a),o)}switch((n=yr(a,o))[0]){case 208:return i=da.read(a,o),r=o,(da.find(i,"EncryptedPackage")?br:Yi)(i,r);case 9:if(n[1]<=4)return Yi(a,o);break;case 60:return Oi(a,o);case 73:if(68===n[1])return function(e,t){var n=t||{},i=!!n.WTF;n.WTF=!0;try{var r=Ho.to_workbook(e,n);return n.WTF=i,r}catch(r){if(n.WTF=i,!r.message.match(/SYLK bad record ID/)&&i)throw r;return jo.to_workbook(e,t)}}(a,o);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return Xo.to_workbook(a,o);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?xr(a,o):_r(e,a,o,s);case 239:return 60===n[3]?Oi(a,o):_r(e,a,o,s);case 255:if(254===n[1])return i=a,"base64"==(r=o).type&&(i=qr.decode(i)),i=cptable.utils.decode(1200,i.slice(2),"str"),r.type="binary",wr(i,r);break;case 0:if(0===n[1]&&2<=n[2]&&0===n[3])return Yo.to_workbook(a,o);break;case 3:case 131:case 139:case 140:return Uo.to_workbook(a,o);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return Ol.to_workbook(a,o);break;case 10:case 13:case 32:return function(e,t){var n="",i=yr(e,t);switch(t.type){case"base64":n=qr.decode(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=h(e);break;default:throw new Error("Unrecognized type "+t.type)}return wr(n=239==i[0]&&187==i[1]&&191==i[2]?La(n):n,t)}(a,o)}return n[2]<=12&&n[3]<=31?Uo.to_workbook(a,o):_r(e,a,o,s)}function Er(e,t){t=t||{};return t.type="file",Cr(e,t)}function kr(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return o(t.file,da.write(e,{type:Qr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return da.write(e,t)}function Pr(e,t,n){var i=(n=n||"")+e;switch(t.type){case"base64":return qr.encode(Fa(i));case"binary":return Fa(i);case"string":return e;case"file":return o(t.file,i,"utf8");case"buffer":return Qr?Jr(i,"utf8"):Pr(i,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Rr(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",i=0;i<e.length;++i)n+=String.fromCharCode(e[i]);return"base64"==t.type?qr.encode(n):"string"==t.type?La(n):n;case"file":return o(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Ar(e,t){c(),yi(e);var n,i=t||{};if(i.cellStyles&&(i.cellNF=!0),"array"==i.type){i.type="binary";t=Ar(e,i);return i.type="array",r(t)}switch(i.bookType||"xlsb"){case"xml":case"xlml":return Pr(Ui(e,i),i);case"slk":case"sylk":return Pr(Nu(e,i),i);case"htm":case"html":return Pr(Fu(e,i),i);case"txt":return function(e,t){switch(t.type){case"base64":return qr.encode(e);case"binary":case"string":return e;case"file":return o(t.file,e,"binary");case"buffer":return Qr?Jr(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}($u(e,i),i);case"csv":return Pr(Ou(e,i),i,"\ufeff");case"dif":return Pr(zu(e,i),i);case"dbf":return Rr(Uu(e,i),i);case"prn":return Pr(Wu(e,i),i);case"rtf":return Pr(Vu(e,i),i);case"eth":return Pr(Hu(e,i),i);case"fods":return Pr(hr(e,i),i);case"biff2":i.biff||(i.biff=2);case"biff3":i.biff||(i.biff=3);case"biff4":return i.biff||(i.biff=4),Rr(sr(e,i),i);case"biff5":i.biff||(i.biff=5);case"biff8":case"xla":case"xls":return i.biff||(i.biff=8),kr(Ki(e,n=(n=i)||{}),n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"ods":return function(e,t){var n=t||{},e=Sr(e,n),i={};if(n.compression&&(i.compression="DEFLATE"),n.password)i.type=Qr?"nodebuffer":"string";else switch(n.type){case"base64":i.type="base64";break;case"binary":i.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":i.type=Qr?"nodebuffer":"string";break;default:throw new Error("Unrecognized type "+n.type)}return e=e.FullPaths?da.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[i.type]||i.type}):e.generate(i),n.password&&"undefined"!=typeof encrypt_agile?kr(encrypt_agile(e,n.password),n):"file"===n.type?o(n.file,e):"string"==n.type?La(e):e}(e,i);default:throw new Error("Unrecognized bookType |"+i.bookType+"|")}}function Tr(e){var t;e.bookType||((t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType)}function Br(e,t,n){n=n||{};return n.type="file",n.file=t,Tr(n),Ar(e,n)}function Mr(e,t,n,i,r,a,s,o){var l=ae(n),c=o.defval,u=o.raw||!o.hasOwnProperty("raw"),h=!0,d=1===r?[]:{};if(1!==r)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:n,enumerable:!1})}catch(e){d.__rowNum__=n}else d.__rowNum__=n;if(!s||e[n])for(var f=t.s.c;f<=t.e.c;++f){var p=s?e[n][f]:e[i[f]+l];if(void 0!==p&&void 0!==p.t){var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=a[f]){if(null==m)if(void 0!==c)d[a[f]]=c;else{if(!u||null!==m)continue;d[a[f]]=null}else d[a[f]]=u?m:fe(p,m,o);null!=m&&(h=!1)}}else void 0!==c&&null!=a[f]&&(d[a[f]]=c)}return{row:d,isempty:h}}function Dr(e,t){if(null==e||null==e["!ref"])return[];var n,i={t:"n",v:0},r=0,a=1,s=[],o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=oe(u);break;case"number":(l=oe(e["!ref"])).s.r=u;break;default:l=u}0<r&&(a=0);var h=ae(l.s.r),d=[],f=[],p=0,m=0,g=Array.isArray(e),v=l.s.r,b=0,S=0;for(g&&!e[v]&&(e[v]=[]),b=l.s.c;b<=l.e.c;++b)switch(d[b]=se(b),i=g?e[v][b]:e[d[b]+h],r){case 1:s[b]=b-l.s.c;break;case 2:s[b]=d[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:for(o=n=fe(i=null==i?{w:"__EMPTY",t:"s"}:i,null,c),S=m=0;S<s.length;++S)s[S]==o&&(o=n+"_"+ ++m);s[b]=o}for(v=l.s.r+a;v<=l.e.r;++v){var y=Mr(e,l,v,d,r,s,g,c);!1!==y.isempty&&(1===r?!1===c.blankrows:!c.blankrows)||(f[p++]=y.row)}return f.length=p,f}function Ir(e,t,n,i,r,a,s,o){for(var l=!0,c=[],u="",h=ae(n),d=t.s.c;d<=t.e.c;++d)if(i[d]){var f=o.dense?(e[n]||[])[d]:e[i[d]+h];if(null==f)u="";else if(null!=f.v){for(var p,l=!1,u=""+fe(f,null,o),m=0;m!==u.length;++m)if((p=u.charCodeAt(m))===r||p===a||34===p){u='"'+u.replace(ju,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(l=!1,0<=(u="="+f.f).indexOf(",")&&(u='"'+u.replace(ju,'""')+'"'));c.push(u)}return!1===o.blankrows&&l?null:c.join(s)}function Lr(e,t){var n=[],i=null==t?{}:t;if(null==e||null==e["!ref"])return"";var r=oe(e["!ref"]),a=void 0!==i.FS?i.FS:",",s=a.charCodeAt(0),o=void 0!==i.RS?i.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==a?"\\|":a)+"+$"),u="",h=[];i.dense=Array.isArray(e);for(var d=i.skipHidden&&e["!cols"]||[],f=i.skipHidden&&e["!rows"]||[],p=r.s.c;p<=r.e.c;++p)(d[p]||{}).hidden||(h[p]=se(p));for(var m=r.s.r;m<=r.e.r;++m)(f[m]||{}).hidden||null!=(u=Ir(e,r,m,h,s,l,a,i))&&(i.strip&&(u=u.replace(c,"")),n.push(u+o));return delete i.dense,n.join("")}function Fr(e,t){(t=t||{}).FS="\t",t.RS="\n";e=Lr(e,t);if("undefined"==typeof cptable||"string"==t.type)return e;e=cptable.utils.encode(1200,e,"str");return String.fromCharCode(255)+String.fromCharCode(254)+e}function Or(e){var t,n="",i="";if(null==e||null==e["!ref"])return[];for(var r,a=oe(e["!ref"]),s=[],o=[],l=Array.isArray(e),c=a.s.c;c<=a.e.c;++c)s[c]=se(c);for(var u=a.s.r;u<=a.e.r;++u)for(r=ae(u),c=a.s.c;c<=a.e.c;++c)if(n=s[c]+r,i="",void 0!==(t=l?(e[u]||[])[c]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;i=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)i=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)i=""+t.v;else if("b"==t.t)i=t.v?"TRUE":"FALSE";else if(void 0!==t.w)i="'"+t.w;else{if(void 0===t.v)continue;i="s"==t.t?"'"+t.v:""+t.v}}o[o.length]=n+"="+i}return o}function Nr(e,t,n){var s=n||{},o=+!s.skipHeader,l=e||{},c=0,u=0;l&&null!=s.origin&&("number"==typeof s.origin?c=s.origin:(i="string"==typeof s.origin?j(s.origin):s.origin,c=i.r,u=i.c));var h,i,e={s:{c:0,r:0},e:{c:u,r:c+t.length-1+o}};l["!ref"]&&(i=oe(l["!ref"]),e.e.c=Math.max(e.e.c,i.e.c),e.e.r=Math.max(e.e.r,i.e.r),-1==c&&(c=e.e.r+1,e.e.r=c+t.length-1+o));var d=s.header||[],f=0;t.forEach(function(r,a){ce(r).forEach(function(e){-1==(f=d.indexOf(e))&&(d[f=d.length]=e);var t=r[e],n="z",i="",e=he({c:u+f,r:c+a+o});h=Yu.sheet_get_cell(l,e),!t||"object"!=typeof t||t instanceof Date?("number"==typeof t?n="n":"boolean"==typeof t?n="b":"string"==typeof t?n="s":t instanceof Date&&(n="d",s.cellDates||(n="n",t=G(t)),i=s.dateNF||aa._table[14]),h?(h.t=n,h.v=t,delete h.w,delete h.R,i&&(h.z=i)):l[e]=h={t:n,v:t},i&&(h.z=i)):l[e]=t})}),e.e.c=Math.max(e.e.c,u+d.length-1);var r=ae(c);if(o)for(f=0;f<d.length;++f)l[se(f+u)+r]={t:"s",v:d[f]};return l["!ref"]=de(e),l}i.version="0.15.5";var zr=1200,Wr=1252;"undefined"!=typeof module&&"undefined"!=typeof require&&"undefined"==typeof cptable&&("undefined"!=typeof global?global.cptable=void 0:"undefined"!=typeof window&&(window.cptable=void 0));for(var Vr=[874,932,936,949,950],$r=0;$r<=8;++$r)Vr.push(1250+$r);function Ur(e){-1!=Vr.indexOf(e)&&(Wr=Hr[0]=e)}var Hr={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Xr=function(e){Ur(zr=e)},Gr=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return 255==t&&254==n?function(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==n?function(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}(e.slice(2)):65279==t?e.slice(1):e},jr=function(e){return String.fromCharCode(e)},Yr=function(e){return String.fromCharCode(e)};"undefined"!=typeof cptable&&(Xr=function(e){Ur(zr=e)},Gr=function(e){return 255===e.charCodeAt(0)&&254===e.charCodeAt(1)?cptable.utils.decode(1200,ee(e.slice(2))):e},jr=function(e){return 1200===zr?String.fromCharCode(e):cptable.utils.decode(zr,[255&e,e>>8])[0]},Yr=function(e){return cptable.utils.decode(Wr,[e])[0]});var Kr,Zr=null,qr=(Kr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",{encode:function(e){for(var t,n,i,r,a,s="",o=0,l=0,c=0;c<e.length;)r=(t=e.charCodeAt(c++))>>2,a=(3&t)<<4|(n=e.charCodeAt(c++))>>4,o=(15&n)<<2|(i=e.charCodeAt(c++))>>6,l=63&i,isNaN(n)?o=l=64:isNaN(i)&&(l=64),s+=Kr.charAt(r)+Kr.charAt(a)+Kr.charAt(o)+Kr.charAt(l);return s},decode:function(e){var t,n,i,r,a="";e=e.replace(/[^\w\+\/\=]/g,"");for(var s=0;s<e.length;)t=Kr.indexOf(e.charAt(s++)),n=Kr.indexOf(e.charAt(s++)),a+=String.fromCharCode(t<<2|n>>4),64!==(i=Kr.indexOf(e.charAt(s++)))&&(a+=String.fromCharCode((15&n)<<4|i>>2)),64!==(r=Kr.indexOf(e.charAt(s++)))&&(a+=String.fromCharCode((3&i)<<6|r));return a}}),Qr="undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node,Jr=function(){};if("undefined"!=typeof Buffer){var ea=!Buffer.from;if(!ea)try{Buffer.from("foo","utf8")}catch(i){ea=!0}Jr=ea?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer),Buffer.alloc||(Buffer.alloc=function(e){return new Buffer(e)}),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(e){return new Buffer(e)})}var ta=function(e){return Qr?Jr(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})},na=function(e){return[].concat.apply([],e)},ia=/\u0000/g,ra=/[\u0001-\u0006]/g,aa={},sa=function(e){function v(e){for(var t="",n=e.length-1;0<=n;)t+=e.charAt(n--);return t}function b(e,t){for(var n="";n.length<t;)n+=e;return n}function E(e,t){e=""+e;return t<=e.length?e:b("0",t-e.length)+e}function S(e,t){e=""+e;return t<=e.length?e:b(" ",t-e.length)+e}function y(e,t){e=""+e;return t<=e.length?e:e+b(" ",t-e.length)}function x(e,t){return c<e||e<-c?(n=e,i=t,n=""+Math.round(n),i<=n.length?n:b("0",i-n.length)+n):(e=Math.round(e),(t=t)<=(e=""+e).length?e:b("0",t-e.length)+e);var n,i}function k(e,t){return e.length>=7+(t=t||0)&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}function t(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e[65535]="General"}function w(e,t,n){for(var i=e<0?-1:1,r=e*i,a=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(r);c<t&&(o=(h=Math.floor(r))*s+a,u=h*c+l,!(r-h<5e-8));)r=1/(r-h),a=s,s=o,l=c,c=u;if(t<u&&(o=t<c?(u=l,a):(u=c,s)),!n)return[0,i*o,u];n=Math.floor(i*o/u);return[n,i*o-n*u,u]}function P(e,t,n){if(2958465<e||e<0)return null;var i=0|e,r=Math.floor(86400*(e-i)),a=0,s=[],e={D:i,T:r,u:86400*(e-i)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};return Math.abs(e.u)<1e-6&&(e.u=0),t&&t.date1904&&(i+=1462),.9999<e.u&&(e.u=0,86400==++r&&(e.T=r=0,++i,++e.D)),60===i?(s=n?[1317,10,29]:[1900,2,29],a=3):0===i?(s=n?[1317,8,29]:[1900,1,0],a=6):(60<i&&--i,(t=new Date(1900,0,1)).setDate(t.getDate()+i-1),s=[t.getFullYear(),t.getMonth()+1,t.getDate()],a=t.getDay(),i<60&&(a=(a+6)%7),n&&(a=0)),e.y=s[0],e.m=s[1],e.d=s[2],e.S=r%60,r=Math.floor(r/60),e.M=r%60,r=Math.floor(r/60),e.H=r,e.q=a,e}function a(e,t){var n=e.getTime();return t?n-=1262304e5:f<=e&&(n+=864e5),(n-(d+6e4*(e.getTimezoneOffset()-h.getTimezoneOffset())))/864e5}function n(e){return e.toString(10)}function R(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return((0|e)===e?n:D)(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return i(14,a(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function _(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(0<n.length?",":"")+e.substr(t,3);return n}function s(e){for(var t=[],n=!1,i=0,r=0;i<e.length;++i)switch(e.charCodeAt(i)){case 34:n=!n;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=e.substr(r,i-r),r=i+1}if(t[t.length]=e.substr(r),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}function A(e){for(var t=0,n="",i="";t<e.length;)switch(n=e.charAt(t)){case"G":k(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;)++t;++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(i=n;"]"!==e.charAt(t++)&&t<e.length;)i+=e.charAt(t);if(i.match(G))return!0;break;case".":case"0":case"#":for(;t<e.length&&(-1<"0#?.,E+-%".indexOf(n=e.charAt(++t))||"\\"==n&&"-"==e.charAt(t+1)&&-1<"0#".indexOf(e.charAt(t+2))););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&-1<"0123456789".indexOf(e.charAt(++t)););break;default:++t}return!1}function o(e,t,n,i){for(var r,a,s,o=[],l="",c=0,u="",h="t",d="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!k(e,c))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c);o[o.length]={t:"("===f||")"===f?f:"t",v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==r&&null==(r=P(t,n,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==r&&null==(r=P(t,n)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"h"===(u="m"===u&&"h"===h.toLowerCase()?"M":u)&&(u=d),o[o.length]={t:u,v:l},h=u;break;case"A":case"a":f={t:u,v:u};if(null==r&&(r=P(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=r&&(f.v=12<=r.H?"P":"A"),f.t="T",d="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=r&&(f.v=12<=r.H?"PM":"AM"),f.t="T",c+=5,d="h"):(f.t="t",++c),null==r&&"T"===f.t)return"";o[o.length]=f,h=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(G)){if(null==r&&null==(r=P(t,n)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else-1<l.indexOf("$")&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",A(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=r){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&-1<"0#?.,E+-%".indexOf(u=e.charAt(c))||"\\"==u&&"-"==e.charAt(c+1)&&c<e.length-2&&-1<"0#".indexOf(e.charAt(c+2));)l+=u;o[o.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;o[o.length]={t:u,v:l},h=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===i?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&-1<"0123456789".indexOf(e.charAt(++c));)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:u,v:u},++c;break;default:if(-1===",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++c}var p,m=0,g=0;for(c=o.length-1,h="t";0<=c;--c)switch(o[c].t){case"h":case"H":o[c].t=d,h="h",m<1&&(m=1);break;case"s":(p=o[c].v.match(/\.0+$/))&&(g=Math.max(g,p[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":h=o[c].t;break;case"m":"s"===h&&(o[c].t="M",m<2&&(m=2));break;case"X":break;case"Z":(m=(m=m<1&&o[c].v.match(/[Hh]/)?1:m)<2&&o[c].v.match(/[Mm]/)?2:m)<3&&o[c].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:.5<=r.u&&(r.u=0,++r.S),60<=r.S&&(r.S=0,++r.M),60<=r.M&&(r.M=0,++r.H);break;case 2:.5<=r.u&&(r.u=0,++r.S),60<=r.S&&(r.S=0,++r.M)}var v="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=function(e,t,n,i){var r,a,s="",o=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:r=l%100,c=2;break;default:r=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:r=n.m,c=t.length;break;case 3:return B[n.m-1][1];case 5:return B[n.m-1][0];default:return B[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:r=n.d,c=t.length;break;case 3:return T[n.q][0];default:return T[n.q][1]}break;case 104:switch(t.length){case 1:case 2:r=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:r=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:r=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(60*(a=2<=i?3===i?1e3:100:1===i?10:1)<=(o=Math.round(a*(n.S+n.u)))&&(o=0),"s"===t?0===o?"0":""+o/a:(s=E(o,2+i),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):E(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":r=24*n.D+n.H;break;case"[m]":case"[mm]":r=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":r=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:r=l,c=1}return 0<c?E(r,c):""}(o[c].t.charCodeAt(0),o[c].v,r,g),o[c].t="t";break;case"n":case"(":case"?":for(x=c+1;null!=o[x]&&("?"===(u=o[x].t)||"D"===u||(" "===u||"t"===u)&&null!=o[x+1]&&("?"===o[x+1].t||"t"===o[x+1].t&&"/"===o[x+1].v)||"("===o[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[x].v||" "===o[x].v&&null!=o[x+1]&&"?"==o[x+1].t));)o[c].v+=o[x].v,o[x]={v:"",t:";"},++x;v+=o[c].v,c=x-1;break;case"G":o[c].t="t",o[c].v=R(t,n)}var b,S,y="";if(0<v.length){40==v.charCodeAt(0)?(b=t<0&&45===v.charCodeAt(0)?-t:t,S=W("(",v,b)):(S=W("n",v,b=t<0&&1<i?-t:t),b<0&&o[0]&&"t"==o[0].t&&(S=S.substr(1),o[0].v="-"+o[0].v));for(var x=S.length-1,w=o.length,c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&-1<o[c].v.indexOf(".")){w=c;break}var _=o.length;if(w===o.length&&-1===S.indexOf("E")){for(c=o.length-1;0<=c;--c)null!=o[c]&&-1!=="n?(".indexOf(o[c].t)&&(x>=o[c].v.length-1?(x-=o[c].v.length,o[c].v=S.substr(x+1,o[c].v.length)):x<0?o[c].v="":(o[c].v=S.substr(0,x+1),x=-1),o[c].t="t",_=c);0<=x&&_<o.length&&(o[_].v=S.substr(0,x+1)+o[_].v)}else if(w!==o.length&&-1===S.indexOf("E")){for(x=S.indexOf(".")-1,c=w;0<=c;--c)if(null!=o[c]&&-1!=="n?(".indexOf(o[c].t)){for(a=-1<o[c].v.indexOf(".")&&c===w?o[c].v.indexOf(".")-1:o[c].v.length-1,y=o[c].v.substr(a+1);0<=a;--a)0<=x&&("0"===o[c].v.charAt(a)||"#"===o[c].v.charAt(a))&&(y=S.charAt(x--)+y);o[c].v=y,o[c].t="t",_=c}for(0<=x&&_<o.length&&(o[_].v=S.substr(0,x+1)+o[_].v),x=S.indexOf(".")+1,c=w;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===w)){for(a=-1<o[c].v.indexOf(".")&&c===w?o[c].v.indexOf(".")+1:0,y=o[c].v.substr(0,a);a<o[c].v.length;++a)x<S.length&&(y+=S.charAt(x++));o[c].v=y,o[c].t="t",_=c}}}for(c=0;c<o.length;++c)null!=o[c]&&-1<"n(?".indexOf(o[c].t)&&(b=1<i&&t<0&&0<c&&"-"===o[c-1].v?-t:t,o[c].v=W(o[c].t,o[c].v,b),o[c].t="t");var C="";for(c=0;c!==o.length;++c)null!=o[c]&&(C+=o[c].v);return C}function l(e,t){if(null!=t){var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return 1;break;case">":if(n<e)return 1;break;case"<":if(e<n)return 1;break;case"<>":if(e!=n)return 1;break;case">=":if(n<=e)return 1;break;case"<=":if(e<=n)return 1}}}function i(e,t,n){null==n&&(n={});var i="";switch(typeof e){case"string":i="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":i=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:u)[e]}if(k(i,0))return R(t,n);var r=function(e,t){var n=s(e),i=n.length,r=n[i-1].indexOf("@");if(i<4&&-1<r&&--i,4<n.length)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!=typeof t)return[4,4===n.length||-1<r?n[n.length-1]:"@"];switch(n.length){case 1:n=-1<r?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=-1<r?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=-1<r?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var a=0<t?n[0]:t<0?n[1]:n[2];return-1===n[0].indexOf("[")&&-1===n[1].indexOf("[")||null==n[0].match(j)&&null==n[1].match(j)?[i,a]:(e=n[0].match(Y),a=n[1].match(Y),l(t,e)?[i,n[0]]:l(t,a)?[i,n[1]]:[i,n[null!=e&&null!=a?2:1]])}(i,t=t instanceof Date?a(t,n.date1904):t);if(k(r[1]))return R(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return o(r[1],t,n,r[0])}function r(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(null!=u[n]){if(u[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return u[t]=e,t}e.version="0.10.2";var c=Math.pow(2,32),T=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],B=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],u={};t(u),e.parse_date_code=P;var h=new Date(1899,11,31,0,0,0),d=h.getTime(),f=new Date(1900,2,1,0,0,0);e._general_int=n;var p,m,g,C,M,D=(p=/\.(\d*[1-9])0+$/,m=/\.0*$/,g=/\.(\d*[1-9])0+/,C=/\.0*[Ee]/,M=/(E[+-])(\d)$/,function(e){var t,n,i,r,a=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t=-4<=a&&a<=-1?e.toPrecision(10+a):Math.abs(a)<=9?(i=(n=e)<0?12:11,(r=I(n.toFixed(12))).length<=i?r:(r=n.toPrecision(10)).length<=i?r:n.toExponential(5)):10===a?e.toFixed(10).substr(0,12):t=(t=(e=e).toFixed(11).replace(p,".$1")).length>(e<0?12:11)?e.toPrecision(6):t;return I(function(e){for(var t=0;t!=e.length;++t)if(101==(32|e.charCodeAt(t)))return e.replace(g,".$1").replace(C,"E").replace("e","E").replace(M,"$10$2");return e}(t))});function I(e){return-1<e.indexOf(".")?e.replace(m,"").replace(p,".$1"):e}e._general_num=D,e._general=R;var L,F,O,N,z,W=(L=/%/g,F=/# (\?+)( ?)\/( ?)(\d+)/,O=/^#*0*\.([0#]+)/,N=/\).*[0#]/,z=/\(###\) ###\\?-####/,function(e,t,n){return((0|n)===n?X:H)(e,t,n)});function V(e){for(var t,n="",i=0;i!=e.length;++i)switch(t=e.charCodeAt(i)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function $(e,t){t=Math.pow(10,t);return""+Math.round(e*t)/t}function U(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?0:Math.round((e-Math.floor(e))*Math.pow(10,t))}function H(e,t,n){if(40===e.charCodeAt(0)&&!t.match(N)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=n?H("n",i,n):"("+H("n",i,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var i=t.length-1;44===t.charCodeAt(i-1);)--i;return W(e,t.substr(0,i),n/Math.pow(10,3*(t.length-i)))}(e,t,n);if(-1!==t.indexOf("%"))return a=e,o=n,s=(l=t).replace(L,""),l=l.length-s.length,W(a,s,o*Math.pow(10,2*l))+b("%",l);if(-1!==t.indexOf("E"))return function e(t,n){var i,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==n)return"0.0E+0";if(n<0)return"-"+e(t,-n);var a=t.indexOf(".");-1===a&&(a=t.indexOf("E"));var s=Math.floor(Math.log(n)*Math.LOG10E)%a;if(s<0&&(s+=a),-1===(i=(n/Math.pow(10,s)).toPrecision(1+r+(a+s)%a)).indexOf("e")){var o=Math.floor(Math.log(n)*Math.LOG10E);for(-1===i.indexOf(".")?i=i.charAt(0)+"."+i.substr(1)+"E+"+(o-i.length+s):i+="E+"+(o-s);"0."===i.substr(0,2);)i=(i=i.charAt(0)+i.substr(2,a)+"."+i.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");i=i.replace(/\+-/,"-")}i=i.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,i){return t+n+i.substr(0,(a+s)%a)+"."+i.substr(s)+"E"})}else i=n.toExponential(r);return t.match(/E\+00$/)&&i.match(/e[+-]\d$/)&&(i=i.substr(0,i.length-1)+"0"+i.charAt(i.length-1)),(i=t.match(/E\-/)&&i.match(/e\+/)?i.replace(/e\+/,"e"):i).replace("e","E")}(t,n);if(36===t.charCodeAt(0))return"$"+H(e,t.substr(" "==t.charAt(1)?2:1),n);var r,a,s,o,l,c=Math.abs(n),u=n<0?"-":"";if(t.match(/^00+$/))return u+x(c,t.length);if(t.match(/^[#?]+$/))return(d="0"===(d=x(n,0))?"":d).length>t.length?d:V(t.substr(0,t.length-d.length))+d;if(r=t.match(F))return i=r,a=c,s=u,o=parseInt(i[4],10),l=Math.round(a*o),a=Math.floor(l/o),o,s+(0===a?"":""+a)+" "+(0==(l-=a*o)?b(" ",i[1].length+1+i[4].length):S(l,i[1].length)+i[2]+"/"+i[3]+E(o,i[4].length));if(t.match(/^#+0+$/))return u+x(c,t.length-t.indexOf("0"));if(r=t.match(O))return d=$(n,r[1].length).replace(/^([^\.]+)$/,"$1."+V(r[1])).replace(/\.$/,"."+V(r[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+b("0",V(r[1]).length-t.length)}),-1!==t.indexOf("0.")?d:d.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),r=t.match(/^(0*)\.(#*)$/))return u+$(c,r[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,r[1].length?"0.":".");if(r=t.match(/^#{1,3},##0(\.?)$/))return u+_(x(c,0));if(r=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+H(e,t,-n):_(""+(Math.floor(n)+((h=r[1].length)<(""+Math.round((n-Math.floor(n))*Math.pow(10,h))).length?1:0)))+"."+E(U(n,r[1].length),r[1].length);if(r=t.match(/^#,#*,#0/))return H(e,t.replace(/^#,#*,/,""),n);if(r=t.match(/^([0#]+)(\\?-([0#]+))+$/))return d=v(H(e,t.replace(/[\\-]/g,""),n)),f=0,v(v(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return f<d.length?d.charAt(f++):"0"===e?"0":""}));if(t.match(z))return"("+(d=H(e,"##########",n)).substr(0,3)+") "+d.substr(3,3)+"-"+d.substr(6);var h="";if(r=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(r[4].length,7),p=w(c,Math.pow(10,f)-1,!1),d=u," "==(h=W("n",r[1],p[1])).charAt(h.length-1)&&(h=h.substr(0,h.length-1)+"0"),d+=h+r[2]+"/"+r[3],(h=y(p[2],f)).length<r[4].length&&(h=V(r[4].substr(r[4].length-h.length))+h),d+=h;if(r=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(r[1].length,r[4].length),7),u+((p=w(c,Math.pow(10,f)-1,!0))[0]||(p[1]?"":"0"))+" "+(p[1]?S(p[1],f)+r[2]+"/"+r[3]+y(p[2],f):b(" ",2*f+1+r[2].length+r[3].length));if(r=t.match(/^[#0?]+$/))return d=x(n,0),t.length<=d.length?d:V(t.substr(0,t.length-d.length))+d;if(r=t.match(/^([#0?]+)\.([#0]+)$/)){var d,f=(d=""+n.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf("."),p=t.indexOf(".")-f,m=t.length-d.length-p;return V(t.substr(0,p)+d+t.substr(t.length-m))}if(r=t.match(/^00,000\.([#0]*0)$/))return f=U(n,r[1].length),n<0?"-"+H(e,t,-n):_((m=n)<2147483647&&-2147483648<m?""+(0<=m?0|m:m-1|0):""+Math.floor(m)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?E(0,3-e.length):"")+e})+"."+E(f,r[1].length);switch(t){case"###,##0.00":return H(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var g=_(x(c,0));return"0"!==g?u+g:"";case"###,###.00":return H(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return H(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function X(e,t,n){if(40===e.charCodeAt(0)&&!t.match(N)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=n?X("n",i,n):"("+X("n",i,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var i=t.length-1;44===t.charCodeAt(i-1);)--i;return W(e,t.substr(0,i),n/Math.pow(10,3*(t.length-i)))}(e,t,n);if(-1!==t.indexOf("%"))return r=e,s=n,i=(a=t).replace(L,""),a=a.length-i.length,W(r,i,s*Math.pow(10,2*a))+b("%",a);var r,a,s;if(-1!==t.indexOf("E"))return function e(t,n){var i,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==n)return"0.0E+0";if(n<0)return"-"+e(t,-n);var a=t.indexOf(".");-1===a&&(a=t.indexOf("E"));var s,o=Math.floor(Math.log(n)*Math.LOG10E)%a;o<0&&(o+=a),(i=(n/Math.pow(10,o)).toPrecision(1+r+(a+o)%a)).match(/[Ee]/)||(s=Math.floor(Math.log(n)*Math.LOG10E),-1===i.indexOf(".")?i=i.charAt(0)+"."+i.substr(1)+"E+"+(s-i.length+o):i+="E+"+(s-o),i=i.replace(/\+-/,"-")),i=i.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,i){return t+n+i.substr(0,(a+o)%a)+"."+i.substr(o)+"E"})}else i=n.toExponential(r);return t.match(/E\+00$/)&&i.match(/e[+-]\d$/)&&(i=i.substr(0,i.length-1)+"0"+i.charAt(i.length-1)),(i=t.match(/E\-/)&&i.match(/e\+/)?i.replace(/e\+/,"e"):i).replace("e","E")}(t,n);if(36===t.charCodeAt(0))return"$"+X(e,t.substr(" "==t.charAt(1)?2:1),n);var o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+E(l,t.length);if(t.match(/^[#?]+$/))return(h=0===n?"":""+n).length>t.length?h:V(t.substr(0,t.length-h.length))+h;if(o=t.match(F))return c+(0===(u=l)?"":""+u)+b(" ",(u=o)[1].length+2+u[4].length);if(t.match(/^#+0+$/))return c+E(l,t.length-t.indexOf("0"));if(o=t.match(O))return h=(h=(""+n).replace(/^([^\.]+)$/,"$1."+V(o[1])).replace(/\.$/,"."+V(o[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+b("0",V(o[1]).length-t.length)}),-1!==t.indexOf("0.")?h:h.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return c+_(""+l);if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+X(e,t,-n):_(""+n)+"."+b("0",o[1].length);if(o=t.match(/^#,#*,#0/))return X(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return h=v(X(e,t.replace(/[\\-]/g,""),n)),d=0,v(v(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return d<h.length?h.charAt(d++):"0"===e?"0":""}));if(t.match(z))return"("+(h=X(e,"##########",n)).substr(0,3)+") "+h.substr(3,3)+"-"+h.substr(6);var u="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(o[4].length,7),f=w(l,Math.pow(10,d)-1,!1),h=c," "==(u=W("n",o[1],f[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),h+=u+o[2]+"/"+o[3],(u=y(f[2],d)).length<o[4].length&&(u=V(o[4].substr(o[4].length-u.length))+u),h+=u;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(o[1].length,o[4].length),7),c+((f=w(l,Math.pow(10,d)-1,!0))[0]||(f[1]?"":"0"))+" "+(f[1]?S(f[1],d)+o[2]+"/"+o[3]+y(f[2],d):b(" ",2*d+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return h=""+n,t.length<=h.length?h:V(t.substr(0,t.length-h.length))+h;if(o=t.match(/^([#0]+)\.([#0]+)$/)){var h,d=(h=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf("."),u=t.indexOf(".")-d,f=t.length-h.length-u;return V(t.substr(0,u)+h+t.substr(t.length-f))}if(o=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+X(e,t,-n):_(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?E(0,3-e.length):"")+e})+"."+E(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=_(""+l);return"0"!==p?c+p:"";default:if(t.match(/\.[0#?]*$/))return X(e,t.slice(0,t.lastIndexOf(".")),n)+V(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}e._split=s;var G=/\[[HhMmSs]*\]/;e.is_date=A,e._eval=o;var j=/\[[=<>]/,Y=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;e.load=r,e._table=u,e.get_table=function(){return u},e.load_table=function(e){for(var t=0;392!=t;++t)void 0!==e[t]&&r(e[t],t)},e.init_table=t,e.format=i};sa(aa);var oa,la={"General Number":"General","General Date":aa._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":aa._table[15],"Short Date":aa._table[14],"Long Time":aa._table[19],"Medium Time":aa._table[18],"Short Time":aa._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:aa._table[2],Standard:aa._table[4],Percent:aa._table[10],Scientific:aa._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'},ca={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ua=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;!function(e){e.version="1.2.0";var o=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)t[e=n]=e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&e?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1;return"undefined"!=typeof Int32Array?new Int32Array(t):t}();e.table=o,e.bstr=function(e,t){for(var n=-1^t,i=e.length-1,r=0;r<i;)n=(n=n>>>8^o[255&(n^e.charCodeAt(r++))])>>>8^o[255&(n^e.charCodeAt(r++))];return-1^(n=r===i?n>>>8^o[255&(n^e.charCodeAt(r))]:n)},e.buf=function(e,t){if(1e4<e.length)return function(e,t){for(var n=-1^t,i=e.length-7,r=0;r<i;)n=(n=(n=(n=(n=(n=(n=(n=n>>>8^o[255&(n^e[r++])])>>>8^o[255&(n^e[r++])])>>>8^o[255&(n^e[r++])])>>>8^o[255&(n^e[r++])])>>>8^o[255&(n^e[r++])])>>>8^o[255&(n^e[r++])])>>>8^o[255&(n^e[r++])])>>>8^o[255&(n^e[r++])];for(;r<7+i;)n=n>>>8^o[255&(n^e[r++])];return-1^n}(e,t);for(var n=-1^t,i=e.length-3,r=0;r<i;)n=(n=(n=(n=n>>>8^o[255&(n^e[r++])])>>>8^o[255&(n^e[r++])])>>>8^o[255&(n^e[r++])])>>>8^o[255&(n^e[r++])];for(;r<3+i;)n=n>>>8^o[255&(n^e[r++])];return-1^n},e.str=function(e,t){for(var n,i,r=-1^t,a=0,s=e.length;a<s;)r=(n=e.charCodeAt(a++))<128?r>>>8^o[255&(r^n)]:n<2048?(r=r>>>8^o[255&(r^(192|n>>6&31))])>>>8^o[255&(r^(128|63&n))]:55296<=n&&n<57344?(n=64+(1023&n),i=1023&e.charCodeAt(a++),(r=(r=(r=r>>>8^o[255&(r^(240|n>>8&7))])>>>8^o[255&(r^(128|n>>2&63))])>>>8^o[255&(r^(128|i>>6&15|(3&n)<<4))])>>>8^o[255&(r^(128|63&i))]):(r=(r=r>>>8^o[255&(r^(224|n>>12&15))])>>>8^o[255&(r^(128|n>>6&63))])>>>8^o[255&(r^(128|63&n))];return-1^r}}(oa={});var ha,da=function(){function d(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:d(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function f(e){if("/"==e.charAt(e.length-1))return f(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function v(e){ue(e,0);for(var t,n={};e.l<=e.length-4;){var i=e._R(2),r=e._R(2),a=e.l+r,s={};21589===i&&(1&(t=e._R(1))&&(s.mtime=e._R(4)),5<r&&(2&t&&(s.atime=e._R(4)),4&t&&(s.ctime=e._R(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime))),e.l=a,n[i]=s}return n}function r(){return o=o||require("fs")}function a(e,t){if(80==e[0]&&75==e[1])return w(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,i,r=512,a=0,s=[],o=e.slice(0,512);ue(o,0);var l=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(B,"Header Signature: "),e.l+=16;var t=e._R(2,"u");return[e._R(2,"u"),t]}(o);switch(n=l[0]){case 3:r=512;break;case 4:r=4096;break;case 0:if(0==l[1])return w(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==r&&ue(o=e.slice(0,r),28);var c=e.slice(0,r);!function(e,t){var n=9;switch(e.l+=2,n=e._R(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(o,n);var u=o._R(4,"i");if(3===n&&0!==u)throw new Error("# Directory Sectors: Expected 0 saw "+u);o.l+=4,i=o._R(4,"i"),o.l+=4,o.chk("00100000","Mini Stream Cutoff Size: ");for(var h=o._R(4,"i"),d=o._R(4,"i"),f=o._R(4,"i"),a=o._R(4,"i"),p=-1,m=0;m<109&&!((p=o._R(4,"i"))<0);++m)s[m]=p;var g=function(e,t){for(var n=Math.ceil(e.length/t)-1,i=[],r=1;r<n;++r)i[r-1]=e.slice(r*t,(r+1)*t);return i[n-1]=e.slice(n*t),i}(e,r);!function e(t,n,i,r,a){var s=T;if(t===T){if(0!==n)throw new Error("DIFAT chain shorter than expected")}else if(-1!==t){var o=i[t],l=(r>>>2)-1;if(o){for(var c=0;c<l&&(s=_s(o,4*c))!==T;++c)a.push(s);e(_s(o,r-4),n-1,i,r,a)}}}(f,a,g,r,s);var v=function(e,t,n,i){var r=e.length,a=[],s=[],o=[],l=[],c=i-1,u=0,h=0,d=0,f=0;for(u=0;u<r;++u)if(o=[],(d=u+t)>=r&&(d-=r),!s[d]){for(l=[],h=d;0<=h;){s[h]=!0,o[o.length]=h,l.push(e[h]);var p=n[Math.floor(4*h/i)];if(i<4+(f=4*h&c))throw new Error("FAT boundary crossed: "+h+" 4 "+i);if(!e[p])break;h=_s(e[p],f)}a[d]={nodes:o,data:qa([l])}}return a}(g,i,s,r);v[i].name="!Directory",0<d&&h!==T&&(v[h].name="!MiniFAT"),v[s[0]].name="!FAT",v.fat_addrs=s,v.ssz=r;u=[],f=[],a=[];(function(e,t,n,i,r,a,s,o){for(var l,c=0,u=i.length?2:0,h=t[e].data,d=0,f=0;d<h.length;d+=128){var p=h.slice(d,d+128);ue(p,64),f=p._R(2),l=Ja(p,0,f-u),i.push(l);var m={name:l,type:p._R(1),color:p._R(1),L:p._R(4,"i"),R:p._R(4,"i"),C:p._R(4,"i"),clsid:p._R(16),state:p._R(4,"i"),start:0,size:0};0!==p._R(2)+p._R(2)+p._R(2)+p._R(2)&&(m.ct=b(p,p.l-8)),0!==p._R(2)+p._R(2)+p._R(2)+p._R(2)&&(m.mt=b(p,p.l-8)),m.start=p._R(4,"i"),m.size=p._R(4,"i"),m.size<0&&m.start<0&&(m.size=m.type=0,m.start=T,m.name=""),5===m.type?(c=m.start,0<r&&c!==T&&(t[c].name="!StreamData")):4096<=m.size?(m.storage="fat",void 0===t[m.start]&&(t[m.start]=function(e,t,n,i,r){var a=[],s=[];r=r||[];var o=i-1,l=0,c=0;for(l=t;0<=l;){r[l]=!0,a[a.length]=l,s.push(e[l]);var u=n[Math.floor(4*l/i)];if(i<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+i);if(!e[u])break;l=_s(e[u],c)}return{nodes:a,data:qa([s])}}(n,m.start,t.fat_addrs,t.ssz)),t[m.start].name=m.name,m.content=t[m.start].data.slice(0,m.size)):(m.storage="minifat",m.size<0?m.size=0:c!==T&&m.start!==T&&t[c]&&(m.content=function(e,t,n){for(var i=e.start,r=e.size,a=[],s=i;n&&0<r&&0<=s;)a.push(t.slice(64*s,64*s+64)),r-=64,s=_s(n,4*s);return 0===a.length?Q(0):na(a).slice(0,e.size)}(m,t[c].data,(t[o]||{}).data))),m.content&&ue(m.content,0),a[l]=m,s.push(m)}})(i,v,g,u,d,{},f,h),function(e,t,n){for(var i=0,r=0,a=0,s=0,o=0,l=n.length,c=[],u=[];i<l;++i)c[i]=u[i]=i,t[i]=n[i];for(;o<u.length;++o)i=u[o],r=e[i].L,a=e[i].R,s=e[i].C,c[i]===i&&(-1!==r&&c[r]!==r&&(c[i]=c[r]),-1!==a&&c[a]!==a&&(c[i]=c[a])),-1!==s&&(c[s]=i),-1!==r&&i!=c[i]&&(c[r]=c[i],u.lastIndexOf(r)<o&&u.push(r)),-1!==a&&i!=c[i]&&(c[a]=c[i],u.lastIndexOf(a)<o&&u.push(a));for(i=1;i<l;++i)c[i]===i&&(-1!==a&&c[a]!==a?c[i]=c[a]:-1!==r&&c[r]!==r&&(c[i]=c[r]));for(i=1;i<l;++i)if(0!==e[i].type){if((o=i)!=c[o])for(;o=c[o],t[i]=t[o]+"/"+t[i],0!==o&&-1!==c[o]&&o!=c[o];);c[i]=-1}for(t[0]+="/",i=1;i<l;++i)2!==e[i].type&&(t[i]+="/")}(f,a,u),u.shift();a={FileIndex:f,FullPaths:a};return t&&t.raw&&(a.raw={header:c,sectors:g}),a}function b(e,t){return new Date(1e3*(ws(e,t+4)/1e7*Math.pow(2,32)+ws(e,t)/1e7-11644473600))}function p(e,t){var n=t||{},t=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=t+"/",e.FileIndex[0]={name:t,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="Sh33tJ5";{var n;da.find(e,"/"+t)||((n=Q(4))[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),m(e))}}(e)}function m(e,t){p(e);for(var n=!1,i=!1,r=e.FullPaths.length-1;0<=r;--r){var a=e.FileIndex[r];switch(a.type){case 0:i?n=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(a.R*a.L*a.C)&&(n=!0),-1<a.R&&-1<a.L&&a.R==a.L&&(n=!0);break;default:n=!0}}if(n||t){for(var s=new Date(1987,1,19),o=0,l=[],r=0;r<e.FullPaths.length;++r)0!==e.FileIndex[r].type&&l.push([e.FullPaths[r],e.FileIndex[r]]);for(r=0;r<l.length;++r){for(var c=d(l[r][0]),i=!1,o=0;o<l.length;++o)l[o][0]===c&&(i=!0);i||l.push([c,{name:f(c).replace("/",""),type:1,clsid:D,ct:s,mt:s,content:null}])}for(l.sort(function(e,t){return function(e,t){for(var n,i=e.split("/"),r=t.split("/"),a=0,s=Math.min(i.length,r.length);a<s;++a){if(n=i[a].length-r[a].length)return n;if(i[a]!=r[a])return i[a]<r[a]?-1:1}return i.length-r.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],r=0;r<l.length;++r)e.FullPaths[r]=l[r][0],e.FileIndex[r]=l[r][1];for(r=0;r<l.length;++r){var u=e.FileIndex[r],h=e.FullPaths[r];if(u.name=f(h).replace("/",""),u.L=u.R=u.C=-(u.color=1),u.size=u.content?u.content.length:0,u.start=0,u.clsid=u.clsid||D,0===r)u.C=1<l.length?1:-1,u.size=0,u.type=5;else if("/"==h.slice(-1)){for(o=r+1;o<l.length&&d(e.FullPaths[o])!=h;++o);for(u.C=o>=l.length?-1:o,o=r+1;o<l.length&&d(e.FullPaths[o])!=d(h);++o);u.R=o>=l.length?-1:o,u.type=1}else d(e.FullPaths[r+1]||"")==d(h)&&(u.R=r+1),u.type=2}}}function i(e,t){var n=t||{};if(m(e),"zip"==n.fileType)return function(e,t){var t=t||{},n=[],i=[],r=Q(1),a=t.compression?8:0,s=0,o=0,l=0,c=0,u=e.FullPaths[0],h=u,d=e.FileIndex[0],f=[],p=0;for(s=1;s<e.FullPaths.length;++s)if(h=e.FullPaths[s].slice(u.length),(d=e.FileIndex[s]).size&&d.content&&"Sh33tJ5"!=h){var m=l,g=Q(h.length);for(o=0;o<h.length;++o)g._W(1,127&h.charCodeAt(o));g=g.slice(0,g.l),f[c]=oa.buf(d.content,0);var v=d.content;8==a&&(v=function(e){return C?C.deflateRawSync(e):W(e)}(v)),(r=Q(30))._W(4,67324752),r._W(2,20),r._W(2,0),r._W(2,a),d.mt?function(e,t){var n;n=(n=(n=(t="string"==typeof t?new Date(t):t).getHours())<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e._W(2,n),n=(n=(n=t.getFullYear()-1980)<<4|t.getMonth()+1)<<5|t.getDate(),e._W(2,n)}(r,d.mt):r._W(4,0),r._W(-4,f[c]),r._W(4,v.length),r._W(4,d.content.length),r._W(2,g.length),r._W(2,0),l+=r.length,n.push(r),l+=g.length,n.push(g),l+=v.length,n.push(v),(r=Q(46))._W(4,33639248),r._W(2,0),r._W(2,20),r._W(2,0),r._W(2,a),r._W(4,0),r._W(-4,f[c]),r._W(4,v.length),r._W(4,d.content.length),r._W(2,g.length),r._W(2,0),r._W(2,0),r._W(2,0),r._W(2,0),r._W(4,0),r._W(4,m),p+=r.l,i.push(r),p+=g.length,i.push(g),++c}return(r=Q(22))._W(4,101010256),r._W(2,0),r._W(2,0),r._W(2,c),r._W(2,c),r._W(4,p),r._W(4,l),r._W(2,0),na([na(n),na(i),r])}(e,n);for(var i=function(e){for(var t=0,n=0,i=0;i<e.FileIndex.length;++i){var r=e.FileIndex[i];!r.content||0<(r=r.content.length)&&(r<4096?t+=r+63>>6:n+=r+511>>9)}for(var a=e.FullPaths.length+3>>2,s=t+127>>7,o=(t+7>>3)+n+a+s,l=o+127>>7,c=l<=109?0:Math.ceil((l-109)/127);l<o+l+c+127>>7;)c=++l<=109?0:Math.ceil((l-109)/127);a=[1,c,l,s,a,n,t,0];return e.FileIndex[0].size=t<<6,a[7]=(e.FileIndex[0].start=a[0]+a[1]+a[2]+a[3]+a[4]+a[5])+(a[6]+7>>3),a}(e),r=Q(i[7]<<9),a=0,s=0,a=0;a<8;++a)r._W(1,M[a]);for(a=0;a<8;++a)r._W(2,0);for(r._W(2,62),r._W(2,3),r._W(2,65534),r._W(2,9),r._W(2,6),a=0;a<3;++a)r._W(2,0);for(r._W(4,0),r._W(4,i[2]),r._W(4,i[0]+i[1]+i[2]+i[3]-1),r._W(4,0),r._W(4,4096),r._W(4,i[3]?i[0]+i[1]+i[2]-1:T),r._W(4,i[3]),r._W(-4,i[1]?i[0]-1:T),r._W(4,i[1]),a=0;a<109;++a)r._W(-4,a<i[2]?i[1]+a:-1);if(i[1])for(s=0;s<i[1];++s){for(;a<236+127*s;++a)r._W(-4,a<i[2]?i[1]+a:-1);r._W(-4,s===i[1]-1?T:s+1)}function o(e){for(s+=e;a<s-1;++a)r._W(-4,a+1);e&&(++a,r._W(-4,T))}s=a=0;for(s+=i[1];a<s;++a)r._W(-4,I.DIFSECT);for(s+=i[2];a<s;++a)r._W(-4,I.FATSECT);o(i[3]),o(i[4]);for(var l=0,c=0,u=e.FileIndex[0];l<e.FileIndex.length;++l)(u=e.FileIndex[l]).content&&((c=u.content.length)<4096||(u.start=s,o(c+511>>9)));for(o(i[6]+7>>3);511&r.l;)r._W(-4,I.ENDOFCHAIN);for(l=s=a=0;l<e.FileIndex.length;++l)(u=e.FileIndex[l]).content&&(!(c=u.content.length)||4096<=c||(u.start=s,o(c+63>>6)));for(;511&r.l;)r._W(-4,I.ENDOFCHAIN);for(a=0;a<i[4]<<2;++a){var h=e.FullPaths[a];if(h&&0!==h.length){u=e.FileIndex[a],0===a&&(u.start=u.size?u.start-1:T);h=0===a&&n.root||u.name,c=2*(h.length+1);if(r._W(64,h,"utf16le"),r._W(2,c),r._W(1,u.type),r._W(1,u.color),r._W(-4,u.L),r._W(-4,u.R),r._W(-4,u.C),u.clsid)r._W(16,u.clsid,"hex");else for(l=0;l<4;++l)r._W(4,0);r._W(4,u.state||0),r._W(4,0),r._W(4,0),r._W(4,0),r._W(4,0),r._W(4,u.start),r._W(4,u.size),r._W(4,0)}else{for(l=0;l<17;++l)r._W(4,0);for(l=0;l<3;++l)r._W(4,-1);for(l=0;l<12;++l)r._W(4,0)}}for(a=1;a<e.FileIndex.length;++a)if(4096<=(u=e.FileIndex[a]).size){for(r.l=u.start+1<<9,l=0;l<u.size;++l)r._W(1,u.content[l]);for(;511&l;++l)r._W(1,0)}for(a=1;a<e.FileIndex.length;++a)if(0<(u=e.FileIndex[a]).size&&u.size<4096){for(l=0;l<u.size;++l)r._W(1,u.content[l]);for(;63&l;++l)r._W(1,0)}for(;r.l<r.length;)r._W(1,0);return r}function s(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function E(e,t){var n=7&t,t=t>>>3;return(e[t]|(n<=5?0:e[1+t]<<8))>>>n&7}function k(e,t){var n=7&t,t=t>>>3;return(e[t]|(n<=3?0:e[1+t]<<8))>>>n&31}function P(e,t){var n=7&t,t=t>>>3;return(e[t]|(n<=1?0:e[1+t]<<8))>>>n&127}function g(e,t,n){var i=7&t,r=t>>>3,a=(1<<n)-1,t=e[r]>>>i;return n<8-i?t&a:(t|=e[1+r]<<8-i,n<16-i?t&a:(t|=e[2+r]<<16-i,n<24-i?t&a:(t|=e[3+r]<<24-i)&a))}function S(e,t){var n=e.length,i=t<2*n?2*n:t+5,r=0;if(t<=n)return e;if(Qr){var a=K(i);if(e.copy)e.copy(a);else for(;r<e.length;++r)a[r]=e[r];return a}if(N){var s=new Uint8Array(i);if(s.set)s.set(e);else for(;r<e.length;++r)s[r]=e[r];return s}return e.length=i,e}function R(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function A(e,t,n){for(var i,r=1,a=0,s=0,o=0,l=e.length,c=N?new Uint16Array(32):R(32),a=0;a<32;++a)c[a]=0;for(a=l;a<n;++a)e[a]=0;var l=e.length,u=N?new Uint16Array(l):R(l);for(a=0;a<l;++a)c[i=e[a]]++,r<i&&(r=i),u[a]=0;for(c[0]=0,a=1;a<=r;++a)c[a+16]=o=o+c[a-1]<<1;for(a=0;a<l;++a)0!=(o=e[a])&&(u[a]=c[o+16]++);var h,d,f,p;for(a=0;a<l;++a)if(0!=(h=e[a]))for(d=u[a],f=r,p=void 0,p=z[255&d],o=(f<=8?p>>>8-f:(p=p<<8|z[d>>8&255],f<=16?p>>>16-f:(p=p<<8|z[d>>16&255])>>>24-f))>>r-h,s=(1<<r+4-h)-1;0<=s;--s)t[o|s<<h]=15&h|a<<4;return r}function n(e,t){if(3==e[0]&&!(3&e[1]))return[Y(t),2];for(var n=0,i=0,r=K(t||1<<18),a=0,s=r.length>>>0,o=0,l=0;0==(1&i);)if(i=E(e,n),n+=3,i>>>1!=0)for(l=i>>>1==1?(o=9,5):(n=function(e,t){var n,i,r,a=k(e,t)+257,s=k(e,t+=5)+1,o=(i=t+=5,r=7&t,4+(((n=e)[i=t>>>3]|(r<=4?0:n[1+i]<<8))>>>r&15));t+=4;for(var l=0,c=N?new Uint8Array(19):R(19),u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h=1,d=N?new Uint8Array(8):R(8),f=N?new Uint8Array(8):R(8),p=c.length,m=0;m<o;++m)c[L[m]]=l=E(e,t),h<l&&(h=l),d[l]++,t+=3;var g=0;for(d[0]=0,m=1;m<=h;++m)f[m]=g=g+d[m-1]<<1;for(m=0;m<p;++m)0!=(g=c[m])&&(u[m]=f[g]++);for(var v,m=0;m<p;++m)if(0!=(v=c[m]))for(var g=z[u[m]]>>8-v,b=(1<<7-v)-1;0<=b;--b)X[g|b<<v]=7&v|m<<3;for(var S,y,x,w=[],h=1;w.length<a+s;)switch(g=X[P(e,t)],t+=7&g,g>>>=3){case 16:for(l=3+(x=void 0,x=7&(y=t),((S=e)[y=t>>>3]|(x<=6?0:S[1+y]<<8))>>>x&3),t+=2,g=w[w.length-1];0<l--;)w.push(g);break;case 17:for(l=3+E(e,t),t+=3;0<l--;)w.push(0);break;case 18:for(l=11+P(e,t),t+=7;0<l--;)w.push(0);break;default:w.push(g),h<g&&(h=g)}var _=w.slice(0,a),C=w.slice(a);for(m=a;m<286;++m)_[m]=0;for(m=s;m<30;++m)C[m]=0;return G=A(_,U,286),j=A(C,H,30),t}(e,n),o=G,j),!t&&s<a+32767&&(s=(r=S(r,a+32767)).length);;){var c=g(e,n,o),u=(i>>>1==1?V:U)[c];if(n+=15&u,0==((u>>>=4)>>>8&255))r[a++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;5<h&&(h=0);var d=a+F[u];0<h&&(d+=g(e,n,h),n+=h),c=g(e,n,l),n+=15&(u=(i>>>1==1?$:H)[c]);var c=(u>>>=4)<4?0:u-2>>1,f=O[u];for(0<c&&(f+=g(e,n,c),n+=c),!t&&s<d&&(s=(r=S(r,d)).length);a<d;)r[a]=r[a-f],++a}}else{7&n&&(n+=8-(7&n));var p=e[n>>>3]|e[1+(n>>>3)]<<8;if(n+=32,!t&&s<a+p&&(s=(r=S(r,a+p)).length),"function"==typeof e.copy)e.copy(r,a,n>>>3,(n>>>3)+p),a+=p,n+=8*p;else for(;0<p--;)r[a++]=e[n>>>3],n+=8}return[t?r:r.slice(0,a),n+7>>>3]}function y(e,t){t=n(e.slice(e.l||0),t);return e.l+=t[1],t[0]}function x(e,t){if(!e)throw new Error(t);"undefined"!=typeof console&&console.error(t)}function w(e,t){var n=e;ue(n,0);var i={FileIndex:[],FullPaths:[]};p(i,{root:t.root});for(var r=n.length-4;(80!=n[r]||75!=n[r+1]||5!=n[r+2]||6!=n[r+3])&&0<=r;)--r;n.l=r+4,n.l+=4;var a=n._R(2);n.l+=6;t=n._R(4);for(n.l=t,r=0;r<a;++r){n.l+=20;var s=n._R(4),o=n._R(4),l=n._R(2),c=n._R(2),u=n._R(2);n.l+=8;var h=n._R(4),d=v(n.slice(n.l+l,n.l+l+c));n.l+=l+c+u;u=n.l;n.l=h+4,function(e,t,n,i,r){e.l+=2;var a=e._R(2),s=e._R(2),o=function(e){var t=65535&e._R(2),n=65535&e._R(2),i=new Date,r=31&n,e=15&(n>>>=5);return n>>>=4,i.setMilliseconds(0),i.setFullYear(1980+n),i.setMonth(e-1),i.setDate(r),e=31&t,r=63&(t>>>=5),i.setHours(t>>>=6),i.setMinutes(r),i.setSeconds(e<<1),i}(e);if(8257&a)throw new Error("Unsupported ZIP encryption");for(var l=e._R(4),c=e._R(4),u=e._R(4),h=e._R(2),d=e._R(2),f="",p=0;p<h;++p)f+=String.fromCharCode(e[e.l++]);{var m;d&&(((m=v(e.slice(e.l,e.l+d)))[21589]||{}).mt&&(o=m[21589].mt),((r||{})[21589]||{}).mt&&(o=r[21589].mt))}e.l+=d;var g=e.slice(e.l,e.l+c);switch(s){case 8:g=function(e,t){if(!C)return y(e,t);var n=new C.InflateRaw,t=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,t}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+s)}d=!1;8&a&&(134695760==(l=e._R(4))&&(l=e._R(4),d=!0),c=e._R(4),u=e._R(4)),c!=t&&x(d,"Bad compressed size: "+t+" != "+c),u!=n&&x(d,"Bad uncompressed size: "+n+" != "+u);n=oa.buf(g,0);l>>0!=n>>0&&x(d,"Bad CRC32 checksum: "+l+" != "+n),_(i,f,g,{unsafe:!0,mt:o})}(n,s,o,i,d),n.l=u}return i}function _(e,t,n,i){var r=i&&i.unsafe;r||p(e);var a,s=!r&&da.find(e,t);return s||(a=e.FullPaths[0],a=t.slice(0,a.length)==a?t:("/"!=a.slice(-1)&&(a+="/"),(a+t).replace("//","/")),s={name:f(t),type:2},e.FileIndex.push(s),e.FullPaths.push(a),r||da.utils.cfb_gc(e)),s.content=n,s.size=n?n.length:0,i&&(i.CLSID&&(s.clsid=i.CLSID),i.mt&&(s.mt=i.mt),i.ct&&(s.ct=i.ct)),s}for(var o,C,e,t={version:"1.1.3"},T=-2,B="d0cf11e0a1b11ae1",M=[208,207,17,224,161,177,26,225],D="00000000000000000000000000000000",I={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:T,FREESECT:-1,HEADER_SIGNATURE:B,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:D,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]},L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],O=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],N="undefined"!=typeof Uint8Array,z=N?new Uint8Array(256):[],l=0;l<256;++l)z[l]=(e=void 0,255&((e=139536&(l<<1|l<<11)|558144&(l<<5|l<<15))>>16|e>>8|e));var c,W=(c=function(e,t){for(var n=0;n<e.length;){var i=Math.min(65535,e.length-n),r=n+i==e.length;for(t._W(1,+r),t._W(2,i),t._W(2,65535&~i);0<i--;)t[t.l++]=e[n++]}return t.l},function(e){var t=Q(50+Math.floor(1.1*e.length)),e=c(e,t);return t.slice(0,e)}),V=N?new Uint16Array(512):R(512),$=N?new Uint16Array(32):R(32);if(!N){for(var u=0;u<512;++u)V[u]=0;for(u=0;u<32;++u)$[u]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);A(e,$,32);for(var n=[],t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);A(n,V,288)}();var U=N?new Uint16Array(32768):R(32768),H=N?new Uint16Array(32768):R(32768),X=N?new Uint16Array(128):R(128),G=1,j=1;return t.find=function(e,t){var n=e.FullPaths.map(function(e){return e.toUpperCase()}),i=n.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),r=!1;47===t.charCodeAt(0)?(r=!0,t=n[0].slice(0,-1)+t):r=-1!==t.indexOf("/");var a=t.toUpperCase(),s=(!0===r?n:i).indexOf(a);if(-1!==s)return e.FileIndex[s];var o=!a.match(ra),a=a.replace(ia,"");for(o&&(a=a.replace(ra,"!")),s=0;s<n.length;++s){if((o?n[s].replace(ra,"!"):n[s]).replace(ia,"")==a)return e.FileIndex[s];if((o?i[s].replace(ra,"!"):i[s]).replace(ia,"")==a)return e.FileIndex[s]}return null},t.read=function(e,t){switch(t&&t.type||"base64"){case"file":return n=e,i=t,r(),a(o.readFileSync(n),i);case"base64":return a(ta(qr.decode(e)),t);case"binary":return a(ta(e),t)}var n,i;return a(e,t)},t.parse=a,t.write=function(e,t){var n=i(e,t);switch(t&&t.type){case"file":return r(),o.writeFileSync(t.filename,n),n;case"binary":return s(n);case"base64":return qr.encode(s(n))}return n},t.writeFile=function(e,t,n){r(),n=i(e,n),o.writeFileSync(t,n)},t.utils={cfb_new:function(e){var t={};return p(t,e),t},cfb_add:_,cfb_del:function(e,t){p(e);var n=da.find(e,t);if(n)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==n)return e.FileIndex.splice(i,1),e.FullPaths.splice(i,1),!0;return!1},cfb_mov:function(e,t,n){p(e);var i=da.find(e,t);if(i)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==i)return e.FileIndex[r].name=f(n),e.FullPaths[r]=n,!0;return!1},cfb_gc:function(e){m(e,!0)},ReadShift:Z,CheckField:q,prep_blob:ue,bconcat:na,use_zlib:function(e){try{var t=new e.InflateRaw;if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");C=e}catch(e){console.error("cannot use native zlib: "+(e.message||e))}},_deflateRaw:W,_inflateRaw:y,consts:I},t}();if("undefined"!=typeof require)try{ha=require("fs")}catch(i){}var fa,pa=new Date(1899,11,30,0,0,0),ma=pa.getTime()+6e4*((new Date).getTimezoneOffset()-pa.getTimezoneOffset()),ga=new Date("2017-02-19T19:06:09.000Z"),va=2017==(ga=isNaN(ga.getFullYear())?new Date("2/19/17"):ga).getFullYear(),ba=5=="abacaba".split(/(:?b)/i).length;"undefined"!=typeof JSZipSync&&(fa=JSZipSync),"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&void 0===fa&&(fa=void 0);var Sa='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',ya=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,xa=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s?[\/\?]?>/g;Sa.match(xa)||(xa=/<[^>]*>/g);var wa,_a,Ca,Ea=/<\w*:/,ka=/<(\/?)\w+:/,Pa={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ra=t(Pa),Aa=(_a=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/g,Ca=/_x([\da-fA-F]{4})_/g,function e(t){var n=t+"",i=n.indexOf("<![CDATA[");if(-1==i)return n.replace(_a,function(e,t){return Pa[e]||String.fromCharCode(parseInt(t,-1<e.indexOf("x")?16:10))||e}).replace(Ca,function(e,t){return String.fromCharCode(parseInt(t,16))});t=n.indexOf("]]>");return e(n.slice(0,i))+n.slice(i+9,t)+e(n.slice(t+3))}),Ta=/[&<>'"]/g,Ba=/[\u0000-\u0008\u000b-\u001f]/g,Ma=/[\u0000-\u001f]/g,Da=(wa=/&#(\d+);/g,function(e){return e.replace(wa,Oa)}),Ia=function(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")},La=function(e){for(var t,n,i,r,a="",s=0,o=0;s<e.length;)(t=e.charCodeAt(s++))<128?a+=String.fromCharCode(t):(n=e.charCodeAt(s++),191<t&&t<224?(o=(31&t)<<6,o|=63&n,a+=String.fromCharCode(o)):(i=e.charCodeAt(s++),t<240?a+=String.fromCharCode((15&t)<<12|(63&n)<<6|63&i):(r=((7&t)<<18|(63&n)<<12|(63&i)<<6|63&(o=e.charCodeAt(s++)))-65536,a+=String.fromCharCode(55296+(r>>>10&1023)),a+=String.fromCharCode(56320+(1023&r)))));return a},Fa=function(e){for(var t,n=[],i=0,r=0;i<e.length;)switch(r=e.charCodeAt(i++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(63&r)));break;case 55296<=r&&r<57344:r-=55296,t=e.charCodeAt(i++)-56320+(r<<10),n.push(String.fromCharCode(240+(t>>18&7))),n.push(String.fromCharCode(144+(t>>12&63))),n.push(String.fromCharCode(128+(t>>6&63))),n.push(String.fromCharCode(128+(63&t)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(63&r)))}return n.join("")};function Oa(e,t){return String.fromCharCode(parseInt(t,10))}Qr&&(bc=function(e){for(var t,n,i=Buffer.alloc(2*e.length),r=1,a=0,s=0,o=0;o<e.length;o+=r)r=1,(n=e.charCodeAt(o))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(o+1)),r=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(o+1))+(63&e.charCodeAt(o+2)),r=3):(r=4,t=262144*(7&n)+4096*(63&e.charCodeAt(o+1))+64*(63&e.charCodeAt(o+2))+(63&e.charCodeAt(o+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(i[a++]=255&s,i[a++]=s>>>8,s=0),i[a++]=t%256,i[a++]=t>>>8;return i.slice(0,a).toString("ucs2")},yc=function(e){return Jr(e,"binary").toString("utf8")},(La=La(Sc="foo bar baz")==bc(Sc)?bc:La)(Sc)==yc(Sc)&&(La=yc),Fa=function(e){return Jr(e,"utf8").toString("binary")});var Na,za,Wa,Va,$a,Ua=(Wa={},function(e,t){var n=e+"|"+(t||"");return Wa[n]||(Wa[n]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",t||""))}),Ha=(za=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","g"),e[1]]}),function(e){for(var t=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<za.length;++n)t=t.replace(za[n][0],za[n][1]);return t}),Xa=(Na={},function(e){return void 0!==Na[e]?Na[e]:Na[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}),Ga=/<\/?(?:vt:)?variant>/g,ja=/<(?:vt:)([^>]*)>([\s\S]*)</,Ya=/(^\s|\s$|\n)/,Ka={dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema",main:["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"]},Za={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"},qa=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,r=e[0][n].length;i<r;i+=10240)t.push.apply(t,e[0][n].slice(i,i+10240));return t},Qa=qa,Ja=function(e,t,n){for(var i=[],r=t;r<n;r+=2)i.push(String.fromCharCode(ys(e,r)));return i.join("").replace(ia,"")},es=Ja,ts=function(e,t,n){for(var i=[],r=t;r<t+n;++r)i.push(("0"+e[r].toString(16)).slice(-2));return i.join("")},ns=ts,is=function(e,t,n){for(var i=[],r=t;r<n;r++)i.push(String.fromCharCode(Ss(e,r)));return i.join("")},rs=is,as=function(e,t){var n=ws(e,t);return 0<n?is(e,t+4,t+4+n-1):""},ss=as,os=function(e,t){var n=ws(e,t);return 0<n?is(e,t+4,t+4+n-1):""},ls=os,cs=function(e,t){var n=2*ws(e,t);return 0<n?is(e,t+4,t+4+n-1):""},us=cs,hs=Va=function(e,t){var n=ws(e,t);return 0<n?Ja(e,t+4,t+4+n):""},ds=function(e,t){var n=ws(e,t);return 0<n?is(e,t+4,t+4+n):""},fs=ds,ps=$a=function(e,t){for(var n=1-2*(e[t+7]>>>7),i=((127&e[t+7])<<4)+(e[t+6]>>>4&15),r=15&e[t+6],a=5;0<=a;--a)r=256*r+e[t+a];return 2047==i?0==r?1/0*n:NaN:(0==i?i=-1022:(i-=1023,r+=Math.pow(2,52)),n*Math.pow(2,i-52)*r)},ms=function(e){return Array.isArray(e)};Qr&&(Ja=function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(ia,""):es(e,t,n)},ts=function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):ns(e,t,n)},as=function(e,t){if(!Buffer.isBuffer(e))return ss(e,t);var n=e.readUInt32LE(t);return 0<n?e.toString("utf8",t+4,t+4+n-1):""},os=function(e,t){if(!Buffer.isBuffer(e))return ls(e,t);var n=e.readUInt32LE(t);return 0<n?e.toString("utf8",t+4,t+4+n-1):""},cs=function(e,t){if(!Buffer.isBuffer(e))return us(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},hs=function(e,t){if(!Buffer.isBuffer(e))return Va(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},ds=function(e,t){if(!Buffer.isBuffer(e))return fs(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},is=function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):rs(e,t,n)},qa=function(e){return 0<e[0].length&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0]):Qa(e)},na=function(e){return Buffer.isBuffer(e[0])?Buffer.concat(e):[].concat.apply([],e)},ps=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):$a(e,t)},ms=function(e){return Buffer.isBuffer(e)||Array.isArray(e)}),"undefined"!=typeof cptable&&(Ja=function(e,t,n){return cptable.utils.decode(1200,e.slice(t,n)).replace(ia,"")},is=function(e,t,n){return cptable.utils.decode(65001,e.slice(t,n))},as=function(e,t){var n=ws(e,t);return 0<n?cptable.utils.decode(Wr,e.slice(t+4,t+4+n-1)):""},os=function(e,t){var n=ws(e,t);return 0<n?cptable.utils.decode(zr,e.slice(t+4,t+4+n-1)):""},cs=function(e,t){var n=2*ws(e,t);return 0<n?cptable.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},hs=function(e,t){var n=ws(e,t);return 0<n?cptable.utils.decode(1200,e.slice(t+4,t+4+n)):""},ds=function(e,t){var n=ws(e,t);return 0<n?cptable.utils.decode(65001,e.slice(t+4,t+4+n)):""});function gs(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255}function vs(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255}function bs(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255}var Ss=function(e,t){return e[t]},ys=function(e,t){return 256*e[t+1]+e[t]},xs=function(e,t){t=256*e[t+1]+e[t];return t<32768?t:-1*(65535-t+1)},ws=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},_s=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Cs=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};!function(e,t){var n;if(void 0!==t)n=t;else if("undefined"!=typeof require)try{n=void 0}catch(e){n=null}e.rc4=function(e,t){for(var n=new Array(256),i=0,r=0,a=0,s=0,r=0;256!=r;++r)n[r]=r;for(r=0;256!=r;++r)a=a+n[r]+e[r%e.length].charCodeAt(0)&255,s=n[r],n[r]=n[a],n[a]=s;r=a=0;for(var o=Buffer(t.length),i=0;i!=t.length;++i)a=(a+n[r=r+1&255])%256,s=n[r],n[r]=n[a],n[a]=s,o[i]=t[i]^n[n[r]+n[a]&255];return o},e.md5=function(e){if(!n)throw new Error("Unsupported crypto");return n.createHash("md5").update(e).digest("hex")}}({},"undefined"!=typeof crypto?crypto:void 0);var Es=ye,ks=be,Ps=Se,Rs=be,As=Ce,Ts=Ee,Bs=Pe,Ms=function(e,t){return(t=t||Q(16))._W(4,e.s.r),t._W(4,e.e.r),t._W(4,e.s.c),t._W(4,e.e.c),t},Ds={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Is=x(Ds),Ls=12,Fs=[80,81],Os={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4096|Ls},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{}},Ns={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{}},zs={2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};!function(){for(var e in zs)zs.hasOwnProperty(e)&&(Os[e]=Ns[e]=zs[e])}();var Ws,Vs=e(Os,"n"),$s=e(Ns,"n"),Us={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Hs=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Xs=ne([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(e){return[e>>16&255,e>>8&255,255&e]})),Gs={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.sheetMetadata":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"TODO","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"vba","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},js=(ce(Ws={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}}).forEach(function(t){["xlsm","xlam"].forEach(function(e){Ws[t][e]||(Ws[t][e]=Ws[t].xlsx)})}),ce(Ws).forEach(function(t){ce(Ws[t]).forEach(function(e){Gs[Ws[t][e]]=t})}),Ws),Ys=function(e){for(var t=[],n=ce(e),i=0;i!==n.length;++i)null==t[e[n[i]]]&&(t[e[n[i]]]=[]),t[e[n[i]]].push(n[i]);return t}(Gs);Ka.CT="http://schemas.openxmlformats.org/package/2006/content-types";var Ks=I("Types",null,{xmlns:Ka.CT,"xmlns:xsd":Ka.xsd,"xmlns:xsi":Ka.xsi}),Zs=[["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels",Ys.rels[0]]].map(function(e){return I("Default",null,{Extension:e[0],ContentType:e[1]})}),qs={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};Ka.RELS="http://schemas.openxmlformats.org/package/2006/relationships";var Qs,Js=I("Relationships",null,{xmlns:Ka.RELS}),eo=[qs.HLINK,qs.XPATH,qs.XMISS],to="application/vnd.oasis.opendocument.spreadsheet",no=(Qs='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+i.version+"</meta:generator></office:meta></office:document-meta>",function(){return Qs}),io=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];Ka.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",qs.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties";var ro=function(){for(var e=new Array(io.length),t=0;t<io.length;++t){var n=io[t],n="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}(),ao=I("cp:coreProperties",null,{"xmlns:cp":Ka.CORE_PROPS,"xmlns:dc":Ka.dc,"xmlns:dcterms":Ka.dcterms,"xmlns:dcmitype":Ka.dcmitype,"xmlns:xsi":Ka.xsi}),so=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];Ka.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",qs.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties";var oo=I("Properties",null,{xmlns:Ka.EXT_PROPS,"xmlns:vt":Ka.vt});Ka.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",qs.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties";function lo(e,t,n){return 0===t?"":ft(e,0,n)}var co=/<[^>]+>[^<]*/g,uo=I("Properties",null,{xmlns:Ka.CUST_PROPS,"xmlns:vt":Ka.vt}),ho={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},fo=t(ho),po=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"].concat(["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"]),mo=Ct,go={0:kt,4:kt,5:kt,6:kt,7:function(e){return e.l+=4,e.cf=e._R(2),{}},8:kt,9:kt,10:kt,11:kt,12:kt,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e._R(2),e.l+=4,t},14:kt,15:kt,16:kt,17:kt,18:kt,19:kt,20:kt,21:Et},vo=ft,bo=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],So=[];So[8]=function(e,t){var n=e.l+t;e.l+=10;var i=e._R(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;t=e._R(1);return e.l+=t,e.l=n,{fmt:i}};var yo,xo,wo,_o,Co,Eo,ko,Po,Ro,Ao,To,Bo,Mo,Do,Io,Lo,Fo,Oo,No,zo,Wo=St,Vo=ct,$o=dt,Uo=(Oo={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,255:16969},No=t({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),zo={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(e,t){try{return pe(_l(e,t),t)}catch(e){if(t&&t.WTF)throw e}return{SheetNames:[],Sheets:{}}},to_sheet:_l,from_sheet:function(e,t){if(0<=+(t=t||{}).codepage&&Xr(+t.codepage),"string"==t.type)throw new Error("Cannot write DBF to JS string");for(var n=y(),i=(t=Dr(e,{header:1,raw:!0,cellDates:!0}))[0],r=t.slice(1),a=0,s=0,o=0,l=1,a=0;a<i.length;++a)if(null!=a){if(++o,"number"==typeof i[a]&&(i[a]=i[a].toString(10)),"string"!=typeof i[a])throw new Error("DBF Invalid column name "+i[a]+" |"+typeof i[a]+"|");if(i.indexOf(i[a])!==a)for(s=0;s<1024;++s)if(-1==i.indexOf(i[a]+"_"+s)){i[a]+="_"+s;break}}var c=oe(e["!ref"]),u=[];for(a=0;a<=c.e.c-c.s.c;++a){var h=[];for(s=0;s<r.length;++s)null!=r[s][a]&&h.push(r[s][a]);if(0!=h.length&&null!=i[a]){for(var d="",f="",s=0;s<h.length;++s){switch(typeof h[s]){case"number":f="B";break;case"string":f="C";break;case"boolean":f="L";break;case"object":f=h[s]instanceof Date?"D":"C";break;default:f="C"}if("C"==(d=d&&d!=f?"C":f))break}l+=zo[d]||0,u[a]=d}else u[a]="?"}var p,m,g=n.next(32);for(g._W(4,318902576),g._W(4,r.length),g._W(2,296+32*o),g._W(2,l),a=0;a<4;++a)g._W(4,0);for(g._W(4,0|(+No[Wr]||3)<<8),s=a=0;a<i.length;++a)null!=i[a]&&(p=n.next(32),m=(i[a].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),p._W(1,m,"sbcs"),p._W(1,"?"==u[a]?"C":u[a],"sbcs"),p._W(4,s),p._W(1,zo[u[a]]||0),p._W(1,0),p._W(1,2),p._W(4,0),p._W(1,0),p._W(4,0),p._W(4,0),s+=zo[u[a]]||0);var v=n.next(264);for(v._W(4,13),a=0;a<65;++a)v._W(4,0);for(a=0;a<r.length;++a){var b=n.next(l);for(b._W(1,0),s=0;s<i.length;++s)if(null!=i[s])switch(u[s]){case"L":b._W(1,null==r[a][s]?63:r[a][s]?84:70);break;case"B":b._W(8,r[a][s]||0,"f");break;case"D":r[a][s]?(b._W(4,("0000"+r[a][s].getFullYear()).slice(-4),"sbcs"),b._W(2,("00"+(r[a][s].getMonth()+1)).slice(-2),"sbcs"),b._W(2,("00"+r[a][s].getDate()).slice(-2),"sbcs")):b._W(8,"00000000","sbcs");break;case"C":var S=String(r[a][s]||"");for(b._W(1,S,"sbcs"),o=0;o<250-S.length;++o)b._W(1,32)}}return n.next(1)._W(1,26),n.end()}}),Ho=(Do={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,B:180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},Io=new RegExp("N("+ce(Do).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),Lo=function(e,t){t=Do[t];return"number"==typeof t?Yr(t):t},Fo=function(e,t,n){n=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==n?e:Yr(n)},Do["|"]=254,{to_workbook:function(e,t){return pe(wl(e,t),t)},to_sheet:wl,from_sheet:function(e,t){var i,n,r=["ID;PWXL;N;E"],a=[],s=oe(e["!ref"]),o=Array.isArray(e),l="\r\n";r.push("P;PGeneral"),r.push("F;P0;DG0G8;M255"),e["!cols"]&&(n=r,e["!cols"].forEach(function(e,t){t="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?t+="0":("number"==typeof e.width&&(e.wpx=en(e.width)),"number"==typeof e.wpx&&(e.wch=tn(e.wpx)),"number"==typeof e.wch&&(t+=Math.round(e.wch)))," "!=t.charAt(t.length-1)&&n.push(t)})),e["!rows"]&&(i=r,e["!rows"].forEach(function(e,t){var n="F;";e.hidden?n+="M0;":e.hpt?n+="M"+20*e.hpt+";":e.hpx&&(n+="M"+20*on(e.hpx)+";"),2<n.length&&i.push(n+"R"+(t+1))})),r.push("B;Y"+(s.e.r-s.s.r+1)+";X"+(s.e.c-s.s.c+1)+";D"+[s.s.c,s.s.r,s.e.c,s.e.r].join(" "));for(var c=s.s.r;c<=s.e.r;++c)for(var u=s.s.c;u<=s.e.c;++u){var h=he({r:c,c:u});(h=o?(e[c]||[])[u]:e[h])&&(null!=h.v||h.f&&!h.F)&&a.push(function(e,t,n){var i="C;Y"+(t+1)+";X"+(n+1)+";K";switch(e.t){case"n":i+=e.v||0,e.f&&!e.F&&(i+=";E"+fc(e.f,{r:t,c:n}));break;case"b":i+=e.v?"TRUE":"FALSE";break;case"e":i+=e.w||e.v;break;case"d":i+='"'+(e.w||e.v)+'"';break;case"s":i+='"'+e.v.replace(/"/g,"")+'"'}return i}(h,c,u))}return r.join(l)+l+a.join(l)+l+"E"+l}}),Xo={to_workbook:function(e,t){return pe(bl(e,t),t)},to_sheet:bl,from_sheet:function(e){var t,n=[],i=oe(e["!ref"]),r=Array.isArray(e);Sl(n,"TABLE",0,1,"sheetjs"),Sl(n,"VECTORS",0,i.e.r-i.s.r+1,""),Sl(n,"TUPLES",0,i.e.c-i.s.c+1,""),Sl(n,"DATA",0,0,"");for(var a=i.s.r;a<=i.e.r;++a){yl(n,-1,0,"BOT");for(var s=i.s.c;s<=i.e.c;++s){var o=he({r:a,c:s});if(t=r?(e[a]||[])[s]:e[o])switch(t.t){case"n":var l=t.w;null==(l=!l&&null!=t.v?t.v:l)?t.f&&!t.F?yl(n,1,0,"="+t.f):yl(n,1,0,""):yl(n,0,l,"V");break;case"b":yl(n,0,t.v?1:0,t.v?"TRUE":"FALSE");break;case"s":yl(n,1,0,isNaN(t.v)?t.v:'="'+t.v+'"');break;case"d":t.w||(t.w=aa.format(t.z||aa._table[14],G(te(t.v)))),yl(n,0,t.w,"V");break;default:yl(n,1,0,"")}else yl(n,1,0,"")}}return yl(n,-1,0,"EOD"),n.join("\r\n")}},Go=(Ao=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),To=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",Bo=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),Mo="--SocialCalcSpreadsheetControlSave--",{to_workbook:function(e,t){return pe(gl(e,t),t)},to_sheet:gl,from_sheet:function(e){return[Ao,To,Bo,To,function(e){if(!e||!e["!ref"])return"";for(var t,n,i=[],r=[],a=J(e["!ref"]),s=Array.isArray(e),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l)if(n=he({r:o,c:l}),(t=s?(e[o]||[])[l]:e[n])&&null!=t.v&&"z"!==t.t){switch(r=["cell",n,"t"],t.t){case"s":case"str":r.push(ml(t.v));break;case"n":t.f?(r[2]="vtf",r[3]="n",r[4]=t.v,r[5]=ml(t.f)):(r[2]="v",r[3]=t.v);break;case"b":r[2]="vt"+(t.f?"f":"c"),r[3]="nl",r[4]=t.v?"1":"0",r[5]=ml(t.f||(t.v?"TRUE":"FALSE"));break;case"d":var c=G(te(t.v));r[2]="vtc",r[3]="nd",r[4]=""+c,r[5]=t.w||aa.format(t.z||aa._table[14],c);break;case"e":continue}i.push(r.join(":"))}return i.push("sheet:c:"+(a.e.c-a.s.c+1)+":r:"+(a.e.r-a.s.r+1)+":tvf:1"),i.push("valueformat:1:text-wiki"),i.join("\n")}(e),Mo].join("\n")}}),jo=(Po={44:",",9:"\t",59:";"},Ro={44:3,9:2,59:1},{to_workbook:function(e,t){return pe(pl(e,t),t)},to_sheet:pl,from_sheet:function(e){for(var t=[],n=oe(e["!ref"]),i=Array.isArray(e),r=n.s.r;r<=n.e.r;++r){for(var a=[],s=n.s.c;s<=n.e.c;++s){var o=he({r:r,c:s});if((o=i?(e[r]||[])[s]:e[o])&&null!=o.v){for(var l=(o.w||(fe(o),o.w)||"").slice(0,10);l.length<10;)l+=" ";a.push(l+(0===s?" ":""))}else a.push("          ")}t.push(a.join(""))}return t.join("\n")}}),Yo=(Eo={0:{n:"BOF",f:ot},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e){var t={s:{c:0,r:0},e:{c:0,r:0}};return t.s.c=e._R(2),t.s.r=e._R(2),t.e.c=e._R(2),t.e.r=e._R(2),65535==t.s.c&&(t.s.c=t.e.c=t.s.r=t.e.r=0),t}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,n){return(n=sl(e,0,n))[1].v=e._R(2,"i"),n}},14:{n:"NUMBER",f:function(e,t,n){return(n=sl(e,0,n))[1].v=e._R(8,"f"),n}},15:{n:"LABEL",f:ol},16:{n:"FORMULA",f:function(e,t,n){var i=e.l+t;return(t=sl(e,0,n))[1].v=e._R(8,"f"),n.qpro?e.l=i:(i=e._R(2),e.l+=i),t}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:ol},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},255:{n:"",f:v}},ko={0:{n:"BOF"},1:{n:"EOF"},3:{n:"??"},4:{n:"??"},5:{n:"??"},6:{n:"??"},7:{n:"??"},9:{n:"??"},10:{n:"??"},11:{n:"??"},12:{n:"??"},14:{n:"??"},15:{n:"??"},16:{n:"??"},17:{n:"??"},18:{n:"??"},19:{n:"??"},21:{n:"??"},22:{n:"LABEL16",f:function(e,t){var n=ll(e);return n[1].t="s",n[1].v=e._R(t-4,"cstr"),n}},23:{n:"NUMBER17",f:cl},24:{n:"NUMBER18",f:function(e,t){var n=ll(e);n[1].v=e._R(2);var i=n[1].v>>1;if(1&n[1].v)switch(7&i){case 1:i=500*(i>>3);break;case 2:i=(i>>3)/20;break;case 4:i=(i>>3)/2e3;break;case 6:i=(i>>3)/16;break;case 7:i=(i>>3)/64;break;default:throw"unknown NUMBER_18 encoding "+(7&i)}return n[1].v=i,n}},25:{n:"FORMULA19",f:function(e,t){var n=cl(e);return e.l+=t-14,n}},26:{n:"??"},27:{n:"??"},28:{n:"??"},29:{n:"??"},30:{n:"??"},31:{n:"??"},33:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=ll(e),e=e._R(4);return n[1].v=e>>6,n}},39:{n:"NUMBER27",f:ul},40:{n:"FORMULA28",f:function(e,t){var n=ul(e);return e.l+=t-10,n}},255:{n:"",f:v}},{to_workbook:function(e,t){switch(t.type){case"base64":return al(ta(qr.decode(e)),t);case"binary":return al(ta(e),t);case"buffer":case"array":return al(e,t)}throw"Unsupported type "+t.type}}),Ko=(xo=Ua("t"),wo=Ua("rPr"),_o=/<(?:\w+:)?r>/g,Co=/<\/(?:\w+:)?r>/,function(e){return e.replace(_o,"").split(Co).map(rl).filter(function(e){return e.v})}),Zo=(yo=/(\r\n|\n)/g,function(e){return e.map(il).join("")}),qo=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Qo=/<(?:\w+:)?r>/,Jo=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g,el=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,tl=/<(?:\w+:)?(?:si|sstItem)>/g,nl=/<\/(?:\w+:)?(?:si|sstItem)>/;function il(e){var t,n,i,r=[[],e.v,[]];return e.v?(e.s&&(t=e.s,n=r[0],i=r[2],e=[],t.u&&e.push("text-decoration: underline;"),t.uval&&e.push("text-underline-style:"+t.uval+";"),t.sz&&e.push("font-size:"+t.sz+"pt;"),t.outline&&e.push("text-effect: outline;"),t.shadow&&e.push("text-shadow: auto;"),n.push('<span style="'+e.join("")+'">'),t.b&&(n.push("<b>"),i.push("</b>")),t.i&&(n.push("<i>"),i.push("</i>")),t.strike&&(n.push("<s>"),i.push("</s>")),"superscript"==(e=t.valign||"")||"super"==e?e="sup":"subscript"==e&&(e="sub"),""!=e&&(n.push("<"+e+">"),i.push("</"+e+">")),i.push("</span>")),r[0].join("")+r[1].replace(yo,"<br/>")+r[2].join("")):""}function rl(e){var t=e.match(xo);if(!t)return{t:"s",v:""};t={t:"s",v:Aa(t[1])},e=e.match(wo);return e&&(t.s=function(e){var t={},n=e.match(xa),i=0,r=!1;if(n)for(;i!=n.length;++i){var a=ie(n[i]);switch(a[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==a.val)break;t.cp=Hr[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==a.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==a.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<family":t.family=a.val;break;case"<vertAlign":t.valign=a.val;break;case"<scheme":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(47!==a[0].charCodeAt(1)&&!r)throw new Error("Unrecognized rich format "+a[0])}}return t}(e[1])),t}function al(i,e){if(!i)return i;var r=e||{};null!=Zr&&null==r.dense&&(r.dense=Zr);var a=r.dense?[]:{},s="Sheet1",o=0,l={},c=[s],u={s:{r:0,c:0},e:{r:0,c:0}},h=r.sheetRows||0;if(2==i[2])r.Enum=Eo;else if(26==i[2])r.Enum=ko;else{if(14!=i[2])throw new Error("Unrecognized LOTUS BOF "+i[2]);r.Enum=ko,r.qpro=!0,i.l=0}return function(e,t,n){if(e){ue(e,e.l||0);for(var i=n.Enum||Eo;e.l<e.length;){var r=e._R(2),a=i[r]||i[255],s=e._R(2),o=e.l+s,s=(a.f||v)(e,s,n);if(e.l=o,t(s,a.n,r))return}}}(i,function(e,t,n){if(2==i[2])switch(n){case 0:4096<=(r.vers=e)&&(r.qpro=!0);break;case 6:u=e;break;case 15:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:case 51:14==n&&112==(112&e[2])&&1<(15&e[2])&&(15&e[2])<15&&(e[1].z=r.dateNF||aa._table[14],r.cellDates&&(e[1].t="d",e[1].v=F(e[1].v))),r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[he(e[0])]=e[1]}else switch(n){case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=de(u),l[s]=a,a=r.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s="Sheet"+(o+1),c.push(s)),0<h&&e[0].r>=h)break;r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[he(e[0])]=e[1],u.e.c<e[0].c&&(u.e.c=e[0].c),u.e.r<e[0].r&&(u.e.r=e[0].r)}},r),a["!ref"]=de(u),l[s]=a,{SheetNames:c,Sheets:l}}function sl(e,t,n){var i=[{c:0,r:0},{t:"n",v:0},0];return n.qpro&&20768!=n.vers?(i[0].c=e._R(1),e.l++,i[0].r=e._R(2),e.l+=2):(i[2]=e._R(1),i[0].c=e._R(2),i[0].r=e._R(2)),i}function ol(e,t,n){var i=e.l+t,t=sl(e,0,n);if(t[1].t="s",20768!=n.vers)return n.qpro&&e.l++,t[1].v=e._R(i-e.l,"cstr"),t;e.l++;i=e._R(1);return t[1].v=e._R(i,"utf8"),t}function ll(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e._R(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function cl(e,t){var n=ll(e),i=e._R(4),r=e._R(4),e=e._R(2);return n[1].v=65535==e?0:(2*(32768&e)-1)*((0<(e=(32767&e)-16446)?r<<e:r>>>-e)+(-32<e?i<<32+e:i>>>-(32+e))),n}function ul(e,t){var n=ll(e),e=e._R(8,"f");return n[1].v=e,n}function hl(e,t,n,i,r){r.raw?t[n][i]=e:"TRUE"===e?t[n][i]=!0:"FALSE"===e?t[n][i]=!1:""===e||(isNaN(_(e))?isNaN(C(e).getDate())?t[n][i]=e:t[n][i]=te(e):t[n][i]=_(e))}function dl(i,e){function t(){var e,t=i.slice(u,h),n={};if(0===(t='"'==t.charAt(0)&&'"'==t.charAt(t.length-1)?t.slice(1,-1).replace(/""/g,'"'):t).length?n.t="z":r.raw||0===t.trim().length?(n.t="s",n.v=t):61==t.charCodeAt(0)?34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(n.t="n",n.f=t.slice(1)):(n.t="s",n.v=t):"TRUE"==t?(n.t="b",n.v=!0):"FALSE"==t?(n.t="b",n.v=!1):isNaN(c=_(t))?!isNaN(C(t).getDate())||p&&t.match(p)?(n.z=r.dateNF||aa._table[14],e=0,p&&t.match(p)&&(t=function(e,i){var r=-1,a=-1,s=-1,o=-1,l=-1,c=-1;(e.match(ua)||[]).forEach(function(e,t){var n=parseInt(i[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=n;break;case"d":s=n;break;case"h":o=n;break;case"s":c=n;break;case"m":0<=o?l=n:a=n}}),0<=c&&-1==l&&0<=a&&(l=a,a=-1);var t=(""+(0<=r?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(1<=a?a:1)).slice(-2)+"-"+("00"+(1<=s?s:1)).slice(-2);return 8==(t=7==t.length?"0"+t:t).length&&(t="20"+t),e=("00"+(0<=o?o:0)).slice(-2)+":"+("00"+(0<=l?l:0)).slice(-2)+":"+("00"+(0<=c?c:0)).slice(-2),-1==o&&-1==l&&-1==c?t:-1==r&&-1==a&&-1==s?e:t+"T"+e}(r.dateNF,t.match(p)||[]),e=1),r.cellDates?(n.t="d",n.v=te(t,e)):(n.t="n",n.v=G(te(t,e))),!1!==r.cellText&&(n.w=aa.format(n.z,n.v instanceof Date?G(n.v):n.v)),r.cellNF||delete n.z):(n.t="s",n.v=t):(!(n.t="n")!==r.cellText&&(n.w=t),n.v=c),"z"==n.t||(r.dense?(a[o]||(a[o]=[]),a[o][l]=n):a[he({c:l,r:o})]=n),u=h+1,s.e.c<l&&(s.e.c=l),s.e.r<o&&(s.e.r=o),f==d)++l;else if(l=0,++o,r.sheetRows&&r.sheetRows<=o)return 1}var r=e||{},e="";null!=Zr&&null==r.dense&&(r.dense=Zr);var a=r.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==i.slice(0,4)&&10==i.charCodeAt(5)?(e=i.charAt(4),i=i.slice(6)):e=function(e){for(var t={},n=!1,i=0,r=0;i<e.length;++i)34==(r=e.charCodeAt(i))?n=!n:!n&&r in Po&&(t[r]=(t[r]||0)+1);for(i in r=[],t)t.hasOwnProperty(i)&&r.push([t[i],i]);if(!r.length)for(i in t=Ro)t.hasOwnProperty(i)&&r.push([t[i],i]);return r.sort(function(e,t){return e[0]-t[0]||Ro[e[1]]-Ro[t[1]]}),Po[r.pop()[1]]}(i.slice(0,1024));var o=0,l=0,c=0,u=0,h=0,d=e.charCodeAt(0),n=!1,f=0;i=i.replace(/\r\n/gm,"\n");var p=null!=r.dateNF?(e=(e="number"==typeof(e=r.dateNF)?aa._table[e]:e).replace(ua,"(\\d+)"),new RegExp("^"+e+"$")):null;e:for(;h<i.length;++h)switch(f=i.charCodeAt(h)){case 34:n=!n;break;case d:case 10:case 13:if(!n&&t())break e}return 0<h-u&&t(),a["!ref"]=de(s),a}function fl(e,t){return"sep="==e.slice(0,4)||0<=e.indexOf("\t")||0<=e.indexOf(",")||0<=e.indexOf(";")?dl(e,t):ge(function(e,t){var n=t||{},i=[];if(!e||0===e.length)return i;for(var r=e.split(/[\r\n]/),a=r.length-1;0<=a&&0===r[a].length;)--a;for(var s=10,o=0,l=0;l<=a;++l)-1==(o=r[l].indexOf(" "))?o=r[l].length:o++,s=Math.max(s,o);for(l=0;l<=a;++l){i[l]=[];var c=0;for(hl(r[l].slice(0,s).trim(),i,l,c,n),c=1;c<=(r[l].length-s)/10+1;++c)hl(r[l].slice(s+10*(c-1),s+10*c).trim(),i,l,c,n)}return i=n.sheetRows?i.slice(0,n.sheetRows):i}(e,t),t)}function pl(e,t){var n="",i="string"==t.type?[0,0,0,0]:yr(e,t);switch(t.type){case"base64":n=qr.decode(e);break;case"binary":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!=typeof cptable?cptable.utils.decode(t.codepage,e):e.toString("binary");break;case"array":n=h(e);break;case"string":n=e;break;default:throw new Error("Unrecognized type "+t.type)}return 239==i[0]&&187==i[1]&&191==i[2]?n=La(n.slice(3)):"binary"==t.type&&"undefined"!=typeof cptable&&t.codepage&&(n=cptable.utils.decode(t.codepage,cptable.utils.encode(1252,n))),"socialcalc:version:"==n.slice(0,19)?Go.to_sheet("string"==t.type?n:La(n),t):fl(n,t)}function ml(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function gl(e,t){return ge(function(e,t){for(var n,i=e.split("\n"),r=-1,a=0,s=[];a!==i.length;++a){var o=i[a].trim().split(":");if("cell"===o[0]){var l=j(o[1]);if(s.length<=l.r)for(r=s.length;r<=l.r;++r)s[r]||(s[r]=[]);switch(r=l.r,n=l.c,o[2]){case"t":s[r][n]=o[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":s[r][n]=+o[3];break;case"vtf":var c=o[o.length-1];case"vtc":"nl"===o[3]?s[r][n]=!!+o[4]:s[r][n]=+o[4],"vtf"==o[2]&&(s[r][n]=[s[r][n],c])}}}return s=t&&t.sheetRows?s.slice(0,t.sheetRows):s}(e,t),t)}function vl(e,t){for(var n=e.split("\n"),i=-1,r=-1,a=0,s=[];a!==n.length;++a)if("BOT"!==n[a].trim()){if(!(i<0)){var o=n[a].trim().split(","),l=o[0],c=o[1],u=n[++a].trim();switch(+l){case-1:if("BOT"===u){s[++i]=[],r=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[i][r]=!0:"FALSE"===u?s[i][r]=!1:isNaN(_(c))?isNaN(C(c).getDate())?s[i][r]=c:s[i][r]=te(c):s[i][r]=_(c),++r;break;case 1:u=u.slice(1,u.length-1),s[i][r++]=""!==u?u:null}if("EOD"===u)break}}else s[++i]=[],r=0;return s=t&&t.sheetRows?s.slice(0,t.sheetRows):s}function bl(e,t){return ge(function(e,t){switch(t.type){case"base64":return vl(qr.decode(e),t);case"binary":return vl(e,t);case"buffer":return vl(e.toString("binary"),t);case"array":return vl(h(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),t)}function Sl(e,t,n,i,r){e.push(t),e.push(n+","+i),e.push('"'+r.replace(/"/g,'""')+'"')}function yl(e,t,n,i){e.push(t+","+n),e.push(1==t?'"'+i.replace(/"/g,'""')+'"':i)}function xl(e,t){var n,i,r=e.split(/[\n\r]+/),a=-1,s=-1,o=0,l=0,c=[],u=[],h=null,e={},d=[],f=[],p=0;for(0<=+t.codepage&&Xr(+t.codepage);o!==r.length;++o){var m,p=0,g=r[o].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,Fo).replace(Io,Lo),v=g.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),b=v[0];if(0<g.length)switch(b){case"ID":case"E":case"B":case"O":break;case"P":"P"==v[1].charAt(0)&&u.push(g.slice(3).replace(/;;/g,";"));break;case"C":for(var S=!1,y=!1,l=1;l<v.length;++l)switch(v[l].charAt(0)){case"X":s=parseInt(v[l].slice(1))-1,y=!0;break;case"Y":for(a=parseInt(v[l].slice(1))-1,y||(s=0),n=c.length;n<=a;++n)c[n]=[];break;case"K":'"'===(m=v[l].slice(1)).charAt(0)?m=m.slice(1,m.length-1):"TRUE"===m?m=!0:"FALSE"===m?m=!1:isNaN(_(m))?isNaN(C(m).getDate())||(m=te(m)):(m=_(m),null!==h&&aa.is_date(h)&&(m=F(m))),"undefined"!=typeof cptable&&"string"==typeof m&&"string"!=(t||{}).type&&(t||{}).codepage&&(m=cptable.utils.decode(t.codepage,m)),S=!0;break;case"E":var x=hc(v[l].slice(1),{r:a,c:s});c[a][s]=[c[a][s],x];break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+g)}S&&(c[a][s]=m,h=null);break;case"F":var w=0;for(l=1;l<v.length;++l)switch(v[l].charAt(0)){case"X":s=parseInt(v[l].slice(1))-1,++w;break;case"Y":for(a=parseInt(v[l].slice(1))-1,n=c.length;n<=a;++n)c[n]=[];break;case"M":p=parseInt(v[l].slice(1))/20;break;case"F":case"G":break;case"P":h=u[parseInt(v[l].slice(1))];break;case"S":case"D":case"N":break;case"W":for(i=v[l].slice(1).split(" "),n=parseInt(i[0],10);n<=parseInt(i[1],10);++n)p=parseInt(i[2],10),f[n-1]=0===p?{hidden:!0}:{wch:p},sn(f[n-1]);break;case"C":f[s=parseInt(v[l].slice(1))-1]||(f[s]={});break;case"R":d[a=parseInt(v[l].slice(1))-1]||(d[a]={}),0<p?(d[a].hpt=p,d[a].hpx=ln(p)):0===p&&(d[a].hidden=!0);break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+g)}w<1&&(h=null);break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+g)}}return 0<d.length&&(e["!rows"]=d),0<f.length&&(e["!cols"]=f),[c=t&&t.sheetRows?c.slice(0,t.sheetRows):c,e]}function wl(e,t){var n=function(e,t){switch(t.type){case"base64":return xl(qr.decode(e),t);case"binary":return xl(e,t);case"buffer":return xl(e.toString("binary"),t);case"array":return xl(h(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),e=n[0],i=n[1],r=ge(e,t);return ce(i).forEach(function(e){r[e]=i[e]}),r}function _l(e,t){t=t||{};return t.dateNF||(t.dateNF="yyyymmdd"),ge(function(e,t){var n=[],i=Y(1);switch(t.type){case"base64":i=ta(qr.decode(e));break;case"binary":i=ta(e);break;case"buffer":case"array":i=e}ue(i,0);var r=i._R(1),a=!1,s=!1,o=!1;switch(r){case 2:case 3:break;case 48:a=s=!0;break;case 49:s=!0;break;case 131:case 139:a=!0;break;case 140:o=a=!0;break;case 245:a=!0;break;default:throw new Error("DBF Unsupported Version: "+r.toString(16))}var l=0,c=0;2==r&&(l=i._R(2)),i.l+=3,2!=r&&(l=i._R(4)),2!=r&&(c=i._R(2));var u=i._R(2),h=1252;2!=r&&(i.l+=16,i._R(1),0!==i[i.l]&&(h=Oo[i[i.l]]),i.l+=1,i.l+=2),o&&(i.l+=36);for(var d=[],f={},p=c-10-(s?264:0),m=o?32:11;2==r?i.l<i.length&&13!=i[i.l]:i.l<p;)switch(f={},f.name=cptable.utils.decode(h,i.slice(i.l,i.l+m)).replace(/[\u0000\r\n].*$/g,""),i.l+=m,f.type=String.fromCharCode(i._R(1)),2==r||o||(f.offset=i._R(4)),f.len=i._R(1),2==r&&(f.offset=i._R(2)),f.dec=i._R(1),f.name.length&&d.push(f),2!=r&&(i.l+=o?13:14),f.type){case"B":s&&8==f.len||!t.WTF||console.log("Skipping "+f.name+":"+f.type);break;case"G":case"P":t.WTF&&console.log("Skipping "+f.name+":"+f.type);break;case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":case"0":case"@":case"+":break;default:throw new Error("Unknown Field Type: "+f.type)}if(13!==i[i.l]?i.l=c-1:2==r&&(i.l=521),2!=r){if(13!==i._R(1))throw new Error("DBF Terminator not found "+i.l+" "+i[i.l]);i.l=c}var g=0,v=0;for(n[0]=[],v=0;v!=d.length;++v)n[0][v]=d[v].name;for(;0<l--;)if(42!==i[i.l])for(++i.l,n[++g]=[],v=v=0;v!=d.length;++v){var b=i.slice(i.l,i.l+d[v].len);i.l+=d[v].len,ue(b,0);var S=cptable.utils.decode(h,b);switch(d[v].type){case"C":n[g][v]=cptable.utils.decode(h,b),n[g][v]=n[g][v].trim();break;case"D":8===S.length?n[g][v]=new Date(+S.slice(0,4),+S.slice(4,6)-1,+S.slice(6,8)):n[g][v]=S;break;case"F":n[g][v]=parseFloat(S.trim());break;case"+":case"I":n[g][v]=o?2147483648^b._R(-4,"i"):b._R(4,"i");break;case"L":switch(S.toUpperCase()){case"Y":case"T":n[g][v]=!0;break;case"N":case"F":n[g][v]=!1;break;case" ":case"?":n[g][v]=!1;break;default:throw new Error("DBF Unrecognized L:|"+S+"|")}break;case"M":if(!a)throw new Error("DBF Unexpected MEMO for type "+r.toString(16));n[g][v]="##MEMO##"+(o?parseInt(S.trim(),10):b._R(4));break;case"N":n[g][v]=+S.replace(/\u0000/g,"").trim();break;case"@":n[g][v]=new Date(b._R(-8,"f")-621356832e5);break;case"T":n[g][v]=new Date(864e5*(b._R(4)-2440588)+b._R(4));break;case"Y":n[g][v]=b._R(4,"i")/1e4;break;case"O":n[g][v]=-b._R(-8,"f");break;case"B":if(s&&8==d[v].len){n[g][v]=b._R(8,"f");break}case"G":case"P":b.l+=d[v].len;break;case"0":if("_NullFlags"===d[v].name)break;default:throw new Error("DBF Unsupported data type "+d[v].type)}}else i.l+=u;if(2!=r&&i.l<i.length&&26!=i[i.l++])throw new Error("DBF EOF Marker missing "+(i.l-1)+" of "+i.length+" "+i[i.l-1].toString(16));return n=t&&t.sheetRows?n.slice(0,t.sheetRows):n}(e,t),t)}qs.SST="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings";var Cl,El,kl,Pl,Rl,Al,Tl,Bl,Ml,Dl=/^\s|\s$|[\t\n\r]/,Il=function(e,t){var n=!1;return null==t&&(n=!0,t=Q(15+4*e.t.length)),t._W(1,0),Se(e.t,t),n?t.slice(0,t.l):t},Ll=(Al=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],Tl=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],Bl=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],Ml=function(e){return 255&(e/2|128*e)},function(e){for(var t,n=Ut(e),i=function(e){for(var t=Tl[e.length-1],n=104,i=e.length-1;0<=i;--i)for(var r=e[i],a=0;7!=a;++a)64&r&&(t^=Bl[n]),r*=2,--n;return t}(n),r=n.length,a=Y(16),s=0;16!=s;++s)a[s]=0;for(1==(1&r)&&(a[r]=Zl(Al[0],i>>8),e=n[n.length-1],a[--r]=Zl(e,255&i));0<r;)a[--r]=Zl(n[r],i>>8),a[--r]=Zl(n[r],255&i);for(t=(r=15)-n.length;0<t;)a[r]=Zl(Al[t],i>>8),--t,a[--r]=Zl(n[r],255&i),--r,--t;return a}),Fl=function(e){var t=0,n=Ll(e);return function(e){e=function(e,t,n,i,r){var a,s;for(r=r||t,i=i||Ll(e),a=0;a!=t.length;++a)s=t[a],s^=i[n],r[a]=255&(s>>5|s<<3),++n;return[r,n,i]}("",e,t,n);return t=e[1],e[0]}},Ol={to_workbook:function(e,t){return pe(Yl(e,t),t)},to_sheet:Yl,from_sheet:function(e){for(var t=["{\\rtf1\\ansi"],n=oe(e["!ref"]),i=Array.isArray(e),r=n.s.r;r<=n.e.r;++r){t.push("\\trowd\\trautofit1");for(var a=n.s.c;a<=n.e.c;++a)t.push("\\cellx"+(a+1));for(t.push("\\pard\\intbl"),a=n.s.c;a<=n.e.c;++a){var s=he({r:r,c:a});(s=i?(e[r]||[])[a]:e[s])&&(null!=s.v||s.f&&!s.F)&&(t.push(" "+(s.w||(fe(s),s.w))),t.push("\\cell"))}t.push("\\pard\\intbl\\row")}return t.join("")+"}"}},Nl=6,zl=15,Wl=1,Vl=Nl,$l=96,Ul={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},Hl=["numFmtId","fillId","fontId","borderId","xfId"],Xl=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],Gl=(Cl=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,El=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,kl=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,Pl=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,Rl=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/,function(e,t,n){var i,r,a,s,o,l={};return e&&((i=(e=e.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(Cl))&&function(e,t,n){t.NumberFmt=[];for(var i=ce(aa._table),r=0;r<i.length;++r)t.NumberFmt[i[r]]=aa._table[i[r]];var a=e[0].match(xa);if(a)for(r=0;r<a.length;++r){var s=ie(a[r]);switch(p(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var o=Aa(La(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,0<l){if(392<l){for(l=392;60<l&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}aa.load(o,l)}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}(i,l,n),(i=e.match(Pl))&&function(e,i,r,a){i.Fonts=[];var s={},o=!1;(e[0].match(xa)||[]).forEach(function(e){var t=ie(e);switch(p(t[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":i.Fonts.push(s),s={};break;case"<name":t.val&&(s.name=t.val);break;case"<name/>":case"</name>":break;case"<b":s.bold=t.val?re(t.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=t.val?re(t.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(t.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=t.val?re(t.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=t.val?re(t.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=t.val?re(t.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=t.val?re(t.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=t.val?re(t.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":t.val&&(s.sz=+t.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":t.val&&(s.vertAlign=t.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":t.val&&(s.family=parseInt(t.val,10));break;case"<family/>":case"</family>":break;case"<scheme":t.val&&(s.scheme=t.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if("1"==t.val)break;t.codepage=Hr[parseInt(t.val,10)];break;case"<color":if(s.color||(s.color={}),t.auto&&(s.color.auto=re(t.auto)),t.rgb)s.color.rgb=t.rgb.slice(-6);else if(t.indexed){s.color.index=parseInt(t.indexed,10);var n=Xs[s.color.index];if(!(n=81==s.color.index?Xs[1]:n))throw new Error(e);s.color.rgb=n[0].toString(16)+n[1].toString(16)+n[2].toString(16)}else t.theme&&(s.color.theme=parseInt(t.theme,10),t.tint&&(s.color.tint=parseFloat(t.tint)),t.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Jt(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+t[0]+" in fonts")}})}(i,l,t,n),(i=e.match(kl))&&function(e,n,i){n.Fills=[];var r={},a=!1;(e[0].match(xa)||[]).forEach(function(e){var t=ie(e);switch(p(t[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":r={},n.Fills.push(r);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(r),r={};break;case"<patternFill":case"<patternFill>":t.patternType&&(r.patternType=t.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":r.bgColor||(r.bgColor={}),t.indexed&&(r.bgColor.indexed=parseInt(t.indexed,10)),t.theme&&(r.bgColor.theme=parseInt(t.theme,10)),t.tint&&(r.bgColor.tint=parseFloat(t.tint)),t.rgb&&(r.bgColor.rgb=t.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":r.fgColor||(r.fgColor={}),t.theme&&(r.fgColor.theme=parseInt(t.theme,10)),t.tint&&(r.fgColor.tint=parseFloat(t.tint)),null!=t.rgb&&(r.fgColor.rgb=t.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i&&i.WTF&&!a)throw new Error("unrecognized "+t[0]+" in fills")}})}(i,l,n),(i=e.match(Rl))&&function(e,n,i){n.Borders=[];var r={},a=!1;(e[0].match(xa)||[]).forEach(function(e){var t=ie(e);switch(p(t[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":r={},t.diagonalUp&&(r.diagonalUp=re(t.diagonalUp)),t.diagonalDown&&(r.diagonalDown=re(t.diagonalDown)),n.Borders.push(r);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i&&i.WTF&&!a)throw new Error("unrecognized "+t[0]+" in borders")}})}(i,l,n),(i=e.match(El))&&(i=i,a=n,o=!((r=l).CellXf=[]),(i[0].match(xa)||[]).forEach(function(e){var t=ie(e),n=0;switch(p(t[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(s=t)[0],n=0;n<Hl.length;++n)s[Hl[n]]&&(s[Hl[n]]=parseInt(s[Hl[n]],10));for(n=0;n<Xl.length;++n)s[Xl[n]]&&(s[Xl[n]]=re(s[Xl[n]]));if(392<s.numFmtId)for(n=392;60<n;--n)if(r.NumberFmt[s.numFmtId]==r.NumberFmt[n]){s.numFmtId=n;break}r.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var i={};t.vertical&&(i.vertical=t.vertical),t.horizontal&&(i.horizontal=t.horizontal),null!=t.textRotation&&(i.textRotation=t.textRotation),t.indent&&(i.indent=t.indent),t.wrapText&&(i.wrapText=re(t.wrapText)),s.alignment=i;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+t[0]+" in cellXfs")}}))),l}),jl=I("styleSheet",null,{xmlns:Ka.main[0],"xmlns:vt":Ka.vt});function Yl(e,t){switch(t.type){case"base64":return Kl(qr.decode(e),t);case"binary":return Kl(e,t);case"buffer":return Kl(e.toString("binary"),t);case"array":return Kl(h(e),t)}throw new Error("Unrecognized type "+t.type)}function Kl(e,t){t=(t||{}).dense?[]:{};if(!e.match(/\\trowd/))throw new Error("RTF missing table");return t["!ref"]=de({s:{c:0,r:0},e:{c:0,r:0}}),t}function Zl(e,t){return Ml(e^t)}qs.STY="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles";var ql=t(["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"]),Ql=v,Jl=v;qs.THEME="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme";var ec=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,tc=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,nc=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,ic=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;qs.IMG="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",qs.DRAW="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing";var rc=1024;qs.CMNT="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments";var ac=I("comments",null,{xmlns:Ka.main[0]}),sc=be,oc="application/vnd.ms-office.vbaProject",lc=["xlsb","xlsm","xlam","biff8","xla"];qs.DS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",qs.MS="http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet";var cc,uc,hc=(cc=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,uc={r:0,c:0},function(e,t){return uc=t,e.replace(cc,Cc)}),dc=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)([1-9]\d{0,5}|10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6])(?![_.\(A-Za-z0-9])/g,fc=function(e,s){return e.replace(dc,function(e,t,n,i,r,a){i=H(i)-(n?0:s.c),a=S(a)-(r?0:s.r);return t+"R"+(0==a?"":r?1+a:"["+a+"]")+"C"+(0==i?"":n?1+i:"["+i+"]")})},pc=On,mc=Nn,gc=Nn,vc=On,ea=On,pa=zn,bc=Nn,Sc=On,yc=On,xc=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],wc={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e._R(4,"i"),0]:[e._R(2),e._R(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:v},3:{n:"PtgAdd",f:Tn},4:{n:"PtgSub",f:Tn},5:{n:"PtgMul",f:Tn},6:{n:"PtgDiv",f:Tn},7:{n:"PtgPower",f:Tn},8:{n:"PtgConcat",f:Tn},9:{n:"PtgLt",f:Tn},10:{n:"PtgLe",f:Tn},11:{n:"PtgEq",f:Tn},12:{n:"PtgGe",f:Tn},13:{n:"PtgGt",f:Tn},14:{n:"PtgNe",f:Tn},15:{n:"PtgIsect",f:Tn},16:{n:"PtgUnion",f:Tn},17:{n:"PtgRange",f:Tn},18:{n:"PtgUplus",f:Tn},19:{n:"PtgUminus",f:Tn},20:{n:"PtgPercent",f:Tn},21:{n:"PtgParen",f:Tn},22:{n:"PtgMissArg",f:Tn},23:{n:"PtgStr",f:function(e,t,n){return e.l++,ut(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Ds[e._R(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e._R(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e._R(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Re(e)}},32:{n:"PtgArray",f:function(e,t,n){var i=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[i]}},33:{n:"PtgFunc",f:function(e,t,n){var i=(96&e[e.l])>>5;return e.l+=1,n=e._R(n&&n.biff<=3?1:2),[Ic[n],Dc[n],i]}},34:{n:"PtgFuncVar",f:function(e,t,n){var i=e[e.l++],r=e._R(1),e=n&&n.biff<=3?[88==i?-1:0,e._R(1)]:[e[e.l+1]>>7,32767&e._R(2)];return[r,(0===e[0]?Dc:Mc)[e[1]]]}},35:{n:"PtgName",f:function(e,t,n){var i=e._R(1)>>>5&3,r=!n||8<=n.biff?4:2,r=e._R(r);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[i,0,r]}},36:{n:"PtgRef",f:function(e,t,n){var i=(96&e[e.l])>>5;return e.l+=1,[i,In(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,Mn(e,2<=n.biff&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var i=e._R(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[i,e._R(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:v},40:{n:"PtgMemNoMem",f:v},41:{n:"PtgMemFunc",f:function(e,t,n){return[e._R(1)>>>5&3,e._R(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var i=e._R(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[i]}},43:{n:"PtgAreaErr",f:function(e,t,n){var i=(96&e[e.l++])>>5;return e.l+=n&&8<n.biff?12:n.biff<8?6:8,[i]}},44:{n:"PtgRefN",f:function(e,t,n){var i=(96&e[e.l])>>5;return e.l+=1,[i,function(e,t){var n,i,r;if(2<=(o=t&&t.biff?t.biff:8)&&o<=5)return i=(n=e)._R(2),r=n._R(1),t=(32768&i)>>15,n=(16384&i)>>14,i&=16383,1==t&&8192<=i&&(i-=16384),1==n&&128<=r&&(r-=256),{r:i,c:r,cRel:n,rRel:t};var a=e._R(12<=o?4:2),s=e._R(2),o=(16384&s)>>14,e=(32768&s)>>15;if(s&=16383,1==e)for(;524287<a;)a-=1048576;if(1==o)for(;8191<s;)s-=16384;return{r:a,c:s,cRel:o,rRel:e}}(e,n)]}},45:{n:"PtgAreaN",f:function(e,t,n){return[(96&e[e.l++])>>5,function(e,t){if(t.biff<8)return Dn(e);var n=e._R(12==t.biff?4:2),i=e._R(12==t.biff?4:2),t=Bn(e,2),e=Bn(e,2);return{s:{r:n,c:t[0],cRel:t[1],rRel:t[2]},e:{r:i,c:e[0],cRel:e[1],rRel:e[2]}}}(e,n)]}},46:{n:"PtgMemAreaN",f:function(e){return[e._R(1)>>>5&3,e._R(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e._R(1)>>>5&3,e._R(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e._R(1)>>>5&3,n=e._R(2,"i");e.l+=8;var i=e._R(2);return e.l+=12,[t,n,i]}(e):[e._R(1)>>>5&3,e._R(2),e._R(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var i=(96&e[e.l])>>5;e.l+=1;var r=e._R(2);return n&&5==n.biff&&(e.l+=12),[i,r,In(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var i=(96&e[e.l++])>>5,r=e._R(2,"i");if(n)switch(n.biff){case 5:e.l+=12,0;break;case 12:0}return[i,r,Mn(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var i=(96&e[e.l++])>>5,r=e._R(2),a=4;if(n)switch(n.biff){case 5:a=15;break;case 12:a=6}return e.l+=a,[i,r]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var i=(96&e[e.l++])>>5,r=e._R(2),a=8;if(n)switch(n.biff){case 5:e.l+=12,a=6;break;case 12:a=12}return e.l+=a,[i,r]}},255:{}},_c={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61};function Cc(e,t,n,i){var r=!1,a=!1;0==n.length?a=!0:"["==n.charAt(0)&&(a=!0,n=n.slice(1,-1)),0==i.length?r=!0:"["==i.charAt(0)&&(r=!0,i=i.slice(1,-1));n=0<n.length?0|parseInt(n,10):0,i=0<i.length?0|parseInt(i,10):0;return r?i+=uc.c:--i,a?n+=uc.r:--n,t+(r?"":"$")+se(i)+(a?"":"$")+ae(n)}!function(){for(var e in _c)wc[e]=wc[_c[e]]}();var Ec={1:{n:"PtgElfLel",f:zn},2:{n:"PtgElfRw",f:Sc},3:{n:"PtgElfCol",f:pc},6:{n:"PtgElfRwV",f:yc},7:{n:"PtgElfColV",f:vc},10:{n:"PtgElfRadical",f:ea},11:{n:"PtgElfRadicalS",f:bc},13:{n:"PtgElfColS",f:mc},15:{n:"PtgElfColSV",f:gc},16:{n:"PtgElfRadicalLel",f:pa},25:{n:"PtgList",f:function(e){e.l+=2;var t=e._R(2),n=e._R(2),i=e._R(4),r=e._R(2),e=e._R(2);return{ixti:t,coltype:3&n,rt:xc[n>>2&31],idx:i,c:r,C:e}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e._R(4)]}},255:{}},kc={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var i=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[i]}},2:{n:"PtgAttrIf",f:function(e,t,n){var i=255&e[e.l+1]?1:0;return e.l+=2,[i,e._R(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var i=e._R(n&&2==n.biff?1:2),r=[],a=0;a<=i;++a)r.push(e._R(n&&2==n.biff?1:2));return r}},8:{n:"PtgAttrGoto",f:function(e,t,n){var i=255&e[e.l+1]?1:0;return e.l+=2,[i,e._R(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:function(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}},64:{n:"PtgAttrSpace",f:function(e){return e._R(2),Ln(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e._R(2),Ln(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e._R(2)]}},255:{}};kc[33]=kc[32];var Pc={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"},Rc=jn,Ac=jn,Tc=jn,Bc=jn,Mc={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Dc={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Ic={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0},Lc={"_xlfn.ACOT":"ACOT","_xlfn.ACOTH":"ACOTH","_xlfn.AGGREGATE":"AGGREGATE","_xlfn.ARABIC":"ARABIC","_xlfn.AVERAGEIF":"AVERAGEIF","_xlfn.AVERAGEIFS":"AVERAGEIFS","_xlfn.BASE":"BASE","_xlfn.BETA.DIST":"BETA.DIST","_xlfn.BETA.INV":"BETA.INV","_xlfn.BINOM.DIST":"BINOM.DIST","_xlfn.BINOM.DIST.RANGE":"BINOM.DIST.RANGE","_xlfn.BINOM.INV":"BINOM.INV","_xlfn.BITAND":"BITAND","_xlfn.BITLSHIFT":"BITLSHIFT","_xlfn.BITOR":"BITOR","_xlfn.BITRSHIFT":"BITRSHIFT","_xlfn.BITXOR":"BITXOR","_xlfn.CEILING.MATH":"CEILING.MATH","_xlfn.CEILING.PRECISE":"CEILING.PRECISE","_xlfn.CHISQ.DIST":"CHISQ.DIST","_xlfn.CHISQ.DIST.RT":"CHISQ.DIST.RT","_xlfn.CHISQ.INV":"CHISQ.INV","_xlfn.CHISQ.INV.RT":"CHISQ.INV.RT","_xlfn.CHISQ.TEST":"CHISQ.TEST","_xlfn.COMBINA":"COMBINA","_xlfn.CONCAT":"CONCAT","_xlfn.CONFIDENCE.NORM":"CONFIDENCE.NORM","_xlfn.CONFIDENCE.T":"CONFIDENCE.T","_xlfn.COT":"COT","_xlfn.COTH":"COTH","_xlfn.COUNTIFS":"COUNTIFS","_xlfn.COVARIANCE.P":"COVARIANCE.P","_xlfn.COVARIANCE.S":"COVARIANCE.S","_xlfn.CSC":"CSC","_xlfn.CSCH":"CSCH","_xlfn.DAYS":"DAYS","_xlfn.DECIMAL":"DECIMAL","_xlfn.ECMA.CEILING":"ECMA.CEILING","_xlfn.ERF.PRECISE":"ERF.PRECISE","_xlfn.ERFC.PRECISE":"ERFC.PRECISE","_xlfn.EXPON.DIST":"EXPON.DIST","_xlfn.F.DIST":"F.DIST","_xlfn.F.DIST.RT":"F.DIST.RT","_xlfn.F.INV":"F.INV","_xlfn.F.INV.RT":"F.INV.RT","_xlfn.F.TEST":"F.TEST","_xlfn.FILTERXML":"FILTERXML","_xlfn.FLOOR.MATH":"FLOOR.MATH","_xlfn.FLOOR.PRECISE":"FLOOR.PRECISE","_xlfn.FORECAST.ETS":"FORECAST.ETS","_xlfn.FORECAST.ETS.CONFINT":"FORECAST.ETS.CONFINT","_xlfn.FORECAST.ETS.SEASONALITY":"FORECAST.ETS.SEASONALITY","_xlfn.FORECAST.ETS.STAT":"FORECAST.ETS.STAT","_xlfn.FORECAST.LINEAR":"FORECAST.LINEAR","_xlfn.FORMULATEXT":"FORMULATEXT","_xlfn.GAMMA":"GAMMA","_xlfn.GAMMA.DIST":"GAMMA.DIST","_xlfn.GAMMA.INV":"GAMMA.INV","_xlfn.GAMMALN.PRECISE":"GAMMALN.PRECISE","_xlfn.GAUSS":"GAUSS","_xlfn.HYPGEOM.DIST":"HYPGEOM.DIST","_xlfn.IFERROR":"IFERROR","_xlfn.IFNA":"IFNA","_xlfn.IFS":"IFS","_xlfn.IMCOSH":"IMCOSH","_xlfn.IMCOT":"IMCOT","_xlfn.IMCSC":"IMCSC","_xlfn.IMCSCH":"IMCSCH","_xlfn.IMSEC":"IMSEC","_xlfn.IMSECH":"IMSECH","_xlfn.IMSINH":"IMSINH","_xlfn.IMTAN":"IMTAN","_xlfn.ISFORMULA":"ISFORMULA","_xlfn.ISO.CEILING":"ISO.CEILING","_xlfn.ISOWEEKNUM":"ISOWEEKNUM","_xlfn.LOGNORM.DIST":"LOGNORM.DIST","_xlfn.LOGNORM.INV":"LOGNORM.INV","_xlfn.MAXIFS":"MAXIFS","_xlfn.MINIFS":"MINIFS","_xlfn.MODE.MULT":"MODE.MULT","_xlfn.MODE.SNGL":"MODE.SNGL","_xlfn.MUNIT":"MUNIT","_xlfn.NEGBINOM.DIST":"NEGBINOM.DIST","_xlfn.NETWORKDAYS.INTL":"NETWORKDAYS.INTL","_xlfn.NIGBINOM":"NIGBINOM","_xlfn.NORM.DIST":"NORM.DIST","_xlfn.NORM.INV":"NORM.INV","_xlfn.NORM.S.DIST":"NORM.S.DIST","_xlfn.NORM.S.INV":"NORM.S.INV","_xlfn.NUMBERVALUE":"NUMBERVALUE","_xlfn.PDURATION":"PDURATION","_xlfn.PERCENTILE.EXC":"PERCENTILE.EXC","_xlfn.PERCENTILE.INC":"PERCENTILE.INC","_xlfn.PERCENTRANK.EXC":"PERCENTRANK.EXC","_xlfn.PERCENTRANK.INC":"PERCENTRANK.INC","_xlfn.PERMUTATIONA":"PERMUTATIONA","_xlfn.PHI":"PHI","_xlfn.POISSON.DIST":"POISSON.DIST","_xlfn.QUARTILE.EXC":"QUARTILE.EXC","_xlfn.QUARTILE.INC":"QUARTILE.INC","_xlfn.QUERYSTRING":"QUERYSTRING","_xlfn.RANK.AVG":"RANK.AVG","_xlfn.RANK.EQ":"RANK.EQ","_xlfn.RRI":"RRI","_xlfn.SEC":"SEC","_xlfn.SECH":"SECH","_xlfn.SHEET":"SHEET","_xlfn.SHEETS":"SHEETS","_xlfn.SKEW.P":"SKEW.P","_xlfn.STDEV.P":"STDEV.P","_xlfn.STDEV.S":"STDEV.S","_xlfn.SUMIFS":"SUMIFS","_xlfn.SWITCH":"SWITCH","_xlfn.T.DIST":"T.DIST","_xlfn.T.DIST.2T":"T.DIST.2T","_xlfn.T.DIST.RT":"T.DIST.RT","_xlfn.T.INV":"T.INV","_xlfn.T.INV.2T":"T.INV.2T","_xlfn.T.TEST":"T.TEST","_xlfn.TEXTJOIN":"TEXTJOIN","_xlfn.UNICHAR":"UNICHAR","_xlfn.UNICODE":"UNICODE","_xlfn.VAR.P":"VAR.P","_xlfn.VAR.S":"VAR.S","_xlfn.WEBSERVICE":"WEBSERVICE","_xlfn.WEIBULL.DIST":"WEIBULL.DIST","_xlfn.WORKDAY.INTL":"WORKDAY.INTL","_xlfn.XOR":"XOR","_xlfn.Z.TEST":"Z.TEST"},Fc={},Oc={};qs.WS=["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"];var Nc,zc,Wc,Vc,$c,Uc,Hc,Xc="undefined"!=typeof Map,Gc=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,jc=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Yc=/<(?:\w:)?hyperlink [^>]*>/gm,Kc=/"(\w*:\w*)"/,Zc=/<(?:\w:)?col\b[^>]*[\/]?>/g,qc=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Qc=/<(?:\w:)?pageMargins[^>]*\/>/g,Jc=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,eu=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/,tu=["objects","scenarios","selectLockedCells","selectUnlockedCells"],nu=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],iu=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,ru=(Nc=/<(?:\w+:)?c[ >]/,zc=/<\/(?:\w+:)?row>/,Wc=/r=["']([^"']*)["']/,Vc=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,$c=/ref=["']([^"']*)["']/,Uc=Ua("v"),Hc=Ua("f"),function(e,t,n,i,r,a){for(var s,o,l,c,u=0,h="",d=[],f=[],p=0,m=0,g=0,v="",b=0,S=0,y=0,x=0,w=Array.isArray(a.CellXf),_=[],C=[],E=Array.isArray(t),k=[],P={},R=!1,A=e.split(zc),T=0,B=A.length;T!=B;++T){var M=(h=A[T].trim()).length;if(0!==M){for(u=0;u<M&&62!==h.charCodeAt(u);++u);if(++u,b=null!=(o=ie(h.slice(0,u),!0)).r?parseInt(o.r,10):b+1,S=-1,!(n.sheetRows&&n.sheetRows<b)){i.s.r>b-1&&(i.s.r=b-1),i.e.r<b-1&&(i.e.r=b-1),n&&n.cellStyles&&(R=!(P={}),o.ht&&(R=!0,P.hpt=parseFloat(o.ht),P.hpx=ln(P.hpt)),"1"==o.hidden&&(P.hidden=R=!0),null!=o.outlineLevel&&(R=!0,P.level=+o.outlineLevel),R&&(k[b-1]=P));for(var d=h.slice(u).split(Nc),D=0;D!=d.length&&"<"==d[D].trim().charAt(0);++D);for(d=d.slice(D),u=0;u!=d.length;++u)if(0!==(h=d[u].trim()).length){if(f=h.match(Wc),p=u,h="<c "+("<"==h.slice(g=m=0,1)?">":"")+h,null!=f&&2===f.length){for(v=f[1],m=p=0;m!=v.length&&!((g=v.charCodeAt(m)-64)<1||26<g);++m)p=26*p+g;S=--p}else++S;for(m=0;m!=h.length&&62!==h.charCodeAt(m);++m);if(++m,(o=ie(h.slice(0,m),!0)).r||(o.r=he({r:b-1,c:S})),s={t:""},null!=(f=(v=h.slice(m)).match(Uc))&&""!==f[1]&&(s.v=Aa(f[1])),n.cellFormula){null!=(f=v.match(Hc))&&""!==f[1]?(s.f=An(Aa(La(f[1]))),-1<f[0].indexOf('t="array"')?(s.F=(v.match($c)||[])[1],-1<s.F.indexOf(":")&&_.push([oe(s.F),s.F])):-1<f[0].indexOf('t="shared"')&&(c=ie(f[0]),C[parseInt(c.si,10)]=[c,An(Aa(La(f[1]))),o.r])):(f=v.match(/<f[^>]*\/>/))&&(C[(c=ie(f[0])).si]&&(s.f=Rn(C[c.si][1],C[c.si][2],o.r)));for(var I=j(o.r),m=0;m<_.length;++m)I.r>=_[m][0].s.r&&I.r<=_[m][0].e.r&&I.c>=_[m][0].s.c&&I.c<=_[m][0].e.c&&(s.F=_[m][1])}if(null==o.t&&void 0===s.v)if(s.f||s.F)s.v=0,s.t="n";else{if(!n.sheetStubs)continue;s.t="z"}else s.t=o.t||"n";switch(i.s.c>S&&(i.s.c=S),i.e.c<S&&(i.e.c=S),s.t){case"n":if(""==s.v||null==s.v){if(!n.sheetStubs)continue;s.t="z"}else s.v=parseFloat(s.v);break;case"s":if(void 0===s.v){if(!n.sheetStubs)continue;s.t="z"}else l=Fc[parseInt(s.v,10)],s.v=l.t,s.r=l.r,n.cellHTML&&(s.h=l.h);break;case"str":s.t="s",s.v=null!=s.v?La(s.v):"",n.cellHTML&&(s.h=O(s.v));break;case"inlineStr":f=v.match(Vc),s.t="s",null!=f&&(l=Wt(f[1]))?(s.v=l.t,n.cellHTML&&(s.h=l.h)):s.v="";break;case"b":s.v=re(s.v);break;case"d":n.cellDates?s.v=te(s.v,1):(s.v=G(te(s.v,1)),s.t="n");break;case"e":n&&!1===n.cellText||(s.w=s.v),s.v=Is[s.v]}var y=x=0,L=null;w&&void 0!==o.s&&null!=(L=a.CellXf[o.s])&&(null!=L.numFmtId&&(y=L.numFmtId),n.cellStyles&&null!=L.fillId&&(x=L.fillId)),ei(s,y,x,n,r,a),n.cellDates&&w&&"n"==s.t&&aa.is_date(aa._table[y])&&(s.t="d",s.v=F(s.v)),E?(t[(L=j(o.r)).r]||(t[L.r]=[]),t[L.r][L.c]=s):t[o.r]=s}}}}0<k.length&&(t["!rows"]=k)}),au=I("worksheet",null,{xmlns:Ka.main[0],"xmlns:r":Ka.r}),gc=Bs,su=Ms,pa=Bs,ou=Ms,lu=["left","right","top","bottom","header","footer"];qs.CHART="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",qs.CHARTEX="http://schemas.microsoft.com/office/2014/relationships/chartEx",qs.CS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet";var cu,uu,hu,du,fu,pu,mu,gu,vu=(I("chartsheet",null,{xmlns:Ka.main[0],"xmlns:r":Ka.r}),[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]]),bu=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Su=[],yu=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]],xu="][*?/\\".split(""),wu=/<\w+:workbook/,_u=I("workbook",null,{xmlns:Ka.main[0],"xmlns:r":Ka.r}),Cu=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Eu=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/,ku=/<(\/?)([^\s?>!\/:]*:|)([^\s?>:\/]+)[^>]*>/gm,Pu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"},Ru={0:{n:"BrtRowHdr",f:function(e,t){var n={},i=e.l+t;n.r=e._R(4),e.l+=4;var r=e._R(2);return e.l+=1,t=e._R(1),e.l=i,7&t&&(n.level=7&t),16&t&&(n.hidden=!0),32&t&&(n.hpt=r/20),n}},1:{n:"BrtCellBlank",f:function(e){return[we(e)]}},2:{n:"BrtCellRk",f:function(e){return[we(e),ke(e),"n"]}},3:{n:"BrtCellError",f:function(e){return[we(e),e._R(1),"e"]}},4:{n:"BrtCellBool",f:function(e){return[we(e),e._R(1),"b"]}},5:{n:"BrtCellReal",f:function(e){return[we(e),Re(e),"n"]}},6:{n:"BrtCellSt",f:function(e){return[we(e),be(e),"str"]}},7:{n:"BrtCellIsst",f:function(e){return[we(e),e._R(4),"s"]}},8:{n:"BrtFmlaString",f:function(e,t,n){var i=e.l+t,r=we(e);r.r=n["!row"];var a=[r,be(e),"str"];return n.cellFormula?(e.l+=2,t=Ac(e,i-e.l,n),a[3]=Hn(t,0,r,n.supbooks,n)):e.l=i,a}},9:{n:"BrtFmlaNum",f:function(e,t,n){var i=e.l+t,r=we(e);r.r=n["!row"];var a=[r,Re(e),"n"];return n.cellFormula?(e.l+=2,t=Ac(e,i-e.l,n),a[3]=Hn(t,0,r,n.supbooks,n)):e.l=i,a}},10:{n:"BrtFmlaBool",f:function(e,t,n){var i=e.l+t,r=we(e);r.r=n["!row"];var a=[r,e._R(1),"b"];return n.cellFormula?(e.l+=2,t=Ac(e,i-e.l,n),a[3]=Hn(t,0,r,n.supbooks,n)):e.l=i,a}},11:{n:"BrtFmlaError",f:function(e,t,n){var i=e.l+t,r=we(e);r.r=n["!row"];var a=[r,e._R(1),"e"];return n.cellFormula?(e.l+=2,t=Ac(e,i-e.l,n),a[3]=Hn(t,0,r,n.supbooks,n)):e.l=i,a}},16:{n:"BrtFRTArchID$",f:function(e,t){var n={};return e._R(4),n.ArchID=e._R(4),e.l+=t-8,n}},19:{n:"BrtSSTItem",f:ye},20:{n:"BrtPCDIMissing"},21:{n:"BrtPCDINumber"},22:{n:"BrtPCDIBoolean"},23:{n:"BrtPCDIError"},24:{n:"BrtPCDIString"},25:{n:"BrtPCDIDatetime"},26:{n:"BrtPCDIIndex"},27:{n:"BrtPCDIAMissing"},28:{n:"BrtPCDIANumber"},29:{n:"BrtPCDIABoolean"},30:{n:"BrtPCDIAError"},31:{n:"BrtPCDIAString"},32:{n:"BrtPCDIADatetime"},33:{n:"BrtPCRRecord"},34:{n:"BrtPCRRecordDt"},35:{n:"BrtFRTBegin"},36:{n:"BrtFRTEnd"},37:{n:"BrtACBegin"},38:{n:"BrtACEnd"},39:{n:"BrtName",f:function(e,t,n){var i=e.l+t;e.l+=4,e.l+=1;var r=e._R(4),a=Rs(e),t=Tc(e,0,n),n=Ce(e);return e.l=i,t={Name:a,Ptg:t},r<268435455&&(t.Sheet=r),n&&(t.Comment=n),t}},40:{n:"BrtIndexRowBlock"},42:{n:"BrtIndexBlock"},43:{n:"BrtFont",f:function(e,t,n){var i={};i.sz=e._R(2)/20;var r,a=(a=(r=e)._R(1),r.l++,{fBold:1&a,fItalic:2&a,fUnderline:4&a,fStrikeout:8&a,fOutline:16&a,fShadow:32&a,fCondense:64&a,fExtend:128&a});switch(a.fItalic&&(i.italic=1),a.fCondense&&(i.condense=1),a.fExtend&&(i.extend=1),a.fShadow&&(i.shadow=1),a.fOutline&&(i.outline=1),a.fStrikeout&&(i.strike=1),700===e._R(2)&&(i.bold=1),e._R(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript"}switch(0!=(a=e._R(1))&&(i.underline=a),0<(a=e._R(1))&&(i.family=a),0<(a=e._R(1))&&(i.charset=a),e.l++,i.color=function(e){var t={},n=e._R(1)>>>1,i=e._R(1),r=e._R(2,"i"),a=e._R(1),s=e._R(1),o=e._R(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var l=Xs[i];l&&(t.rgb=Qt(l));break;case 2:t.rgb=Qt([a,s,o]);break;case 3:t.theme=i}return 0!=r&&(t.tint=0<r?r/32767:r/32768),t}(e),e._R(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor"}return i.name=be(e),i}},44:{n:"BrtFmt",f:function(e,t){return[e._R(2),be(e)]}},45:{n:"BrtFill",f:Ql},46:{n:"BrtBorder",f:Jl},47:{n:"BrtXF",f:function(e,t){var n=e.l+t,i=e._R(2),t=e._R(2);return e.l=n,{ixfe:i,numFmtId:t}}},48:{n:"BrtStyle"},49:{n:"BrtCellMeta"},50:{n:"BrtValueMeta"},51:{n:"BrtMdb"},52:{n:"BrtBeginFmd"},53:{n:"BrtEndFmd"},54:{n:"BrtBeginMdx"},55:{n:"BrtEndMdx"},56:{n:"BrtBeginMdxTuple"},57:{n:"BrtEndMdxTuple"},58:{n:"BrtMdxMbrIstr"},59:{n:"BrtStr"},60:{n:"BrtColInfo",f:zt},62:{n:"BrtCellRString"},63:{n:"BrtCalcChainItem$",f:function(e){var t={};t.i=e._R(4);var n={};return n.r=e._R(4),n.c=e._R(4),t.r=he(n),2&(e=e._R(1))&&(t.l="1"),8&e&&(t.a="1"),t}},64:{n:"BrtDVal",f:function(){}},65:{n:"BrtSxvcellNum"},66:{n:"BrtSxvcellStr"},67:{n:"BrtSxvcellBool"},68:{n:"BrtSxvcellErr"},69:{n:"BrtSxvcellDate"},70:{n:"BrtSxvcellNil"},128:{n:"BrtFileVersion"},129:{n:"BrtBeginSheet"},130:{n:"BrtEndSheet"},131:{n:"BrtBeginBook",f:v,p:0},132:{n:"BrtEndBook"},133:{n:"BrtBeginWsViews"},134:{n:"BrtEndWsViews"},135:{n:"BrtBeginBookViews"},136:{n:"BrtEndBookViews"},137:{n:"BrtBeginWsView",f:function(e){var t=e._R(2);return e.l+=28,{RTL:32&t}}},138:{n:"BrtEndWsView"},139:{n:"BrtBeginCsViews"},140:{n:"BrtEndCsViews"},141:{n:"BrtBeginCsView"},142:{n:"BrtEndCsView"},143:{n:"BrtBeginBundleShs"},144:{n:"BrtEndBundleShs"},145:{n:"BrtBeginSheetData"},146:{n:"BrtEndSheetData"},147:{n:"BrtWsProp",f:function(e,t){var n={};return e.l+=19,n.name=ks(e,t-19),n}},148:{n:"BrtWsDim",f:gc,p:16},151:{n:"BrtPane",f:function(){}},152:{n:"BrtSel"},153:{n:"BrtWbProp",f:function(e,t){var n={},i=e._R(4);return n.defaultThemeVersion=e._R(4),0<(e=8<t?be(e):"").length&&(n.CodeName=e),n.autoCompressPictures=!!(65536&i),n.backupFile=!!(64&i),n.checkCompatibility=!!(4096&i),n.date1904=!!(1&i),n.filterPrivacy=!!(8&i),n.hidePivotFieldList=!!(1024&i),n.promptedSolutions=!!(16&i),n.publishItems=!!(2048&i),n.refreshAllConnections=!!(262144&i),n.saveExternalLinkValues=!!(128&i),n.showBorderUnselectedTables=!!(4&i),n.showInkAnnotation=!!(32&i),n.showObjects=["all","placeholders","none"][i>>13&3],n.showPivotChartFilter=!!(32768&i),n.updateLinks=["userSet","never","always"][i>>8&3],n}},154:{n:"BrtWbFactoid"},155:{n:"BrtFileRecover"},156:{n:"BrtBundleSh",f:function(e,t){var n={};return n.Hidden=e._R(4),n.iTabID=e._R(4),n.strRelID=As(e,t-8),n.name=be(e),n}},157:{n:"BrtCalcProp"},158:{n:"BrtBookView"},159:{n:"BrtBeginSst",f:function(e){return[e._R(4),e._R(4)]}},160:{n:"BrtEndSst"},161:{n:"BrtBeginAFilter",f:Bs},162:{n:"BrtEndAFilter"},163:{n:"BrtBeginFilterColumn"},164:{n:"BrtEndFilterColumn"},165:{n:"BrtBeginFilters"},166:{n:"BrtEndFilters"},167:{n:"BrtFilter"},168:{n:"BrtColorFilter"},169:{n:"BrtIconFilter"},170:{n:"BrtTop10Filter"},171:{n:"BrtDynamicFilter"},172:{n:"BrtBeginCustomFilters"},173:{n:"BrtEndCustomFilters"},174:{n:"BrtCustomFilter"},175:{n:"BrtAFilterDateGroupItem"},176:{n:"BrtMergeCell",f:pa},177:{n:"BrtBeginMergeCells"},178:{n:"BrtEndMergeCells"},179:{n:"BrtBeginPivotCacheDef"},180:{n:"BrtEndPivotCacheDef"},181:{n:"BrtBeginPCDFields"},182:{n:"BrtEndPCDFields"},183:{n:"BrtBeginPCDField"},184:{n:"BrtEndPCDField"},185:{n:"BrtBeginPCDSource"},186:{n:"BrtEndPCDSource"},187:{n:"BrtBeginPCDSRange"},188:{n:"BrtEndPCDSRange"},189:{n:"BrtBeginPCDFAtbl"},190:{n:"BrtEndPCDFAtbl"},191:{n:"BrtBeginPCDIRun"},192:{n:"BrtEndPCDIRun"},193:{n:"BrtBeginPivotCacheRecords"},194:{n:"BrtEndPivotCacheRecords"},195:{n:"BrtBeginPCDHierarchies"},196:{n:"BrtEndPCDHierarchies"},197:{n:"BrtBeginPCDHierarchy"},198:{n:"BrtEndPCDHierarchy"},199:{n:"BrtBeginPCDHFieldsUsage"},200:{n:"BrtEndPCDHFieldsUsage"},201:{n:"BrtBeginExtConnection"},202:{n:"BrtEndExtConnection"},203:{n:"BrtBeginECDbProps"},204:{n:"BrtEndECDbProps"},205:{n:"BrtBeginECOlapProps"},206:{n:"BrtEndECOlapProps"},207:{n:"BrtBeginPCDSConsol"},208:{n:"BrtEndPCDSConsol"},209:{n:"BrtBeginPCDSCPages"},210:{n:"BrtEndPCDSCPages"},211:{n:"BrtBeginPCDSCPage"},212:{n:"BrtEndPCDSCPage"},213:{n:"BrtBeginPCDSCPItem"},214:{n:"BrtEndPCDSCPItem"},215:{n:"BrtBeginPCDSCSets"},216:{n:"BrtEndPCDSCSets"},217:{n:"BrtBeginPCDSCSet"},218:{n:"BrtEndPCDSCSet"},219:{n:"BrtBeginPCDFGroup"},220:{n:"BrtEndPCDFGroup"},221:{n:"BrtBeginPCDFGItems"},222:{n:"BrtEndPCDFGItems"},223:{n:"BrtBeginPCDFGRange"},224:{n:"BrtEndPCDFGRange"},225:{n:"BrtBeginPCDFGDiscrete"},226:{n:"BrtEndPCDFGDiscrete"},227:{n:"BrtBeginPCDSDTupleCache"},228:{n:"BrtEndPCDSDTupleCache"},229:{n:"BrtBeginPCDSDTCEntries"},230:{n:"BrtEndPCDSDTCEntries"},231:{n:"BrtBeginPCDSDTCEMembers"},232:{n:"BrtEndPCDSDTCEMembers"},233:{n:"BrtBeginPCDSDTCEMember"},234:{n:"BrtEndPCDSDTCEMember"},235:{n:"BrtBeginPCDSDTCQueries"},236:{n:"BrtEndPCDSDTCQueries"},237:{n:"BrtBeginPCDSDTCQuery"},238:{n:"BrtEndPCDSDTCQuery"},239:{n:"BrtBeginPCDSDTCSets"},240:{n:"BrtEndPCDSDTCSets"},241:{n:"BrtBeginPCDSDTCSet"},242:{n:"BrtEndPCDSDTCSet"},243:{n:"BrtBeginPCDCalcItems"},244:{n:"BrtEndPCDCalcItems"},245:{n:"BrtBeginPCDCalcItem"},246:{n:"BrtEndPCDCalcItem"},247:{n:"BrtBeginPRule"},248:{n:"BrtEndPRule"},249:{n:"BrtBeginPRFilters"},250:{n:"BrtEndPRFilters"},251:{n:"BrtBeginPRFilter"},252:{n:"BrtEndPRFilter"},253:{n:"BrtBeginPNames"},254:{n:"BrtEndPNames"},255:{n:"BrtBeginPName"},256:{n:"BrtEndPName"},257:{n:"BrtBeginPNPairs"},258:{n:"BrtEndPNPairs"},259:{n:"BrtBeginPNPair"},260:{n:"BrtEndPNPair"},261:{n:"BrtBeginECWebProps"},262:{n:"BrtEndECWebProps"},263:{n:"BrtBeginEcWpTables"},264:{n:"BrtEndECWPTables"},265:{n:"BrtBeginECParams"},266:{n:"BrtEndECParams"},267:{n:"BrtBeginECParam"},268:{n:"BrtEndECParam"},269:{n:"BrtBeginPCDKPIs"},270:{n:"BrtEndPCDKPIs"},271:{n:"BrtBeginPCDKPI"},272:{n:"BrtEndPCDKPI"},273:{n:"BrtBeginDims"},274:{n:"BrtEndDims"},275:{n:"BrtBeginDim"},276:{n:"BrtEndDim"},277:{n:"BrtIndexPartEnd"},278:{n:"BrtBeginStyleSheet"},279:{n:"BrtEndStyleSheet"},280:{n:"BrtBeginSXView"},281:{n:"BrtEndSXVI"},282:{n:"BrtBeginSXVI"},283:{n:"BrtBeginSXVIs"},284:{n:"BrtEndSXVIs"},285:{n:"BrtBeginSXVD"},286:{n:"BrtEndSXVD"},287:{n:"BrtBeginSXVDs"},288:{n:"BrtEndSXVDs"},289:{n:"BrtBeginSXPI"},290:{n:"BrtEndSXPI"},291:{n:"BrtBeginSXPIs"},292:{n:"BrtEndSXPIs"},293:{n:"BrtBeginSXDI"},294:{n:"BrtEndSXDI"},295:{n:"BrtBeginSXDIs"},296:{n:"BrtEndSXDIs"},297:{n:"BrtBeginSXLI"},298:{n:"BrtEndSXLI"},299:{n:"BrtBeginSXLIRws"},300:{n:"BrtEndSXLIRws"},301:{n:"BrtBeginSXLICols"},302:{n:"BrtEndSXLICols"},303:{n:"BrtBeginSXFormat"},304:{n:"BrtEndSXFormat"},305:{n:"BrtBeginSXFormats"},306:{n:"BrtEndSxFormats"},307:{n:"BrtBeginSxSelect"},308:{n:"BrtEndSxSelect"},309:{n:"BrtBeginISXVDRws"},310:{n:"BrtEndISXVDRws"},311:{n:"BrtBeginISXVDCols"},312:{n:"BrtEndISXVDCols"},313:{n:"BrtEndSXLocation"},314:{n:"BrtBeginSXLocation"},315:{n:"BrtEndSXView"},316:{n:"BrtBeginSXTHs"},317:{n:"BrtEndSXTHs"},318:{n:"BrtBeginSXTH"},319:{n:"BrtEndSXTH"},320:{n:"BrtBeginISXTHRws"},321:{n:"BrtEndISXTHRws"},322:{n:"BrtBeginISXTHCols"},323:{n:"BrtEndISXTHCols"},324:{n:"BrtBeginSXTDMPS"},325:{n:"BrtEndSXTDMPs"},326:{n:"BrtBeginSXTDMP"},327:{n:"BrtEndSXTDMP"},328:{n:"BrtBeginSXTHItems"},329:{n:"BrtEndSXTHItems"},330:{n:"BrtBeginSXTHItem"},331:{n:"BrtEndSXTHItem"},332:{n:"BrtBeginMetadata"},333:{n:"BrtEndMetadata"},334:{n:"BrtBeginEsmdtinfo"},335:{n:"BrtMdtinfo"},336:{n:"BrtEndEsmdtinfo"},337:{n:"BrtBeginEsmdb"},338:{n:"BrtEndEsmdb"},339:{n:"BrtBeginEsfmd"},340:{n:"BrtEndEsfmd"},341:{n:"BrtBeginSingleCells"},342:{n:"BrtEndSingleCells"},343:{n:"BrtBeginList"},344:{n:"BrtEndList"},345:{n:"BrtBeginListCols"},346:{n:"BrtEndListCols"},347:{n:"BrtBeginListCol"},348:{n:"BrtEndListCol"},349:{n:"BrtBeginListXmlCPr"},350:{n:"BrtEndListXmlCPr"},351:{n:"BrtListCCFmla"},352:{n:"BrtListTrFmla"},353:{n:"BrtBeginExternals"},354:{n:"BrtEndExternals"},355:{n:"BrtSupBookSrc",f:As},357:{n:"BrtSupSelf"},358:{n:"BrtSupSame"},359:{n:"BrtSupTabs"},360:{n:"BrtBeginSupBook"},361:{n:"BrtPlaceholderName"},362:{n:"BrtExternSheet",f:Ft},363:{n:"BrtExternTableStart"},364:{n:"BrtExternTableEnd"},366:{n:"BrtExternRowHdr"},367:{n:"BrtExternCellBlank"},368:{n:"BrtExternCellReal"},369:{n:"BrtExternCellBool"},370:{n:"BrtExternCellError"},371:{n:"BrtExternCellString"},372:{n:"BrtBeginEsmdx"},373:{n:"BrtEndEsmdx"},374:{n:"BrtBeginMdxSet"},375:{n:"BrtEndMdxSet"},376:{n:"BrtBeginMdxMbrProp"},377:{n:"BrtEndMdxMbrProp"},378:{n:"BrtBeginMdxKPI"},379:{n:"BrtEndMdxKPI"},380:{n:"BrtBeginEsstr"},381:{n:"BrtEndEsstr"},382:{n:"BrtBeginPRFItem"},383:{n:"BrtEndPRFItem"},384:{n:"BrtBeginPivotCacheIDs"},385:{n:"BrtEndPivotCacheIDs"},386:{n:"BrtBeginPivotCacheID"},387:{n:"BrtEndPivotCacheID"},388:{n:"BrtBeginISXVIs"},389:{n:"BrtEndISXVIs"},390:{n:"BrtBeginColInfos"},391:{n:"BrtEndColInfos"},392:{n:"BrtBeginRwBrk"},393:{n:"BrtEndRwBrk"},394:{n:"BrtBeginColBrk"},395:{n:"BrtEndColBrk"},396:{n:"BrtBrk"},397:{n:"BrtUserBookView"},398:{n:"BrtInfo"},399:{n:"BrtCUsr"},400:{n:"BrtUsr"},401:{n:"BrtBeginUsers"},403:{n:"BrtEOF"},404:{n:"BrtUCR"},405:{n:"BrtRRInsDel"},406:{n:"BrtRREndInsDel"},407:{n:"BrtRRMove"},408:{n:"BrtRREndMove"},409:{n:"BrtRRChgCell"},410:{n:"BrtRREndChgCell"},411:{n:"BrtRRHeader"},412:{n:"BrtRRUserView"},413:{n:"BrtRRRenSheet"},414:{n:"BrtRRInsertSh"},415:{n:"BrtRRDefName"},416:{n:"BrtRRNote"},417:{n:"BrtRRConflict"},418:{n:"BrtRRTQSIF"},419:{n:"BrtRRFormat"},420:{n:"BrtRREndFormat"},421:{n:"BrtRRAutoFmt"},422:{n:"BrtBeginUserShViews"},423:{n:"BrtBeginUserShView"},424:{n:"BrtEndUserShView"},425:{n:"BrtEndUserShViews"},426:{n:"BrtArrFmla",f:function(e,t,n){var i=e.l+t,r=Pe(e),t=e._R(1);return(r=[r])[2]=t,n.cellFormula?(n=Rc(e,i-e.l,n),r[1]=n):e.l=i,r}},427:{n:"BrtShrFmla",f:function(e,t,n){var i=e.l+t,t=[Bs(e,16)];return n.cellFormula&&(n=Bc(e,i-e.l,n),t[1]=n),e.l=i,t}},428:{n:"BrtTable"},429:{n:"BrtBeginExtConnections"},430:{n:"BrtEndExtConnections"},431:{n:"BrtBeginPCDCalcMems"},432:{n:"BrtEndPCDCalcMems"},433:{n:"BrtBeginPCDCalcMem"},434:{n:"BrtEndPCDCalcMem"},435:{n:"BrtBeginPCDHGLevels"},436:{n:"BrtEndPCDHGLevels"},437:{n:"BrtBeginPCDHGLevel"},438:{n:"BrtEndPCDHGLevel"},439:{n:"BrtBeginPCDHGLGroups"},440:{n:"BrtEndPCDHGLGroups"},441:{n:"BrtBeginPCDHGLGroup"},442:{n:"BrtEndPCDHGLGroup"},443:{n:"BrtBeginPCDHGLGMembers"},444:{n:"BrtEndPCDHGLGMembers"},445:{n:"BrtBeginPCDHGLGMember"},446:{n:"BrtEndPCDHGLGMember"},447:{n:"BrtBeginQSI"},448:{n:"BrtEndQSI"},449:{n:"BrtBeginQSIR"},450:{n:"BrtEndQSIR"},451:{n:"BrtBeginDeletedNames"},452:{n:"BrtEndDeletedNames"},453:{n:"BrtBeginDeletedName"},454:{n:"BrtEndDeletedName"},455:{n:"BrtBeginQSIFs"},456:{n:"BrtEndQSIFs"},457:{n:"BrtBeginQSIF"},458:{n:"BrtEndQSIF"},459:{n:"BrtBeginAutoSortScope"},460:{n:"BrtEndAutoSortScope"},461:{n:"BrtBeginConditionalFormatting"},462:{n:"BrtEndConditionalFormatting"},463:{n:"BrtBeginCFRule"},464:{n:"BrtEndCFRule"},465:{n:"BrtBeginIconSet"},466:{n:"BrtEndIconSet"},467:{n:"BrtBeginDatabar"},468:{n:"BrtEndDatabar"},469:{n:"BrtBeginColorScale"},470:{n:"BrtEndColorScale"},471:{n:"BrtCFVO"},472:{n:"BrtExternValueMeta"},473:{n:"BrtBeginColorPalette"},474:{n:"BrtEndColorPalette"},475:{n:"BrtIndexedColor"},476:{n:"BrtMargins",f:function(t){var n={};return lu.forEach(function(e){n[e]=Re(t)}),n}},477:{n:"BrtPrintOptions"},478:{n:"BrtPageSetup"},479:{n:"BrtBeginHeaderFooter"},480:{n:"BrtEndHeaderFooter"},481:{n:"BrtBeginSXCrtFormat"},482:{n:"BrtEndSXCrtFormat"},483:{n:"BrtBeginSXCrtFormats"},484:{n:"BrtEndSXCrtFormats"},485:{n:"BrtWsFmtInfo",f:function(){}},486:{n:"BrtBeginMgs"},487:{n:"BrtEndMGs"},488:{n:"BrtBeginMGMaps"},489:{n:"BrtEndMGMaps"},490:{n:"BrtBeginMG"},491:{n:"BrtEndMG"},492:{n:"BrtBeginMap"},493:{n:"BrtEndMap"},494:{n:"BrtHLink",f:function(e,t){var n=e.l+t,i=Bs(e,16),r=Ce(e),a=be(e),s=be(e),t=be(e);return e.l=n,t={rfx:i,relId:r,loc:a,display:t},s&&(t.Tooltip=s),t}},495:{n:"BrtBeginDCon"},496:{n:"BrtEndDCon"},497:{n:"BrtBeginDRefs"},498:{n:"BrtEndDRefs"},499:{n:"BrtDRef"},500:{n:"BrtBeginScenMan"},501:{n:"BrtEndScenMan"},502:{n:"BrtBeginSct"},503:{n:"BrtEndSct"},504:{n:"BrtSlc"},505:{n:"BrtBeginDXFs"},506:{n:"BrtEndDXFs"},507:{n:"BrtDXF"},508:{n:"BrtBeginTableStyles"},509:{n:"BrtEndTableStyles"},510:{n:"BrtBeginTableStyle"},511:{n:"BrtEndTableStyle"},512:{n:"BrtTableStyleElement"},513:{n:"BrtTableStyleClient"},514:{n:"BrtBeginVolDeps"},515:{n:"BrtEndVolDeps"},516:{n:"BrtBeginVolType"},517:{n:"BrtEndVolType"},518:{n:"BrtBeginVolMain"},519:{n:"BrtEndVolMain"},520:{n:"BrtBeginVolTopic"},521:{n:"BrtEndVolTopic"},522:{n:"BrtVolSubtopic"},523:{n:"BrtVolRef"},524:{n:"BrtVolNum"},525:{n:"BrtVolErr"},526:{n:"BrtVolStr"},527:{n:"BrtVolBool"},528:{n:"BrtBeginCalcChain$"},529:{n:"BrtEndCalcChain$"},530:{n:"BrtBeginSortState"},531:{n:"BrtEndSortState"},532:{n:"BrtBeginSortCond"},533:{n:"BrtEndSortCond"},534:{n:"BrtBookProtection"},535:{n:"BrtSheetProtection"},536:{n:"BrtRangeProtection"},537:{n:"BrtPhoneticInfo"},538:{n:"BrtBeginECTxtWiz"},539:{n:"BrtEndECTxtWiz"},540:{n:"BrtBeginECTWFldInfoLst"},541:{n:"BrtEndECTWFldInfoLst"},542:{n:"BrtBeginECTwFldInfo"},548:{n:"BrtFileSharing"},549:{n:"BrtOleSize"},550:{n:"BrtDrawing",f:As},551:{n:"BrtLegacyDrawing"},552:{n:"BrtLegacyDrawingHF"},553:{n:"BrtWebOpt"},554:{n:"BrtBeginWebPubItems"},555:{n:"BrtEndWebPubItems"},556:{n:"BrtBeginWebPubItem"},557:{n:"BrtEndWebPubItem"},558:{n:"BrtBeginSXCondFmt"},559:{n:"BrtEndSXCondFmt"},560:{n:"BrtBeginSXCondFmts"},561:{n:"BrtEndSXCondFmts"},562:{n:"BrtBkHim"},564:{n:"BrtColor"},565:{n:"BrtBeginIndexedColors"},566:{n:"BrtEndIndexedColors"},569:{n:"BrtBeginMRUColors"},570:{n:"BrtEndMRUColors"},572:{n:"BrtMRUColor"},573:{n:"BrtBeginDVals"},574:{n:"BrtEndDVals"},577:{n:"BrtSupNameStart"},578:{n:"BrtSupNameValueStart"},579:{n:"BrtSupNameValueEnd"},580:{n:"BrtSupNameNum"},581:{n:"BrtSupNameErr"},582:{n:"BrtSupNameSt"},583:{n:"BrtSupNameNil"},584:{n:"BrtSupNameBool"},585:{n:"BrtSupNameFmla"},586:{n:"BrtSupNameBits"},587:{n:"BrtSupNameEnd"},588:{n:"BrtEndSupBook"},589:{n:"BrtCellSmartTagProperty"},590:{n:"BrtBeginCellSmartTag"},591:{n:"BrtEndCellSmartTag"},592:{n:"BrtBeginCellSmartTags"},593:{n:"BrtEndCellSmartTags"},594:{n:"BrtBeginSmartTags"},595:{n:"BrtEndSmartTags"},596:{n:"BrtSmartTagType"},597:{n:"BrtBeginSmartTagTypes"},598:{n:"BrtEndSmartTagTypes"},599:{n:"BrtBeginSXFilters"},600:{n:"BrtEndSXFilters"},601:{n:"BrtBeginSXFILTER"},602:{n:"BrtEndSXFilter"},603:{n:"BrtBeginFills"},604:{n:"BrtEndFills"},605:{n:"BrtBeginCellWatches"},606:{n:"BrtEndCellWatches"},607:{n:"BrtCellWatch"},608:{n:"BrtBeginCRErrs"},609:{n:"BrtEndCRErrs"},610:{n:"BrtCrashRecErr"},611:{n:"BrtBeginFonts"},612:{n:"BrtEndFonts"},613:{n:"BrtBeginBorders"},614:{n:"BrtEndBorders"},615:{n:"BrtBeginFmts"},616:{n:"BrtEndFmts"},617:{n:"BrtBeginCellXFs"},618:{n:"BrtEndCellXFs"},619:{n:"BrtBeginStyles"},620:{n:"BrtEndStyles"},625:{n:"BrtBigName"},626:{n:"BrtBeginCellStyleXFs"},627:{n:"BrtEndCellStyleXFs"},628:{n:"BrtBeginComments"},629:{n:"BrtEndComments"},630:{n:"BrtBeginCommentAuthors"},631:{n:"BrtEndCommentAuthors"},632:{n:"BrtCommentAuthor",f:sc},633:{n:"BrtBeginCommentList"},634:{n:"BrtEndCommentList"},635:{n:"BrtBeginComment",f:function(e){var t={};t.iauthor=e._R(4);var n=Bs(e,16);return t.rfx=n.s,t.ref=he(n.s),e.l+=16,t}},636:{n:"BrtEndComment"},637:{n:"BrtCommentText",f:Es},638:{n:"BrtBeginOleObjects"},639:{n:"BrtOleObject"},640:{n:"BrtEndOleObjects"},641:{n:"BrtBeginSxrules"},642:{n:"BrtEndSxRules"},643:{n:"BrtBeginActiveXControls"},644:{n:"BrtActiveX"},645:{n:"BrtEndActiveXControls"},646:{n:"BrtBeginPCDSDTCEMembersSortBy"},648:{n:"BrtBeginCellIgnoreECs"},649:{n:"BrtCellIgnoreEC"},650:{n:"BrtEndCellIgnoreECs"},651:{n:"BrtCsProp",f:function(e,t){return e.l+=10,{name:be(e)}}},652:{n:"BrtCsPageSetup"},653:{n:"BrtBeginUserCsViews"},654:{n:"BrtEndUserCsViews"},655:{n:"BrtBeginUserCsView"},656:{n:"BrtEndUserCsView"},657:{n:"BrtBeginPcdSFCIEntries"},658:{n:"BrtEndPCDSFCIEntries"},659:{n:"BrtPCDSFCIEntry"},660:{n:"BrtBeginListParts"},661:{n:"BrtListPart"},662:{n:"BrtEndListParts"},663:{n:"BrtSheetCalcProp"},664:{n:"BrtBeginFnGroup"},665:{n:"BrtFnGroup"},666:{n:"BrtEndFnGroup"},667:{n:"BrtSupAddin"},668:{n:"BrtSXTDMPOrder"},669:{n:"BrtCsProtection"},671:{n:"BrtBeginWsSortMap"},672:{n:"BrtEndWsSortMap"},673:{n:"BrtBeginRRSort"},674:{n:"BrtEndRRSort"},675:{n:"BrtRRSortItem"},676:{n:"BrtFileSharingIso"},677:{n:"BrtBookProtectionIso"},678:{n:"BrtSheetProtectionIso"},679:{n:"BrtCsProtectionIso"},680:{n:"BrtRangeProtectionIso"},681:{n:"BrtDValList"},1024:{n:"BrtRwDescent"},1025:{n:"BrtKnownFonts"},1026:{n:"BrtBeginSXTupleSet"},1027:{n:"BrtEndSXTupleSet"},1028:{n:"BrtBeginSXTupleSetHeader"},1029:{n:"BrtEndSXTupleSetHeader"},1030:{n:"BrtSXTupleSetHeaderItem"},1031:{n:"BrtBeginSXTupleSetData"},1032:{n:"BrtEndSXTupleSetData"},1033:{n:"BrtBeginSXTupleSetRow"},1034:{n:"BrtEndSXTupleSetRow"},1035:{n:"BrtSXTupleSetRowItem"},1036:{n:"BrtNameExt"},1037:{n:"BrtPCDH14"},1038:{n:"BrtBeginPCDCalcMem14"},1039:{n:"BrtEndPCDCalcMem14"},1040:{n:"BrtSXTH14"},1041:{n:"BrtBeginSparklineGroup"},1042:{n:"BrtEndSparklineGroup"},1043:{n:"BrtSparkline"},1044:{n:"BrtSXDI14"},1045:{n:"BrtWsFmtInfoEx14"},1046:{n:"BrtBeginConditionalFormatting14"},1047:{n:"BrtEndConditionalFormatting14"},1048:{n:"BrtBeginCFRule14"},1049:{n:"BrtEndCFRule14"},1050:{n:"BrtCFVO14"},1051:{n:"BrtBeginDatabar14"},1052:{n:"BrtBeginIconSet14"},1053:{n:"BrtDVal14",f:function(){}},1054:{n:"BrtBeginDVals14"},1055:{n:"BrtColor14"},1056:{n:"BrtBeginSparklines"},1057:{n:"BrtEndSparklines"},1058:{n:"BrtBeginSparklineGroups"},1059:{n:"BrtEndSparklineGroups"},1061:{n:"BrtSXVD14"},1062:{n:"BrtBeginSXView14"},1063:{n:"BrtEndSXView14"},1064:{n:"BrtBeginSXView16"},1065:{n:"BrtEndSXView16"},1066:{n:"BrtBeginPCD14"},1067:{n:"BrtEndPCD14"},1068:{n:"BrtBeginExtConn14"},1069:{n:"BrtEndExtConn14"},1070:{n:"BrtBeginSlicerCacheIDs"},1071:{n:"BrtEndSlicerCacheIDs"},1072:{n:"BrtBeginSlicerCacheID"},1073:{n:"BrtEndSlicerCacheID"},1075:{n:"BrtBeginSlicerCache"},1076:{n:"BrtEndSlicerCache"},1077:{n:"BrtBeginSlicerCacheDef"},1078:{n:"BrtEndSlicerCacheDef"},1079:{n:"BrtBeginSlicersEx"},1080:{n:"BrtEndSlicersEx"},1081:{n:"BrtBeginSlicerEx"},1082:{n:"BrtEndSlicerEx"},1083:{n:"BrtBeginSlicer"},1084:{n:"BrtEndSlicer"},1085:{n:"BrtSlicerCachePivotTables"},1086:{n:"BrtBeginSlicerCacheOlapImpl"},1087:{n:"BrtEndSlicerCacheOlapImpl"},1088:{n:"BrtBeginSlicerCacheLevelsData"},1089:{n:"BrtEndSlicerCacheLevelsData"},1090:{n:"BrtBeginSlicerCacheLevelData"},1091:{n:"BrtEndSlicerCacheLevelData"},1092:{n:"BrtBeginSlicerCacheSiRanges"},1093:{n:"BrtEndSlicerCacheSiRanges"},1094:{n:"BrtBeginSlicerCacheSiRange"},1095:{n:"BrtEndSlicerCacheSiRange"},1096:{n:"BrtSlicerCacheOlapItem"},1097:{n:"BrtBeginSlicerCacheSelections"},1098:{n:"BrtSlicerCacheSelection"},1099:{n:"BrtEndSlicerCacheSelections"},1100:{n:"BrtBeginSlicerCacheNative"},1101:{n:"BrtEndSlicerCacheNative"},1102:{n:"BrtSlicerCacheNativeItem"},1103:{n:"BrtRangeProtection14"},1104:{n:"BrtRangeProtectionIso14"},1105:{n:"BrtCellIgnoreEC14"},1111:{n:"BrtList14"},1112:{n:"BrtCFIcon"},1113:{n:"BrtBeginSlicerCachesPivotCacheIDs"},1114:{n:"BrtEndSlicerCachesPivotCacheIDs"},1115:{n:"BrtBeginSlicers"},1116:{n:"BrtEndSlicers"},1117:{n:"BrtWbProp14"},1118:{n:"BrtBeginSXEdit"},1119:{n:"BrtEndSXEdit"},1120:{n:"BrtBeginSXEdits"},1121:{n:"BrtEndSXEdits"},1122:{n:"BrtBeginSXChange"},1123:{n:"BrtEndSXChange"},1124:{n:"BrtBeginSXChanges"},1125:{n:"BrtEndSXChanges"},1126:{n:"BrtSXTupleItems"},1128:{n:"BrtBeginSlicerStyle"},1129:{n:"BrtEndSlicerStyle"},1130:{n:"BrtSlicerStyleElement"},1131:{n:"BrtBeginStyleSheetExt14"},1132:{n:"BrtEndStyleSheetExt14"},1133:{n:"BrtBeginSlicerCachesPivotCacheID"},1134:{n:"BrtEndSlicerCachesPivotCacheID"},1135:{n:"BrtBeginConditionalFormattings"},1136:{n:"BrtEndConditionalFormattings"},1137:{n:"BrtBeginPCDCalcMemExt"},1138:{n:"BrtEndPCDCalcMemExt"},1139:{n:"BrtBeginPCDCalcMemsExt"},1140:{n:"BrtEndPCDCalcMemsExt"},1141:{n:"BrtPCDField14"},1142:{n:"BrtBeginSlicerStyles"},1143:{n:"BrtEndSlicerStyles"},1144:{n:"BrtBeginSlicerStyleElements"},1145:{n:"BrtEndSlicerStyleElements"},1146:{n:"BrtCFRuleExt"},1147:{n:"BrtBeginSXCondFmt14"},1148:{n:"BrtEndSXCondFmt14"},1149:{n:"BrtBeginSXCondFmts14"},1150:{n:"BrtEndSXCondFmts14"},1152:{n:"BrtBeginSortCond14"},1153:{n:"BrtEndSortCond14"},1154:{n:"BrtEndDVals14"},1155:{n:"BrtEndIconSet14"},1156:{n:"BrtEndDatabar14"},1157:{n:"BrtBeginColorScale14"},1158:{n:"BrtEndColorScale14"},1159:{n:"BrtBeginSxrules14"},1160:{n:"BrtEndSxrules14"},1161:{n:"BrtBeginPRule14"},1162:{n:"BrtEndPRule14"},1163:{n:"BrtBeginPRFilters14"},1164:{n:"BrtEndPRFilters14"},1165:{n:"BrtBeginPRFilter14"},1166:{n:"BrtEndPRFilter14"},1167:{n:"BrtBeginPRFItem14"},1168:{n:"BrtEndPRFItem14"},1169:{n:"BrtBeginCellIgnoreECs14"},1170:{n:"BrtEndCellIgnoreECs14"},1171:{n:"BrtDxf14"},1172:{n:"BrtBeginDxF14s"},1173:{n:"BrtEndDxf14s"},1177:{n:"BrtFilter14"},1178:{n:"BrtBeginCustomFilters14"},1180:{n:"BrtCustomFilter14"},1181:{n:"BrtIconFilter14"},1182:{n:"BrtPivotCacheConnectionName"},2048:{n:"BrtBeginDecoupledPivotCacheIDs"},2049:{n:"BrtEndDecoupledPivotCacheIDs"},2050:{n:"BrtDecoupledPivotCacheID"},2051:{n:"BrtBeginPivotTableRefs"},2052:{n:"BrtEndPivotTableRefs"},2053:{n:"BrtPivotTableRef"},2054:{n:"BrtSlicerCacheBookPivotTables"},2055:{n:"BrtBeginSxvcells"},2056:{n:"BrtEndSxvcells"},2057:{n:"BrtBeginSxRow"},2058:{n:"BrtEndSxRow"},2060:{n:"BrtPcdCalcMem15"},2067:{n:"BrtQsi15"},2068:{n:"BrtBeginWebExtensions"},2069:{n:"BrtEndWebExtensions"},2070:{n:"BrtWebExtension"},2071:{n:"BrtAbsPath15"},2072:{n:"BrtBeginPivotTableUISettings"},2073:{n:"BrtEndPivotTableUISettings"},2075:{n:"BrtTableSlicerCacheIDs"},2076:{n:"BrtTableSlicerCacheID"},2077:{n:"BrtBeginTableSlicerCache"},2078:{n:"BrtEndTableSlicerCache"},2079:{n:"BrtSxFilter15"},2080:{n:"BrtBeginTimelineCachePivotCacheIDs"},2081:{n:"BrtEndTimelineCachePivotCacheIDs"},2082:{n:"BrtTimelineCachePivotCacheID"},2083:{n:"BrtBeginTimelineCacheIDs"},2084:{n:"BrtEndTimelineCacheIDs"},2085:{n:"BrtBeginTimelineCacheID"},2086:{n:"BrtEndTimelineCacheID"},2087:{n:"BrtBeginTimelinesEx"},2088:{n:"BrtEndTimelinesEx"},2089:{n:"BrtBeginTimelineEx"},2090:{n:"BrtEndTimelineEx"},2091:{n:"BrtWorkBookPr15"},2092:{n:"BrtPCDH15"},2093:{n:"BrtBeginTimelineStyle"},2094:{n:"BrtEndTimelineStyle"},2095:{n:"BrtTimelineStyleElement"},2096:{n:"BrtBeginTimelineStylesheetExt15"},2097:{n:"BrtEndTimelineStylesheetExt15"},2098:{n:"BrtBeginTimelineStyles"},2099:{n:"BrtEndTimelineStyles"},2100:{n:"BrtBeginTimelineStyleElements"},2101:{n:"BrtEndTimelineStyleElements"},2102:{n:"BrtDxf15"},2103:{n:"BrtBeginDxfs15"},2104:{n:"brtEndDxfs15"},2105:{n:"BrtSlicerCacheHideItemsWithNoData"},2106:{n:"BrtBeginItemUniqueNames"},2107:{n:"BrtEndItemUniqueNames"},2108:{n:"BrtItemUniqueName"},2109:{n:"BrtBeginExtConn15"},2110:{n:"BrtEndExtConn15"},2111:{n:"BrtBeginOledbPr15"},2112:{n:"BrtEndOledbPr15"},2113:{n:"BrtBeginDataFeedPr15"},2114:{n:"BrtEndDataFeedPr15"},2115:{n:"BrtTextPr15"},2116:{n:"BrtRangePr15"},2117:{n:"BrtDbCommand15"},2118:{n:"BrtBeginDbTables15"},2119:{n:"BrtEndDbTables15"},2120:{n:"BrtDbTable15"},2121:{n:"BrtBeginDataModel"},2122:{n:"BrtEndDataModel"},2123:{n:"BrtBeginModelTables"},2124:{n:"BrtEndModelTables"},2125:{n:"BrtModelTable"},2126:{n:"BrtBeginModelRelationships"},2127:{n:"BrtEndModelRelationships"},2128:{n:"BrtModelRelationship"},2129:{n:"BrtBeginECTxtWiz15"},2130:{n:"BrtEndECTxtWiz15"},2131:{n:"BrtBeginECTWFldInfoLst15"},2132:{n:"BrtEndECTWFldInfoLst15"},2133:{n:"BrtBeginECTWFldInfo15"},2134:{n:"BrtFieldListActiveItem"},2135:{n:"BrtPivotCacheIdVersion"},2136:{n:"BrtSXDI15"},2137:{n:"BrtBeginModelTimeGroupings"},2138:{n:"BrtEndModelTimeGroupings"},2139:{n:"BrtBeginModelTimeGrouping"},2140:{n:"BrtEndModelTimeGrouping"},2141:{n:"BrtModelTimeGroupingCalcCol"},3072:{n:"BrtUid"},3073:{n:"BrtRevisionPtr"},5095:{n:"BrtBeginCalcFeatures"},5096:{n:"BrtEndCalcFeatures"},5097:{n:"BrtCalcFeature"},65535:{n:""}},Au=e(Ru,"n"),Tu={3:{n:"BIFF2NUM",f:function(e){var t=St(e);return++e.l,e=Re(e),t.t="n",t.val=e,t}},4:{n:"BIFF2STR",f:function(e,t,n){var i=St(e);return++e.l,n=ft(e,0,n),i.t="str",i.val=n,i}},6:{n:"Formula",f:Xn},9:{n:"BOF",f:Pt},10:{n:"EOF",f:rt},12:{n:"CalcCount",f:ot},13:{n:"CalcMode",f:ot},14:{n:"CalcPrecision",f:at},15:{n:"CalcRefMode",f:at},16:{n:"CalcDelta",f:Re},17:{n:"CalcIter",f:at},18:{n:"Protect",f:at},19:{n:"Password",f:ot},20:{n:"Header",f:lo},21:{n:"Footer",f:lo},23:{n:"ExternSheet",f:Ft},24:{n:"Lbl",f:Lt},25:{n:"WinProtect",f:at},26:{n:"VerticalPageBreaks"},27:{n:"HorizontalPageBreaks"},28:{n:"Note",f:function(e,t,n){return function(e,t){if(!(t.biff<8)){var n=e._R(2),i=e._R(2),r=e._R(2),a=e._R(2),s=ft(e,0,t);return t.biff<8&&e._R(1),[{r:n,c:i},s,a,r]}}(e,n)}},29:{n:"Selection"},34:{n:"Date1904",f:at},35:{n:"ExternName",f:It},36:{n:"COLWIDTH"},38:{n:"LeftMargin",f:Re},39:{n:"RightMargin",f:Re},40:{n:"TopMargin",f:Re},41:{n:"BottomMargin",f:Re},42:{n:"PrintRowCol",f:at},43:{n:"PrintGrid",f:at},47:{n:"FilePass",f:function(e,t,n){var i={Type:8<=n.biff?e._R(2):0};return i.Type?qt(e,t-2,i):(t=e,n.biff,e=n,n=i,t={key:ot(t),verificationBytes:ot(t)},e.password&&(t.verifier=Zt(e.password)),n.valid=t.verificationBytes===t.verifier,n.valid&&(n.insitu=Fl(e.password))),i}},49:{n:"Font",f:function(e,t,n){var i={dyHeight:e._R(2),fl:e._R(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return i.name=ut(e,0,n),i}},51:{n:"PrintSize",f:ot},60:{n:"Continue"},61:{n:"Window1",f:function(e){return{Pos:[e._R(2),e._R(2)],Dim:[e._R(2),e._R(2)],Flags:e._R(2),CurTab:e._R(2),FirstTab:e._R(2),Selected:e._R(2),TabRatio:e._R(2)}}},64:{n:"Backup",f:at},65:{n:"Pane",f:function(){}},66:{n:"CodePage",f:ot},77:{n:"Pls"},80:{n:"DCon"},81:{n:"DConRef"},82:{n:"DConName"},85:{n:"DefColWidth",f:ot},89:{n:"XCT"},90:{n:"CRN"},91:{n:"FileSharing"},92:{n:"WriteAccess",f:function(e,t,n){if(n.enc)return e.l+=t,"";var i=e.l,n=ft(e,0,n);return e._R(t+i-e.l),n}},93:{n:"Obj",f:function(e,t,n){return n&&n.biff<8?function(e,t,n){e.l+=4;var i=e._R(2),r=e._R(2),a=e._R(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((So[i]||v)(e,t,n)),{cmo:[r,i,a],ft:s}}(e,t,n):{cmo:n=Et(e),ft:function(e,t){for(var n=e.l+t,i=[];e.l<n;){var r=e._R(2);e.l-=2;try{i.push(go[r](e,n-e.l))}catch(t){return e.l=n,i}}return e.l!=n&&(e.l=n),i}(e,t-22,n[1])}}},94:{n:"Uncalced"},95:{n:"CalcSaveRecalc",f:at},96:{n:"Template"},97:{n:"Intl"},99:{n:"ObjProtect",f:at},125:{n:"ColInfo",f:zt},128:{n:"Guts",f:function(e){if(e.l+=4,0!==(e=[e._R(2),e._R(2)])[0]&&e[0]--,0!==e[1]&&e[1]--,7<e[0]||7<e[1])throw new Error("Bad Gutters: "+e.join("|"));return e}},129:{n:"WsBool",f:function(e,t,n){return{fDialog:16&(n&&8==n.biff||2==t?e._R(2):(e.l+=t,0))}}},130:{n:"GridSet",f:ot},131:{n:"HCenter",f:at},132:{n:"VCenter",f:at},133:{n:"BoundSheet8",f:function(e,t,n){var i=e._R(4),r=3&e._R(1),a=e._R(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule"}return n=ut(e,0,n),{pos:i,hs:r,dt:a,name:n=0===n.length?"Sheet1":n}}},134:{n:"WriteProtect"},140:{n:"Country",f:function(e){var t=[0,0],n=e._R(2);return t[0]=Us[n]||n,n=e._R(2),t[1]=Us[n]||n,t}},141:{n:"HideObj",f:ot},144:{n:"Sort"},146:{n:"Palette",f:function(e){for(var t=e._R(2),n=[];0<t--;)n.push(bt(e));return n}},151:{n:"Sync"},152:{n:"LPr"},153:{n:"DxGCol"},154:{n:"FnGroupName"},155:{n:"FilterMode"},156:{n:"BuiltInFnGroupCount",f:ot},157:{n:"AutoFilterInfo"},158:{n:"AutoFilter"},160:{n:"Scl",f:Vo},161:{n:"Setup",f:function(e,t){var n={};return t<32||(e.l+=16,n.header=Re(e),n.footer=Re(e),e.l+=2),n}},174:{n:"ScenMan"},175:{n:"SCENARIO"},176:{n:"SxView"},177:{n:"Sxvd"},178:{n:"SXVI"},180:{n:"SxIvd"},181:{n:"SXLI"},182:{n:"SXPI"},184:{n:"DocRoute"},185:{n:"RecipName"},189:{n:"MulRk",f:function(e,t){for(var n=e.l+t-2,i=e._R(2),r=e._R(2),a=[];e.l<n;)a.push(xt(e));if(e.l!==n)throw new Error("MulRK read error");if(t=e._R(2),a.length!=t-r+1)throw new Error("MulRK length mismatch");return{r:i,c:r,C:t,rkrec:a}}},190:{n:"MulBlank",f:function(e,t){for(var n=e.l+t-2,i=e._R(2),r=e._R(2),a=[];e.l<n;)a.push(e._R(2));if(e.l!==n)throw new Error("MulBlank read error");if(t=e._R(2),a.length!=t-r+1)throw new Error("MulBlank length mismatch");return{r:i,c:r,C:t,ixfe:a}}},193:{n:"Mms",f:rt},197:{n:"SXDI"},198:{n:"SXDB"},199:{n:"SXFDB"},200:{n:"SXDBB"},201:{n:"SXNum"},202:{n:"SxBool",f:at},203:{n:"SxErr"},204:{n:"SXInt"},205:{n:"SXString"},206:{n:"SXDtr"},207:{n:"SxNil"},208:{n:"SXTbl"},209:{n:"SXTBRGIITM"},210:{n:"SxTbpg"},211:{n:"ObProj"},213:{n:"SXStreamID"},215:{n:"DBCell"},216:{n:"SXRng"},217:{n:"SxIsxoper"},218:{n:"BookBool",f:ot},220:{n:"DbOrParamQry"},221:{n:"ScenarioProtect",f:at},222:{n:"OleObjectSize"},224:{n:"XF",f:function(e,t,n){var i,r,a,s={};return s.ifnt=e._R(2),s.numFmtId=e._R(2),s.flags=e._R(2),s.fStyle=s.flags>>2&1,t-=6,s.data=(i=e,s.fStyle,r=n,a={},t=i._R(4),e=i._R(4),n=i._R(4),i=i._R(2),a.patternType=Hs[n>>26],r.cellStyles&&(a.alc=7&t,a.fWrap=t>>3&1,a.alcV=t>>4&7,a.fJustLast=t>>7&1,a.trot=t>>8&255,a.cIndent=t>>16&15,a.fShrinkToFit=t>>20&1,a.iReadOrder=t>>22&2,a.fAtrNum=t>>26&1,a.fAtrFnt=t>>27&1,a.fAtrAlc=t>>28&1,a.fAtrBdr=t>>29&1,a.fAtrPat=t>>30&1,a.fAtrProt=t>>31&1,a.dgLeft=15&e,a.dgRight=e>>4&15,a.dgTop=e>>8&15,a.dgBottom=e>>12&15,a.icvLeft=e>>16&127,a.icvRight=e>>23&127,a.grbitDiag=e>>30&3,a.icvTop=127&n,a.icvBottom=n>>7&127,a.icvDiag=n>>14&127,a.dgDiag=n>>21&15,a.icvFore=127&i,a.icvBack=i>>7&127,a.fsxButton=i>>14&1),a),s}},225:{n:"InterfaceHdr",f:function(e,t){return 0===t||e._R(2),1200}},226:{n:"InterfaceEnd",f:rt},227:{n:"SXVS"},229:{n:"MergeCells",f:function(e,t){for(var n=[],i=e._R(2);i--;)n.push(wt(e,t));return n}},233:{n:"BkHim"},235:{n:"MsoDrawingGroup"},236:{n:"MsoDrawing"},237:{n:"MsoDrawingSelection"},239:{n:"PhoneticInfo"},240:{n:"SxRule"},241:{n:"SXEx"},242:{n:"SxFilt"},244:{n:"SxDXF"},245:{n:"SxItm"},246:{n:"SxName"},247:{n:"SxSelect"},248:{n:"SXPair"},249:{n:"SxFmla"},251:{n:"SxFormat"},252:{n:"SST",f:function(e,t){for(var n=e.l+t,t=e._R(4),i=e._R(4),r=[],a=0;a!=i&&e.l<n;++a)r.push(function(e){var t=zr;zr=1200;var n,i=e._R(2),r=4&(l=e._R(1)),a=8&l,s=1+(1&l),o=0,l={};return a&&(o=e._R(2)),r&&(n=e._R(4)),s=0===i?"":e._R(i,2==s?"dbcs-cont":"sbcs-cont"),a&&(e.l+=4*o),r&&(e.l+=n),l.t=s,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),zr=t,l}(e));return r.Count=t,r.Unique=i,r}},253:{n:"LabelSst",f:function(e){var t=St(e);return t.isst=e._R(4),t}},255:{n:"ExtSST",f:function(e,t){var n={};return n.dsst=e._R(2),e.l+=t-2,n}},256:{n:"SXVDEx"},259:{n:"SXFormula"},290:{n:"SXDBEx"},311:{n:"RRDInsDel"},312:{n:"RRDHead"},315:{n:"RRDChgCell"},317:{n:"RRTabId",f:ct},318:{n:"RRDRenSheet"},319:{n:"RRSort"},320:{n:"RRDMove"},330:{n:"RRFormat"},331:{n:"RRAutoFmt"},333:{n:"RRInsertSh"},334:{n:"RRDMoveBegin"},335:{n:"RRDMoveEnd"},336:{n:"RRDInsDelBegin"},337:{n:"RRDInsDelEnd"},338:{n:"RRDConflict"},339:{n:"RRDDefName"},340:{n:"RRDRstEtxp"},351:{n:"LRng"},352:{n:"UsesELFs",f:at},353:{n:"DSF",f:rt},401:{n:"CUsr"},402:{n:"CbUsr"},403:{n:"UsrInfo"},404:{n:"UsrExcl"},405:{n:"FileLock"},406:{n:"RRDInfo"},407:{n:"BCUsrs"},408:{n:"UsrChk"},425:{n:"UserBView"},426:{n:"UserSViewBegin"},427:{n:"UserSViewEnd"},428:{n:"RRDUserView"},429:{n:"Qsi"},430:{n:"SupBook",f:function(e,t,n){var i=e.l+t,r=e._R(2),t=e._R(2);if(1025==(n.sbcch=t)||14849==t)return[t,r];if(t<1||255<t)throw new Error("Unexpected SupBook type: "+t);for(var n=ht(e,t),a=[];i>e.l;)a.push(dt(e));return[t,r,n,a]}},431:{n:"Prot4Rev",f:at},432:{n:"CondFmt"},433:{n:"CF"},434:{n:"DVal"},437:{n:"DConBin"},438:{n:"TxO",f:function(e,t,n){var i,r=e.l,a="";try{e.l+=4;var s=(n.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:((i=e)._R(1),i.l++,i._R(2),i.l+=2);var o=e._R(2);e._R(2),ot(e);var l=e._R(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-r!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l];if((a+=ht(e,e.lens[c+1]-e.lens[c]-1)).length>=(u?o:2*o))break}if(a.length!==o&&a.length!==2*o)throw new Error("cchText: "+o+" != "+a.length);return e.l=r+t,{t:a}}catch(n){return e.l=r+t,{t:a}}}},439:{n:"RefreshAll",f:at},440:{n:"HLink",f:function(e,t){var n=wt(e,8);return e.l+=16,[n,function(e,t){var n=e.l+t;if(2!==(l=e._R(4)))throw new Error("Unrecognized streamVersion: "+l);t=e._R(2),e.l+=2;var i,r,a,s,o,l="";16&t&&(i=gt(e,e.l)),128&t&&(r=gt(e,e.l)),257==(257&t)&&(a=gt(e,e.l)),1==(257&t)&&(c=mt(e,e.l)),8&t&&(l=gt(e,e.l)),32&t&&(s=e._R(16)),64&t&&(o=Ue(e)),e.l=n;var c=r||a||c||"";return c&&l&&(c+="#"+l),c={Target:c=c||"#"+l},s&&(c.guid=s),o&&(c.time=o),i&&(c.Tooltip=i),c}(e,t-24)]}},441:{n:"Lel"},442:{n:"CodeName",f:dt},443:{n:"SXFDBType"},444:{n:"Prot4RevPass",f:ot},445:{n:"ObNoMacros"},446:{n:"Dv"},448:{n:"Excel9File",f:rt},449:{n:"RecalcId",f:function(e){return e._R(2),e._R(4)},r:2},450:{n:"EntExU2",f:rt},512:{n:"Dimensions",f:Tt},513:{n:"Blank",f:Wo},515:{n:"Number",f:function(e){var t=St(e),e=Re(e);return t.val=e,t}},516:{n:"Label",f:function(e,t,n){return e.l,t=St(e),2==n.biff&&e.l++,n=dt(e,e.l,n),t.val=n,t}},517:{n:"BoolErr",f:Mt},518:{n:"Formula",f:Xn},519:{n:"String",f:$o},520:{n:"Row",f:function(e){var t={};t.r=e._R(2),t.c=e._R(2),t.cnt=e._R(2)-t.c;var n=e._R(2);e.l+=4;var i=e._R(1);return e.l+=3,7&i&&(t.level=7&i),32&i&&(t.hidden=!0),64&i&&(t.hpt=n/20),t}},523:{n:"Index"},545:{n:"Array",f:Ot},549:{n:"DefaultRowHeight",f:At},566:{n:"Table"},574:{n:"Window2",f:function(e,t,n){return n&&2<=n.biff&&n.biff<8?{}:{RTL:64&e._R(2)}}},638:{n:"RK",f:function(e){var t=e._R(2),n=e._R(2),e=xt(e);return{r:t,c:n,ixfe:e[0],rknum:e[1]}}},659:{n:"Style"},1030:{n:"Formula",f:Xn},1048:{n:"BigName"},1054:{n:"Format",f:function(e,t,n){return[e._R(2),ft(e,0,n)]}},1084:{n:"ContinueBigName"},1212:{n:"ShrFmla",f:function(e,t,n){var i=Ct(e);e.l++;var r,a,s,o,l=e._R(1);return[(a=t-=8,s=n,t=(r=e).l+a,n=r._R(2),e=Vn(r,n,s),65535==n?[[],v(r,a-2)]:(a!==n+2&&(o=Wn(r,t-n-2,e,s)),[e,o])),l,i]}},2048:{n:"HLinkTooltip",f:function(e,t){return e._R(2),[wt(e,8),e._R((t-10)/2,"dbcs-cont").replace(ia,"")]}},2049:{n:"WebPub"},2050:{n:"QsiSXTag"},2051:{n:"DBQueryExt"},2052:{n:"ExtString"},2053:{n:"TxtQry"},2054:{n:"Qsir"},2055:{n:"Qsif"},2056:{n:"RRDTQSIF"},2057:{n:"BOF",f:Pt},2058:{n:"OleDbConn"},2059:{n:"WOpt"},2060:{n:"SXViewEx"},2061:{n:"SXTH"},2062:{n:"SXPIEx"},2063:{n:"SXVDTEx"},2064:{n:"SXViewEx9"},2066:{n:"ContinueFrt"},2067:{n:"RealTimeData"},2128:{n:"ChartFrtInfo"},2129:{n:"FrtWrapper"},2130:{n:"StartBlock"},2131:{n:"EndBlock"},2132:{n:"StartObject"},2133:{n:"EndObject"},2134:{n:"CatLab"},2135:{n:"YMult"},2136:{n:"SXViewLink"},2137:{n:"PivotChartBits"},2138:{n:"FrtFontList"},2146:{n:"SheetExt"},2147:{n:"BookExt",r:12},2148:{n:"SXAddl"},2149:{n:"CrErr"},2150:{n:"HFPicture"},2151:{n:"FeatHdr",f:rt},2152:{n:"Feat"},2154:{n:"DataLabExt"},2155:{n:"DataLabExtContents"},2156:{n:"CellWatch"},2161:{n:"FeatHdr11"},2162:{n:"Feature11"},2164:{n:"DropDownObjIds"},2165:{n:"ContinueFrt11"},2166:{n:"DConn"},2167:{n:"List12"},2168:{n:"Feature12"},2169:{n:"CondFmt12"},2170:{n:"CF12"},2171:{n:"CFEx"},2172:{n:"XFCRC",f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e._R(2),t.crc=e._R(4),t},r:12},2173:{n:"XFExt",f:function(e,t){e.l,e.l+=2,t=e._R(2),e.l+=2;for(var n=e._R(2),i=[];0<n--;)i.push(En(e,e.l));return{ixfe:t,ext:i}},r:12},2174:{n:"AutoFilter12"},2175:{n:"ContinueFrt12"},2180:{n:"MDTInfo"},2181:{n:"MDXStr"},2182:{n:"MDXTuple"},2183:{n:"MDXSet"},2184:{n:"MDXProp"},2185:{n:"MDXKPI"},2186:{n:"MDB"},2187:{n:"PLV"},2188:{n:"Compat12",f:at,r:12},2189:{n:"DXF"},2190:{n:"TableStyles",r:12},2191:{n:"TableStyle"},2192:{n:"TableStyleElement"},2194:{n:"StyleExt"},2195:{n:"NamePublish"},2196:{n:"NameCmt",f:function(e,t,n){if(!(n.biff<8)){var i=e._R(2),r=e._R(2);return[ht(e,i,n),ht(e,r,n)]}e.l+=t},r:12},2197:{n:"SortData"},2198:{n:"Theme",f:function(e,t,n){var i=e.l+t;if(124226!==e._R(4)){if(n.cellStyles&&fa){t=e.slice(e.l);e.l=i;try{r=new fa(t)}catch(e){return}var r=B(r,"theme/theme/theme1.xml",!0);return r?wn(r,n):void 0}e.l=i}},r:12},2199:{n:"GUIDTypeLib"},2200:{n:"FnGrp12"},2201:{n:"NameFnGrp12"},2202:{n:"MTRSettings",f:function(e){return[0!==e._R(4),0!==e._R(4),e._R(4)]},r:12},2203:{n:"CompressPictures",f:rt},2204:{n:"HeaderFooter"},2205:{n:"CrtLayout12"},2206:{n:"CrtMlFrt"},2207:{n:"CrtMlFrtContinue"},2211:{n:"ForceFullCalculation",f:function(e){var t,n,i=(n=(t=e)._R(2),i=t._R(2),t.l+=8,{type:n,flags:i});if(2211!=i.type)throw new Error("Invalid Future Record "+i.type);return 0!==e._R(4)}},2212:{n:"ShapePropsStream"},2213:{n:"TextPropsStream"},2214:{n:"RichTextStream"},2215:{n:"CrtLayout12A"},4097:{n:"Units"},4098:{n:"Chart"},4099:{n:"Series"},4102:{n:"DataFormat"},4103:{n:"LineFormat"},4105:{n:"MarkerFormat"},4106:{n:"AreaFormat"},4107:{n:"PieFormat"},4108:{n:"AttachedLabel"},4109:{n:"SeriesText"},4116:{n:"ChartFormat"},4117:{n:"Legend"},4118:{n:"SeriesList"},4119:{n:"Bar"},4120:{n:"Line"},4121:{n:"Pie"},4122:{n:"Area"},4123:{n:"Scatter"},4124:{n:"CrtLine"},4125:{n:"Axis"},4126:{n:"Tick"},4127:{n:"ValueRange"},4128:{n:"CatSerRange"},4129:{n:"AxisLine"},4130:{n:"CrtLink"},4132:{n:"DefaultText"},4133:{n:"Text"},4134:{n:"FontX",f:ot},4135:{n:"ObjectLink"},4146:{n:"Frame"},4147:{n:"Begin"},4148:{n:"End"},4149:{n:"PlotArea"},4154:{n:"Chart3d"},4156:{n:"PicF"},4157:{n:"DropBar"},4158:{n:"Radar"},4159:{n:"Surf"},4160:{n:"RadarArea"},4161:{n:"AxisParent"},4163:{n:"LegendException"},4164:{n:"ShtProps",f:function(e,t,n){var i={area:!1};return 5!=n.biff?e.l+=t:(t=e._R(1),e.l+=3,16&t&&(i.area=!0)),i}},4165:{n:"SerToCrt"},4166:{n:"AxesUsed"},4168:{n:"SBaseRef"},4170:{n:"SerParent"},4171:{n:"SerAuxTrend"},4174:{n:"IFmtRecord"},4175:{n:"Pos"},4176:{n:"AlRuns"},4177:{n:"BRAI"},4187:{n:"SerAuxErrBar"},4188:{n:"ClrtClient",f:function(e){for(var t=e._R(2),n=[];0<t--;)n.push(bt(e));return n}},4189:{n:"SerFmt"},4191:{n:"Chart3DBarShape"},4192:{n:"Fbi"},4193:{n:"BopPop"},4194:{n:"AxcExt"},4195:{n:"Dat"},4196:{n:"PlotGrowth"},4197:{n:"SIIndex"},4198:{n:"GelFrame"},4199:{n:"BopPopCustom"},4200:{n:"Fbi2"},0:{n:"Dimensions",f:Tt},2:{n:"BIFF2INT",f:function(e){var t=St(e);return++e.l,e=e._R(2),t.t="n",t.val=e,t}},5:{n:"BoolErr",f:Mt},7:{n:"String",f:function(e){var t=e._R(1);return 0===t?(e.l++,""):e._R(t,"sbcs-cont")}},8:{n:"BIFF2ROW"},11:{n:"Index"},22:{n:"ExternCount",f:ot},30:{n:"BIFF2FORMAT",f:vo},31:{n:"BIFF2FMTCNT"},32:{n:"BIFF2COLINFO"},33:{n:"Array",f:Ot},37:{n:"DefaultRowHeight",f:At},50:{n:"BIFF2FONTXTRA",f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},52:{n:"DDEObjName"},62:{n:"BIFF2WINDOW2"},67:{n:"BIFF2XF"},69:{n:"BIFF2FONTCLR"},86:{n:"BIFF4FMTCNT"},126:{n:"RK"},127:{n:"ImData",f:function(e){var t=e._R(2),n=e._R(2),i=e._R(4),n={fmt:t,env:n,len:i,data:e.slice(e.l,e.l+i)};return e.l+=i,n}},135:{n:"Addin"},136:{n:"Edg"},137:{n:"Pub"},145:{n:"Sub"},148:{n:"LHRecord"},149:{n:"LHNGraph"},150:{n:"Sound"},169:{n:"CoordList"},171:{n:"GCW"},188:{n:"ShrFmla"},191:{n:"ToolbarHdr"},192:{n:"ToolbarEnd"},194:{n:"AddMenu"},195:{n:"DelMenu"},214:{n:"RString",f:function(e,t,n){var i=e.l+t,r=St(e),t=e._R(2),n=ht(e,t,n);return e.l=i,r.t="str",r.val=n,r}},223:{n:"UDDesc"},234:{n:"TabIdConf"},354:{n:"XL5Modify"},421:{n:"FileSharing2"},521:{n:"BOF",f:Pt},536:{n:"Lbl",f:Lt},547:{n:"ExternName",f:It},561:{n:"Font"},579:{n:"BIFF3XF"},1033:{n:"BOF",f:Pt},1091:{n:"BIFF4XF"},2157:{n:"FeatInfo"},2163:{n:"FeatInfo11"},2177:{n:"SXAddl12"},2240:{n:"AutoWebPub"},2241:{n:"ListObj"},2242:{n:"ListField"},2243:{n:"ListDV"},2244:{n:"ListCondFmt"},2245:{n:"ListCF"},2246:{n:"FMQry"},2247:{n:"FMSQry"},2248:{n:"PLV"},2249:{n:"LnExt"},2250:{n:"MkrExt"},2251:{n:"CrtCoopt"},2262:{n:"FRTArchId$",r:12},29282:{}},Bu=e(Tu,"n"),Mu={to_workbook:function(e,t){return pe(Zu(e,t),t)},to_sheet:Zu,_row:qu,BEGIN:fu='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',END:pu="</body></html>",_preamble:Qu,from_sheet:function(e,t){var n=t||{},i=null!=n.header?n.header:fu,t=null!=n.footer?n.footer:pu,r=[i],a=J(e["!ref"]);n.dense=Array.isArray(e),r.push(Qu(0,0,n));for(var s=a.s.r;s<=a.e.r;++s)r.push(qu(e,a,s,n));return r.push("</table>"+t),r.join("")}},Du=(du={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']},function(e,t){var n=t||{};null!=Zr&&null==n.dense&&(n.dense=Zr);var i,r,a,s,o=Li(e),l=[],c={name:""},u="",h=0,d={},f=[],p=n.dense?[]:{},m={value:""},g="",v=0,b=[],S=-1,y=-1,x={s:{r:1e6,c:1e7},e:{r:0,c:0}},w=0,_={},C=[],E={},k=0,P=0,R=[],A=1,T=1,B=[],M={Names:[]},D={},I=["",""],L=[],F={},O="",N=0,z=!1,W=!1,V=0;for(ku.lastIndex=0,o=o.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");a=ku.exec(o);)switch(a[3]=a[3].replace(/_.*$/,"")){case"table":case"":"/"===a[1]?(x.e.c>=x.s.c&&x.e.r>=x.s.r&&(p["!ref"]=de(x)),0<n.sheetRows&&n.sheetRows<=x.e.r&&(p["!fullref"]=p["!ref"],x.e.r=n.sheetRows-1,p["!ref"]=de(x)),C.length&&(p["!merges"]=C),R.length&&(p["!rows"]=R),r.name=r[""]||r.name,"undefined"!=typeof JSON&&JSON.stringify(r),f.push(r.name),d[r.name]=p,W=!1):"/"!==a[0].charAt(a[0].length-2)&&(r=ie(a[0],!1),S=y=-1,x.s.r=x.s.c=1e7,x.e.r=x.e.c=0,p=n.dense?[]:{},C=[],R=[],W=!0);break;case"table-row-group":"/"===a[1]?--w:++w;break;case"table-row":case"":if("/"===a[1]){S+=A,A=1;break}if(($=ie(a[0],!1))[""]?S=$[""]-1:-1==S&&(S=0),(A=+$["number-rows-repeated"]||1)<10)for(V=0;V<A;++V)0<w&&(R[S+V]={level:w});y=-1;break;case"covered-table-cell":"/"!==a[1]&&++y,n.sheetStubs&&(n.dense?(p[S]||(p[S]=[]),p[S][y]={t:"z"}):p[he({r:S,c:y})]={t:"z"}),g="",b=[];break;case"table-cell":case"":if("/"===a[0].charAt(a[0].length-2))++y,m=ie(a[0],!1),T=parseInt(m["number-columns-repeated"]||"1",10),s={t:"z",v:null},m.formula&&0!=n.cellFormula&&(s.f=Yn(Aa(m.formula))),"string"==(m[""]||m["value-type"])&&(s.t="s",s.v=Aa(m["string-value"]||""),n.dense?(p[S]||(p[S]=[]),p[S][y]=s):p[he({r:S,c:y})]=s),y+=T-1;else if("/"!==a[1]){var T=1,$=A?S+A-1:S;if(++y>x.e.c&&(x.e.c=y),y<x.s.c&&(x.s.c=y),S<x.s.r&&(x.s.r=S),$>x.e.r&&(x.e.r=$),L=[],s={t:(m=ie(a[0],!(F={})))[""]||m["value-type"],v:null},n.cellFormula)if(m.formula&&(m.formula=Aa(m.formula)),m["number-matrix-columns-spanned"]&&m["number-matrix-rows-spanned"]&&(k=parseInt(m["number-matrix-rows-spanned"],10)||0,P=parseInt(m["number-matrix-columns-spanned"],10)||0,s.F=de(E={s:{r:S,c:y},e:{r:S+k-1,c:y+P-1}}),B.push([E,s.F])),m.formula)s.f=Yn(m.formula);else for(V=0;V<B.length;++V)S>=B[V][0].s.r&&S<=B[V][0].e.r&&y>=B[V][0].s.c&&y<=B[V][0].e.c&&(s.F=B[V][1]);switch((m["number-columns-spanned"]||m["number-rows-spanned"])&&(k=parseInt(m["number-rows-spanned"],10)||0,P=parseInt(m["number-columns-spanned"],10)||0,C.push(E={s:{r:S,c:y},e:{r:S+k-1,c:y+P-1}})),m["number-columns-repeated"]&&(T=parseInt(m["number-columns-repeated"],10)),s.t){case"boolean":s.t="b",s.v=re(m["boolean-value"]);break;case"float":case"percentage":case"currency":s.t="n",s.v=parseFloat(m.value);break;case"date":s.t="d",s.v=te(m["date-value"]),n.cellDates||(s.t="n",s.v=G(s.v)),s.z="m/d/yy";break;case"time":s.t="n",s.v=function(e){var t=0,n=0,i=!1,r=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!r)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=r.length;++a)if(r[a]){switch(3<a&&(i=!0),r[a].slice(r[a].length-(n=1))){case"Y":throw new Error("Unsupported ISO Duration Field: "+r[a].slice(r[a].length-1));case"D":n*=24;case"H":n*=60;case"M":if(!i)throw new Error("Unsupported ISO Duration Field: M");n*=60}t+=n*parseInt(r[a],10)}return t}(m["time-value"])/86400;break;case"number":s.t="n",s.v=parseFloat(m[""]);break;default:if("string"!==s.t&&"text"!==s.t&&s.t)throw new Error("Unsupported value type "+s.t);s.t="s",null!=m["string-value"]&&(g=Aa(m["string-value"]),b=[])}}else{if(z=!1,"s"===s.t&&(s.v=g||"",b.length&&(s.R=b),z=0==v),D.Target&&(s.l=D),0<L.length&&(s.c=L,L=[]),g&&!1!==n.cellText&&(s.w=g),(!z||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=S))for(var U=0;U<A;++U){if(T=parseInt(m["number-columns-repeated"]||"1",10),n.dense)for(p[S+U]||(p[S+U]=[]),p[S+U][y]=0==U?s:ne(s);0<--T;)p[S+U][y+T]=ne(s);else for(p[he({r:S+U,c:y})]=s;0<--T;)p[he({r:S+U,c:y+T})]=ne(s);x.e.c<=y&&(x.e.c=y)}y+=(T=parseInt(m["number-columns-repeated"]||"1",10))-1,T=0,s={},g="",b=[]}D={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":if("/"===a[1]){if((i=l.pop())[0]!==a[3])throw"Bad state: "+i}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break;case"annotation":if("/"===a[1]){if((i=l.pop())[0]!==a[3])throw"Bad state: "+i;F.t=g,b.length&&(F.R=b),F.a=O,L.push(F)}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!1]);g=O="",v=N=0,b=[];break;case"creator":"/"===a[1]?O=o.slice(N,a.index):N=a.index+a[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===a[1]){if((i=l.pop())[0]!==a[3])throw"Bad state: "+i}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!1]);g="",v=0,b=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===a[1]){if(_[c.name]=u,(i=l.pop())[0]!==a[3])throw"Bad state: "+i}else"/"!==a[0].charAt(a[0].length-2)&&(u="",c=ie(a[0],!1),l.push([a[3],!0]));break;case"script":case"libraries":case"automatic-styles":case"master-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(l[l.length-1][0]){case"time-style":case"date-style":H=ie(a[0],!1),u+=du[a[3]]["long"===H.style?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(l[l.length-1][0]){case"time-style":case"date-style":H=ie(a[0],!1),u+=du[a[3]]["long"===H.style?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if("/>"===a[0].slice(-2))break;if("/"===a[1])switch(l[l.length-1][0]){case"number-style":case"date-style":case"time-style":u+=o.slice(h,a.index)}else h=a.index+a[0].length;break;case"named-range":var H,I=Kn((H=ie(a[0],!1))["cell-range-address"]),X={Name:H.name,Ref:I[0]+"!"+I[1]};W&&(X.Sheet=f.length),M.Names.push(X);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"":"/"!==a[1]||m&&m["string-value"]?(ie(a[0],!1),v=a.index+a[0].length):(X=function(e){e=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[Aa(e.replace(/<[^>]*>/g,""))]}(o.slice(v,a.index)),g=(0<g.length?g+"\n":"")+X[0]);break;case"s":break;case"database-range":if("/"===a[1])break;try{d[(I=Kn(ie(a[0])["target-range-address"]))[0]]["!autofilter"]={ref:I[1]}}catch(e){}break;case"date":case"object":break;case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if("/"!==a[1]){if(!(D=ie(a[0],!1)).href)break;D.Target=D.href,delete D.href,"#"==D.Target.charAt(0)&&-1<D.Target.indexOf(".")&&(I=Kn(D.Target.slice(1)),D.Target="#"+I[0]+"!"+I[1])}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(a[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(a)}}e={Sheets:d,SheetNames:f,Workbook:M};return n.bookSheets&&delete e.Sheets,e}),Iu=(hu="<office:document-styles "+D({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+"></office:document-styles>",function(){return Sa+hu}),Lu=function(e,t){var n=[Sa],i=D({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),r=D({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?n.push("<office:document"+i+r+">\n"):n.push("<office:document-content"+i+">\n"),(i=n).push(" <office:automatic-styles>\n"),i.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),i.push('   <number:month number:style="long"/>\n'),i.push("   <number:text>/</number:text>\n"),i.push('   <number:day number:style="long"/>\n'),i.push("   <number:text>/</number:text>\n"),i.push("   <number:year/>\n"),i.push("  </number:date-style>\n"),i.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),i.push(" </office:automatic-styles>\n"),n.push("  <office:body>\n"),n.push("    <office:spreadsheet>\n");for(var a=0;a!=e.SheetNames.length;++a)n.push(Ku(e.Sheets[e.SheetNames[a]],e,a));return n.push("    </office:spreadsheet>\n"),n.push("  </office:body>\n"),"fods"==t.bookType?n.push("</office:document>"):n.push("</office:document-content>"),n.join("")},Fu=dr(Mu),Ou=dr({from_sheet:Lr}),Nu=dr(void 0!==Ho?Ho:{}),zu=dr(void 0!==Xo?Xo:{}),Wu=dr(void 0!==jo?jo:{}),Vu=dr(void 0!==Ol?Ol:{}),$u=dr({from_sheet:Fr}),Uu=dr(void 0!==Uo?Uo:{}),Hu=dr(void 0!==Go?Go:{}),Xu=fr([["cellNF",!(uu="          <table:table-cell />\n")],["cellHTML",!0],["cellFormula",!0],["cellStyles",!(cu=function(e){return P(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"<text:line-break/>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")})],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]]),Gu=fr([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]]),ju=/"/g,Yu={encode_col:se,encode_row:ae,encode_cell:he,encode_range:de,decode_col:H,decode_row:S,split_cell:X,decode_cell:j,decode_range:J,format_cell:fe,get_formulae:Or,make_csv:Lr,make_json:Dr,make_formulae:Or,sheet_add_aoa:me,sheet_add_json:Nr,aoa_to_sheet:ge,json_to_sheet:function(e,t){return Nr(null,e,t)},table_to_sheet:or,table_to_book:function(e,t){return pe(or(e,t),t)},sheet_to_csv:Lr,sheet_to_txt:Fr,sheet_to_json:Dr,sheet_to_html:Mu.from_sheet,sheet_to_formulae:Or,sheet_to_row_object_array:Dr};function Ku(e,t,n){var i=[];i.push('      <table:table table:name="'+P(t.SheetNames[n])+'">\n');for(var r=0,a=0,s=J(e["!ref"]),o=e["!merges"]||[],l=0,c=Array.isArray(e),r=0;r<s.s.r;++r)i.push("        <table:table-row></table:table-row>\n");for(;r<=s.e.r;++r){for(i.push("        <table:table-row>\n"),a=0;a<s.s.c;++a)i.push(uu);for(;a<=s.e.c;++a){for(var u=!1,h={},d="",l=0;l!=o.length;++l)if(!(o[l].s.c>a||o[l].s.r>r||o[l].e.c<a||o[l].e.r<r)){o[l].s.c==a&&o[l].s.r==r||(u=!0),h["table:number-columns-spanned"]=o[l].e.c-o[l].s.c+1,h["table:number-rows-spanned"]=o[l].e.r-o[l].s.r+1;break}if(u)i.push("          <table:covered-table-cell/>\n");else{var f=he({r:r,c:a}),p=c?(e[r]||[])[a]:e[f];if(p&&p.f&&(h["table:formula"]=P(("of:="+p.f.replace(dc,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),p.F&&p.F.slice(0,f.length)==f)&&(m=J(p.F),h["table:number-matrix-columns-spanned"]=m.e.c-m.s.c+1,h["table:number-matrix-rows-spanned"]=m.e.r-m.s.r+1),p){switch(p.t){case"b":d=p.v?"TRUE":"FALSE",h["office:value-type"]="boolean",h["office:boolean-value"]=p.v?"true":"false";break;case"n":d=p.w||String(p.v||0),h["office:value-type"]="float",h["office:value"]=p.v||0;break;case"s":case"str":d=p.v,h["office:value-type"]="string";break;case"d":d=p.w||te(p.v).toISOString(),h["office:value-type"]="date",h["office:date-value"]=te(p.v).toISOString(),h["table:style-name"]="ce1";break;default:i.push(uu);continue}var m,f=cu(d);p.l&&p.l.Target&&(f=I("text:a",f,{"xlink:href":m="#"==(m=p.l.Target).charAt(0)?"#"+m.slice(1).replace(/\./,"!"):m})),i.push("          "+I("table:table-cell",I("text:p",f,{}),h)+"\n")}else i.push(uu)}}i.push("        </table:table-row>\n")}return i.push("      </table:table>\n"),i.join("")}function Zu(e,t){var n=t||{};null!=Zr&&null==n.dense&&(n.dense=Zr);var i=n.dense?[]:{},r=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!r)throw new Error("Invalid HTML: could not find <table>");for(var a,t=e.match(/<\/table/i),s=r.index,o=t&&t.index||e.length,l=function(e,t,n){if(ba||"string"==typeof t)return e.split(t);for(var i=e.split(t),r=[i[0]],a=1;a<i.length;++a)r.push(n),r.push(i[a]);return r}(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},d=[],s=0;s<l.length;++s){var f=l[s].trim(),p=f.slice(0,3).toLowerCase();if("<tr"!=p){if("<td"==p||"<th"==p)for(var m=f.split(/<\/t[dh]>/i),o=0;o<m.length;++o){var g=m[o].trim();if(g.match(/<t[dh]/i)){for(var v=g,b=0;"<"==v.charAt(0)&&-1<(b=v.indexOf(">"));)v=v.slice(b+1);for(var S=0;S<d.length;++S){var y=d[S];y.s.c==u&&y.s.r<c&&c<=y.e.r&&(u=y.e.c+1,S=-1)}var x=ie(g.slice(0,g.indexOf(">"))),w=x.colspan?+x.colspan:1;(1<(a=+x.rowspan)||1<w)&&d.push({s:{r:c,c:u},e:{r:c+(a||1)-1,c:u+w-1}});g=x.t||"";v.length?(v=Ha(v),h.s.r>c&&(h.s.r=c),h.e.r<c&&(h.e.r=c),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),v.length&&(x={t:"s",v:v},n.raw||!v.trim().length||"s"==g||("TRUE"===v?x={t:"b",v:!0}:"FALSE"===v?x={t:"b",v:!1}:isNaN(_(v))?isNaN(C(v).getDate())||(x={t:"d",v:te(v)},(x=!n.cellDates?{t:"n",v:G(x.v)}:x).z=n.dateNF||aa._table[14]):x={t:"n",v:_(v)}),n.dense?(i[c]||(i[c]=[]),i[c][u]=x):i[he({r:c,c:u})]=x,u+=w)):u+=w}}}else{if(++c,n.sheetRows&&n.sheetRows<=c){--c;break}u=0}}return i["!ref"]=de(h),d.length&&(i["!merges"]=d),i}function qu(e,t,n,i){for(var r=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o,l,c,u,h=0,d=0,f=0;f<r.length;++f)if(!(r[f].s.r>n||r[f].s.c>s||r[f].e.r<n||r[f].e.c<s)){if(r[f].s.r<n||r[f].s.c<s){h=-1;break}h=r[f].e.r-r[f].s.r+1,d=r[f].e.c-r[f].s.c+1;break}h<0||(o=he({r:n,c:s}),c=(l=i.dense?(e[n]||[])[s]:e[o])&&null!=l.v&&(l.h||O(l.w||(fe(l),l.w)||""))||"",u={},1<h&&(u.rowspan=h),1<d&&(u.colspan=d),u.t=l&&l.t||"z",i.editable&&(c='<span contenteditable="true">'+c+"</span>"),u.id=(i.id||"sjs")+"-"+o,a.push(I("td",c,u)))}return"<tr>"+a.join("")+"</tr>"}function Qu(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Ju(e,t,n){return null!=e[t]?e[t]:e[t]=n}function eh(e,t,n){if("string"!=typeof t)return eh(e,he("number"!=typeof t?t:{r:t,c:n||0}));if(Array.isArray(e)){n=j(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}(gu=Yu).consts=gu.consts||{},gu.sheet_get_cell=eh,gu.book_new=function(){return{SheetNames:[],Sheets:{}}},gu.book_append_sheet=function(e,t,n){if(!n)for(var i=1;i<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+i);++i);if(!n)throw new Error("Too many worksheets");if(Si(n),0<=e.SheetNames.indexOf(n))throw new Error("Worksheet with name |"+n+"| already exists!");e.SheetNames.push(n),e.Sheets[n]=t},gu.book_set_sheet_visibility=function(e,t,n){Ju(e,"Workbook",{}),Ju(e.Workbook,"Sheets",[]);t=function(e,t){if("number"==typeof t){if(0<=t&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"!=typeof t)throw new Error("Cannot find sheet |"+t+"|");if(-1<(e=e.SheetNames.indexOf(t)))return e;throw new Error("Cannot find sheet name |"+t+"|")}(e,t);switch(Ju(e.Workbook.Sheets,t,{}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[t].Hidden=n},[["SHEET_VISIBLE",0],["SHEET_HIDDEN",1],["SHEET_VERY_HIDDEN",2]].forEach(function(e){gu.consts[e[0]]=e[1]}),gu.cell_set_number_format=function(e,t){return e.z=t,e},gu.cell_set_hyperlink=function(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e},gu.cell_set_internal_link=function(e,t,n){return gu.cell_set_hyperlink(e,"#"+t,n)},gu.cell_add_comment=function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},gu.sheet_set_array_formula=function(e,t,n){for(var i="string"!=typeof t?t:oe(t),r="string"==typeof t?t:de(t),a=i.s.r;a<=i.e.r;++a)for(var s=i.s.c;s<=i.e.c;++s){var o=eh(e,a,s);o.t="n",o.F=r,delete o.v,a==i.s.r&&s==i.s.c&&(o.f=n)}return e},Qr&&"undefined"!=typeof require&&(mu={}.Readable,i.stream={to_json:function(t,e){var n=mu({objectMode:!0});if(null==t||null==t["!ref"])return n.push(null),n;var i,r={t:"n",v:0},a=0,s=1,o=[],l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},h=null!=u.range?u.range:t["!ref"];switch(1===u.header?a=1:"A"===u.header?a=2:Array.isArray(u.header)&&(a=3),typeof h){case"string":c=oe(h);break;case"number":(c=oe(t["!ref"])).s.r=h;break;default:c=h}0<a&&(s=0);var d=ae(c.s.r),f=[],p=0,m=Array.isArray(t),g=c.s.r,v=0,b=0;for(m&&!t[g]&&(t[g]=[]),v=c.s.c;v<=c.e.c;++v)switch(f[v]=se(v),r=m?t[g][v]:t[f[v]+d],a){case 1:o[v]=v-c.s.c;break;case 2:o[v]=f[v];break;case 3:o[v]=u.header[v-c.s.c];break;default:for(l=i=fe(r=null==r?{w:"__EMPTY",t:"s"}:r,null,u),b=p=0;b<o.length;++b)o[b]==l&&(l=i+"_"+ ++p);o[v]=l}return g=c.s.r+s,n._read=function(){if(g>c.e.r)return n.push(null);for(;g<=c.e.r;){var e=Mr(t,c,g,f,a,o,m,u);if(++g,!1===e.isempty||(1===a?!1!==u.blankrows:u.blankrows)){n.push(e.row);break}}},n},to_html:function(e,t){var n=mu(),i=t||{},t=null!=i.header?i.header:Mu.BEGIN,r=null!=i.footer?i.footer:Mu.END;n.push(t);var a=J(e["!ref"]);i.dense=Array.isArray(e),n.push(Mu._preamble(e,a,i));var s=a.s.r,o=!1;return n._read=function(){if(s>a.e.r)return o||(o=!0,n.push("</table>"+r)),n.push(null);for(;s<=a.e.r;){n.push(Mu._row(e,a,s,i)),++s;break}},n},to_csv:function(e,t){var n=mu(),i=null==t?{}:t;if(null==e||null==e["!ref"])return n.push(null),n;var r=oe(e["!ref"]),a=void 0!==i.FS?i.FS:",",s=a.charCodeAt(0),o=void 0!==i.RS?i.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==a?"\\|":a)+"+$"),u="",h=[];i.dense=Array.isArray(e);for(var d=i.skipHidden&&e["!cols"]||[],f=i.skipHidden&&e["!rows"]||[],p=r.s.c;p<=r.e.c;++p)(d[p]||{}).hidden||(h[p]=se(p));var m=r.s.r,g=!1;return n._read=function(){if(!g)return g=!0,n.push("\ufeff");for(;m<=r.e.r;)if(!(f[++m-1]||{}).hidden&&null!=(u=Ir(e,r,m-1,h,s,l,a,i))){i.strip&&(u=u.replace(c,"")),n.push(u+o);break}return m>r.e.r?n.push(null):void 0},n}}),i.parse_xlscfb=Yi,i.parse_zip=vr,i.read=Cr,i.readFile=Er,i.readFileSync=Er,i.write=Ar,i.writeFile=Br,i.writeFileSync=Br,i.writeFileAsync=function(e,t,n,i){var r=n||{};r.type="file",r.file=e,Tr(r),r.type="buffer";var a=i;return i instanceof Function||(a=n),ha.writeFile(e,Ar(t,r),a)},i.utils=Yu,i.SSF=aa,void 0!==da&&(i.CFB=da)}define("mtoolBar",["toolBar","curveSettings"],function(){});var DO_NOT_EXPORT_CODEPAGE=!0,DO_NOT_EXPORT_JSZIP=!0;!function(e){var t;"object"==typeof exports&&"undefined"!=typeof module&&void 0===DO_NOT_EXPORT_JSZIP?module.exports=e():"function"==typeof define&&define.amd&&void 0===DO_NOT_EXPORT_JSZIP?(JSZipSync=e(),define("xlsx",[],e)):("undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof $&&$.global?t=$.global:"undefined"!=typeof self&&(t=self),t.JSZipSync=e())}(function(){return function i(r,a,s){function o(t,e){if(!a[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);throw new Error("Cannot find module '"+t+"'")}n=a[t]={exports:{}};r[t][0].call(n.exports,function(e){return o(r[t][1][e]||e)},n,n.exports,i,r,a,s)}return a[t].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)o(s[e]);return o}({1:[function(e,t,n){"use strict";var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e,t){for(var n,i,r,a,s,o,l="",c=0;c<e.length;)r=(o=e.charCodeAt(c++))>>2,a=(3&o)<<4|(n=e.charCodeAt(c++))>>4,s=(15&n)<<2|(i=e.charCodeAt(c++))>>6,o=63&i,isNaN(n)?s=o=64:isNaN(i)&&(o=64),l=l+u.charAt(r)+u.charAt(a)+u.charAt(s)+u.charAt(o);return l},n.decode=function(e,t){var n,i,r,a,s,o,l="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)r=u.indexOf(e.charAt(c++)),n=(15&(a=u.indexOf(e.charAt(c++))))<<4|(s=u.indexOf(e.charAt(c++)))>>2,i=(3&s)<<6|(o=u.indexOf(e.charAt(c++))),l+=String.fromCharCode(r<<2|a>>4),64!=s&&(l+=String.fromCharCode(n)),64!=o&&(l+=String.fromCharCode(i));return l}},{}],2:[function(e,t,n){"use strict";function i(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}i.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},t.exports=i},{}],3:[function(e,t,n){"use strict";n.STORE={magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null},n.DEFLATE=e("./flate")},{"./flate":8}],4:[function(e,t,n){"use strict";var s=e("./utils"),o=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];t.exports=function(e,t){if(void 0===e||!e.length)return 0;var n="string"!==s.getTypeOf(e);void 0===t&&(t=0);var i;t^=-1;for(var r=0,a=e.length;r<a;r++)i=n?e[r]:e.charCodeAt(r),t=t>>>8^o[255&(t^i)];return-1^t}},{"./utils":21}],5:[function(e,t,n){"use strict";function i(e){this.data=null,this.length=0,this.index=0}var r=e("./utils");i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1)}},t.exports=i},{"./utils":21}],6:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!1,n.date=null,n.compression=null,n.comment=null},{}],7:[function(e,t,n){"use strict";var i=e("./utils");n.string2binary=function(e){return i.string2binary(e)},n.string2Uint8Array=function(e){return i.transformTo("uint8array",e)},n.uint8Array2String=function(e){return i.transformTo("string",e)},n.string2Blob=function(e){e=i.transformTo("arraybuffer",e);return i.arrayBuffer2Blob(e)},n.arrayBuffer2Blob=function(e){return i.arrayBuffer2Blob(e)},n.transformTo=function(e,t){return i.transformTo(e,t)},n.getTypeOf=function(e){return i.getTypeOf(e)},n.checkSupport=function(e){return i.checkSupport(e)},n.MAX_VALUE_16BITS=i.MAX_VALUE_16BITS,n.MAX_VALUE_32BITS=i.MAX_VALUE_32BITS,n.pretty=function(e){return i.pretty(e)},n.findCompression=function(e){return i.findCompression(e)},n.isRegExp=function(e){return i.isRegExp(e)}},{"./utils":21}],8:[function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=e("pako");n.uncompressInputType=i?"uint8array":"array",n.compressInputType=i?"uint8array":"array",n.magic="\b\0",n.compress=function(e){return r.deflateRaw(e)},n.uncompress=function(e){return r.inflateRaw(e)}},{pako:24}],9:[function(e,t,n){"use strict";function i(e,t){if(!(this instanceof i))return new i(e,t);this.files={},this.comment=null,this.root="",e&&this.load(e,t),this.clone=function(){var e,t=new i;for(e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}var r=e("./base64");(i.prototype=e("./object")).load=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.utils=e("./deprecatedPublicUtils"),i.base64={encode:function(e){return r.encode(e)},decode:function(e){return r.decode(e)}},i.compressions=e("./compressions"),t.exports=i},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(e,t,n){"use strict";var a=e("./base64"),s=e("./zipEntries");t.exports=function(e,t){var n,i,r;for((t=t||{}).base64&&(e=a.decode(e)),n=(e=new s(e,t)).files,i=0;i<n.length;i++)r=n[i],this.file(r.fileName,r.decompressed,{binary:!0,optimizedBinaryString:!0,date:r.date,dir:r.dir,comment:r.fileComment.length?r.fileComment:null,createFolders:t.createFolders});return e.zipComment.length&&(this.comment=e.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(e,t,n){!function(n){"use strict";var i=function(){};if(void 0!==n){var e=!n.from;if(!e)try{n.from("foo","utf8")}catch(n){e=!0}i=e?function(e,t){return t?new n(e,t):new n(e)}:n.from.bind(n),n.alloc||(n.alloc=function(e){return new n(e)})}t.exports=function(e,t){return"number"==typeof e?n.alloc(e):i(e,t)},t.exports.test=function(e){return n.isBuffer(e)}}.call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],12:[function(e,t,n){"use strict";function i(e){this.data=e,this.length=this.data.length,this.index=0}e=e("./uint8ArrayReader");(i.prototype=new e).readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=i},{"./uint8ArrayReader":18}],13:[function(e,t,n){"use strict";function i(e){var t;return e._data instanceof c&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,"uint8array"===f.getTypeOf(e._data))&&(t=e._data,e._data=new Uint8Array(t.length),0!==t.length&&e._data.set(t,0)),e._data}function r(e){var t=i(e);return"string"===f.getTypeOf(t)?!e.options.binary&&o.nodebuffer?u(t,"utf-8"):e.asBinary():t}function a(e){var t=i(this);return null==t?"":(this.options.base64&&(t=g.decode(t)),t=e&&this.options.binary?E.utf8decode(t):f.transformTo("string",t),t=!e&&!this.options.binary?f.transformTo("string",E.utf8encode(t)):t)}function s(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this._data=t,this.options=n,this._initialMetadata={dir:n.dir,date:n.date}}var o=e("./support"),f=e("./utils"),p=e("./crc32"),m=e("./signature"),l=e("./defaults"),g=e("./base64"),v=e("./compressions"),c=e("./compressedObject"),u=e("./nodeBuffer"),b=e("./utf8"),S=e("./stringWriter"),y=e("./uint8ArrayWriter");s.prototype={asText:function(){return a.call(this,!0)},asBinary:function(){return a.call(this,!1)},asNodeBuffer:function(){var e=r(this);return f.transformTo("nodebuffer",e)},asUint8Array:function(){var e=r(this);return f.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};function x(e,t){for(var n="",i=0;i<t;i++)n+=String.fromCharCode(255&e),e>>>=8;return n}function h(e,t){return"/"!=e.slice(-1)&&(e+="/"),t=void 0!==t&&t,this.files[e]||d.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]}function w(e,t){var n,i=new c;return e._data instanceof c?(i.uncompressedSize=e._data.uncompressedSize,i.crc32=e._data.crc32,0===i.uncompressedSize||e.dir?(t=v.STORE,i.compressedContent="",i.crc32=0):e._data.compressionMethod===t.magic?i.compressedContent=e._data.getCompressedContent():(n=e._data.getContent(),i.compressedContent=t.compress(f.transformTo(t.compressInputType,n)))):((n=r(e))&&0!==n.length&&!e.dir||(t=v.STORE,n=""),i.uncompressedSize=n.length,i.crc32=p(n),i.compressedContent=t.compress(f.transformTo(t.compressInputType,n))),i.compressedSize=i.compressedContent.length,i.compressionMethod=t.magic,i}function _(e,t,n,i){var r=(n.compressedContent,f.transformTo("string",b.utf8encode(t.name))),a=t.comment||"",s=f.transformTo("string",b.utf8encode(a)),o=r.length!==t.name.length,l=s.length!==a.length,c=t.options,u="",h=(t._initialMetadata.dir!==t.dir?t:c).dir,t=(a=(t._initialMetadata.date!==t.date?t:c).date).getHours();t<<=6,t|=a.getMinutes(),t<<=5,t|=a.getSeconds()/2,c=a.getFullYear()-1980,c<<=4,c|=a.getMonth()+1,c<<=5,c|=a.getDate(),o&&(a=x(1,1)+x(p(r),4)+r,u+="up"+x(a.length,2)+a),l&&(d=x(1,1)+x(this.crc32(s),4)+s,u+="uc"+x(d.length,2)+d);var d="";return d+="\n\0",d+=o||l?"\0\b":"\0\0",d+=n.compressionMethod,d+=x(t,2),d+=x(c,2),d+=x(n.crc32,4),d+=x(n.compressedSize,4),d+=x(n.uncompressedSize,4),d+=x(r.length,2),d+=x(u.length,2),{fileRecord:m.LOCAL_FILE_HEADER+d+r+u,dirRecord:m.CENTRAL_FILE_HEADER+"\0"+d+x(s.length,2)+"\0\0\0\0"+(!0===h?"\0\0\0":"\0\0\0\0")+x(i,4)+r+u+s,compressedObject:n}}var C=function(){for(var e,t={},n=0;n<arguments.length;n++)for(e in arguments[n])arguments[n].hasOwnProperty(e)&&void 0===t[e]&&(t[e]=arguments[n][e]);return t},d=function(e,t,n){var i,r,a=f.getTypeOf(t);if(!0!==(r=(r=n)||{}).base64||null!==r.binary&&void 0!==r.binary||(r.binary=!0),(r=C(r,l)).date=r.date||new Date,null!==r.compression&&(r.compression=r.compression.toUpperCase()),(n=r).createFolders&&(i=0<(i=(r="/"==(r=e).slice(-1)?r.substring(0,r.length-1):r).lastIndexOf("/"))?r.substring(0,i):"")&&h.call(this,i,!0),n.dir||null==t)n.base64=!1,n.binary=!1,t=null;else if("string"===a)n.binary&&!n.base64&&!0!==n.optimizedBinaryString&&(t=f.string2binary(t));else{if(n.base64=!1,n.binary=!0,!(a||t instanceof c))throw new Error("The data of '"+e+"' is in an unsupported format !");"arraybuffer"===a&&(t=f.transformTo("uint8array",t))}n=new s(e,t,n);return this.files[e]=n},E={load:function(e,t){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var t,n,i,r=[];for(t in this.files)this.files.hasOwnProperty(t)&&(n=this.files[t],i=new s(n.name,n._data,C(n.options)),n=t.slice(this.root.length,t.length),t.slice(0,this.root.length)===this.root&&e(n,i)&&r.push(i));return r},file:function(n,e,t){if(1!==arguments.length)return n=this.root+n,d.call(this,n,e,t),this;if(f.isRegExp(n)){var i=n;return this.filter(function(e,t){return!t.dir&&i.test(e)})}return this.filter(function(e,t){return!t.dir&&e===n})[0]||null},folder:function(n){if(!n)return this;if(f.isRegExp(n))return this.filter(function(e,t){return t.dir&&n.test(e)});var e=this.root+n,t=h.call(this,e),e=this.clone();return e.root=t.name,e},remove:function(n){n=this.root+n;var e=this.files[n];if(e||("/"!=n.slice(-1)&&(n+="/"),e=this.files[n]),e&&!e.dir)delete this.files[n];else for(var t=this.filter(function(e,t){return t.name.slice(0,n.length)===n}),i=0;i<t.length;i++)delete this.files[t[i].name];return this},generate:function(e){e=C(e||{},{base64:!0,compression:"STORE",type:"base64",comment:null}),f.checkSupport(e.type);var t,n=[],i=0,r=0,a=f.transformTo("string",this.utf8encode(e.comment||this.comment||""));for(t in this.files)if(this.files.hasOwnProperty(t)){var s=this.files[t],o=s.options.compression||e.compression.toUpperCase(),l=v[o];if(!l)throw new Error(o+" is not a valid compression method !");l=w.call(this,s,l),s=_.call(this,t,s,l,i);i+=s.fileRecord.length+l.compressedSize,r+=s.dirRecord.length,n.push(s)}for(var c=m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+x(n.length,2)+x(n.length,2)+x(r,4)+x(i,4)+x(a.length,2)+a,a=e.type.toLowerCase(),u=new("uint8array"===a||"arraybuffer"===a||"blob"===a||"nodebuffer"===a?y:S)(i+r+c.length),h=0;h<n.length;h++)u.append(n[h].fileRecord),u.append(n[h].compressedObject.compressedContent);for(h=0;h<n.length;h++)u.append(n[h].dirRecord);u.append(c);var d=u.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return f.transformTo(e.type.toLowerCase(),d);case"blob":return f.arrayBuffer2Blob(f.transformTo("arraybuffer",d));case"base64":return e.base64?g.encode(d):d;default:return d}},crc32:function(e,t){return p(e,t)},utf8encode:function(e){return f.transformTo("string",b.utf8encode(e))},utf8decode:function(e){return b.utf8decode(e)}};t.exports=E},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],15:[function(e,t,n){"use strict";function i(e,t){this.data=e,t||(this.data=a.string2binary(this.data)),this.length=this.data.length,this.index=0}var r=e("./dataReader"),a=e("./utils");(i.prototype=new r).byteAt=function(e){return this.data.charCodeAt(e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=i},{"./dataReader":5,"./utils":21}],16:[function(e,t,n){"use strict";var i=e("./utils"),e=function(){this.data=[]};e.prototype={append:function(e){e=i.transformTo("string",e),this.data.push(e)},finalize:function(){return this.data.join("")}},t.exports=e},{"./utils":21}],17:[function(e,t,i){!function(e){"use strict";if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,i.nodebuffer=void 0!==e,i.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)i.blob=!1;else{var t=new ArrayBuffer(0);try{i.blob=0===new Blob([t],{type:"application/zip"}).size}catch(e){try{var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);n.append(t),i.blob=0===n.getBlob("application/zip").size}catch(e){i.blob=!1}}}}.call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],18:[function(e,t,n){"use strict";function i(e){e&&(this.data=e,this.length=this.data.length,this.index=0)}e=e("./dataReader");(i.prototype=new e).byteAt=function(e){return this.data[e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===n&&this.data[a+2]===i&&this.data[a+3]===r)return a;return-1},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.index,this.index+e);return this.index+=e,t},t.exports=i},{"./dataReader":5}],19:[function(e,t,n){"use strict";var i=e("./utils"),e=function(e){this.data=new Uint8Array(e),this.index=0};e.prototype={append:function(e){0!==e.length&&(e=i.transformTo("uint8array",e),this.data.set(e,this.index),this.index+=e.length)},finalize:function(){return this.data}},t.exports=e},{"./utils":21}],20:[function(e,t,n){"use strict";for(var o=e("./utils"),l=e("./support"),i=e("./nodeBuffer"),c=new Array(256),r=0;r<256;r++)c[r]=252<=r?6:248<=r?5:240<=r?4:224<=r?3:192<=r?2:1;c[254]=c[254]=1;function a(e){for(var t,n,i=e.length,r=new Array(2*i),a=0,s=0;s<i;)if((t=e[s++])<128)r[a++]=t;else if(4<(n=c[t]))r[a++]=65533,s+=n-1;else{for(t&=2===n?31:3===n?15:7;1<n&&s<i;)t=t<<6|63&e[s++],n--;1<n?r[a++]=65533:t<65536?r[a++]=t:(t-=65536,r[a++]=55296|t>>10&1023,r[a++]=56320|1023&t)}return r.length!==a&&(r.subarray?r=r.subarray(0,a):r.length=a),o.applyFromCharCode(r)}n.utf8encode=function(e){return l.nodebuffer?i(e,"utf-8"):function(e){for(var t,n,i,r,a=e.length,s=0,o=0;o<a;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new(l.uint8array?Uint8Array:Array)(s),o=r=0;r<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?t[r++]=n:(n<2048?t[r++]=192|n>>>6:(n<65536?t[r++]=224|n>>>12:(t[r++]=240|n>>>18,t[r++]=128|n>>>12&63),t[r++]=128|n>>>6&63),t[r++]=128|63&n);return t}(e)},n.utf8decode=function(e){if(l.nodebuffer)return o.transformTo("nodebuffer",e).toString("utf-8");for(var t=[],n=0,i=(e=o.transformTo(l.uint8array?"uint8array":"array",e)).length;n<i;){var r=function(e,t){for(var n=(t=(t=t||e.length)>e.length?e.length:t)-1;0<=n&&128==(192&e[n]);)n--;return!(n<0)&&0!==n&&n+c[e[n]]>t?n:t}(e,Math.min(n+65536,i));l.uint8array?t.push(a(e.subarray(n,r))):t.push(a(e.slice(n,r))),n=r}return t.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(e,t,c){"use strict";function n(e){return e}function i(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}function r(e){var t=65536,n=[],i=e.length,r=c.getTypeOf(e),a=0,s=!0;try{switch(r){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,u(0))}}catch(e){s=!1}if(!s){for(var o="",l=0;l<e.length;l++)o+=String.fromCharCode(e[l]);return o}for(;a<i&&1<t;)try{"array"===r||"nodebuffer"===r?n.push(String.fromCharCode.apply(null,e.slice(a,Math.min(a+t,i)))):n.push(String.fromCharCode.apply(null,e.subarray(a,Math.min(a+t,i)))),a+=t}catch(e){t=Math.floor(t/2)}return n.join("")}function a(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}var s=e("./support"),o=e("./compressions"),u=e("./nodeBuffer");c.string2binary=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e.charCodeAt(n));return t},c.arrayBuffer2Blob=function(t){c.checkSupport("blob");try{return new Blob([t],{type:"application/zip"})}catch(e){try{var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return n.append(t),n.getBlob("application/zip")}catch(t){throw new Error("Bug : can't construct the Blob.")}}},c.applyFromCharCode=r;var l={};l.string={string:n,array:function(e){return i(e,new Array(e.length))},arraybuffer:function(e){return l.string.uint8array(e).buffer},uint8array:function(e){return i(e,new Uint8Array(e.length))},nodebuffer:function(e){return i(e,u(e.length))}},l.array={string:r,array:n,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return u(e)}},l.arraybuffer={string:function(e){return r(new Uint8Array(e))},array:function(e){return a(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:n,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return u(new Uint8Array(e))}},l.uint8array={string:r,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:n,nodebuffer:function(e){return u(e)}},l.nodebuffer={string:r,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return l.nodebuffer.uint8array(e).buffer},uint8array:function(e){return a(e,new Uint8Array(e.length))},nodebuffer:n},c.transformTo=function(e,t){if(t=t||"",!e)return t;c.checkSupport(e);var n=c.getTypeOf(t);return l[n][e](t)},c.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":s.nodebuffer&&u.test(e)?"nodebuffer":s.uint8array&&e instanceof Uint8Array?"uint8array":s.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},c.checkSupport=function(e){if(!s[e.toLowerCase()])throw new Error(e+" is not supported by this browser")},c.MAX_VALUE_16BITS=65535,c.MAX_VALUE_32BITS=-1,c.pretty=function(e){for(var t,n="",i=0;i<(e||"").length;i++)n+="\\x"+((t=e.charCodeAt(i))<16?"0":"")+t.toString(16).toUpperCase();return n},c.findCompression=function(e){for(var t in o)if(o.hasOwnProperty(t)&&o[t].magic===e)return o[t];return null},c.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(e,t,n){"use strict";function i(e,t){this.files=[],this.loadOptions=t,e&&this.load(e)}var r=e("./stringReader"),a=e("./nodeBufferReader"),s=e("./uint8ArrayReader"),o=e("./utils"),l=e("./signature"),c=e("./zipEntry"),u=e("./support"),h=e("./object");i.prototype={checkSignature:function(e){var t=this.reader.readString(4);if(t!==e)throw new Error("Corrupted zip or bug : unexpected signature ("+o.pretty(t)+", expected "+o.pretty(e)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=h.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,i=this.zip64EndOfCentralSize-44;0<i;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readString(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){for(var e,t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===l.CENTRAL_FILE_HEADER;)(e=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(-1===e)throw new Error("Corrupted zip : can't find end of central directory");if(this.reader.setIndex(e),this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,-1===(e=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR)))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(e),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(e){var t=o.getTypeOf(e);"string"!==t||u.uint8array?this.reader="nodebuffer"===t?new a(e):new s(o.transformTo("uint8array",e)):this.reader=new r(e,this.loadOptions.optimizedBinaryString)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=i},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(e,t,n){"use strict";function i(e,t){this.options=e,this.loadOptions=t}var r=e("./stringReader"),a=e("./utils"),s=e("./compressedObject"),o=e("./object");i.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},prepareCompressedContent:function(n,i,r){return function(){var e=n.index;n.setIndex(i);var t=n.readData(r);return n.setIndex(e),t}},prepareContent:function(e,t,n,i,r){return function(){var e=a.transformTo(i.uncompressInputType,this.getCompressedContent()),e=i.uncompress(e);if(e.length!==r)throw new Error("Bug : uncompressed data size mismatch");return e}},readLocalPart:function(e){var t;if(e.skip(22),this.fileNameLength=e.readInt(2),t=e.readInt(2),this.fileName=e.readString(this.fileNameLength),e.skip(t),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(null===(t=a.findCompression(this.compressionMethod)))throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new s,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,t),this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,t,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=a.transformTo("string",this.decompressed.getContent()),o.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(e){if(this.versionMadeBy=e.readString(2),this.versionNeeded=e.readInt(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4),this.fileNameLength=e.readInt(2),this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=e.readString(this.fileNameLength),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readString(this.fileCommentLength),this.dir=!!(16&this.externalFileAttributes)},parseZIP64ExtraField:function(e){var t;this.extraFields[1]&&(t=new r(this.extraFields[1].value),this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4)))},readExtraFields:function(e){var t,n,i,r=e.index;for(this.extraFields=this.extraFields||{};e.index<r+this.extraFieldsLength;)t=e.readInt(2),n=e.readInt(2),i=e.readString(n),this.extraFields[t]={id:t,length:n,value:i}},handleUTF8:function(){var e;this.useUTF8()?(this.fileName=o.utf8decode(this.fileName),this.fileComment=o.utf8decode(this.fileComment)):(null!==(e=this.findExtraFieldUnicodePath())&&(this.fileName=e),null!==(e=this.findExtraFieldUnicodeComment())&&(this.fileComment=e))},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=new r(e.value);return 1!==t.readInt(1)||o.crc32(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=new r(e.value);return 1!==t.readInt(1)||o.crc32(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readString(e.length-5))}return null}},t.exports=i},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(e,t,n){"use strict";var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=i},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(e,t,n){"use strict";function i(e,t){t=new r(t);if(t.push(e,!0),t.err)throw t.msg;return t.result}function r(e){this.options=o.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;if(t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,(this.strm.avail_out=0)!==(e=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy)))throw new Error(a[e]);t.header&&s.deflateSetHeader(this.strm,t.header)}var s=e("./zlib/deflate.js"),o=e("./utils/common"),l=e("./utils/strings"),a=e("./zlib/messages"),c=e("./zlib/zstream");r.prototype.push=function(e,t){var n,i,r=this.strm,a=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:!0===t?4:0,r.input="string"==typeof e?l.string2buf(e):e,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new o.Buf8(a),r.next_out=0,r.avail_out=a),1!==(n=s.deflate(r,i))&&0!==n)return this.onEnd(n),!(this.ended=!0)}while((0===r.avail_out||0===r.avail_in&&4===i)&&("string"===this.options.to?this.onData(l.buf2binstring(o.shrinkBuf(r.output,r.next_out))):this.onData(o.shrinkBuf(r.output,r.next_out))),(0<r.avail_in||0===r.avail_out)&&1!==n);return 4!==i||(n=s.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n)},r.prototype.onData=function(e){this.chunks.push(e)},r.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=r,n.deflate=i,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,i(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,i(e,t)}},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(e,t,n){"use strict";function i(e,t){t=new r(t);if(t.push(e,!0),t.err)throw t.msg;return t.result}function r(e){this.options=u.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;if(t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0,(t=c.inflateInit2(this.strm,t.windowBits))!==d.Z_OK)throw new Error(a[t]);this.header=new o,c.inflateGetHeader(this.strm,this.header)}var c=e("./zlib/inflate.js"),u=e("./utils/common"),h=e("./utils/strings"),d=e("./zlib/constants"),a=e("./zlib/messages"),s=e("./zlib/zstream"),o=e("./zlib/gzheader");r.prototype.push=function(e,t){var n,i,r,a,s,o=this.strm,l=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:!0===t?d.Z_FINISH:d.Z_NO_FLUSH,o.input="string"==typeof e?h.binstring2buf(e):e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new u.Buf8(l),o.next_out=0,o.avail_out=l),(n=c.inflate(o,d.Z_NO_FLUSH))!==d.Z_STREAM_END&&n!==d.Z_OK)return this.onEnd(n),!(this.ended=!0)}while(o.next_out&&(0===o.avail_out||n===d.Z_STREAM_END||0===o.avail_in&&i===d.Z_FINISH)&&("string"===this.options.to?(r=h.utf8border(o.output,o.next_out),a=o.next_out-r,s=h.buf2string(o.output,r),o.next_out=a,o.avail_out=l-a,a&&u.arraySet(o.output,o.output,r,a,0),this.onData(s)):this.onData(u.shrinkBuf(o.output,o.next_out))),0<o.avail_in&&n!==d.Z_STREAM_END);return(i=n===d.Z_STREAM_END?d.Z_FINISH:i)!==d.Z_FINISH||(n=c.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===d.Z_OK)},r.prototype.onData=function(e){this.chunks.push(e)},r.prototype.onEnd=function(e){e===d.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=r,n.inflate=i,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,i(e,t)},n.ungzip=i},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){for(var t,n,i,r=0,a=0,s=e.length;a<s;a++)r+=e[a].length;for(i=new Uint8Array(r),a=t=0,s=e.length;a<s;a++)n=e[a],i.set(n,t),t+=n.length;return i}},a={arraySet:function(e,t,n,i,r){for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(i)},{}],28:[function(e,t,n){"use strict";function l(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&r))return String.fromCharCode.apply(null,c.shrinkBuf(e,t));for(var n="",i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n}var c=e("./common"),r=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var u=new c.Buf8(256),i=0;i<256;i++)u[i]=252<=i?6:248<=i?5:240<=i?4:224<=i?3:192<=i?2:1;u[254]=u[254]=1,n.string2buf=function(e){for(var t,n,i,r,a=e.length,s=0,o=0;o<a;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new c.Buf8(s),o=r=0;r<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?t[r++]=n:(n<2048?t[r++]=192|n>>>6:(n<65536?t[r++]=224|n>>>12:(t[r++]=240|n>>>18,t[r++]=128|n>>>12&63),t[r++]=128|n>>>6&63),t[r++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new c.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){for(var n,i,r=t||e.length,a=new Array(2*r),s=0,o=0;o<r;)if((n=e[o++])<128)a[s++]=n;else if(4<(i=u[n]))a[s++]=65533,o+=i-1;else{for(n&=2===i?31:3===i?15:7;1<i&&o<r;)n=n<<6|63&e[o++],i--;1<i?a[s++]=65533:n<65536?a[s++]=n:(n-=65536,a[s++]=55296|n>>10&1023,a[s++]=56320|1023&n)}return l(a,s)},n.utf8border=function(e,t){for(var n=(t=(t=t||e.length)>e.length?e.length:t)-1;0<=n&&128==(192&e[n]);)n--;return!(n<0)&&0!==n&&n+u[e[n]]>t?n:t}},{"./common":27}],29:[function(e,t,n){"use strict";t.exports=function(e,t,n,i){for(var r=65535&e|0,a=e>>>16&65535|0,s=0;0!==n;){for(n-=s=2e3<n?2e3:n;a=a+(r=r+t[i++]|0)|0,--s;);r%=65521,a%=65521}return r|a<<16|0}},{}],30:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(e,t,n){"use strict";var o=function(){for(var e=[],t=0;t<256;t++){for(var n=t,i=0;i<8;i++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n}return e}();t.exports=function(e,t,n,i){var r=o,a=i+n;e^=-1;for(var s=i;s<a;s++)e=e>>>8^r[255&(e^t[s])];return-1^e}},{}],32:[function(e,t,n){"use strict";function l(e,t){return e.msg=w[t],t}function o(e){return(e<<1)-(4<e?9:0)}function c(e){for(var t=e.length;0<=--t;)e[t]=0}function u(e){var t=e.state,n=t.pending;0!==(n=n>e.avail_out?e.avail_out:n)&&(b.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function h(e,t){S._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,u(e.strm)}function d(e,t){e.pending_buf[e.pending++]=t}function f(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function a(e,t){var n,i,r=e.max_chain_length,a=e.strstart,s=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-z?e.strstart-(e.w_size-z):0,c=e.window,u=e.w_mask,h=e.prev,d=e.strstart+N,f=c[a+s-1],p=c[a+s];e.prev_length>=e.good_match&&(r>>=2),o>e.lookahead&&(o=e.lookahead);do{if(c[(n=t)+s]===p&&c[n+s-1]===f&&c[n]===c[a]&&c[++n]===c[a+1]){for(a+=2,n++;c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&a<d;);if(i=N-(d-a),a=d-N,s<i){if(e.match_start=t,o<=(s=i))break;f=c[a+s-1],p=c[a+s]}}}while((t=h[t&u])>l&&0!=--r);return s<=e.lookahead?s:e.lookahead}function p(e){var t,n,i,r,a,s,o,l,c,u=e.w_size;do{if(c=e.window_size-e.lookahead-e.strstart,e.strstart>=u+(u-z)){for(b.arraySet(e.window,e.window,u,u,0),e.match_start-=u,e.strstart-=u,e.block_start-=u,t=n=e.hash_size;i=e.head[--t],e.head[t]=u<=i?i-u:0,--n;);for(t=n=u;i=e.prev[--t],e.prev[t]=u<=i?i-u:0,--n;);c+=u}if(0===e.strm.avail_in)break;if(a=e.strm,s=e.window,o=e.strstart+e.lookahead,l=c,c=void 0,c=a.avail_in,n=0===(c=l<c?l:c)?0:(a.avail_in-=c,b.arraySet(s,a.input,a.next_in,c,o),1===a.state.wrap?a.adler=y(a.adler,s,c,o):2===a.state.wrap&&(a.adler=x(a.adler,s,c,o)),a.next_in+=c,a.total_in+=c,c),e.lookahead+=n,e.lookahead+e.insert>=O)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=(e.ins_h<<e.hash_shift^e.window[r+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[r+O-1])&e.hash_mask,e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<O)););}while(e.lookahead<z&&0!==e.strm.avail_in)}function i(e,t){for(var n,i;;){if(e.lookahead<z){if(p(e),e.lookahead<z&&t===_)return $;if(0===e.lookahead)break}if(n=0,e.lookahead>=O&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+O-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-z&&(e.match_length=a(e,n)),e.match_length>=O)if(i=S._tr_tally(e,e.strstart-e.match_start,e.match_length-O),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=O){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+O-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=S._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(h(e,!1),0===e.strm.avail_out))return $}return e.insert=e.strstart<O-1?e.strstart:O-1,t===C?(h(e,!0),0===e.strm.avail_out?H:X):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?$:U}function r(e,t){for(var n,i,r;;){if(e.lookahead<z){if(p(e),e.lookahead<z&&t===_)return $;if(0===e.lookahead)break}if(n=0,e.lookahead>=O&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+O-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=O-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-z&&(e.match_length=a(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===O&&4096<e.strstart-e.match_start)&&(e.match_length=O-1)),e.prev_length>=O&&e.match_length<=e.prev_length){for(r=e.strstart+e.lookahead-O,i=S._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-O),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+O-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=O-1,e.strstart++,i&&(h(e,!1),0===e.strm.avail_out))return $}else if(e.match_available){if((i=S._tr_tally(e,0,e.window[e.strstart-1]))&&h(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return $}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=S._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<O-1?e.strstart:O-1,t===C?(h(e,!0),0===e.strm.avail_out?H:X):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?$:U}function m(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new b.Buf16(2*L),this.dyn_dtree=new b.Buf16(2*(2*D+1)),this.bl_tree=new b.Buf16(2*(2*I+1)),c(this.dyn_ltree),c(this.dyn_dtree),c(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new b.Buf16(F+1),this.heap=new b.Buf16(2*M+1),c(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new b.Buf16(2*M+1),c(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function s(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=A,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?W:V,e.adler=2===t.wrap?0:1,t.last_flush=_,S._tr_init(t),E):l(e,k)}function g(e){var t=s(e);return t===E&&((e=e.state).window_size=2*e.w_size,c(e.head),e.max_lazy_match=G[e.level].max_lazy,e.good_match=G[e.level].good_length,e.nice_match=G[e.level].nice_length,e.max_chain_length=G[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=O-1,e.match_available=0,e.ins_h=0),t}function v(e,t,n,i,r,a){if(!e)return k;var s=1;if(t===P&&(t=6),i<0?(s=0,i=-i):15<i&&(s=2,i-=16),r<1||B<r||n!==T||i<8||15<i||t<0||9<t||a<0||R<a)return l(e,k);8===i&&(i=9);var o=new m;return(e.state=o).strm=e,o.wrap=s,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=r+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+O-1)/O),o.window=new b.Buf8(2*o.w_size),o.head=new b.Buf16(o.hash_size),o.prev=new b.Buf16(o.w_size),o.lit_bufsize=1<<r+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new b.Buf8(o.pending_buf_size),o.d_buf=o.lit_bufsize>>1,o.l_buf=3*o.lit_bufsize,o.level=t,o.strategy=a,o.method=n,g(e)}var b=e("../utils/common"),S=e("./trees"),y=e("./adler32"),x=e("./crc32"),w=e("./messages"),_=0,C=4,E=0,k=-2,P=-1,R=4,A=2,T=8,B=9,M=286,D=30,I=19,L=2*M+1,F=15,O=3,N=258,z=N+O+1,W=42,V=113,$=1,U=2,H=3,X=4,e=function(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r},G=[new e(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(p(e),0===e.lookahead&&t===_)return $;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,h(e,!1),0===e.strm.avail_out))return $;if(e.strstart-e.block_start>=e.w_size-z&&(h(e,!1),0===e.strm.avail_out))return $}return e.insert=0,t===C?(h(e,!0),0===e.strm.avail_out?H:X):(e.strstart>e.block_start&&(h(e,!1),e.strm.avail_out),$)}),new e(4,4,8,4,i),new e(4,5,16,8,i),new e(4,6,32,32,i),new e(4,4,16,16,r),new e(8,16,32,32,r),new e(8,16,128,128,r),new e(8,32,128,256,r),new e(32,128,258,1024,r),new e(32,258,258,4096,r)];n.deflateInit=function(e,t){return v(e,t,T,15,8,0)},n.deflateInit2=v,n.deflateReset=g,n.deflateResetKeep=s,n.deflateSetHeader=function(e,t){return!e||!e.state||2!==e.state.wrap?k:(e.state.gzhead=t,E)},n.deflate=function(e,t){var n,i,r,a;if(!e||!e.state||5<t||t<0)return e?l(e,k):k;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&t!==C)return l(e,0===e.avail_out?-5:k);if(n.strm=e,s=n.last_flush,n.last_flush=t,n.status===W&&(2===n.wrap?(e.adler=0,d(n,31),d(n,139),d(n,8),n.gzhead?(d(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),d(n,255&n.gzhead.time),d(n,n.gzhead.time>>8&255),d(n,n.gzhead.time>>16&255),d(n,n.gzhead.time>>24&255),d(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),d(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(d(n,255&n.gzhead.extra.length),d(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=x(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(d(n,0),d(n,0),d(n,0),d(n,0),d(n,0),d(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),d(n,3),n.status=V)):(a=T+(n.w_bits-8<<4)<<8,a|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(a|=32),a+=31-a%31,n.status=V,f(n,a),0!==n.strstart&&(f(n,e.adler>>>16),f(n,65535&e.adler)),e.adler=1)),69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=x(e.adler,n.pending_buf,n.pending-i,i)),u(e),i=n.pending,n.pending!==n.pending_buf_size));)d(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=x(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=x(e.adler,n.pending_buf,n.pending-i,i)),u(e),i=n.pending,n.pending===n.pending_buf_size)){r=1;break}}while(r=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,d(n,r),0!==r);n.gzhead.hcrc&&n.pending>i&&(e.adler=x(e.adler,n.pending_buf,n.pending-i,i)),0===r&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=x(e.adler,n.pending_buf,n.pending-i,i)),u(e),i=n.pending,n.pending===n.pending_buf_size)){r=1;break}}while(r=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,d(n,r),0!==r);n.gzhead.hcrc&&n.pending>i&&(e.adler=x(e.adler,n.pending_buf,n.pending-i,i)),0===r&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&u(e),n.pending+2<=n.pending_buf_size&&(d(n,255&e.adler),d(n,e.adler>>8&255),e.adler=0,n.status=V)):n.status=V),0!==n.pending){if(u(e),0===e.avail_out)return n.last_flush=-1,E}else if(0===e.avail_in&&o(t)<=o(s)&&t!==C)return l(e,-5);if(666===n.status&&0!==e.avail_in)return l(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==_&&666!==n.status){var s=2===n.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(p(e),0===e.lookahead)){if(t===_)return $;break}if(e.match_length=0,n=S._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(h(e,!1),0===e.strm.avail_out))return $}return e.insert=0,t===C?(h(e,!0),0===e.strm.avail_out?H:X):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?$:U}(n,t):3===n.strategy?function(e,t){for(var n,i,r,a,s=e.window;;){if(e.lookahead<=N){if(p(e),e.lookahead<=N&&t===_)return $;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=O&&0<e.strstart&&((i=s[r=e.strstart-1])===s[++r]&&i===s[++r]&&i===s[++r])){for(a=e.strstart+N;i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<a;);e.match_length=N-(a-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=O?(n=S._tr_tally(e,1,e.match_length-O),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=S._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(h(e,!1),0===e.strm.avail_out))return $}return e.insert=0,t===C?(h(e,!0),0===e.strm.avail_out?H:X):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?$:U}(n,t):G[n.level].func(n,t);if(s!==H&&s!==X||(n.status=666),s===$||s===H)return 0===e.avail_out&&(n.last_flush=-1),E;if(s===U&&(1===t?S._tr_align(n):5!==t&&(S._tr_stored_block(n,0,0,!1),3===t&&(c(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),u(e),0===e.avail_out))return n.last_flush=-1,E}return t!==C?E:n.wrap<=0?1:(2===n.wrap?(d(n,255&e.adler),d(n,e.adler>>8&255),d(n,e.adler>>16&255),d(n,e.adler>>24&255),d(n,255&e.total_in),d(n,e.total_in>>8&255),d(n,e.total_in>>16&255),d(n,e.total_in>>24&255)):(f(n,e.adler>>>16),f(n,65535&e.adler)),u(e),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?E:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==W&&69!==t&&73!==t&&91!==t&&103!==t&&t!==V&&666!==t?l(e,k):(e.state=null,t===V?l(e,-3):E):k},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],34:[function(e,t,n){"use strict";t.exports=function(e,t){var n,i,r,a,s,o,l=e.state,c=e.next_in,u=e.input,h=c+(e.avail_in-5),d=e.next_out,f=e.output,p=d-(t-e.avail_out),m=d+(e.avail_out-257),g=l.dmax,v=l.wsize,b=l.whave,S=l.wnext,y=l.window,x=l.hold,w=l.bits,_=l.lencode,C=l.distcode,E=(1<<l.lenbits)-1,k=(1<<l.distbits)-1;e:do{w<15&&(x+=u[c++]<<w,w+=8,x+=u[c++]<<w,w+=8),n=_[x&E];t:for(;;){if(x>>>=i=n>>>24,w-=i,0==(i=n>>>16&255))f[d++]=65535&n;else{if(!(16&i)){if(0==(64&i)){n=_[(65535&n)+(x&(1<<i)-1)];continue t}if(32&i){l.mode=12;break e}e.msg="invalid literal/length code",l.mode=30;break e}r=65535&n,(i&=15)&&(w<i&&(x+=u[c++]<<w,w+=8),r+=x&(1<<i)-1,x>>>=i,w-=i),w<15&&(x+=u[c++]<<w,w+=8,x+=u[c++]<<w,w+=8),n=C[x&k];n:for(;;){if(x>>>=i=n>>>24,w-=i,!(16&(i=n>>>16&255))){if(0==(64&i)){n=C[(65535&n)+(x&(1<<i)-1)];continue n}e.msg="invalid distance code",l.mode=30;break e}if(a=65535&n,w<(i&=15)&&(x+=u[c++]<<w,(w+=8)<i&&(x+=u[c++]<<w,w+=8)),(a+=x&(1<<i)-1)>g){e.msg="invalid distance too far back",l.mode=30;break e}if(x>>>=i,w-=i,(i=d-p)<a){if((i=a-i)>b&&l.sane){e.msg="invalid distance too far back",l.mode=30;break e}if(o=y,(s=0)===S){if(s+=v-i,i<r){for(r-=i;f[d++]=y[s++],--i;);s=d-a,o=f}}else if(S<i){if(s+=v+S-i,(i-=S)<r){for(r-=i;f[d++]=y[s++],--i;);if(s=0,S<r){for(r-=i=S;f[d++]=y[s++],--i;);s=d-a,o=f}}}else if(s+=S-i,i<r){for(r-=i;f[d++]=y[s++],--i;);s=d-a,o=f}for(;2<r;)f[d++]=o[s++],f[d++]=o[s++],f[d++]=o[s++],r-=3;r&&(f[d++]=o[s++],1<r&&(f[d++]=o[s++]))}else{for(s=d-a;f[d++]=f[s++],f[d++]=f[s++],f[d++]=f[s++],2<(r-=3););r&&(f[d++]=f[s++],1<r&&(f[d++]=f[s++]))}break}}break}}while(c<h&&d<m);x&=(1<<(w-=(r=w>>3)<<3))-1,e.next_in=c-=r,e.next_out=d,e.avail_in=c<h?h-c+5:5-(c-h),e.avail_out=d<m?m-d+257:257-(d-m),l.hold=x,l.bits=w}},{}],35:[function(e,t,n){"use strict";function I(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function i(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new O.Buf16(320),this.work=new O.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function r(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=G,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new O.Buf32(l),t.distcode=t.distdyn=new O.Buf32(c),t.sane=1,t.back=-1,H):X}function a(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,r(e)):X}function s(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?X:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,a(e))):X}function o(e,t){var n;return e?(n=new i,(e.state=n).window=null,(t=s(e,t))!==H&&(e.state=null),t):X}var L,F,O=e("../utils/common"),N=e("./adler32"),z=e("./crc32"),W=e("./inffast"),V=e("./inftrees"),$=1,U=2,H=0,X=-2,G=1,l=852,c=592,j=!0;n.inflateReset=a,n.inflateReset2=s,n.inflateResetKeep=r,n.inflateInit=function(e){return o(e,15)},n.inflateInit2=o,n.inflate=function(e,t){var n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,v,b,S,y,x,w,_,C,E,k,P,R,A,T,B=0,M=new O.Buf8(4),D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return X;12===(n=e.state).mode&&(n.mode=13),s=e.next_out,r=e.output,l=e.avail_out,a=e.next_in,i=e.input,o=e.avail_in,c=n.hold,u=n.bits,h=o,d=l,_=H;e:for(;;)switch(n.mode){case G:if(0===n.wrap){n.mode=13;break}for(;u<16;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}if(2&n.wrap&&35615===c){M[n.check=0]=255&c,M[1]=c>>>8&255,n.check=z(n.check,M,2,0),u=c=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&c)){e.msg="unknown compression method",n.mode=30;break}if(u-=4,w=8+(15&(c>>>=4)),0===n.wbits)n.wbits=w;else if(w>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<w,e.adler=n.check=1,n.mode=512&c?10:12,u=c=0;break;case 2:for(;u<16;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}if(n.flags=c,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&(M[0]=255&c,M[1]=c>>>8&255,n.check=z(n.check,M,2,0)),u=c=0,n.mode=3;case 3:for(;u<32;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}n.head&&(n.head.time=c),512&n.flags&&(M[0]=255&c,M[1]=c>>>8&255,M[2]=c>>>16&255,M[3]=c>>>24&255,n.check=z(n.check,M,4,0)),u=c=0,n.mode=4;case 4:for(;u<16;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&(M[0]=255&c,M[1]=c>>>8&255,n.check=z(n.check,M,2,0)),u=c=0,n.mode=5;case 5:if(1024&n.flags){for(;u<16;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&(M[0]=255&c,M[1]=c>>>8&255,n.check=z(n.check,M,2,0)),u=c=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((f=o<(f=n.length)?o:f)&&(n.head&&(w=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),O.arraySet(n.head.extra,i,a,f,w)),512&n.flags&&(n.check=z(n.check,i,f,a)),o-=f,a+=f,n.length-=f),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===o)break e;for(f=0;w=i[a+f++],n.head&&w&&n.length<65536&&(n.head.name+=String.fromCharCode(w)),w&&f<o;);if(512&n.flags&&(n.check=z(n.check,i,f,a)),o-=f,a+=f,w)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===o)break e;for(f=0;w=i[a+f++],n.head&&w&&n.length<65536&&(n.head.comment+=String.fromCharCode(w)),w&&f<o;);if(512&n.flags&&(n.check=z(n.check,i,f,a)),o-=f,a+=f,w)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;u<16;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}if(c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}u=c=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;u<32;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}e.adler=n.check=I(c),u=c=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,n.hold=c,n.bits=u,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){c>>>=7&u,u-=7&u,n.mode=27;break}for(;u<3;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}switch(n.last=1&c,--u,3&(c>>>=1)){case 0:n.mode=14;break;case 1:if(function(e){if(j){var t;for(L=new O.Buf32(512),F=new O.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(V($,e.lens,0,288,L,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;V(U,e.lens,0,32,F,0,e.work,{bits:5}),j=!1}e.lencode=L,e.lenbits=9,e.distcode=F,e.distbits=5}(n),n.mode=20,6!==t)break;c>>>=2,u-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&c,u=c=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(f=n.length){if(0===(f=l<(f=o<f?o:f)?l:f))break e;O.arraySet(r,i,a,f,s),o-=f,a+=f,l-=f,s+=f,n.length-=f;break}n.mode=12;break;case 17:for(;u<14;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}if(n.nlen=257+(31&c),c>>>=5,u-=5,n.ndist=1+(31&c),c>>>=5,u-=5,n.ncode=4+(15&c),c>>>=4,u-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;u<3;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}n.lens[D[n.have++]]=7&c,c>>>=3,u-=3}for(;n.have<19;)n.lens[D[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},_=V(0,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,_){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;v=(B=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,b=65535&B,!((g=B>>>24)<=u);){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}if(b<16)c>>>=g,u-=g,n.lens[n.have++]=b;else{if(16===b){for(E=g+2;u<E;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}if(c>>>=g,u-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}w=n.lens[n.have-1],f=3+(3&c),c>>>=2,u-=2}else if(17===b){for(E=g+3;u<E;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}u-=g,w=0,f=3+(7&(c>>>=g)),c>>>=3,u-=3}else{for(E=g+7;u<E;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}u-=g,w=0,f=11+(127&(c>>>=g)),c>>>=7,u-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;f--;)n.lens[n.have++]=w}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,C={bits:n.lenbits},_=V($,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,_){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},_=V(U,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,_){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=o&&258<=l){e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,n.hold=c,n.bits=u,W(e,d),s=e.next_out,r=e.output,l=e.avail_out,a=e.next_in,i=e.input,o=e.avail_in,c=n.hold,u=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;v=(B=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,b=65535&B,!((g=B>>>24)<=u);){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}if(v&&0==(240&v)){for(S=g,y=v,x=b;v=(B=n.lencode[x+((c&(1<<S+y)-1)>>S)])>>>16&255,b=65535&B,!(S+(g=B>>>24)<=u);){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}c>>>=S,u-=S,n.back+=S}if(c>>>=g,u-=g,n.back+=g,n.length=b,0===v){n.mode=26;break}if(32&v){n.back=-1,n.mode=12;break}if(64&v){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&v,n.mode=22;case 22:if(n.extra){for(E=n.extra;u<E;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;v=(B=n.distcode[c&(1<<n.distbits)-1])>>>16&255,b=65535&B,!((g=B>>>24)<=u);){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}if(0==(240&v)){for(S=g,y=v,x=b;v=(B=n.distcode[x+((c&(1<<S+y)-1)>>S)])>>>16&255,b=65535&B,!(S+(g=B>>>24)<=u);){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}c>>>=S,u-=S,n.back+=S}if(c>>>=g,u-=g,n.back+=g,64&v){e.msg="invalid distance code",n.mode=30;break}n.offset=b,n.extra=15&v,n.mode=24;case 24:if(n.extra){for(E=n.extra;u<E;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===l)break e;if(n.offset>(f=d-l)){if((f=n.offset-f)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}p=f>n.wnext?(f-=n.wnext,n.wsize-f):n.wnext-f,f>n.length&&(f=n.length),m=n.window}else m=r,p=s-n.offset,f=n.length;for(l-=f=l<f?l:f,n.length-=f;r[s++]=m[p++],--f;);0===n.length&&(n.mode=21);break;case 26:if(0===l)break e;r[s++]=n.length,l--,n.mode=21;break;case 27:if(n.wrap){for(;u<32;){if(0===o)break e;o--,c|=i[a++]<<u,u+=8}if(d-=l,e.total_out+=d,n.total+=d,d&&(e.adler=n.check=(n.flags?z:N)(n.check,r,d,s-d)),d=l,(n.flags?c:I(c))!==n.check){e.msg="incorrect data check",n.mode=30;break}u=c=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;u<32;){if(0===o)break e;o--,c+=i[a++]<<u,u+=8}if(c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}u=c=0}n.mode=29;case 29:_=1;break e;case 30:_=-3;break e;case 31:return-4;default:return X}return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,n.hold=c,n.bits=u,(n.wsize||d!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&(P=(k=e).output,R=e.next_out,A=d-e.avail_out,null===(T=k.state).window&&(T.wsize=1<<T.wbits,T.wnext=0,T.whave=0,T.window=new O.Buf8(T.wsize)),A>=T.wsize?(O.arraySet(T.window,P,R-T.wsize,T.wsize,0),T.wnext=0,T.whave=T.wsize):(A<(k=T.wsize-T.wnext)&&(k=A),O.arraySet(T.window,P,R-A,k,T.wnext),(A-=k)?(O.arraySet(T.window,P,R-A,A,0),T.wnext=A,T.whave=T.wsize):(T.wnext+=k,T.wnext===T.wsize&&(T.wnext=0),T.whave<T.wsize&&(T.whave+=k))),0)?(n.mode=31,-4):(h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,n.total+=d,n.wrap&&d&&(e.adler=n.check=(n.flags?z:N)(n.check,r,d,e.next_out-d)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),_=(0==h&&0===d||4===t)&&_===H?-5:_)},n.inflateEnd=function(e){if(!e||!e.state)return X;var t=e.state;return t.window&&(t.window=null),e.state=null,H},n.inflateGetHeader=function(e,t){return e&&e.state?0==(2&(e=e.state).wrap)?X:((e.head=t).done=!1,H):X},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(e,t,n){"use strict";var I=e("../utils/common"),L=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],F=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],O=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],N=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,i,r,a,s,o){for(var l,c,u,h,d,f,p,m,g,v=o.bits,b=0,S=0,y=0,x=0,w=0,_=0,C=0,E=0,k=0,P=0,R=null,A=0,T=new I.Buf16(16),B=new I.Buf16(16),M=null,D=0,b=0;b<=15;b++)T[b]=0;for(S=0;S<i;S++)T[t[n+S]]++;for(w=v,x=15;1<=x&&0===T[x];x--);if(x<w&&(w=x),0===x)return r[a++]=20971520,r[a++]=20971520,o.bits=1,0;for(y=1;y<x&&0===T[y];y++);for(w<y&&(w=y),b=E=1;b<=15;b++)if(E<<=1,(E-=T[b])<0)return-1;if(0<E&&(0===e||1!==x))return-1;for(B[1]=0,b=1;b<15;b++)B[b+1]=B[b]+T[b];for(S=0;S<i;S++)0!==t[n+S]&&(s[B[t[n+S]]++]=S);if(f=0===e?(R=M=s,19):1===e?(R=L,A-=257,M=F,D-=257,256):(R=O,M=N,-1),b=y,d=a,u=-1,h=(k=1<<(_=w))-1,1===e&&852<k||2===e&&592<k)return 1;for(C=S=P=0;;){for(g=s[S]<f?(m=0,s[S]):s[S]>f?(m=M[D+s[S]],R[A+s[S]]):(m=96,0),l=1<<(p=b-C),y=c=1<<_;r[d+(P>>C)+(c-=l)]=p<<24|m<<16|g|0,0!==c;);for(l=1<<b-1;P&l;)l>>=1;if(0!==l?(P&=l-1,P+=l):P=0,S++,0==--T[b]){if(b===x)break;b=t[n+s[S]]}if(w<b&&(P&h)!==u){for(d+=y,E=1<<(_=b-(C=0===C?w:C));_+C<x&&!((E-=T[_+C])<=0);)_++,E<<=1;if(k+=1<<_,1===e&&852<k||2===e&&592<k)return 1;r[u=P&h]=w<<24|_<<16|d-a|0}}return 0!==P&&(r[d+P]=b-C<<24|64<<16|0),o.bits=w,0}},{"../utils/common":27}],37:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(e,t,n){"use strict";function i(e){for(var t=e.length;0<=--t;)e[t]=0}function l(e){return e<256?V[e]:V[256+(e>>>7)]}function r(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function u(e,t,n){e.bi_valid>A-n?(e.bi_buf|=t<<e.bi_valid&65535,r(e,e.bi_buf),e.bi_buf=t>>A-e.bi_valid,e.bi_valid+=n-A):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function h(e,t,n){u(e,n[2*t],n[2*t+1])}function c(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function d(e,t,n){for(var i,r=new Array(R+1),a=0,s=1;s<=R;s++)r[s]=a=a+n[s-1]<<1;for(i=0;i<=t;i++){var o=e[2*i+1];0!==o&&(e[2*i]=c(r[o]++,o))}}function o(e){for(var t=0;t<C;t++)e.dyn_ltree[2*t]=0;for(t=0;t<E;t++)e.dyn_dtree[2*t]=0;for(t=0;t<k;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*B]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function f(e){8<e.bi_valid?r(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function a(e,t,n,i){var r=2*t,a=2*n;return e[r]<e[a]||e[r]===e[a]&&i[t]<=i[n]}function p(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&a(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!a(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function m(e,t,n){var i,r,a,s,o=0;if(0!==e.last_lit)for(;i=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],r=e.pending_buf[e.l_buf+o],o++,0==i?h(e,r,t):(h(e,(a=$[r])+_+1,t),0!==(s=L[a])&&u(e,r-=U[a],s),h(e,a=l(--i),n),0!==(s=F[a])&&u(e,i-=H[a],s)),o<e.last_lit;);h(e,B,t)}function g(e,t){var n,i,r,a=t.dyn_tree,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=P,n=0;n<l;n++)0!==a[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(r=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[r]=0,e.opt_len--,o&&(e.static_len-=s[2*r+1]);for(t.max_code=c,n=e.heap_len>>1;1<=n;n--)p(e,a,n);for(r=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],p(e,a,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,a[2*r]=a[2*n]+a[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,a[2*n+1]=a[2*i+1]=r,e.heap[1]=r++,p(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){for(var n,i,r,a,s,o=t.dyn_tree,l=t.max_code,c=t.stat_desc.static_tree,u=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,f=t.stat_desc.max_length,p=0,m=0;m<=R;m++)e.bl_count[m]=0;for(o[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<P;n++)f<(m=o[2*o[2*(i=e.heap[n])+1]+1]+1)&&(m=f,p++),o[2*i+1]=m,l<i||(e.bl_count[m]++,a=0,d<=i&&(a=h[i-d]),s=o[2*i],e.opt_len+=s*(m+a),u&&(e.static_len+=s*(c[2*i+1]+a)));if(0!==p){do{for(m=f-1;0===e.bl_count[m];)m--}while(e.bl_count[m]--,e.bl_count[m+1]+=2,e.bl_count[f]--,0<(p-=2));for(m=f;0!==m;m--)for(i=e.bl_count[m];0!==i;)(r=e.heap[--n])>l||(o[2*r+1]!==m&&(e.opt_len+=(m-o[2*r+1])*o[2*r],o[2*r+1]=m),i--)}}(e,t),d(a,c,e.bl_count)}function v(e,t,n){var i,r,a=-1,s=t[1],o=0,l=7,c=4;for(0===s&&(l=138,c=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=s,s=t[2*(i+1)+1],++o<l&&r===s||(o<c?e.bl_tree[2*r]+=o:0!==r?(r!==a&&e.bl_tree[2*r]++,e.bl_tree[2*M]++):o<=10?e.bl_tree[2*D]++:e.bl_tree[2*I]++,a=r,c=(o=0)===s?(l=138,3):r===s?(l=6,3):(l=7,4))}function b(e,t,n){var i,r,a=-1,s=t[1],o=0,l=7,c=4;for(0===s&&(l=138,c=3),i=0;i<=n;i++)if(r=s,s=t[2*(i+1)+1],!(++o<l&&r===s)){if(o<c)for(;h(e,r,e.bl_tree),0!=--o;);else 0!==r?(r!==a&&(h(e,r,e.bl_tree),o--),h(e,M,e.bl_tree),u(e,o-3,2)):o<=10?(h(e,D,e.bl_tree),u(e,o-3,3)):(h(e,I,e.bl_tree),u(e,o-11,7));a=r,c=(o=0)===s?(l=138,3):r===s?(l=6,3):(l=7,4)}}function S(e,t,n,i){u(e,0+(i?1:0),3),i=t,t=n,n=!0,f(e=e),n&&(r(e,t),r(e,~t)),s.arraySet(e.pending_buf,e.window,i,t,e.pending),e.pending+=t}var s=e("../utils/common"),y=0,x=1,w=29,_=256,C=_+1+w,E=30,k=19,P=2*C+1,R=15,A=16,T=7,B=256,M=16,D=17,I=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],F=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=new Array(2*(C+2));i(z);var W=new Array(2*E);i(W);var V=new Array(512);i(V);var $=new Array(256);i($);var U=new Array(w);i(U);var H=new Array(E);i(H);function X(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}var G,j,Y,K=function(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length},Z=!1;n._tr_init=function(e){Z||(function(){for(var e,t,n,i=new Array(R+1),r=0,a=0;a<w-1;a++)for(U[a]=r,e=0;e<1<<L[a];e++)$[r++]=a;for($[r-1]=a,a=n=0;a<16;a++)for(H[a]=n,e=0;e<1<<F[a];e++)V[n++]=a;for(n>>=7;a<E;a++)for(H[a]=n<<7,e=0;e<1<<F[a]-7;e++)V[256+n++]=a;for(t=0;t<=R;t++)i[t]=0;for(e=0;e<=143;)z[2*e+1]=8,e++,i[8]++;for(;e<=255;)z[2*e+1]=9,e++,i[9]++;for(;e<=279;)z[2*e+1]=7,e++,i[7]++;for(;e<=287;)z[2*e+1]=8,e++,i[8]++;for(d(z,C+1,i),e=0;e<E;e++)W[2*e+1]=5,W[2*e]=c(e,5);G=new K(z,L,_+1,C,R),j=new K(W,F,0,E,R),Y=new K(new Array(0),O,0,k,T)}(),Z=!0),e.l_desc=new X(e.dyn_ltree,G),e.d_desc=new X(e.dyn_dtree,j),e.bl_desc=new X(e.bl_tree,Y),e.bi_buf=0,e.bi_valid=0,o(e)},n._tr_stored_block=S,n._tr_flush_block=function(e,t,n,i){var r,a,s=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){for(var t=4093624447,n=0;n<=31;n++,t>>>=1)if(1&t&&0!==e.dyn_ltree[2*n])return y;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return x;for(n=32;n<_;n++)if(0!==e.dyn_ltree[2*n])return x;return y}(e)),g(e,e.l_desc),g(e,e.d_desc),s=function(e){var t;for(v(e,e.dyn_ltree,e.l_desc.max_code),v(e,e.dyn_dtree,e.d_desc.max_code),g(e,e.bl_desc),t=k-1;3<=t&&0===e.bl_tree[2*N[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=r&&(r=a)):r=a=n+5,n+4<=r&&-1!==t?S(e,t,n,i):4===e.strategy||a===r?(u(e,2+(i?1:0),3),m(e,z,W)):(u(e,4+(i?1:0),3),function(e,t,n,i){var r;for(u(e,t-257,5),u(e,n-1,5),u(e,i-4,4),r=0;r<i;r++)u(e,e.bl_tree[2*N[r]+1],3);b(e,e.dyn_ltree,t-1),b(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),m(e,e.dyn_ltree,e.dyn_dtree)),o(e),i&&f(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*($[n]+_+1)]++,e.dyn_dtree[2*l(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){u(e,2,3),h(e,B,z),16===(e=e).bi_valid?(r(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}},{"../utils/common":27}],39:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}]},{},[9])(9)});var XLSX={};"undefined"!=typeof exports?make_xlsx_lib(exports):"undefined"!=typeof module&&module.exports?make_xlsx_lib(module.exports):"function"==typeof define&&define.amd?define("xlsx",[],function(){return XLSX.version||make_xlsx_lib(XLSX),XLSX}):make_xlsx_lib(XLSX);var XLS=XLSX,ODS=XLSX;class UpLoad{constructor(e,t,n){var s=this;this.cb=null,this.reset=function(e){e[0].value=""},this.setInputElement=function(e){Static.bind("itemAttached",function(e,t,n){t.rtti>Static.Rtti_PlotMarker&&t.rtti<Static.Rtti_PlotShape&&$("#fileInput").val().includes(t.title())&&!n&&s.reset($("#fileInput"))}),e.change(function(e){for(var t,n=e.target.files,i=0;t=n[i];i++){var r,a=t.name.split(".")[1];"txt"!=a&&"xls"!=a&&"xlsx"!=a&&"plt"!=a||((r=new FileReader).onload=function(t){return function(e){s.cb?s.cb({fileName:t.name,content:e.target.result}):console.log({fileName:t.name,content:e.target.result})}}(t),"xls"==a||"xlsx"==a?r.readAsBinaryString(t):r.readAsText(t))}})}}}define("upload",function(){});class MFile{constructor(e){let s=new UpLoad,o=this,l=null;function t(){let i=[],e={};e.bottomScaleEngineType=l.axisScaleEngine(xBottom).toString(),e.leftScaleEngineType=l.axisScaleEngine(yLeft).toString(),e.topScaleEngineType=l.axisScaleEngine(xTop).toString(),e.rightScaleEngineType=l.axisScaleEngine(yRight).toString(),e.title=l.title(),e.titleFont=l.titleFont(),e.footer=l.footer(),e.footerFont=l.footerFont(),e.axisTitleFont=l.axisTitleFont(xBottom),e.xBottomAxisTitle=l.axisTitle(xBottom),e.xTopAxisTitle=l.axisTitle(xTop),e.yLeftAxisTitle=l.axisTitle(yLeft),e.yRightAxisTitle=l.axisTitle(yRight),e.autoScale=l.axisAutoScale(xBottom),e.autoScale||(e.xBottomMin=l.axisInterval(xBottom).minValue(),e.xBottomMax=l.axisInterval(xBottom).maxValue(),e.yLeftMin=l.axisInterval(yLeft).minValue(),e.yLeftMax=l.axisInterval(yLeft).maxValue(),e.xTopMin=l.axisInterval(xTop).minValue(),e.xTopMax=l.axisInterval(xTop).maxValue(),e.yRightMin=l.axisInterval(yRight).minValue(),e.yRightMax=l.axisInterval(yRight).maxValue()),i.push(e);let r=l.itemList(Static.Rtti_PlotCurve);for(let n=0;n<r.length;++n){let e={};e.rtti=Static.Rtti_PlotCurve,e.title=r[n].title(),r[n].fn?e.functionDlgData=r[n].functionDlgData:e.samples=r[n].data().samples(),e.fn=r[n].fn,e.pen=r[n].pen(),e.fitType=r[n].fitType,e.equation=r[n].equation;let t=r[n].symbol();e.symbolType=NoSymbol,t&&(e.symbolType=t.style(),e.symbolWidth=t.size().width,e.symbolPenColor=t.pen().color,e.symbolPenWidth=t.pen().width,e.symbolBrushColor=t.brush().color),e.style=r[n].style(),e.xAxis=r[n].xAxis(),e.yAxis=r[n].yAxis(),i.push(e)}r=l.itemList(Static.Rtti_PlotMarker),r=_.filter(r,function(e){return void 0===e.rulers&&"ClosestPointMarker123@###"!==e.title()&&"cgMarker@12345"!==e.title()});for(let n=0;n<r.length;++n){let e={};e.title=r[n].title(),e.rtti=Static.Rtti_PlotMarker,e.label=r[n].label(),e.x=r[n].xValue(),e.y=r[n].yValue(),e.labelAlignment=r[n].labelAlignment(),e.labelOrientation=r[n].labelOrientation(),e.labelFont=r[n].labelFont(),e.lineStyle=r[n].lineStyle(),e.linePen=r[n].linePen();let t=r[n].symbol();t&&(e.type=t.type,e.symbolType=t.style(),e.symbolWidth=t.size().width,e.symbolHeight=t.size().height,e.symbolPenColor=t.pen().color,e.symbolPenWidth=t.pen().width,e.symbolBrushColor=t.brush().color,e.rotation=t.rotation&&t.rotation()),e.xAxis=r[n].xAxis(),e.yAxis=r[n].yAxis(),i.push(e)}r=l.itemList(Static.Rtti_PlotSpectroCurve);for(let t=0;t<r.length;++t){let e={};e.title=r[t].title(),e.rtti=Static.Rtti_PlotSpectroCurve,r[t].fn?e.functionDlgData=r[t].functionDlgData:e.samples=r[t].data().samples(),e.color1=r[t].color1(),e.color2=r[t].color2(),e.minZ=r[t].minZ,e.maxZ=r[t].maxZ,e.fn=r[t].fn,e.penWidth=r[t].penWidth(),e.xAxis=r[t].xAxis(),e.yAxis=r[t].yAxis(),i.push(e)}r=l.itemList(Static.Rtti_PlotSpectrogram);for(let t=0;t<r.length;++t){let e={};e.title=r[t].title(),e.rtti=Static.Rtti_PlotSpectrogram,r[t].fn&&(e.functionDlgData=r[t].functionDlgData),e.fn=r[t].fn,e.upload=r[t].upload,e.spectrogramData=r[t].spectrogramData;const n=r[t].colorMap();e.color1=n.color1(),e.color2=n.color2(),e.showContour=r[t].testDisplayMode(Enum.DisplayMode.ContourMode),e.showSpectrogram=r[t].testDisplayMode(Enum.DisplayMode.ImageMode),e.numberOfContourPlanes=r[t].numberOfContourPlanes(),i.push(e)}return i}function c(e){var t,r=JSON.parse(e.content),e=r[0];"[LogScaleEngine]"==e.rightScaleEngineType&&l.setAxisScaleEngine(yRight,new LogScaleEngine),"[LogScaleEngine]"==e.leftScaleEngineType&&l.setAxisScaleEngine(yLeft,new LogScaleEngine),"[LogScaleEngine]"==e.bottomScaleEngineType&&l.setAxisScaleEngine(xBottom,new LogScaleEngine),"[LogScaleEngine]"==e.topScaleEngineType&&l.setAxisScaleEngine(xTop,new LogScaleEngine),"[LinearScaleEngine]"==e.rightScaleEngineType&&l.setAxisScaleEngine(yRight,new LinearScaleEngine),"[LinearScaleEngine]"==e.leftScaleEngineType&&l.setAxisScaleEngine(yLeft,new LinearScaleEngine),"[LinearScaleEngine]"==e.bottomScaleEngineType&&l.setAxisScaleEngine(xBottom,new LinearScaleEngine),"[LinearScaleEngine]"==e.topScaleEngineType&&l.setAxisScaleEngine(xTop,new LinearScaleEngine),e.autoScale?Utility.setAutoScale(l,!0):(l.setAxisScale(xBottom,e.xBottomMin,e.xBottomMax),l.setAxisScale(yLeft,e.yLeftMin,e.yLeftMax),l.setAxisScale(xTop,e.xTopMin,e.xTopMax),l.setAxisScale(yRight,e.yRightMin,e.yRightMax)),l.setTitleFont(new Misc.Font(e.titleFont)),l.setFooterFont(new Misc.Font(e.footerFont)),l.setAxisTitleFont(xBottom,new Misc.Font(e.axisTitleFont)),l.setAxisTitleFont(xTop,new Misc.Font(e.axisTitleFont)),l.setAxisTitleFont(yLeft,new Misc.Font(e.axisTitleFont)),l.setAxisTitleFont(yRight,new Misc.Font(e.axisTitleFont)),l.setTitle(e.title),l.setFooter(e.footer),l.setAxisTitle(xBottom,e.xBottomAxisTitle),l.setAxisTitle(xTop,e.xTopAxisTitle),l.setAxisTitle(yLeft,e.yLeftAxisTitle),l.setAxisTitle(yRight,e.yRightAxisTitle);for(let e=1;e<r.length;++e)if(r[e].rtti==Static.Rtti_PlotCurve&&l.findPlotCurve(r[e].title))return Static.alert(r[e].title+" already exist"),void s.reset($("#fileInput"));for(let i=1;i<r.length;++i){if(r[i].rtti==Static.Rtti_PlotCurve){let n=null;if(r[i].fn?n=l.functionDlgCb(r[i].functionDlgData):(n=l.createCurve(r[i].rtti,r[i].title),n.setSamples(Utility.pointsFromXYObjectArray(r[i].samples))),r[i].symbolType!==NoSymbol){let e=new Symbol;e.setStyle(r[i].symbolType),e.setSize(new Misc.Size(r[i].symbolWidth,r[i].symbolWidth)),e.setPen(new Misc.Pen(r[i].symbolPenColor,r[i].symbolPenWidth)),e.setBrush(new Misc.Brush(r[i].symbolBrushColor)),n.setSymbol(e)}if(n.setStyle(r[i].style),r[i].fitType&&(n.fitType=r[i].fitType,n.equation=r[i].equation),"natural"==r[i].fitType||"periodic"==r[i].fitType){let e=new SplineCurveFitter,t=e.spline();"periodic"==r[i].fitType?t.setSplineType(Static.SplineType.Periodic):t.setSplineType(Static.SplineType.Natural),n.setCurveFitter(e)}n.setPen(new Misc.Pen(r[i].pen.color,r[i].pen.width,r[i].pen.style)),n.setAxes(r[i].xAxis,r[i].yAxis),n.attach(l)}if(r[i].rtti==Static.Rtti_PlotSpectroCurve){let e=null;r[i].fn?e=l.functionDlgCb(r[i].functionDlgData):(e=l.createCurve(r[i].rtti,r[i].title),e.setSamples(r[i].samples)),e.setPenWidth(r[i].penWidth),e.setColorInterval(r[i].color1,r[i].color2),e.setColorRange(new Interval(r[i].minZ,r[i].maxZ)),e.minZ=r[i].minZ,e.maxZ=r[i].maxZ,e.attach(l)}if(r[i].rtti==Static.Rtti_PlotSpectrogram){let e=null;r[i].fn?(e=l.functionDlgCb(r[i].functionDlgData),e.setNumberOfContourPlanes(r[i].numberOfContourPlanes),e.showContour(r[i].showContour),e.showSpectrogram(r[i].showSpectrogram)):(t={title:r[i].title,color1:r[i].color1,color2:r[i].color2,showContour:r[i].showContour,showSpectrogram:r[i].showSpectrogram,numberOfContourPlanes:r[i].numberOfContourPlanes},l.uploadSpectrogram(t,r[i].spectrogramData,r[i].upload))}if(r[i].rtti==Static.Rtti_PlotMarker){let t=l.createCurve(r[i].rtti,r[i].title);if(r[i].symbolType!==NoSymbol){let e=null;r[i].type&&"arrow"===r[i].type?e=new ArrowSymbol:r[i].type&&"dotOnLine"===r[i].type&&(e=new DotOnLineSymbol),e&&(e.setSize(new Misc.Size(r[i].symbolWidth,r[i].symbolHeight)),e.setRotation&&e.setRotation(r[i].rotation),e.setPen(new Misc.Pen(r[i].symbolPenColor,r[i].symbolPenWidth)),e.setBrush(new Misc.Brush(r[i].symbolBrushColor)),t.setSymbol(e)),t.setLineStyle(r[i].lineStyle),t.setLinePen(new Misc.Pen(r[i].linePen.color,r[i].linePen.width,r[i].linePen.style)),t.setAxes(r[i].xAxis,r[i].yAxis),t.setValue(r[i].x,r[i].y),t.setLabel(r[i].label),t.setLabelAlignment(r[i].labelAlignment),t.setLabelOrientation(r[i].labelOrientation),t.setLabelFont(new Misc.Font(r[i].labelFont.th,r[i].labelFont.name,r[i].labelFont.style,r[i].labelFont.weight,r[i].labelFont.fontColor)),t.attach(l)}}}s.reset($("#fileInput"))}this.getPlotData=function(){var e=t();return JSON.stringify(e)},this.setPlotData=function(e){this.upload(e)},this.init=function(e){l=e,s.cb=this.upload},this.setInputElement=function(e){s.setInputElement(e)},this.upload=function(i){var e=i.fileName.split(".")[1];if("xls"==e||"xlsx"==e||"txt"==e||"tbl"==e){var t;let n=null;if(n="xls"==e||"xlsx"==e?(r=(t=XLSX.read(i.content,{type:"binary"})).SheetNames[0],Utility.toArrays(XLSX.utils.sheet_to_csv(t.Sheets[r]))):Utility.toArrays(i.content),!n.dataType)if(n.array.length&&n.array[0].hasOwnProperty("z")){let t=[];for(let e=0;e<n.array.length;e++)t.push(n.array[e].x);t.length===_.uniq(t).length?n.dataType="spectrocurve":n.dataType="spectrogram"}else n.dataType="curve";"curve"===n.dataType?(a=Utility.makePoints(n.array),Static.trigger("addCurve",[i.fileName,a,!0])):"spectrocurve"===n.dataType?Static.trigger("addSpectrocurve",[i.fileName,n,!0]):"spectrogram"===n.dataType&&Static.trigger("addSpectrogram",[i.fileName,n,!0])}else if("plt"==e){let t=!1;l.rightSidebar.isSideBarVisible()&&(l.rightSidebar.showSidebar(!1),t=!0);let n=l.itemList(Static.Rtti_PlotCurve);var r=l.itemList(Static.Rtti_PlotMarker),a=l.itemList(Static.Rtti_PlotSpectroCurve),e=l.itemList(Static.Rtti_PlotSpectrogram),r=_.filter(r,function(e){return void 0===e.rulers&&"ClosestPointMarker123@###"!==e.title()&&"cgMarker@12345"!==e.title()});n=n.concat(r),n=n.concat(a),n=n.concat(e),n.length?Static.alertYesNo("Do you want to save the changes to the Grapher?",function(e){if(e==Static.Cancel)return s.reset($("#fileInput")),void(t&&l.rightSidebar.showSidebar(!0));if(e!=Static.Yes){if(e==Static.No){for(let e=0;e<n.length;++e)n[e].detach();c(i),t&&l.rightSidebar.showSidebar(!0)}}else{o.save(),s.reset($("#fileInput"));for(let e=0;e<n.length;++e)n[e].detach();c(i)}}):c(i)}},this.save=function(){Static.prompt("Enter a filename without extensions","plot_1",function(e){return e+=".plt",function(e,t){let n=document.createElement("a");document.body.appendChild(n),n.style="display: none",e=JSON.stringify(e),e=new Blob([e],{type:"octet/stream"}),e=window.URL.createObjectURL(e),n.href=e,n.download=t,n.click(),window.URL.revokeObjectURL(e)}(t(),e),!0},"small")},this.init(e)}}define("file",["xlsx","upload"],function(){});class Watch{constructor(e,t){var n=this;this._dependentRuler=t||Static.NoRuler,this._rulerGroup=e;var i=!0;this._curveName="",this._curve=null,this._rulerLeft=Number.MAX_VALUE,this._rulerRight=Number.MAX_VALUE,this._rulerBottom=Number.MAX_VALUE,this._rulerTop=Number.MAX_VALUE,this._value,this._magnifying=!1,this._rulerLeftPrevious=Number.MAX_VALUE,this._rulerRightPrevious=Number.MAX_VALUE,Static.bind("invalidateWatch",function(){n._rulerLeftPrevious=Number.MAX_VALUE,n._rulerRightPrevious=Number.MAX_VALUE}),Static.bind("magnifyingStart",function(){n._magnifying=!0}),Static.bind("magnifyingEnd",function(){n._magnifying=!1,Static.trigger("positionChanged")}),this.name=function(){},this.computeWatch=function(){},this.value=function(){return this._value},this.setCurveName=function(e){this._curveName=e},this.setCurve=function(e){this._curve=e},this.setRulerLeft=function(e){this._rulerLeft=e},this.setRulerRight=function(e){this._rulerRight=e},this.setRulerBottom=function(e){this._curve&&this._curve.plot()&&(e=Static.adjustForDecimalPlaces(e,this._curve.plot().axisDecimalPlaces(this._curve.yAxis()))),this._rulerBottom=e},this.setRulerTop=function(e){this._curve&&this._curve.plot()&&(e=Static.adjustForDecimalPlaces(e,this._curve.plot().axisDecimalPlaces(this._curve.yAxis()))),this._rulerTop=e},this.setEnable=function(e){i=e,Static.trigger("watchEnabled",[this,e])},this.isEnable=function(){return i}}}define("watch",function(){});var MoveToElement=0,LineToElement=1,CurveToElement=2,CurveToDataElement=3,Misc={};Misc.EPSILON=Number.MIN_VALUE,Misc.Image=function(e,t){var i=e,n=t,r=null;"object"==typeof e&&_.has(e,"width")&&_.has(e,"height")&&(i=e.width,n=e.height),null==e&&(n=i=0);var l=$("<canvas/>")[0].getContext("2d"),c=null;0!==i&&0!==n&&(c=l.createImageData(i,n)),this.data=function(){return c.data},this.scaleImageData=function(e){if(c){for(var t=l.createImageData(c.width*e,c.height*e),n=l.createImageData(e,1).data,i=0;i<c.height;i++)for(var r=0;r<c.width;r++){for(var a=c.data.subarray(4*(i*c.width+r),4*(i*c.width+r)+4),s=0;s<e;s++)n.set(a,4*s);for(var o=0;o<e;o++)t.data.set(n,4*((i*e+o)*t.width+r*e))}c=t}},this.imageData=function(){return c},this.setImageData=function(e){c=e},this.width=function(){return i},this.height=function(){return n},this.size=function(){return new Misc.Size(i,n)},this.isNull=function(){return null==c},this.copy=function(){var e=new Misc.Image(this.width(),this.height()),t=new ImageData(new Uint8ClampedArray(this.imageData().data),this.imageData().width,this.imageData().height);return e.setImageData(t),e},this.setAlpha=function(e){for(var t=c.data,n=t.length,i=3;i<n;i+=4)t[i]=e},this.setPixel=function(e,t,n){"number"==typeof n&&(n=r[Math.round(n)]);e=t*(4*i)+4*e;c.data[e]=n.r,c.data[1+e]=n.g,c.data[2+e]=n.b,c.data[3+e]=255,n.a&&(255<n.a&&(n.a=255),n.a<0&&(n.a=0),c.data[3+e]=n.a)},this.setColorTable=function(e){r=e},this.pixel=function(e,t){if(null==t&&r)return r[Math.round(e)];e=t*(4*i)+4*e;return{r:c.data[e],g:c.data[1+e],b:c.data[2+e],a:c.data[3+e]}}},Misc.Pen=function(e,t,n){if("object"==typeof e)return new Misc.Pen(e.color,e.width,e.style);this.color="black",this.width=1,this.style="solid",e!=Static.NoPen&&n!=Static.NoPen||(this.style=Static.NoPen),void 0!==n&&(this.style=n),void 0!==t&&(this.width=t),void 0!==e&&(this.color=e)},Misc.Pen.prototype.toString=function(){return"[color:"+this.color+", width:"+this.width+", style:"+this.style+"]"},Misc.Pen.prototype.isEqual=function(e){return null!=e&&(this.color==e.color&&this.style==e.style&&this.width==e.width)},Misc.Brush=function(e){this.color=Static.NoBrush,void 0!==e&&(this.color=e)},Misc.Brush.prototype.toString=function(){return"[Brush: "+this.color+"]"},Misc.Brush.prototype.isEqual=function(e){return this.color==e.color},Misc.Line=function(e,t){var n=e,i=t;this.p1=function(){return n},this.p2=function(){return i}},Misc.Line.prototype.x1=function(){return this.p1().x},Misc.Line.prototype.x2=function(){return this.p2().x},Misc.Line.prototype.y1=function(){return this.p1().y},Misc.Line.prototype.y2=function(){return this.p2().y},Misc.Line.prototype.x2=function(){return this.p2().x},Misc.Line.prototype.length=function(){return Math.sqrt((this.p2().x-this.p1().x)*(this.p2().x-this.p1().x)+(this.p2().y-this.p1().y)*(this.p2().y-this.p1().y))},Misc.Size=function(e,t){e instanceof Misc.Size&&(t=e.height,e=e.width),this.width=0,void(this.height=0)!==t&&(this.width=e,this.height=t)},Misc.Size.prototype.isValid=function(){return!(this.width<0||this.height<0)},Misc.Size.prototype.isEmpty=function(){return this.width<=0||this.height<=0},Misc.Size.prototype.copy=function(){return new Misc.Size(this.width,this.height)},Misc.Size.prototype.isEqual=function(e){var t=this.width-e.width,e=this.height-e.height;return t*t+e*e<Misc.EPSILON},Misc.Size.prototype.expandedTo=function(e){return new Misc.Size(Math.max(this.width,e.width),Math.max(this.height,e.height))},Misc.Size.prototype.boundedTo=function(e){return new Misc.Size(Math.min(this.width,e.width),Math.min(this.height,e.height))},Misc.Size.prototype.toString=function(){return"["+this.width+", "+this.height+"]"},Misc.Point=function(e,t){this.x=0,void(this.y=0)!==t&&(this.y=t),void 0!==e&&(this.x=e)},Misc.Point.prototype.interpolatedPoint=function(e,t){if(t==e.x)return e;if(t==this.x)return this;e=(this.y-e.y)/(this.x-e.x)*(t-e.x)+e.y;return new Misc.Point(t,e)},Misc.Point.prototype.logInterpolatedPoint=function(e,t){if(t==e.x)return e;if(t==this.x)return this;e=(this.y-e.y)/(math.log(this.x,10)-math.log(e.x,10))*(math.log(t,10)-math.log(e.x,10))+e.y;return new Misc.Point(t,e)},Misc.Point.prototype.isEqual=function(e){var t=this.x-e.x,e=this.y-e.y;return t*t+e*e<Misc.EPSILON},Misc.Point.prototype.toString=function(){return"("+this.x+", "+this.y+")"},Misc.Rect=function(e,t,n,i){var r=0,a=0,s=-1,o=-1,l=-1,c=-1;void 0!==i?(s=(r=e)+(l=n),o=(a=t)+(c=i)):void 0!==n?(r=e.x,a=e.y,s=r+(l=t),o=a+(c=n)):void 0!==t&&(r=e.x,a=e.y,void 0!==t.x?(s=t.x,o=t.y,l=s-r,c=o-a):(l=t.width,c=t.height,s=r+l,o=a+c)),this.left=function(){return r},this.setLeft=function(e){r!==e&&(l=s-(r=e))},this.top=function(){return a},this.setTop=function(e){a!==e&&(c=o-(a=e))},this.right=function(){return s},this.setRight=function(e){s!==e&&(l=(s=e)-r)},this.bottom=function(){return o},this.setBottom=function(e){o!==e&&(c=(o=e)-a)},this.width=function(){return l},this.height=function(){return c}},Misc.Rect.prototype.setWidth=function(e){this.width()!==e&&this.setRight(this.left()+e)},Misc.Rect.prototype.isValid=function(){return!(this.width()<=0||this.height()<=0)},Misc.Rect.prototype.copy=function(){return new Misc.Rect(this.left(),this.top(),this.width(),this.height())},Misc.Rect.prototype.setHeight=function(e){this.height()!==e&&this.setBottom(this.top()+e)},Misc.Rect.prototype.adjust=function(e,t,n,i){this.setLeft(this.left()+e),this.setTop(this.top()+t),this.setRight(this.right()+n),this.setBottom(this.bottom()+i)},Misc.Rect.prototype.size=function(){return new Misc.Size(this.width(),this.height())},Misc.Rect.prototype.setSize=function(e){this.setWidth(e.width),this.setHeight(e.height)},Misc.Rect.prototype.setRect=function(e,t,n,i){this.setLeft(e),this.setTop(t),this.setWidth(n),this.setHeight(i)},Misc.Rect.prototype.united=function(e){return new Misc.Rect(Math.min(this.left(),e.left()),Math.min(this.top(),e.top()),Math.max(this.right(),e.right())-Math.min(this.left(),e.left()),Math.max(this.bottom(),e.bottom())-Math.min(this.top(),e.top()))},Misc.Rect.prototype.normalized=function(){var e,t=new Misc.Rect(this.left(),this.top(),this.width(),this.height());return t.width()<0&&(e=t.right(),t.setRight(t.left()),t.setLeft(e)),this.height()<0&&(e=t.bottom(),t.setBottom(t.top()),t.setTop(e)),t},Misc.Rect.prototype.toRect=function(){return new Misc.Rect(Math.round(this.left()),Math.round(this.top()),Math.round(this.width()),Math.round(this.height()))},Misc.Rect.prototype.center=function(){return new Misc.Point(.5*(this.left()+this.right()),.5*(this.top()+this.bottom()))},Misc.Rect.prototype.moveTopLeft=function(e){var t=this.width(),n=this.height();this.setLeft(e.x),this.setTop(e.y),this.setRight(e.x+t),this.setBottom(e.y+n)},Misc.Rect.prototype.moveBottomRight=function(e){var t=this.width(),n=this.height();this.setRight(e.x),this.setBottom(e.y),this.setLeft(e.x-t),this.setTop(e.y-n)},Misc.Rect.prototype.moveCenter=function(e){var t=this.width(),n=this.height();this.setRight(e.x+.5*t),this.setBottom(e.y+.5*n),this.setLeft(e.x-.5*t),this.setTop(e.y-.5*n)},Misc.Rect.prototype.intersects=function(e){var t=Math.max(this.left(),e.left()),n=this.left()+this.width(),i=e.left()+e.width();if(t<Math.min(n,i)){n=Math.max(this.top(),e.top()),i=this.top()+this.height(),e=e.top()+e.height();if(n<Math.min(i,e))return!0}return!1},Misc.Rect.prototype.intersected=function(e){if(e.contains(new Misc.Point(this.left(),this.top()),!1)||e.contains(new Misc.Point(this.right(),this.top()),!1)||e.contains(new Misc.Point(this.right(),this.bottom()),!1)||e.contains(new Misc.Point(this.left(),this.bottom()),!1)||this.contains(new Misc.Point(e.left(),e.top()),!1)||this.contains(new Misc.Point(e.right(),e.top()),!1)||this.contains(new Misc.Point(e.right(),e.bottom()),!1)||this.contains(new Misc.Point(e.left(),e.bottom()),!1)){var t=Math.max(this.left(),e.left()),n=Math.max(this.top(),e.top()),i=Math.min(this.right()-t,e.right()-t),e=Math.min(this.bottom()-n,e.bottom()-n);return new Misc.Rect(t,n,i,e)}return new Misc.Rect},Misc.Rect.prototype.adjusted=function(e,t,n,i){t=new Misc.Point(this.left()+e,this.top()+t),i=new Misc.Point(this.right()+n,this.bottom()+i);return new Misc.Rect(t,i)},Misc.Rect.prototype.contains=function(e,t){return void 0===t||!0===t?e.x>this.left()&&e.y>this.top()&&e.x<this.right()&&e.y<this.bottom():e.x>=this.left()&&e.y>=this.top()&&e.x<=this.right()&&e.y<=this.bottom()},Misc.Rect.prototype.isEqual=function(e){var t=new Misc.Point(e.left(),e.top());if(new Misc.Point(this.left(),this.top()).isEqual(t)){t=this.width()-e.width(),e=this.height()-e.height();return t*t+e*e<Misc.EPSILON}return!1},Misc.Rect.prototype.leftTop=function(){return new Misc.Point(this.left(),this.top())},Misc.Rect.prototype.topLeft=function(){return this.leftTop()},Misc.Rect.prototype.rightTop=function(){return new Misc.Point(this.right(),this.top())},Misc.Rect.prototype.topRight=function(){return new Misc.Point(this.right(),this.top())},Misc.Rect.prototype.leftBottom=function(){return new Misc.Point(this.left(),this.bottom())},Misc.Rect.prototype.rightBottom=function(){return new Misc.Point(this.right(),this.bottom())},Misc.Rect.prototype.bottomRight=function(){return this.rightBottom()},Misc.Rect.prototype.bottomLeft=function(){return this.rightBottom()},Misc.Rect.prototype.toString=function(){return"["+this.left()+", "+this.top()+", "+this.width()+", "+this.height()+"]"},Misc.Rect.prototype.isEmpty=function(){return this.width()<=0||this.height()<=0},Misc.Rect.prototype.x=function(){return this.left()},Misc.Rect.prototype.y=function(){return this.top()},Misc.Polygon=function(e,t=0){this.points=[],this.points.push(new Misc.Point(e.left(),e.top()),new Misc.Point(e.right(),e.top()),new Misc.Point(e.right(),e.bottom()),new Misc.Point(e.left(),e.bottom())),close&&this.points.push(new Misc.Point(e.left(),e.top()))},Misc.Polygon.prototype.toString=function(){return"[Polygon]"},Misc.Font=function(e,t,n,i,r){"object"==typeof e?(this.th=e.th,this.name=e.name,this.style=e.style,this.weight=e.weight,this.fontColor=e.fontColor):(this.th=12,this.name="Arial",this.style="normal",this.weight="normal",this.fontColor="black"),"object"!=typeof e&&(void 0!==r&&(this.fontColor=r),void 0!==i&&(this.weight=i),void 0!==n&&(this.style=n),void 0!==t&&(this.name=t),void 0!==e&&(this.th=e))},Misc.Font.prototype.textSize=function(e){if(""==e||void 0===e)return new Misc.Size(0,0);var t=$("<canvas />"),n=t[0].getContext("2d");n.font=this.weight+" "+this.style+" "+this.th+"px "+this.name;e=1.16*n.measureText(e).width,n=n.measureText("M").width;return t.remove(),new Misc.Size(e,n)},Misc.Font.prototype.toString=function(){return"[th:"+this.th+", name:"+this.name+", style:"+this.style+", weight:"+this.weight+", color:"+this.fontColor+"]"},Misc.MPathElement=function(e,t,n){this.type=MoveToElement,this.x=0,void(this.y=0)!==t&&(this.x=t),void 0!==n&&(this.y=n),void 0!==e&&(this.type=e)},Misc.MPathElement.prototype.toString=function(){return"[MPathElement: type("+this.type+"), point"+new Misc.Point(this.x,this.y)+"]"},Misc.MPath=function(){var e=[];this.data={},this.elements=function(){return e}},Misc.MPath.prototype.elementCount=function(){return this.elements().length},Misc.MPath.prototype.elementAt=function(e){return e<0||e>=this.elements().length?null:this.elements()[e]},Misc.MPath.prototype.moveTo=function(e,t){this.elements().push(new Misc.MPathElement(MoveToElement,e,t))},Misc.MPath.prototype.lineTo=function(e,t){this.elements().push(new Misc.MPathElement(LineToElement,e,t))},Misc.MPath.prototype.cubicTo=function(e,t,n,i,r,a){var s=this.elements();s.push(new Misc.MPathElement(CurveToElement,e,t)),s.push(new Misc.MPathElement(CurveToElement,n,i)),s.push(new Misc.MPathElement(CurveToElement,r,a))},Misc.MPath.prototype.toString=function(){return"[MPath: elementCount = "+this.elements().length+"]"},Misc.MPath.prototype.isEmpty=function(){return 0==this.elements().length},Misc.MPath.prototype.addRect=function(e){var t=this.elements();t.push(new Misc.MPathElement(MoveToElement,e.left(),e.top())),t.push(new Misc.MPathElement(LineToElement,e.right(),e.top())),t.push(new Misc.MPathElement(LineToElement,e.right(),e.bottom())),t.push(new Misc.MPathElement(LineToElement,e.left(),e.bottom())),t.push(new Misc.MPathElement(LineToElement,e.left(),e.top()))},Misc.MPath.prototype.addPolygon=function(e){if(e&&e.length){this.elements().push(new Misc.MPathElement(MoveToElement,e[0].x,e[0].y));for(var t=1;t<e.length;++t)this.elements().push(new Misc.MPathElement(LineToElement,e[t].x,e[t].y))}},Misc.MPath.prototype.addPathElement=function(e){this.elements().push(e)},Misc.MPath.prototype.boundingRect=function(){for(var e=0,t=0,n=0,i=0,r=!1,a=0;a<this.elements().length;a++){var s=this.elements()[a];switch(s.type){case LineToElement:case MoveToElement:case CurveToElement:r||(e=s.x,t=s.y,n=s.x,i=s.y,r=!0),e=Math.min(e,s.x),n=Math.max(n,s.x),t=Math.min(t,s.y),i=Math.max(i,s.y)}}if(null==this.data.rotation||0==this.data.rotation)return new Misc.Rect(e,t,n-e,i-t);var o=(o=this.data.rotation)*Math.PI/180,l=n-e,c=i-t,u=Math.abs(l*Math.sin(o))+Math.abs(c*Math.cos(o)),o=Math.abs(c*Math.sin(o))+Math.abs(l*Math.cos(o));return new Misc.Rect(e-(o-l)/2,t-(u-c)/2,o,u)},define("miscObjects",function(){}),function(e,t){"function"==typeof define&&define.amd?define("regression",t):"undefined"!=typeof module?module.exports=t():e.regression=t()}(this,function(){"use strict";function m(e,i){var n=e.reduce(function(e,t){return e+t[1]},0)/e.length,t=e.reduce(function(e,t){t=t[1]-n;return e+t*t},0);return 1-e.reduce(function(e,t,n){n=i[n],n=t[1]-n[1];return e+n*n},0)/t}function g(e,t){t=Math.pow(10,t);return Math.round(e*t)/t}var r={linear:function(e,t,n){for(var i,r,a,s=[0,0,0,0,0],o=e.length,l=0;l<o;l++)null!==e[l][1]&&(s[0]+=e[l][0],s[1]+=e[l][1],s[2]+=e[l][0]*e[l][0],s[3]+=e[l][0]*e[l][1],s[4]+=e[l][1]*e[l][1]);return r=(o*s[3]-s[0]*s[1])/(o*s[2]-s[0]*s[0]),a=s[1]/o-r*s[0]/o,i=e.map(function(e){e=e[0];return[e,r*e+a]}),{r2:m(e,i),equation:[r,a],points:i,string:"y = "+g(r,n.precision)+"x + "+g(a,n.precision)}},linearthroughorigin:function(e,t,n){for(var i,r,a=[0,0],s=0;s<e.length;s++)null!==e[s][1]&&(a[0]+=e[s][0]*e[s][0],a[1]+=e[s][0]*e[s][1]);return i=a[1]/a[0],r=e.map(function(e){e=e[0];return[e,i*e]}),{r2:m(e,r),equation:[i],points:r,string:"y = "+g(i,n.precision)+"x"}},exponential:function(e,t,n){for(var i,r,a,s=[0,0,0,0,0,0],o=0;o<e.length;o++)null!==e[o][1]&&(s[0]+=e[o][0],s[1]+=e[o][1],s[2]+=e[o][0]*e[o][0]*e[o][1],s[3]+=e[o][1]*Math.log(e[o][1]),s[4]+=e[o][0]*e[o][1]*Math.log(e[o][1]),s[5]+=e[o][0]*e[o][1]);return a=s[1]*s[2]-s[5]*s[5],i=Math.exp((s[2]*s[3]-s[5]*s[4])/a),r=(s[1]*s[4]-s[5]*s[3])/a,a=e.map(function(e){e=e[0];return[e,i*Math.exp(r*e)]}),{r2:m(e,a),equation:[i,r],points:a,string:"y = "+g(i,n.precision)+"e^("+g(r,n.precision)+"x)"}},logarithmic:function(e,t,n){for(var i,r,a,s=[0,0,0,0],o=e.length,l=0;l<o;l++)null!==e[l][1]&&(s[0]+=Math.log(e[l][0]),s[1]+=e[l][1]*Math.log(e[l][0]),s[2]+=e[l][1],s[3]+=Math.pow(Math.log(e[l][0]),2));return r=(o*s[1]-s[2]*s[0])/(o*s[3]-s[0]*s[0]),i=(s[2]-r*s[0])/o,a=e.map(function(e){e=e[0];return[e,i+r*Math.log(e)]}),{r2:m(e,a),equation:[i,r],points:a,string:"y = "+g(i,n.precision)+" + "+g(r,n.precision)+" ln(x)"}},power:function(e,t,n){for(var i,r,a,s=[0,0,0,0],o=e.length,l=0;l<o;l++)null!==e[l][1]&&(s[0]+=Math.log(e[l][0]),s[1]+=Math.log(e[l][1])*Math.log(e[l][0]),s[2]+=Math.log(e[l][1]),s[3]+=Math.pow(Math.log(e[l][0]),2));return r=(o*s[1]-s[2]*s[0])/(o*s[3]-s[0]*s[0]),i=Math.exp((s[2]-r*s[0])/o),a=e.map(function(e){e=e[0];return[e,i*Math.pow(e,r)]}),{r2:m(e,a),equation:[i,r],points:a,string:"y = "+g(i,n.precision)+"x^"+g(r,n.precision)}},polynomial:function(e,t,n){for(var i,r,a,s,o,l=[],c=[],u=0,h=0,d=e.length,f=void 0===t?3:t+1,p=0;p<f;p++){for(a=0;a<d;a++)null!==e[a][1]&&(u+=Math.pow(e[a][0],p)*e[a][1]);for(l.push(u),i=[],r=u=0;r<f;r++){for(a=0;a<d;a++)null!==e[a][1]&&(h+=Math.pow(e[a][0],p+r));i.push(h),h=0}c.push(i)}for(c.push(l),s=function(e,t){for(var n=0,i=0,r=0,a=0,s=0,o=e.length-1,l=new Array(t),n=0;n<o;n++){for(i=(a=n)+1;i<o;i++)Math.abs(e[n][i])>Math.abs(e[n][a])&&(a=i);for(r=n;r<1+o;r++)s=e[r][n],e[r][n]=e[r][a],e[r][a]=s;for(i=n+1;i<o;i++)for(r=o;n<=r;r--)e[r][i]-=e[r][n]*e[n][i]/e[n][n]}for(i=o-1;0<=i;i--){for(s=0,r=i+1;r<o;r++)s+=e[r][i]*l[r];l[i]=(e[o][i]-s)/e[i][i]}return l}(c,f),t=e.map(function(e){var i=e[0],e=s.reduce(function(e,t,n){return e+t*Math.pow(i,n)},0);return[i,e]}),o="y = ",p=s.length-1;0<=p;p--)o+=1<p?g(s[p],n.precision)+"x^"+p+" + ":1===p?g(s[p],n.precision)+"x + ":g(s[p],n.precision);return{r2:m(e,t),equation:s,points:t,string:o}},lastvalue:function(e,t,n){for(var i=[],r=null,a=0;a<e.length;a++)null!==e[a][1]&&isFinite(e[a][1])?(r=e[a][1],i.push([e[a][0],e[a][1]])):i.push([e[a][0],r]);return{r2:m(e,i),equation:[r],points:i,string:""+g(r,n.precision)}}};return function(e,t,n,i){i="object"==typeof n&&void 0===i?n:i||{};return i.precision||(i.precision=2),"string"==typeof e?r[e.toLowerCase()](t,n,i):null}});var Static={},Enum={};math.config({epsilon:1e-301}),Enum.MousePatternCode={MouseSelect1:0,MouseSelect2:1,MouseSelect3:2,MouseSelect4:3,MouseSelect5:4,MouseSelect6:5,MousePatternCount:6},Enum.KeyPatternCode={KeySelect1:0,KeySelect2:1,KeyAbort:2,KeyLeft:3,KeyRight:4,KeyUp:5,KeyDown:6,KeyRedo:7,KeyUndo:8,KeyHome:9,KeyPatternCount:10},Enum.ScaleComponent={Backbone:1,Ticks:2,Labels:4},Enum.Format={RGB:0,Indexed:1},Enum.Mode={FixedColors:0,ScaledColors:1},Enum.FitMode={Auto:0,Spline:1,ParametricSpline:2},Static.makeAbstract=function(e,t){if(e.constructor==t)throw new Error("Abstract classes can't be instantiated.")},Static.qBound=function(e,t,n){return Math.max(e,Math.min(t,n))},Array.prototype.mid=function(e,t=-1){return-1==t?this.slice(e+1):(t=Math.max(t,0),this.slice(e,e+t))},String.prototype.insertAt=function(e,t,n){return this.slice(0,e)+n+this.slice(e+Math.abs(t))},String.prototype.replaceAt=function(e,t){return this.substr(0,e)+t+this.substr(e+t.length)},Array.prototype.resize=function(e,t=void 0){for(;e>this.length;)this.push(t)},Array.prototype.containsPoint=function(e){for(var t=0;t<this.length;++t)if(this[t].isEqual(e))return!0;return!1},Static.MagnifierEnabled=1,Static.ZoomEnabled=2,Static.PanEnabled=4,Static.Locked=8,Static.LeftButtonDown=16,Static.DragCursor=32,Static.PanningInProgress=64,Static.MagnifierSearch=128,Static.ZoomerSearch=256,Static.PannerSearch=512,Static.NoRuler=1024,Static.Left=0,Static.Right=1,Static.Bottom=2,Static.Top=3,Static.LeftAndRight=75776,Static.BottomAndTop=153088,Static.NoTrackingText=0,Static.FullTrackingText=1,Static.PartialTrackingText=2,Static.ReadOnly=0,Static.Clickable=1,Static.Checkable=2,Static.ModeRole=0,Static.TitleRole=1,Static.IconRole=2,Static.UserRole=32,Static.NoRubberBand=0,Static.HLineRubberBand=1,Static.VLineRubberBand=2,Static.CrossRubberBand=3,Static.RectRubberBand=4,Static.EllipseRubberBand=5,Static.PolygonRubberBand=6,Static.UserRubberBand=100,Static.NoSelection=-1,Static.PointSelection=0,Static.RectSelection=1,Static.PolygonSelection=2,Static.AlwaysOff=0,Static.AlwaysOn=1,Static.ActiveOnly=2,Static.NoPen="noPen",Static.NoBrush="noBrush",Static.accuracyFactorModerate=.002,Static.accuracyFactor=Static.accuracyFactorModerate,Static.watchUpdateError=!1,Static.showWatchUpdateError=!0;var _eps=1e-300,NoTick=-1,MinorTick=0,MediumTick=1,MajorTick=2,NTickTypes=3,BottomScale=0,TopScale=1,LeftScale=2,RightScale=3,Horizontal=1,Vertical=2,ScaleInterest=1,IncludeBorders=0,ExcludeMinimum=1,ExcludeMaximum=2,ExcludeBorders=3,XAxis=0,YAxis=1,ZAxis=2,yLeft=0,yRight=1,xBottom=2,xTop=3,axisCnt=4,Legend=1,AutoScale=2,Margins=4,NoCurve=-1,Lines=0,Sticks=1,Steps=2,Dots=3,UserCurve=100,Inverted=1,Fitted=2,RoundPoints=1,WeedOutPoints=2,FilterPoints=1,MinimizeMemory=2,NoLine=0,NoSymbol=-1,Ellipse=0,MRect=2,Diamond=3,Triangle=4,DTriangle=5,UTriangle=6,LTriangle=7,RTriangle=8,Cross=9,XCross=10,HLine=11,VLine=12,Star1=13,Star2=14,Hexagon=15,Path=16,Pixmap=17,MGraphic=18,SvgDocument=19,UserStyle=1e3;function insertLogBase(e,t){var n=e;if(e.includes(t))for(var i=t.replace("log","");-1!==n.indexOf(t);)for(var r=n.indexOf(t)+t.length,a=0,s=0;r<n.length;++r)if("("==n[r]&&a++,")"==n[r]&&s++,a==s){n=(n=n.insertAt(r,0,","+i)).replace(t,"log");break}return n}function logBaseAdjust(e){for(var t=["log2","log3","log4","log5","log6","log7","log8","log9","log10"],n=0;n<t.length;n++)e=insertLogBase(e,t[n]);return e}function EvaluateExp(e){var i,r=e;this.error=!1;var a=this;function t(){var t=Static.expandDefines(r);try{i=math.parse(t),r.includes("log")||(i=math.simplify(i))}catch(e){var n=parseInt(e.message.match(/(\d+)/)[0]);return Static.alert("Invalid character in function: "+t[n-1]),void(a.error=!0)}i=i.compile()}void 0!==r&&0<r.length&&(r=logBaseAdjust(r),t()),this.setExpString=function(e){r=e,t()},this.getExpString=function(){return r},this.eval=function(e){this.error=!1;try{return i.evaluate(e)}catch(e){return this.errorMessage=e.message,this.error=!0,0}}}Static.NoButton=-1,Static.LeftButton=0,Static.MiddleButton=1,Static.MidButton=1,Static.RightButton=2,Static.Key_Escape=27,Static.Key_Plus=107,Static.Key_Minus=109,Static.Key_Ctrl=17,Static.Key_Shift=16,Static.Key_Return=13,Static.Key_Space=32,Static.Key_Left=37,Static.Key_Right=39,Static.Key_Up=38,Static.Key_Down=40,Static.Key_Undo=90,Static.Key_Redo=89,Static.Key_Home=36,Static.Key_I=73,Static.Key_O=79,Static.Key_unknown=-1,Static.NoModifier=0,Static.ShiftModifier=33554432,Static.ControlModifier=67108864,Static.AltModifier=134217728,Static.AlignRight=1,Static.AlignLeft=2,Static.AlignBottom=4,Static.AlignTop=8,Static.AlignCenter=16,Static.toPrecision=function(e,t){return t<1?t=1:16<t&&(t=16),e.toPrecision(t)},Static.adjustForDecimalPlaces=function(e,t){null==t&&(t=5);t=Math.pow(10,t);return Math.round(e*t)/t},Static.mFuzzyCompare=function(e,t){return Math.abs(e-t)<_eps},Static.m3FuzzyCompare=function(e,t,n){n=Math.abs(_eps*n);return n<t-e?-1:n<e-t?1:0},Static.bind=function(e,t,n){$(window).on(e,t,n)},Static.unbind=function(e,t){$(window).off(e,t)},Static.trigger=function(e,t){$(window).trigger(e,t)},Static.invert=function(e){e=[].slice.call(arguments).join(",").replace(/rgb\(|\)|rgba\(|\)|\s/gi,"").split(",");for(var t=0;t<e.length;t++)e[t]=(3===t?1:255)-e[t];return"rgb("+e.join(", ")+")"},Static.RGB2HTML=function(e,t,n){var i;return"string"==typeof e&&(i=(i=e).replace("rgb(",""),e=parseInt(i),i=(i=i.replace(",","")).replace(e,""),t=parseInt(i),i=(i=i.replace(",","")).replace(t,""),n=parseInt(i)),void 0!==e.r&&(e=(i=e).r,t=i.g,n=i.b),"#"+(16777216+n+256*t+65536*e).toString(16).substr(1)},Static.HTMLToRGB=function(e){e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},Static.mRgb=function(e,t,n){return{r:e,g:t,b:n,toString:function(){return"rgb("+e+","+t+","+n+")"}}},Static.mRgba=function(e,t,n,i){return{r:e,g:t,b:n,a:i,toString:function(){return"rgb("+e+","+t+","+n+","+i+")"}}},Static.colorNameToHex=function(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return"object"==typeof e?Static.RGB2HTML(e.r,e.g,e.b):"r"==e[0]&&"g"==e[1]&&"b"==e[2]?Static.RGB2HTML(e):"#"==e[0]?e:void 0!==t[e.toLowerCase()]?t[e.toLowerCase()]:"#000000"},Static.sqr=function(e){return Math.pow(e,2)},Static.setElementIndex=function(e,t){var n=$(e).parent().children(),i=n[t];$(e).index()>t?(i=null==i?n[0]:i)!=e&&null!=i&&$(i).before(e):(i=null==i?n[n.length-1]:i)!=e&&null!=i&&$(i).after(e)},Static.elementsFromPoint=function(e,t,n){for(var i,r=n[0],a=[];(i=document.elementFromPoint(e,t))!==r?(a.push(i),i.style.pointerEvents="none"):i=!1,i;);return a.forEach(function(e){return e.style.pointerEvents="all"}),$(a)},Static.stopkeyPressPropagation=function(e){e.keydown(function(e){e.stopPropagation()})},window.matchMedia("print").addListener(function(e){e.matches?Static.trigger("beforePrint"):Static.trigger("afterPrint")}),Static.onHtmlElementResize=function(e,t){const n=new ResizeObserver(()=>t());n.observe(e)},Static.Cancel=0,Static.No=1,Static.Yes=2,Static.alertDlg=function(){var n=$('<div class="modal fade" id="alert_Modal" role="dialog">            <div id="dlg" class="modal-dialog">            \x3c!-- Modal content--\x3e            <div class="modal-content">            <div class="modal-header">            \x3c!--button type="button" class="close" data-dismiss="modal">&times;</button--\x3e            <h4 class="modal-title"><b>Alert</b></h4>            </div>            <div class="modal-body">            <p id="msg"></p>            </div>            <div id="alertDlgFooter1" class="modal-footer">            <button type="button" class="btn btn-default" data-dismiss="modal">Ok</button>            </div>            <div id="alertDlgFooter2" class="modal-footer">            <button id="yes" type="button" class="btn btn-default">Yes</button>            <button id="no" type="button" class="btn btn-default">No</button>            <button id="cancel" type="button" class="btn btn-default">Cancel</button>            </div>            </div>            </div>            </div>');$("body").append(n),n.css("z-index",1e9),this.alert=function(e,t){$("#alertDlgFooter2").hide(),$("#alertDlgFooter1").show(),$("#msg").text(e),"small"==t?$("#dlg").addClass("modal-sm"):$("#dlg").removeClass("modal-sm"),n.modal({backdrop:"static"})};var e=this;this.alertYesNo=function(e,t,n){$("#alert_Modal").modal("hide"),this.alertYesCb=t,$("#alertDlgFooter1").hide(),$("#alertDlgFooter2").show(),$("#msg").text(e),"small"==n?$("#dlg").addClass("modal-sm"):$("#dlg").removeClass("modal-sm"),$("#alert_Modal").modal("show")},$("#yes").click(function(){$("#alert_Modal").modal("hide"),e.alertYesCb(Static.Yes)}),$("#no").click(function(){$("#alert_Modal").modal("hide"),e.alertYesCb(Static.No)}),$("#cancel").click(function(){$("#alert_Modal").modal("hide"),e.alertYesCb(Static.Cancel)})},Static.alert=function(e,t){null==Static.alertObj&&(Static.alertObj=new Static.alertDlg),Static.alertObj.alert(e,t)},Static.alertYesNo=function(e,t,n){null==Static.alertObj&&(Static.alertObj=new Static.alertDlg),Static.alertObj.alertYesNo(e,t,n)},Static.promptDlg=function(){var r=$('<div class="modal fade" id="promptModal" role="dialog">            <div id="prompt_dlg" class="modal-dialog">            \x3c!-- Modal content--\x3e            <div class="modal-content">            <div class="modal-header">            <button type="button" class="close" data-dismiss="modal"></button>            <h4 class="modal-title" id="prompt_title">Alert</h4>            </div>            <div class="modal-body">            <input id="prompt_msg" style="width:100%" autofocus />            </div>            <div class="modal-footer">            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>            <button id="prompt_ok" type="button" class="btn btn-default">Ok</button>            </div>            </div>            </div>            </div>');$("body").append(r);var e=this;this.prompt=function(e,t,n,i){"small"==i&&$("#prompt_dlg").addClass("modal-sm"),$("#prompt_title").text(e),$("#prompt_msg").val(t),$("#prompt_msg").select(),this.cb=n,r.modal({backdrop:"static"})},$("#prompt_ok").on("click",function(){e.cb($("#prompt_msg").val())?$(".close").click():$("#prompt_msg").select()})},Static.prompt=function(e,t,n,i){null==Static.promptObj&&(Static.promptObj=new Static.promptDlg),Static.promptObj.prompt(e,t,n,i)},Static.isMobile=function(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i.test(navigator.userAgent||navigator.vendor||window.opera)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test((navigator.userAgent||navigator.vendor||window.opera).substr(0,4))},Static.expandDefines=function(e){for(var t=purgeAndMarkKeywords(t=e.slice()),n=0;n<Static.m_defines.length;n++)for(var i=0;i<Static.m_defines.length;i++)for(;-1!==t.search(Static.m_defines[i].name);)t=t.replace(Static.m_defines[i].name,purgeAndMarkKeywords(Static.getDefined(Static.m_defines[i].name)));return t=replaceKeywordMarkers(t)};var keywords=["asinh","acosh","atanh","acoth","asech","acsch","asin","acos","atan","acot","asec","acsc","sinh","cosh","tanh","coth","sech","csch","sin","cos","tan","sec","csc","cot","ln","log","log2","log3","log4","log5","log6","log7","log8","log9","log10","deg","pi","PI","e","E"];function containsKeyword(e){for(var t=0;t<keywords.length;t++)if(-1!=e.indexOf(keywords[t]))return keywords[t];return null}function purgeKewords(e){for(var t=0;t<keywords.length;++t)for(;-1!=e.indexOf(keywords[t]);)e=e.replace(keywords[t],"");return e}var keywordMarkers=[];function purgeAndMarkKeywords(e){for(var t=0;t<keywords.length;++t)for(;-1!=e.indexOf(keywords[t]);){var n="%"+keywordMarkers.length+"%";e=e.replace(keywords[t],n),keywordMarkers.push({marker:n,keyword:keywords[t]})}return e}function replaceKeywordMarkers(e){for(var t=0;t<keywordMarkers.length;++t)for(;-1!=e.indexOf(keywordMarkers[t].marker);)e=e.replace(keywordMarkers[t].marker,keywordMarkers[t].keyword);return keywordMarkers=[],e}function findIndepVar(e){for(var t=0,n=purgeKewords(e);t<n.length;){for(var i=n.charAt(t),r="";-1!="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(i)&&t<n.length;)r+=i,++t,i=n.charAt(t);if(1===r.length)return r;++t}}function regress(e,t,n,i,r){"linear"==t&&i&&(t="linearthroughorigin");for(var a=e.data().samples(),s=[],o=0;o<a.length;++o)s.push([a[o].x,a[o].y]);return Static.regression(t,s,n,r)}function integrate(e,t,n,i,r){Static.total_area=0;var a=Static.total_volume=0,s=t,o=0;if(i=i||!1){if(_eps<r)for(;s<n;s+=r)n<(a=s+r)&&(r-=a-n),o=e(s+r/2),Static.total_volume+=o*r*o*Math.PI;else alert("The aplication is attempted to use too small a step in the trapezoidial rule.");return Static.total_volume}if(_eps<r)for(;s<n;s+=r)n<(a=s+r)&&(r-=a-n),o=e(s+r/2),Static.total_area+=o*r;else alert("The aplication is attempted to use too small a step in the trapezoidial rule.");return Static.total_area}define("static",["regression"],function(e){Static.regression=e}),$("body").on("contextmenu",function(e){e.preventDefault()}),Static.total_area=0,Static.total_volume=0,integrate.transform=function(e,t,n){if(!e[1].isSymbolNode)throw new Error("Second argument must be a symbol");const i=e[1].name;var r=e[2].compile().evaluate(n),a=e[3].compile().evaluate(n),s=e[4]&&e[4].compile().evaluate(n),o=e[5]&&e[5].compile().evaluate(n),l=Object.create(n),c=e[0].compile();return integrate(function(e){return l[i]=e,c.evaluate(l)},r,a,s,o)},integrate.transform.rawArgs=!0,math.import({integrate:integrate}),Static.isAlpha=function(e){return 96<(e=e.toLowerCase().charCodeAt(0))&&e<122},Static.plotDivPosition={},Static.addCSS=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=e,n.media="all",t.appendChild(n)},Static.m_defines=[],Static.define=function(e,t){Static.m_defines.push({name:e,value:t})},Static.containsDefine=function(e){for(var t=0;t<Static.m_defines.length;t++)if(-1!=e.indexOf(Static.m_defines[t].name))return Static.m_defines[t].name;for(t=0;t<Static.m_defines.length;t++)if(-1!=Static.m_defines[t].name.indexOf(e))return Static.m_defines[t].name;return null},Enum.DefineError={noError:0,start:1,contain:2,keyword:3},Static.validateDefineName=function(e){if(!Static.isAlpha(e[0]))return{errorType:Enum.DefineError.start,name:e};var t=Static.containsDefine(e);if(t)return{errorType:Enum.DefineError.contain,name:t};t=containsKeyword(e);return t?{errorType:Enum.DefineError.keyword,name:t}:{errorType:Enum.DefineError.noError,name:e}},Static.getDefined=function(e){for(var t=0;t<Static.m_defines.length;t++)if(Static.m_defines[t].name===e)return"("+Static.m_defines[t].value+")";return console.warn('"'+e+'" is not predefined!'),""};class DefinesDlg{constructor(a){var e=_.once(function(){function n(){i($("#definesName").val())?($("#definesRemove").attr("disabled",!1),$("#definesRemoveAll").attr("disabled",!1)):($("#definesRemove").attr("disabled",!0),$("#definesRemoveAll").attr("disabled",!0))}function s(e){var t=e.fileName.split(".")[1];if("xls"==t||"xlsx"==t||"txt"==t||"def"==t){var n,i=null;i="xls"==t||"xlsx"==t?(t=(n=XLSX.read(e.content,{type:"binary"})).SheetNames[0],XLSX.utils.sheet_to_csv(n.Sheets[t]).split("\n")):e.content.split("\n");for(var r=!1,a=0;a<i.length;a++){var s,o,l=i[a].split(",");2===l.length&&(s=l[0],o=l[1],s.length&&o.length&&(l=Static.validateDefineName(s),!r&&l.errorType>Enum.DefineError.noError&&(r=!0),l.errorType==Enum.DefineError.noError&&c(s,o)))}r&&Static.alert("One or more invalid names found or an attempt to load the same file more than once.")}$("#definesUpload")[0].value=""}$("body").append($('                        <div class="modal fade" id="definesModal" role="dialog">                        <div class="modal-dialog modal-md">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal">&times;</button>                        <h4 class="modal-title">Defines</h4>                        </div>                        <div class="modal-body">                        <div class="row">                        <div class="col-md-3">Name:</div>                        <div class="col-md-8">                        <input id="definesName" type="text" style="width:100%">                        </input>                        </div>                        </div>                        <br>                        <div class="row">                        <div class="col-md-3">Value:</div>                        <div class="col-md-8">                        <input id="definesValue" type="text" style="width:100%">                        </input>                        </div>                        </div>                        <br>                                                <table>                        <tr style="border: 1px solid black">                        <th style="border: 0px"> Name</th>                        <th style="text-align: right; border: 0px">Value </th>                        </tr>                        </table>                        <div style="position:relative; overflow: auto;height: 100px">                        <table id="definesTable" style="border: 1px solid black">                        <col width="15%">                        </table>                        </div>                                                <div class="modal-footer">                        <button id="definesUploadButton" type="button" class="btn btn-default">\t\t\t\t\t\tLoad                        </button>                        <select name="uploadDefinesType" id="uploadDefinesType">                            <option value="loadFromLocalFs">from Local System</option>                            <option value="loadFromMongoFs">from Mongo System</option>                        </select>                        <label>                        <input id="definesUpload" type="file" style="display: none;" name="files[]" multiple />                        </label>                        <button id="definesAdd" type="button" class="btn btn-default" >Add</button>                        <button id="definesRemove" type="button" class="btn btn-default" >Remove</button>                        <button id="definesRemoveAll" type="button" class="btn btn-default" >Remove All</button>                        <button type="button" class="btn btn-default"  data-dismiss="modal">Close</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#definesAdd").click(r),$("#definesRemove").click(t),$("#definesAdd").attr("disabled",!0),$("#definesRemove").attr("disabled",!0),Static.m_defines.length||($("#definesRemoveAll").attr("disabled",!0),$("#definesRemove").attr("disabled",!0)),$("#definesRemoveAll").on("click",function(){for(var e=0;e<Static.m_defines.length;e++){var t="#"+Static.m_defines[e].name;$(t).remove()}$("#definesRemoveAll").attr("disabled",!0),$("#definesRemove").attr("disabled",!0),Static.m_defines=[]}),$(window).bind("fileOpened",function(e,t,n,i,r){".txt"===i||".def"===i?r===a.definesEditor.m_data.name&&s({fileName:n,content:t}):alert(`Cannot load "${i}" files.`)}),$("#definesUploadButton").on("click",function(){"loadFromLocalFs"===$("#uploadDefinesType").val()?$("#definesUpload").trigger("click"):a.definesEditor.openFile()}),$("#definesUpload").on("change",function(e){for(var t,n=e.target.files,i=0;t=n[i];i++){var r,a=t.name.split(".")[1];"txt"!=a&&"xls"!=a&&"xlsx"!=a&&"plt"!=a||((r=new FileReader).onload=function(t){return function(e){s({fileName:t.name,content:e.target.result})}}(t),"xls"==a||"xlsx"==a?r.readAsBinaryString(t):r.readAsText(t))}}),$("#definesName").on("input",function(e){var t;$("#definesName").val().length&&_.isString($("#definesName").val())&&((t=i($("#definesName").val()))&&$("#definesValue").val(t.value)),$("#definesName").val().length&&_.isString($("#definesName").val())&&$("#definesValue").val().length&&_.isString($("#definesValue").val())?(n(),$("#definesAdd").attr("disabled",!1)):($("#definesAdd").attr("disabled",!0),$("#definesRemove").attr("disabled",!0),$("#definesRemoveAll").attr("disabled",!0))}),$("#definesValue").on("input",function(e){$("#definesName").val().length&&_.isString($("#definesName").val())&&$("#definesValue").val().length&&_.isString($("#definesValue").val())?(n(),$("#definesAdd").attr("disabled",!1)):($("#definesAdd").attr("disabled",!0),$("#definesRemove").attr("disabled",!0),$("#definesRemoveAll").attr("disabled",!0))});for(var e=0;e<Static.m_defines.length;e++)$("#definesTable").append($("<tr id="+Static.m_defines[e].name+' style="border: 1px solid black">                            <td style="border: 1px solid black">'+Static.m_defines[e].name+'</td>                            <td style="border: 1px solid black">'+Static.m_defines[e].value+"</td>                            </tr>"))});function c(e,t){e=e.trim(),t=t.trim();var n=i(e);n?(n.value=t,$("#"+e)[0].children[1].innerText=t):(Static.define(e,t),$("#definesRemoveAll").attr("disabled",!1),$("#definesTable").append($("<tr id="+e+' style="border: 1px solid black">                        <td style="border: 1px solid black">'+e+"</td>                        <td>"+t+"</td>                        </tr>"))),$("#definesName").val(""),$("#definesValue").val(""),$("#definesName").focus(),$("#definesAdd").attr("disabled",!0),$("#definesRemove").attr("disabled",!0)}function i(e){for(var t=0;t<Static.m_defines.length;t++)if(Static.m_defines[t].name===e)return Static.m_defines[t];return null}function t(){var e="#"+$("#definesName").val();!function(e){var t=Static.m_defines.slice();Static.m_defines=[];for(var n=0;n<t.length;n++)t[n].name!==e&&Static.m_defines.push(t[n]);Static.m_defines.length||($("#definesRemove").attr("disabled",!0),$("#definesRemoveAll").attr("disabled",!0),$("#definesAdd").attr("disabled",!0))}($("#definesName").val()),$(e).remove(),$("#definesName").val(""),$("#definesValue").val(""),$("#definesName").focus(),$("#definesRemove").attr("disabled",!0),$("#definesAdd").attr("disabled",!0)}function r(){var e=$("#definesName").val(),t=Static.validateDefineName($("#definesName").val());return t.errorType==Enum.DefineError.start?(Static.alert('Define name,"'+e+'", must start with alpha character.'),$("#definesName").val(""),void(Static.m_defines.length&&$("#definesRemoveAll").attr("disabled",!1))):t.errorType==Enum.DefineError.contain?(Static.alert('Define name,"'+e+'", contains, or is part of, the earlier define, "'+t.name+'".'),$("#definesName").val(""),void(Static.m_defines.length&&$("#definesRemoveAll").attr("disabled",!1))):t.errorType==Enum.DefineError.keyword?(Static.alert('Define name,"'+e+'", contains "'+t.name+'" keyword!'),$("#definesName").val(""),void(Static.m_defines.length&&$("#definesRemoveAll").attr("disabled",!1))):void c(e,$("#definesValue").val())}this.defines=function(){e(),$("#definesModal").modal({backdrop:"static"})}}}var definesDlg=null;Static.defines=function(e){(definesDlg=definesDlg||new DefinesDlg(e)).defines()};class PlotItem{constructor(e){Static.Rtti_PlotItem=0,Static.Rtti_PlotGrid=1,Static.Rtti_PlotScale=2,Static.Rtti_PlotLegend=3,Static.Rtti_PlotMarker=4,Static.Rtti_PlotCurve=5,Static.Rtti_PlotSpectroCurve=6,Static.Rtti_PlotIntervalCurve=7,Static.Rtti_PlotHistogram=8,Static.Rtti_PlotSpectrogram=9,Static.Rtti_PlotSVG=10,Static.Rtti_PlotTradingCurve=11,Static.Rtti_PlotBarChart=12,Static.Rtti_PlotMultiBarChart=13,Static.Rtti_PlotShape=14,Static.Rtti_PlotTextLabel=15,Static.Rtti_PlotZone=16,Static.Rtti_PlotUserItem=1e3;this.plotId="";var n,t=null,i=null,r=($("#centralDiv"),!0),a=0,s=0,o=xBottom,l=yLeft,c=e||"";this.rtti=Static.Rtti_PlotItem;var u=new Misc.Size(10,10);this.getLegendIconSize=function(){return u},this.setLegendIconSize=function(e){u=e,t&&t.updateLegend(this)},this.setItemInterest=function(e,t){t?n|=e:n&=~e,this.itemChanged()},this.testItemInterest=function(e){return n&e},this.plot=function(){return t},this.title=function(){return c},this.setTitle=function(e){c!==e&&(c=e,this.legendChanged(),this.itemChanged(),Static.trigger("titleChange",[this,e]))},this.clearCanvas=function(){this.getContext().clearRect(0,0,i[0].width,i[0].height)},this.attach=function(e){e!=t&&(t&&(this.getContext().clearRect(0,0,i[0].width,i[0].height),i.hide(),i=null,t.attachItem(this,!1)),(t=e)&&(null===i&&(i=$("<canvas />").attr({style:"position: absolute; background-color: transparent"}),t.getLayout().getCentralDiv().append(i),i.css({"border-radius":"inherit"}),0!=s&&i.css("zIndex",s)),t.attachItem(this,!0)))},this.detach=function(){this.attach(null)},this.setZ=function(e){s!==e&&(s=e,i&&i.css("zIndex",s),this.itemChanged())},this.getZ=function(e){return s},this.getCanvas=function(){return i},this.syncSizes=function(){var e=t.getLayout().getCentralDiv();i[0].width=parseFloat(e.css("width")),i[0].height=parseFloat(e.css("height"))},this.getContext=function(){return this.syncSizes(),i[0].getContext("2d")},this._setAxes=function(e,t){e!=xBottom&&e!=xTop||(o=e),t!=yLeft&&t!=yRight||(l=t),this.itemChanged()},this.setItemAttribute=function(e,t){t?a|=e:a&=~e,e==Legend&&this.legendChanged(),this.itemChanged()},this.testItemAttribute=function(e){return a&e},this.show=function(){this.setVisible(!0)},this.hide=function(){this.setVisible(!1)},this.doSetVisible=function(e){e!==r&&((r=e)?i.show():i.hide(),this.itemChanged(),Static.trigger("visibilityChange",[this,e]))},this.isVisible=function(){return r},this.itemChanged=function(){t&&t.autoRefresh()},this.legendChanged=function(){this.testItemAttribute(Legend)&&t&&t.updateLegend(this)},this._setXAxis=function(e){e!=xBottom&&e!=xTop||(o=e,this.itemChanged())},this._setYAxis=function(e){e!=yLeft&&e!=yRight||(l=e,this.itemChanged())},this.xAxis=function(){return o},this.yAxis=function(){return l},this.getCanvasRect=function(){return this.syncSizes(),new Misc.Rect(new Misc.Point,i[0].width,i[0].height)},this.legendIconSize=function(){return this.getLegendIconSize()},this.legendIcon=function(e,t){return null},this.defaultIcon=function(e,t){var n,i=null;return 0<t.width&&0<t.height&&(n=new Misc.Rect(0,0,t.width,t.height),i=new GraphicUtil.Graphic(null,t.width+1,t.height+1),new GraphicPainter(i).fillRect(n,e)),i},this.legendData=function(){var e=new LegendData,t=this.title();e.setValue(Static.TitleRole,t);t=this.legendIcon(0,this.legendIconSize());return t&&e.setValue(Static.IconRole,t),[e]},this.toString=function(){return'[PlotItem "'+this.plotId+'"]'}}boundingRect(){return new Misc.Rect}setVisible(e){this.doSetVisible(e)}setXAxis(e){this._setXAxis(e)}setYAxis(e){this._setYAxis(e)}setAxes(e,t){this._setAxes(e,t)}draw(e,t){console.log("No drawing mehod define in subclass")}}define("plotItem",["static"],function(){});class PlotMarker extends PlotItem{constructor(e){super(e);var u="",h=new Misc.Font,d=Static.AlignCenter,f=Horizontal,p=2,m=new Misc.Pen,g=null,v=NoLine,r=0,a=0;this.rtti=Static.Rtti_PlotMarker,this.labelFont=function(){return h},this.setLabelFont=function(e){h=e},this.value=function(){return new Misc.Point(r,a)},this.xValue=function(){return r},this.yValue=function(){return a},this.setValue=function(e,t){var n;"object"==typeof e&&(e=(n=e).x,t=n.y),e==r&&t==a||(r=e,a=t,this.plot()&&this.plot().autoRefresh())},this.setXValue=function(e){this.setValue(e,a)},this.setYValue=function(e){this.setValue(r,e)},this.setLabel=function(e){e!=u&&(u=e)},this.label=function(){return u},this.setLabelAlignment=function(e){e!==d&&(d=e)},this.labelAlignment=function(){return d},this.setLabelOrientation=function(e){e!=f&&(f=e)},this.labelOrientation=function(){return f},this.setSpacing=function(e){(e=e<0?0:e)!=p&&(p=e)},this.spacing=function(){return p},this.setSymbol=function(e){g=e},this.symbol=function(){return g},this.draw=function(e,t){var n=this.getCanvasRect(),i=new Misc.Point(e.transform(r),t.transform(a)),e=this.getContext();this.drawLines(e,n,i),g&&g.style()!==NoSymbol&&(t=g.size(),n.adjusted(-t.width,-t.height,t.width,t.height).contains(i)&&g.drawSymbol(e,i)),this.drawLabel(e,n,i)},this.drawLabel=function(e,t,n){if(""!==u){var i,r=d,a=n,s=new Misc.Size(0,0);switch(v){case VLine:d&Static.AlignTop?(a.y=t.top(),r&=~Static.AlignTop,r|=Static.AlignBottom):d&Static.AlignBottom?(a.y=t.bottom()-1,r&=~Static.AlignBottom,r|=Static.AlignTop):a.y=t.center().y;break;case HLine:d&Static.AlignLeft?(a.x=t.left(),r&=~Static.AlignLeft,r|=Static.AlignRight):d&Static.AlignRight?(a.x=t.right()-1,r&=~Static.AlignRight,r|=Static.AlignLeft):a.x=t.center().x;break;default:g&&g.style()!==NoSymbol&&(i=g.size(),s=new Misc.Size((i.width+1)/2,(i.height+1)/2))}var o=m.width/2;0==o&&(o=.5);var l=p,c=Math.max(o,s.width),n=Math.max(o,s.height),o=h.textSize(u);r&Static.AlignLeft?(a.x-=c+l,a.x-=f==Vertical?o.height:o.width):r&Static.AlignRight?(a.x+=c+l,f==Vertical&&(a.x+=o.height)):a.x-=f==Vertical?o.height/2:o.width/2,r&Static.AlignTop?(a.y-=n+l,f!=Vertical&&(a.y-=o.height)):r&Static.AlignBottom?(a.y+=n+l,f==Vertical&&(a.y+=o.width)):f==Vertical?a.y+=o.width/2:a.y-=o.height/2;l=new PaintUtil.Painter(e);l.translate(a.x,a.y),l.setFont(h);e=new Misc.Rect(0,0,o.width,o.height);f==Vertical?l.drawVerticalText(u,e.left()+.3*o.height,e.bottom()-.75*o.width):l.drawText(u,e.left(),e.bottom()-2)}},this.drawLines=function(e,t,n){var i;v!=NoLine&&((i=new PaintUtil.Painter(e)).setPen(m),v!=HLine&&v!=Cross||(e=n.y,i.drawLine(t.left(),e,t.right()-1,e)),v!=VLine&&v!=Cross||(n=n.x,i.drawLine(n,t.top(),n,t.bottom()-1)))},this.setLineStyle=function(e){e!=v&&(v=e)},this.lineStyle=function(){return v},this.setLinePen=function(e){m=e,this.plot()&&this.plot().autoRefresh()},this.linePen=function(){return m},this.setZ(30),this.toString=function(){return"[PlotMarker]"},this.legendIcon=function(e,t){if(0===t.width&&0===t.height)return null;var n,i=new Graphic(null,t.width,t.height),r=new PaintUtil.Painter(i);if(v!==NoLine&&(r.setPen(this.linePen()),v!=HLine&&v!=Cross||(n=.5*t.height,r.drawLine(0,n,t.width,n)),v!=VLine&&v!=Cross||(n=.5*t.width,r.drawLine(n,0,n,t.height))),this.symbol()){let e=t.height/2;this.symbol().style()==Ellipse&&--e,r.setPen(this.symbol().pen()),this.symbol().drawGraphicSymbol(r,new Misc.Point(t.width/2,e),t)}return r=null,i}}}define("plotMarker",["static","plotItem"],function(){});class Graphic{constructor(e,t,n){var i=e,r=t,a=n,s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("width",t),s.setAttribute("height",n),this.parent&&this.parent[0].appendChild(s),this.setParent=function(e){this.parent=e,this.parent[0].appendChild(s)},this.parent=function(){return i},this.setWidth=function(e){r=e},this.width=function(){return r},this.setHeight=function(e){a=e},this.height=function(){return a},this.svg=function(){return s},this.toString=function(){return"[Graphic]"}}}function mDrawXCrossSymbols(e,t,n){var i=n.size(),r=n.pen(),a=(n.brush(),i.width),s=i.height;e.beginPath(),e.strokeStyle=r.color,e.lineWidth=r.width;for(var o=0;o<t.length;o++){var l=t[o].x-.5*a-1,c=t[o].y-.5*s-1;e.moveTo(l,c),e.lineTo(l+a,c+s),e.moveTo(l+a,c),e.lineTo(l,c+s)}e.stroke()}function mDrawLineSymbols(e,t,n,i){var r=i.size(),a=i.pen(),s=(i.brush(),r.width),o=r.height,l=new PaintUtil.Painter(e);l.setPen(a),l.save();for(var c,u,h=0;h<n.length;h++)t&Horizontal&&(c=n[h].x-.5*s-1,u=n[h].y-1,l.drawLine(c,u,c+s,u)),t&Vertical&&(c=n[h].x-1,u=n[h].y-.5*o-1,l.drawLine(c,u,c,u+o));l.restore()}function mDrawPathSymbols(e,t,n){var i=t.length,r=n.size(),a=n.pen(),s=n.brush(),o=(r.width,r.height,new PaintUtil.Painter(e));o.setPen(a),o.setBrush(s);for(var l=0;l<i;l++){var c=t[l].x,u=t[l].y,h=n.m_path.boundingRect();o.save(),o.translate(c,u),n.m_path.data.scale=Math.min(r.width/h.width(),r.height/h.height()),n.m_path.data.rotation&&o.rotate(n.m_path.data.rotation);h=n.pinPoint();o.translate(-1*h.x,-1*h.y),o.drawPath(n.m_path),o.restore()}}function mDrawDiamondSymbols(e,t,n){var i=new PaintUtil.Painter(e);i.save(),i.setBrush(n.brush()),i.setPen(n.pen());for(var r=n.size(),a=(new Misc.Rect(new Misc.Point,n.size()),t.length),s=0;s<a;s++)i.save(),i.translate(t[s].x-1,t[s].y-1),i.rotate(45),i.drawRect(-.5*r.width,-.5*r.height,r.width,r.height),i.restore();i.restore()}function mDrawRectSymbols(e,t,n){var i=new PaintUtil.Painter(e);i.save(),i.setBrush(n.brush()),i.setPen(n.pen());for(var r=new Misc.Rect(new Misc.Point,n.size()),a=t.length,s=0;s<a;s++)r.moveCenter(t[s]),i.drawRect(r.left(),r.top(),r.width(),r.height());i.restore()}function mDrawEllipseSymbols(e,t,n){var i=new PaintUtil.Painter(e);i.save(),i.setBrush(n.brush()),i.setPen(n.pen());for(var r=Math.min(n.size().width,n.size().height)/2,a=t.length,s=0;s<a;s++)i.drawCircle(t[s].x-1,t[s].y-1,r);i.restore()}function mDrawCrossGraphicSymbol(e,t,n,i){e.setBrush(i.brush()),e.setPen(i.pen());i=new Misc.Rect(new Misc.Point,i.size());i.moveCenter(t),e.drawLine(i.left()+.5*i.width(),i.top(),i.left()+.5*i.width(),i.bottom()),e.drawLine(i.left(),i.top()+.5*i.height(),i.right(),i.top()+.5*i.height())}function mDrawXCrossGraphicSymbol(e,t,n,i){e.setBrush(i.brush()),e.setPen(i.pen());i=new Misc.Rect(new Misc.Point,i.size());i.moveCenter(t),e.drawLine(i.left(),i.top(),i.right(),i.bottom()),e.drawLine(i.right(),i.top(),i.left(),i.bottom())}function mDrawRectGraphicSymbol(e,t,n,i){e.setBrush(i.brush());i=new Misc.Rect(new Misc.Point,i.size());i.moveCenter(t),e.drawRect(i.left(),i.top(),i.width(),i.height())}function mDrawDiamondGraphicSymbol(e,t,n,i){e.setBrush(i.brush());i=new Misc.Rect(new Misc.Point,.707*i.size().width,.707*i.size().height);i.moveCenter(t),e.drawRect(i.left(),i.top(),i.width(),i.height()),e.transform({rotation:45,rotationX:t.x,rotationY:t.y})}function mDrawEllipseGraphicSymbol(e,t,n,i){e.setBrush(i.brush());i=Math.min(i.size().width-i.pen().width,i.size().height-i.pen().width)/2;e.drawCircle(t.x,t.y,i)}function mDrawPathGraphicSymbol(e,t,n,i){var r=i.pen(),a=0;r.style!==Static.NoPen&&(a=Math.max(r.width,1));r=(r=i.path().boundingRect()).adjusted(-a,-a,a,a),a=i.path().data;a.xOffset=-1*r.left(),a.yOffset=-1*r.top(),a.xCenter=(r.right()-r.left())/2,a.yCenter=(r.bottom()-r.top())/2,e.setBrush(i.brush()),e.setPen(i.pen()),a.scale=Math.min(n.width/r.width(),n.height/r.height()),e.drawPath(i.path())}define("graphic",function(){});class Symbol{constructor(e,t,n,i){var r=NoSymbol,a=new Misc.Size(-1,-1),s=new Misc.Brush("gray"),o=new Misc.Pen;this.m_path=0;var l=new Misc.Point(0,0);void 0!==i?(r=e,s=t,o=n,a=i):void 0!==n?(r=e,s=t,o=n):void 0!==t?(r=e,s=t):void 0!==e&&(r=e),this.setPinPoint=function(e){l=e},this.pinPoint=function(e){return l},this.setSize=function(e){e.isValid()&&!e.isEqual(a)&&(a=e)},this.size=function(){return a},this.setStyle=function(e){r!=e&&(r=e)},this.style=function(){return r},this.setPath=function(e){r=Path,this.m_path=e},this.path=function(){return this.m_path},this.setPen=function(e){o=e},this.pen=function(){return o},this.setBrush=function(e){s=e},this.brush=function(){return s},this.brush1=function(){return"noBrush"!==s.color},this.drawSymbols=function(e,t){t.length<=0||this.renderSymbols(e,t)},this.drawGraphicSymbol=function(e,t,n){this.renderGraphicSymbol(e,t,n)},this.drawSymbol=function(e,t){this.drawSymbols(e,[t])},this.renderSymbols=function(e,t){t.length;switch(r){case Ellipse:mDrawEllipseSymbols(e,t,this);break;case MRect:mDrawRectSymbols(e,t,this);break;case Diamond:mDrawDiamondSymbols(e,t,this);break;case Cross:mDrawLineSymbols(e,Horizontal|Vertical,t,this);break;case XCross:mDrawXCrossSymbols(e,t,this);break;case HLine:mDrawLineSymbols(e,Horizontal,t,this);break;case VLine:mDrawLineSymbols(e,Vertical,t,this);break;case Path:mDrawPathSymbols(e,t,this)}},this.renderGraphicSymbol=function(e,t,n){var i;switch(r===Cross&&r===XCross||(i=new Misc.Pen(this.pen()),this.brush1()&&(i.width/=2),e.setPen(i)),r){case Ellipse:mDrawEllipseGraphicSymbol(e,t,0,this);break;case MRect:mDrawRectGraphicSymbol(e,t,0,this);break;case Diamond:mDrawDiamondGraphicSymbol(e,t,0,this);break;case Cross:mDrawCrossGraphicSymbol(e,t,0,this);break;case XCross:mDrawXCrossGraphicSymbol(e,t,0,this);break;case HLine:case VLine:break;case Path:mDrawPathGraphicSymbol(e,t,n,this)}},this.boundingRect=function(){var e=new Misc.Rect;switch(r){case Ellipse:case MRect:case Hexagon:var t=0;o.style!=Static.NoPen&&(t=Math.max(o.width,1)),(e=new Misc.Rect(new Misc.Point,a.width+t,a.height+t)).moveCenter(new Misc.Point);break;case XCross:case Diamond:case Triangle:case UTriangle:case DTriangle:case RTriangle:case LTriangle:case Star1:case Star2:t=0;o.style!==Static.NoPen&&(t=Math.max(o.width,1)),(e=new Misc.Rect(new Misc.Point,a.width+t,a.height+t)).moveCenter(new Misc.Point);break;case Path:e=m_path.boundingRect(),console.log(e.width()),e.moveCenter(new Misc.Point);break;default:(e=new Misc.Rect(new Misc.Point,a.width,a.height)).moveCenter(new Misc.Point)}var n=new Misc.Rect;return n.setLeft(Math.floor(e.left())),n.setTop(Math.floor(e.top())),n.setRight(Math.ceil(e.right())),n.setBottom(Math.ceil(e.bottom())),n}}toString(){return"[Symbol]"}}class ArrowSymbol extends Symbol{constructor(e=0){super();this.type="arrow",this.setPen(new Misc.Pen("black")),this.setBrush(new Misc.Brush("red"));var t=new Misc.MPath;t.moveTo(13,30),t.lineTo(13,15),t.lineTo(10,15),t.lineTo(13,10),t.lineTo(16,15),t.lineTo(13,15),t.data.rotation=e,this.setPath(t),this.setPinPoint(new Misc.Point(13,10)),this.rotation=function(){return t.data.rotation},this.setRotation=function(e){t.data.rotation=e}}}class DotOnLineSymbol extends Symbol{constructor(e=0){super();this.type="dotOnLine",this.setPen(new Misc.Pen("black")),this.setBrush(new Misc.Brush("red"));var t=new Misc.MPath;t.moveTo(13,30),t.lineTo(13,15),t.addRect(new Misc.Rect(10,9,6,6)),t.data.rotation=e,this.setPath(t),this.setPinPoint(new Misc.Point(14,13)),this.setSize(new Misc.Size(6,23)),this.rotation=function(){return t.data.rotation},this.setRotation=function(e){t.data.rotation=e}}}define("symbol",["static","graphic"],function(){});class CGMarker extends PlotMarker{constructor(){super("cgMarker@12345");var i=this;class e extends Symbol{constructor(){super();this.type="arrow",this.setPen(new Misc.Pen("black",2)),this.setBrush(new Misc.Brush("red"));var e=new Misc.MPath;e.moveTo(5,10),e.lineTo(5,0),e.moveTo(0,5),e.lineTo(10,5),this.setPath(e),this.setPinPoint(new Misc.Point(6,6)),this.setSize(new Misc.Size(12,12))}}i.setSymbol(new e),i.setLabel("CG"),i.setLabelAlignment(Static.AlignCenter|Static.AlignBottom);var r=!1;Static.bind("watchEnabled",function(e,t,n){"Area below curve"===t.name()&&(i.setVisible(n),r=n)}),Static.bind("showSidebar",function(e,t,n){n&&r?i.setVisible(!0):i.setVisible(!1)}),Static.bind("currentCurveChanged",function(e,t){null!=t&&i.setAxes(t.xAxis(),t.yAxis())})}}class WatchCurveName extends Watch{constructor(){super(),this.name=function(){return"Curve name"},this.computeWatch=function(){this._value=this._curveName}}}class WatchLeftRulerPosition extends Watch{constructor(e){super(e,Static.Left);var n=this;this.name=function(){return"Left ruler position"},this.valueType="number",this.computeWatch=function(){this._rulerLeft==Number.MAX_VALUE?this._value="Invalid":(this._value=Static.adjustForDecimalPlaces(this._rulerLeft,this._curve.plot().axisDecimalPlaces(this._curve.xAxis())),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,this._curve.plot().axisPrecision(this._curve.xAxis())))},this.cb=function(){var e=n._value,t=n._rulerGroup.setPosition(0,$(this).val());e!==t?Static.trigger("positionChanged",[n._rulerGroup.ruler(0),t]):$(this).val(t)}}}class WatchRightRulerPosition extends Watch{constructor(e){super(e,Static.Right);var n=this;this.name=function(){return"Right ruler position"},this.valueType="number",this.computeWatch=function(){this._rulerLeft==Number.MAX_VALUE?this._value="Invalid":(this._value=Static.adjustForDecimalPlaces(this._rulerRight,this._curve.plot().axisDecimalPlaces(this._curve.xAxis())),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,this._curve.plot().axisPrecision(this._curve.xAxis())))},this.cb=function(){var e=n._value,t=n._rulerGroup.setPosition(1,$(this).val());e!==t?Static.trigger("positionChanged",[n._rulerGroup.ruler(1),t]):$(this).val(t)}}}class WatchBottomRulerPosition extends Watch{constructor(e){super(e,Static.Bottom);var n=this;this.valueType="number",this.name=function(){return"Bottom ruler position"},this.computeWatch=function(){this._rulerBottom==Number.MAX_VALUE?this._value="Invalid":(this._value=Static.adjustForDecimalPlaces(this._rulerBottom,this._curve.plot().axisDecimalPlaces(this._curve.xAxis())),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,this._curve.plot().axisPrecision(this._curve.yAxis())))},this.cb=function(){var e=n._value,t=n._rulerGroup.setPosition(2,$(this).val());e!==t?Static.trigger("positionChanged",[n._rulerGroup.ruler(2),t]):$(this).val(t)}}}class WatchTopRulerPosition extends Watch{constructor(e){super(e,Static.Top);var n=this;this.valueType="number",this.name=function(){return"Top ruler position"},this.computeWatch=function(){this._rulerTop==Number.MAX_VALUE?this._value="Invalid":(this._value=Static.adjustForDecimalPlaces(this._rulerTop,this._curve.plot().axisDecimalPlaces(this._curve.xAxis())),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,this._curve.plot().axisPrecision(this._curve.yAxis())))},this.cb=function(){var e=n._value,t=n._rulerGroup.setPosition(3,$(this).val());e!==t?Static.trigger("positionChanged",[n._rulerGroup.ruler(3),t]):$(this).val(t)}}}class WatchSlope extends Watch{constructor(){super(Static.Left),this.name=function(){return"Slope at left ruler"},this.computeWatch=function(){if(1!=self._magnifying&&this._rulerLeft!=this._rulerLeftPrevious){var e=this._curve.plot().axisPrecision(this._curve.yAxis()),t=this._curve.plot().axisPrecision(this._curve.xAxis()),n=this._curve.plot().axisDecimalPlaces(this._curve.yAxis()),i=this._curve.plot().axisDecimalPlaces(this._curve.xAxis()),r=this._rulerLeftPrevious=this._rulerLeft,r=Static.adjustForDecimalPlaces(r,i);if(this._rulerLeft!=Number.MAX_VALUE&&isFinite(this._rulerLeft)){if(this._curve.expandedFn&&!this._curve.expandedFn.includes("log")){var a=this._curve.expandedFn;if("z"!=this._curve.variable)for(;-1!=a.indexOf(this._curve.variable);)a=a.replace(this._curve.variable,"z");if(this._curve.coeffs)for(var s=0;s<this._curve.coeffs.length;++s)for(;-1!=a.indexOf(this._curve.coeffs[s]);)a=a.replace(this._curve.coeffs[s],this._curve.coeffsVal[s]);return this._value=math.derivative(a,"z").evaluate({z:r}),this._value=Static.adjustForDecimalPlaces(this._value,Math.max(i,n)),isNaN(this._value)&&(Static.watchUpdateError=!0),void(this._value=Static.toPrecision(this._value,Math.max(t,e)))}for(var o=this._curve.dataSize(),l=this._rulerLeft,s=0;s<o;++s)if(this._curve.sample(s).x>l){var c=this._curve.sample(s),u=this._curve.sample(s-1);return this._value=(c.y-u.y)/(c.x-u.x),this._value=Static.adjustForDecimalPlaces(this._value,Math.max(i,n)),isNaN(this._value)&&(Static.watchUpdateError=!0),void(this._value=Static.toPrecision(this._value,Math.max(t,e)))}}else this._value="Invalid"}}}}class WatchAreaBelowCurve extends Watch{constructor(){super(Static.LeftAndRight);var S,e=this,y=null;this.name=function(){return"Area below curve"},this.computeWatch=function(){if(1!=e._magnifying&&(this._rulerLeft!=this._rulerLeftPrevious||this._rulerRight!=this._rulerRightPrevious)){let e=0;var t=this._curve.plot().axisPrecision(this._curve.yAxis()),n=this._curve.plot().axisPrecision(this._curve.xAxis()),i=this._curve.plot().axisDecimalPlaces(this._curve.yAxis()),r=this._curve.plot().axisDecimalPlaces(this._curve.xAxis()),a=this._rulerLeftPrevious=this._rulerLeft,s=this._rulerRightPrevious=this._rulerRight,a=Static.adjustForDecimalPlaces(a,r),s=Static.adjustForDecimalPlaces(s,r),o=this._curve.plot().transform(this._curve.xAxis(),s)-this._curve.plot().transform(this._curve.xAxis(),a),l=Static.accuracyFactor*(s-a)/o;if(isNaN(l)||0==l)console.log(l);else if(y||((y=new CGMarker).setAxes(this._curve.xAxis(),this._curve.yAxis()),S=this._curve.plot(),y.attach(S)),a!=Number.MAX_VALUE&&isFinite(a)&&s!=Number.MAX_VALUE&&isFinite(s)){if(this._curve.expandedFn){if(v=logBaseAdjust(v=this._curve.expandedFn),"z"!=this._curve.variable)for(;-1!=v.indexOf(this._curve.variable);)v=v.replace(this._curve.variable,"z");if(this._curve.coeffs)for(var c=0;c<this._curve.coeffs.length;++c)for(;-1!=v.indexOf(this._curve.coeffs[c]);)v=v.replace(this._curve.coeffs[c],this._curve.coeffsVal[c]);this._value=math.evaluate("integrate("+v+", z,"+a+","+s+",false,"+l+")");var u=math.evaluate("integrate((("+v+")*("+v+")), z,"+a+","+s+",false,"+l+")"),h=math.evaluate("integrate(z * ("+v+"), z,"+a+","+s+",false,"+l+")");e=this._value,this._value=Static.adjustForDecimalPlaces(this._value,r+i),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,n+t);var d=Static.adjustForDecimalPlaces(u/(2*e),i);isNaN(d)&&(Static.watchUpdateError=!0),d=Static.toPrecision(d,t);var f=Static.adjustForDecimalPlaces(h/e,r);return isNaN(f)&&(Static.watchUpdateError=!0),f=Static.toPrecision(f,t),void(Static.watchCentroidWithArea?(0==this._value&&(f=d="Infinity"),this._value+=" centroid:("+f+", "+d+")",y.setValue(f,d),y.setVisible(!0)):y.setVisible(!1))}for(var p=this._curve.dataSize(),u=this._value=0,h=0,c=1;c<p;++c){var m=this._curve.sample(c),g=this._curve.sample(c-1),v=Utility.linearEquationFromPoints(g,m),b=g.x;m.x<a||g.x>s||(b<a&&(b=a),s<(m=m.x)&&(m=s),this._value+=math.evaluate("integrate("+v+", x,"+b+","+m+",false,"+l+")"),u+=math.evaluate("integrate((("+v+")*("+v+")), x,"+b+","+m+",false,"+l+")"),h+=math.evaluate("integrate(x * ("+v+"), x,"+b+","+m+",false,"+l+")"))}e=this._value,this._value=Static.adjustForDecimalPlaces(this._value,r+i),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,n+t);d=Static.adjustForDecimalPlaces(u/(2*e),i);isNaN(d)&&(Static.watchUpdateError=!0);f=Static.adjustForDecimalPlaces(h/e,r);isNaN(f)&&(Static.watchUpdateError=!0),d=Static.toPrecision(d,t),f=Static.toPrecision(f,n),Static.watchCentroidWithArea?(0==this._value&&(f=d="Infinity"),this._value+=" centroid:("+f+", "+d+")",y.setValue(f,d),y.setVisible(!0)):y.setVisible(!1)}else this._value="Invalid"}}}}class WatchVolumeOfRevolution extends Watch{constructor(){super(Static.LeftAndRight);var v=this;function b(e,t,n){var i=e*n*Math.PI*e;return i+=.5*(t-e)*n*(e+(t-e)/3)*2*Math.PI}this.name=function(){return"Volume of revolution"},this.computeWatch=function(){if(1!=v._magnifying&&(this._rulerLeft!=this._rulerLeftPrevious||this._rulerRight!=this._rulerRightPrevious)){var e=this._curve.plot().axisPrecision(this._curve.yAxis()),t=this._curve.plot().axisPrecision(this._curve.xAxis()),n=this._curve.plot().axisDecimalPlaces(this._curve.yAxis()),i=this._curve.plot().axisDecimalPlaces(this._curve.xAxis()),r=this._rulerLeftPrevious=this._rulerLeft,a=this._rulerRightPrevious=this._rulerRight,r=Static.adjustForDecimalPlaces(r,i),a=Static.adjustForDecimalPlaces(a,i),s=this._curve.plot().transform(this._curve.xAxis(),a)-this._curve.plot().transform(this._curve.xAxis(),r),s=Static.accuracyFactor*(a-r)/s;if(isNaN(s)||0==s)console.log(s);else if(this._rulerLeft!=Number.MAX_VALUE&&isFinite(this._rulerLeft)){if(this._curve.expandedFn){var o=logBaseAdjust(o=this._curve.expandedFn);if("x"!=this._curve.variable)for(;-1!=o.indexOf(this._curve.variable);)o=o.replace(this._curve.variable,"x");if(this._curve.coeffs)for(var l=0;l<this._curve.coeffs.length;++l)for(;-1!=o.indexOf(this._curve.coeffs[l]);)o=o.replace(this._curve.coeffs[l],this._curve.coeffsVal[l]);return this._value=math.evaluate("integrate("+o+", x,"+this._rulerLeft+","+this._rulerRight+",true,"+s+")"),this._value=Static.adjustForDecimalPlaces(this._value,i+2*n),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,2*t+e),void(isNaN(this._value)&&(this._value="< 1E-300"))}for(var c=this._curve.dataSize(),u=this._rulerLeft,h=this._rulerRight,d=0,f=0,p=0,l=1;l<c;++l){var m=this._curve.sample(l),g=this._curve.sample(l-1);if(!d&&m.x>u&&m.x<=h)d=b(g.y+(m.y-g.y)*(u-g.x)/(m.x-g.x),m.y,m.x-u);else if(d&&m.x<=h)p+=b(m.y,g.y,m.x-g.x);else if(m.x>h){if(g.x>=u){f=b(m.y+(m.y-g.y)*(h-m.x)/(m.x-g.x),g.y,h-g.x);break}f=b(m.y+(m.y-g.y)*(h-m.x)/(m.x-g.x),g.y+(m.y-g.y)*(u-g.x)/(m.x-g.x),h-u);break}}this._value=Static.adjustForDecimalPlaces(d+p+f,n+2*i),isNaN(this._value)&&(Static.watchUpdateError=!0),this._value=Static.toPrecision(this._value,2*e+t),isNaN(this._value)&&(this._value="< 1E-300")}else this._value="Invalid"}}}}define("basicWatch",["static","watch","plotMarker","symbol"],function(){}),function(k,P,R){"use strict";var t;k.single=(t=k({}),function(e){return t[0]=e,t}),k.fn.contextMenu=function(t,n,i){a[t]?n&&(n instanceof Array||"string"==typeof n||n.nodeType||n.jquery||(i=n,n=null)):(i=n,n=t,t="popup"),n instanceof Array&&"update"!=t&&(t="menu");var r=i;return-1<k.inArray(t,["menu","popup","close","destroy"])?(i=A.optionOtimizer(t,i),this.each(function(){var e=k(this);(r=k.extend({},k.fn.contextMenu.defaults,i)).baseTrigger||(r.baseTrigger=e),a[t].call(e,n,r)})):a[t].call(this,n,r),this},k.fn.contextMenu.defaults={triggerOn:"click",subMenuTriggerOn:"hover click",displayAround:"cursor",mouseClick:"left",verAdjust:0,horAdjust:0,top:"auto",left:"auto",closeOther:!0,containment:P,winEventClose:!0,position:"auto",closeOnClick:!0,onOpen:function(e,t){},afterOpen:function(e,t){},onClose:function(e,t){}};var a={menu:function(e,t){e=A.createMenuList(this,e,t),A.contextMenuBind.call(this,e,t,"menu")},popup:function(e,t){k(e).addClass("iw-contextMenu"),A.contextMenuBind.call(this,e,t,"popup")},update:function(g,v){var b=this;v=v||{},this.each(function(){var e=k(this),t=e.data("iw-menuData");t||(b.contextMenu("refresh"),t=e.data("iw-menuData"));var n=t.menu;if("object"==typeof g)for(var i=0;i<g.length;i++){var r=g[i].name,a=g[i].disable,s=g[i].fun,o=g[i].icon,l=g[i].img,c=g[i].title,u=g[i].className,h=n.children("li").filter(function(){return k(this).contents().filter(function(){return 3==this.nodeType}).text()==r}),d=g[i].subMenu;null!=a&&(a?h.addClass("iw-mDisable"):h.removeClass("iw-mDisable")),s&&h.unbind("click.contextMenu").bind("click.contextMenu",s),null!=c&&h.attr("title",c),null!=u&&h.attr("class",u);u=h.find(".iw-mIcon");u.length&&u.remove(),l?h.prepend('<img src="'+l+'" align="absmiddle" class="iw-mIcon" />'):o&&h.prepend('<span align="absmiddle" class="iw-mIcon '+o+'" />'),d&&h.contextMenu("update",d)}if(A.onOff(n),f=v.triggerOn){e.unbind(".contextMenu");for(var f,p=[],i=0,m=(f=f.split(" ")).length;i<m;i++)p.push(f[i]+".contextMenu");e.bind(p.join(" "),A.eventHandler)}t.option=k.extend({},t.option,v),e.data("iw-menuData",t)})},refresh:function(){var e=this.filter(function(){return!!k(this).data("iw-menuData")}).data("iw-menuData"),t=this.filter(function(){return!k(this).data("iw-menuData")});e.option.baseTrigger=this,A.contextMenuBind.call(t,e.menuSelector,e.option)},open:function(e,t){var n=(t=t||{}).event||k.Event("click");t.top&&(n.clientY=t.top),t.left&&(n.clientX=t.left),this.each(function(){A.eventHandler.call(this,n)})},close:function(){var e=this.data("iw-menuData");e&&A.closeContextMenu(e.option,this,e.menu,null)},value:function(e){var t=this.data("iw-menuData");return t[e]||(t.option?t.option[e]:null)},destroy:function(){var e=this.data("iw-menuData").menuId,t=k(".iw-contextMenu[menuId="+e+"]"),n=t.data("iw-menuData");n&&(1==n.noTrigger?t.hasClass("iw-created")?t.remove():(t.removeClass("iw-contextMenu "+e).removeAttr("menuId").removeData("iw-menuData"),t.find("li.iw-mTrigger").contextMenu("destroy")):(n.noTrigger--,t.data("iw-menuData",n)),this.unbind(".contextMenu").removeClass("iw-mTrigger").removeData("iw-menuData"))}},A={contextMenuBind:function(e,t,n){var i=this,r=k(e),a=r.data("iw-menuData");if(0!=r.length||0!=(r=i.find(e)).length){"menu"==n&&A.menuHover(r);var s,o,l=t.baseTrigger;a?(a.noTrigger++,r.data("iw-menuData",a)):(l.data("iw-menuData")?s=l.data("iw-menuData").menuId:(s=Math.ceil(1e5*Math.random()),l.data("iw-menuData",{menuId:s})),(o=r.clone()).appendTo("body"),a={menuId:s,menuWidth:o.outerWidth(!0),menuHeight:o.outerHeight(!0),noTrigger:1,trigger:i},r.data("iw-menuData",a).attr("menuId",s),o.remove()),i.addClass("iw-mTrigger").data("iw-menuData",{menuId:a.menuId,option:t,menu:r,menuSelector:e,method:n});var c=t.triggerOn;-1!=c.indexOf("hover")&&(c=c.replace("hover","mouseenter"),-1!=l.index(i)&&l.add(r).bind("mouseleave.contextMenu",function(e){0==k(e.relatedTarget).closest(".iw-contextMenu").length&&k('.iw-contextMenu[menuId="'+a.menuId+'"]').fadeOut(100)})),i.delegate("input,a,.needs-click","click",function(e){e.stopImmediatePropagation()});for(var u=[],h=0,d=(c=c.split(" ")).length;h<d;h++)u.push(c[h]+".contextMenu");i.bind(u.join(" "),A.eventHandler),r.bind("click mouseenter",function(e){e.stopPropagation()}),r.delegate("li","click",function(e){t.closeOnClick&&!k.single(this).hasClass("iw-has-submenu")&&A.closeContextMenu(t,i,r,e)})}},eventHandler:function(e){e.preventDefault();var t=k(this),n=t.data("iw-menuData"),i=n.menu,r=i.data("iw-menuData"),a=n.option,s=a.containment,o={trigger:t,menu:i},l=s==P,c=-1==a.baseTrigger.index(t);!c&&a.closeOther&&k(".iw-contextMenu").css("display","none"),i.find(".iw-mSelected").removeClass("iw-mSelected"),a.onOpen.call(this,o,e);var u,h,d,f,p,m=k(s),g=m.innerHeight(),v=m.innerWidth(),b=0,S=0,y=r.menuHeight,x=r.menuWidth,w=0,_=0,C=u=parseInt(a.verAdjust),E=h=parseInt(a.horAdjust);l||(b=m.offset().top,S=m.offset().left,"static"==m.css("position")&&m.css("position","relative")),"cursor"==a.displayAround?(w=l?e.clientX:e.clientX+k(P).scrollLeft()-S,g<(f=(_=l?e.clientY:e.clientY+k(P).scrollTop()-b)+y)&&(_-y<0?f-g<y-_?(_=g-y,u*=-1):u=_=0:(_-=y,u*=-1)),v<(p=w+x)&&(w-x<0?p-v<x-w?(w=v-x,h*=-1):h=w=0:(w-=x,h*=-1))):"trigger"==a.displayAround&&(d=t.outerHeight(!0),s=t.outerWidth(!0),r=l?t.offset().left-m.scrollLeft():t.offset().left-S,g<(f=(_=m=l?t.offset().top-m.scrollTop():t.offset().top-b)+y)&&(_-y<0?f-g<y-_?(_=g-y,u*=-1):u=_=0:(_=_-y+d,u*=-1)),v<(p=(w=r+(f=s))+x)&&(f=w-x<0?p-v<x-w?(w=v-x,h*=-1,-s):h=w=0:(w=w-x-s,h*=-1,-s)),"top"==a.position?(_=m-y,u=C,w-=f):"left"==a.position?(w=r-x,h=E):"bottom"==a.position?(_=m+d,u=C,w-=f):"right"==a.position&&(w=r+s,h=E));E={position:l||c?"fixed":"absolute",display:"inline-block",height:"",width:""};"auto"!=a.left&&(w=A.getPxSize(a.left,v)),"auto"!=a.top&&(_=A.getPxSize(a.top,g)),l||(l=t.offsetParent().offset(),c?(w=w+S-k(P).scrollLeft(),_=_+b-k(P).scrollTop()):(w-=S-l.left,_-=b-l.top)),E.left=w+h+"px",E.top=_+u+"px",i.css(E),a.afterOpen.call(this,o,e),0==t.closest(".iw-contextMenu").length&&(k(".iw-curMenu").removeClass("iw-curMenu"),i.addClass("iw-curMenu"));n={trigger:t,menu:i,option:a,method:n.method};k("html").unbind("click",A.clickEvent).click(n,A.clickEvent),k(R).unbind("keydown",A.keyEvent).keydown(n,A.keyEvent),a.winEventClose&&k(P).bind("scroll resize",n,A.scrollEvent)},scrollEvent:function(e){A.closeContextMenu(e.data.option,e.data.trigger,e.data.menu,e)},clickEvent:function(e){e.data.trigger.get(0)!==e.target&&0==k(e.target).closest(".iw-contextMenu").length&&A.closeContextMenu(e.data.option,e.data.trigger,e.data.menu,e)},keyEvent:function(t){t.preventDefault();var e,n=t.data.menu,i=t.data.option,r=t.keyCode;if(27==r&&A.closeContextMenu(i,t.data.trigger,n,t),"menu"==t.data.method){var a=k(".iw-curMenu"),s=a.children("li:not(.iw-mDisable)"),o=s.filter(".iw-mSelected"),l=s.index(o),c=function(e){A.selectMenu(a,e),e.data("iw-menuData")&&A.eventHandler.call(e[0],t)},u=function(){c(s.filter(":first"))},h=function(){c(s.filter(":last"))};switch(r){case 13:o.click();break;case 40:l==s.length-1||0==o.length?u():c(s.filter(":eq("+(l+1)+")"));break;case 38:0==l||0==o.length?h():c(s.filter(":eq("+(l-1)+")"));break;case 33:u();break;case 34:h();break;case 37:0!=(e=a.data("iw-menuData").trigger.closest(".iw-contextMenu")).length&&(a.removeClass("iw-curMenu").css("display","none"),e.addClass("iw-curMenu"));break;case 39:(e=o.data("iw-menuData"))&&(A.eventHandler.call(o[0],t),(e=e.menu).addClass("iw-curMenu"),a.removeClass("iw-curMenu"),s=(a=e).children("li:not(.iw-mDisable)"),o=s.filter(".iw-mSelected"),u())}}},closeContextMenu:function(e,t,n,i){k(R).unbind("keydown",A.keyEvent),k("html").unbind("click",A.clickEvent),k(P).unbind("scroll resize",A.scrollEvent),k(".iw-contextMenu").css("display","none"),k(R).focus(),e.onClose.call(this,{trigger:t,menu:n},i)},getPxSize:function(e,t){return isNaN(e)?-1!=e.indexOf("%")?parseInt(e)*t/100:parseInt(e):e},selectMenu:function(e,t){var n=e.find("li.iw-mSelected"),e=n.find(".iw-contextMenu");0!=e.length&&n[0]!=t[0]&&e.fadeOut(100),n.removeClass("iw-mSelected"),t.addClass("iw-mSelected")},menuHover:function(t){Date.now(),t.children("li").bind("mouseenter.contextMenu click.contextMenu",function(e){k(".iw-curMenu").removeClass("iw-curMenu"),t.addClass("iw-curMenu"),A.selectMenu(t,k(this))})},createMenuList:function(e,t,c){var u=c.baseTrigger,n=Math.floor(1e4*Math.random());if("object"==typeof t&&!t.nodeType&&!t.jquery){var h=k('<ul class="iw-contextMenu iw-created iw-cm-menu" id="iw-contextMenu'+n+'"></ul>'),i=c.zIndex||e.css("zIndex");return h.css("zIndex",i),k.each(t,function(e,t){var n=t.name,i=t.fun||function(){},r=t.subMenu,a=t.img||"",s=t.icon||"",o=t.title||"",l=t.className||"",t=t.disable,n=k('<li title="'+o+'" class="'+l+'">'+n+"</li>");a?n.prepend('<img src="'+a+'" align="absmiddle" class="iw-mIcon" />'):s&&n.prepend('<span align="absmiddle" class="iw-mIcon '+s+'" />'),t&&n.addClass("iw-mDisable"),r||n.bind("click.contextMenu",function(e){i.call(this,{trigger:u,menu:h},e)}),h.append(n),r&&(n.addClass("iw-has-submenu").append('<div class="iw-cm-arrow-right" />'),A.subMenu(n,r,u,c))}),-1==u.index(e[0])?e.append(h):(e=c.containment==P?"body":c.containment,k(e).append(h)),A.onOff(k("#iw-contextMenu"+n)),"#iw-contextMenu"+n}if(0!=k(t).length){t=k(t);return t.removeClass("iw-contextMenuCurrent").addClass("iw-contextMenu iw-cm-menu iw-contextMenu"+n).attr("menuId","iw-contextMenu"+n).css("display","none"),t.find("ul").each(function(e,t){var n=k(this),i=n.parent("li");i.append('<div class="iw-cm-arrow-right" />'),n.addClass("iw-contextMenuCurrent"),A.subMenu(i,".iw-contextMenuCurrent",u,c)}),A.onOff(k(".iw-contextMenu"+n)),".iw-contextMenu"+n}},subMenu:function(e,t,n,i){e.contextMenu("menu",t,{triggerOn:i.subMenuTriggerOn,displayAround:"trigger",position:"auto",mouseClick:"left",baseTrigger:n,containment:i.containment})},onOff:function(e){e.find(".iw-mOverlay").remove(),e.find(".iw-mDisable").each(function(){var e=k(this);e.append('<div class="iw-mOverlay"/>'),e.find(".iw-mOverlay").bind("click mouseenter",function(e){e.stopPropagation()})})},optionOtimizer:function(e,t){if(t)return"menu"==e&&(t.mouseClick||(t.mouseClick="right")),"right"==t.mouseClick&&"click"==t.triggerOn&&(t.triggerOn="contextmenu"),-1!=k.inArray(t.triggerOn,["hover","mouseenter","mouseover","mouseleave","mouseout","focusin","focusout"])&&(t.displayAround="trigger"),t}}}(jQuery,window,document),define("contextMenu",function(){});class LegendMenu{constructor(a){var u=null,e=null,h=null,t=[{name:"1",fun:function(){var e,t=h;if(t&&t.rtti==Static.Rtti_PlotSpectroCurve)return t.setPenWidth(1),void Static.trigger("penAttributeChanged",t);t&&t.rtti===Static.Rtti_PlotCurve&&((e=t.pen()).width=1,t.setPen(e),Static.trigger("penAttributeChanged",t))}},{name:"2",fun:function(){var e,t=h;if(t&&t.rtti==Static.Rtti_PlotSpectroCurve)return t.setPenWidth(2),void Static.trigger("penAttributeChanged",t);t&&t.rtti===Static.Rtti_PlotCurve&&((e=t.pen()).width=2,t.setPen(e),Static.trigger("penAttributeChanged",t))}},{name:"3",fun:function(){var e,t=h;if(t&&t.rtti==Static.Rtti_PlotSpectroCurve)return t.setPenWidth(3),void Static.trigger("penAttributeChanged",t);t&&t.rtti===Static.Rtti_PlotCurve&&((e=t.pen()).width=3,t.setPen(e),Static.trigger("penAttributeChanged",t))}},{name:"4",fun:function(){var e,t=h;if(t&&t.rtti==Static.Rtti_PlotSpectroCurve)return t.setPenWidth(4),void Static.trigger("penAttributeChanged",t);t&&t.rtti===Static.Rtti_PlotCurve&&((e=t.pen()).width=4,t.setPen(e),Static.trigger("penAttributeChanged",t))}},{name:"5",fun:function(){var e,t=h;if(t&&t.rtti==Static.Rtti_PlotSpectroCurve)return t.setPenWidth(5),void Static.trigger("penAttributeChanged",t);t&&t.rtti===Static.Rtti_PlotCurve&&((e=t.pen()).width=5,t.setPen(e),Static.trigger("penAttributeChanged",t))}}];this.getPenWidthSubMenu=function(){return t};var n=[{name:"color",fun:function(){var e=$('<input type="color" style="opacity:0;">'),t=h;t&&t.rtti===Static.Rtti_PlotCurve&&(e.val(Static.colorNameToHex(t.pen().color)),e.change(function(){var e=t.pen();e.color=$(this).val(),t.setPen(e),Static.trigger("penAttributeChanged",t)}),e.trigger("click"))}},{name:"line style",subMenu:[{name:"solid",fun:function(){var e,t=h;t&&t.rtti===Static.Rtti_PlotCurve&&((e=t.pen()).style="solid",t.setPen(e),Static.trigger("penAttributeChanged",t))}},{name:"dot",fun:function(){var e,t=h;t&&t.rtti===Static.Rtti_PlotCurve&&((e=t.pen()).style="dot",t.setPen(e),Static.trigger("penAttributeChanged",t))}},{name:"dash",fun:function(){var e,t=h;t&&t.rtti===Static.Rtti_PlotCurve&&((e=t.pen()).style="dash",t.setPen(e),Static.trigger("penAttributeChanged",t))}},{name:"dashDot",fun:function(){var e,t=h;t&&t.rtti===Static.Rtti_PlotCurve&&((e=t.pen()).style="dashDot",t.setPen(e),Static.trigger("penAttributeChanged",t))}},{name:"dashDotDot",fun:function(){var e,t=h;t&&t.rtti===Static.Rtti_PlotCurve&&((e=t.pen()).style="dashDotDot",t.setPen(e),Static.trigger("penAttributeChanged",t))}}]},{name:"pen width",subMenu:t}];this.getPenSubMenu=function(){return n};var d=[{name:"style",subMenu:[{name:"Rectangle",fun:function(){Utility.addSymbol(h,MRect)}},{name:"Cross",fun:function(){Utility.addSymbol(h,Cross)}},{name:"Diamond",fun:function(){Utility.addSymbol(h,Diamond)}},{name:"Ellipse",fun:function(){Utility.addSymbol(h,Ellipse)}},{name:"Diagonal cross",fun:function(){Utility.addSymbol(h,XCross)}},{name:"None",fun:function(){var e=h;e&&e.rtti===Static.Rtti_PlotCurve&&e.setSymbol(null)}}]}],f=[{name:"style",subMenu:[{name:"Rectangle",fun:function(){Utility.addSymbol(h,MRect)}},{name:"Cross",fun:function(){Utility.addSymbol(h,Cross)}},{name:"Diamond",fun:function(){Utility.addSymbol(h,Diamond)}},{name:"Ellipse",fun:function(){Utility.addSymbol(h,Ellipse)}},{name:"Diagonal cross",fun:function(){Utility.addSymbol(h,XCross)}},{name:"None",fun:function(){h&&Utility.addSymbol(h,NoSymbol)}}]},{name:"size",subMenu:[{name:"5x5",fun:function(){Utility.setSymbolSize(h,5)}},{name:"6x6",fun:function(){Utility.setSymbolSize(h,6)}},{name:"8x8",fun:function(){Utility.setSymbolSize(h,8)}},{name:"10x10",fun:function(){Utility.setSymbolSize(h,10)}},{name:"12x12",fun:function(){Utility.setSymbolSize(h,12)}},{name:"15x15",fun:function(){Utility.setSymbolSize(h,15)}}]},{name:"fill brush",fun:function(){var e,t,n,i=$('<input type="color" style="opacity:0;">'),r=h;!r||(e=r.symbol())&&(n=(t=e.brush()).color,i.val(Static.colorNameToHex(n="noBrush"==n?"#000000":n)),i.change(function(){$(this).remove(),t.color=$(this).val(),e.setBrush(t),a.autoRefresh(),a.updateLegend(r),Static.trigger("symbolAttributeChanged",r)}),i.trigger("click"))}},{name:"pen",subMenu:[{name:"color",fun:function(){var t,e=$('<input type="color" style="opacity:0;">'),n=h;!n||(t=n.symbol())&&(e.val(Static.colorNameToHex(t.pen().color)),e.change(function(){var e=t.pen();e.color=$(this).val(),t.setPen(e),a.autoRefresh(),a.updateLegend(n),Static.trigger("symbolAttributeChanged",n)}),e.trigger("click"))}},{name:"pen width",subMenu:[{name:"1",fun:function(){Utility.setSymbolPenWidth(h,1)}},{name:"2",fun:function(){Utility.setSymbolPenWidth(h,2)}},{name:"3",fun:function(){Utility.setSymbolPenWidth(h,3)}},{name:"4",fun:function(){Utility.setSymbolPenWidth(h,4)}},{name:"5",fun:function(){Utility.setSymbolPenWidth(h,5)}}]}]}],p=[{pos:0,name:"curve brush",img:"images/brush.png",title:"Set the fill color.",fun:function(){Utility.setCurveBrush(h,function(e){Static.trigger("curveBrushChanged",e)})}},{pos:4,name:"remove",img:"images/scissors.png",title:"Removes the curve from the plot.",fun:function(){h&&h.detach()}},{pos:5,name:"rename",img:"images/rename.png",title:"Renames the curve.",fun:function(){var e=h;e&&Utility.curveRenameDlg(e.title(),e.plot())}},{pos:7,name:"symbol",img:"images/symbol.png",title:"attach/modify curve symbol",subMenu:null},{pos:8,name:"pen",img:"images/pen.png",title:"modify/change curve pen",subMenu:n}];this.getCurve=function(){return h};var m=function(){if(null==u)return null;var e=u.text().replace(" ","");return a.findPlotCurve(e)},g=function(){};this.setMenuModificationCb=function(e){g=e};function i(){var l="";function c(e){return e.name==l}function t(e,t){for(var n=[],i=document.elementFromPoint(e,t);i&&"BODY"!=i.tagName&&"HTML"!=i.tagName;)n.push(i),i.style.display="none",i=document.elementFromPoint(e,t);for(var r=0;r<n.length;r++)n[r].style.display="";for(var a=null,r=0;r<n.length;r++)if("LABEL"===n[r].tagName){a=n[r];break}u&&void 0!==u.menuAppended&&u.menuAppended&&u.contextMenu("destroy"),u=$(a).parent();var s,o=h=m();o&&(g(),l="symbol",-1<(s=p.findIndex(c))&&(p[s].subMenu=d,o&&o.rtti==Static.Rtti_PlotCurve&&o.symbol()&&(p[s].subMenu=f)),u.menuAppended=!0,u.contextMenu(p,{triggerOn:"contextmenu",zIndex:1}))}(e=$(a.getLayout().getLegendDiv().children()[0])).on("touchstart",function(e){t(e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY)}),e.on("mousedown",function(e){!Static.isMobile&&2!=e.button||t(e.pageX,e.pageY)})}function s(){p=p.sort(function(e,t){return e.pos-t.pos})}this.modifyMenu=function(n,t){if(null==n)return _.isArray(t)?function(t){for(var n=0;n<t.length;++n)void 0===_.find(p,function(e){return e.name==t[n].name})&&p.push(t[n])}(t):null==_.find(p,function(e){return e.name==t.name})&&p.push(t),void s();var e,i,r=-1,a=_.find(p,function(e,t){return r=t,e.name==n});if(null!=a){if(_.isEmpty(t))return e=p,void(-1<(i=r)&&e.splice(i,1));a.pos=t.pos||a.pos,a.name=t.name||a.name,a.img=t.img||a.img,a.title=t.title||a.title,a.fun=t.fun||a.fun,p=s()}},a.legend()?i():Static.bind("legendInserted",function(){i(),Static.unbind("legendInserted")})}}define("legendMenu",["static","contextMenu"],function(){});class HObject{constructor(e){let n=this,t=!1,i=$("body");this.m_objectName="jObject",this.m_mouseTracking=!0,this.m_filterObjs=[],void 0!==e&&(i=e&&e instanceof HObject?e.getElement():e);let r="mousedown",a="mouseup",s="mousemove";Static.isMobile()&&(r="touchstart",a="touchend",s="touchmove"),this.mapToElement=function(t){if(i){let e=new Misc.Point;var n=i[0].getBoundingClientRect();return e.x=t.x-n.left,e.y=t.y-n.top,e}},this.setElement=function(e){i=e},this.getElement=function(){return i},this.setEnabled_1=function(e){t!=e&&(t=e,this.elementEvent(t),t&&Static.trigger("enabled"))},this.event=function(e){return!0},this.elementEventOnCb=function(t){if(!n.m_filterObjs.length)return n.event(t);n.m_filterObjs.forEach(function(e){if(!e.eventFilter(n,t))return n.event(t)})},this.elementEvent=function(e){if(this instanceof HObject){let n=this;e?(n.getElement().on(r+" "+a+" "+s+" mouseenter mouseleave mousewheel",function(e){n.elementEventOnCb(e)}),$("body").on("keydown keyup",function(t){return n.m_filterObjs.length?void n.m_filterObjs.forEach(function(e){if(!e.eventFilter(n,t))return n.event(t)}):n.event(t)})):(n.getElement().off(r+" "+a+" "+s+" mouseenter mouseleave mousewheel"),$("body").off("keydown keyup"))}},this.installEventFilter=function(e){this.m_filterObjs.push(e)},this.removeEventFilter=function(e){e=this.m_filterObjs.indexOf(e);-1<e&&this.m_filterObjs.splice(e,1)},this.hasSameElement=function(e){return this.getElement()==e.getElement()},this.isEnabled=function(){return t},this.toString=function(){return"[HObject]"}}eventFilter(e,t){console.log("eventFilter() called")}setMouseTracking(e){if(this.getElement()&&e){let t=this;this.getElement().on("mousemove touchmove",function(e){t.elementEventOnCb(e)}),this.m_mouseTracking=!0}else this.getElement().off("mousemove touchmove"),this.m_mouseTracking=!1}hasMouseTracking(){return this.m_mouseTracking}setObjectName(e){this.m_objectName=e}objectName(){return this.m_objectName}isWidget(){return"[Widget]"==this.toString()}}define("hObject",function(){});class Widget extends HObject{constructor(e){super(e);let t=!0,n=0;var i=new Misc.Font(12);let r=$("<canvas />").attr({style:"position: absolute; background-color: transparent"});this.getElement()&&this.getElement().append(r),this.clearCanvas=function(){let e=this.getContext();e&&e.clearRect(0,0,r[0].width,r[0].height)},this.getContext=function(){return this.getElement()?(r[0].width=parseFloat(this.getElement().css("width")),r[0].height=parseFloat(this.getElement().css("height")),r[0].getContext("2d")):null},this.width=function(){return r[0].width},this.height=function(){return r[0].height},this.setCanvasParent=function(e){this.getElement().append(r)},this.getCanvas=function(){return r},this.contentsRect=function(){let e=this.getElement();return new Misc.Rect(0,0,parseFloat(e.css("width")),parseFloat(e.css("height")))},this.setVisible=function(e){t=e||void 0===e?(this.getCanvas().show(),!0):(this.getCanvas().hide(),!1)},this.hide=function(){this.setVisible(!1)},this.show=function(){this.setVisible(!0)},this.font=function(){return i},this.setFont=function(e){i=e},this.isVisible=function(){return t},this.setZ=function(e){n!==e&&(n=e,r&&r.css("zIndex",n))},this.getZ=function(e){return n},this.toString=function(){return"[Widget]"}}setElement(e){this.super(e),this.setCanvasParent(e)}}define("widget",["static","hObject"],function(){});class WidgetOverlay extends Widget{constructor(e){super(e);this.draw=function(){var e=new PaintUtil.Painter(this);this.drawOverlay(e)},this.toString=function(){return"[WidgetOverlay]"}}updateOverlay(){this.draw()}drawOverlay(e){console.warn("drawOverlay() not reimplemented")}}define("widgetOverlay",["static","widget"],function(){});class MousePattern{constructor(e,t){this.button=Static.NoButton,this.modifiers=Static.NoModifier,void 0!==e&&(this.button=e),void 0!==t&&(this.modifiers=t)}}function KeyPattern(e,t){this.key=Static.Key_unknown,this.modifiers=Static.NoModifier,void 0!==e&&(this.key=e),void 0!==t&&(this.modifiers=t)}class EventPattern extends HObject{constructor(e){super(e);const n=Enum.MousePatternCode.MouseSelect1,i=Enum.MousePatternCode.MouseSelect2,r=Enum.MousePatternCode.MouseSelect3,a=Enum.MousePatternCode.MouseSelect4,s=Enum.MousePatternCode.MouseSelect5,o=Enum.MousePatternCode.MouseSelect6,l=Enum.MousePatternCode.MousePatternCount;var c=[],u=[];this.initMousePattern=function(e){for(var t=0;t<l;++t)c.push(new MousePattern);switch(e){case 1:this.setMousePattern(n,Static.LeftButton),this.setMousePattern(i,Static.LeftButton,Static.ControlModifier),this.setMousePattern(r,Static.LeftButton,Static.AltModifier);break;case 2:this.setMousePattern(n,Static.LeftButton),this.setMousePattern(i,Static.RightButton),this.setMousePattern(r,Static.LeftButton,Static.AltModifier);break;default:this.setMousePattern(n,Static.LeftButton),this.setMousePattern(i,Static.RightButton),this.setMousePattern(r,Static.MidButton)}this.setMousePattern(a,c[n].button,c[n].modifiers|Static.ShiftModifier),this.setMousePattern(s,c[i].button,c[i].modifiers|Static.ShiftModifier),this.setMousePattern(o,c[r].button,c[r].modifiers|Static.ShiftModifier)},this.initKeyPattern=function(){for(var e=0;e<Enum.KeyPatternCode.KeyPatternCount;++e)u.push(new KeyPattern);this.setKeyPattern(Enum.KeyPatternCode.KeySelect1,Static.Key_Return),this.setKeyPattern(Enum.KeyPatternCode.KeySelect2,Static.Key_Space),this.setKeyPattern(Enum.KeyPatternCode.KeyAbort,Static.Key_Escape),this.setKeyPattern(Enum.KeyPatternCode.KeyLeft,Static.Key_Left),this.setKeyPattern(Enum.KeyPatternCode.KeyRight,Static.Key_Right),this.setKeyPattern(Enum.KeyPatternCode.KeyUp,Static.Key_Up),this.setKeyPattern(Enum.KeyPatternCode.KeyDown,Static.Key_Down),this.setKeyPattern(Enum.KeyPatternCode.KeyRedo,Static.Key_Plus),this.setKeyPattern(Enum.KeyPatternCode.KeyUndo,Static.Key_Minus),this.setKeyPattern(Enum.KeyPatternCode.KeyHome,Static.Key_Escape)},this.setMousePattern=function(e,t,n){null==t?c=e:(null==n&&(n=Static.NoModifier),0<=e&&e<l&&(c[e].button=t,c[e].modifiers=n))},this.setKeyPattern=function(e,t,n){null==t?c=e:(null==n&&(n=Static.NoModifier),0<=e&&e<Enum.KeyPatternCode.KeyPatternCount&&(u[e].key=t,u[e].modifiers=n))},this.mouseMatch=function(e,t){return 0<=e&&e<l&&this.mouseMatch2(c[e],t)},this.mouseMatch2=function(e,t){return null!=t&&(e.button==Utility.button(t)&&e.modifiers==Utility.modifiers(t))},this.keyPattern=function(){return u},this.key=function(e){return null!=e&&e.keyCode},this.keyMatch=function(e,t){return 0<=e&&e<Enum.KeyPatternCode.KeyPatternCount&&this.keyMatch2(u[e],t)},this.keyMatch2=function(e,t){return null!=t&&(e.key==this.key(t)&&e.modifiers==Utility.modifiers(t))},this.initKeyPattern(),this.initMousePattern(3)}}define("eventpattern",function(){});class PickerMachine{constructor(e){Static.Begin=0,Static.Append=1,Static.Move=2,Static.Remove=3,Static.End=4;var t=e,n=0;this.selectionType=function(){return t},this.state=function(){return n},this.setState=function(e){n=e},this.reset=function(){this.setState(0)}}}class PickerTrackerMachine extends PickerMachine{constructor(){super(Static.NoSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mouseenter":case"mousemove":case"touchmove":0==this.state()?(n.push(Static.Begin),n.push(Static.Append),this.setState(1)):n.push(Static.Move);break;case"mouseleave":n.push(Static.Remove),n.push(Static.End),this.setState(0)}return n}}}class PickerClickPointMachine extends PickerMachine{constructor(){super(Static.PointSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mousedown":case"touchstart":e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t)&&(n.push(Static.Begin),n.push(Static.Append),n.push(Static.End));break;case"keydown":e.keyMatch(Enum.KeyPatternCode.KeySelect1,t)&&(n.push(Static.Begin),n.push(Static.Append),n.push(Static.End))}return n}}toString(){return"[PickerClickPointMachine]"}}class PickerDragPointMachine extends PickerMachine{constructor(){super(Static.PointSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mousedown":case"touchstart":e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t)&&0==this.state()&&(n.push(Static.Begin),n.push(Static.Append),this.setState(1));break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&n.push(Static.Move);break;case"mouseup":case"touchend":0!=this.state()&&(n.push(Static.End),this.setState(0));break;case"keydown":e.keyMatch(Enum.KeyPatternCode.KeySelect1,t)&&(0==this.state()?(n.push(Static.Begin),n.push(Static.Append),this.setState(1)):(n.push(Static.End),this.setState(0)))}return n}}toString(){return"[PickerDragPointMachine]"}}class PickerClickRectMachine extends PickerMachine{constructor(){super(Static.RectSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mousedown":case"touchstart":if(e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t))switch(this.state()){case 0:n.push(Static.Begin),n.push(Static.Append),this.setState(1);break;case 1:break;default:n.push(Static.End),this.setState(0)}break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&n.push(Static.Move);break;case"mouseup":case"touchend":e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t)&&1==this.state()&&(n.push(Static.Append),this.setState(2));break;case"keydown":e.keyMatch(Enum.KeyPatternCode.KeySelect1,t)&&(0==this.state()?(n.push(Static.Begin),n.push(Static.Append),this.setState(1)):1==this.state()?(n.push(Static.Append),this.setState(2)):2==this.state()&&(n.push(Static.End),this.setState(0)))}return n}}toString(){return"[PickerClickRectMachine]"}}class PickerDragRectMachine extends PickerMachine{constructor(){super(Static.RectSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mousedown":case"touchstart":"touchstart"!=t.type&&!e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t)||0!=this.state()||(n.push(Static.Begin),n.push(Static.Append),n.push(Static.Append),this.setState(2));break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&n.push(Static.Move);break;case"mouseup":case"touchend":2==this.state()&&(n.push(Static.End),this.setState(0));break;case"keydown":e.keyMatch(Enum.KeyPatternCode.KeySelect1,t)&&(0==this.state()?(n.push(Static.Begin),n.push(Static.Append),n.push(Static.Append),this.setState(2)):(n.push(Static.End),this.setState(0)))}return n}}toString(){return"[PickerDragRectMachine]"}}class PickerPolygonMachine extends PickerMachine{constructor(){super(Static.PolygonSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mousedown":case"touchstart":e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t)&&(0==this.state()?(n.push(Static.Begin),n.push(Static.Append),n.push(Static.Append),this.setState(1)):n.push(Static.Append)),e.mouseMatch(Enum.MousePatternCode.MouseSelect2,t)&&1==this.state()&&(n.push(Static.End),this.setState(0));break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&n.push(Static.Move);break;case"keydown":var i=t;e.keyMatch(Enum.KeyPatternCode.KeySelect1,i)?0==this.state()?(n.push(Static.Begin),n.push(Static.Append),n.push(Static.Append),this.setState(1)):n.push(Static.Append):e.keyMatch(Enum.KeyPatternCode.KeySelect2,i)&&1==this.state()&&(n.push(Static.End),this.setState(0))}return n}}toString(){return"[PickerPolygonMachine]"}}class PickerDragLineMachine extends PickerMachine{constructor(){super(Static.PolygonSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mousedown":case"touchstart":e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t)&&0==this.state()&&(n.push(Static.Begin),n.push(Static.Append),n.push(Static.Append),this.setState(1));break;case"keydown":e.keyMatch(Enum.KeyPatternCode.KeySelect1,t)&&(0==this.state()?(n.push(Static.Begin),n.push(Static.Append),n.push(Static.Append),this.setState(1)):(n.push(Static.End),this.setState(0)));break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&n.push(Static.Move);break;case"mouseup":case"touchend":0!=this.state()&&(n.push(Static.End),this.setState(0))}return n}}toString(){return"[PickerDragLineMachine]"}}define("pickermachine",["static","eventpattern"],function(){});class PickerRubberband extends WidgetOverlay{constructor(e,t){super(t),this.setZ(30);var n=e;this.drawOverlay=function(e){e.setPen(n.rubberBandPen()),e.setBrush(Static.NoBrush),n.drawRubberBand(e)}}}class PickerTracker extends WidgetOverlay{constructor(e,t){super(t),this.setZ(30);var n=e;this.drawOverlay=function(e){n.trackerOverlay().clearCanvas(),e.save(),e.setPen(n.trackerPen()),n.drawTracker(e),e.restore()}}}function PickerPrivateData(){this.enabled=!1,this.stateMachine=null,this.resizeMode,this.rubberBand=Static.NoRubberBand,this.rubberBandPen=new Misc.Pen("red",1,"solid"),this.trackerMode=Static.AlwaysOff,this.trackerPen=new Misc.Pen("red"),this.trackerFont,this.pickedPoints=[],this.isActive=!1,this.trackerPosition=new Misc.Point,this.mouseTracking=!1,this.rubberBandOverlay=null,this.trackerOverlay=null}class Picker extends EventPattern{constructor(e,t,n){super(n);const i=this;var s;let r="mousedown",a="mouseup",o="mousemove";Static.isMobile()&&(r="touchstart",a="touchend",o="touchmove");var l=[],c=null;void 0!==n&&"[Widget]"==n.toString()&&(c=n),this.init=function(e,t,n){(s=new PickerPrivateData).rubberBand=t,e&&(s.trackerFont=new Misc.Font(12),this.setEnabled_1(!0)),this.setTrackerMode(n),Picker.pickers.push(this)},this.getPickerData=function(){return s},this.setStateMachine=function(e){s.stateMachine!=e&&(this.reset(),s.stateMachine=e,s.stateMachine&&s.stateMachine.reset())},this.stateMachine=function(){return s.stateMachine},this.parentWidget=function(){return c},this.setRubberBand=function(e){s.rubberBand=e},this.rubberBand=function(){return s.rubberBand},this.setTrackerMode=function(e){s.trackerMode!=e&&(s.trackerMode=e)},this.trackerMode=function(){return s.trackerMode},this.setEnabled=function(e){var t;s.enabled!=e&&(s.enabled=e,(t=i.parentWidget())&&(e?t.installEventFilter(this):t.removeEventFilter(this)),i.updateDisplay())},this.isEnabled=function(){return s.enabled},this.setTrackerFont=function(e){e!=s.trackerFont&&(s.trackerFont=e,this.updateDisplay())},this.trackerFont=function(){return s.trackerFont},this.setTrackerPen=function(e){e!=s.trackerPen&&(s.trackerPen=e,this.updateDisplay())},this.trackerPen=function(){return s.trackerPen},this.setRubberBandPen=function(e){e!=s.rubberBandPen&&(s.rubberBandPen=e,this.updateDisplay())},this.rubberBandPen=function(){return s.rubberBandPen},this.drawRubberBand=function(e){if(this.isActive()&&this.rubberBand()!=Static.NoRubberBand&&this.rubberBandPen().style!=Static.NoPen){var t=this.adjustedPoints(s.pickedPoints),n=Static.NoSelection;switch(n=s.stateMachine?s.stateMachine.selectionType():n){case Static.NoSelection:case Static.PointSelection:if(t.length<1)return;var i=t[0],r=this.pickArea();switch(this.rubberBand()){case Static.VLineRubberBand:e.drawLine(i.x,r.top(),i.x,r.bottom());break;case Static.HLineRubberBand:e.drawLine(r.left(),i.y,r.right(),i.y);break;case Static.CrossRubberBand:e.drawLine(i.x,r.top(),i.x,r.bottom()),e.drawLine(r.left(),i.y,r.right(),i.y)}break;case Static.RectSelection:if(t.length<2)return;var a=(a=new Misc.Rect(t[0],t[t.length-1])).normalized();switch(this.rubberBand()){case Static.EllipseRubberBand:e.drawEllipse(a);break;case Static.RectRubberBand:e.drawRect(a)}break;case Static.PolygonSelection:if(t.length<2)return;this.rubberBand()==Static.PolygonRubberBand&&e.drawPolyline(t)}}},this.drawTracker=function(e){var t,n=this.trackerRect(this.trackerFont());null===n||""!==(t=this.trackerText(s.trackerPosition))&&(e.setFont(s.trackerFont),e.drawText(t,n.left(),n.bottom()))},this.adjustedPoints=function(e){return e},this.selection=function(){return this.adjustedPoints(s.pickedPoints)},this.trackerPosition=function(){return s.trackerPosition},this.trackerRect=function(e){if(this.trackerMode()===Static.AlwaysOff)return null;if(this.trackerPosition().x<0||this.trackerPosition().y<0)return null;var t=this.trackerText(this.trackerPosition());if(""==t)return null;var n=e.textSize(t),e=new Misc.Rect(new Misc.Point,n.width,n.height),t=this.trackerPosition(),n=0;1<l.length.length&&this.rubberBand()!=Static.NoRubberBand?(n|=t.x>=(i=l[0]).x?Static.AlignRight:Static.AlignLeft,n|=t.y>i.y?Static.AlignBottom:Static.AlignTop):n=Static.AlignTop|Static.AlignRight;var i=t.x;n&Static.AlignLeft?i-=e.width()+5:n&Static.AlignRight&&(i+=5);t=t.y;n&Static.AlignBottom?t+=5:n&Static.AlignTop&&(t-=e.height()+5),e.moveTopLeft(new Misc.Point(i,t));n=new Misc.Rect(new Misc.Point,this.trackerOverlay().width(),this.trackerOverlay().height()),i=Math.min(e.right(),n.right()-5),t=Math.min(e.bottom(),n.bottom()-5);e.moveBottomRight(new Misc.Point(i,t));t=Math.max(e.left(),n.left()+5),n=Math.max(e.top(),n.top()+5);return e.moveTopLeft(new Misc.Point(t,n)),e},this.eventFilter=function(e,t){if(!this.isEnabled())return!1;if(e&&e==this.parentWidget())switch(t.type){case"mouseenter":this.widgetEnterEvent(t);break;case"mouseleave":this.widgetLeaveEvent(t);break;case r:this.widgetMousePressEvent(t);break;case a:this.widgetMouseReleaseEvent(t);break;case"dblclick":this.widgetMouseDoubleClickEvent(t);break;case o:this.widgetMouseMoveEvent(t);break;case"keydown":this.widgetKeyPressEvent(t);break;case"keyup":this.widgetKeyReleaseEvent(t);break;case"mousewheel":this.widgetWheelEvent(t)}return!1},this.transition=function(e){if(s.stateMachine){var t=s.stateMachine.transition(this,e);switch(e.type){case r:case a:case o:var n=new Misc.Point(e.clientX,e.clientY);Static.isMobile()&&(n=new Misc.Point(e.originalEvent.changedTouches[0].clientX,e.originalEvent.changedTouches[0].clientY)),n=this.parentWidget().mapToElement(n);break;default:n=this.parentWidget().mapToElement(new Misc.Point(0,0))}for(var i=0;i<t.length;i++)switch(t[i]){case Static.Begin:this.begin();break;case Static.Append:this.append(n);break;case Static.Move:this.move(n);break;case Static.Remove:this.remove();break;case Static.End:this.end()}}},this.reset=function(){s.stateMachine&&s.stateMachine.reset(),this.isActive()&&this.end(!1)},this.append=function(e){s.isActive&&(s.pickedPoints.push(e),this.updateDisplay(),Static.trigger("appended",e))},this.move=function(e){var t;!s.isActive||0<=(t=s.pickedPoints.length-1)&&s.pickedPoints[t]!=e&&(s.pickedPoints[t]=e,this.updateDisplay(),Static.trigger("moved",e))},this.remove=function(){var e;s.isActive&&0<s.pickedPoints.length-1&&(e=s.pickedPoints.pop(),this.updateDisplay(),Static.trigger("removed",e))},this.accept=function(e){return!0},this.isActive=function(){return s.isActive},this.pickedPoints=function(){return s.pickedPoints},this.setMouseTracking=function(e){var t=this.parentWidget();t&&(e?(s.mouseTracking=t.hasMouseTracking(),t.setMouseTracking(!0)):t.setMouseTracking(s.mouseTracking))},this.pickArea=function(){var e=this.parentWidget();return e?e.contentsRect():null},this.updateDisplay=function(){var e=this.parentWidget(),t=!1,n=!1;e&&e.isVisible()&&s.enabled&&(this.rubberBand()!==Static.NoRubberBand&&this.isActive()&&this.rubberBandPen().style!==Static.NoPen&&(t=!0),(this.trackerMode()==Static.AlwaysOn||this.trackerMode()==Static.ActiveOnly&&this.isActive())&&this.trackerPen()!=Static.NoPen&&(n=!0));var i=s.rubberBandOverlay;t?(null==i&&((i=new PickerRubberband(this,e)).setObjectName("PickerRubberBand"),s.rubberBandOverlay=i),i.updateOverlay()):i&&(s.rubberBandOverlay.getCanvas().hide(),s.rubberBandOverlay.getCanvas(),s.rubberBandOverlay=null);i=s.trackerOverlay;n?(null==i&&((i=new PickerTracker(this,e)).setObjectName("PickerTracker"),s.trackerOverlay=i),i.setFont(s.trackerFont),i.updateOverlay()):i&&(s.trackerOverlay.getCanvas().hide(),s.trackerOverlay.getCanvas(),s.trackerOverlay=null)},this.rubberBandOverlay=function(){return s.rubberBandOverlay},this.trackerOverlay=function(){return s.trackerOverlay},null==e&&null==t?this.init(n,Static.NoRubberBand,Static.AlwaysOff):this.init(n,e,t)}widgetEnterEvent(e){this.transition(e)}widgetLeaveEvent(e){this.transition(e),this.getPickerData().trackerPosition=new Misc.Point(-1,-1),this.isActive()||this.updateDisplay()}widgetKeyReleaseEvent(e){this.transition(e)}widgetWheelEvent(e){var t=new Misc.Point(e.clientX,e.clientY);this.pickArea().contains(t)?this.getPickerData().trackerPosition=t:this.getPickerData().trackerPosition=new Misc.Point(-1,-1),this.updateDisplay(),this.transition(e)}widgetMouseDoubleClickEvent(e){this.transition(e)}widgetMouseMoveEvent(e){var t=new Misc.Point(e.clientX,e.clientY);Static.isMobile()&&(t=new Misc.Point(e.originalEvent.changedTouches[0].clientX,e.originalEvent.changedTouches[0].clientY)),t=this.mapToElement(t),this.pickArea().contains(t)?this.getPickerData().trackerPosition=t:this.getPickerData().trackerPosition=new Misc.Point(-1,-1),this.isActive()||this.updateDisplay(),this.transition(e)}widgetMousePressEvent(e){this.transition(e)}widgetKeyPressEvent(e){var t,n=0,i=0;this.keyMatch(Enum.KeyPatternCode.KeyLeft,e)?n=-1:this.keyMatch(Enum.KeyPatternCode.KeyRight,e)?n=1:this.keyMatch(Enum.KeyPatternCode.KeyUp,e)?i=-1:this.keyMatch(Enum.KeyPatternCode.KeyDown,e)?i=1:this.keyMatch(Enum.KeyPatternCode.KeyAbort,e)?this.reset():this.transition(e),0===n&&0===i||(t=pickArea(),n=(e=this.parentWidget().mapToElement(new Misc.Point(clientX,clientY))).x+n,n=Math.max(t.left(),n),n=Math.min(t.right(),n),i=e.y+i,i=Math.max(t.top(),i),Math.min(t.bottom(),i))}widgetMouseReleaseEvent(e){this.transition(e)}end(e){var t=this.getPickerData();return t.isActive?(this.setMouseTracking(!1),t.isActive=!1,Static.trigger("activated",!1),this.trackerMode()==Static.ActiveOnly&&(t.trackerPosition=new Misc.Point(-1,-1)),(e=e&&this.accept(t.pickedPoints))?Static.trigger("selected",t.pickedPoints):t.pickedPoints=[],this.updateDisplay()):e=!1,e}begin(){var e,t=this.getPickerData();t&&(t.isActive||(t.pickedPoints=[],t.isActive=!0,Static.trigger("activated",!0),this.trackerMode()!==Static.AlwaysOff&&(!(t.trackerPosition.x<0||t.trackerPosition.y<0)||(e=this.parentWidget())&&(t.trackerPosition=e.mapToElement(new Misc.Point(0,0)))),this.updateDisplay(),this.setMouseTracking(!0)))}trackerText(e){var t;switch(this.rubberBand()){case Static.HLineRubberBand:t=e.y.toString();break;case Static.VLineRubberBand:t=e.x.toString();break;default:t=e.x.toString()+", "+e.y.toString()}return t}}Picker.pickers=[],define("picker",["static","widgetOverlay","pickermachine"],function(){});class PlotPicker extends Picker{constructor(e,t,n,i,r){var a=0;"number"!=typeof e&&(r=e,t=e=-1,n=Static.NoRubberBand,i=Static.AlwaysOff,a=1),"number"!=typeof n&&(r=n,n=Static.NoRubberBand,i=Static.AlwaysOff,a=2),super(n,i,r=r instanceof Plot?r.getCentralWidget():r),this.d_xAxis=-1,this.d_yAxis=-1,1==a?(a=this.plot(),e=xBottom,a&&!a.axisEnabled(xBottom)&&a.axisEnabled(xTop)&&(e=xTop),t=yLeft,a&&!a.axisEnabled(yLeft)&&a.axisEnabled(yRight)&&(t=yRight),this.setAxis(e,t)):(this.d_xAxis=e,this.d_yAxis=t),this.setEnabled(!0),r&&r.setEnabled_1(!0)}setAxis(e,t){this.plot()&&(e==this.d_xAxis&&t==this.d_yAxis||(this.d_xAxis=e,this.d_yAxis=t))}xAxis(){return this.d_xAxis}yAxis(){return this.d_yAxis}plot(){var e=this.parentWidget();return e?e.plot:null}canvas(){return this.parentWidget()}scaleRect(){var e,t,n=null;return this.plot()&&(e=this.plot().axisScaleDiv(this.xAxis()),t=this.plot().axisScaleDiv(this.yAxis()),n=(n=new Misc.Rect(e.lowerBound(),t.lowerBound(),e.range(),t.range())).normalized()),n}invTransform(e){var t=this.plot().canvasMap(this.d_xAxis),n=this.plot().canvasMap(this.d_yAxis);if(_.has(e,"x")&&_.has(e,"y")){var i=e;return new Misc.Point(t.invTransform(i.x),n.invTransform(i.y))}return ScaleMap.invTransform_Rect(t,n,e)}transform(e){var t=this.plot().canvasMap(this.d_xAxis),n=this.plot().canvasMap(this.d_yAxis);if(void 0===e.x)return Static.mTransform(t,n,e);return new Misc.Point(t.transform(e.x),n.transform(e.y))}trackerText(e){var t;switch(e=this.invTransform(e),this.rubberBand()){case Static.HLineRubberBand:t=e.y.toString();break;case Static.VLineRubberBand:t=e.x.toString();break;default:t=e.x.toString()+", "+e.y.toString()}return t}move(e){super.method(move(e)),Static.trigger("moved",invTransform(e))}append(e){super.method(append(e)),Static.trigger("appended",invTransform(e))}end(e=!0){if(!(e=super.end(e)))return!1;if(!this.plot())return!1;var t=this.selection();if(0==t.length)return!1;var n,e=Static.NoSelection;switch(e=this.stateMachine()?this.stateMachine().selectionType():e){case Static.PointSelection:var i=this.invTransform(t[0]);Static.trigger("selected",i);break;case Static.RectSelection:2<=t.length&&(n=t[0],i=t[t.length-1],i=new Misc.Rect(n,i).normalized(),Static.trigger("selected",this.invTransform(i)));break;case Static.PolygonSelection:for(var r=[],a=0;a<t.length;a++)r.push(this.invTransform(t[a]));Static.trigger("selected",r)}return!0}}define("plotpicker",["static","picker"],function(){});class MPicker extends PlotPicker{constructor(e,t,n){super(e);var i=this;this._rulerPos=t,this._ruler=n;var r,a=null,s=null,o=null,l="",c=null,u=!1,h=0;this._ruler&&this._ruler.setAxes(this.xAxis(),this.yAxis());var d=Static.FullTrackingText;this.plot()&&(l=this.plot().cursor()),this.preventDragging=function(e){u=e},this.controlFlag=function(e){return Boolean(h&e)},this.setControlFlag=function(e,t){t?h|=e:h&=~e},this.prohibit=function(){a&&this.controlFlag(Static.ZoomerSearch)&&(this.setControlFlag(Static.ZoomEnabled,a.isEnabled()),this.controlFlag(Static.ZoomEnabled)&&a.setEnabled(!1)),s&&this.controlFlag(Static.PannerSearch)&&(this.setControlFlag(Static.PanEnabled,s.isEnabled()),this.controlFlag(Static.PanEnabled)&&s.setEnabled(!1)),o&&this.controlFlag(Static.MagnifierSearch)&&(this.setControlFlag(Static.MagnifierEnabled,o.isEnabled()),this.controlFlag(Static.MagnifierEnabled)&&o.setEnabled(!1))},this.restore=function(){a&&this.controlFlag(Static.ZoomEnabled)&&(a.setEnabled(!0),this.setControlFlag(Static.ZoomEnabled,!1)),s&&this.controlFlag(Static.PanEnabled)&&(s.setEnabled(!0),this.setControlFlag(Static.PanEnabled,!1)),o&&this.controlFlag(Static.MagnifierEnabled)&&(o.setEnabled(!0),this.setControlFlag(Static.MagnifierEnabled,!1))},this.setDragCursor=function(){u||this.controlFlag(Static.DragCursor)||e.cursor()==l&&(c=e.cursor(),r=this._dragCursorShape,e.setCursor(r),this.setControlFlag(Static.DragCursor,!0),this.prohibit(),Static.trigger("rulerSelected",i._ruler))},this.clearDragCursor=function(){this.controlFlag(Static.DragCursor)&&(this._ruler.plot().setCursor(c),this.setControlFlag(Static.DragCursor,!1),this.restore(),Static.trigger("rulerDeselected",i._ruler))},this.setTrackingTextStyle=function(e){d=e},this.trackerText=function(e){if(this._ruler.lock()||d==Static.NoTrackingText||!this.controlFlag(Static.LeftButtonDown)&&!this.controlFlag(Static.ZoomEnabled))return"";if(d!=Static.FullTrackingText)return d==Static.PartialTrackingText?this._rulerPos:"";var t=this.axisTitle();return t.length?t+"="+this._rulerPos:this._rulerPos},this.panningFinished=function(){this.setControlFlag(Static.PanningInProgress,!1)},this.panningStarted=function(){this.setControlFlag(Static.PanningInProgress,!0)},e.getLayout().getPlotDiv().parent().on("mouseup",function(){Static.LeftButtonDown&&(Static.isMobile()&&i.clearDragCursor(),i.setControlFlag(Static.LeftButtonDown,!1))}),this.initMagnifier=function(){this.controlFlag(Static.MagnifierSearch)&&!o&&e.magnifier&&(o=e.magnifier)},this.initZoomer=function(){!this.controlFlag(Static.ZoomerSearch)&&a||e.zoomer&&(a=e.zoomer)},this.initPanner=function(){!this.controlFlag(Static.PannerSearch)&&s||e.panner&&(s=e.panner)},this.doMouseReleaseEvent=function(e){this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)&&(e.button==Static.LeftButton&&(this.controlFlag(Static.LeftButtonDown)&&Static.trigger("positionChanged",[this._ruler,this._rulerPos]),this.setControlFlag(Static.LeftButtonDown,!1)),Static.isMobile()&&(this.controlFlag(Static.LeftButtonDown)&&Static.trigger("positionChanged",[this._ruler,this._rulerPos]),this.setControlFlag(Static.LeftButtonDown,!1)))}}widgetMouseReleaseEvent(e){this.doMouseReleaseEvent(e),super.widgetMouseReleaseEvent(e)}widgetLeaveEvent(e){this.doMouseReleaseEvent(e),super.widgetMouseReleaseEvent(e)}}class PickerV extends MPicker{constructor(e,t,n){super(e,t,n),this._dragCursorShape="w-resize",this.axisTitle=function(){return this._ruler.plot().axisTitle(this.xAxis())}}widgetMousePressEvent(e){if(e.preventDefault(),this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)){if(2==e.button)return this.controlFlag(Static.DragCursor),!0;if(Static.isMobile()){Static.isMobile()&&this.clearDragCursor();var t=this._ruler.plot().transform(this.xAxis(),this._rulerPos),n=e.originalEvent.touches[0].clientX,i=e.originalEvent.touches[0].clientY,i=this.mapToElement(new Misc.Point(n,i)).x;!this.controlFlag(Static.LeftButtonDown)&&i<t+12&&t-12<i&&(this.setDragCursor(),this.setControlFlag(Static.LeftButtonDown,!0))}else if(e.button==Static.LeftButton||Static.isMobile())return this.controlFlag(Static.DragCursor)&&this.setControlFlag(Static.LeftButtonDown,!0),!0}}widgetLeaveEvent(e){this.controlFlag(Static.LeftButtonDown)||this.clearDragCursor()}widgetMouseMoveEvent(e){e.preventDefault();var t,n=this._ruler.plot(),i=e.clientX,r=e.clientY,a=this.mapToElement(new Misc.Point(i,r));this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)&&(this.controlFlag(Static.Locked)||(Static.isMobile()&&(t=e.originalEvent.changedTouches[0],i=parseInt(t.clientX),r=parseInt(t.clientY)),t=a.x,r=this._ruler.plot().transform(this.xAxis(),this._rulerPos),this.controlFlag(Static.LeftButtonDown)&&(this._rulerPos=n.invTransform(this.xAxis(),t),this._rulerPos=this._ruler._rulers.setPosition(this._ruler._rulers.rulerId(this._ruler),this._rulerPos),Static.trigger("positionChanging",[this._ruler,this._ruler._pos])),!this.controlFlag(Static.LeftButtonDown)&&t<r+2&&r-2<t&&(n.getCentralWidget().contentsRect().contains(a,!0),this.setDragCursor()),this.controlFlag(Static.LeftButtonDown)||t<r+2&&r-2<t||this.clearDragCursor()))}}class PickerH extends MPicker{constructor(e,t,n){super(e,t,n),this._dragCursorShape="s-resize",this.axisTitle=function(){return this._ruler.plot().axisTitle(this.yAxis())}}widgetMousePressEvent(e){if(e.preventDefault(),this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)){if(2==e.button)return this.controlFlag(Static.DragCursor),!0;if(Static.isMobile()){var t=this._ruler.plot().transform(this.yAxis(),this._rulerPos),n=e.originalEvent.touches[0].clientX,i=e.originalEvent.touches[0].clientY,i=this.mapToElement(new Misc.Point(n,i)).y;!this.controlFlag(Static.LeftButtonDown)&&i<t+12&&t-12<i&&(this.setDragCursor(),this.setControlFlag(Static.LeftButtonDown,!0))}else if(e.button==Static.LeftButton||Static.isMobile())return this.controlFlag(Static.DragCursor)&&this.setControlFlag(Static.LeftButtonDown,!0),!0}}widgetLeaveEvent(e){this.controlFlag(Static.LeftButtonDown)||this.clearDragCursor()}widgetMouseMoveEvent(e){e.preventDefault();var t,n=this._ruler.plot(),i=e.clientX,r=e.clientY,a=this.mapToElement(new Misc.Point(i,r));this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)&&(this.controlFlag(Static.Locked)||(Static.isMobile()&&(t=e.originalEvent.changedTouches[0],i=parseInt(t.clientX),r=parseInt(t.clientY)),t=a.y,r=this._ruler.plot().transform(this.yAxis(),this._rulerPos),this.controlFlag(Static.LeftButtonDown)&&(this._rulerPos=n.invTransform(this.yAxis(),t),this._rulerPos=this._ruler._rulers.setPosition(this._ruler._rulers.rulerId(this._ruler),this._rulerPos),Static.trigger("positionChanging",[this._ruler,this._ruler._pos])),!this.controlFlag(Static.LeftButtonDown)&&t<r+2&&r-2<t&&(n.getCentralWidget().contentsRect().contains(a,!0)?this.setDragCursor():this.clearDragCursor()),this.controlFlag(Static.LeftButtonDown)||t<r+2&&r-2<t||this.clearDragCursor()))}}define("mpicker",["static","plotpicker"],function(){});class Ruler extends PlotMarker{constructor(e,t,n){super(t),this._picker=0,this._pos=Number.MAX_VALUE,this._rightClickMenu=0,this._rulers=null,n!=VLine&&n!=HLine||(this.setLineStyle(n),this.setLinePen(new Misc.Pen("blue"))),this.attach(e),this.setMouseTracking=function(e){this._picker.setMouseTracking(e)}}}Ruler.prototype.toString=function(){return"[Ruler]"},Ruler.prototype.setPicker=function(e){return!!e&&(this._picker=e,!0)},Ruler.prototype.setZoomerSearch=function(e){this._picker.setControlFlag(Static.ZoomerSearch,e),this._picker.initZoomer()},Ruler.prototype.setPannerSearch=function(e){this._picker.setControlFlag(Static.PannerSearch,e)},Ruler.prototype.setLock=function(e){this._picker.setControlFlag(Static.Locked,e),this._picker.clearDragCursor()},Ruler.prototype.lock=function(){return this._picker.controlFlag(Static.Locked)},Ruler.prototype.setTrackingTextStyle=function(e){this._picker.setTrackingTextStyle(e)},Ruler.prototype.trackingTextStyle=function(){return this._picker.trackingTextStyle()},Ruler.prototype.setTrackingTextFont=function(e){this._picker.setTrackerFont(e)},Ruler.prototype.trackingTextFont=function(){return this._picker.trackerFont()},Ruler.prototype.setTrackingTextColor=function(e){var t=this._picker.trackerFont();t.fontColor=e,this._picker.setTrackerFont(t)},Ruler.prototype.trackingTextColor=function(){return this._picker.trackerFont().color},Ruler.prototype.validatePosition=function(e,t){},Ruler.prototype.dragCursorShape=function(){return this._picker.dragCursorShape()},Ruler.prototype.setDragCursorShape=function(e){this._picker.setDragCursorShape(e)},Ruler.prototype.setRightClickMenu=function(e){};class RulerV extends Ruler{constructor(e,t,n){super(e,t,VLine),n&&(this._rulers=n),this._picker=new PickerV(e,this._pos,this)}}RulerV.prototype.setPosition=function(e){this._pos=e,this._picker._rulerPos=e,this.setXValue(this._pos)};class RulerH extends Ruler{constructor(e,t,n){super(e,t,HLine),n&&(this._rulers=n),this._picker=new PickerH(e,this._pos,this)}}RulerH.prototype.setPosition=function(e){this._pos=e,this._picker._rulerPos=e,this.setYValue(this._pos)},define("ruler",["static","plotMarker"],function(){});class MRulerV extends RulerV{constructor(e,t,n){super(e,t,n),this.rulers=function(){return this._rulers},this.validatePosition=function(){var e=!1,t=this.plot(),n=t.axisInterval(this.xAxis()),i=n.minValue(),r=n.maxValue(),a=t.transform(this._picker.xAxis(),i),s=t.transform(this._picker.xAxis(),r),o=t.transform(this._picker.xAxis(),this._pos),l=this._rulers.minX(),n=this._rulers.maxX(),i=2;Static.isMobile()&&(i=12);var c,r=.5*(this.rulers().ruler(0).linePen().width+this.rulers().ruler(1).linePen().width)+i,i=this._rulers.rulerId(this);return 0==i&&(this._rulers.ruler(1).isVisible()?((c=t.transform(this._picker.xAxis(),this._rulers.ruler(1)._pos))-r<=o&&(this._pos=t.invTransform(this._picker.xAxis(),c-r),e=!0),o<a&&(this._pos=t.invTransform(this._picker.xAxis(),a),e=!0),this._rulers._curve&&this._pos<l&&(this._pos=l,e=!0)):(o<a&&(this._pos=t.invTransform(this._picker.xAxis(),a),e=!0),s<o&&(this._pos=t.invTransform(this._picker.xAxis(),s),e=!0),this._rulers._curve&&this._pos<l&&(this._pos=l,e=!0),this._rulers._curve&&this._pos>n&&(this._pos=n,e=!0))),1==i&&(this._rulers.ruler(0).isVisible()?(o<=(c=t.transform(this._picker.xAxis(),this._rulers.ruler(0)._pos))+r&&(this._pos=t.invTransform(this._picker.xAxis(),c+r),e=!0),s<o&&(this._pos=t.invTransform(this._picker.xAxis(),s),e=!0)):(o<a&&(this._pos=t.invTransform(this._picker.xAxis(),a),e=!0),s<o&&(this._pos=t.invTransform(this._picker.xAxis(),s),e=!0),this._rulers._curve&&this._pos<l&&(this._pos=l,e=!0)),this._rulers._curve&&this._pos>n&&(this._pos=n,e=!0)),e&&this.setPosition(this._pos),e}}setVisible(e){super.setVisible(e),e&&this._rulers?0==(e=this._rulers.rulerId(this))&&this._rulers.ruler(1).isVisible()||1==e&&this._rulers.ruler(0).isVisible():(this._pos=Number.MAX_VALUE,this._rulers.updateWatchesAndTable())}setLockAt(e){this.setPosition(e),this.validatePosition(),this.setLock(!0),Static.trigger("positionChanged",[this,e])}}class MRulerH extends RulerH{constructor(e,t,n){super(e,t,n),this.rulers=function(){return this._rulers},this.validatePosition=function(){var e=!1,t=this.plot(),n=t.axisInterval(this.yAxis()),i=n.minValue(),r=n.maxValue(),a=t.transform(this.yAxis(),i),s=t.transform(this.yAxis(),r),o=t.transform(this.yAxis(),this._pos),l=this._rulers.minY(),n=this._rulers.maxY(),i=2;Static.isMobile()&&(i=12);var c,r=.5*(this.rulers().ruler(2).linePen().width+this.rulers().ruler(3).linePen().width)+i,i=this._rulers.rulerId(this);return 2==i&&(this._rulers.ruler(3).isVisible()?(o<=(c=t.transform(this.yAxis(),this._rulers.ruler(3)._pos))+r&&(this._pos=t.invTransform(this.yAxis(),c+r),e=!0),a<o&&(this._pos=t.invTransform(this.yAxis(),a),e=!0),this._rulers._curve&&this._pos<l&&(this._pos=l),e=!0):(o<s&&(this._pos=t.invTransform(this.yAxis(),s),e=!0),a<o&&(this._pos=t.invTransform(this.yAxis(),a),e=!0),this._rulers._curve&&this._pos<l&&(this._pos=l,e=!0),this._rulers._curve&&this._pos>n&&(this._pos=n,e=!0))),3==i&&(this._rulers.ruler(2).isVisible()?((c=t.transform(this.yAxis(),this._rulers.ruler(2)._pos))-r<=o&&(this._pos=t.invTransform(this.yAxis(),c-r),e=!0),o<s&&(this._pos=t.invTransform(this.yAxis(),s),e=!0),this._rulers._curve&&this._pos>n&&(this._pos=n,e=!0)):(a<o&&(this._pos=t.invTransform(this.yAxis(),a),e=!0),o<s&&(this._pos=t.invTransform(this.yAxis(),s),e=!0),this._rulers._curve&&this._pos<l&&(this._pos=l,e=!0),this._rulers._curve&&this._pos>n&&(this._pos=n))),e&&this.setPosition(this._pos),e}}setVisible(e){super.setVisible(e),e&&this._rulers?2==(e=this._rulers.rulerId(this))&&this._rulers.ruler(3).isVisible()||3==e&&this._rulers.ruler(2).isVisible():(this._pos=Number.MAX_VALUE,this._rulers.updateWatchesAndTable())}setLockAt(e){this.setPosition(e),this.validatePosition(),this.setLock(!0),Static.trigger("positionChanged",[this,e])}}function Rulers(n,e){var i=this,r=[{name:"hide...",img:"images/hide.png",title:"hide the ruler.",fun:function(){n.rv.currentRuler.setVisible(!1),n.rv.currentRuler._picker.clearDragCursor(),n.rv.hasVisibleRuler()}},{name:"lock...",img:"images/lock.png",title:"lock the ruler in its current position.",fun:function(){n.rv.currentRuler.setLock(!0),n.rv.hasLockedRuler()}},{name:"lock at...",img:"images/lockAt.png",title:"lock the ruler at a specific position.",fun:function(){var e=0,e=n.rv.currentRuler instanceof RulerH?n.rv.currentRuler.yValue():n.rv.currentRuler.xValue();Static.prompt("Enter a position",e,function(e){return n.rv.currentRuler.setLockAt(parseFloat(e)),!0},"small")}}],t=[{name:"Hide rulers",img:"images/hide.png",title:"Hide all rulers",fun:function(){n.rv.setVisible(!1)}},{name:"Show rulers",img:"images/show.png",title:"Show any hidden rulers",fun:function(){n.rv.setVisible(!0)}},{name:"Unlock rulers",img:"images/unlock.png",title:"Unlock any locked rulers",fun:function(){n.rv.unlockAllRulers()}}];if(this.setRulerDeselectMenu=function(e){t=e||[]},this._curve=0,this._watchTable=new WatchTable(this),this._editor=0,this._curveShapeItem=0,this._watchSetter=0,this._rulerList=null,this._watchList=[],this.sidebarVisible=!1,n.setAutoReplot(!0),this._rulerList=[new MRulerV(n,"v_ruler1",i),new MRulerV(n,"v_ruler2",i),new MRulerH(n,"h_ruler1",i),new MRulerH(n,"h_ruler2",i)],Static.isMobile())for(var a=0;a<4;++a){var s=this._rulerList[a].linePen();s.width=2*s.width}this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this.minX=function(){return this._minX},this.maxX=function(){return this._maxX},this.minY=function(){return this._minY},this.maxY=function(){return this._maxY},this.currentRuler=null;var o=n.getLayout().getCentralDiv(),l=!1;Static.bind("rulerSelected",function(e,t){i.currentRuler=t,l&&o.contextMenu("destroy"),l=!0,o.contextMenu(r,{triggerOn:"contextmenu",zIndex:1})}),Static.bind("rulerDeselected",function(){l&&o.contextMenu("destroy"),l=!0,o.contextMenu(t,{triggerOn:"contextmenu",zIndex:1})}),this.init(n),this.position=function(e){return-1<e&&e<4&&this._rulerList[e].isVisible()?this._rulerList[e]._pos:Number.MAX_VALUE},this.watch=function(e){return 0<=e&&e<this._watchList.length?this._watchList[e]:null},this.addToWatchList=function(e){return this._watchList.push(e),this._watchList.length-1},this.setWatchEnabled=function(e,t){0<=e&&e<this._watchList.length&&this._watchList[e].isEnable()!=t&&(this._watchList[e].setEnable(t),t&&this.updateWatch(this._watchList[e]),this._watchTable.updateWatchTable())},this.isWatchEnabled=function(e){return 0<=e&&e<this._watchList.length&&this._watchList[e].isEnable()},Static.bind("showSidebar",function(e,t,n){"right"==t&&(i.sidebarVisible=n)}),this.updateWatchesAndTable=function(){i.sidebarVisible&&this._curve&&(this.updateWatches(),this._watchTable&&this._watchTable.updateWatchTable())},this.setVisible=function(t){this._rulerList.forEach(function(e){e.setVisible(t)}),t&&Static.trigger("curveAdjusted"),this.refresh()},this.hasVisibleRuler=function(){for(var e=0;e<4;++e)if(this._rulerList[e].isVisible())return!0;return!1},this.hasLockedRuler=function(){for(var e=0;e<4;++e)if(this._rulerList[e].lock())return!0;return!1},this.updateWatch=function(e){var t;e.isEnable()&&(t=n.autoReplot(),n.setAutoReplot(!1),e.setCurveName(this._curve.title()),e.setRulerLeft(this.position(0)),e.setRulerRight(this.position(1)),e.setRulerBottom(this.position(2)),e.setRulerTop(this.position(3)),this._curve&&e.setCurve(this._curve),n.setAutoReplot(t),n.autoRefresh(),e.computeWatch())},this.updateWatches=function(){var e=n.autoReplot();n.setAutoReplot(!1),this._watchList.forEach(function(e){i.updateWatch(e)}),n.setAutoReplot(e),n.autoRefresh()},this.setEnabled=function(t){this._rulerList.forEach(function(e){e._picker.setEnabled(t)})},this.setMouseTracking=function(t){this._rulerList.forEach(function(e){e._picker.setMouseTracking(t)})},this.setZoomerSearch(!0),this.setPannerSearch(!0),this.setMouseTracking(!0),Static.bind("zoomerAdded",function(e,t){i.setZoomerSearch(i._rulerList[0]._picker.controlFlag(Static.ZoomerSearch)),i.setMouseTracking(!0)}),Static.bind("pannerAdded",function(e,t){i.setPannerSearch(i._rulerList[0]._picker.controlFlag(Static.PannerSearch)),i.setMouseTracking(!0)}),Static.bind("currentCurveChanged",function(e,t){i.setCurrentCurve(t)}),n.rv=this,Static.trigger("rulerDeselected")}Rulers.prototype.unlockAllRulers=function(){for(var e=0;e<this._rulerList.length;++e)this._rulerList[e].setLock(!1)},Rulers.prototype.setCurrentCurve=function(e){this._curve!=e&&this.doSetCurrentCurve(e)},Rulers.prototype.refresh=function(){var e,t,n,i=this._rulerList[0].plot();i.replot(),this._curve&&this._curve.isVisible()?(this._curve.isVisible()&&(this._minX=this._curve.minXValue(),this._maxX=this._curve.maxXValue(),this._minY=this._curve.minYValue(),this._maxY=this._curve.maxYValue()),this._rulerList[0].xAxis(),n=(t=i.axisInterval(this._rulerList[0].xAxis())).minValue(),e=t.maxValue(),i=(t=i.axisInterval(this._rulerList[0].yAxis())).minValue(),t=t.maxValue(),n=this._minX<n?n:this._minX,this._rulerList[0].setPosition(n),e=this._maxX<e?this._maxX:e,this._rulerList[1].setPosition(e),i=this._minY<i?i:this._minY,this._rulerList[2].setPosition(i),t=this._maxY<t?this._maxY:t,this._rulerList[3].setPosition(t),this.updateWatchesAndTable()):(this.resetXPositions(),this.resetYPositions())},Rulers.prototype.doSetRulersAxes=function(e,t){var n=this._rulerList[0].plot(),i=n.autoReplot();n.setAutoReplot(!1);this._rulerList[0].xAxis(),this._rulerList[0].yAxis();for(var r=0;r<this._rulerList.length;++r)this._rulerList[r].setAxes(e,t),this._rulerList[r]._picker.setAxis(e,t);n.setAutoReplot(i),n.autoRefresh()},Rulers.prototype.adjustToCurve=function(e){this._curve=e,this._curve&&(this.doSetRulersAxes(this._curve.xAxis(),this._curve.yAxis()),this._curveShapeItem),this.refresh()},Rulers.prototype.doSetCurrentCurve=function(e){this._curve;this.adjustToCurve(e)},Rulers.prototype.setCurrentCurve=function(e){this._curve!=e&&this.doSetCurrentCurve(e)},Rulers.prototype.currentCurve=function(){return this._curve},Rulers.prototype.init=function(e){var i=this;this._rulerList;Static.bind("positionChanged decimalPlacesChanged calculationAccuracy",function(e,t,n){i.updateWatchesAndTable()}),Static.bind("curveAdjusted",function(){i.refresh()}),Static.bind("rescaled",function(){Static.trigger("curveAdjusted")}),Static.bind("pointAdded pointRemoved",function(e,t){i.doSetCurrentCurve(t)}),Static.bind("axisChanged",function(e,t,n){i.currentCurve()===n&&i.adjustToCurve(n)}),this._rulerList[0].linePen().color="red",this._rulerList[2].linePen().color="red",this.resetXPositions(),this.resetYPositions()},Rulers.prototype.setZoomerSearch=function(t){this._rulerList.forEach(function(e){e.setZoomerSearch(t),e._picker.initZoomer()})},Rulers.prototype.setPannerSearch=function(t){this._rulerList.forEach(function(e){e.setPannerSearch(t),e._picker.initPanner()})},Rulers.prototype.setPosition=function(e,t){if(t=parseFloat(t),this._rulerList[e]._pos==t)return t;var n=this._rulerList[e]._pos;return this._rulerList[e]._pos=t,this._rulerList[e].validatePosition(),this._rulerList[e]._pos!==n&&this._rulerList[e].setPosition(this._rulerList[e]._pos),this._rulerList[e]._pos},Rulers.prototype.resetXPositions=function(){var e=this._rulerList[0].plot(),t=e.autoReplot();e.setAutoReplot(!1);var n=e.axisInterval(this._rulerList[0].xAxis());this._curve&&this._curve.isVisible()?(n.minValue()>this._minX?this._rulerList[0].setPosition(n.minValue()):this._rulerList[0].setPosition(this._minX),n.maxValue()<this._maxX?this._rulerList[1].setPosition(n.maxValue()):this._rulerList[1].setPosition(this._maxX)):(this._rulerList[0].setPosition(n.minValue()),this._rulerList[1].setPosition(n.maxValue())),e.setAutoReplot(t),e.autoRefresh()},Rulers.prototype.resetYPositions=function(){var e=this._rulerList[0].plot(),t=e.autoReplot();e.setAutoReplot(!1);var n=e.axisInterval(this._rulerList[0].yAxis());this._curve&&this._curve.isVisible()?(this._rulerList[2].setPosition(this._minY),this._rulerList[3].setPosition(this._maxY),n.minValue()>this._minY?this._rulerList[2].setPosition(n.minValue()):this._rulerList[2].setPosition(this._minY),n.maxValue()<this._maxY?this._rulerList[3].setPosition(n.maxValue()):this._rulerList[3].setPosition(this._maxY)):(this._rulerList[2].setPosition(n.minValue()),this._rulerList[3].setPosition(n.maxValue())),e.setAutoReplot(t),e.autoRefresh()},Rulers.prototype.ruler=function(e){return e<4&&0<=e?this._rulerList[e]:0},Rulers.prototype.rulerId=function(e){return e?this._rulerList.indexOf(e):-1},Rulers.prototype.preventDragging=function(e){for(var t=0;t<this._rulerList.length;++t)this._rulerList[t]._picker.preventDragging(e)},Rulers.prototype.setRulersXAxis=function(e){var t=this._rulerList[0].plot(),n=t.autoReplot();t.setAutoReplot(!1);for(var i=0;i<this._rulerList.length;++i)this._rulerList[i].setXAxis(e),this._rulerList[i]._picker.setAxis(e,this._rulerList[i].yAxis());this._curveShapeItem&&this._curveShapeItem.setAxes(e,this._rulerList[0].yAxis()),t.setAutoReplot(n),t.autoRefresh()},Rulers.prototype.setRulersYAxis=function(e){var t=this._rulerList[0].plot(),n=t.autoReplot();t.setAutoReplot(!1);for(var i=0;i<this._rulerList.length;++i)this._rulerList[i].setYAxis(e),this._rulerList[i]._picker.setAxis(this._rulerList[i].xAxis(),e);this._curveShapeItem&&this._curveShapeItem.setAxes(_rulerList[0].xAxis(),e),t.setAutoReplot(n),t.autoRefresh()};class WatchTable{constructor(i){this.removeAllRows=function(){for(var e=$("#watchTableBody").children(),t=0;t<e.length;++t)$("#watchTableBody")[0].removeChild(e[t])},this.insertInfoRow=function(e){!function(e){var t=e.name(),n=e.value();if("number"==e.valueType||"text"==e.valueType){for(var i=t;-1!=i.indexOf(" ");)i=i.replace(" ","");var r=$("<tr><td>"+t+"</td></tr>");$("#watchTableBody").append(r);var a=$("<td><input id="+i+" type="+e.valueType+'  style="width:100%" value='+n+" /></td>");r.append(a),$("#"+i).on("change",e.cb)}else $("#watchTableBody").append($("<tr><td>"+t+"</td><td>"+n+"</td></tr>"))}(e)},this.updateWatchTable=function(){if(Static.watchUpdateError,this.removeAllRows(),i._curve&&i._curve.isVisible())for(var e=i._watchList.length,t=0;t<e;++t){var n=i.watch(t);n.isEnable()&&this.insertInfoRow(n)}Static.showWatchUpdateError&&Static.watchUpdateError&&confirm("The application encountered extremely small values that may affect the computation of one or more watches. This may be due to incorrect axes decimal places setup (Plot Property pane: Watch Settings -> Calculation accuracy -> Decimal places in calculation).\n\nWould you like to prevent this message ?")&&(Static.showWatchUpdateError=!1)}}}define("rulers",["static","mpicker","ruler"],function(){});class SideBar{constructor(e,i,t,n){var r=this;this.plotDiv=i;r.sideBarVisible=!1;var a=n||"right",s=$('<div class="grid-container noprint" style="position: absolute; border: 1px solid lightgray;"/>');e.append(s),s.css("bottom",0),s.css("top",0);class o{constructor(){this.visible=!0,this.headerElement=null,this.bodyElement=null,this.element=null,this.anchorPosition=""}}for(var l=[],c=0,u=0;u<t;++u){var h=new o;h.anchorPosition=a,h.element=$('<div class="grid-item"></div>'),s.append(h.element),h.headerElement=$('<div class="grid-item-header"></div>'),h.element.append(h.headerElement),h.bodyElement=$('<div class="grid-item-body"></div>'),h.element.append(h.bodyElement),l.push(h),++c}this.hideAllGridItems=function(){for(var e=0;e<t;++e)this.doShowGridItem(e,!1)},this.setHeaderElement=function(e,t){l[e].headerElement.css("height",t+"px"),this.setGridItemHeigth()},this.setGridItemHeigth=function(){parseInt(s.css("height"));for(var e,t,n=1/c*100,i=0;i<l.length;++i)l[i].visible&&(l[i].element.css("height",n+"%"),e=parseInt(l[i].element.css("height")),t=parseInt(l[i].headerElement.css("height")),l[i].bodyElement.css("height",100*(1-t/e)+"%"))},this.doShowGridItem=function(e,t){if(l[e].visible!=t)return t?(this.sideBarVisible||this.showSidebar(!0),l[e].element.show(),++c):(l[e].element.hide(),0===--c&&this.showSidebar(!1)),l[e].visible=t,this.setGridItemHeigth(),Static.trigger("showGridItem",[a,e,t]),c},this.gridItem=function(e){return e<l.length?l[e]:null},this.gridItemCount=function(){return l.length},this.setGridItemHeigth(),s.css("width","20%"),this.isSideBarVisible=function(){return r.sideBarVisible},this.sideBarWidth=function(){return 20},this.setTop=function(e){s.css("top",e)},this.setBorderStyle=function(e){s.css("border-style",e)},this.setBorderWidth=function(e){s.css("border-width",e)},this.setBackgroundColor=function(e){s.css("background-color",e)};this.html=function(){return s};Static.bind("beforePrint",function(){}),Static.bind("afterPrint",function(){}),this.anchorPosition=function(){return a},this.getIndexFromHeaderElement=function(e){for(var t=0;t<r.gridItemCount();++t)if(r.gridItem(t).headerElement[0].offsetTop==e.offsetTop&&r.gridItem(t).headerElement[0].innerText==e.innerText)return t;return-1},this.hideGridItemWithHeaderElement=function(e){for(var t=0;t<r.gridItemCount();++t)if(r.gridItem(t).headerElement[0].offsetTop==e.offsetTop&&r.gridItem(t).headerElement[0].innerText==e.innerText)return r.showGridItem(t,!1);return-1};var d=null;Static.bind("toolBarResized",function(e,t,n){d=t,r.html().css("top",parseFloat(d.css("height"))+2)});i=null;Static.bind("resize",function(){"left"===a&&r.isSideBarVisible()&&i.css("left",parseFloat(r.html().css("width"))),r.setGridItemHeigth()}),Static.bind("plotDivResized",function(e,t,n){i=t}),this.hideAllGridItems(),s.hide()}showSidebar(e){var t;this.isSideBarVisible()!=e&&((this.sideBarVisible=e)?(this.html().show(),"right"==this.anchorPosition()?this.html().css("right","0.5%"):"left"==this.anchorPosition()&&this.html().css("left","0.5%")):this.html().hide(),t=parseFloat(this.plotDiv.css("width"))/parseFloat(this.plotDiv.parent().css("width"))*100,e?"right"==this.anchorPosition()?this.plotDiv.css("width",t-this.sideBarWidth()+"%"):"left"==this.anchorPosition()&&(this.plotDiv.css("left",this.sideBarWidth()+"%"),this.plotDiv.css("width",t-this.sideBarWidth()+"%")):(this.plotDiv.css("width",t+this.sideBarWidth()+"%"),"left"==this.anchorPosition()&&this.plotDiv.css("left","0%")),Static.trigger("showSidebar",[this.anchorPosition(),e]))}showGridItem(e,t){this.doShowGridItem(e,t)}}define("sideBar",function(){});class InfoSideBar extends SideBar{constructor(e,t){super(t.parent(),t,1,"right");var n=this,i=e;this.plot=function(){return i},Static.bind("paneClose",function(e,t){n.hideGridItemWithHeaderElement(t)}),this.setHeaderElement(0,40)}showGridItem(e,t){this.doShowGridItem(e,t)}showSidebar(e){this.isSideBarVisible()!=e&&(super.showSidebar(e),this.plot().autoRefresh())}}define("infoSidebar",["sideBar"],function(){});class Pane{constructor(e){var t=this;t.paneParent=$("<div/>"),e.append(t.paneParent),this.setPaneHeight=function(e){t.paneParent.css("height",e)},this.setHeader=function(e,t,n){n=n||!1,t=this.header(t);n&&(n=$('<div><button style="position: absolute; right:1px">X</button></div>'),e.append(n),n.on("click",function(){Static.trigger("paneClose",e)})),e.append(t)}}header(e){var t=$('<div style="text-align:center; padding-top: 10px; border-style: solid; border-width:1px; border-color:#666666; font-size: 16px; color:#666666"/>');return t.append("<label>"+e+"</label>"),t}}define("pane",function(){});class InfoPropertiesPane extends Pane{constructor(e,s){super(e);this.setHeader(s.rightSidebar.gridItem(0).headerElement,"Sidebar",!0);var t=$('<div style="background-color:rgba(249, 251, 221, 0.8);  ">                <div style="margin:4px">                <select id="currentCurve" style="width:100%">                </select></div>                <div><input type="text" id="fnDisplay" style="width:100%; background-color:rgba(255, 255, 255, 0.8); padding-left:6px" readonly /></div>                <div><label style="padding-left:6px">onchcange: <input id="onchange" type="checkbox" readonly /> </label>\t\t\t\tdamp: <input id="damp" style="width:30%" type="number" min="1" value="30000" step="500"/>\t\t\t\t</div>                                <div style="height:30%; overflow: auto">                <div id="coeff_cont0" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff0">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val0" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                <br>                <div id="coeff_cont1" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff1">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val1" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                <br>                <div id="coeff_cont2" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff2">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val2" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                <br>                <div id="coeff_cont3" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff3">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val3" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                <br>                <div id="coeff_cont4" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff4">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val4" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                </div>                                <div style="text-align:center"><h4>Watches</h4></div>                <div class="table-responsive" style="height: 47%">                                                <table class="table table-bordered" id="watchTable">                <thead>                <tr>                <th>Watch</th>                <th>Value</th>                </tr>                </thead>                <tbody id="watchTableBody">                </tbody>                </table>                                                </div>                </div>');function n(){s.itemList(Static.Rtti_PlotCurve);!function(){for(var e=0;e<5;++e)$("#coeff_cont"+e).hide()}();var n=s.findPlotCurve($("#currentCurve").val());if(n){$("#fnDisplay").val(""),n.fn&&$("#fnDisplay").val("f("+n.variable+")="+n.fn);for(var i=3e4,r=(n.upperX-n.lowerX)/(i/1e4),e=n.coeffs||[],a=e.length,t=0;t<a;++t)$("#coeff_val"+t).attr("step",r);$("#damp").on("input",function(){var e=parseInt($("#damp").val());!_.isFinite(e)||e<1?$("#damp").val(i):i=e,r=(n.upperX-n.lowerX)/(i/1e4);for(var t=0;t<a;++t)$("#coeff_val"+t).attr("step",r)}),5<a&&(a=5);for(t=0;t<a;++t)$("#coeff"+t).html(e[t]),$("#coeff_val"+t).attr("step",r),$("#coeff_val"+t).val(n.coeffsVal[t]),$("#coeff_cont"+t).show()}}function i(){!function(){for(var e=$("#currentCurve").children(),t=0;t<e.length;++t)$("#currentCurve")[0].removeChild(e[t]);for(var n,i=s.itemList(Static.Rtti_PlotCurve),t=0;t<i.length;++t)i[t].isVisible()&&((n=$("<option>"+i[t].title()+"</option>")).attr("value",i[t].title()),$("#currentCurve").append(n))}(),n(),Static.trigger("currentCurveChanged",s.findPlotCurve($("#currentCurve").val()))}this.paneParent.append(t);var r=!((s.sidebar=this).sidebarDlg=function(){return t});this.sidebarReDisplay=function(){return r},this.setSidebarReDisplay=function(e){r=e},this.setTop=function(e){t.css("top",e)};var a=_.once(function(){$("#currentCurve").change(function(){Static.total_volume=void 0,Static.total_area=void 0,Static.prevStart=void 0,Static.prevEnd=void 0,n(),Static.trigger("invalidateWatch"),Static.trigger("currentCurveChanged",s.findPlotCurve($("#currentCurve").val()))}),$("#coeff_val0, #coeff_val1, #coeff_val2, #coeff_val3, #coeff_val4").on("input",function(){$("#onchange")[0].checked||l($(this))&&o()}),$("#coeff_val0, #coeff_val1, #coeff_val2, #coeff_val3, #coeff_val4").on("change",function(){var e;l($(this))?$("#onchange")[0].checked&&o():$(this).val((e=$(this),s.findPlotCurve($("#currentCurve").val()).coeffsVal[["coeff_val0","coeff_val1","coeff_val2","coeff_val3","coeff_val4"].indexOf(e[0].id)]))})});this.initSidebar=function(){i(),a()},this.currentCurveName=function(){return $("#currentCurve").val()};function o(){for(var e=s.findPlotCurve($("#currentCurve").val()),t=e.coeffs,n=e.fn,i=0;i<t.length;++i){for(;-1!=n.indexOf(t[i]);)n=n.replace(t[i],$("#coeff_val"+i).val());e.coeffsVal[i]=$("#coeff_val"+i).val()}e.expandedFn=n;var r=e.data();e.unboundedRange?r.setFn(n):r.setSamples(Utility.makeSamples({fx:n,lowerX:e.lowerX,upperX:e.upperX,numOfSamples:e.numOfSamples})),Static.trigger("curveAdjusted"),s.autoRefresh()}function l(e){s.findPlotCurve($("#currentCurve").val()).coeffsVal,["coeff_val0","coeff_val1","coeff_val2","coeff_val3","coeff_val4"].indexOf(e[0].id);return e=e.val(),!!_.isFinite(parseFloat(e))}Static.bind("titleChange",function(){i()}),Static.bind("pointAdded pointRemoved",function(e,t){$("#currentCurve").val(t.title)}),Static.bind("itemAttached",function(e,t,n){t.rtti==Static.Rtti_PlotCurve&&(n||s.itemList(Static.Rtti_PlotCurve).length&&s.hasVisiblePlotCurve(),Static.trigger("visibilityChange",[t,n]))}),this.initSidebar()}}define("infoPropertiesPane",["pane"],function(){});class PlotSideBar extends SideBar{constructor(e,t){super(t.parent(),t,2,"left");var n=this,i=e;this.plot=function(){return i},Static.bind("paneClose",function(e,t){n.hideGridItemWithHeaderElement(t)})}showSidebar(e){this.isSideBarVisible()!=e&&(super.showSidebar(e),this.plot().autoRefresh())}showGridItem(e,t){this.doShowGridItem(e,t)}}define("plotSideBar",["sideBar"],function(){});class PropertiesPane extends Pane{static fontsDisplay(){return["Arial","Arial Black","Comic Sans MS","Courier New","Georgia","Impact","Lucida Console","Lucida Sans Unicode","PalatinoLinotype","Tahoma","Times New Roman","Trebuchet MS","Verdana","Gill Sans"]}static fontGroup(e){return["Arial,Arial,Helvetica,sans-serif","Arial Black,Arial Black,Gadget,sans-serif","Comic Sans MS,Comic Sans MS,cursive","Courier New,Courier New,Courier,monospace","Georgia,Georgia,serif","Impact,Charcoal,sans-serif","Lucida Console,Monaco,monospace","Lucida Sans Unicode,Lucida Grande,sans-serif","Palatino Linotype,Book Antiqua,Palatino,serif","Tahoma,Geneva,sans-serif","Times New Roman,Times,serif","Trebuchet MS,Helvetica,sans-serif","Verdana,Geneva,sans-serif","Gill Sans,Geneva,sans-serif"][e]}constructor(e){super(e);var a=$("<table/>");this.paneParent.append(a),this.table=function(){return a},this.init=function(e){a.treetable(e||{expandable:!0,clickableNodeNames:!0})},this.hide=function(e){var t=a.treetable("node",e);t?t.hide():console.error("invalid id: "+e)},this.show=function(e){var t=a.treetable("node",e);t?t.show():console.error("invalid id: "+e)},this.getElementValueDataAttribute=function(e){for(var t=null,n=a[0].getElementsByTagName("TR"),i=0;i<n.length;++i)if(n[i].getAttribute("data-tt-id")==e){t=n[i];break}if(t){var r=t.children;return 2!==r.length?null:$(r[1].children[0])}return null},this.getTableRowByPropertyName=function(e){for(var t=a[0].getElementsByTagName("TR"),n=0;n<t.length;++n)if(t[n].cells[0].innerText==e)return $(t[n]);return null},this.getTableRowByPropertyId=function(e){for(var t=a[0].getElementsByTagName("TR"),n=0;n<t.length;++n)if(t[n].getAttribute("data-tt-id")==e)return $(t[n]);return null},this.getElementValueDataByPropertyName=function(e){for(var t=null,n=a[0].getElementsByTagName("TR"),i=0;i<n.length;++i)if(n[i].cells[0].innerText==e){t=n[i];break}if(t){var r=t.children;return 2!==r.length?null:$(r[1].children[0])}return null},this.setFontSize=function(e){a.css("font-size",e)},this.addProperty=function(e){var t=function(e){null==e.type&&(e.type="span");var t="";e.disabled&&(t="disabled");var n="";e.checked&&(n="checked");var i="";void 0!==e.value&&(i="value="+e.value);var r=null;if("text"==e.type)return $('<tr><td style="border: 1px solid grey;">'+e.name+'</td><td style="border: 1px solid grey;"><input type="text" '+t+" "+i+' style="width:100%"/></td></tr>');if("button"==e.type)return $('<tr><td style="border: 1px solid grey;">'+e.name+'</td><td style="border: 1px solid grey;"><input type="button" '+t+' value="..." /></td></tr>');if("number"==e.type)return $('<tr><td style="border: 1px solid grey;">'+e.name+'</td><td style="border: 1px solid grey;"><input type="number" '+t+" step ="+e.step+" min ="+e.min+" max="+e.max+" "+i+' style="width:100%"/></td></tr>');if("checkbox"==e.type)return $('<tr><td style="border: 1px solid grey;">'+e.name+'</td><td style="border: 1px solid grey;"><input '+t+' type="checkbox" style="width:100%" '+n+"/></td></tr>");if("radio"==e.type)return $('<tr><td style="border: 1px solid grey;">'+e.name+'</td><td style="border: 1px solid grey;"><input '+t+' type="radio" name='+e.group+' style="width:100%" '+n+"/></td></tr>");if("color"==e.type){n="#000000";return e.value&&(n=Static.colorNameToHex(e.value)),$('<tr><td style="border: 1px solid grey;">'+e.name+'</td><td style="border: 1px solid grey;"><input '+t+' type="color" value='+n+" /></td></tr>")}if("span"==e.type)return $('<tr><td style="border: 1px solid grey;">'+e.name+'</td><td style="border: 1px solid grey;"><span style="width:100%"/></td></tr>');if("select"!=e.type)return r;var r=$('<tr><td style="border: 1px solid grey;">'+e.name+"</td></tr>"),a=$("<select "+t+" />");if(e.selectorOptions)for(var s=0;s<e.selectorOptions.length;++s)a.append($("<option>"+e.selectorOptions[s]+"</option>"));return r.append($("<td/>").append(a))}(e);if(!t)return null;var n=null;return t.attr("data-tt-id",e.id),void 0!==e.parentId&&t.attr("data-tt-parent-id",e.parentId),"text"!=e.type&&"number"!=e.type&&"color"!=e.type&&"checkbox"!=e.type&&"radio"!=e.type||(n=$(t[0].getElementsByTagName("INPUT"))).on("change",function(){e.fun&&("checkbox"==e.type?e.fun($(this)[0].checked):e.fun($(this).val()))}),"select"==e.type&&(n=$(t[0].getElementsByTagName("SELECT"))).on("change",function(){e.fun&&e.fun($(this)[0].selectedIndex)}),"button"==e.type&&(n=$(t[0].getElementsByTagName("INPUT"))).on("click",function(){e.fun&&e.fun()}),"span"==e.type&&(n=$(t[0].getElementsByTagName("SPAN"))),a.append(t),e.title&&t.attr("title",e.title),n}}header(e){var t=$("<table />");return t.append('<caption style="text-align:center; border-width:4px; color:black"><b>'+e+"</b></caption>"),t.append('<thead style="background-color:lightgray">                <tr style="border-style:solid; border-width:1px">                <th style="border-style:none;"><label>Property</label></th>                <th style="border-style:none; text-align:right"><label style="margin-right:4px">Value</label></th>                </tr>                </thead>'),t}}define("propertiesPane",["pane"],function(){});class CurvePropertiesPane extends PropertiesPane{constructor(e,r){super(e);var a=this;a.setHeader(r.leftSidebar.gridItem(0).headerElement,"Curve Properties",!0);var s=this.addProperty({name:"Curve",id:"currentCurve",type:"select",title:"Curve being modified",fun:function(e){var t=r.findPlotCurve(s.val());X(t),Static.trigger("currentCurveChangedViaPropertiesPane",t)}});this.addProperty({name:"Rename",id:"renameCurve",type:"button",title:"Give the curve a different unique name",fun:function(){t=s[0].selectedIndex,Utility.curveRenameDlg(s.val(),r)}}),this.addProperty({name:"Remove",id:"removeCurve",type:"button",title:"Permanently remove the currently selected curve",fun:function(){let e=r.findPlotCurve(s.val());e.detach()}}),this.addProperty({name:"Fit",id:"fitCurve",type:"button",title:"Assign a curve fitter to the currently selected curve",fun:function(){r.curveFitDlg.curveFitCb(r.findPlotCurve(s.val()))}}),this.addProperty({name:"Legend Attributes",id:"legendAttributes",type:"button",title:"Configure how the curve is represented on the legend",fun:function(){r.curveAttributeDlg.curveAttributeCb(r.findPlotCurve(s.val()))}}),this.addProperty({name:"Orientation",id:"orientation",type:"select",selectorOptions:["Vertical","Horizontal"],title:"Set the orientation of the curve. This affect how the step and stick styles are displayed",fun:function(e){let t=r.findPlotCurve(s.val());1==e?t.setOrientation(Horizontal):t.setOrientation(Vertical)}});var i=this.addProperty({name:"Style",id:"curveStyle",type:"select",selectorOptions:["Lines (Default)","Sticks","Steps","Dots","NoCurve"],title:"Set the curve's drawing style",fun:function(e){let t=r.findPlotCurve(s.val());t.setStyle(d[e])}}),o=this.addProperty({name:"Axes",id:"curveAxes",title:"Set X and Y axis. The curve is drawn according to the coordinates of its Axes."}),l=this.addProperty({name:"Horizontal",id:"horizontal",parentId:"curveAxes",type:"select",selectorOptions:["Bottom","Top"],title:"Set X axis.",fun:function(e){let t=r.findPlotCurve(s.val());e=0==e?xBottom:xTop;t.setXAxis(e),m(t),Static.trigger("curveAxisChangedViaPropertiesPane",[e,t])}}),c=this.addProperty({name:"Vertical",id:"vertical",parentId:"curveAxes",type:"select",selectorOptions:["Left","Right"],title:"Set Y axis.",fun:function(e){let t=r.findPlotCurve(s.val());e=0==e?yLeft:yRight;t.setYAxis(e),m(t),Static.trigger("curveAxisChangedViaPropertiesPane",[e,t])}});this.addProperty({name:"Pen",title:"Build and assign a pen.",id:"curvePen"}),this.addProperty({name:"Color",id:"curvePenColor",parentId:"curvePen",type:"color",title:"Set the pen color",fun:function(e){let t=r.findPlotCurve(s.val()),n=t.pen();n.color=e,t.setPen(n),X(t)}}),this.addProperty({name:"Style",id:"curvePenStyle",parentId:"curvePen",type:"select",selectorOptions:["solid","dot","dash","dash-dot","dash-dot-dot"],title:"Set the pen style",fun:function(e){let t=r.findPlotCurve(s.val()),n=t.pen();n.style=b[e],t.setPen(n),X(t)}}),this.addProperty({name:"Width",id:"curvePenWidth",parentId:"curvePen",type:"select",selectorOptions:[1,2,3,4,5],title:"Set the pen width",fun:function(e){let t=r.findPlotCurve(s.val()),n=t.pen();n.width=e+1,t.setPen(n),X(t)}}),this.addProperty({name:"Curve Symbol",title:"Assign a symbol. Any previously set symbol is removed by setting a new one.",id:"curveSymbol"}),this.addProperty({name:"Pen",title:"Build and assign a pen.",id:"curveSymPen",parentId:"curveSymbol"}),this.addProperty({name:"Color",id:"curveSymbolPenColor",parentId:"curveSymPen",type:"color",title:"Set the pen color",fun:function(t){let n=r.findPlotCurve(s.val()),i=n.symbol();if(i){let e=i.pen();e.color=t,i.setPen(e),X(n),n.plot().autoRefresh(),n.plot().updateLegend(n)}}}),this.addProperty({name:"Width",id:"curveSymbolPenWidth",parentId:"curveSymPen",type:"select",selectorOptions:[1,2,3,4,5],title:"Set the pen width",fun:function(e){var t=r.findPlotCurve(s.val());Utility.setSymbolPenWidth(t,e+1),a.setSymbolIcon()}}),this.addProperty({name:"Fill Brush",id:"curveSymbolBrushColor",parentId:"curveSymbol",type:"color",title:"Assign a brush. The brush is used to draw the interior of the symbol.",fun:function(t){let n=r.findPlotCurve(s.val()),i=n.symbol();if(i){let e=i.brush();e.color=t,i.setBrush(e),n.plot().autoRefresh(),n.plot().updateLegend(n),a.setSymbolIcon()}}}),this.addProperty({name:"Style",id:"curveSymbolStyle",parentId:"curveSymbol",type:"select",selectorOptions:["None","Rectangle","Cross","Diamond","Ellipse","Diagonal cross"],title:"Specify the symbol style",fun:function(e){var t=r.findPlotCurve(s.val());"None"==R[e]&&(E.val(1),C.val(Static.colorNameToHex("black")),k.val(Static.colorNameToHex("transparent")),x.val(10));!function(e,t){let n=NoSymbol;"MRect"==t&&(n=MRect);"Cross"==t&&(n=Cross);"Diamond"==t&&(n=Diamond);"Ellipse"==t&&(n=Ellipse);"XCross"==t&&(n=XCross);Utility.addSymbol(e,n)}(t,R[e])}}),this.addProperty({name:"Size",id:"curveSymbolSize",parentId:"curveSymbol",type:"select",selectorOptions:["5x5","6x6","8x8","10x10","12x12","15x15"],title:"Specify the symbol's size.",fun:function(e){var t=r.findPlotCurve(s.val());Utility.setSymbolSize(t,T[e]),a.setSymbolIcon()}}),this.addProperty({name:"Fill",title:"If the curve style is not equal to Sticks, the area between the curve and the baseline can be filled.",id:"curveFill"}),this.addProperty({name:"Brush",id:"curveFillBrushColor",parentId:"curveFill",type:"color",title:"Assign the brush used to fill the curve.",fun:function(t){var n=r.findPlotCurve(s.val());if(n.fill){let e=n.brush();e.color=t,n.setBrush(e)}a.setBrushIcon()}}),this.addProperty({name:"Fill Curve",id:"fillCurve",parentId:"curveFill",type:"checkbox",title:"If checked, curve filling is enabled.",fun:function(e){var t=r.findPlotCurve(s.val());if(t.fill=e){let e=t.brush();e.color=M.val(),t.setBrush(e)}else Utility.removeCurveBrush(t);a.setBrushIcon()}}),this.addProperty({name:"Baseline",id:"baseline",type:"number",value:0,step:.5,title:"Set the value of the baseline. The baseline is required for filling the curve with a brush or the Sticks curve style.",fun:function(e){let t=r.findPlotCurve(s.val());t.setBaseline(e)}}),this.addProperty({name:"Pen Width",id:"penWidth",type:"select",selectorOptions:[1,2,3,4,5],title:"Assign a pen width.",fun:function(e){let t=r.findPlotCurve(s.val());t.setPenWidth(e+1)}}),this.addProperty({name:"Colormap",id:"colormap",type:"select",selectorOptions:["RGB-map","Indexed-map"],title:"Change the color map. Color Maps are used for mapping the intensity values to colors",fun:function(e){let t=r.findPlotCurve(s.val());0==e?t.setSpectrogramColorMap(Enum.ColorMap.RGBMap):t.setSpectrogramColorMap(Enum.ColorMap.IndexMap)}}),this.addProperty({name:"Interpolation",id:"interpolation",type:"select",selectorOptions:["Bi-Linear","Bi-Cubic"],title:"Select the interpolation type.",fun:function(e){let t=r.findPlotCurve(s.val());var n=t.data();n.hasOwnProperty("_interpolationType")&&(0==e?n.setInterpolaionType(Enum.InterpolationType.linear):n.setInterpolaionType(Enum.InterpolationType.cubic),t.invalidateCache(),t.itemChanged())}});var n=this.addProperty({name:"Spectrogram",title:"Configure how the spectrogram is drawn.",id:"spectrogram"});this.addProperty({name:"show",id:"showSpectrogram",parentId:"spectrogram",type:"checkbox",checked:!0,title:"If checked, the spectrogram is drawn.",fun:function(e){let t=r.findPlotCurve(s.val());t.showSpectrogram(e),p(t)}}),this.addProperty({name:"alpha",id:"alpha",parentId:"spectrogram",type:"number",min:0,max:255,value:255,step:1,title:"Set an alpha value for the raster data.",fun:function(e){let t=r.findPlotCurve(s.val());t.setAlpha(e),p(t)}});var u=this.addProperty({name:"Contours",title:"Configure contours.",id:"contours"});function h(){var t=s.children();for(let e=0;e<t.length;++e)s[0].removeChild(t[e]);for(var e=r.itemList(),n=[],i=0;i<e.length;++i)e[i].rtti!==Static.Rtti_PlotCurve&&e[i].rtti!==Static.Rtti_PlotSpectroCurve&&e[i].rtti!==Static.Rtti_PlotSpectrogram||n.push(e[i]);for(let t=0;t<n.length;++t){let e=$("<option>"+n[t].title()+"</option>");e.attr("value",n[t].title()),s.append(e)}Static.trigger("currentCurveChangedViaPropertiesPane",n[0])}this.addProperty({name:"show",id:"showContours",parentId:"contours",type:"checkbox",title:"If checked, contours are drawn.",fun:function(e){let t=r.findPlotCurve(s.val());t.showContour(e),f(t)}}),this.addProperty({name:"Number of planes",id:"numberOfPlanes",parentId:"contours",type:"number",min:0,max:20,value:10,step:1,title:"Set the number of contour planes.",fun:function(e){let t=r.findPlotCurve(s.val());t.setNumberOfContourPlanes(parseInt(e)),f(t)}}),this.addProperty({name:"Color interval",title:"Set the color range.",id:"colorInterval"}),this.addProperty({name:"color1",id:"color1",parentId:"colorInterval",type:"color",title:"Color used for the minimum value of the value interval.",fun:function(e){let t=r.findPlotCurve(s.val());t.setColorInterval(e,Static.RGB2HTML(t.color2()))}}),this.addProperty({name:"color2",id:"color2",parentId:"colorInterval",type:"color",title:"Color used for the maximum value of the value interval.",fun:function(e){let t=r.findPlotCurve(s.val());t.setColorInterval(Static.RGB2HTML(t.color1()),e)}}),this.addProperty({name:"Color range",title:"Set the value interval, that corresponds to the color map.",id:"colorRange"}),this.addProperty({name:"minimum Z",id:"minimumZ",parentId:"colorRange",type:"number",title:"Lower limit of the interval.",fun:function(e){let t=r.findPlotCurve(s.val());t.colorRange().setMinValue(e),r.autoRefresh()}}),this.addProperty({name:"maximum Z",id:"maximumZ",parentId:"colorRange",type:"number",title:"Upper limit of the interval.",fun:function(e){let t=r.findPlotCurve(s.val());t.colorRange().setMaxValue(e),r.autoRefresh()}}),this.init(),this.setFontSize("12px"),Static.bind("showGridItem",function(e,t,n,i){"left"==t&&0==n&&i&&X(r.findPlotCurve(s.val()))}),Static.bind("itemAttached",function(e,t,n){t.rtti!=Static.Rtti_PlotCurve&&t.rtti!=Static.Rtti_PlotSpectroCurve&&t.rtti!=Static.Rtti_PlotSpectrogram||(n||(r.hasVisiblePlotCurve()||r.hasVisiblePlotSpectroCurve()||r.hasVisiblePlotSpectrogram()||r.leftSidebar.showGridItem(0,!1),r.hasPlotCurve()),h(),X(r.findPlotCurve(s.val())))}),r.leftSidebar.showGridItem(0,!1);var t=-1;Static.bind("curveRenamed",function(){-1==t&&(t=s[0].selectedIndex),h(),s[0].selectedIndex=t;r.findPlotCurve(s.val());t=-1});var d=[Lines,Sticks,Steps,Dots,NoCurve];function f(e){var t="Visible";e.testDisplayMode(Enum.DisplayMode.ContourMode)||(t="Hidden"),u.html(t+", planes:"+e.contourLevels().length)}function p(e){var t="Visible";e.testDisplayMode(Enum.DisplayMode.ImageMode)||(t="Hidden"),n.html(t+", alpha:"+e.alpha())}function m(e){var t="Left";e.yAxis()==yRight&&(t="Right");var n="Bottom";e.xAxis()==xTop&&(n="Top"),o.html(n+", "+t)}Static.bind("curveStyleChanged",function(e,t){X(t)}),Static.bind("axisChanged",function(e,t,n){X(n)}),this.penIcon=function(e){if(!e)return null;var t=new Graphic(null,50,16),n=new PaintUtil.Painter(t);return e.pen().color!=Static.NoPen&&(e=e.pen(),n.setPen(e),n.drawLine(0,8,50,8)),n=null,t},this.spanElem=null;var g=this.getElementValueDataAttribute("curvePen").parent();this.setPenIcon=function(){var e=r.findPlotCurve(s.val()),t=g,e=this.penIcon(e);this.spanElem&&this.spanElem.remove(),this.spanElem=$('<span id="spanElem" />'),e&&e.setParent(this.spanElem),this.spanElem.appendTo(t)};var v=this.getElementValueDataAttribute("curvePenColor");Static.bind("penAttributeChanged",function(e,t){X(t)});var b=["solid","dot","dash","dashDot","dashDotDot"],S=this.getElementValueDataAttribute("curvePenStyle");var y=this.getElementValueDataAttribute("curvePenWidth");var x=this.getElementValueDataAttribute("curveSymbolSize");this.symbolIcon=function(e){if(!e)return null;var t=new Misc.Size(10,10),n=new Graphic(null,10,10),i=new PaintUtil.Painter(n);return e.symbol()&&(e.symbol().style(),i.setPen(e.symbol().pen()),e.symbol().drawGraphicSymbol(i,new Misc.Point(5,5),t)),i=null,n},this.spanElem2=null;var w=this.getElementValueDataAttribute("curveSymbol").parent();this.setSymbolIcon=function(){var e=r.findPlotCurve(s.val()),t=w,e=this.symbolIcon(e);this.spanElem2&&this.spanElem2.remove(),this.spanElem2=$('<span id="spanElem2" />'),e&&e.setParent(this.spanElem2),this.spanElem2.appendTo(t)},Static.bind("symbolAdded symbolAttributeChanged",function(e,t){X(t)});var C=this.getElementValueDataAttribute("curveSymbolPenColor");var E=this.getElementValueDataAttribute("curveSymbolPenWidth");var k=this.getElementValueDataAttribute("curveSymbolBrushColor");var x=this.getElementValueDataAttribute("curveSymbolSize"),P=this.getElementValueDataAttribute("curveSymbolStyle"),R=["None","MRect","Cross","Diamond","Ellipse","XCross"],A=[MRect,Cross,Diamond,Ellipse,XCross];var T=[5,6,8,10,12,15];var B=this.getElementValueDataAttribute("curveFill").parent();this.brushIcon=function(e,t){if(!e)return null;new Misc.Size(12,12);var n=new Graphic(null,12,12),i=new PaintUtil.Painter(n);if("noBrush"==e.brush().color)return null;i.setBrush(e.brush());e=new Misc.Rect(new Misc.Point,new Misc.Size(12,12));return e.moveCenter(new Misc.Point(6,6)),i.drawRect(e.left(),e.top(),e.width(),e.height()),i=null,n},this.spanElem3=null;var M=this.getElementValueDataAttribute("curveFillBrushColor");M.parent();this.setBrushIcon=function(){var e=r.findPlotCurve(s.val()),t=B,e=a.brushIcon(e);this.spanElem3&&this.spanElem3.remove(),this.spanElem3=$('<span id="spanElem" />'),e&&e.setParent(this.spanElem3),this.spanElem3.appendTo(t)};var D=this.getElementValueDataAttribute("fillCurve");Static.bind("curveBrushChanged",function(e,t){X(t)});var I=this.getElementValueDataAttribute("baseline");var L=a.getElementValueDataAttribute("showContours"),F=a.getElementValueDataAttribute("numberOfPlanes"),O=a.getElementValueDataAttribute("showSpectrogram"),N=a.getElementValueDataAttribute("alpha"),z=a.getElementValueDataAttribute("penWidth"),W=a.getElementValueDataAttribute("color1"),V=a.getElementValueDataAttribute("color2"),U=a.getElementValueDataAttribute("minimumZ"),H=a.getElementValueDataAttribute("maximumZ");function X(e){var t,n;e&&e.title()===s.val()&&(e.rtti===Static.Rtti_PlotSpectroCurve?(a.show("penWidth"),a.show("colorInterval"),a.show("colorRange"),z[0].selectedIndex=e.penWidth()-1,W.val(Static.RGB2HTML(e.color1())),V.val(Static.RGB2HTML(e.color2())),t=e.colorRange(),U.val(t.minValue()),H.val(t.maxValue())):(a.hide("penWidth"),a.hide("colorInterval"),a.hide("colorRange")),e.rtti===Static.Rtti_PlotSpectrogram?(e.isVisible()?(a.show("spectrogram"),a.show("contours")):(a.hide("spectrogram"),a.hide("contours")),a.show("colormap"),e.data().hasOwnProperty("_interpolationType")?a.show("interpolation"):a.hide("interpolation"),e.testDisplayMode(Enum.DisplayMode.ImageMode),O[0].checked=e.testDisplayMode(Enum.DisplayMode.ImageMode),N.val(e.alpha()),L[0].checked=e.testDisplayMode(Enum.DisplayMode.ContourMode),F.val(e.contourLevels().length),p(e),f(e)):(a.hide("spectrogram"),a.hide("contours"),a.hide("interpolation"),a.hide("colormap")),e.rtti===Static.Rtti_PlotSpectroCurve||e.rtti===Static.Rtti_PlotSpectrogram?(a.hide("fitCurve"),a.hide("curveSymbol"),a.hide("legendAttributes"),a.hide("orientation"),a.hide("curveStyle"),a.hide("curveFill"),a.hide("baseline"),a.hide("curvePen")):(a.show("fitCurve"),a.show("curveSymbol"),a.show("legendAttributes"),a.show("orientation"),a.show("curveStyle"),a.show("curveFill"),a.show("baseline"),a.show("curvePen")),e.rtti===Static.Rtti_PlotCurve&&(v.val(Static.colorNameToHex(e.pen().color)),S[0].selectedIndex=b.indexOf(e.pen().style),y[0].selectedIndex=e.pen().width-1,e.symbol()?(C.val(Static.colorNameToHex(e.symbol().pen().color)),E[0].selectedIndex=e.symbol().pen().width-1,k.val(Static.colorNameToHex(e.symbol().brush().color)),n=-1,n="None"==e.symbol().style()?0:A.indexOf(e.symbol().style())+1,P[0].selectedIndex=n,x[0].selectedIndex=T.indexOf(e.symbol().size().height)):(C.val(Static.colorNameToHex("black")),E[0].selectedIndex=0,k.val(Static.colorNameToHex("black")),P[0].selectedIndex=0,x[0].selectedIndex=3)),e.rtti===Static.Rtti_PlotCurve&&(i[0].selectedIndex=_.keys(d)[_.values(d).indexOf(e.style())]),l[0].selectedIndex=e.xAxis()==xBottom?0:1,c[0].selectedIndex=e.yAxis()==yLeft?0:1,m(e),e.rtti===Static.Rtti_PlotCurve&&(a.setPenIcon(),a.setSymbolIcon(),D[0].checked=e.fill,M.val(e.brush().color),a.setBrushIcon(),I.val(e.baseline()),n=a.getElementValueDataAttribute("orientation"),e.orientation()==Vertical?n[0].selectedIndex=0:n[0].selectedIndex=1))}Static.bind("visibilityChange",function(e,t,n){t.rtti==Static.Rtti_PlotSpectrogram&&t.title()==s.val()&&t.rtti===Static.Rtti_PlotSpectrogram&&(n?(a.show("spectrogram"),a.show("contours")):(a.hide("spectrogram"),a.hide("contours")))})}}define("curvePropertiesPane",["propertiesPane"],function(){});class PlotPropertiesPane extends PropertiesPane{constructor(e,s){super(e);var n=this;n.setHeader(s.leftSidebar.gridItem(1).headerElement,"Plot Properties",!0),this.shadeWatchArea=!0,this.addProperty({name:"General Settings",title:"General properties",id:"generalSettings"}),this.addProperty({name:"Plot Title",title:"Configure plot title",id:"plotTitle",parentId:"generalSettings"});var t=this.addProperty({name:"Title",id:"plotTitleTitle",parentId:"plotTitle",type:"text",title:"Set a plot title",fun:function(e){s.setTitle(e)}});this.addProperty({name:"Font",id:"plotTitleFont",parentId:"plotTitle",type:"select",selectorOptions:PropertiesPane.fontsDisplay(),title:"Set plot title font type",fun:function(e){var t=s.titleFont();t.name=PropertiesPane.fontGroup(e),s.setTitleFont(t)}}),this.addProperty({name:"Point",id:"plotTitlePoint",parentId:"plotTitle",type:"number",value:"20",min:"6",max:"32",title:"Set plot title font size",fun:function(e){var t=s.titleFont();t.th=e,s.setTitleFont(t)}}),this.addProperty({name:"Color",id:"plotTitleColor",parentId:"plotTitle",type:"color",title:"Set plot title font color",fun:function(e){var t=s.titleFont();t.fontColor=e,s.setTitleFont(t)}}),this.addProperty({name:"Bold",id:"plotTitleBold",parentId:"plotTitle",type:"checkbox",checked:!0,title:"Set plot title font weight",fun:function(e){var t=s.titleFont();t.weight=e?"bold":"normal";s.setTitleFont(t)}}),this.addProperty({name:"Plot Footer",title:"Configure plot footer",id:"plotFooter",parentId:"generalSettings"}),this.addProperty({name:"Footer",id:"plotFooterFooter",parentId:"plotFooter",type:"text",value:"Footer",title:"Set a plot footer",fun:function(e){s.setFooter(e)}}),this.addProperty({name:"Font",id:"plotFooterFont",parentId:"plotFooter",type:"select",selectorOptions:PropertiesPane.fontsDisplay(),title:"Set plot footer font type",fun:function(e){var t=s.footerFont();t.name=PropertiesPane.fontGroup(e),s.setFooterFont(t)}}),this.addProperty({name:"Point",id:"plotFooterPoint",parentId:"plotFooter",type:"number",value:"20",min:"6",max:"32",title:"Set plot footer font size",fun:function(e){var t=s.footerFont();t.th=e,s.setFooterFont(t)}}),this.addProperty({name:"Color",id:"plotFooterColor",parentId:"plotFooter",type:"color",title:"Set plot footer font color",fun:function(e){var t=s.footerFont();t.fontColor=e,s.setFooterFont(t)}}),this.addProperty({name:"Bold",id:"plotFooterBold",parentId:"plotFooter",type:"checkbox",checked:!0,title:"Set plot footer font weight",fun:function(e){var t=s.footerFont();t.weight=e?"bold":"normal";s.setFooterFont(t)}}),this.addProperty({name:"Background",id:"plotBackground",parentId:"generalSettings",type:"color",value:"#ffffc8",title:"Set plot background color",fun:function(e){s.setPlotBackground(e)}}),this.addProperty({name:"Legend",title:"Configure legend",id:"plotLegend",parentId:"generalSettings"}),this.addProperty({name:"Background",id:"plotLegendBackground",parentId:"plotLegend",type:"color",value:"#ffffff",title:"Set legend background color",fun:function(e){var t=s.getLayout().getLegendDiv().children()[0];$(t).css("background-color",e)}}),this.addProperty({name:"Show Line",id:"plotLegendShowLine",parentId:"plotLegend",type:"checkbox",title:"If checked, curve is represented by a line on the legend",fun:function(e){Static.showline=e}}),this.addProperty({name:"Show Symbol",id:"plotLegendShowSymbol",parentId:"plotLegend",type:"checkbox",title:"If checked, attached symbols are represented on the legend",fun:function(e){Static.showsymbol=e}}),this.addProperty({name:"Scale Settings",title:"Configure scales",id:"scaleSettings"}),this.addProperty({name:"Title",title:"Configure scale title",id:"scaleTitle",parentId:"scaleSettings"});var i=this.addProperty({name:"Bottom",id:"bottomScaleTitle",parentId:"scaleTitle",type:"text",value:"Bottom-Scale",title:"Set bottom scale title",fun:i}),r=this.addProperty({name:"Top",id:"topScaleTitle",parentId:"scaleTitle",type:"text",value:"Top-Scale",title:"Set top scale title",fun:r}),a=this.addProperty({name:"Left",id:"leftScaleTitle",parentId:"scaleTitle",type:"text",value:"Left-Scale",title:"Set left scale title",fun:a}),o=this.addProperty({name:"Right",id:"rightScaleTitle",parentId:"scaleTitle",type:"text",value:"Right-Scale",title:"Set right scale title",fun:o});this.addProperty({name:"Font",id:"scaleTitleFont",parentId:"scaleTitle",type:"select",selectorOptions:PropertiesPane.fontsDisplay(),title:"Set scale title font type",fun:function(e){var t=s.axisTitleFont(xBottom);t.name=PropertiesPane.fontGroup(e),s.setAxisTitleFont(xBottom,t),s.setAxisTitleFont(xTop,t),s.setAxisTitleFont(yLeft,t),s.setAxisTitleFont(yRight,t)}}),this.addProperty({name:"Point",id:"scaleTitlePoint",parentId:"scaleTitle",type:"number",value:"20",min:"6",max:"32",title:"Set scale title font size",fun:function(e){var t=s.axisTitleFont(xBottom);t.th=.86*e,s.setAxisTitleFont(xBottom,t),s.setAxisTitleFont(xTop,t),s.setAxisTitleFont(yLeft,t),s.setAxisTitleFont(yRight,t)}}),this.addProperty({name:"Color",id:"scaleTitleColor",parentId:"scaleTitle",type:"color",title:"Set scale title font color",fun:function(e){var t=s.axisTitleFont(xBottom);t.fontColor=e,s.setAxisTitleFont(xBottom,t),s.setAxisTitleFont(xTop,t),s.setAxisTitleFont(yLeft,t),s.setAxisTitleFont(yRight,t)}}),this.addProperty({name:"Bold",id:"scaleTitleBold",parentId:"scaleTitle",type:"checkbox",title:"Set scale title font weight",fun:function(e){var t=s.axisTitleFont(xBottom);t.weight=e?"bold":"normal";s.setAxisTitleFont(xBottom,t),s.setAxisTitleFont(xTop,t),s.setAxisTitleFont(yLeft,t),s.setAxisTitleFont(yRight,t)}}),this.addProperty({name:"Type & precision",title:"Configure scale type and precision",id:"scalePosition",parentId:"scaleSettings"}),this.addProperty({name:"Bottom",title:"Configure bottom scale type",id:"scalePositionBottom",parentId:"scalePosition"});var l=this.addProperty({name:"Linear",title:"Linear scale",id:"scalePositionBottomLinear",parentId:"scalePositionBottom",type:"radio",checked:!0,group:"scalePositionBottomGroup"}),c=this.addProperty({name:"Log",title:"Log scale",id:"scalePositionBottomLog",parentId:"scalePositionBottom",type:"radio",group:"scalePositionBottomGroup"}),u=this.addProperty({name:"Base",title:"Set the base of Log scale",id:"scalePositionBottomBase",parentId:"scalePositionBottom",disabled:!0,type:"number",value:"10",min:"2",max:"10"}),h=this.addProperty({name:"Precision",title:"Display scale labels either as exponential or fixed-point notation with the specified number of digits.",id:"scalePositionBottomBottom",parentId:"scalePositionBottom",type:"number",value:"4",min:"2",max:"10"});this.addProperty({name:"Top",title:"Configure top scale type",id:"scalePositionTop",parentId:"scalePosition"});var d=this.addProperty({name:"Linear",title:"Linear scale",id:"scalePositionTopLinear",parentId:"scalePositionTop",type:"radio",checked:!0,group:"scalePositionTopGroup"}),f=this.addProperty({name:"Log",title:"Log scale",id:"scalePositionTopLog",parentId:"scalePositionTop",type:"radio",group:"scalePositionTopGroup"}),p=this.addProperty({name:"Base",title:"Set the base of Log scale",id:"scalePositionTopBase",parentId:"scalePositionTop",disabled:!0,type:"number",value:"10",min:"2",max:"10"}),m=this.addProperty({name:"Precision",title:"Display scale labels either as exponential or fixed-point notation with the specified number of digits.",id:"scalePositionTopTop",parentId:"scalePositionTop",type:"number",value:"4",min:"2",max:"10"});this.addProperty({name:"Left",title:"Configure left scale type",id:"scalePositionLeft",parentId:"scalePosition"});var g=this.addProperty({name:"Linear",title:"Linear scale",id:"scalePositionLeftLinear",parentId:"scalePositionLeft",type:"radio",checked:!0,group:"scalePositionLeftGroup"}),v=this.addProperty({name:"Log",title:"Log scale",id:"scalePositionLeftLog",parentId:"scalePositionLeft",type:"radio",group:"scalePositionLeftGroup"}),b=this.addProperty({name:"Base",title:"Set the base of Log scale",id:"scalePositionLeftBase",parentId:"scalePositionLeft",disabled:!0,type:"number",value:"10",min:"2",max:"10"}),S=this.addProperty({name:"Precision",title:"Display scale labels either as exponential or fixed-point notation with the specified number of digits.",id:"scalePositionLeftLeft",parentId:"scalePositionLeft",type:"number",value:"4",min:"2",max:"10"});this.addProperty({name:"Right",title:"Configure right scale type",id:"scalePositionRight",parentId:"scalePosition"});var y=this.addProperty({name:"Linear",title:"Linear scale",id:"scalePositionRightLinear",parentId:"scalePositionRight",type:"radio",checked:!0,group:"scalePositionRightGroup"}),x=this.addProperty({name:"Log",title:"Log scale",id:"scalePositionRightLog",parentId:"scalePositionRight",type:"radio",group:"scalePositionRightGroup"}),w=this.addProperty({name:"Base",title:"Set the base of Log scale",id:"scalePositionRightBase",parentId:"scalePositionRight",disabled:!0,type:"number",value:"10",min:"2",max:"10"}),_=this.addProperty({name:"Precision",title:"Display scale labels either as exponential or fixed-point notation with the specified number of digits.",id:"scalePositionRightRight",parentId:"scalePositionRight",type:"number",value:"4",min:"2",max:"10"});this.addProperty({name:"Limits",title:"Configure scale limits",id:"scaleLimits",parentId:"scaleSettings"});var C=this.addProperty({name:"Enable user scale",id:"limitsEnableUserScale",parentId:"scaleLimits",type:"checkbox"});this.addProperty({name:"Bottom",id:"limitsBottom",parentId:"scaleLimits"});var E=this.addProperty({name:"minimum",id:"limitsBottomMinimum",parentId:"limitsBottom",type:"number",value:"0",disabled:!0}),k=this.addProperty({name:"maximum",id:"limitsBottomMaximum",parentId:"limitsBottom",type:"number",value:"0",disabled:!0});this.addProperty({name:"Left",id:"limitsLeft",parentId:"scaleLimits"});var P=this.addProperty({name:"minimum",id:"limitsLeftMinimum",parentId:"limitsLeft",type:"number",value:"0",disabled:!0}),R=this.addProperty({name:"maximum",id:"limitsLeftMaximum",parentId:"limitsLeft",type:"number",value:"0",disabled:!0});this.addProperty({name:"Top",id:"limitsTop",parentId:"scaleLimits"});var A=this.addProperty({name:"minimum",id:"limitsTopMinimum",parentId:"limitsTop",type:"number",value:"0",disabled:!0}),T=this.addProperty({name:"maximum",id:"limitsTopMaximum",parentId:"limitsTop",type:"number",value:"0",disabled:!0});this.addProperty({name:"Right",id:"limitsRight",parentId:"scaleLimits"});var B=this.addProperty({name:"minimum",id:"limitsRightMinimum",parentId:"limitsRight",type:"number",value:"0",disabled:!0}),M=this.addProperty({name:"maximum",id:"limitsRightMaximum",parentId:"limitsRight",type:"number",value:"0",disabled:!0});this.addProperty({name:"Margins",title:"Set scale margins",id:"scaleMargins",parentId:"scaleSettings"});var D=this.addProperty({name:"Left axis",id:"scaleMarginsLeftAxis",parentId:"scaleMargins",type:"number",min:"0",value:"0.0"}),I=this.addProperty({name:"Right axis",id:"scaleMarginsRightAxis",parentId:"scaleMargins",type:"number",min:"0",value:"0.0"}),L=this.addProperty({name:"Bottom axis",id:"scaleMarginsBottomAxis",parentId:"scaleMargins",type:"number",min:"0",value:"0.0"}),F=this.addProperty({name:"Top axis",id:"scaleMarginsTopAxis",parentId:"scaleMargins",type:"number",min:"0",value:"0.0"});this.addProperty({name:"Components",title:"Configure plot components",id:"scaleComponents",parentId:"scaleSettings"});var O=this.addProperty({name:"Show backbone",id:"scaleComponentsShowBackbone",parentId:"scaleComponents",type:"checkbox",checked:!0}),N=this.addProperty({name:"Show labels",id:"scaleComponentsShowLabels",parentId:"scaleComponents",type:"checkbox",checked:!0}),z=this.addProperty({name:"Show ticks",id:"scaleComponentsShowTicks",parentId:"scaleComponents",type:"checkbox",checked:!0}),W=this.addProperty({name:"Tick length",id:"scaleComponentsTickLength",parentId:"scaleComponents",type:"select",selectorOptions:["Small","Medium","Large"]});this.addProperty({name:"Error Settings",title:"Configure error handling",id:"errorSettings"});var V=this.addProperty({name:"When an error occurs",id:"errorResponse",parentId:"errorSettings",type:"select",selectorOptions:["Stop and warn","Silently ignore","Allow for ignore"]}),U=this.addProperty({name:"Zoomer Settings",title:"Configure zoomer",id:"zoomerSettings"}),H=this.addProperty({name:"Zoom according to the current curve axes",id:"zoomerAxes",parentId:"zoomerSettings",type:"checkbox",checked:!0}),X=this.addProperty({name:"Horizontal",id:"zoomerHorizontalAxes",parentId:"zoomerSettings",type:"select",selectorOptions:["Bottom","Top"],disabled:!0}),G=this.addProperty({name:"Vertical",id:"zoomerVerticalAxes",parentId:"zoomerSettings",type:"select",selectorOptions:["Left","Right"],disabled:!0}),j=this.addProperty({name:"Magnifier Settings",title:"Configure magnifier",id:"magnifierSettings"}),Y=this.addProperty({name:"Left axis enabled",id:"magnifierLeftAxis",parentId:"magnifierSettings",type:"checkbox",checked:!0}),K=this.addProperty({name:"Right axis enabled",id:"magnifierRightAxis",parentId:"magnifierSettings",type:"checkbox"}),Z=this.addProperty({name:"Bottom axis enabled",id:"magnifierBottomAxis",parentId:"magnifierSettings",type:"checkbox",checked:!0}),q=this.addProperty({name:"Top axis enabled",id:"magnifierTopAxis",parentId:"magnifierSettings",type:"checkbox"}),Q=this.addProperty({name:"Watch Settings",title:"Configure watch",id:"watchSettings"}),J=this.addProperty({name:"Calculation accuracy",id:"watchCalculationAccuracy",parentId:"watchSettings"}),ee=this.addProperty({name:"Low",id:"watchCalculationAccuracyLow",parentId:"watchCalculationAccuracy",type:"radio",group:"watchCalculationAccuracyGroup"}),te=this.addProperty({name:"Moderate",id:"watchCalculationAccuracyModerate",parentId:"watchCalculationAccuracy",type:"radio",group:"watchCalculationAccuracyGroup",checked:!0}),ne=this.addProperty({name:"High",id:"watchCalculationAccuracyHigh",parentId:"watchCalculationAccuracy",type:"radio",group:"watchCalculationAccuracyGroup"}),ie=(this.addProperty({name:"Decimal places in calculation",title:"Set the maximum decimal places used in calculations for an axis",id:"decimalPlacesForCalculationy",parentId:"watchCalculationAccuracy"}),this.addProperty({name:"Bottom axis",title:"Set the maximum decimal places used in calculations",id:"scalePositionBottomBottom",parentId:"decimalPlacesForCalculationy",type:"number",value:"2",min:"0"})),re=this.addProperty({name:"Left axis",title:"Set the maximum decimal places used in calculations",id:"scalePositionBottomBottom",parentId:"decimalPlacesForCalculationy",type:"number",value:"2",min:"0"}),ae=this.addProperty({name:"Top axis",title:"Set the maximum decimal places used in calculations",id:"scalePositionBottomBottom",parentId:"decimalPlacesForCalculationy",type:"number",value:"2",min:"0"}),se=this.addProperty({name:"Right axis",title:"Set the maximum decimal places used in calculations",id:"scalePositionBottomBottom",parentId:"decimalPlacesForCalculationy",type:"number",value:"2",min:"0"}),oe=this.addProperty({name:"Shading",id:"watchShading",parentId:"watchSettings"}),le=this.addProperty({name:"Shade watch area",id:"watchShadeWatchArea",parentId:"watchShading",type:"checkbox",checked:!0}),ce=this.addProperty({name:"Scale shaded area",id:"watchShadeAutoScale",parentId:"watchShading",type:"checkbox",checked:!0}),ue=this.addProperty({name:"Shade color",id:"watchShadeColor",parentId:"watchShading",value:"#006464",type:"color"}),he=this.addProperty({name:"Watch centroid with area",id:"watchCentroidWithArea",parentId:"watchSettings",type:"checkbox",checked:!0});this.addProperty({name:"Grid Settings",title:"Configure grid",id:"gridSettings"}),this.addProperty({name:"Minor Lines",id:"gridMinorLines",parentId:"gridSettings"});var de=this.addProperty({name:"Show",id:"gridMinorLinesShow",parentId:"gridMinorLines",type:"checkbox",checked:!0}),fe=this.addProperty({name:"Minors per major",id:"gridMinorsPerMajor",parentId:"gridMinorLines",type:"number",value:"5",min:"2",max:"20"}),pe=this.addProperty({name:"Color",id:"gridMinorLinesColor",parentId:"gridMinorLines",type:"color"});this.addProperty({name:"Major Lines",id:"gridMajorLines",parentId:"gridSettings"});var me=this.addProperty({name:"Show",id:"gridMajorLinesShow",parentId:"gridMajorLines",type:"checkbox",checked:!0}),ge=this.addProperty({name:"Majors",id:"gridMajorMajors",parentId:"gridMajorLines",type:"number",value:"8",min:"1",max:"40"}),ve=this.addProperty({name:"Color",id:"gridMajorLinesColor",parentId:"gridMajorLines",type:"color"}),be=this.addProperty({name:"Grid Axes",id:"gridAxes",parentId:"gridSettings"}),Se=this.addProperty({name:"According to current curve",id:"gridAxesAccordingToCurve",parentId:"gridAxes",type:"checkbox",checked:!0}),ye=this.addProperty({name:"Horizontal",id:"gridHorizontalAxes",parentId:"gridAxes",type:"select",selectorOptions:["Bottom","Top"],disabled:!0}),xe=this.addProperty({name:"Vertical",id:"gridVerticalAxes",parentId:"gridAxes",type:"select",selectorOptions:["Left","Right"],disabled:!0}),we=this.addProperty({name:"When a point is selected",title:"Set what happens to selected point",id:"pointSelected",type:"select",selectorOptions:["Display data","remove it","Modify it"]}),e=this.addProperty({name:"Add/Remove Point",title:"If checked, point addition/removal with Shift-Left click is enabled.",id:"addRemovePoint",type:"checkbox"});function i(e){s.setAxisTitle(xBottom,e)}function r(e){s.setAxisTitle(xTop,e)}function a(e){s.setAxisTitle(yLeft,e)}function o(e){s.setAxisTitle(yRight,e)}function _e(e){E.attr("disabled",e),k.attr("disabled",e),P.attr("disabled",e),R.attr("disabled",e),A.attr("disabled",e),T.attr("disabled",e),B.attr("disabled",e),M.attr("disabled",e)}this.init(),c.change(function(){u.attr("disabled",!1),Static.trigger("invalidateWatch"),s.setAxisScaleEngine(xBottom,new LogScaleEngine)}),u.change(function(){Static.trigger("invalidateWatch"),s.axisScaleEngine(yLeft).setBase($(this).val()),s.autoRefresh()}),l.change(function(){u.attr("disabled",!0),Static.trigger("invalidateWatch"),s.setAxisScaleEngine(xBottom,new LinearScaleEngine)}),v.change(function(){b.attr("disabled",!1),Static.trigger("invalidateWatch"),s.setAxisScaleEngine(yLeft,new LogScaleEngine)}),$("#left_logBase").change(function(){Static.trigger("invalidateWatch"),m_plot.axisScaleEngine(yLeft).setBase($(this).val()),m_plot.autoRefresh()}),g.change(function(){b.attr("disabled",!0),Static.trigger("invalidateWatch"),s.setAxisScaleEngine(yLeft,new LinearScaleEngine)}),f.change(function(){p.attr("disabled",!1),Static.trigger("invalidateWatch"),s.setAxisScaleEngine(xTop,new LogScaleEngine)}),p.change(function(){Static.trigger("invalidateWatch"),s.axisScaleEngine(yLeft).setBase($(this).val()),s.autoRefresh()}),d.change(function(){$("#top_logBase").attr("disabled",!0),Static.trigger("invalidateWatch"),s.setAxisScaleEngine(xTop,new LinearScaleEngine)}),x.change(function(){w.attr("disabled",!1),Static.trigger("invalidateWatch"),s.setAxisScaleEngine(yRight,new LogScaleEngine)}),w.change(function(){Static.trigger("invalidateWatch"),s.axisScaleEngine(yLeft).setBase($(this).val()),s.autoRefresh()}),y.change(function(){$("#right_logBase").attr("disabled",!0),Static.trigger("invalidateWatch"),s.setAxisScaleEngine(yRight,new LinearScaleEngine)}),h.change(function(){s.setAxisPrecision(xBottom,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")}),m.change(function(){s.setAxisPrecision(xTop,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")}),S.change(function(){s.setAxisPrecision(yLeft,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")}),_.change(function(){s.setAxisPrecision(yRight,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")}),ie.val(s.axisDecimalPlaces(xBottom)),ie.change(function(){s.setAxisDecimalPlaces(xBottom,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")}),ae.val(s.axisDecimalPlaces(xTop)),ae.change(function(){s.setAxisDecimalPlaces(xTop,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")}),re.val(s.axisDecimalPlaces(yLeft)),re.change(function(){s.setAxisDecimalPlaces(yLeft,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")}),se.val(s.axisDecimalPlaces(yRight)),se.change(function(){s.setAxisDecimalPlaces(yRight,parseInt($(this).val())),Static.trigger("invalidateWatch"),Static.trigger("decimalPlacesChanged")}),C.change(function(){_e(!this.checked),P.val()!==R.val()&&s.setAxisScale(yLeft,parseFloat(P.val()),parseFloat(R.val())),E.val()!==k.val()&&s.setAxisScale(xBottom,parseFloat(E.val()),parseFloat(k.val())),B.val()!==M.val()&&s.setAxisScale(yRight,parseFloat(B.val()),parseFloat(M.val())),A.val()!==T.val()&&s.setAxisScale(xTop,parseFloat(A.val()),parseFloat(T.val()))}),Static.bind("autoScaleChanged",function(e,t){_e(t),C.prop("checked",!t)});var Ce=null;function Ee(){var e=s.axisInterval(xBottom);E.val(e.minValue()),k.val(e.maxValue()),e=s.axisInterval(yLeft),P.val(e.minValue()),R.val(e.maxValue()),e=s.axisInterval(xTop),A.val(e.minValue()),T.val(e.maxValue()),e=s.axisInterval(yRight),B.val(e.minValue()),M.val(e.maxValue())}function ke(e){X.attr("disabled",e),G.attr("disabled",e)}function Pe(){var e="",t="";s.zm;H[0].checked&&Ce?(Ce.yAxis()==yRight?(t="Right",G[0].selectedIndex=1):(t="Left",G[0].selectedIndex=0),Ce.xAxis()==xTop?(e="Top",X[0].selectedIndex=1):(e="Bottom",X[0].selectedIndex=0)):(e=1==X[0].selectedIndex?"Top":"Bottom",t=1==G[0].selectedIndex?"Right":"Left"),U.html(e+", "+t)}function Re(){var e="",t="",n="",i="",r="",a=s.magnifier;a.isAxisEnabled(yLeft)&&(t="Left"),a.isAxisEnabled(yRight)&&(n="Right"),a.isAxisEnabled(xBottom)&&(i="Bottom"),a.isAxisEnabled(xTop)&&(r="Top");a=0;0<(e+=t).length&&(n.length||i.length||r.length)&&(e+=", "),a=e.length,(e+=n).length>a&&(i.length||r.length)&&(e+=", "),a=e.length,(e+=i).length>a&&r.length&&(e+=", "),j.html(e=""==(e+=r)?"No axis enabled":e)}function Ae(e){new Misc.Size(12,12);var t=new Graphic(null,12,12),n=new PaintUtil.Painter(t);n.setBrush(new Misc.Brush(e));e=new Misc.Rect(new Misc.Point,new Misc.Size(12,12));return e.moveCenter(new Misc.Point(6,6)),n.drawRect(e.left(),e.top(),e.width(),e.height()),n=null,t}function Te(e){e=Ae(e);oe[0].children&&$(oe[0].children[0]).remove(),e&&le[0].checked&&e.setParent(oe)}function Be(){var e="",t="No shade";Static.accuracyMaxSteps==.5*Static.accuracyBase*.5&&(e="Low"),Static.accuracyMaxSteps==.5*Static.accuracyBase&&(e="Moderate"),Static.accuracyMaxSteps==Static.accuracyBase&&(e="High"),le[0].checked&&(t="Shade "),J.html(e),Q.html(e+"; "+t),le[0].checked&&Ae(ue.val()).setParent(Q)}function Me(e){ye.attr("disabled",e),xe.attr("disabled",e)}function De(){var e="",t="";s.itemList(Static.Rtti_PlotGrid)[0];Se[0].checked&&Ce?(Ce.yAxis()==yRight?(t="Right",xe[0].selectedIndex=1):(t="Left",xe[0].selectedIndex=0),Ce.xAxis()==xTop?(e="Top",ye[0].selectedIndex=1):(e="Bottom",ye[0].selectedIndex=0)):(e=1==ye[0].selectedIndex?"Top":"Bottom",t=1==xe[0].selectedIndex?"Right":"Left"),be.html(e+", "+t)}Static.bind("itemAttached",function(e,t,n){t.rtti==Static.Rtti_PlotCurve&&Ee()}),E.change(function(){E.val()!==k.val()&&s.setAxisScale(xBottom,parseFloat(E.val()),parseFloat(k.val()))}),k.change(function(){E.val()!==k.val()&&s.setAxisScale(xBottom,parseFloat(E.val()),parseFloat(k.val()))}),A.change(function(){A.val()!==T.val()&&s.setAxisScale(xTop,parseFloat(A.val()),parseFloat(T.val()))}),T.change(function(){A.val()!==T.val()&&s.setAxisScale(xTop,parseFloat(A.val()),parseFloat(T.val()))}),P.change(function(){P.val()!==R.val()&&s.setAxisScale(yLeft,parseFloat(P.val()),parseFloat(R.val()))}),R.change(function(){P.val()!==R.val()&&s.setAxisScale(yLeft,parseFloat(P.val()),parseFloat(R.val()))}),B.change(function(){B.val()!==M.val()&&s.setAxisScale(yRight,parseFloat(B.val()),parseFloat(M.val()))}),M.change(function(){B.val()!==M.val()&&s.setAxisScale(yRight,parseFloat(B.val()),parseFloat(M.val()))}),D.change(function(){var e=0,t=s.axisScaleEngine(yLeft);e=t instanceof LogScaleEngine?(s.axisScaleDiv(yLeft),Static.mLog(t.base(),$(this).val())):(s.axisInterval(yLeft),$(this).val()),s.axisScaleEngine(yLeft).setMargins(e,e),s.autoRefresh()}),I.change(function(){var e=0,t=s.axisScaleEngine(yRight);e=t instanceof LogScaleEngine?(s.axisScaleDiv(yRight),Static.mLog(t.base(),$(this).val())):(s.axisInterval(yRight),$(this).val()),s.axisScaleEngine(yRight).setMargins(e,e),s.autoRefresh()}),L.change(function(){var e=0,t=s.axisScaleEngine(xBottom);e=t instanceof LogScaleEngine?(s.axisScaleDiv(xBottom),Static.mLog(t.base(),$(this).val())):(s.axisInterval(xBottom),$(this).val()),s.axisScaleEngine(xBottom).setMargins(e,e),s.autoRefresh()}),F.change(function(){var e=0,t=s.axisScaleEngine(xTop);e=t instanceof LogScaleEngine?(s.axisScaleDiv(xTop),Static.mLog(t.base(),$(this).val())):(s.axisInterval(xTop),$(this).val()),s.axisScaleEngine(xTop).setMargins(e,e),s.autoRefresh()}),O.change(function(){Utility.enableComponent(s,Enum.ScaleComponent.Backbone,this.checked)}),z.change(function(){Utility.enableComponent(s,Enum.ScaleComponent.Ticks,this.checked),tickLengthRow.toggle(this.checked)}),W.change(function(){Utility.setTickLength(s,["small","medium","large"][$(this)[0].selectedIndex])}),N.change(function(){Utility.enableComponent(s,Enum.ScaleComponent.Labels,this.checked)}),we.change(function(){var e=$(this)[0].selectedIndex;1==e?s.curveClosestPoint.setCb(function(e,t){e.removePoint(t)}):2==e?s.curveClosestPoint.setCb(function(e,t){s.pointEntryDlg.pointEntryCb("Modify/Remove Point",s,e.title(),t)}):s.curveClosestPoint.setCb(null)}),e.change(function(){s.addRemovePoint.activate(this.checked),this.checked?s.zm.setTrackerMode(Static.AlwaysOff):s.zm.setTrackerMode(Static.ActiveOnly)}),V.change(function(){var e=$(this)[0].selectedIndex;1==e?(console.log("Static.silentIgnore"),Static.errorResponse=Static.silentIgnore):2==e?(console.log("Static.warnIgnore"),Static.errorResponse=Static.warnIgnore):(console.log("Static.warn"),Static.errorResponse=Static.warn)}),Static.bind("currentCurveChanged",function(e,t){var n,i;(Ce=t)&&(n=s.zm,H[0].checked?n.setAxis(Ce.xAxis(),Ce.yAxis()):(i=xBottom,1==X[0].selectedIndex&&(i=xTop),t=yLeft,1==G[0].selectedIndex&&(t=yRight),n.setAxis(i,t))),Pe()}),Static.bind("curveAxisChangedViaPropertiesPane axisChanged",function(e,t,n){var i=s.zm;H[0].checked?i.setAxis(n.xAxis(),n.yAxis()):(0==X[0].selectedIndex?i.setAxis(xBottom,i.yAxis()):i.setAxis(xTop,i.yAxis()),0==G[0].selectedIndex?i.setAxis(i.xAxis(),yLeft):i.setAxis(i.xAxis(),yRight)),Pe()}),G.change(function(){var e=s.zm;0==$(this)[0].selectedIndex?e.setAxis(e.xAxis(),yLeft):e.setAxis(e.xAxis(),yRight),Pe()}),X.change(function(){var e=s.zm;0==$(this)[0].selectedIndex?e.setAxis(xBottom,e.yAxis()):e.setAxis(xTop,e.yAxis()),Pe()}),H.click(function(){var e;$(this)[0].checked?ke(!0):(ke(!1),e=s.zm,0==X[0].selectedIndex?e.setAxis(xBottom,e.yAxis()):e.setAxis(xTop,e.yAxis()),0==G[0].selectedIndex?e.setAxis(e.xAxis(),yLeft):e.setAxis(e.xAxis(),yRight)),Pe(),Static.trigger("zoomAccordingToCurve",$(this)[0].checked)}),Y.change(function(){s.magnifier.setAxisEnabled(yLeft,this.checked),Re()}),K.change(function(){s.magnifier.setAxisEnabled(yRight,this.checked),Re()}),Z.change(function(){s.magnifier.setAxisEnabled(xBottom,this.checked),Re()}),q.change(function(){s.magnifier.setAxisEnabled(xTop,this.checked),Re()}),ee.change(function(){Static.accuracyFactor=1.5*Static.accuracyFactorModerate,Be(),Static.trigger("invalidateWatch"),Static.trigger("calculationAccuracy")}),te.change(function(){Static.accuracyFactor=Static.accuracyFactorModerate,Be(),Static.trigger("invalidateWatch"),Static.trigger("calculationAccuracy")}),ne.change(function(){Static.accuracyFactor=.5*Static.accuracyFactorModerate,Be(),Static.trigger("invalidateWatch"),Static.trigger("calculationAccuracy")}),le.change(function(){n.shadeWatchArea=le[0].checked,n.shadeWatchArea?ue.attr("disabled",!1):ue.attr("disabled",!0),Be(),Te(ue.val()),Static.trigger("shadeWatchArea",n.shadeWatchArea)}),ue.change(function(){Te($(this).val()),Be(),Static.trigger("curveShapeColorChanged",$(this).val())}),ce.change(function(){Static.trigger("autoScaleCurveShapeItem",$(this)[0].checked)}),he.change(function(){Static.trigger("watchCentroidWithArea",$(this)[0].checked)}),fe.change(function(){var e=Math.min(Math.max(2,$(this).val()),20);fe.val(e),s.setAxisMaxMinor(yLeft,e),s.setAxisMaxMinor(yRight,e),s.setAxisMaxMinor(xTop,e),s.setAxisMaxMinor(xBottom,e)}),ge.change(function(){var e=Math.min(Math.max(1,$(this).val()),40);ge.val(e),s.setAxisMaxMajor(yLeft,$(this).val()),s.setAxisMaxMajor(yRight,$(this).val()),s.setAxisMaxMajor(xTop,$(this).val()),s.setAxisMaxMajor(xBottom,$(this).val())}),pe.change(function(){s.itemList(Static.Rtti_PlotGrid)[0].setMinorPen(pe[0].value)}),ve.change(function(){s.itemList(Static.Rtti_PlotGrid)[0].setMajorPen(ve[0].value)}),me.change(function(){var e=s.itemList(Static.Rtti_PlotGrid)[0];Utility.majorGridLines(e,$(this)[0].checked),de.attr("disabled",!$(this)[0].checked)}),Static.bind("majorGridLines",function(e,t,n){me[0].checked=n,de.attr("disabled",!n)}),de.change(function(){var e=s.itemList(Static.Rtti_PlotGrid)[0];Utility.minorGridLines(e,$(this)[0].checked)}),Static.bind("minorGridLines",function(e,t,n){de[0].checked=n}),Static.bind("currentCurveChanged",function(e,t){var n,i;(Ce=t)&&(n=s.itemList(Static.Rtti_PlotGrid)[0],Se[0].checked?n.setAxes(Ce.xAxis(),Ce.yAxis()):(i=xBottom,1==ye[0].selectedIndex&&(i=xTop),t=yLeft,1==xe[0].selectedIndex&&(t=yRight),n.setAxes(i,t))),De()}),Static.bind("curveAxisChangedViaPropertiesPane axisChanged",function(e,t,n){var i=s.itemList(Static.Rtti_PlotGrid)[0];Se[0].checked?i.setAxes(n.xAxis(),n.yAxis()):(0==ye[0].selectedIndex?i.setAxes(xBottom,i.yAxis()):i.setAxes(xTop,i.yAxis()),0==G[0].selectedIndex?i.setAxes(i.xAxis(),yLeft):i.setAxes(i.xAxis(),yRight)),De()}),Static.bind("pSel",function(e,t){t?n.show("pointSelected"):n.hide("pointSelected")}),xe.change(function(){var e=s.itemList(Static.Rtti_PlotGrid)[0];0==$(this)[0].selectedIndex?e.setAxes(e.xAxis(),yLeft):e.setAxes(e.xAxis(),yRight),De()}),ye.change(function(){var e=s.itemList(Static.Rtti_PlotGrid)[0];0==$(this)[0].selectedIndex?e.setAxes(xBottom,e.yAxis()):e.setAxes(xTop,e.yAxis()),De()}),Se.click(function(){var e;$(this)[0].checked?Me(!0):(Me(!1),e=s.itemList(Static.Rtti_PlotGrid)[0],0==ye[0].selectedIndex?e.setAxes(xBottom,e.yAxis()):e.setAxes(xTop,e.yAxis()),0==xe[0].selectedIndex?e.setAxes(e.xAxis(),yLeft):e.setAxes(e.xAxis(),yRight)),De(),Static.trigger("gridlinesAccordingToCurve",$(this)[0].checked)}),function(){ke(!0),Pe(),De(),Re(),Be(),Te(ue.val()),t.val(s.title()),Ee();var e=s.itemList(Static.Rtti_PlotGrid)[0];de[0].checked=e.xMinEnabled(),me[0].checked=e.xEnabled(),i.val(s.axisTitle(xBottom)),r.val(s.axisTitle(xTop)),a.val(s.axisTitle(yLeft)),o.val(s.axisTitle(yRight)),pe.val(Static.colorNameToHex(e.minorPen())),ve.val(Static.colorNameToHex(e.majorPen())),n.hide("pointSelected")}()}}define("plotPropertiesPane",["propertiesPane"],function(){});class MyOverlay extends WidgetOverlay{constructor(e,t){super(e);this.eventObject=t,this.curve=null,this.toString=function(){return"[MyOverlay]"}}drawOverlay(e){let t=this.curve.plot().canvasMap(this.curve.xAxis()),n=this.curve.plot().canvasMap(this.curve.yAxis());var i=t.transform(this.eventObject.p.x),r=n.transform(this.eventObject.p.y);e.setBrush(new Misc.Brush("lightGrey")),e.drawCircle(i,r,8)}}class MyObject extends HObject{constructor(s,e){super();var o=this;this._plot=s,this._dmin=10,this._cb,this.selected=!1,this.button=Static.LeftButton,this.modifiers=Static.NoModifier,void 0!==e&&(this._cb=e),this.selectorWidgetOverlay=new MyOverlay(s.getCentralWidget(),this),Static.bind("visibilityChange",function(e,t,n){o.selectorWidgetOverlay.curve===t&&(n||(o.selectorWidgetOverlay.clearCanvas(),this.selected=!1))}),this.toString=function(){return"[MyObject]"},this.mouseDown=function(e){return e.button==this.button&&Utility.modifiers(e)==this.modifiers&&this.selected&&(null==this._cb?alert("Curve: "+this.selectorWidgetOverlay.curve.title()+"; point: ("+this.p.x+", "+this.p.y+")"):this._cb(this.selectorWidgetOverlay.curve,this.p)),!0},this.showMarker=function(e){var t=s.autoReplot();s.setAutoReplot(!1);var n,i,r=this.selectorWidgetOverlay.curve;o.mPos.setAxes(r.xAxis(),r.yAxis()),n=e,a=o.selectorWidgetOverlay.curve,i=s.axisScaleDiv(a.xAxis()),a=s.axisScaleDiv(a.yAxis()),i=(i=new Misc.Rect(i.lowerBound(),a.lowerBound(),i.range(),a.range())).normalized(),a=0,a|=n.x<i.left()+.3*i.width()?Static.AlignRight:Static.AlignLeft,a|=n.y-.3*i.height()>i.top()?Static.AlignBottom:Static.AlignTop,o.mPos.setLabelAlignment(a),o.mPos.setVisible(!0),o.mPos.setValue(e);var a=Static.toPrecision(e.x,s.axisPrecision(r.xAxis())),r=Static.toPrecision(e.y,s.axisPrecision(r.yAxis()));o.mPos.setLabel("("+a.toString()+", "+r.toString()+")"),s.setAutoReplot(t),s.autoRefresh()},this.hideMarker=function(){o.mPos.setVisible(!1)}}eventFilter(r,a){if(!Static.isMobile()){if("mousedown"==a.type)this.mouseDown(a);else if("mouseleave"==a.type)this.selected&&(this.selectorWidgetOverlay.clearCanvas(),this.selected=!1);else if("mousemove"==a.type){a.preventDefault();let e=this._plot.itemList(Static.Rtti_PlotCurve);if(!e.length)return;var s,o=r.mapToElement({x:a.clientX,y:a.clientY}),l={distance:-1};let t=-1,n=1e10,i=-1;for(h=0;h<e.length;++h)!e[h].isVisible()&&"[SyntheticPointData]"==e[h].data().toString()||(s=e[h].closestPoint(o,l),l.distance<n&&(n=l.distance,i=h,t=s));if(-1==t)return;if("[SyntheticPointData]"==e[i].data().toString())return;this.p=e[i].data().samples()[t],this.selected||this.selectorWidgetOverlay.clearCanvas(),n<this._dmin?(this.selectorWidgetOverlay.curve=e[i],this.selected||(this.selectorWidgetOverlay.draw(),this.selected=!0,this.showMarker(this.p),Static.trigger("pointSelected"))):(this.selected=!1,this.hideMarker(),Static.trigger("pointNotSelected"))}return!0}if("touchstart"==a.type){let e=this._plot.itemList(Static.Rtti_PlotCurve);if(!e.length)return;var c,o=r.mapToElement({x:a.originalEvent.touches[0].clientX,y:a.originalEvent.touches[0].clientY}),u={distance:-1};let t=-1,n=1e10,i=-1;for(var h=0;h<e.length;++h)!e[h].isVisible()&&"[SyntheticPointData]"==e[h].data().toString()||(c=e[h].closestPoint(o,u),u.distance<n&&(n=u.distance,i=h,t=c));if(-1==t)return;this.p=e[i].data().samples()[t],n<this._dmin&&(null==this._cb?alert("Curve: "+e[i].title()+"; point: ("+this.p.x+", "+this.p.y+")"):this._cb(e[i],this.p))}}}class CurveClosestPoint{constructor(e,t){this.eventHandlingObject=new MyObject(e,t),void 0!==t&&(this.eventHandlingObject.cb=t),this.cw=e.getCentralWidget(),this.cw.setEnabled_1(!0),this.eventHandlingObject.mPos=new PlotMarker("ClosestPointMarker123@###");t=this.eventHandlingObject.mPos.labelFont();t.th=14,t.fontColor="red",this.eventHandlingObject.mPos.setLabelFont(t),this.eventHandlingObject.mPos.setLabel("AAAAAb"),this.eventHandlingObject.mPos.attach(e),this.eventHandlingObject.mPos.setVisible(!1)}setDistance(e){this.eventHandlingObject._dmin=e}setEnabled(e){e?this.cw.installEventFilter(this.eventHandlingObject):(this.cw.removeEventFilter(this.eventHandlingObject),this.eventHandlingObject.selectorWidgetOverlay.clearCanvas())}setCb(e){this.eventHandlingObject._cb=e}setMousePattern(e,t){this.eventHandlingObject.button=e,this.eventHandlingObject.modifiers=t}}define("curveClosestPoint",["static","widgetOverlay","plotMarker"],function(){});class ScaleWidget extends Widget{constructor(e,t,n){super(t);var r=this.getElement(),a=null,s="",o=e,i=[],l=[],c=new Misc.Font(14),u=new Misc.Font(12);this.setBorderDist=function(e,t){e==l[0]&&t==l[1]||(l[0]=e,l[1]=t)},this.getBorderDistHint=function(e){a.getBorderDistHint(u,e),e.start<i[0]&&(e.start=i[0]),e.end<i[1]&&(e.end=i[1])},this.setLabelFont=function(e){e.th<0||""===e.name||""===e.style||(u=e,o.getLayout().adjustLayout(t,e.th))},this.labelFont=function(){return u},this.setTitleFont=function(e){e.th<0||""===e.name||""===e.style||(c=e,o.getLayout().adjustLayout(t,e.th))},this.titleFont=function(){return c},this.setScaleDraw=function(e){var t;void 0!==e&&e!=a&&(a&&(e.setScaleDiv(a.scaleDiv()),t=null,a.scaleMap().transformation()&&(t=a.scaleMap().transformation().copy()),e.setTransformation(t)),a=e)},this.scaleDraw=function(){return a},this.initScale=function(e){(a=new ScaleDraw).setAlignment(e);e=new LinearScaleEngine;a.setScaleDiv(e.divideScale(0,100,10,5))},void 0===n?this.initScale(LeftScale):this.initScale(n),this.setTitle=function(e){s!==e&&(""!==e?(""===s&&(this.alignment()===LeftScale||this.alignment()===RightScale?o.getLayout().adjustLayout(r,parseFloat(r.css("width"))+c.th):o.getLayout().adjustLayout(r,parseFloat(r.css("height"))+c.th),Static.trigger("axisTitleAdded",!0)),s=e):(this.alignment()===LeftScale||this.alignment()===RightScale?o.getLayout().adjustLayout(r,parseFloat(r.css("width"))-c.th):o.getLayout().adjustLayout(r,parseFloat(r.css("height"))-c.th),s="",Static.trigger("axisTitleAdded",!1)),o.getLayout().updateLayout())},this.title=function(){return s},this.setAlignment=function(e){a&&a.setAlignment(e)},this.alignment=function(){return null==a?LeftScale:a.alignment()},this.labelWidth=function(e){return u.textSize(e).width},this.draw=function(){var e,t=a.maxTickLength(),n=a.spacing();a.orientation()===Vertical&&(e=t+n+this.labelWidth(a.longestLabel())+10+(""!==s?c.th:0)+10,o.getLayout().adjustLayout(r,e)),a.orientation()===Horizontal&&(i=t+n+10+(""!==s?c.th:0)+10,o.getLayout().adjustLayout(r,i)),o.getLayout().updateLayout();var i=new PaintUtil.Painter(this);i.setFont(u),a.draw(i),""!==s&&(i.setFont(c),this.drawTitle(i))},this.drawTitle=function(e){var t=e.canvasWidth(),n=e.canvasHeight();e.save(),e.setFont(c),a.alignment()===LeftScale?""!==s&&e.drawVerticalText(s,c.th,n/2):a.alignment()===RightScale?""!==s&&e.drawVerticalText(s,t-c.th,n/2,!0):a.alignment()===BottomScale?""!==s&&e.drawText(s,t/2,n-2,"center"):a.alignment()===TopScale&&""!==s&&e.drawText(s,t/2,c.th,"center"),e.restore()},this.setScaleDiv=function(e){a.scaleDiv()!==e&&(a.setScaleDiv(e),Static.trigger("scaleDivChanged"))},Static.bind("scaleDivChanged",this.scaleChange),this.setTransformation=function(e){a.setTransformation(e)},this.toString=function(){return"[ScaleWidget]"}}}ScaleWidget.prototype.scaleChange=function(){},define("scaleWidget",["static","widget"],function(){});class Utility{static BicubicInterpolation(e,t,n){function i(e,t,n,i,r){return.5*(i-t+(2*t-5*n+4*i-r+(3*(n-i)+r-t)*e)*e)*e+n}var r=i(t,e[0][0],e[1][0],e[2][0],e[3][0]),a=i(t,e[0][1],e[1][1],e[2][1],e[3][1]),s=i(t,e[0][2],e[1][2],e[2][2],e[3][2]),e=i(t,e[0][3],e[1][3],e[2][3],e[3][3]);return i(n,r,a,s,e)}static bicubicInterpolate(e,t,n){for(var i,r,a=e.length,s=e[0].length,o=(e[e.length-1][0].x-e[0][0].x)/(e.length-1),l=Math.floor((t-e[0][0].x)/o);l<a;l++)if(e[l][0].x>t){i=l;break}null==i&&(i=a-1);for(var c=e[0],u=(c[c.length-1].y-c[0].y)/(c.length-1),l=Math.floor((n-c[0].y)/u);l<s;l++)if(c[l].y>n){r=l;break}if(t>e[i][0].x||t<e[0][0].x)throw"x out of range";if(n>e[0][r=null==r?s-1:r].y||n<e[0][0].y)throw"y out of range";o=i-2,u=r-2;if(0<=o&&0<=u&&i+1<a&&r+1<s){var h=[e[i-2][r-2].z,e[i-2][r-1].z,e[i-2][r].z,e[i-2][r+1].z],d=[e[i-1][r-2].z,e[i-1][r-1].z,e[i-1][r].z,e[i-1][r+1].z],f=[e[i][r-2].z,e[i][r-1].z,e[i][r].z,e[i][r+1].z],p=[e[i+1][r-2].z,e[i+1][r-1].z,e[i+1][r].z,e[i+1][r+1].z];return Utility.BicubicInterpolation([h,d,f,p],(t-e[i-1][0].x)/(e[i][0].x-e[i-1][0].x),(n-c[r-1].y)/(c[r].y-c[r-1].y))}if(o<0&&0<=u&&i+1<a&&r+1<s){h=[e[i-1][r-2].z,e[i-1][r-1].z,e[i-1][r].z,e[i-1][r+1].z],d=[e[i-1][r-2].z,e[i-1][r-1].z,e[i-1][r].z,e[i-1][r+1].z],f=[e[i][r-2].z,e[i][r-1].z,e[i][r].z,e[i][r+1].z],p=[e[i+1][r-2].z,e[i+1][r-1].z,e[i+1][r].z,e[i+1][r+1].z];return Utility.BicubicInterpolation([h,d,f,p],(t-e[i-1][0].x)/(e[i][0].x-e[i-1][0].x),(n-c[r-1].y)/(c[r].y-c[r-1].y))}if(0<=o&&u<0&&i+1<a&&r<s){h=[e[i-2][r-1].z,e[i-2][r-1].z,e[i-2][r].z,e[i-2][r+1].z],d=[e[i-1][r-1].z,e[i-1][r-1].z,e[i-1][r].z,e[i-1][r+1].z],f=[e[i][r-1].z,e[i][r-1].z,e[i][r].z,e[i][r+1].z],p=[e[i+1][r-1].z,e[i+1][r-1].z,e[i+1][r].z,e[i+1][r+1].z];return Utility.BicubicInterpolation([h,d,f,p],(t-e[i-1][0].x)/(e[i][0].x-e[i-1][0].x),(n-c[r-1].y)/(c[r].y-c[r-1].y))}if(0<=o&&0<=u&&a<=i+1&&r+1<s){h=[e[i-2][r-2].z,e[i-2][r-1].z,e[i-2][r].z,e[i-2][r+1].z],d=[e[i-1][r-2].z,e[i-1][r-1].z,e[i-1][r].z,e[i-1][r+1].z],f=[e[i][r-2].z,e[i][r-1].z,e[i][r].z,e[i][r+1].z],p=[e[i][r-2].z,e[i][r-1].z,e[i][r].z,e[i][r+1].z];return Utility.BicubicInterpolation([h,d,f,p],(t-e[i-1][0].x)/(e[i][0].x-e[i-1][0].x),(n-c[r-1].y)/(c[r].y-c[r-1].y))}if(0<=o&&0<=u&&i+1<a&&s<=r+1){h=[e[i-2][r-2].z,e[i-2][r-1].z,e[i-2][r].z,e[i-2][r].z],d=[e[i-1][r-2].z,e[i-1][r-1].z,e[i-1][r].z,e[i-1][r].z],f=[e[i][r-2].z,e[i][r-1].z,e[i][r].z,e[i][r].z],p=[e[i+1][r-2].z,e[i+1][r-1].z,e[i+1][r].z,e[i+1][r].z];return Utility.BicubicInterpolation([h,d,f,p],(t-e[i-1][0].x)/(e[i][0].x-e[i-1][0].x),(n-c[r-1].y)/(c[r].y-c[r-1].y))}if(o<0&&u<0&&i+1<a&&r<s){h=[e[i-1][r-1].z,e[i-1][r-1].z,e[i-1][r].z,e[i-1][r+1].z],d=[e[i-1][r-1].z,e[i-1][r-1].z,e[i-1][r].z,e[i-1][r+1].z],f=[e[i][r-1].z,e[i][r-1].z,e[i][r].z,e[i][r+1].z],p=[e[i+1][r-1].z,e[i+1][r-1].z,e[i+1][r].z,e[i+1][r+1].z];return Utility.BicubicInterpolation([h,d,f,p],(t-e[i-1][0].x)/(e[i][0].x-e[i-1][0].x),(n-c[r-1].y)/(c[r].y-c[r-1].y))}if(0<=o&&u<0&&a<=i+1&&r<s){h=[e[i-2][r-1].z,e[i-2][r-1].z,e[i-2][r].z,e[i-2][r+1].z],d=[e[i-1][r-1].z,e[i-1][r-1].z,e[i-1][r].z,e[i-1][r+1].z],f=[e[i][r-1].z,e[i][r-1].z,e[i][r].z,e[i][r+1].z],p=[e[i][r-1].z,e[i][r-1].z,e[i][r].z,e[i][r+1].z];return Utility.BicubicInterpolation([h,d,f,p],(t-e[i-1][0].x)/(e[i][0].x-e[i-1][0].x),(n-c[r-1].y)/(c[r].y-c[r-1].y))}if(o<0&&0<=u&&i+1<a&&s<=r+1){h=[e[i-1][r-2].z,e[i-1][r-1].z,e[i-1][r].z,e[i-1][r].z],d=[e[i-1][r-2].z,e[i-1][r-1].z,e[i-1][r].z,e[i-1][r].z],f=[e[i][r-2].z,e[i][r-1].z,e[i][r].z,e[i][r].z],p=[e[i+1][r-2].z,e[i+1][r-1].z,e[i+1][r].z,e[i+1][r].z];return Utility.BicubicInterpolation([h,d,f,p],(t-e[i-1][0].x)/(e[i][0].x-e[i-1][0].x),(n-c[r-1].y)/(c[r].y-c[r-1].y))}if(0<=o&&0<=u&&a<=i+1&&s<=r+1){h=[e[i-2][r-2].z,e[i-2][r-1].z,e[i-2][r].z,e[i-2][r].z],d=[e[i-1][r-2].z,e[i-1][r-1].z,e[i-1][r].z,e[i-1][r].z],f=[e[i][r-2].z,e[i][r-1].z,e[i][r].z,e[i][r].z],p=[e[i][r-2].z,e[i][r-1].z,e[i][r].z,e[i][r].z];return Utility.BicubicInterpolation([h,d,f,p],(t-e[i-1][0].x)/(e[i][0].x-e[i-1][0].x),(n-c[r-1].y)/(c[r].y-c[r-1].y))}}static BilinearInterpolation(e,t,n,i,r,a,s,o,l,c){return 1/((a-r)*(o-s))*(e*(a-l)*(o-c)+n*(l-r)*(o-c)+t*(a-l)*(c-s)+i*(l-r)*(c-s))}static bilinearInterpolate(e,t,n){for(var i,r,a=e.length,s=e[0].length,o=(e[e.length-1][0].x-e[0][0].x)/(e.length-1),l=Math.floor((t-e[0][0].x)/o);l<a;l++)if(e[l][0].x>t){i=l;break}null==i&&(i=a-1);for(var c=e[0],u=(c[c.length-1].y-c[0].y)/(c.length-1),l=Math.floor((n-c[0].y)/u);l<s;l++)if(c[l].y>n){r=l;break}if(t>e[i][0].x||t<e[0][0].x)throw"x out of range";if(n>e[0][r=null==r?s-1:r].y||n<e[0][0].y)throw"y out of range";var h=i-1,d=r-1,f=e[h][0].x,p=e[i][0].x,m=e[0][r].y,g=e[0][d].y,o=e[h][r].z,u=e[h][d].z,h=e[i][r].z,d=e[i][d].z;return Utility.BilinearInterpolation(o,u,h,d,f,p,m,g,t,n)}static generateCurveName(e,t){let n=1,i=t||"curve_",r=i.concat(n);for(;e.findPlotCurve(r);)r=i.concat(++n);return r}static modifiers(e){var t=Static.NoModifier;return e.altKey&&e.ctrlKey&&e.shiftKey?t|Static.AltModifier|Static.ControlModifier|Static.ShiftModifier:e.altKey&&e.ctrlKey?t|Static.AltModifier|Static.ControlModifier:e.altKey&&e.shiftKey?t|Static.AltModifier|Static.ShiftModifier:e.ctrlKey&&e.shiftKey?t|Static.ControlModifier|Static.ShiftModifier:e.altKey?t|Static.AltModifier:e.ctrlKey?t|Static.ControlModifier:e.shiftKey?t|Static.ShiftModifier:t}static button(e){return null!=e&&e.button}static colorList(){return["black","red","green","blue","yellow","brown"]}static makePoints(e){var t=[];return e.forEach(function(e){t.push(new Misc.Point(parseFloat(e[0]),parseFloat(e[1])))}),t}static makeSpectrocurvePoints(e){var n=[],i=Number.MAX_VALUE,r=Number.MIN_VALUE;return e.forEach(function(e){var t=parseFloat(e[2]);t<i&&(i=e[2]),r<t&&(r=e[2]),n.push({x:parseFloat(e[0]),y:parseFloat(e[1]),z:t})}),{points:n,zMin:i,zMax:r}}static pointsToXYObjectArray(e){var t=[];return e.forEach(function(e){t.push({x:e.x,y:e.y})}),t}static pointsFromXYObjectArray(e){var t=[];return e.forEach(function(e){t.push(new Misc.Point(e.x,e.y))}),t}static linearEquationFromPoints(e,t){t=(t.y-e.y)/(t.x-e.x),e=-t*e.x+e.y,t=t.toString();return t+="x+",t+=e.toString()}static toArrays(e){var t=Number.MAX_VALUE,n=Number.MIN_VALUE,i=null,r=e.split("\n"),e=r[0].toLowerCase();e.includes("curve")?i="curve":e.includes("spectrocurve")?i="spectrocurve":e.includes("spectrogram")&&(i="spectrogram");for(var a=[],s=0;s<r.length;++s){var o=r[s].split(",");isNaN(parseFloat(o))||(3==(o=o.map(function(e){return parseFloat(e)})).length?(a.push({x:o[0],y:o[1],z:o[2]}),a[a.length-1].z<t&&(t=a[a.length-1].z),a[a.length-1].z>n&&(n=a[a.length-1].z)):a.push(o))}return{array:a,dataType:i,minZ:t,maxZ:n}}static setAutoScale(e,t){e.setAxisAutoScale(xBottom,t),e.setAxisAutoScale(yLeft,t),e.setAxisAutoScale(xTop,t),e.setAxisAutoScale(yRight,t),Static.trigger("rescaled",t)}static majorGridLines(e,t){e.enableX(t),e.enableY(t),Static.trigger("majorGridLines",[e,t])}static minorGridLines(e,t){e.enableXMin(t),e.enableYMin(t),Static.trigger("minorGridLines",[e,t])}static randomColor(e=0){var t=[256*Math.random(),256*Math.random(),256*Math.random()],e=[51*e,51*e,51*e];return"rgb("+[t[0]+e[0],t[1]+e[1],t[2]+e[2]].map(function(e){return Math.round(e/2)}).join(",")+")"}static setCurveBrush(t,n){var e=$('<input type="color" style="opacity:0;">');t&&t.rtti===Static.Rtti_PlotCurve&&(t.brush().color==Static.NoBrush?e.val(Static.colorNameToHex("rgb(255, 255, 254)")):e.val(Static.colorNameToHex(t.brush().color)),e.change(function(){var e=t.brush();e.color=$(this).val(),t.setBrush(e),void 0!==n&&n(t)}),e.trigger("click"))}static removeCurveBrush(e){var t=e.brush();t.color=Static.NoBrush,e.setBrush(t)}static setSymbolPenWidth(e,t){var n=e.symbol();n&&(n.pen().width=t,e.plot().autoRefresh(),Utility.updateLegendIconSize(e),e.plot().updateLegend(e),Static.trigger("symbolAttributeChanged",e))}static updateLegendIconSize(e){var t,n=e.getLegendIconSize();e.symbol()&&(n=e.symbol().boundingRect().size()),e.symbol()&&e.testLegendAttribute(Static.LegendShowSymbol)?(e.testLegendAttribute(Static.LegendShowLine)&&((t=Math.ceil(1.5*n.width))%2&&t++,n.width=Math.max(40,t)),e.setLegendIconSize(n)):e.testLegendAttribute(Static.LegendShowLine)&&(n.width=40,e.setLegendIconSize(n))}static setSymbolSize(e,t){var n,i=e.symbol();i&&((n=i.size()).width=t,n.height=t,i.setSize(n),e.plot().autoRefresh(),Utility.updateLegendIconSize(e),e.plot().updateLegend(e),Static.trigger("symbolAttributeChanged",e))}static addSymbol(e,t){var n;e&&e.rtti===Static.Rtti_PlotCurve&&(t==NoSymbol&&e.setSymbol(null),null==(n=e.symbol())&&((n=new Symbol).setBrush(new Misc.Brush(Static.NoBrush)),n.setSize(new Misc.Size(10,10)),e.setSymbol(n)),n.size().width<=0&&n.setSize(new Misc.Size(10,10)),n.setStyle(t),e.itemChanged(),e.legendChanged(),Static.trigger("symbolAdded",e))}static curveRenameDlg(n,i,r){Static.prompt('Enter a new name for "'+n+'"',n,function(e){if(n==e)return Static.alert("You did not change the name!"),!1;var t=i.findPlotCurve(n);return i.findPlotCurve(e)?(Static.alert(e+" already exist"),!1):(t.setTitle(e),void 0!==r&&r(e,t),Static.trigger("curveRenamed",t),!0)},"small")}static setLegendAttribute(e,t,n){return"line"==t?(e.setLegendIconSize(new Misc.Size(n)),e.setLegendAttribute(Static.LegendShowSymbol,!1),void e.setLegendAttribute(Static.LegendShowLine,!0)):"symbol"==t?(e.setLegendIconSize(new Misc.Size(n)),e.setLegendAttribute(Static.LegendShowLine,!1),void e.setLegendAttribute(Static.LegendShowSymbol,!0)):"lineAndSymbol"==t?(e.setLegendIconSize(new Misc.Size(n)),e.setLegendAttribute(Static.LegendShowLine,!0),void e.setLegendAttribute(Static.LegendShowSymbol,!0)):(e.setLegendAttribute(Static.LegendShowLine,!1),void e.setLegendAttribute(Static.LegendShowSymbol,!1))}static enableComponent(e,t,n){for(var i=0;i<axisCnt;++i)e.axisScaleDraw(i).enableComponent(t,n);e.autoRefresh()}static setTickLength(e,t){for(var n=null,i=0;i<axisCnt;++i)n=e.axisScaleDraw(i),"small"==t?(n.setTickLength(MajorTick,6),n.setTickLength(MinorTick,3)):"medium"==t?(n.setTickLength(MajorTick,8),n.setTickLength(MinorTick,4)):"large"==t&&(n.setTickLength(MajorTick,12),n.setTickLength(MinorTick,6));e.autoRefresh()}static mVerifyRange(e,t,n){return e<1?0:(t=Math.max(0,Math.min(t,e-1)),(n=Math.max(0,Math.min(n,e-1)))<t&&(e=t,t=n,n=e),n-t+1)}static makeSamples(e){var t=e.fx,n=e.lowerX,i=e.upperX,r=e.numOfSamples,a=(e.indepVarIsDegree,e.variable||findIndepVar(t)),s=e.variableY;if(void 0===r&&(r=_numOfSamples),"x"!==a)for(;-1!=t.indexOf(a);)t=t.replace(a,"x");if(e.threeD&&"y"!==s){for(;-1!=t.indexOf(s);)t=t.replace(s,"y");var o=e.lowerY,l=e.upperY}e.threeD&&(o=e.lowerY,l=e.upperY);var c=[],u=new EvaluateExp(t);if(u.error)return Static.alert(u.errorMessage),null;var h,d,f,p=(i-n)/(r-1);e.threeD&&(h=(l-o)/(r-1));for(var m=Number.MAX_VALUE,g=Number.MIN_VALUE,v=0;v<=r-1;++v){var b=n+v*p;if(e.threeD?((f=u.eval({x:b,y:d=o+v*h}))<m&&(m=f),g<f&&(g=f)):d=u.eval({x:b}),!isFinite(d)){if(Static.errorResponse==Static.warn)return Static.alert("f("+b+'): yields infinity. Probably a "divide by zero" error. Try changing the limits or adjusting number of points.'),null;if(Static.errorResponse!=Static.warnIgnore)continue;Static.alertYesNo("Error found!!! Do you want to silently ignore errors?",function(e){return e==Static.Cancel?(console.log("C"),null):e==Static.Yes?(console.log("Y"),Static.errorResponse=Static.silentIgnore,Static.errorResponseChanged=!0,null):e==Static.No?(console.log("N"),null):void 0}),c=[];break}if(e.threeD&&!isFinite(f)){if(Static.errorResponse==Static.warn)return Static.alert("f("+b+","+d+'): yields infinity. Probably a "divide by zero" error. Try changing the limits or adjusting number of points.'),null;if(Static.errorResponse!=Static.warnIgnore)continue;Static.alertYesNo("Error found!!! Do you want to silently ignore errors?",function(e){return e==Static.Cancel?(console.log("C"),null):e==Static.Yes?(console.log("Y"),Static.errorResponse=Static.silentIgnore,Static.errorResponseChanged=!0,null):e==Static.No?(console.log("N"),null):void 0}),c=[];break}if(u.error)return Static.alert(u.errorMessage),null;e.threeD?c.push({x:b,y:d,z:f}):c.push(new Misc.Point(b,d))}return Static.errorResponseChanged&&(Static.errorResponseChanged=!1,Static.errorResponse=Static.warnIgnore),e.threeD?{data:c,zLimits:{min:m,max:g}}:c}}function PaintUtil(){function t(e){var c=e,t="",a=null;class n{constructor(){var i=c.getTransform();this.dx=function(){return i.m41},this.dy=function(){return i.m42},this.mapRect=function(e){var t=e.left(),n=e.top();return new Misc.Rect(i.m11*t+i.m21*n+this.dx(),i.m22*n+i.m12*t+this.dy(),e.width(),e.height())},this.map=function(e){var t=e.x,e=e.y;return new Misc.Point(i.m11*t+i.m21*e+this.dx(),i.m22*e+i.m12*t+this.dy())}}}this.getTransform=function(e,t){return new n},this.textSize=function(e){c.save(),c.font=a.weight+" "+a.style+" "+a.th+"px "+a.name;var t=c.measureText(e).width,e=c.measureText("M").width;return c.restore(),new Misc.Size(t,e)},this.context=function(){return c},this.canvasWidth=function(){return c.canvas.width},this.canvasHeight=function(){return c.canvas.height},this.save=function(){c.save()},this.restore=function(){c.restore()},this.translate=function(e,t){c.translate(e,t)},this.rotate=function(e){c.rotate(e*Math.PI/180)},this.scale=function(e,t){c.scale(e,t)},this.setPen=function(e){this.style==Static.NoPen?c.strokeStyle="transparent":c.strokeStyle=e.color,c.lineWidth=e.width,"dash"===e.style?c.setLineDash([10,5]):"dot"===e.style?c.setLineDash([3,8]):"dashDot"===e.style?c.setLineDash([12,5,3,5]):"dashDotDot"===e.style&&c.setLineDash([12,5,3,5,3,5]),t=e.style},this.pen=function(){var e="",e="transparent"==c.strokeStyle?NoPen:c.strokeStyle;return new Misc.Pen(e,c.lineWidth,t)},this.setBrush=function(e){void 0===e.color||e.color===Static.NoBrush?c.fillStyle="transparent":c.fillStyle=e.color},this.brush=function(){return c.fillStyle},this.setFont=function(e){c.font=e.weight+" "+e.style+" "+e.th+"px "+e.name,typeof e.fontColor&&(c.fillStyle=e.fontColor),a=e},this.font=function(){return a},this.fillRect=function(e,t){t.style!==NoBrush&&(this.setBrush(t),c.rect(e.left(),e.top(),e.width(),e.height()),c.fill())},this.drawPath=function(e){c.beginPath();for(var t=0;t<e.elementCount();t++){var n=e.elementAt(t),i=n.x,r=n.y;switch(n.type){case MoveToElement:c.moveTo(i,r);break;case LineToElement:c.lineTo(i,r);break;case CurveToElement:var a=e.elementAt(++t),s=a.x,o=a.y,l=e.elementAt(++t),a=l.x,l=l.y;c.bezierCurveTo(i,r,s,o,a,l)}}c.stroke(),c.fill()},this.drawPoint=function(e){var t=this.pen().width;c.fillStyle=this.pen().color,c.fillRect(e.x-+t,e.y-+t,1.9*t,2*t)},this.drawPoints=function(e){c.fillStyle=this.pen().color;for(var t=this.pen().width,n=0;n<e.length;++n)c.fillRect(e[n].x-+t,e[n].y-+t,1.9*t,2*t)},this.drawLine=function(e,t,n,i){c.beginPath(),void 0!==i&&void 0!==n?(c.moveTo(e,t),c.lineTo(n,i)):(c.moveTo(e.x,e.y),c.lineTo(t.x,t.y)),c.stroke()},this.drawImage=function(e,t,n,i,r){var a=0,s=0,o=e.width(),l=e.height();"object"==typeof t&&(a=t.left(),s=t.top(),o=t.width(),l=t.height()),"number"==typeof t&&"number"==typeof n&&(a=t,s=n),"number"==typeof i&&"number"==typeof r&&(o=i,l=r),0<e.width()&&0<e.height()&&c.putImageData(e.imageData(),a,s,0,0,o,l)},this.drawPolyline=function(e){c.beginPath(),c.moveTo(e[0].x,e[0].y);for(var t=1;t<e.length;++t)c.lineTo(e[t].x,e[t].y);c.stroke()},this.drawPolygon=function(e){e[0].x===e[e.length-1].x&&e[0].y===e[e.length-1].y||e.push(e[0]),c.beginPath(),this.drawPolyline(e),c.closePath(),c.fill()},this.drawRect=function(e,t,n,i){c.beginPath(),"number"==typeof e?c.rect(e,t,n,i):c.rect((e=e).left(),e.top(),e.width(),e.height()),c.stroke(),c.fill(),c.closePath()},this.drawCircle=function(e,t,n){c.beginPath(),"number"==typeof e?c.arc(e,t,n,0,2*Math.PI,!1):c.arc(e.x,e.y,n=t,0,2*Math.PI,!1),c.stroke(),c.fill(),c.closePath()},this.drawEllipse=function(e){var t=(e.left()+e.right())/2,n=(e.top()+e.bottom())/2,i=e.width(),e=e.height();c.beginPath(),c.moveTo(t,n-e/2),c.bezierCurveTo(t+i/2,n-e/2,t+i/2,n+e/2,t,n+e/2),c.bezierCurveTo(t-i/2,n+e/2,t-i/2,n-e/2,t,n-e/2),c.stroke(),c.fill(),c.closePath(),c.closePath()},this.drawVerticalText=function(e,t,n,i){var r=-1;void 0!==i&&!0===i&&(r=1);i=c.measureText(e);c.save();i=n-r*i.width/2;c.translate(t,i),c.rotate(r*Math.PI/2),c.translate(-t,-i),-1===r&&(c.textAlign="left"),c.fillText(e,t,i),c.restore()},this.drawText=function(e,t,n,i,r){void 0!==r&&(e=function(e,t){for(var n=e,i=a.textSize(n).width;t<i&&n.substring;)n=n.substring(0,n.length-1),i=a.textSize(n).width;return n}(e,r)),void 0!==i&&(c.textAlign=i),c.fillText(e,t,n)},this.toString=function(){return"[Painter: "+c+"]"}}function n(e){var u="http://www.w3.org/2000/svg",h=e,t=new Misc.Pen;t.style=Static.NoPen;var n=new Misc.Brush,i=new Misc.Font,d=null;function f(){t.style===Static.NoPen?d.attr("stroke","transparent"):d.attr("stroke",t.color),d.attr("stroke-Width",t.width),"dash"===t.style?d.attr("stroke-dasharray",[10,5]):"dot"===t.style?d.attr("stroke-dasharray",[3,8]):"dashDot"===t.style?d.attr("stroke-dasharray",[12,5,3,5]):"dashDotDot"===t.style&&d.attr("stroke-dasharray",[12,5,3,5,3,5])}function p(){n.color===Static.NoBrush?d.attr("fill","transparent"):d.attr("fill",n.color)}this.setBrush=function(e){n=e},this.setPen=function(e){t=e},this.pen=function(){return t},this.rotate=function(e,t,n){xCenter=t||0,yCenter=n||0,e&&d.attr("transform"," rotate("+e+" "+xCenter+" "+yCenter+")")},this.transform=function(e){var t=e.translateX||0,n=e.translateY||0,i=e.scaleX||1,r=e.scaleY||1,a=e.rotation||0,s=e.rotationX||0,o=e.rotationY||0,e="";1==i&&1==r||(e+=" scale("+i+" "+r+")"),a&&(e+=" rotate("+a+" "+s+" "+o+")"),1==t&&1==n||(e+=" translate("+t+" "+n+")"),d.attr("transform",e)},this.drawRect=function(e,t,n,i){(d=$(document.createElementNS(u,"rect"))).attr("x",e),d.attr("y",t),d.attr("width",n),d.attr("height",i),p(),f(),d.appendTo($(h.svg()))},this.drawPath=function(e){d=$(document.createElementNS(u,"path"));for(var t=e.data,n="",i=0;i<e.elementCount();i++){var r=e.elementAt(i),a=r.x+t.xOffset,s=r.y+t.yOffset;switch(r.type){case MoveToElement:n+="M"+a+" "+s+" ";break;case LineToElement:n+="L"+a+" "+s+" ";break;case CurveToElement:var o=e.elementAt(++i),l=o.x+t.xOffset,c=o.y+t.yOffset,o=e.elementAt(++i);n+="C "+a+" "+s+" "+l+" "+c+" "+(o.x+t.xOffset)+" "+(o.y+t.yOffset)+" "}}d.attr("d",n),d.attr("transform"," scale("+t.scale+") rotate("+t.rotation+" "+t.xCenter+" "+t.yCenter+")"),p(),f(),d.appendTo($(h.svg()))},this.fillRect=function(e,t){(d=$(document.createElementNS(u,"rect"))).attr("x",e.left),d.attr("y",e.top),d.attr("width",e.width),d.attr("height",e.height),d.attr("fill",t.color),f(),d.appendTo($(h.svg()))},this.drawCircle=function(e,t,n){(d=$(document.createElementNS(u,"circle"))).attr("cx",e),d.attr("cy",t),d.attr("r",n),p(),f(),d.appendTo($(h.svg()))},this.drawLine=function(e,t,n,i){(d=$(document.createElementNS(u,"line"))).attr("x1",e),d.attr("y1",t),d.attr("x2",n),d.attr("y2",i),f(),d.appendTo($(h.svg()))},this.drawText=function(e,t,n){(d=$(document.createElementNS(u,"text"))).attr("x",t),d.attr("y",n),d.attr("font-size",i.th),d.attr("font-family",i.name),d.attr("font-weight",i.weight),d.attr("font-style",i.style),f(),p(),d[0].textContent=e,d.appendTo($(h.svg()))},this.textSize=function(e){return i.textSize(e)},this.setFont=function(e){i=e},this.font=function(){return i},this.toString=function(){return"[GraphicPainter]"}}PaintUtil.Painter=function(e){var a=null,r=!1,a="[Graphic]"===e.toString()?(r=!0,new n(e)):"[object CanvasRenderingContext2D]"===e.toString()?new t(e):new t(e.getContext());this.isGraphicPainter=function(){return r},this.textSize=function(e){return a.textSize(e)},this.context=function(){if(!r)return a.context()},this.canvasWidth=function(){if(!r)return a.canvasWidth()},this.canvasHeight=function(){if(!r)return a.canvasHeight()},this.save=function(){r||a.save()},this.restore=function(){r||a.restore()},this.translate=function(e,t){r||a.translate(e,t)},this.scale=function(e,t){r||a.scale(e,t)},this.rotate=function(e,t,n){r||a.rotate(e,t,n)},this.transform=function(e){if(null==e)return a.getTransform();r&&a.transform(e)},this.setPen=function(e){a.setPen(e)},this.pen=function(){return a.pen()},this.setBrush=function(e){a.setBrush(e)},this.brush=function(){return a.brush()},this.setFont=function(e){a.setFont(e)},this.font=function(){return a.font()},this.fillRect=function(e,t){a.fillRect(e,t)},this.drawPath=function(e){a.drawPath(e)},this.drawPoint=function(e){r||a.drawPoint(e)},this.drawPoints=function(e){r||a.drawPoints(e)},this.drawLine=function(e,t,n,i){a.drawLine(e,t,n,i)},this.drawImage=function(e,t,n,i,r){a.drawImage(e,t,n,i,r)},this.drawPolyline=function(e){r||a.drawPolyline(e)},this.drawPolygon=function(e){r||a.drawPolygon(e)},this.drawRect=function(e,t,n,i){a.drawRect(e,t,n,i)},this.drawVerticalText=function(e,t,n,i){r||a.drawVerticalText(e,t,n,i)},this.drawText=function(e,t,n,i,r){a.drawText(e,t,n,i,r)},this.drawCircle=function(e,t,n){a.drawCircle(e,t,n)},this.drawEllipse=function(e){a.drawEllipse(e)},this.toString=function(){return a.toString()}}}define("utility",function(){}),PaintUtil(),define("painter",function(){});var ScaleDiv=function(e,t,n,i,r){var s=0,o=0,l=[];if(void 0!==e&&void 0!==t)if(void 0===n&&"object"==typeof e&&"object"==typeof t)for(var a=e,c=t,s=a.minValue(),o=a.maxValue(),u=0;u<NTickTypes;u++)l[u]=c[u];else if(void 0===i)for(lowerBound=e,upperBound=t,c=n,s=lowerBound,o=upperBound,u=0;u<NTickTypes;u++)l[u]=c[u];else void 0===e&&void 0===t&&void 0===n&&void 0===i&&void 0===r&&(lowerBound=e,upperBound=t,minorTicks=n,mediumTicks=i,majorTicks=r,s=lowerBound,o=upperBound,l[MinorTick]=minorTicks,l[MediumTick]=mediumTicks,l[MajorTick]=majorTicks);this.setInterval=function(e,t){"number"==typeof e&&"number"==typeof t?(lowerBound=e,upperBound=t,s=lowerBound,o=upperBound):"object"==typeof e&&void 0===t&&(s=(a=e).minValue(),o=a.maxValue())},this.interval=function(){return new Interval(s,o)},this.setLowerBound=function(e){s=e},this.lowerBound=function(){return s},this.setUpperBound=function(e){o=e},this.upperBound=function(){return o},this.range=function(){return o-s},this.isEmpty=function(){return s==o},this.isIncreasing=function(){return s<=o},this.contains=function(e){var t=Math.min(s,o),n=Math.max(s,o);return t<=e&&e<=n},this.invert=function(){var e=s;s=o,o=e;for(var t=0;t<NTickTypes;t++){for(var n=l[t],i=n.length,r=i/2,a=0;a<r;a++)e=n[a],n[a]=n[i-1-a],n[i-1-a]=e;l[t]=n}},this.inverted=function(){var e=new ScaleDiv(s,o,l);return e.invert(),e},this.bounded=function(e,t){var n=Math.min(e,t),i=Math.max(e,t),r=new ScaleDiv;for(r.setInterval(e,t),tickType=0;tickType<NTickTypes;tickType++){var a=l[tickType],s=[];for(u=0;u<a.size();u++){var o=a[u];n<=o&&o<=i&&s.push(o)}r.setTicks(tickType,s)}return r},this.setTicks=function(e,t){0<=e&&e<NTickTypes&&(l[e]=t)},this.ticks=function(e){return 0<=e&&e<NTickTypes?l[e]:[]}};ScaleDiv.prototype.toString=function(){return"[ScaleDiv]"},define("scaleDiv",function(){});class Interval{constructor(e,t,n){var i=0,r=-1,a=IncludeBorders;void 0!==e&&void 0!==t&&(i=e,r=t),void 0!==n&&(a=n),this.setBorderFlags=function(e){a=e},this.borderFlags=function(){return a},this.setMinValue=function(e){i=e},this.setMaxValue=function(e){r=e},this.minValue=function(){return i},this.maxValue=function(){return r}}toString(){return"[Interval]"}setInterval(e,t,n){this.setMinValue(e),this.setMaxValue(t),this.setBorderFlags(n)}isValid(){return 0==(this.borderFlags()&ExcludeBorders)?this.minValue()<=this.maxValue():this.minValue()<this.maxValue()}width(){return this.isValid()?this.maxValue()-this.minValue():0}isNull(){return this.isValid()&&this.minValue()>=this.maxValue()}invalidate(){this.setMinValue(0),this.setMaxValue(-1)}normalized(){return this.minValue()>this.maxValue()||this.minValue()==this.maxValue()&&this.borderFlags()==ExcludeMinimum?this.inverted():this}inverted(){var e=IncludeBorders;return this.borderFlags()&ExcludeMinimum&&(e|=ExcludeMaximum),this.borderFlags()&ExcludeMaximum&&(e|=ExcludeMinimum),new Interval(this.maxValue(),this.minValue(),e)}contains(e){return!!this.isValid()&&(!(e<this.minValue()||e>this.maxValue())&&(!(e==this.minValue()&&this.borderFlags()&ExcludeMinimum)&&!(e==this.maxValue()&&this.borderFlags()&ExcludeMaximum)))}limited(e,t){if(!this.isValid()||t<e)return new Interval;var n=Math.max(this.minValue(),e),n=Math.min(n,t),e=Math.max(this.maxValue(),e),e=Math.min(e,t);return new Interval(n,e,this.borderFlags())}}define("interval",function(){});class Transform{constructor(){}toString(){return"[Transform]"}bounded(e){return e}}class NullTransform extends Transform{constructor(){super()}toString(){return"[NullTransform]"}transform(e){return e}invTransform(e){return e}copy(){return new NullTransform}}class LogTransform extends Transform{constructor(){super()}toString(){return"[LogTransform]"}transform(e){return Math.log(e)}invTransform(e){return Math.exp(e)}bounded(e){return e>Number.MAX_VALUE?Number.MAX_VALUE:e<Number.MIN_VALUE?Number.MIN_VALUE:e}copy(){return new LogTransform}}class PowerTransform extends Transform{constructor(e){super(),this.d_exponent=e}toString(){return"[PowerTransform]"}transform(e){return e<0?-Math.pow(-e,1/this.d_exponent):Math.pow(e,1/this.d_exponent)}invTransform(e){return e<0?-Math.pow(-e,this.d_exponent):Math.pow(e,this.d_exponent)}copy(){return new PowerTransform(this.d_exponent)}}define("transform",function(){});class ScaleMap{static invTransform_Rect(e,t,n){var i=e.invTransform(n.left()),r=e.invTransform(n.right()-1),e=t.invTransform(n.top()),n=t.invTransform(n.bottom()-1);return new Misc.Rect(new Misc.Point(i,e),r-i,n-e).normalized()}static transform_Rect(e,t,n){var i=e.transform(n.left()),r=e.transform(n.right()),e=t.transform(n.top()),n=t.transform(n.bottom());return new Misc.Rect(new Misc.Point(i,e),r-i,n-e).normalized()}static invTransform(e,t,n){return new Misc.Point(e.invTransform1(n.x),t.invTransform1(n.y))}static transform(e,t,n){return new Misc.Point(e.transform1(n.x),t.transform1(n.y))}static transformPath(e,t,n,i){for(var r=new Misc.MPath,a=0;a<n.elementCount();a++){var s=n.elementAt(a),o=e.transform(s.x),l=t.transform(s.y);switch(s.type){case MoveToElement:i&&(o=Math.round(o),l=Math.round(l)),r.moveTo(o,l);break;case LineToElement:i&&(o=Math.round(o),l=Math.round(l)),r.lineTo(o,l);break;case CurveToElement:var c=n.elementAt(++a),u=e.transform(c.x),h=t.transform(c.y),d=n.elementAt(++a),c=e.transform(d.x),d=t.transform(d.y);r.cubicTo(o,l,u,h,c,d)}}return r}constructor(){var n=0,i=1,r=0,a=1,t=1,s=0,o=null;this.setd_cnv=function(e){t=e},this.setd_ts1=function(e){s=e},this.setTransformation=function(e){e!==o&&(o=e),this.setScaleInterval(n,i)},this.transformation=function(){return o},this.setScaleInterval=function(e,t){n=e,i=t,o&&(n=o.bounded(n),i=o.bounded(i)),this.updateFactor()},this.setPaintInterval=function(e,t){r=e,a=t,this.updateFactor()},this.copy=function(){var e=new ScaleMap;return e.setScaleInterval(this.s1(),this.s2()),e.setPaintInterval(this.p1(),this.p2()),e},this.updateFactor=function(){s=n;var e=i;o&&(s=o.transform(s),e=o.transform(e)),t=s!=e?(a-r)/(e-s):1},this.invTransform=function(e){return this.invTransform1(e)},this.transform=function(e){return this.transform1(e)},this.transform1=function(e){return o&&(e=o.transform(e)),r+(e-s)*t},this.invTransform1=function(e){e=s+(e-r)/t;return e=o?o.invTransform(e):e},this.s1=function(){return n},this.s2=function(){return i},this.p1=function(){return r},this.p2=function(){return a},this.copy=function(){var e=new ScaleMap;return e.setScaleInterval(n,i),e.setPaintInterval(r,a),e.setd_cnv(t),e.setd_ts1(s),this.transformation()&&e.setTransformation(this.transformation().copy()),e},this.isInverting=function(){return r<a!=n<i},this.toString=function(){return'[ScaleMap "'+t+'"]'}}}define("scaleMap",["static","transform"],function(){});class Layout{constructor(t,e){var n,i,r,a,s,o,l,c,u,h,d,f=e;function p(){var e=parseFloat(i.css("height")),t=parseFloat(r.css("height"));l.css("top",e),r.css("top",e),s.css("top",e+t),a.css("top",e+t),o.css("top",e+t)}function m(){var e=parseFloat(r.css("height"));l.css("top",0),r.css("top",0),s.css("top",e),a.css("top",e),o.css("top",e)}function g(){var e=parseFloat(i.css("height"));l.css("top",e),s.css("top",e),a.css("top",e),o.css("top",e)}function v(){l.css("top",0),s.css("top",0),a.css("top",0),o.css("top",0)}function b(){var e=parseFloat(u.css("height")),t=parseFloat(c.css("height"));l.css("bottom",e),c.css("bottom",e),s.css("bottom",e+t),a.css("bottom",e+t),o.css("bottom",e+t)}function S(){var e=parseFloat(c.css("height"));l.css("bottom",0),c.css("bottom",0),s.css("bottom",e),a.css("bottom",e),o.css("bottom",e)}function y(){var e=parseFloat(u.css("height"));l.css("bottom",e),s.css("bottom",e),a.css("bottom",e),o.css("bottom",e)}function x(){l.css("bottom",0),s.css("bottom",0),a.css("bottom",0),o.css("bottom",0)}function w(){var e=parseFloat(l.css("width")),t=parseFloat(o.css("width"));i.css("right",e+t+14+3),r.css("right",e+t+14+3),u.css("right",e+t+14+3),c.css("right",e+t+14+3),l.css("right",3),s.css("right",e+t+14+3),o.css("right",e+14+3)}function _(){var e=parseFloat(o.css("width"));i.css("right",e),r.css("right",e),u.css("right",e),c.css("right",e),s.css("right",e),o.css("right",0)}function C(){var e=parseFloat(l.css("width"));s.css("right",e+3+14),i.css("right",e+3+14),r.css("right",e+3+14),u.css("right",e+3+14),c.css("right",e+3+14),l.css("right",3)}function E(){i.css("right",0),r.css("right",0),u.css("right",0),c.css("right",0),s.css("right",0)}t&&(n=t.parent(),t.parent()[0]===document.body&&t.css("position","absolute"),i=$("<div />").attr({id:"titleDiv"}),t.append(i),r=$("<div />").attr({id:"topScaleDiv"}),t.append(r),"auto"!==r.css("top")&&parseFloat(r.css("top")),a=$("<div />").attr({id:"leftScaleDiv"}),t.append(a),"auto"!==a.css("left")&&parseFloat(a.css("left")),s=$("<div />").attr({id:"centralDiv"}),t.append(s),"auto"!==s.css("top")&&parseFloat(s.css("top")),"auto"!==s.css("bottom")&&parseFloat(s.css("bottom")),"auto"!==s.css("right")&&parseFloat(s.css("right")),"auto"!==s.css("left")&&parseFloat(s.css("left")),this.getCentralDiv=function(){return s},o=$("<div />").attr({id:"rightScaleDiv"}),t.append(o),"auto"!==o.css("right")&&parseFloat(o.css("right")),l=$("<div/>").attr({id:"legendDiv"}),t.append(l),"auto"!==l.css("right")&&parseFloat(l.css("right")),c=$("<div />").attr({id:"bottomScaleDiv"}),t.append(c),"auto"!==c.css("bottom")&&parseFloat(c.css("bottom")),u=$("<div />").attr({id:"footerDiv"}),t.append(u),"auto"!==u.css("bottom")&&parseFloat(u.css("bottom")),this.getPlotDiv=function(){return t},this.getLegendDiv=function(){return l},this.getTitleDiv=function(){return i},this.getFooterDiv=function(){return u},h=[a,o,c,r],this.getScaleDivElement=function(e){return e<0||axisCnt<=e?null:h[e]},this.adjustLayout=function(e,t){var n="width";"footerDiv"!==e[0].id&&"titleDiv"!==e[0].id&&"topScaleDiv"!==e[0].id&&"bottomScaleDiv"!==e[0].id||(n="height"),e.css(n,t)},d=parseFloat(n.css("height")),this.updateLayout=function(){var e;void 0!==f&&(e=parseFloat(n.css("height"))-d,d=parseFloat(n.css("height")),t.css("height",parseFloat(t.css("height"))+e),e="none"==i.css("display"),(f.axisEnabled(xTop)?e?p:m:e?g:v)(),("none"!==i.css("display")?f.axisEnabled(xTop)?p:g:f.axisEnabled(xTop)?m:v)(),e="none"==u.css("display"),(f.axisEnabled(xBottom)?e?b:S:e?y:x)(),("none"!=u.css("display")?f.axisEnabled(xBottom)?b:y:f.axisEnabled(xBottom)?S:x)(),f.legend()&&l.css("width",f.legend().legendDivWidth()),(f.axisEnabled(yRight)?f.isLegendEnabled()?w:_:f.isLegendEnabled()?C:E)(),(f.isLegendEnabled()?f.axisEnabled(yRight)?w:C:f.axisEnabled(yRight)?_:E)(),e=parseFloat(a.css("width")),f.axisEnabled(yLeft)?(i.css("left",e),r.css("left",e),u.css("left",e),c.css("left",e),s.css("left",e)):(i.css("left",0),r.css("left",0),u.css("left",0),c.css("left",0),s.css("left",0)))},this.isLegendDivVisible=function(){return"block"===l[0].style.display},this.setPlot=function(e){f=e},this.toString=function(){return"[Layout]"})}}define("layout",function(){});class AbstractScaleDraw{constructor(){Static.makeAbstract(this,AbstractScaleDraw);var n=Enum.ScaleComponent.Backbone|Enum.ScaleComponent.Ticks|Enum.ScaleComponent.Labels,s=[];s[MinorTick]=4,s[MediumTick]=6,s[MajorTick]=8;var o=new ScaleMap,l=null,t=4,r=4,i=4,c=1;this.data={},this.precision=function(){return r},this.setPrecision=function(e){r=e},this.decimalPlaces=function(){return t},this.setDecimalPlaces=function(e){t=e},this.longestLabel=function(){var n="",i=l.ticks(MajorTick);return i.forEach(function(e,t){0!==t&&t!==i.length-1&&l.contains(e)&&(e=Static.toPrecision(e,r)).toString().length>n.length&&(n=e.toString())}),n},this.enableComponent=function(e,t){t?n|=e:n&=~e},this.hasComponent=function(e){return n&e},this.setScaleDiv=function(e){l=e,o.setScaleInterval(l.lowerBound(),l.upperBound())},this.setTransformation=function(e){o.setTransformation(e)},this.scaleMap=function(){return o},this.scaleDiv=function(){return l},this.setPenWidth=function(e){(e=e<=0?1:e)!==c&&(c=e)},this.penWidth=function(){return c},this.draw=function(e){if(this.orientation()===Horizontal?o.setPaintInterval(0,e.canvasWidth()):o.setPaintInterval(e.canvasHeight(),0),this.hasComponent(Enum.ScaleComponent.Labels))for(var t=l.ticks(MajorTick),n=0;n<t.length;n++){var i=t[n];l.contains(i)&&this.drawLabel(e,i)}if(this.hasComponent(Enum.ScaleComponent.Ticks)){e.save(),e.setPen(new Misc.Pen("grey",c));for(var r=MinorTick;r<NTickTypes;r++)for(var a=l.ticks(r),n=0;n<a.length;n++){i=a[n];l.contains(i)&&this.drawTick(e,i,s[r])}e.restore()}this.hasComponent(Enum.ScaleComponent.Backbone)&&(e.save(),e.setPen(new Misc.Pen("grey",c)),this.drawBackbone(e),e.restore())},this.setSpacing=function(e){i=e=e<0?0:e},this.spacing=function(){return i},this.setTickLength=function(e,t){e<MinorTick||MajorTick<e||(s[e]=t=1e3<(t=t<0?0:t)?1e3:t)},this.tickLength=function(e){return e<MinorTick||MajorTick<e?0:s[e]},this.maxTickLength=function(){for(var e=0,t=0;t<NTickTypes;t++)e=Math.max(e,s[t]);return e},this.label=function(e){return(e=Static.mFuzzyCompare(e,_eps)?0:e).toString()},this.toString=function(){return"[AbstractScaleDraw]"}}}define("abstractScaleDraw",function(){});class ScaleDraw extends AbstractScaleDraw{constructor(){super();var t=BottomScale;this.orientation=function(){return t===TopScale||t===BottomScale?Horizontal:Vertical},this.alignment=function(){return t},this.setAlignment=function(e){t=e},this.getBorderDistHint=function(e,t){},this.toString=function(){return"[ScaleDraw]"},this.drawTick=function(e,t,n){if(!(n<=0)){var i=this.scaleMap().transform(t)+0,r=this.hasComponent(Enum.ScaleComponent.Backbone);switch(this.alignment()){case LeftScale:var a=e.canvasWidth();r&&(a-=2);var s=a-n;e.drawLine(a,i,s,i);break;case RightScale:a=0;r&&(a+=2);s=a+n;e.drawLine(a,i,s,i);break;case BottomScale:var o=0;r&&(o+=2);var l=o+n;e.drawLine(i,o,i,l);break;case TopScale:o=e.canvasHeight();r&&(o-=2);l=o-n;e.drawLine(i,o,i,l)}}},this.drawBackbone=function(e){var t=.5*e.pen().width,n=this.hasComponent(Enum.ScaleComponent.Backbone);switch(this.alignment()){case LeftScale:var i=e.canvasWidth()-t;n&&(i-=2),e.drawLine(i,0,i,e.canvasHeight());break;case RightScale:i=t;n&&(i+=2),e.drawLine(i,0,i,e.canvasHeight());break;case TopScale:var r=e.canvasHeight()-t;n&&(r-=2),e.drawLine(0,r,e.canvasWidth(),r);break;case BottomScale:r=t;n&&(r+=2),e.drawLine(0,r,e.canvasWidth(),r)}},this.labelPosition=function(e,t){e.save();var n=this.scaleMap().transform(t),i=this.spacing();this.hasComponent(Enum.ScaleComponent.Backbone)&&(i+=1),this.hasComponent(Enum.ScaleComponent.Ticks)&&(i+=this.tickLength(MajorTick));var r=0,a=0,s=e.measureText("M").width;switch(this.alignment()){case RightScale:r=i,a=n+.5*s+0;break;case LeftScale:r=e.canvas.width-i,a=n+.5*s+0;break;case BottomScale:r=n+0,a=i+s;break;case TopScale:r=n+0,a=e.canvas.height-i}return e.restore(),new Misc.Point(r,a)},this.drawLabel=function(e,t){t=Static.toPrecision(t,this.precision());var n=this.label(t);if(""!==n){var i=this.labelPosition(e.context(),t);if(this.orientation()!=Horizontal||0!==i.x&&i.x!=e.canvasWidth()){var r=e.textSize(n),a=r.height;if(this.orientation()!=Vertical||!(Math.abs(i.y-.5*a)<a||Math.abs(i.y-.5*a-e.canvasHeight())<a)){t="center",a="undefined";if(this.alignment()===LeftScale)t="right",a="undefined";else if(this.alignment()===RightScale)t="left",a="undefined";else{a=e.canvasWidth()/(this.scaleDiv().ticks(MajorTick).length-1)-5,r=r.width;if(a<r&&(r=a),i.x-r/2<0||i.x+r/2>e.canvasWidth())return}e.drawText(n,i.x,i.y,t,a)}}}}}}function ceilEps(e,t){return e=(e-_eps*t)/t,Math.ceil(e)*t}function floorEps(e,t){return e=(e+_eps*t)/t,Math.floor(e)*t}function divideEps(e,t){return 0===t||0===e?0:(e-_eps*e)/t}define("scaleDraw",["static","abstractScaleDraw"],function(){}),Static.mLog=function(e,t){return Math.log(t)/Math.log(e)},Static.mLogInterval=function(e,t){return new Interval(Static.mLog(e,t.minValue()),Static.mLog(e,t.maxValue()))},Static.mPowInterval=function(e,t){return new Interval(Math.pow(e,t.minValue()),Math.pow(e,t.maxValue()))},Static.mStepSize=function(e,t,n){if(t<=0)return 0;if(2<t)for(var i=t;1<i;i--)for(var r=e/i,a=Math.floor(Math.log(r)/Math.log(n)),s=Math.pow(n,a),o=n;1<o;o/=2){if(Static.mFuzzyCompare(r,o*s))return r;if(3===o&&n%2==0&&Static.mFuzzyCompare(r,2*s))return r}return.5*e},Static.divideInterval=function(e,t,n){if(t<=0)return 0;var i=divideEps(e,t);if(0===i)return 0;for(var e=Static.mLog(n,Math.abs(i)),t=Math.floor(e),r=Math.pow(n,e-t),a=n;1<a&&r<=a/2;)a/=2;t=a*Math.pow(n,t);return t=i<0?-t:t};class ScaleEngine{constructor(e){var n=10,i=0,r=0;void 0!==e&&(n=e);var t=null,a=0;this.lowerMargin=function(){return i},this.upperMargin=function(){return r},this.setMargins=function(e,t){i=Math.max(e,0),r=Math.max(t,0)},this.setTransformation=function(e){e!==t&&(t=e)},this.transformation=function(){var e=null;return e=t?t.copy():e},this.divideInterval=function(e,t){return Static.divideInterval(e,t,n)},this.contains=function(e,t){return!!e.isValid()&&(!(Static.m3FuzzyCompare(t,e.minValue(),e.width())<0)&&!(0<Static.m3FuzzyCompare(t,e.maxValue(),e.width())))},this.strip=function(e,t){if(!t.isValid()||0===e.length)return[];if(this.contains(t,e[0])&&this.contains(t,e[e.length-1]))return e;for(var n=[],i=0;i<e.length;i++)this.contains(t,e[i])&&n.push(e[i]);return n},this.buildInterval=function(e){var t=0===e?.5:Math.abs(.5*e);return Number.MAX_VALUE-t<e?new Interval(Number.MAX_VALUE-t,Number.MAX_VALUE):-Number.MAX_VALUE+t>e?new Interval(-Number.MAX_VALUE,-Number.MAX_VALUE+t):new Interval(e-t,e+t)},this.setBase=function(e){n=Math.max(e,2)},this.base=function(){return n},this.setReference=function(e){a=e},this.reference=function(){return a}}toString(){return"[ScaleEngine]"}}class LinearScaleEngine extends ScaleEngine{constructor(e){super(e),this.autoScale=function(e,t,n){var i=new Interval(t.x1,t.x2);(i=i.normalized()).setMinValue(i.minValue()-this.lowerMargin()),i.setMaxValue(i.maxValue()+this.upperMargin()),0===i.width()&&(i=this.buildInterval(i.minValue())),Static.divideInterval(i.width(),Math.max(e,1),this.base()),t.x1=i.minValue(),t.x2=i.maxValue()},this.divideScale=function(e,t,n,i,r){void 0===r&&(r=0);var a=new Interval(e,t).normalized();if(a.width()<=0)return new ScaleDiv;0===(r=Math.abs(r))&&(n<1&&(n=1),r=Static.divideInterval(a.width(),n,this.base()));n=new ScaleDiv;return 0!==r&&(this.buildTicks(a,r,i,i=[]),n=new ScaleDiv(a,i)),t<e&&n.invert(),n},this.buildTicks=function(e,t,n,i){var r=this.align(e,t);i[MajorTick]=this.buildMajorTicks(r,t),0<n&&(this.buildMinorTicks(i[MajorTick],n,t,r=[],n=[]),i[MinorTick]=r,i[MediumTick]=n);for(var a=0;a<NTickTypes;a++){var s=this.strip(i[a],e);i[a]=[],i[a]=s;for(var o=0;o<i[a].length;o++)0===Static.m3FuzzyCompare(i[a][o],0,t)&&(i[a][o]=0)}},this.buildMajorTicks=function(e,t){var n=Math.round(e.width()/t)+1;1e4<n&&(n=1e4);var i=[];i.push(e.minValue());for(var r=1;r<n-1;r++)i.push(e.minValue()+r*t);return i.push(e.maxValue()),i},this.buildMinorTicks=function(e,t,n,i,r){var a=Static.mStepSize(n,t,this.base());if(0!==a){var s=Math.ceil(Math.abs(n/a))-1,o=-1;s%2&&(o=s/2);for(var l=0;l<e.length;l++)for(var c=e[l],u=0;u<s;u++){var h=c+=a;0===Static.m3FuzzyCompare(c,0,n)&&(h=0),(u==o?r:i).push(h)}}},this.align=function(e,t){var n,i=e.minValue(),e=e.maxValue();return-Number.MAX_VALUE+t<=i&&(n=floorEps(i,t),0!==Static.m3FuzzyCompare(i,n,t)&&(i=n)),Number.MAX_VALUE-t>=e&&(n=ceilEps(e,t),0!==Static.m3FuzzyCompare(e,n,t)&&(e=n)),new Interval(i,e)}}toString(){return"[LinearScaleEngine]"}}class LogScaleEngine extends ScaleEngine{constructor(e){super(e),this.setTransformation(new LogTransform),this.autoScale=function(e,t,n){var i=this.base(),r=new Interval(t.x1/Math.pow(i,this.lowerMargin()),t.x2*Math.pow(i,this.upperMargin()));if(r.maxValue()/r.minValue()<i){var a=new LinearScaleEngine;a.setReference(this.reference()),a.setMargins(this.lowerMargin(),this.upperMargin()),a.autoScale(e,t,n);a=new Interval(t.x1,t.x2);if(a.normalized(),(a=a.limited(1e-100,1e100)).maxValue()/a.minValue()<i)return void(n=n<0?-Static.mLog(i,Math.abs(n)):Static.mLog(i,n))}5e-101<this.reference()&&Math.min(this.reference(),5e99),0==(r=r.limited(1e-100,1e100)).width()&&(r=this.buildInterval(r.minValue())),(n=Static.divideInterval(Static.mLogInterval(i,r).width(),Math.max(e,1)))<1&&(n=1),t.x1=r.minValue(),t.x2=r.maxValue()},this.divideScale=function(e,t,n,i,r){var a=new Interval(e,t);if(a.normalized(),(a=a.limited(1e-100,1e100)).width()<=0)return new ScaleDiv;var s=this.base();if(a.maxValue()/a.minValue()<s){var o=new LinearScaleEngine;return o.setReference(this.reference()),o.setMargins(this.lowerMargin(),this.upperMargin()),0!=r&&(r=r<0?-Math.pow(s,-r):Math.pow(s,r)),o.divideScale(e,t,n,i,r)}0==(r=Math.abs(r))&&(n<1&&(n=1),(r=Static.divideInterval(Static.mLogInterval(s,a).width(),n,this.base()))<1&&(r=1));n=new ScaleDiv;return 0!=r&&(this.buildTicks(a,r,i,i=[]),n=new ScaleDiv(a,i)),t<e&&n.invert(),n},this.buildTicks=function(e,t,n,i){var r=this.align(e,t);i[MajorTick]=this.buildMajorTicks(r,t),0<n&&(this.buildMinorTicks(i[MajorTick],n,t,r=[],n=[]),i[MinorTick]=r,i[MediumTick]=n);for(var a=0;a<NTickTypes;a++){var s=this.strip(i[a],e);i[a]=[],i[a]=s;for(var o=0;o<i[a].length;o++)0===Static.m3FuzzyCompare(i[a][o],0,t)&&(i[a][o]=0)}},this.buildMajorTicks=function(e,t){var n=Static.mLogInterval(this.base(),e).width(),i=Math.round(n/t)+1;1e4<i&&(i=1e4);var r=Math.log(e.minValue()),a=(Math.log(e.maxValue())-r)/(i-1),s=[];s.push(e.minValue());for(var o=1;o<i-1;o++)s.push(Math.exp(r+o*a));return s.push(e.maxValue()),s},this.buildMinorTicks=function(e,t,n,i,r){var a,s=this.base();if(n<1.1){if(0!=(a=this.divideInterval(n,t+1)))for(var o=Math.round(n/a),l=2<o&&o%2==0?o/2:-1,c=0;c<e.length-1;c++){var u=e[c],h=s/o;if(1<=h)for(m=2;m<o;m++)i.push(u*m*h);else for(m=1;m<o;m++){var d=u+m*u*(s-1)/o;(m==l?r:i).push(d)}}}else if(0!=(a=this.divideInterval(n,t))){a<1&&(a=1);var f=Math.round(n/a)-1;if(!((f=0<Static.m3FuzzyCompare((f+1)*a,n,n)?0:f)<1)){l=-1;2<f&&f%2&&(l=f/2);for(var p=Math.max(Math.pow(s,a),s),c=0;c<e.length;c++)for(var d=e[c],m=0;m<f;m++)(m==l?r:i).push(d*=p)}}},this.align=function(e,t){var n=Static.mLogInterval(this.base(),e),i=floorEps(n.minValue(),t);0==Static.m3FuzzyCompare(e.minValue(),i,t)&&(i=e.minValue());n=ceilEps(n.maxValue(),t);return 0==Static.m3FuzzyCompare(e.maxValue(),n,t)&&(n=e.maxValue()),Static.mPowInterval(this.base(),new Interval(i,n))}}toString(){return"[LogScaleEngine]"}}function PointMapper(){var a=0,s=new Misc.Rect;this.setBoundingRect=function(e){s=e},this.boundingRect=function(){return s},this.setFlag=function(e,t){t?a|=e:a&=~e},this.testFlag=function(e){return a&e},this.toPolygonF=function(e,t,n,i,r){return a&WeedOutPoints?a&RoundPoints?mToPolylineFiltered(e,t,n,i,r,!0):mToPolylineFiltered(e,t,n,i,r,!1):a&RoundPoints?Static.mToPoints(new Misc.Rect(0,0,-1,-1),e,t,n,i,r,!0):Static.mToPoints(new Misc.Rect(0,0,-1,-1),e,t,n,i,r,!1)},this.toPointsF=function(e,t,n,i,r){return a&WeedOutPoints?a&RoundPoints?s.left()<=s.right()&&s.top()<=s.bottom()?Static.mToPointsFiltered(s,e,t,n,i,r):mToPolylineFiltered(e,t,n,i,r,!0):Static.mToPolylineFiltered(e,t,n,i,r,!1):a&RoundPoints?Static.mToPoints(s,e,t,n,i,r,!0):Static.mToPoints(s,e,t,n,i,r,!1)}}define("scaleEngine",["static"],function(){}),Static.mToPolylineFiltered=function(e,t,n,i,r,a){var s=[],o=n.sample(i);s[0]=new Misc.Point(Math.round(e.transform(o.x)),Math.round(t.transform(o.y)));for(var l=0,c=i+1;c<=r;c++){var u=n.sample(c),u=a?new Misc.Point(Math.round(e.transform(u.x)),Math.round(t.transform(u.y))):new Misc.Point(e.transform(u.x),t.transform(u.y));s[l].x===u.x&&s[l].y===u.y||(s[++l]=u)}return s},Static.mToPoints=function(e,t,n,i,r,a,s){var o=[];if(e.left()<=e.right()&&e.top()<=e.bottom())for(h=r;h<=a;h++){var l=i.sample(h),c=t.transform(l.x),u=n.transform(l.y);c>=e.left()&&c<=e.right()&&u>=e.top()&&u<=e.bottom()&&(s?o.push(new Misc.Point(Math.round(c),Math.round(u))):o.push(new Misc.Point(c,u)),0)}else for(var h=r;h<=a;h++){l=i.sample(h),c=t.transform(l.x)-1,u=n.transform(l.y)-1;s?o.push(new Misc.Point(Math.round(c),Math.round(u))):o.push(new Misc.Point(c,u)),0}return o},PointMapper.prototype.toString=function(){return"[PointMapper]"},define("pointMapper",["static"],function(){});class AxisData{constructor(){this.axisName="",this.isEnabled=!1,this.doAutoScale=!0,this.minValue,this.maxValue,this.stepSize,this.maxMajor,this.maxMinor,this.isValid=!0,this.scaleDiv=null,this.scaleEngine=null,this.scaleWidget=null,this.scaleDomDiv=null,this.canvas=null}toString(){return"[AxisData]"}}class Plot{constructor(e,t){var n;this.plotDiv=null,this.plotDiv=null==e?$("#plotDiv"):e,"DIV"!==this.plotDiv.parent()[0].tagName&&(n=$('<div style="position: absolute; width:100%; height: 98%;"></div>'),this.plotDiv.parent().append(n),e=this.plotDiv.detach(),n.append(e));var u=this,h=[],d=[],i=null,r=null;u.tbarHeight=0;var a=this.plotDiv.parent(),s=parseFloat(a.css("width")),o=parseFloat(a.css("height")),l=!1,c="",f="",p=!1,m="",g="",v=!1,b=null,S=new Misc.Font;this.zoomer=null,this.panner=null,this.isSidebarVisible=function(){return l},Static.bind("showSidebar",function(e,t){l=t}),this.setLegendFont=function(e){S=e},this.legendFont=function(){return S},this.autoRefresh=function(){v&&this.replot()},this.setAutoReplot=function(e){v=e},this.autoReplot=function(){return v},this.plotItemStore=function(){return h};var y=new Misc.Font(12),x=new Misc.Font(12),w=new Layout(this.plotDiv,this);this.getLayout=function(){return w},this.axisInterval=function(e){return this.axisValid(e)?d[e].scaleDiv.interval():new Interval},this.setAxisPrecision=function(e,t){this.axisValid(e)&&(this.axisScaleDraw(e).setPrecision(t),this.autoRefresh())},this.setAxisDecimalPlaces=function(e,t){this.axisValid(e)&&(this.axisScaleDraw(e).setDecimalPlaces(t),this.autoRefresh())},this.axisPrecision=function(e){return this.axisValid(e)?this.axisScaleDraw(e).precision():3},this.axisDecimalPlaces=function(e){return this.axisValid(e)?this.axisScaleDraw(e).decimalPlaces():3};var C=new Widget(w.getCentralDiv()),E=new Widget(w.getTitleDiv()),k=new Widget(w.getFooterDiv());C.setEnabled_1(!0),(C.plot=this).getCentralWidget=function(){return C},this.getTitleWidget=function(){return E},this.getFooterWidget=function(){return k},this.initAxesData=function(){for(var e=0;e<axisCnt;e++)d[e]=new AxisData;for(d[yLeft].axisName="AxisYLeft",d[yRight].axisName="AxisYRight",d[xTop].axisName="AxisXTop",d[xBottom].axisName="AxisXBottom",d[yLeft].scaleWidget=new ScaleWidget(this,w.getScaleDivElement(yLeft),LeftScale),d[yRight].scaleWidget=new ScaleWidget(this,w.getScaleDivElement(yRight),RightScale),d[xTop].scaleWidget=new ScaleWidget(this,w.getScaleDivElement(xTop),TopScale),d[xBottom].scaleWidget=new ScaleWidget(this,w.getScaleDivElement(xBottom),BottomScale),e=0;e<axisCnt;e++){var t=d[e];t.scaleEngine=new LinearScaleEngine,t.scaleWidget.setTransformation(t.scaleEngine.transformation()),t.doAutoScale=!0,t.minValue=0,t.maxValue=1e3,t.stepSize=0,t.maxMinor=5,t.maxMajor=8,t.isValid=!1}d[yLeft].isEnabled=!0,d[yRight].isEnabled=!0,d[xBottom].isEnabled=!0,d[xTop].isEnabled=!0},this.axisMaxMinor=function(e){return this.axisValid(e)?d[e].maxMinor:0},this.axisMaxMajor=function(e){return this.axisValid(e)?d[e].maxMajor:0},this.setAxisMaxMinor=function(e,t){!this.axisValid(e)||(t=Static.qBound(0,t,100))!=(e=d[e]).maxMinor&&(e.maxMinor=t,e.isValid=!1,this.autoRefresh())},this.setAxisMaxMajor=function(e,t){!this.axisValid(e)||(t=Static.qBound(1,t,1e4))!=(e=d[e]).maxMajor&&(e.maxMajor=t,e.isValid=!1,this.autoRefresh())},this.axisValid=function(e){return yLeft<=e&&e<axisCnt},this.setAxisScaleEngine=function(e,t){var n;this.axisValid(e)&&null!==t&&((n=d[e]).scaleEngine=t,d[e].scaleWidget.setTransformation(t.transformation()),n.isValid=!1,this.autoRefresh())},this.legend=function(){return b},this.setLegend=function(e){b!==e&&(b=e).setPlot(this)},this.insertLegend=function(e){(b=e).setLegendDiv(w.getLegendDiv()),b.setPlot(this);for(var t=0;t<h.length;++t)this.insertLegendItem(h[t]);Static.trigger("legendInserted",b)},this.insertLegendItem=function(e,t){null!==b&&null!=e&&(e.testItemAttribute(Legend)&&b.addItem(e,t),b.isEmpty()||p&&b.legendDiv().show())},this.removeLegendItem=function(e){if(null!==b){e=b.removeItem(e);return b.isEmpty()&&b.legendDiv().hide(),e}},this.updateLegend=function(e){var t;null!=e&&e.testItemAttribute(Legend)&&(t=this.removeLegendItem(e),this.insertLegendItem(e,t))},this.axisScaleEngine=function(e){return this.axisValid(e)?d[e].scaleEngine:null},this.setAxisAutoScale=function(e,t){this.axisValid(e)&&d[e].doAutoScale!==t&&(d[e].doAutoScale=t,Static.trigger("autoScaleChanged",t),this.autoRefresh())},this.axisAutoScale=function(e){return!!this.axisValid(e)&&d[e].doAutoScale},this.setAxisScale=function(e,t,n,i){i=void 0!==i?i:0;this.axisValid(e)&&((e=d[e]).doAutoScale=!1,e.isValid=!1,e.minValue=t,e.maxValue=n,e.stepSize=i,Static.trigger("rescaled"),this.autoRefresh())},this.enableAxis=function(e,t){this.axisValid(e)&&t!==d[e].isEnabled&&((d[e].isEnabled=t)?d[e].scaleWidget.show():d[e].scaleWidget.hide(),this.autoRefresh())},this.axisEnabled=function(e){return!!this.axisValid(e)&&d[e].isEnabled},this.setAxisTitle=function(e,t){this.axisValid(e)&&(d[e].scaleWidget.setTitle(t),this.autoRefresh())},this.axisTitle=function(e){return this.axisValid(e)?d[e].scaleWidget.title():""},this.axisScaleDiv=function(e){return d[e].scaleDiv},this.setAxisScaleDiv=function(e,t){this.axisValid(e)&&((e=d[e]).doAutoScale=!1,e.scaleDiv=t,e.isValid=!0,this.autoRefresh())},this.axisScaleDraw=function(e){return this.axisValid(e)?this.axisWidget(e).scaleDraw():null},this.setAxisLabelFont=function(e,t){this.axisValid(e)&&(this.axisWidget(e).setLabelFont(t),this.autoRefresh())},this.axisLabelFont=function(e){return this.axisValid(e)?this.axisWidget(e).labelFont():null},this.setAxisTitleFont=function(e,t){this.axisValid(e)&&(this.axisWidget(e).setTitleFont(t),this.autoRefresh())},this.axisTitleFont=function(e){return this.axisValid(e)?this.axisWidget(e).titleFont():null},this.initAxesData(),this.isCursorSet=function(){return""!==m},this.cursor=function(e){return m},this.setCursor=function(e){if(e!=m){var t=m;return m=e,w.getCentralDiv().css("cursor",m),t}},this.setDefaultCursor=function(e){g!=e&&(g=e)},this.unsetCursor=function(){g!=m&&(m=g,w.getCentralDiv[0].style.cursor=m)},this.title=function(){return c},this.hideTitle=function(){""!=c&&(w.getTitleDiv().hide(),w.updateLayout(),this.autoRefresh())},this.showTitle=function(){""!=c&&(w.getTitleDiv().show(),w.updateLayout(),this.autoRefresh())},this.setTitle=function(e){c!==e&&(""!==(c=0==(c=e).trim(" ").length?"":c)?(w.getTitleDiv().show(),Static.trigger("titleAdded",!0)):(w.getTitleDiv().hide(),Static.trigger("titleAdded",!1)),w.updateLayout(),this.autoRefresh())},this.setTitleFont=function(e){e.th<0||""===e.name||""===e.style||(y=e,w.adjustLayout(w.getTitleDiv(),2*e.th),this.autoRefresh())},this.setTitleFont(new Misc.Font(20,"Arial","normal","bold")),this.titleFont=function(){return y},this.footer=function(){return f},this.hideFooter=function(){""!=f&&(w.getFooterDiv().hide(),w.updateLayout(),this.autoRefresh())},this.showFooter=function(){""!=f&&(w.getFooterDiv().show(),w.updateLayout(),this.autoRefresh())},this.setFooter=function(e){f!==e&&(""!==(f=0==(f=e).trim(" ").length?"":f)?(w.getFooterDiv().show(),Static.trigger("footerAdded",!0)):(w.getFooterDiv().hide(),Static.trigger("footerAdded",!1)),w.updateLayout(),this.autoRefresh())},w.getFooterDiv().hide(),this.setFooterFont=function(e){e.th<0||""===e.name||""===e.style||(x=e,w.adjustLayout(w.getFooterDiv(),2*e.th),this.autoRefresh())},this.setFooterFont(new Misc.Font(15,"Arial","normal","bold")),this.footerFont=function(){return x},this.enableLegend=function(e){p=e,b&&!b.isEmpty()&&(e?b.legendDiv().show():b.legendDiv().hide(),this.autoRefresh())},this.isLegendEnabled=function(e){return!!b&&!("none"==b.legendDiv()[0].style.display)},this.invTransform=function(e,t){return this.axisValid(e)?this.canvasMap(e).invTransform(t):0},this.transform=function(e,t){return this.axisValid(e)?this.canvasMap(e).transform(t):0};this.setPlotBackground=function(e){this.getCentralWidget().getElement().css("background-color",e)},this.setPlotBackground("rgb(255, 255, 200)"),this.plotBackground=function(e){return this.getCentralWidget().getElement().css("background-color")},this.setBorderRadius=function(e){this.getCentralWidget().getCanvas().css("border-radius",e)},this.borderRadius=function(e){return m_borderRadius},this.findPlotCurve=function(e){for(var t=this.itemList(Static.Rtti_PlotCurve),n=0;n<t.length;++n)if(t[n].title()===e)return t[n];for(t=this.itemList(Static.Rtti_PlotSpectroCurve),n=0;n<t.length;++n)if(t[n].title()===e)return t[n];t=this.itemList(Static.Rtti_PlotSpectrogram);for(n=0;n<t.length;++n)if(t[n].title()===e)return t[n];return null},this.findPlotMarker=function(e){for(var t=this.itemList(Static.Rtti_PlotMarker),n=0;n<t.length;++n)if(t[n].title()===e)return t[n];return null},this.hasVisiblePlotCurve=function(){for(var e=this.itemList(Static.Rtti_PlotCurve),t=0;t<e.length;++t)if(e[t].isVisible())return!0;return!1},this.hasVisiblePlotSpectroCurve=function(){for(var e=this.itemList(Static.Rtti_PlotSpectroCurve),t=0;t<e.length;++t)if(e[t].isVisible())return!0;return!1},this.hasVisiblePlotSpectrogram=function(){for(var e=this.itemList(Static.Rtti_PlotSpectrogram),t=0;t<e.length;++t)if(e[t].isVisible())return!0;return!1},this.hasPlotCurve=function(){return 0<this.itemList(Static.Rtti_PlotCurve).length},this.hasPlotSpectroCurve=function(){return 0<this.itemList(Static.Rtti_PlotSpectroCurve).length},this.hasPlotSpectrogram=function(){return 0<this.itemList(Static.Rtti_PlotSpectrogram).length},this.drawBackGround=function(){var e=new PaintUtil.Painter(C);e.fillRect(new Misc.Rect(0,0,C.width(),C.height()),"")},this.drawTitle=function(){var e;""!==c&&((e=new PaintUtil.Painter(E)).setFont(y),e.drawText(c,E.width()/2,2.6*y.th/2,"center"))},this.drawFooter=function(){var e;""!==f&&((e=new PaintUtil.Painter(k)).setFont(x),e.drawText(f,k.width()/2,2.6*x.th/2,"center"))},this.itemList=function(t){return void 0===t?h:_.filter(h,function(e){return e.rtti===t})},this.insertItem=function(e){h.push(e)},this.removeItem=function(e){e=h.indexOf(e);-1<e&&h.splice(e,1)},this.canvasMap=function(e){var t=new ScaleMap;t.setTransformation(this.axisScaleEngine(e).transformation());var n=this.axisScaleDiv(e);t.setScaleInterval(n.lowerBound(),n.upperBound());n=this.axisWidget(e);return e==yLeft||e==yRight?(e=n.height(),t.setPaintInterval(e,0)):(n=n.width(),t.setPaintInterval(0,n)),t},this.axisWidget=function(e){return this.axisValid(e)?d[e].scaleWidget:null},this.updateAxes=function(){for(var e=[new Interval(Number.MAX_VALUE,-Number.MAX_VALUE),new Interval(Number.MAX_VALUE,-Number.MAX_VALUE),new Interval(Number.MAX_VALUE,-Number.MAX_VALUE),new Interval(Number.MAX_VALUE,-Number.MAX_VALUE)],t=0;t<h.length;++t){var n,i=h[t];i.testItemAttribute(AutoScale)&&i.isVisible()&&(this.axisAutoScale(i.xAxis())||this.axisAutoScale(i.yAxis()))&&(0<=(n=i.boundingRect()).width()&&(n.left()<e[i.xAxis()].minValue()&&e[i.xAxis()].setMinValue(n.left()),n.right()>e[i.xAxis()].maxValue()&&e[i.xAxis()].setMaxValue(n.right())),0<=n.height()&&(n.top()<e[i.yAxis()].minValue()&&e[i.yAxis()].setMinValue(n.top()),n.bottom()>e[i.yAxis()].maxValue()&&e[i.yAxis()].setMaxValue(n.bottom())))}for(var r=0;r<axisCnt;r++){var a,s=d[r],o=s.minValue,l=s.maxValue,c=s.stepSize;s.doAutoScale&&e[r].isValid()&&(s.isValid=!1,o=e[r].minValue(),l=e[r].maxValue(),Static.mFuzzyCompare(l,o)&&(o-=_eps),s.scaleEngine.autoScale(s.maxMajor,a={x1:o,x2:l},c),o=a.x1,l=a.x2),s.isValid||(s.scaleDiv=s.scaleEngine.divideScale(o,l,s.maxMajor,s.maxMinor,c),s.isValid=!0);c=this.axisWidget(r);c.setScaleDiv(s.scaleDiv);s={start:void 0,end:void 0};c.getBorderDistHint(s),c.setBorderDist(s.start,s.end)}h.forEach(function(e){e.testItemInterest(ScaleInterest)&&e.updateScaleDiv(u.axisScaleDiv(e.xAxis()),u.axisScaleDiv(e.yAxis()))})},this.attachItem=function(e,t){t?(this.insertItem(e),e.testItemAttribute(Legend)&&this.insertLegendItem(e)):(e.testItemAttribute(Legend)&&this.removeLegendItem(e),this.removeItem(e)),Static.trigger("itemAttached",[e,t]),t||(e=null),this.autoRefresh()},this.replot=function(){var e=this.autoReplot();this.setAutoReplot(!1),this.updateAxes();for(var t=0;t<axisCnt;t++){var n=d[t].scaleWidget;n.scaleDraw().data.plotBorderWidth=parseFloat(this.getLayout().getCentralDiv().css("border-width")),n.draw()}this.drawTitle(),this.drawFooter();for(var i=0;i<h.length;++i)h[i].isVisible()&&h[i].draw(this.axisScaleDraw(h[i].xAxis()).scaleMap(),this.axisScaleDraw(h[i].yAxis()).scaleMap());Static.trigger("replot"),this.setAutoReplot(e)},this.setAutoReplot(!0),w.getTitleDiv().hide(),void 0!==t&&this.setTitle(t),g=w.getCentralDiv().css("cursor"),this.setCursor("crosshair"),this.enableAxis(yRight,!1),this.enableAxis(xTop,!1),w.getFooterDiv().hide(),(b?b.legendDiv():w.getLegendDiv()).hide(),this.setAutoReplot(!1),this.toString=function(){return'[Plot "'+c+'"]'};var P=0,R=0,A=0;this.print=function(){P=parseFloat(u.plotDiv.css("left"))/parseFloat(u.plotDiv.parent().css("width"))*100,R=(parseFloat(u.plotDiv.parent().css("width"))-parseFloat(u.plotDiv.css("width"))-parseFloat(u.plotDiv.css("left")))/parseFloat(u.plotDiv.parent().css("width"))*100-2,A=parseFloat(u.plotDiv.parent().css("height"))-parseFloat(u.plotDiv.css("height")),window.print()};var T=!(this.registerPrintCb=function(e,t){"beforePrint"===e&&(i=t),"afterPrint"===e&&(r=t)});Static.bind("beforePrint",function(){i?i():(T||u.plotDiv.css("height",parseFloat(u.plotDiv.css("height"))+A),u.plotDiv.css("left",0),u.plotDiv.css("width","98%"),u.autoRefresh()),T=!0}),Static.bind("afterPrint",function(){r?r():(T=!1,u.plotDiv.css("height",parseFloat(u.plotDiv.css("height"))-A),u.plotDiv.css("left",u.plotDivContainerSize().width*P/100),u.plotDiv.css("width",98-R-P+"%"),u.autoRefresh())}),Static.bind("resize",function(){s=parseFloat(a.css("width")),o=parseFloat(a.css("height")),u.autoRefresh()}),this.plotDivContainerSize=function(){return new Misc.Size(s,o)};var B=parseFloat(a.css("height")),M=parseFloat(u.plotDiv.css("height"));Static.onHtmlElementResize(u.plotDiv[0],function(){var e=parseFloat(u.plotDiv.css("height"))-M;M=parseFloat(u.plotDiv.css("height")),Static.trigger("plotDivResized",[u.plotDiv,e]),u.autoRefresh()}),Static.onHtmlElementResize(a[0],function(){var e=parseFloat(a.css("height"))-B;B=parseFloat(a.css("height")),Static.trigger("plotDivContainerResized",[a,e])})}}define("plot",["static","widget","scaleWidget","utility","miscObjects","painter","scaleDiv","interval","scaleMap","scaleWidget","transform","layout","scaleDraw","scaleEngine","pointMapper"],function(){});class SeriesData{constructor(){this.d_boundingRect=new Misc.Rect,Static.mBoundingRectPoint=function(e){return new Misc.Rect(e.x,e.y,0,0)},Static.mBoundingRect=function(e,t,n){var i,r,a=new Misc.Rect;if(void 0===t&&(t=0),(n=void 0===n?e.size()-1:n)<t)return a;for(i=t;i<=n;i++)if(0<=(r=Static.mBoundingRectPoint(e.sample(i))).width()&&0<=r.height()){a=r,i++;break}for(;i<=n;i++)0<=(r=Static.mBoundingRectPoint(e.sample(i))).width()&&0<=r.height()&&a.setRect(Math.min(a.left(),r.left()),Math.min(a.top(),r.top()),Math.max(a.right(),r.right())-Math.min(a.left(),r.left()),Math.max(a.bottom(),r.bottom())-Math.min(a.top(),r.top()));return a},this.setRectOfInterest=function(e){},this.toString=function(){return"[SeriesData]"}}}class ArraySeriesData extends SeriesData{constructor(e){super();var t=void 0!==e?e:[];this.setSamples=function(e){this.d_boundingRect=new Misc.Rect,t=e},this.samples=function(){return t},this.size=function(){return t.length},this.sample=function(e){return t[e]},this.toString=function(){return"[ArraySeriesData]"}}}class PointSeriesData extends ArraySeriesData{constructor(e){super(e),this.boundingRect=function(){return this.d_boundingRect.width()<0&&(this.d_boundingRect=Static.mBoundingRect(this)),this.d_boundingRect},this.toString=function(){return"[PointSeriesData]"}}}class Point3DSeriesData extends ArraySeriesData{constructor(e){super(e),this.boundingRect=function(){return this.d_boundingRect.width()<0&&(this.d_boundingRect=Static.mBoundingRect(this)),this.d_boundingRect},this.toString=function(){return"[Point3DSeriesData]"}}}class PlotSeriesItem extends PlotItem{constructor(e){super(e);var n=null,t=Vertical;this.setOrientation=function(e){t!=e&&(t=e,this.itemChanged())},this.orientation=function(){return t},this.draw=function(e,t){this.drawSeries(e,t,0,-1)},this.updateScaleDiv=function(e,t){t=new Misc.Rect(new Misc.Point(e.lowerBound(),t.lowerBound()),e.range(),t.range());this.setRectOfInterest(t)},this.data=function(){return n},this.sample=function(e){return n?n.sample(e):null},this.setData=function(e){n!=e&&(n=e)},this.dataSize=function(){return null==n?0:n.size()},this.dataRect=function(){return null==n?new Misc.Rect:n.boundingRect()},this.setRectOfInterest=function(e){n&&n.setRectOfInterest(e)},this.swapData=function(e){var t=n;return n=e,t},this.toString=function(){return"[PlotSeriesItem]"}}boundingRect(){return this.dataRect()}}define("seriesData",["static","plotItem"],function(){});class SyntheticPointData extends SeriesData{constructor(e,t){super();var n,i=e,r=t||new Interval,a=new Interval(0,10);this.setSize=function(e){i=e},this.size=function(){return i},this.setInterval=function(e){r=e.normalized()},this.interval=function(){return r},this.setRectOfInterest=function(e){n=e,a=new Interval(e.left(),e.right()).normalized()},this.rectOfInterest=function(){return n},this.boundingRect=function(){return 0==i||!r.isValid()&&!a.isValid()?new Misc.Rect(1,1,-2,-2):Static.mBoundingRect(this)},this.y=function(e){throw'subclass must implement "this.y"'},this.sample=function(e){if(i<=e)return new Misc.Point(0,0);var t=this.x(e),e=this.y(t);return new Misc.Point(t,e)},this.x=function(e){var t=r.isValid()?r:a;if(!t.isValid()||0==i||i<=e)return 0;var n=t.width()/i;return t.minValue()+e*n},this.toString=function(){return"[SyntheticPointData]"}}}define("pointData",["static","seriesData"],function(){});class FunctionData extends SyntheticPointData{constructor(e,t){super(t);var n=new EvaluateExp(e);this.setFn=function(e){n.setExpString(e)},this.y=function(e){return n.error?0:n.eval({x:e})}}}define("functionData",["pointData"],function(){});class PlotGrid extends PlotItem{constructor(e){super(e),this.setItemAttribute(AutoScale,!0);var a=!0,s=!0,o=!1,l=!1,t=null,n=null,c="grey",u="lightGrey";this.rtti=Static.Rtti_PlotGrid,this.setMajorPen=function(e){c!==e&&(c=e,this.itemChanged())},this.majorPen=function(){return c},this.setMinorPen=function(e){u!==e&&(u=e,this.itemChanged())},this.minorPen=function(){return u},this.enableX=function(e){a!=e&&(a=e,this.itemChanged(),Static.trigger("itemChanged",[this,e]))},this.xEnabled=function(){return a},this.enableY=function(e){s!=e&&(s=e,this.itemChanged(),Static.trigger("itemChanged",[this,e]))},this.yEnabled=function(){return s},this.enableXMin=function(e){o!=e&&(o=e,this.itemChanged())},this.xMinEnabled=function(){return o},this.enableYMin=function(e){l!=e&&(l=e,this.itemChanged())},this.yMinEnabled=function(){return l},this.setXDiv=function(e){t!==e&&(t=e)},this.xDiv=function(){return t},this.setYDiv=function(e){n!==e&&(n=e)},this.yDiv=function(){return n},this.draw=function(e,t){var n=this.plot(),i=n.axisScaleDiv(this.xAxis()),r=n.axisScaleDiv(this.yAxis()),n=this.getContext();n.strokeStyle=u,a&&o&&(this.drawLines(n,"vertical",e,i.ticks(MinorTick)),this.drawLines(n,"vertical",e,i.ticks(MediumTick))),s&&l&&(this.drawLines(n,"horizontal",t,r.ticks(MinorTick)),this.drawLines(n,"horizontal",t,r.ticks(MediumTick))),n.strokeStyle=c,a&&this.drawLines(n,"vertical",e,i.ticks(MajorTick)),s&&this.drawLines(n,"horizontal",t,r.ticks(MajorTick))},this.drawLines=function(e,t,n,i){for(var r=e.canvas.width-1,a=e.canvas.height-1,s=new PaintUtil.Painter(e),o=s.pen().width,l=0;l<i.length;l++){var c=n.transform(i[l]);"horizontal"===t?s.drawLine(0,c-o,r,c-o):s.drawLine(c-o,0,c-o,a)}},this.updateScaleDiv=function(e,t){this.setXDiv(e),this.setYDiv(t)},this.toString=function(){return"[PlotGrid]"}}}define("plotGrid",["static","plotItem"],function(){});var Conrec=function(){function u(e,t){var n=e.x-t.x,t=e.y-t.y;return n*n+t*t<1e-20}function h(e){for(var t=e.head;t;){var n=t.next;t.next=t.prev,t.prev=n,t=n}n=e.head,e.head=e.tail,e.tail=n}function s(e){this.level=e,this.s=null,this.count=0}s.prototype.remove_seq=function(e){e.prev?e.prev.next=e.next:this.s=e.next,e.next&&(e.next.prev=e.prev),--this.count},s.prototype.addSegment=function(e,t){for(var n=this.s,i=null,r=null,a=!1,s=!1;n&&(null==i&&(u(e,n.head.p)?(i=n,a=!0):u(e,n.tail.p)&&(i=n)),null==r&&(u(t,n.head.p)?(r=n,s=!0):u(t,n.tail.p)&&(r=n)),null==r||null==i);)n=n.next;switch((null!=i?1:0)|(null!=r?2:0)){case 0:var o={p:e,prev:null},l={p:t,next:null},i={head:(o.next=l).prev=o,tail:l,next:this.s,prev:null,closed:!1};this.s&&(this.s.prev=i),this.s=i,++this.count;break;case 1:var c={p:t};a?(c.next=i.head,c.prev=null,i.head.prev=c,i.head=c):(c.next=null,c.prev=i.tail,i.tail.next=c,i.tail=c);break;case 2:c={p:e};s?(c.next=r.head,c.prev=null,r.head.prev=c,r.head=c):(c.next=null,c.prev=r.tail,r.tail.next=c,r.tail=c);break;case 3:if(i===r){c={p:i.tail.p,next:i.head,prev:null};i.head.prev=c,i.head=c,i.closed=!0;break}switch((a?1:0)|(s?2:0)){case 0:h(i);case 1:r.tail.next=i.head,i.head.prev=r.tail,r.tail=i.tail,this.remove_seq(i);break;case 3:h(i);case 2:i.tail.next=r.head,r.head.prev=i.tail,i.tail=r.tail,this.remove_seq(r)}}};function e(e){var o;e?this.drawContour=e:((o=this).contours={},this.drawContour=function(e,t,n,i,r,a){(o.contours[a]||(o.contours[a]=new s(r))).addSegment({x:e,y:t},{x:n,y:i})},this.contourList=function(){var e,t=[],n=o.contours;for(e in n)for(var i=n[e].s,r=n[e].level;i;){var a=i.head,s=[];for(s.level=r,s.k=e;a&&a.p;)s.push(a.p),a=a.next;t.push(s),i=i.next}return t.sort(function(e,t){return t.k-e.k}),t}),this.h=new Array(5),this.sh=new Array(5),this.xh=new Array(5),this.yh=new Array(5)}return e.prototype.contour=function(e,t,n,i,r,a,s,o,l){var c=this.h,u=this.sh,h=this.xh,d=this.yh,f=this.drawContour;this.contours={};function p(e,t){return(c[t]*h[e]-c[e]*h[t])/(c[t]-c[e])}function m(e,t){return(c[t]*d[e]-c[e]*d[t])/(c[t]-c[e])}for(var g,v,b,S,y=0,x=0,w=0,_=0,C=[0,1,1,0],E=[0,0,1,1],k=[[[0,0,8],[0,2,5],[7,6,9]],[[0,3,4],[1,3,1],[4,3,0]],[[9,6,7],[5,2,0],[8,0,0]]],P=r-1;i<=P;P--)for(var R=t;R<=n-1;R++){var A=Math.min(e[R][P],e[R][P+1]),T=Math.min(e[R+1][P],e[R+1][P+1]),B=Math.min(A,T);if(A=Math.max(e[R][P],e[R][P+1]),T=Math.max(e[R+1][P],e[R+1][P+1]),(S=Math.max(A,T))>=l[0]&&B<=l[o-1])for(var M=0;M<o;M++)if(l[M]>=B&&l[M]<=S){for(var D=4;0<=D;D--)0<D?(c[D]=e[R+C[D-1]][P+E[D-1]]-l[M],h[D]=a[R+C[D-1]],d[D]=s[P+E[D-1]]):(c[0]=.25*(c[1]+c[2]+c[3]+c[4]),h[0]=.5*(a[R]+a[R+1]),d[0]=.5*(s[P]+s[P+1])),0<c[D]?u[D]=1:c[D]<0?u[D]=-1:u[D]=0;for(D=1;D<=4;D++)if(0!=(b=k[u[g=D]+1][u[0]+1][u[v=4!=D?D+1:1]+1])){switch(b){case 1:y=h[g],w=d[g],x=h[0],_=d[0];break;case 2:y=h[0],w=d[0],x=h[v],_=d[v];break;case 3:y=h[v],w=d[v],x=h[g],_=d[g];break;case 4:y=h[g],w=d[g],x=p(0,v),_=m(0,v);break;case 5:y=h[0],w=d[0],x=p(v,g),_=m(v,g);break;case 6:y=h[v],w=d[v],x=p(g,0),_=m(g,0);break;case 7:y=p(g,0),w=m(g,0),x=p(0,v),_=m(0,v);break;case 8:y=p(0,v),w=m(0,v),x=p(v,g),_=m(v,g);break;case 9:y=p(v,g),w=m(v,g),x=p(g,0),_=m(g,0)}f(y,w,x,_,l[M],M)}}}},e}();"undefined"!=typeof exports&&(exports.Conrec=Conrec),define("conrec",function(){});class PlotRasterItem extends PlotItem{static useCache(e,t){var n=!1;return n=e==Enum.CachePolicy.PaintCache?!0:n}static qwtToRgba(e,t){e=e.copy();return e.setAlpha(t),e}constructor(e){super(e),Enum.CachePolicy={NoCache:0,PaintCache:1},Enum.PaintAttribute={PaintInDeviceResolution:1};class t{constructor(){this.cache={policy:null,area:null,size:null,image:null},this.alpha=-1,this.paintAttributes=Enum.PaintAttribute.PaintInDeviceResolution,this.cache.policy=Enum.CachePolicy.NoCache}}var o=null,n=new Misc.Size(1,1);this.init=function(){o=new t,this.setItemAttribute(AutoScale,!0),this.setItemAttribute(Legend,!1),this.setZ(8)},this.setPaintAttribute=function(e,t){t?o.paintAttributes|=e:o.paintAttributes&=~e},this.testPaintAttribute=function(e){return o.paintAttributes&e},this.setAlpha=function(e){(e=255<(e=e<0?-1:e)?255:e)!=o.alpha&&(o.alpha=e,this.itemChanged())},this.alpha=function(){return o.alpha},this.setCachePolicy=function(e){o.cache.policy!=e&&(o.cache.policy=e,this.invalidateCache(),this.itemChanged())},this.cachePolicy=function(){return o.cache.policy},this.invalidateCache=function(){o.cache.image=new Misc.Image,o.cache.area=new Misc.Rect,o.cache.size=new Misc.Size},this.interval=function(e){return new Interval},this.pixelSize=function(){return n},this.setPixelSize=function(e){n=e},this.compose=function(e,t,n,i,r,a){var s=new Misc.Image;return n.isEmpty()||i.isEmpty()||r.isEmpty()?s:((s=a&&!o.cache.image.isNull()&&o.cache.area.isEqual(n)&&o.cache.size.isEqual(i.size())?o.cache.image:s).isNull()&&(e=this.imageMap(Horizontal,e,n,r),t=this.imageMap(Vertical,t,n,r),s=this.renderImage(e,t,n,r),a&&(o.cache.area=n.copy(),o.cache.size=i.size().copy(),o.cache.image=s.copy())),0<=o.alpha&&o.alpha<255?PlotRasterItem.qwtToRgba(s,o.alpha):s)},this.imageMap=function(e,t,n,i){var r,a,s;i=e==Horizontal?(r=0,a=i.width,s=n.left(),n.right()):(r=0,a=i.height,s=n.top(),n.bottom()),t.isInverting()&&s<i&&(n=s,s=i,i=n);t=t.copy();return t.setPaintInterval(r,a),t.setScaleInterval(s,i),t},this.dataRasterItemPrivateData=function(){return o},this.init()}boundingRect(){var e=this.interval(XAxis),t=this.interval(YAxis);if(!e.isValid()&&!t.isValid())return new Misc.Rect;var n=new Misc.Rect;return e.isValid()?(n.setLeft(e.minValue()),n.setRight(e.maxValue())):(n.setLeft(-.5*Number.MAX_VALUE),n.setWidth(Number.MAX_VALUE)),t.isValid()?(n.setTop(t.minValue()),n.setBottom(t.maxValue())):(n.setTop(-.5*Number.MAX_VALUE),n.setHeight(Number.MAX_VALUE)),n.normalized()}draw(e,t,n,i){var r,a,s=this.dataRasterItemPrivateData();i.isEmpty()||0==s.alpha||(a=PlotRasterItem.useCache(s.cache.policy,e),r=ScaleMap.invTransform_Rect(t,n,i),s=new Misc.Size(i.width(),i.height()),(a=this.compose(t,n,r,i,s,a)).isNull()||(e.save(),e.drawImage(a,i),e.restore()))}}define("plotRasterItem",["static","plotItem"],function(){});class PlotSpectrogram extends PlotRasterItem{constructor(e){super(e),Enum.DisplayMode={ImageMode:1,ContourMode:2};var u=this,y=new class{constructor(){this.data=null,this.colorMap=new LinearColorMap,this.displayMode=Enum.DisplayMode.ImageMode,this.contourLevels=[],this.defaultContourPen=new Misc.Pen,this.numberOfContourPlanes=10}};this.privateData=function(){return y},this.setItemAttribute(AutoScale,!0),this.setItemAttribute(Legend,!1),this.setZ(8),this.rtti=Static.Rtti_PlotSpectrogram,this.setDisplayMode=function(e,t){t!=(e&y.displayMode)&&(t?y.displayMode|=e:y.displayMode&=~e,this.legendChanged(),this.itemChanged())},this.testDisplayMode=function(e){return y.displayMode&e},this.setColorMap=function(e){y.colorMap!=e&&(y.colorMap=e),this.invalidateCache(),this.legendChanged(),this.itemChanged()},this.colorMap=function(){return y.colorMap},this.setDefaultContourPen=function(e,t,n){var i=e;"object"!=typeof e&&(i=new Misc.Pen(e,t,n)),this.doSetDefaultContourPen(i)},this.doSetDefaultContourPen=function(e){e.isEqual(y.defaultContourPen)||(y.defaultContourPen=e,this.legendChanged(),this.itemChanged())},this.defaultContourPen=function(){return y.defaultContourPen},this.contourPen=function(e){if(null==y.data||null==y.colorMap)return new Misc.Pen;var t=y.data.interval(ZAxis),e=y.colorMap.rgb(t,e);return new Misc.Pen(e.toString())},this.calculateContourLevels=function(e,t,n){if(e<1)return[];var i=y.data.interval(ZAxis);null==t&&(t=i.minValue(),n=i.maxValue());for(var r=(n-t)/e,a=[],s=t+.5*r;s<n;s+=r)a.push(s);return a};let t=10;this.numberOfContourPlanes=function(){return t},this.setNumberOfContourPlanes=function(e){t=e,this.setContourLevels(this.calculateContourLevels(e))},this.setContourLevels=function(e){y.contourLevels=e,_.sortBy(y.contourLevels),this.legendChanged(),this.itemChanged()},this.contourLevels=function(){return y.contourLevels},this.setData=function(e){e!=y.data&&(y.data=e,this.invalidateCache(),this.itemChanged())},this.data=function(){return y.data},this.interval=function(e){return null==y.data?new Interval:y.data.interval(e)},this.renderImage=function(e,t,n,i){if(i.isEmpty()||null==y.data||null==y.colorMap)return new Misc.Image;var r=y.data.interval(ZAxis);if(!r.isValid())return new Misc.Image;var a=new Misc.Image(i);y.colorMap.format()==Enum.Format.Indexed&&a.setColorTable(y.colorMap.colorTable(r)),y.data.initRaster(n,a.size());i=new Misc.Rect(0,0,i.width,i.height);return this.renderTile(e,t,i,a),y.data.discardRaster(),a},this.renderTile=function(e,t,n,i){var r=y.data.interval(ZAxis);if(r.isValid()){var a,s=this.pixelSize().width-1,o=this.pixelSize().height-1,l=1+s,c=1+o,u=n.top()+o,h=n.bottom(),d=n.left()+s,f=n.right();if(y.colorMap.format()==Enum.Format.RGB)for(a=u;a<h;a+=c)for(var p=t.invTransform(a),m=d;m<f;m+=l)for(var g=e.invTransform(m),v=y.colorMap.rgb(r,y.data.value(g,p)),b=o;0<=b;--b)for(var S=s;0<=S;--S)i.setPixel(m+S-s,a+b-o,v);else if(y.colorMap.format()==Enum.Format.Indexed)for(a=u;a<h;a+=c){p=t.invTransform(a);for(m=d;m<f;m+=l)for(g=e.invTransform(m),v=i.pixel(y.colorMap.colorIndex(r,y.data.value(g,p))),b=o;0<=b;--b)for(S=s;0<=S;--S)i.setPixel(m+S-s,a+b-o,v)}}},this.renderContourLines=function(o,l,c,e){var t,n;null!=y.data&&(t=y.contourLevels,n=y.data.contourLinesData(t,80,80),new Conrec(function(e,t,n,i,r,a){var s=u.defaultContourPen();(s=s.style==Static.NoPen?u.contourPen(r):s).style!=Static.NoPen&&(o.setPen(s),o.drawLine(l.transform(e),c.transform(t),l.transform(n),c.transform(i)))}).contour(n.d,0,n.x.length-1,0,n.y.length-1,n.x,n.y,t.length,t))}}draw(e,t){var n,i=this.privateData(),r=this.getCanvasRect(),a=new PaintUtil.Painter(this);i.displayMode&Enum.DisplayMode.ImageMode&&super.draw(a,e,t,r),i.displayMode&Enum.DisplayMode.ContourMode&&(n=ScaleMap.invTransform_Rect(e,t,r),(i=this.boundingRect()).isValid()&&(n.united(i),n.isEmpty())||this.renderContourLines(a,e,t,r))}}define("plotSpectrogram",["static","conrec","plotRasterItem"],function(){});class ColorStop{constructor(e,t){this.pos,this.m_rgb,null==e?(this.pos=0,this.m_rgb=0):(this.pos=e,-1!==(this.m_rgb=t).indexOf("#")&&(this.m_rgb=Static.HTMLToRGB(t)),this.r=this.m_rgb.r,this.g=this.m_rgb.g,this.b=this.m_rgb.b,this.a=this.m_rgb.a,void 0===this.a&&(this.a=255),this.r0=this.r+.5,this.g0=this.g+.5,this.b0=this.b+.5,this.a0=this.a+.5,this.rStep=0,this.gStep=0,this.bStep=0,this.aStep=0,this.posStep=0),this.updateSteps=function(e){this.rStep=e.r-this.r,this.gStep=e.g-this.g,this.bStep=e.b-this.b,this.aStep=e.a-this.a,this.posStep=e.pos-this.pos}}}class ColorStops{constructor(){var a=!1,s=[];this.findUpper=function(e){for(var t=0,n=s.length;0<n;){var i=n>>1,r=t+i;s[r].pos<=e?(t=r+1,n-=1+i):n=i}return t},this.insert=function(e,t){if("#"!==t[0]&&(t=Static.colorNameToHex(t)),!(e<0||1<e)){var n;if(0==s.length)n=0,s.resize(1);else if((n=this.findUpper(e))==s.length||.001<=Math.abs(s[n].pos-e)){s.resize(s.length+1);for(var i=s.length-1;n<i;i--)s[i]=s[i-1]}s[n]=new ColorStop(e,t),255!=t.alpha&&(a=!0),0<n&&s[n-1].updateSteps(s[n]),n<s.length-1&&s[n].updateSteps(s[n+1])}},this.rgb=function(e,t){if(t<=0)return s[0].m_rgb;if(1<=t)return s[s.length-1].m_rgb;var n=this.findUpper(t);if(e==Enum.Mode.FixedColors)return s[n-1].m_rgb;var i=s[n-1],r=(t-i.pos)/i.posStep,e=Math.round(i.r0+r*i.rStep),n=Math.round(i.g0+r*i.gStep),t=Math.round(i.b0+r*i.bStep);if(a){if(i.aStep){r=i.a0+r*i.aStep;return Static.mRgba(e,n,t,r)}return Static.mRgba(e,n,t,i.a)}return Static.mRgb(e,n,t)},this.stops=function(){for(var e=new Array(s.length),t=0;t<s.length;t++)e[t]=s[t].pos;return e}}}class ColorMap{constructor(e){var t=e;this.format=function(){return t},this.colorTable=function(e){var t=new Array(256);if(e.isValid())for(var n=e.width()/(t.length-1),i=0;i<t.length;i++)t[i]=this.rgb(e,e.minValue()+n*i);return t},this.rgb=function(e,t){return{r:0,g:0,b:0,a:0}}}}class LinearColorMap extends ColorMap{constructor(e,t,n){var i,r=null==n;super(n=r?e:n),this.m_mode=Enum.Mode.ScaledColors,this.setColorInterval=function(e,t){(i=new ColorStops).insert(0,e),i.insert(1,t)},r?this.setColorInterval("#0000FF","#FFFF00"):this.setColorInterval(e,t),this.setMode=function(e){this.m_mode=e},this.mode=function(){return this.m_mode},this.addColorStop=function(e,t){0<=e&&e<=1&&i.insert(e,t)},this.colorStops=function(){return i.stops()},this.color1=function(){return i.rgb(this.m_mode,0)},this.color2=function(){return i.rgb(this.m_mode,1)},this.rgb=function(e,t){if(isNaN(t))return 0;var n=e.width();if(n<=0)return 0;n=(t-e.minValue())/n;return i.rgb(this.m_mode,n)},this.colorIndex=function(e,t){var n=e.width();if(isNaN(t)||n<=0||t<=e.minValue())return 0;if(t>=e.maxValue())return 255;n=(t-e.minValue())/n,n=this.m_mode==Enum.Mode.FixedColors?255*n:255*n+.5;return n}}}define("colorMap",["static"],function(){});class RasterData{constructor(){var n=[null,null,null];this.setInterval=function(e,t){n[e]=t},this.interval=function(e){return n[e]},this.initRaster=function(e,t){},this.discardRaster=function(){},this.contourLinesData=function(e,t,n){for(var i=t||100,r=n||100,t=this.interval(XAxis),n=this.interval(YAxis),a=t.width()/(i-1),s=n.width()/(r-1),o=[],l=t.minValue(),c=[],u=n.minValue(),h=0;h<i;h++)o.push(l+h*a);for(h=0;h<r;h++)c.push(u+h*s);o[i-1]=t.maxValue(),c[r-1]=n.maxValue();for(var d=[],f=0;f<o.length;f++){for(var p=[],m=0;m<c.length;m++)p.push(this.value(o[f],c[m]));d.push(p)}return{d:d,x:o,y:c}}}value(e,t){}}define("rasterData",function(){});class RasterFileData extends RasterData{constructor(e){Enum.InterpolationType={cubic:0,linear:1},super(),this._interpolationType=Enum.InterpolationType.linear;var t,n=e.array;this.samples3D=[];for(var i=0,r=n.length,a=0;a<r;a++)if(0!=a){if(t!==n[a].x)break;i++}else t=n[a].x,i++;this.samples3D=_.chunk(n,i),this.minX=this.samples3D[0][0].x,this.maxX=this.samples3D[this.samples3D.length-1][0].x;var s=this.samples3D[0];this.minY=s[0].y,this.maxY=s[s.length-1].y,this.setInterval(XAxis,new Interval(this.minX,this.maxX)),this.setInterval(YAxis,new Interval(this.minY,this.maxY)),this.setInterval(ZAxis,new Interval(e.minZ,e.maxZ))}interpolaionType(){return this._interpolationType}setInterpolaionType(e){e<Enum.InterpolationType.cubic||e>Enum.InterpolationType.linear||(this._interpolationType=e)}value(e,t){return(e=e>this.maxX?this.maxX:e)<this.minX&&(e=this.minX),(t=t>this.maxY?this.maxY:t)<this.minY&&(t=this.minY),this.interpolaionType()==Enum.InterpolationType.cubic?Utility.bicubicInterpolate(this.samples3D,e,t):this.interpolaionType()==Enum.InterpolationType.linear?Utility.bilinearInterpolate(this.samples3D,e,t):void 0}}define("rasterFileData",["rasterData"],function(){});class RasterFunctionData extends RasterData{constructor(e){super();var t=e.fx,n=new EvaluateExp(t=(t=t.replaceAll(e.variable,"_x")).replaceAll(e.variableY,"_y"));if(n.error)return Static.alert(n.errorMessage),null;this.minX=e.minX,this.maxX=e.maxX,this.minY=e.minY,this.maxY=e.maxY,this.setInterval(XAxis,new Interval(this.minX,this.maxX)),this.setInterval(YAxis,new Interval(this.minY,this.maxY)),this.setInterval(ZAxis,new Interval(e.minZ,e.maxZ)),this.getValue=function(e,t){return n.eval({_x:e,_y:t})}}value(e,t){return(e=e>=this.maxX?this.maxX:e)<this.minX&&(e=this.minX),(t=t>=this.maxY?this.maxY:t)<this.minY&&(t=this.minY),this.getValue(e,t)}}define("rasterFunctionData",["rasterData"],function(){});class LinearColorMapRGB extends LinearColorMap{constructor(){super(Enum.Format.RGB),this.setColorInterval("darkCyan","red"),this.addColorStop(.1,"cyan"),this.addColorStop(.6,"green"),this.addColorStop(.95,"yellow")}}class LinearColorMapIndexed extends LinearColorMap{constructor(){super(Enum.Format.Indexed),this.setColorInterval("darkCyan","red"),this.addColorStop(.1,"cyan"),this.addColorStop(.6,"green"),this.addColorStop(.95,"yellow")}}class Spectrogram extends PlotSpectrogram{constructor(e){super(e);Enum.ColorMap={RGBMap:0,IndexMap:1,HueMap:2,AlphaMap:3};var o,l=255;this.setColorMap(new LinearColorMapRGB),this.setAlpha(l),this.setCachePolicy(Enum.CachePolicy.PaintCache);for(var t=[],n=.5;n<10;n+=1)t.push(n);this.setContourLevels(t),this.setItemAttribute(Legend,!0),this.showContour=function(e){this.setDisplayMode(Enum.DisplayMode.ContourMode,e),this.plot().replot()},this.showSpectrogram=function(e){this.setDisplayMode(Enum.DisplayMode.ImageMode,e),this.setDefaultContourPen(e?new Misc.Pen("black",0):new Misc.Pen(Static.NoPen))},this.setSpectrogramColorMap=function(e){var t=this.plot(),n=(t.axisWidget(yRight),this.data().interval(ZAxis),l);switch(o=e){case Enum.ColorMap.HueMap:case Enum.ColorMap.AlphaMap:case Enum.ColorMap.IndexMap:{const i=this.colorMap(),r=new LinearColorMapIndexed;r.setColorInterval(i.color1(),i.color2()),r.addColorStop(.1,"cyan"),r.addColorStop(.6,"green"),r.addColorStop(.95,"yellow"),this.setColorMap(r);break}default:Enum.ColorMap.RGBMap;{const a=this.colorMap(),s=new LinearColorMapRGB;s.setColorInterval(a.color1(),a.color2()),s.addColorStop(.1,"cyan"),s.addColorStop(.6,"green"),s.addColorStop(.95,"yellow"),this.setColorMap(s)}}this.setSpectrogramAlpha(n),t.replot()},this.setSpectrogramAlpha=function(e){var t=this.plot();l=e,o!=Enum.ColorMap.AlphaMap&&(this.setAlpha(e),t.replot())}}}class SpectrogramFileData extends RasterFileData{constructor(e){super(e),this.setInterval(ZAxis,new Interval(0,10))}}class SpectrogramFunctionData extends RasterFunctionData{constructor(e){super(e)}}define("spectrogram",["static","plotSpectrogram","colorMap","rasterFileData","rasterFunctionData"],function(){});class MyPlot extends Plot{constructor(e,t){super(e,t);var o=this,n=!0;function l(e,t,n,i){if(!t||0==t.length)return null;if(o.findPlotCurve(e))return Static.alert(e+" already exist"),null;e=new MyCurve(e);e.expandedFn=i,n||o.addCurveInit(e),e.setSamples(t),e.setPen(new Misc.Pen(Utility.randomColor())),o.curveAttributeDlg.defaultIconSize=new Misc.Size(e.getLegendIconSize());t="";return Static.showline&&Static.showsymbol?t="lineAndSymbol":Static.showline?t="line":Static.showsymbol&&(t="symbol"),Utility.setLegendAttribute(e,t,e.getLegendIconSize()),e.attach(o),o.rv.setCurrentCurve(e),o.sidebar&&(o.sidebar.initSidebar(),o.rv.refresh()),e}function c(e,t,n,i,r){var a,s,i=r?(a=i.array,s=i.minZ,i.maxZ):(a=i.data,s=i.zLimits.min,i.zLimits.max);if(!a||0==a.length)return null;if(o.findPlotCurve(e))return Static.alert(e+" already exist"),null;e=new SpectroCurve(e);return e.minZ=s,e.maxZ=i,e.setSamples(a),e.setPenWidth(4),e.setColorInterval(t,n),e.setColorRange(new Interval(s,i)),e.attach(o),e}function u(e,t,n,i,r){var a=new Spectrogram(e);a.upload=r,a.spectrogramData=i,r?a.setData(new SpectrogramFileData(i)):a.setData(new SpectrogramFunctionData(i)),a.setNumberOfContourPlanes(10);const s=a.colorMap();return s.setColorInterval(t,n),s.addColorStop(.1,"cyan"),s.addColorStop(.6,"green"),s.addColorStop(.95,"yellow"),a.attach(o),Static.bind("alphaChanged",function(e,t){a.setAlpha(t)}),Static.bind("showSpectrogram",function(e,t){a.setDisplayMode(Enum.DisplayMode.ImageMode,t),a.setDefaultContourPen(t?new Misc.Pen("black",0):new Misc.Pen(Static.NoPen))}),Static.bind("showContour",function(e,t){a.setDisplayMode(Enum.DisplayMode.ContourMode,t)}),Static.bind("numberOfPlanes",function(e,t){console.log(4441),a.setContourLevels(a.calculateContourLevels(t))}),a}function h(e){let t={};return(t.rtti=e)==Static.Rtti_PlotCurve&&(t.coeffs=o._functionDlg.coeffs,t.expandedFn=o._functionDlg.expandedFn,t.fn=o._functionDlg.fn,t.lowerLimit=o._functionDlg.lowerLimit,t.numOfPoints=o._functionDlg.numOfPoints,t.threeD=o._functionDlg.threeD,t.title=o._functionDlg.title,t.unboundedRange=o._functionDlg.unboundedRange,t.upperLimit=o._functionDlg.upperLimit,t.variable=o._functionDlg.variable),e==Static.Rtti_PlotSpectroCurve&&(t.color1=o._functionDlg.color1,t.color2=o._functionDlg.color2,t.expandedFn=o._functionDlg.expandedFn,t.fn=o._functionDlg.fn,t.lowerLimit=o._functionDlg.lowerLimit,t.lowerLimitFxy=o._functionDlg.lowerLimitFxy,t.lowerLimitY=o._functionDlg.lowerLimitY,t.numOfPoints=o._functionDlg.numOfPoints,t.threeD=o._functionDlg.threeD,t.threeDType=o._functionDlg.threeDType,t.title=o._functionDlg.title,t.upperLimit=o._functionDlg.upperLimit,t.upperLimitFxy=o._functionDlg.upperLimitFxy,t.upperLimitY=o._functionDlg.upperLimitY,t.variable=o._functionDlg.variable,t.variableY=o._functionDlg.variableY),e==Static.Rtti_PlotSpectrogram&&(t.color1=o._functionDlg.color1,t.color2=o._functionDlg.color2,t.expandedFn=o._functionDlg.expandedFn,t.fn=o._functionDlg.fn,t.lowerLimit=o._functionDlg.lowerLimit,t.lowerLimitFxy=o._functionDlg.lowerLimitFxy,t.lowerLimitY=o._functionDlg.lowerLimitY,t.numOfPoints=o._functionDlg.numOfPoints,t.threeD=o._functionDlg.threeD,t.threeDInterpolationType=o._functionDlg.threeDInterpolationType,t.threeDType=o._functionDlg.threeDType,t.title=o._functionDlg.title,t.upperLimit=o._functionDlg.upperLimit,t.upperLimitFxy=o._functionDlg.upperLimitFxy,t.upperLimitY=o._functionDlg.upperLimitY,t.variable=o._functionDlg.variable,t.variableY=o._functionDlg.variableY),t}this.grid=new PlotGrid,this.fileSystemServices=null,Static.curvePropPane=0,Static.plotPropPane=1,Static.infoPropPane=2,this.grid.attach(this),Utility.minorGridLines(this.grid,!0),this.insertLegend(new MLegend),this.enableLegend(!0),this.file=new MFile(this),this.markerDlg=new MMarkerDlg,this.pointEntryDlg=new MPointEntryDlg,this._functionDlg=new MFunctionDlg,this.curveFitDlg=new MCurveFitDlg,this.curveStyleDlg=new MCurveStyleDlg,this.axisDlg=new MAxisDlg,this.curveAttributeDlg=new MCurveLegendAttributeDlg,this.addCurveInit=function(e){e.coeffs=o._functionDlg.coeffs,e.variable=o._functionDlg.variable,e.coeffsVal=function(){for(var e=[],t=o._functionDlg.coeffs||[],n=0;n<t.length;++n)e.push(1);return e}(),e.fn=o._functionDlg.expandedFn,e.unboundedRange=o._functionDlg.unboundedRange,e.lowerX=parseFloat(o._functionDlg.lowerLimit),e.upperX=parseFloat(o._functionDlg.upperLimit),e.numOfSamples=o._functionDlg.numOfPoints},Static.bind("addSpectrocurve",function(e,t,n,i){c(t,"red","green",n,i)}),this.uploadSpectrogram=function(e,t,n){const i=u(e.title,e.color1,e.color2,t,n);return i.setNumberOfContourPlanes(e.numberOfContourPlanes),i.showContour(e.showContour),i.showSpectrogram(e.showSpectrogram),i},Static.bind("addSpectrogram",function(e,t,n,i){u(t,"#008b8b","#ff0000",n,i)}),Static.bind("addCurve",function(e,t,n,i,r){l(t,n,i)}),this.createCurve=function(e,t){return e==Static.Rtti_PlotCurve?new MyCurve(t):e==Static.Rtti_PlotMarker?new PlotMarker(t):e==Static.Rtti_PlotSpectroCurve?new SpectroCurve(t):void 0},this.functionDlgCb=function(e=null){let t=null;e&&((i=e).rtti==Static.Rtti_PlotCurve&&(o._functionDlg.coeffs=i.coeffs,o._functionDlg.expandedFn=i.expandedFn,o._functionDlg.lowerLimit=i.lowerLimit,o._functionDlg.numOfPoints=i.numOfPoints,o._functionDlg.threeD=i.threeD,o._functionDlg.title=i.title,o._functionDlg.unboundedRange=i.unboundedRange,o._functionDlg.upperLimit=i.upperLimit,o._functionDlg.variable=i.variable),i.rtti==Static.Rtti_PlotSpectroCurve&&(o._functionDlg.color1=i.color1,o._functionDlg.color2=i.color2,o._functionDlg.expandedFn=i.expandedFn,o._functionDlg.fn=i.fn,o._functionDlg.lowerLimit=i.lowerLimit,o._functionDlg.lowerLimitFxy=i.lowerLimitFxy,o._functionDlg.lowerLimitY=i.lowerLimitY,o._functionDlg.numOfPoints=i.numOfPoints,o._functionDlg.threeD=i.threeD,o._functionDlg.threeDType=i.threeDType,o._functionDlg.title=i.title,o._functionDlg.upperLimit=i.upperLimit,o._functionDlg.upperLimitFxy=i.upperLimitFxy,o._functionDlg.upperLimitY=i.upperLimitY,o._functionDlg.variable=i.variable,o._functionDlg.variableY=i.variableY),i.rtti==Static.Rtti_PlotSpectrogram&&(o._functionDlg.color1=i.color1,o._functionDlg.color2=i.color2,o._functionDlg.expandedFn=i.expandedFn,o._functionDlg.fn=i.fn,o._functionDlg.lowerLimit=i.lowerLimit,o._functionDlg.lowerLimitFxy=i.lowerLimitFxy,o._functionDlg.lowerLimitY=i.lowerLimitY,o._functionDlg.numOfPoints=i.numOfPoints,o._functionDlg.threeD=i.threeD,o._functionDlg.threeDInterpolationType=i.threeDInterpolationType,o._functionDlg.threeDType=i.threeDType,o._functionDlg.title=i.title,o._functionDlg.upperLimit=i.upperLimit,o._functionDlg.upperLimitFxy=i.upperLimitFxy,o._functionDlg.upperLimitY=i.upperLimitY,o._functionDlg.variable=i.variable,o._functionDlg.variableY=i.variableY));var e=o._functionDlg.title,n=o._functionDlg.expandedFn,i=(o._functionDlg.lowerLimit,o._functionDlg.upperLimit,o._functionDlg.numOfPoints);if(o._functionDlg.threeD)return"spectrocurve"===o._functionDlg.threeDType?(t=c(e,o._functionDlg.color1,o._functionDlg.color2,Utility.makeSamples({fx:n,threeD:!0,variable:o._functionDlg.variable,variableY:o._functionDlg.variableY,lowerX:parseFloat(o._functionDlg.lowerLimit),upperX:parseFloat(o._functionDlg.upperLimit),lowerY:parseFloat(o._functionDlg.lowerLimitY),upperY:parseFloat(o._functionDlg.upperLimitY),numOfSamples:o._functionDlg.numOfPoints,ok_fn:o._functionDlg.ok})),t.fn=n,t.functionDlgData=h(t.rtti),t&&o._functionDlg.close&&o._functionDlg.close()):"spectrogram"===o._functionDlg.threeDType&&(s={fx:n,variable:o._functionDlg.variable,variableY:o._functionDlg.variableY,minX:parseFloat(o._functionDlg.lowerLimit),maxX:parseFloat(o._functionDlg.upperLimit),minY:parseFloat(o._functionDlg.lowerLimitY),maxY:parseFloat(o._functionDlg.upperLimitY),minZ:parseFloat(o._functionDlg.lowerLimitFxy),maxZ:parseFloat(o._functionDlg.upperLimitFxy)},t=u(e,o._functionDlg.color1,o._functionDlg.color2,s),t.fn=n,t.functionDlgData=h(t.rtti),t&&o._functionDlg.close&&o._functionDlg.close()),t;var r=o._functionDlg.coeffs;if(r&&o._functionDlg.coeffs.length)for(var a=0;a<r.length;++a)for(;-1!=n.indexOf(r[a]);)n=n.replace(r[a],1);if(!o._functionDlg.unboundedRange){var s={fx:n,variable:o._functionDlg.variable,lowerX:parseFloat(o._functionDlg.lowerLimit),upperX:parseFloat(o._functionDlg.upperLimit),numOfSamples:o._functionDlg.numOfPoints,ok_fn:o._functionDlg.ok},s=Utility.makeSamples(s);return t=l(e,s,!1,n),t.functionDlgData=h(t.rtti),t&&o._functionDlg.close&&o._functionDlg.close(),t}t=function(e,t,n){if(o.findPlotCurve(e))return Static.alert(e+" already exist"),null;o.setAxisScale(xBottom,1,10);let i=new MyCurve(e);return o.addCurveInit(i),i.functionData=new FunctionData(t,n),i.setData(i.functionData),i.setPen(new Misc.Pen(Utility.randomColor())),o.curveAttributeDlg.defaultIconSize=new Misc.Size(i.getLegendIconSize()),Static.showline&&i.setLegendAttribute(LegendShowLine,!0),Static.showsymbol&&i.setLegendAttribute(LegendShowSymbol,!0),i.attach(o),i}(e,n,i),t&&o._functionDlg.close&&o._functionDlg.close()},this._functionDlg.init(o.functionDlgCb),this.addRemovePoint=new AddRemovePointPicker(this),this.addRemovePoint.setAddRemoveMousePattern(Enum.MousePatternCode.MouseSelect1,Static.LeftButton,Static.ShiftModifier);var i=new Rulers(this);Static.watchCentroidWithArea=!0,Static.bind("watchCentroidWithArea",function(e,t){Static.watchCentroidWithArea=t,Static.trigger("invalidateWatch"),i.updateWatchesAndTable()}),this.tbar=new MToolBar(this,{zIndex:1003},o.plotDiv),this.curveClosestPoint=new CurveClosestPoint(this),this.curveClosestPoint.setMousePattern(Static.LeftButton,Static.AltModifier),this.cs=new CurveShapeItem(this),this.curveShapeEnabledByPlotSettings=function(){return n},this.setCurveShapeEnabledByPlotSettings=function(e){n=e},this.setAxisTitle(xBottom,"Bottom scale"),this.setAxisTitle(xTop,"Top scale"),this.setAxisTitle(yLeft,"Left scale"),this.setAxisTitle(yRight,"Right scale"),this.magnifier=new Magnifier(this),this.pan=new Panner(this),this.pan.setCursor("move"),this.pan.setEnabled(!1),this.zm=new MyPlotZoomer(this);this.leftSidebar=new PlotSideBar(this,o.plotDiv),this.leftSidebar.setTop(parseInt($("#toolBar1").css("height"))+2);new CurvePropertiesPane(this.leftSidebar.gridItem(0).bodyElement,this,Static.curvePropPane);var r=new PlotPropertiesPane(this.leftSidebar.gridItem(1).bodyElement,this,Static.plotPropPane);this.leftSidebar.showGridItem(1,!0),this.rightSidebar=new InfoSideBar(this,o.plotDiv),this.rightSidebar.setTop(parseInt($("#toolBar1").css("height"))+2);new InfoPropertiesPane(this.rightSidebar.gridItem(0).bodyElement,this,Static.infoPropPane);this.rightSidebar.showSidebar(!1),this.settings=function(){return r},this.setFooter("Footer");var a=new LegendMenu(this);a.modifyMenu(null,{pos:2,name:"axis",img:"images/axis.png",title:"Sets the axes associated with the curve.",fun:function(){var e=a.getCurve();e&&o.axisDlg.axisCb(e)}}),a.setMenuModificationCb(function(){var e=a.getCurve();e.rtti===Static.Rtti_PlotSpectroCurve||e.rtti===Static.Rtti_PlotSpectrogram?(a.modifyMenu("curve brush",{}),a.modifyMenu("curve style",{}),a.modifyMenu("legend attribute",{}),a.modifyMenu("fit",{}),a.modifyMenu("symbol",{}),a.modifyMenu("pen",{})):a.modifyMenu(null,[{pos:0,name:"curve brush",img:"images/brush.png",title:"Set the fill color.",fun:function(){Utility.setCurveBrush(m_curve,function(e){Static.trigger("curveBrushChanged",e)})}},{pos:1,name:"curve style",img:"images/style.png",title:"Sets the style of the curve.",fun:function(){var e=a.getCurve();e&&o.curveStyleDlg.curveStyleCb(e)}},{pos:3,name:"legend attribute",img:"images/attribute.png",title:"Sets how the curve is represented on the legend.",fun:function(){var e=a.getCurve();e&&o.curveAttributeDlg.curveAttributeCb(e)}},{pos:6,name:"fit",img:"images/fit.png",title:"Defines a curve fitter.",fun:function(){var e=a.getCurve();e&&o.curveFitDlg.curveFitCb(e)}},{pos:7,name:"symbol",img:"images/symbol.png",title:"attach/modify curve symbol",subMenu:null},{pos:8,name:"pen",img:"images/pen.png",title:"modify/change curve pen",subMenu:a.getPenSubMenu()}]),e.rtti===Static.Rtti_PlotSpectroCurve?a.modifyMenu(null,{name:"pen width",subMenu:a.getPenWidthSubMenu()}):a.modifyMenu("pen width",{}),a.getCurve().fitType?a.modifyMenu(null,{pos:100,name:"fit info...",title:"Displays information associated with curve fitting.",fun:function(){var e,t=a.getCurve();t&&((e=o.curveFitDlg.curveFitInfoCb(t)).length?Static.alert(e):Static.alert('No curve fitting equation found for "'+t.title()+'."'))}}):a.modifyMenu("fit info...",{})}),this.file.setInputElement($("#fileInput")),this.replot(),this.setAutoReplot(!0),Static.bind("visibilityChange",function(e,t,n){t.rtti==Static.Rtti_PlotCurve&&(o.hasVisiblePlotCurve()?o.watchAreaBelowCurve.setEnable(o.tbar.isDropdownItemChecked("Watch",6)):o.watchAreaBelowCurve.setEnable(!1))});var s=o.getLayout().getCentralDiv(),d=[{name:"Hide rulers",img:"images/hide.png",title:"Hide all rulers",fun:function(){o.rv.setVisible(!1)}},{name:"Show rulers",img:"images/show.png",title:"Show any hidden rulers",fun:function(){o.rv.setVisible(!0)}},{name:"Unlock rulers",img:"images/unlock.png",title:"Unlock any locked rulers",fun:function(){o.rv.unlockAllRulers()}},{name:"Remove all curves",title:"Permanently remove all curves",img:"images/scissors.png",fun:function(){var e=o.itemList(Static.Rtti_PlotCurve);e.forEach(function(e){e.detach()}),(e=o.itemList(Static.Rtti_PlotSpectroCurve)).forEach(function(e){e.detach()}),(e=o.itemList(Static.Rtti_PlotSpectrogram)).forEach(function(e){e.detach()})}}];Static.bind("rulerDeselected",function(){s.contextMenu(d,{triggerOn:"contextmenu",zIndex:1})}),s.contextMenu(d,{triggerOn:"contextmenu",zIndex:1});var f=!0;Static.bind("gridlinesAccordingToCurve",function(e,t){f=t;t=i.currentCurve();t&&f&&o.grid.setAxes(t.xAxis(),t.yAxis())}),Static.bind("currentCurveChanged",function(e,t){t&&f&&o.grid.setAxes(t.xAxis(),t.yAxis()),t&&p&&o.zm.setAxis(t.xAxis(),t.yAxis())}),Static.bind("axisChanged",function(e,t,n){var i=o.rv.currentCurve();n&&f&&o.grid.setAxes(i.xAxis(),i.yAxis()),n&&p&&o.zm.setAxis(i.xAxis(),i.yAxis())});var p=!0;Static.bind("zoomAccordingToCurve",function(e,t){p=t;t=i.currentCurve();t&&p&&o.zm.setAxis(t.xAxis(),t.yAxis())});class m extends FileSystemServices{constructor(e){super(e);const t=this;$(window).on("beforeSave",()=>{}),$(window).on("afterSave",()=>{$("#myText").focus()}),$("#myText").on("input",()=>{t.currentFileModified()})}setData(e,t,n,i){alert(`Do not know how to open files with extension "${n}".`)}getRefreshToken(){return super.getRefreshToken()}}const g=o.fileSystemServices=new m({fsServerUrl:"https://grapher-file-system.herokuapp.com",sameDomain:!1,listOfFileTypes:[{display:"Grapher plot (*.plt)",ext:".plt",defaultFilename:"Grapher Plot"},{display:"Data table (*.tbl)",ext:".tbl",defaultFilename:"Data table"},{display:"Defines (*.def)",ext:".def",defaultFilename:"Defines"},{display:"Image (*.png)",ext:".png",defaultFilename:"PNG Image"},{display:"Excel (*.xls)",ext:".xls",defaultFilename:"Excel Worksheet"}],listOfOpenWithTypes:[{name:"Text Editor",options:{encoding:"utf8",flag:"r"}},{name:"Grapher",options:{encoding:"utf8",flag:"r"}}]});class v extends Editor{constructor(e){super(e);const t=this;e.fs.addSaveMenuItem(t),e.fs.addSaveAsMenuItem(t),e.fs.registerEditor({name:"Grapher",editor:t}),Static.bind("replot",function(){t.currentFileModified(!0)})}getData(){return o.file.getPlotData()}setData(e,t,n,i){".tbl"!=n&&".txt"!=n&&".plt"!=n&&"Grapher"!=i||(".plt"!==n&&".txt"!==n&&".tbl"!==n||o.file.setPlotData({content:e,fileName:t}),".plt"===n&&this.currentFilename(t))}}class b extends Editor{constructor(e){super(e);e.fs.registerEditor({name:"Defines",editor:this})}}const S={};S.fs=g,S.editorName="Grapher",S.fileExtensions=[".plt",".tbl",".txt"],o.grapherEditor=new v(S);const y={};y.fs=g,y.editorName="Defines",y.fileExtensions=[".def",".txt"],o.definesEditor=new b(y),g.enableNotepad()}}define("myPlot",["curveClosestPoint","plot","functionData","plotGrid","spectrogram"],function(){});class Curve extends PlotSeriesItem{constructor(e){super(e),Static.LegendNoAttribute=0,Static.LegendShowLine=1,Static.LegendShowSymbol=2,Static.LegendShowBrush=4;var o=Lines,m=0,d=0,u=FilterPoints,n=Static.LegendNoAttribute,l=new Misc.Brush,c=new Misc.Pen,t=null,h=null;function f(e){return e*e}this.rtti=Static.Rtti_PlotCurve,this.setItemInterest(ScaleInterest,!0),this.minXValue=function(){return this.boundingRect().left()},this.maxXValue=function(){return this.boundingRect().right()},this.minYValue=function(){return this.boundingRect().top()},this.maxYValue=function(){return this.boundingRect().bottom()},this.setLegendAttribute=function(e,t){t!=this.testLegendAttribute(e)&&(t?n|=e:n&=~e,Utility.updateLegendIconSize(this),this.plot()&&this.plot().updateLegend(this))},this.testLegendAttribute=function(e){return n&e},this.legendAttributes=function(){return n},this.setSymbol=function(e){e!==h&&(h=e,Utility.updateLegendIconSize(this),this.legendChanged(),this.itemChanged())},this.symbol=function(){return h},this.setBrush=function(e){"string"==typeof e&&(e=new Misc.Brush(e)),l=e,this.legendChanged(),this.itemChanged()},this.brush=function(){return l},this.setPen=function(e){"object"==typeof e&&(c=e,this.legendChanged(),this.itemChanged())},this.pen=function(){return c},this.setPaintAttribute=function(e,t){t?u|=e:u&=~e},this.testPaintAttribute=function(e){return u&e},this.setSamples=function(e){this.setData(new PointSeriesData(e))},this.setCurveAttribute=function(e,t){(m&e)!=(t=void 0===t?!0:t)&&(t?m|=e:m&=~e,this.itemChanged())},this.curveAttributes=function(){return m},this.testCurveAttribute=function(e){return m&e},this.init=function(){this.setItemAttribute(Legend,!0),this.setItemAttribute(AutoScale,!0),this.setData(new PointSeriesData),this.setCurveAttribute(Fitted,!0),this.setZ(20)},this.setStyle=function(e){e!=o&&(o=e,this.legendChanged(),this.itemChanged())},this.style=function(){return o},this.drawSeries=function(e,t,n,i){var r=this.getContext(),a=new PaintUtil.Painter(r),s=this.dataSize();s<=0||(i<0&&(i=s-1),0<Utility.mVerifyRange(s,n,i)&&(a.save(),a.setPen(c),a.setBrush(l),this.drawCurve(a,o,e,t,n,i),a.restore(),h&&h.style()!==NoSymbol&&(a.save(),a.setPen(h.pen()),a.setBrush(h.brush()),this.drawSymbols(r,h,e,t,n,i),a.restore())))},this.drawSymbols=function(e,t,n,i,r,a){var s=new PointMapper;s.setFlag(WeedOutPoints,this.testPaintAttribute(FilterPoints));for(var o=r;o<=a;o+=500){var l=Math.min(500,a-o+1),l=s.toPointsF(n,i,this.data(),o,o+l-1);0<l.length&&t.drawSymbols(e,l)}},this.setBaseline=function(e){d!=e&&(d=e,this.itemChanged())},this.baseline=function(){return d},this.drawCurve=function(e,t,n,i,r,a){switch(t){case Lines:this.testCurveAttribute(Fitted)&&(r=0,a=this.dataSize()-1),this.drawLines(e,n,i,r,a);break;case Sticks:this.drawSticks(e,n,i,r,a);break;case Steps:this.drawSteps(e,n,i,r,a);break;case Dots:this.drawDots(e,n,i,r,a)}},this.setCurveFitter=function(e){t=e,this.itemChanged()},this.curveFitter=function(){return t},this.closestPoint=function(e,t){var n=this.dataSize();if(null==this.plot()||n<=0)return-1;let i=this.data(),r=this.plot().canvasMap(this.xAxis()),a=this.plot().canvasMap(this.yAxis()),s=-1,o=1e10;for(var l=0;l<n;l++){var c=i.sample(l),u=r.transform(c.x)-e.x,c=a.transform(c.y)-e.y,c=f(u)+f(c);c<o&&(s=l,o=c)}return t&&(t.distance=Math.sqrt(o)),s},this.fillCurve=function(e,t,n,i){l.color!=Static.NoBrush&&(this.closePolyline(t,n,i),i.length<=2||(e.setPen(new Misc.Pen(l.color)),e.drawPolygon(i)))},this.closePolyline=function(e,t,n){var i;n.length<2||(i=d,this.orientation()==Vertical?(t.transformation()&&(i=t.transformation().bounded(i)),t=t.transform(i),n.push(new Misc.Point(n[n.length-1].x,t)),n.push(new Misc.Point(n[0].x,t))):(e.transformation()&&(i=e.transformation().bounded(i)),i=e.transform(i),n.push(new Misc.Point(i,n[n.length-1].y)),n.push(new Misc.Point(i,n[0].y))))},this.drawSteps=function(e,t,n,i,r){for(var a=[],s=2*(r-i)+1,o=0;o<s;++o)a.push(new Misc.Point);var l=this.orientation()==Vertical;m&Inverted&&(l=!l);var c,u=this.data();for(o=i,c=0;o<=r;o++,c+=2){var h,d=u.sample(o),f=t.transform(d.x),p=n.transform(d.y);0<c&&(h=a[c-2],d=a[c-1],l?(d.x=h.x,d.y=p):(d.x=f,d.y=h.y)),a[c].x=f,a[c].y=p}e.drawPolyline(a),"noBrush"!=this.brush()&&this.fillCurve(e,t,n,a)},this.drawSticks=function(e,t,n,i,r){for(var a=t.transform(d),s=n.transform(d),o=this.orientation(),l=this.data(),c=i;c<=r;c++){var u=l.sample(c),h=t.transform(u.x),u=n.transform(u.y);o==Horizontal?e.drawLine(a,u,h,u):e.drawLine(h,s,h,u)}},this.drawDots=function(e,t,n,i,r){var a=new PointMapper;if(u&FilterPoints&&a.setFlag(WeedOutPoints,!0),u&MinimizeMemory)for(var s=this.data(),o=i;o<=r;o++){var l=s.sample(o),c=t.transform(l.x),l=n.transform(l.y);e.drawPoint(new Misc.Point(c,l))}else{i=a.toPointsF(t,n,this.data(),i,r);e.drawPoints(i)}},this.legendIcon=function(e,t){if(0===t.width&&0===t.height)return null;var n,i,r,a=new Graphic(null,t.width,t.height),s=new PaintUtil.Painter(a);return(0==this.legendAttributes()||this.legendAttributes()&Static.LegendShowBrush)&&((n=this.brush()).color==Static.NoBrush&&0==this.legendAttributes()&&(this.style()!=NoCurve?n=new Misc.Brush(this.pen().color):this.symbol()&&this.symbol().style()!=NoSymbol&&(n=new Misc.Brush(this.symbol().pen().color))),n.color!=Static.NoBrush&&(i=new Misc.Rect(0,0,t.width,t.height),s.fillRect(i,n))),this.legendAttributes()&Static.LegendShowLine&&this.pen().color!=Static.NoPen&&(r=this.pen(),s.setPen(r),r=.5*t.height,s.drawLine(0,r,t.width,r)),this.legendAttributes()&Static.LegendShowSymbol&&this.symbol()&&(r=t.height/2,this.symbol().style()==Ellipse&&--r,s.setPen(this.symbol().pen()),this.symbol().drawGraphicSymbol(s,new Misc.Point(t.width/2,r),t)),s=null,a},this.removePoint=function(e,t){null==t&&(t=!1);var n=this.data().samples();if(1!=n.length||t){for(var i=[],r=0;r<n.length;++r)n[r].isEqual(e)||i.push(n[r]);i.length!==n.length||t?(this.setSamples(i),this.itemChanged(),Static.trigger("pointRemoved",this)):Static.alert("The point selected for removal does not exist.")}else Static.alert("You cannot remove the only point in the curve. Remove the entire curve.")},this.toString=function(){return"[Curve]"},this.init()}drawLines(e,t,n,i,r){var a,s;r<i||(a=this.curveAttributes()&Fitted&&this.curveFitter(),s=this.brush().color!==Static.NoBrush,r=(new PointMapper).toPolygonF(t,n,this.data(),i,r),a&&(r=this.curveFitter().fitCurve(r)),e.drawPolyline(r),s&&this.fillCurve(e,t,n,r))}}define("plotcurve",["static","seriesData"],function(){});class MyCurve extends Curve{constructor(e){super(e)}}define("myCurve",["plotcurve"],function(){});class SpectroCurve extends PlotSeriesItem{constructor(e){super(e),this.rtti=Static.Rtti_PlotSpectroCurve;var d=new LinearColorMap(Enum.Format.Indexed),f=new Interval(0,1e3),p=0,m=[];this.init=function(){this.setItemAttribute(Legend,!0),this.setItemAttribute(AutoScale,!0),this.setData(new Point3DSeriesData)},this.setPaintAttribute=function(e,t){t?m_paintAttributes|=e:m_paintAttributes&=~e},this.testPaintAttribute=function(e){return m_paintAttributes&e},this.setSamples=function(e){this.setData(new Point3DSeriesData(e))},this.setColorMap=function(e){e!=d&&(d=e),itemChanged()},this.colorMap=function(){return d},this.setColorRange=function(e){e!=f&&(f=e,this.itemChanged())},this.colorRange=function(){return f},this.setPenWidth=function(e){p!=(e=e<0?0:e)&&(p=e,this.itemChanged())},this.penWidth=function(){return p},this.setColorInterval=function(e,t){d.setColorInterval(e,t),this.itemChanged()},this.color1=function(){return d.color1()},this.color2=function(){return d.color2()},this.drawSeries=function(e,t,n,i){var r=this.getContext(),r=new PaintUtil.Painter(r);this.dataSize()<=0||(i=i<0?this.dataSize()-1:i)<(n=n<0?0:n)||this.drawDots(r,e,t,n,i)},this.drawDots=function(e,t,n,i,r){if(f.isValid()){var a=d.format();a==Enum.Format.Indexed&&(m=d.colorTable(f));for(var s=this.data(),o=i;o<=r;o++){var l,c=s.sample(o),u=t.transform(c.x),h=n.transform(c.y);a==Enum.Format.RGB?(l=d.rgb(f,c.z),e.setPen(new Misc.Pen(Static.RGB2HTML(l),p)),e.setBrush(new Misc.Brush(Static.RGB2HTML(l)))):(c=parseInt(d.colorIndex(f,c.z)),c=m[c],e.setPen(new Misc.Pen(Static.RGB2HTML(c),p)),e.setBrush(new Misc.Brush(Static.RGB2HTML(c)))),e.drawPoint(new Misc.Point(u,h))}m=[]}},this.init()}}define("plotSpectroCurve",["static","colorMap","plotItem","seriesData"],function(){});class LegendData{constructor(){var n={},i=!0;function t(e){return void 0!==n[e]}this.title=function(){return this.value(Static.TitleRole)},this.icon=function(){return this.value(Static.IconRole)},this.mode=function(){return this.hasRole(Static.ModeRole)?this.value(Static.ModeRole):Static.ReadOnly},this.setValue=function(e,t){n[e]=t,i=!1},this.isValid=function(){return!i},this.hasRole=t,this.value=function(e){return t(e)?n[e]:null},this.toString=function(){return"[LegendData]"}}}class AbstractLegend{constructor(){Static.makeAbstract(this,AbstractLegend);var n=null,l=!1,i=null,c="",u=0,t=100,h=function(e,t){e.setVisible(!t),n.autoReplot()||n.replot()};"undefined"!=typeof checkChangeFn&&(h=checkChangeFn);var d=[],f=$("<table/>").attr({});this.setLegendDiv=function(e){i||((i=e).append(f),i.css("overflow","auto"))},this.legendDiv=function(){return i},this.setPlot=function(e){n=e,i!==$("#legendDiv")&&e.getLayout().getPlotDiv().append(i)},this.isEmpty=function(){return!(1<=f[0].rows.length)},this.setMaxWidth=function(e){t=e},this.maxWidth=function(){return t},this.legendDivWidth=function(){var e=n.legendFont().textSize(c).width+u+8;return e<this.maxWidth()?e:this.maxWidth()},this.addItem=function(e,t){var n,i,r,a,s=e.plot().legendFont(),o=e.legendData()[0];o.isValid()&&(a=o.title(),(n=o.icon())&&n.width()>u&&(u=n.width()),i=$("<tr />"),r=$('<td class="unchecked"></td>'),(o=$("<label />")).css("color",s.fontColor),o.css("font-size",s.th),o.text(" "+a),a=$("<span/>"),n&&n.setParent(a),o.appendTo(a),a.appendTo(r),i.append(r),f.append(i),void 0!==t&&-1<t?(d.splice(t,0,e),Static.setElementIndex(i,t)):d.push(e),r.on("click",e,function(e){l="unchecked"===$(this).attr("class")?($(this).removeClass("unchecked"),$(this).addClass("checked"),!0):($(this).removeClass("checked"),$(this).addClass("unchecked"),!1),h&&h(e.data,l)}),e.title().length>c.length&&(c=e.title()))},this.removeItem=function(e){var t=d.indexOf(e);if(!(t<0))return-1<(e=t)&&d.splice(e,1),f[0].deleteRow(t),parseInt(f.css("height"))<parseInt(i.css("height"))&&i.css("overflow-y","auto"),parseInt(f.css("width"))<parseInt(i.css("width"))&&i.css("overflow-x","auto"),t},this.clearLegend=function(){for(var e=f[0].rows.length,t=0;t<e;++t)f[0].deleteRow(0)},this.rowNumberFromName=function(e){for(var t=f[0].rows,n=0;n<t.length;++n)if(t[n].cells[0].innerText===e)return n;return-1}}toString(){return"[AbstractLegend]"}renderLegend(e,t,n){return!0}updateLegend(e,t){}}class MLegend extends AbstractLegend{constructor(){super(),this.toString=function(){return"[MLegend]"}}}define("legend",["static"],function(){});class Magnifier extends HObject{constructor(e){super(e);for(var t=null,i=!0,r=1.9,n=Static.NoModifier,a=.95,s=Static.RightButton,o=Static.NoModifier,l=.9,c=107,u=Static.Key_Shift,h=109,d=Static.Key_Shift,f=!1,p=!1,m=!1,g=0,v=0,b=[],S=0;S<axisCnt;S++)b[S]=!0;b[1]=!1,b[3]=!1,this.setAxisEnabled=function(e,t){0<=e&&e<axisCnt&&(b[e]=t)},this.isAxisEnabled=function(e){return!(0<=e&&e<axisCnt)||b[e]},void 0!==e&&(e.magnifier=this,t=e,this.setElement(t.getLayout().getCentralDiv())),this.plot=function(){return t},this.setWheelFactor=function(e){r=e},this.wheelFactor=function(){return r},this.setWheelModifiers=function(e){n=e},this.wheelModifiers=function(){return n},this.setMouseFactor=function(e){a=e},this.mouseFactor=function(){return a},this.setMouseButton=function(e,t){s=e,o=t},this.getMouseButton=function(){return{button:s,modifiers:o}},this.setKeyFactor=function(e){l=e},this.keyFactor=function(){return l},this.setZoomInKey=function(e,t){c=e,u=t},this.getZoomInKey=function(){return{key:c,modifiers:u}},this.setZoomOutKey=function(e,t){h=e,d=t},this.getZoomOutKey=function(){return{key:h,modifiers:d}},this.setEnabled=function(e){i=e},this.isEnabled=function(e){return i},this.event=function(e){if(i)switch(e.type){case"mousedown":return null==this.plot()||(e.button!==s||(e.clientX,g=e.clientY,f=!0));case"mouseup":e.button===s&&f&&this.plot()&&(f=!1);break;case"mousemove":if(!f)return;var t=e.clientY-g;0!=t&&(n=a,this.rescale(n=t<0?1/n:n)),e.clientX,g=e.clientY;break;case"keydown":e.keyCode==u&&(p=!0),e.keyCode==d&&(m=!0),e.keyCode==c&&p?this.rescale(l):e.keyCode==h&&m&&this.rescale(1/l);break;case"keyup":e.keyCode==u&&(p=!1),e.keyCode==d&&(m=!1);break;case"mousewheel":var n;0!=r&&(n=Math.pow(r,Math.abs(e.deltaY/15)),0<e.deltaY&&(n=1/n),this.rescale(n))}},this.rescale=function(e){var t=this.plot();if(null!=t&&1!=(e=Math.abs(e))&&0!=e){var n=!1,i=t.autoReplot();t.setAutoReplot(!1),clearTimeout(v),Static.trigger("magnifyingStart");for(var r=0;r<axisCnt;r++){var a,s,o,l,c=this.plot().axisScaleDiv(r);this.isAxisEnabled(r)&&(c=(a=this.plot().axisScaleEngine(r))instanceof LogScaleEngine?(s=(Static.mLog(a.base(),c.lowerBound())+Static.mLog(a.base(),c.upperBound()))/2,o=(Static.mLog(a.base(),c.upperBound())-Static.mLog(a.base(),c.lowerBound()))/2*e,l=Math.pow(a.base(),s-o),Math.pow(a.base(),s+o)):(l=(s=c.lowerBound()+c.range()/2)-(o=c.range()/2*e),s+o),t.setAxisScale(r,l,c),n=!0)}return v=setTimeout(function(){Static.trigger("magnifyingEnd")},100),t.setAutoReplot(i),n&&t.replot(),!1}},this.setEnabled_1(!0),this.toString=function(){return"[Magnifier]"}}}define("magnifier",["static","hObject"],function(){});class PrivateData_2{constructor(){this.zoomRectIndex,this.zoomStack=[],this.maxStackDepth}}class PlotZoomer extends PlotPicker{constructor(e,t,n,i=!0){"number"!=typeof e?super(n=e):super(e,t,n);var a;this.getZoomerData=function(){return a},this.init=function(e){(a=new PrivateData_2).maxStackDepth=-1,this.setTrackerMode(Static.ActiveOnly),this.setRubberBand(Static.RectRubberBand),this.setStateMachine(new PickerDragRectMachine),this.plot().zoomer=this,Static.trigger("zoomerAdded",this),e&&this.plot()&&this.plot().replot(),this.setZoomBase(this.scaleRect())},this.setZoomBase=function(e=!0){var t,n,i,r;"object"==typeof e?(t=e,(r=this.plot())&&(n=this.scaleRect(),i=null,i=t||n,a.zoomStack=[],a.zoomStack.push(i),a.zoomRectIndex=0,t.isEqual(n)||(a.zoomStack.push(n),a.zoomRectIndex++),this.rescale())):null!=(r=this.plot())&&(e&&r.replot(),a.zoomStack=[],a.zoomStack.push(this.scaleRect()),a.zoomRectIndex=0,this.rescale())},this.zoomBase=function(){return a.zoomStack[0]},this.zoomRect=function(){return a.zoomStack[a.zoomRectIndex]},this.setMaxStackDepth=function(e){if(0<=(a.maxStackDepth=e)){e=a.zoomStack.length-1-e;if(0<e){this.zoom(-e);for(var t=a.zoomStack.length-1;t>a.zoomRectIndex;t--)a.zoomStack.pop()}}},this.maxStackDepth=function(){return a.maxStackDepth},this.zoomStack=function(){return a.zoomStack},this.setZoomStack=function(e,t=-1){var n;0!=this.zoomStack.length&&(0<=a.maxStackDepth&&this.zoomStack.length>a.maxStackDepth||((t<0||t>this.zoomStack.length)&&(t=e.length-1),n=this.zoomStack[t]!=this.zoomRect(),a.zoomStack=e,a.zoomRectIndex=t,n&&(this.rescale(),Static.trigger("zoomed",this.zoomRect()))))},this.zoomRectIndex=function(){return a.zoomRectIndex},this.moveBy=function(e,t){var n=a.zoomStack[a.zoomRectIndex];moveTo(new Misc.Point(n.left()+e,n.top()+t))},this.moveTo=function(e){var t=e.x,e=e.y;(t=t<this.zoomBase().left()?this.zoomBase().left():t)>this.zoomBase().right()-this.zoomRect().width()&&(t=this.zoomBase().right()-this.zoomRect().width()),(e=e<this.zoomBase().top()?this.zoomBase().top():e)>this.zoomBase().bottom()-this.zoomRect().height()&&(e=this.zoomBase().bottom()-this.zoomRect().height()),t==this.zoomRect().left()&&e==this.zoomRect().top()||(a.zoomStack[a.zoomRectIndex].moveTo(t,e),this.rescale())},this.zoom=function(e){if("number"==typeof e){var t=e;0==t?a.zoomRectIndex=0:(t=a.zoomRectIndex+t,t=Math.max(0,t),t=Math.min(a.zoomStack.length-1,t),a.zoomRectIndex=t),this.rescale(),Static.trigger("zoomed",this.zoomRect())}else if(!(0<=a.maxStackDepth&&a.zoomRectIndex>=a.maxStackDepth)){e=e.normalized();if(!e.isEqual(a.zoomStack[a.zoomRectIndex])){for(var n=a.zoomStack.length-1;n>a.zoomRectIndex;n--)a.zoomStack.pop();a.zoomStack.push(e),a.zoomRectIndex++,this.rescale(),Static.trigger("zoomed",e)}}},this.rescale=function(){var e,t,n,i,r=this.plot();r&&((i=a.zoomStack[a.zoomRectIndex]).isEqual(this.scaleRect())||(e=r.autoReplot(),r.setAutoReplot(!1),t=i.left(),n=i.right(),r.axisScaleDiv(this.xAxis()).isIncreasing()||(n=t=n),r.setAxisScale(this.xAxis(),t,n),n=i.top(),i=i.bottom(),r.axisScaleDiv(this.yAxis()).isIncreasing()||(i=n=i),r.setAxisScale(this.yAxis(),n,i),r.setAutoReplot(e),r.replot()))},this.minZoomSize=function(){return new Misc.Size(a.zoomStack[0].width()/1e5,a.zoomStack[0].height()/1e5)},this.accept=function(e){if(e.length<2)return!1;var t=new Misc.Rect(e[0],e[e.length-1]);if((t=t.normalized()).width()<2&&t.height()<2)return!1;var n=t.center();return t.setSize(t.size().expandedTo(new Misc.Size(11,11))),t.moveCenter(n),e.resize(2),e[0]=t.topLeft(),e[1]=t.bottomRight(),!0},n&&this.init(i)}widgetKeyPressEvent(e){this.isActive()||(this.keyMatch(Enum.KeyPatternCode.KeyUndo,e)?this.zoom(-1):this.keyMatch(Enum.KeyPatternCode.KeyRedo,e)?this.zoom(1):this.keyMatch(Enum.KeyPatternCode.KeyHome,e)&&this.zoom(0)),super.widgetKeyPressEvent(e)}widgetMouseReleaseEvent(e){this.mouseMatch(Enum.MousePatternCode.MouseSelect2,e)||(this.mouseMatch(Enum.MousePatternCode.MouseSelect3,e)?this.zoom(-1):this.mouseMatch(Enum.MousePatternCode.MouseSelect6,e)?this.zoom(1):super.widgetMouseReleaseEvent(e))}end(e=!0){if(!(e=super.end(e)))return!1;if(!this.plot())return!1;var t=this.selection();if(t.length<2)return!1;e=(e=new Misc.Rect(t[0],t[t.length-1])).normalized(),t=this.invTransform(e).normalized();return this.minZoomSize().isValid()&&(e=t.center(),t.setSize(t.size().expandedTo(this.minZoomSize())),t.moveCenter(e)),this.zoom(t),!0}begin(){var e=this.getZoomerData();if(!(0<=e.maxStackDepth&&e.zoomRectIndex>=e.maxStackDepth)){var t=this.minZoomSize();if(t.isValid()){e=new Misc.Size(.9999*e.zoomStack[e.zoomRectIndex].width(),.9999*e.zoomStack[e.zoomRectIndex].height());if(t.width>=e.width&&t.height>=e.height)return}super.begin()}}setAxis(e,t){e==super.xAxis()&&t==super.yAxis()||(super.setAxis(e,t),void 0!==this.setZoomBase&&this.setZoomBase(this.scaleRect()))}}define("plotzoomer",["plotpicker"],function(){});class MyPlotZoomer extends PlotZoomer{constructor(e){super(e),this.setEnabled(!1),this.setTrackerMode(Static.AlwaysOff),this.setTrackerPen(new Misc.Pen("blue"))}trackerText(e){var t,n=this.plot();e=this.invTransform(e);var i=0,i=!n.axisEnabled(xBottom)&&n.axisEnabled(xTop)?n.axisDecimalPlaces(xTop):n.axisDecimalPlaces(xBottom),r=0,r=!n.axisEnabled(yLeft)&&n.axisEnabled(yRight)?n.axisDecimalPlaces(yRight):n.axisDecimalPlaces(yLeft);switch(this.rubberBand()){case Static.HLineRubberBand:t=Static.adjustForDecimalPlaces(e.y,r).toString();break;case Static.VLineRubberBand:t=Static.adjustForDecimalPlaces(e.x,i).toString();break;default:t=Static.adjustForDecimalPlaces(e.x,i).toString()+", "+Static.adjustForDecimalPlaces(e.y,r).toString()}return t}}define("myZoomer",["plotzoomer"],function(){});class CurveFitter{constructor(){this.fitCurve=function(e){throw'"fitCurve()" not reimplemented in subclass'}}}class SplineCurveFitter extends CurveFitter{constructor(){super();var a=Enum.FitMode.Auto,g=new Spline,v=100;this.setFitMode=function(e){},this.fitMode=function(){},this.setSpline=function(e){(g=e).reset()},this.spline=function(){return g},this.setSplineSize=function(e){v=Math.max(e,10)},this.splineSize=function(){return v},this.fitCurve=function(e){var t=e.length;if(t<=2)return e;if((n=a)==Enum.FitMode.Auto)for(var n=Enum.FitMode.Spline,i=e,r=1;r<t;r++)if(i[r].x<=i[r-1].x){n=Enum.FitMode.ParametricSpline;break}return(n==Enum.FitMode.ParametricSpline?function(e){for(var t=e.length,n=[],i=0;i<v;i++)n.push(new Misc.Point(-1,-1));for(var r=[],a=[],i=0;i<t;i++)r.push(new Misc.Point(-1,-1)),a.push(new Misc.Point(-1,-1));var s=e,o=r,l=a,c=0;for(i=0;i<t;i++){var u,h=s[i].x,d=s[i].y;0<i&&(u=Math.sqrt(Static.sqr(h-o[i-1].y)+Static.sqr(d-l[i-1].y)),c+=Math.max(u,1)),o[i].x=c,o[i].y=h,l[i].x=c,l[i].y=d}if(g.setPoints(r),!g.isValid())return e;var f=r[t-1].x/(v-1);for(i=0;i<v;i++){var p=i*f;n[i].x=g.value(p)}if(g.setPoints(a),!g.isValid())return e;var m=a[t-1].x/(v-1);for(i=0;i<v;i++){p=i*m;n[i].y=g.value(p)}return n}:function(e){if(g.setPoints(e),!g.isValid())return e;for(var t=new Array(v),n=e[0].x,i=(e[e.length-1].x-n)/(v-1),r=0;r<v;r++){var a=n+r*i,s=g.value(a);t[r]=new Misc.Point(a,s)}return g.reset(),t})(e)}}}class WC_PrivateData{constructor(){this.tolerance=1,this.chunkSize=0}}class WC_Line{constructor(e=0,t=0){this.from=e,this.to=t}}class WeedingCurveFitter extends CurveFitter{constructor(e){var S;super();function r(e){var t=S.tolerance*S.tolerance,n=[],i=e,r=e.length,a=[];for(a.resize(r,!1),n.push(new WC_Line(0,r-1));n.length;){for(var s=n.pop(),o=i[s.to].x-i[s.from].x,l=i[s.to].y-i[s.from].y,c=Math.sqrt(o*o+l*l),u=0!=c?o/c:0,h=0!=c?l/c:0,d=0,f=s.from+1,p=s.from+1;p<s.to;p++){var m,g=i[p].x-i[s.from].x,v=i[p].y-i[s.from].y;d<(m=g*u+v*h<0?g*g+v*v:(v=(g=i[p].x-i[s.to].x)*g+(m=i[p].y-i[s.to].y)*m,(m=g*-u+m*-h)<0?v:Math.abs(v-m*m)))&&(d=m,f=p)}d<=t?(a[s.from]=!0,a[s.to]=!0):(n.push(new WC_Line(s.from,f)),n.push(new WC_Line(f,s.to)))}for(var b=[],p=0;p<r;p++)a[p]&&b.push(i[p]);return b}this.setTolerance=function(e){S.tolerance=Math.max(e,0)},this.tolerance=function(){return S.tolerance},this.setChunkSize=function(e){0<e&&(e=Math.max(e,3)),S.chunkSize=e},this.chunkSize=function(){return S.chunkSize},this.fitCurve=function(e){var t=[];if(0==S.chunkSize)t=r(e);else for(var n=0;n<e.length;n+=S.chunkSize)var i=e.mid(n,S.chunkSize),t=t.concat(r(i));return t},S=new WC_PrivateData,this.setTolerance(e)}}function Spline(){var n=null,m=[],g=[],v=[],i=Static.SplineType.Natural;this.setSplineType=function(e){i=e},this.splineType=function(){return i},this.setPoints=function(e){var t=e.length;return t<=2?(this.reset(),!1):(n=e,m.resize(t-1),g.resize(t-1),v.resize(t-1),(e=i==Static.SplineType.Periodic?this.buildPeriodicSpline(e):this.buildNaturalSpline(e))||this.reset(),e)},this.points=function(){return n},this.reset=function(){m.resize(0),g.resize(0),v.resize(0),n.resize(0)},this.isValid=function(){return 0<m.length},this.value=function(e){if(0==m.length)return 0;var t=Static.lookup(e,n),e=e-n[t].x;return((m[t]*e+g[t])*e+v[t])*e+n[t].y},this.coefficientsA=function(){return m},this.coefficientsB=function(){return g},this.coefficientsC=function(){return v},this.buildNaturalSpline=function(e){for(var t=e,n=e.length,i=m,r=g,a=v,s=new Array(n-1),o=0;o<n-1;o++)if(s[o]=t[o+1].x-t[o].x,s[o]<=0)return!1;var l=new Array(n-1),c=(t[1].y-t[0].y)/s[0];for(o=1;o<n-1;o++){r[o]=a[o]=s[o],i[o]=2*(s[o-1]+s[o]);var u=(t[o+1].y-t[o].y)/s[o];l[o]=6*(c-u),c=u}for(o=1;o<n-2;o++)a[o]/=i[o],i[o+1]-=r[o]*a[o];var h=new Array(n);for(h[1]=l[1],o=2;o<n-1;o++)h[o]=l[o]-a[o-1]*h[o-1];for(h[n-2]=-h[n-2]/i[n-2],o=n-3;0<o;o--)h[o]=-(h[o]+r[o]*h[o+1])/i[o];for(o=h[n-1]=h[0]=0;o<n-1;o++)i[o]=(h[o+1]-h[o])/(6*s[o]),r[o]=.5*h[o],a[o]=(t[o+1].y-t[o].y)/s[o]-(h[o+1]+2*h[o])*s[o]/6;return!0},this.buildPeriodicSpline=function(e){for(var t=e,n=e.length,i=m,r=g,a=v,s=new Array(n-1),o=new Array(n-1),l=new Array(n),c=0;c<n-1;c++)if(o[c]=t[c+1].x-t[c].x,o[c]<=0)return!1;var u=n-2,h=o[u],d=(t[0].y-t[u].y)/h;for(c=0;c<=u;c++){r[c]=a[c]=o[c],i[c]=2*(h+o[c]);var f=(t[c+1].y-t[c].y)/o[c];s[c]=6*(d-f),d=f,h=o[c]}i[0]=Math.sqrt(i[0]),a[0]=o[u]/i[0];var p=0;for(c=0;c<u-1;c++)r[c]/=i[c],0<c&&(a[c]=-a[c-1]*r[c-1]/i[c]),i[c+1]=Math.sqrt(i[c+1]-Static.sqr(r[c])),p+=Static.sqr(a[c]);for(r[u-1]=(r[u-1]-a[u-2]*r[u-2])/i[u-1],i[u]=Math.sqrt(i[u]-Static.sqr(r[u-1])-p),l[0]=s[0]/i[0],p=0,c=1;c<u;c++)l[c]=(s[c]-r[c-1]*l[c-1])/i[c],p+=a[c-1]*l[c-1];for(l[u]=(s[u]-r[u-1]*l[u-1]-p)/i[u],l[u]=-l[u]/i[u],l[u-1]=-(l[u-1]+r[u-1]*l[u])/i[u-1],c=u-2;0<=c;c--)l[c]=-(l[c]+r[c]*l[c+1]+a[c]*l[u])/i[c];for(l[n-1]=l[0],c=0;c<n-1;c++)i[c]=(l[c+1]-l[c])/(6*o[c]),r[c]=.5*l[c],a[c]=(t[c+1].y-t[c].y)/o[c]-(l[c+1]+2*l[c])*o[c]/6;return!0}}define("curveFitter",["static"],function(){}),Static.SplineType={},Static.SplineType.Natural=0,Static.SplineType.Periodic=1,Static.lookup=function(e,t){var n=t.length;if(e<=t[0].x)r=0;else if(e>=t[n-2].x)r=n-2;else for(var i,r=0,a=n-2;1<a-r;)t[i=r+(a-r>>1)].x>e?a=i:r=i;return r},define("spline",["static"],function(){});class Panner extends HObject{constructor(n){super();var d=this,f=null,i=Static.LeftButton,r=Static.NoModifier,a=(Static.Key_Escape,Static.NoModifier,0),s=0,o=!1,l=!1,t="",c="",u=!1,h=Vertical|Horizontal,p=0,m=0;void 0!==n&&(n.panner=this,f=n),this.plot=function(){return f},this.setMouseButton=function(e,t=Static.NoModifier){i=e,r=t},this.getMouseButton=function(){return{button:i,modifiers:r}},this.setOrientation=function(e){h=e},this.rescaleAndRedraw=function(e,t){for(var n=d.plot().plotItemStore(),i=0;i<n.length;++i){var r=n[i].getCanvas();r.css("left",0),r.css("top",0)}var a=!1,s=f.autoReplot();f.setAutoReplot(!1);for(var o=0;o<axisCnt;o++){var l,c=d.plot().canvasMap(o),u=c.transform(d.plot().axisScaleDiv(o).lowerBound()),h=c.transform(d.plot().axisScaleDiv(o).upperBound()),h=o==xBottom||o==xTop?(l=c.invTransform(u-e),c.invTransform(h-e)):(l=c.invTransform(u-t),c.invTransform(h-t));this.setAxisScale(o,l,h),a=!0}f.setAutoReplot(s),a&&f.replot()},this.showCursor=function(e){e!=u&&null!=this.plot()&&""!=t&&((u=e)?(this.plot().isCursorSet()&&(c=this.plot().cursor()),this.plot().setCursor(t)):""!==c?(this.plot().setCursor(c),c=""):this.plot().unsetCursor())},this.setCursor=function(e){t=e},this.cursor=function(){return""!=t?t:null!=this.plot()?this.plot().cursor():""},this.plot()&&this.setEnabled_1(!0),this.setEnabled=function(e){var t;o!=e&&(o=e,(t=n.getCentralWidget())&&(e?t.installEventFilter(this):t.removeEventFilter(this)))},this.isEnabled=function(e){return o},this.widgetMousePressEvent=function(e){var t=Static.isMobile();return(t||e.button==i&&Utility.modifiers(e)===r)&&(l=(s=t?(a=e.originalEvent.touches[0].clientX,e.originalEvent.touches[0].clientY):(a=e.clientX,e.clientY),!0),this.showCursor(!0)),!0},this.widgetMouseUpEvent=function(e){l&&(l=!1,d.showCursor(!1),0==p&&0==m||(d.rescaleAndRedraw(p,m),m=p=0))},this.widgetMouseMoveEvent=function(e){var t;l&&(m=Static.isMobile()?(t=e.originalEvent.changedTouches[0],p=parseInt(t.clientX)-a,parseInt(t.clientY)-s):(p=e.clientX-a,e.clientY-s),h==Vertical&&(p=0),h==Horizontal&&(m=0),function(){for(var e=d.plot().plotItemStore(),t=0;t<e.length;++t){var n=e[t].getCanvas();n.css("left",p),n.css("top",m)}}())},Static.trigger("pannerAdded",this),this.setEnabled(!0)}setAxisScale(e,t,n){this.plot().setAxisScale(e,t,n)}eventFilter(e,t){if(this.isEnabled())switch(t.type){case"mousedown":case"touchstart":this.widgetMousePressEvent(t);break;case"mousemove":case"touchmove":this.widgetMouseMoveEvent(t);break;case"mouseleave":this.widgetMouseUpEvent(t);break;case"mouseup":case"touchend":this.widgetMouseUpEvent(t)}}}Panner.prototype.toString=function(){return"[Panner]"},define("panner",["static","hObject"],function(){});class PlotShapeItem extends PlotItem{constructor(){super("Shape");var i=super.boundingRect(),r=new Misc.Pen("black",1,Static.NoPen),a=new Misc.Brush("#006464"),s=new Misc.MPath;this.setItemAttribute(AutoScale,!0),this.setItemAttribute(Legend,!1),this.setZ(8),this.rtti=Static.Rtti_PlotShape,this.getBoundingRect=function(){return i},this.setRect=function(e){var t=new Misc.MPath;t.addRect(e),this.setShape(t)},this.setPolygon=function(e){var t=new Misc.MPath;t.addPolygon(e),this.setShape(t)},this.setShape=function(e){i=(s=e).isEmpty()?PlotItem.prototype.boundingRect.call(this):s.boundingRect()},this.setBrush=function(e){a=e,this.itemChanged()},this.brush=function(){return a},this.setPen=function(e){r=e,this.itemChanged()},this.pen=function(){return r},this.draw=function(e,t){var n;this.clearCanvas(),s.isEmpty()||r.style==Static.NoPen&&a==Static.NoBrush||(n=this.getCanvasRect(),n=ScaleMap.invTransform_Rect(e,t,n),i.intersects(n)&&(n=this.getContext(),t=ScaleMap.transformPath(e,t,s,!1),(n=new PaintUtil.Painter(n)).setBrush(a),n.setPen(r),n.drawPath(t)))},this.boundingRect=function(){return this.getBoundingRect()},this.toString=function(){return"[PlotShapeItem]"}}}define("plotShapeItem",["static","plotItem"],function(){});class CurveShapeItem extends PlotShapeItem{constructor(i){super();var c=null,e=null,u=void 0,h=void 0,r=!0,a=this;function s(e,t){e&&("v_ruler1"!=e.title()&&"v_ruler2"!=e.title()||("v_ruler1"==e.title()?a.setLowerLimit(t):a.setUpperLimit(t)))}this.setEnabled=function(e){(r=e)&&c&&c.isVisible()?(this.setVisible(!0),this.refresh()):this.setVisible(!1)},this.enabled=function(e){return r},this.setCurve=function(e){e&&c==e||(c=e,this.setLimits(),r&&c&&c.isVisible()&&(this.setVisible(!0),this.refresh()))},this.curve=function(){return c},this.refresh=function(){e=this.isVisible()&&c?function(){var t=null,e=[];if("[SyntheticPointData]"==c.data().toString()){var n=c.functionData.size();let e=[];for(var i=0;i<n-1;++i)e.push(c.functionData.sample(i));t=e}else t=c.data().samples();if(t&&!(t.length<2)){if(u<t[0].x||h>t[t.length-1].x||h<=u)return null;null==u&&(u=t[0].x),null==h&&(h=t[t.length-1].x);for(var r,a,s=-1,o=-1,e=[],i=1;i<t.length;i++)t[i].x>u&&-1==s&&e.push(t[s=i-1]),t[i-1].x<h&&(o=i,-1!=s&&e.push(t[o]));var l=c.plot().axisScaleEngine(c.xAxis()).toString();return"[LinearScaleEngine]"==l?(r=t[s].interpolatedPoint(t[s+1],u),a=t[o-1].interpolatedPoint(t[o],h)):"[LogScaleEngine]"==l&&(r=t[s].logInterpolatedPoint(t[s+1],u),a=t[o-1].logInterpolatedPoint(t[o],h)),e.length&&e[0].x!==r.x&&e.splice(0,1,r),e.length&&e[e.length-1].x!==a.x&&(e.pop(),e.push(a)),e.splice(0,0,new Misc.Point(e[0].x,Number.MIN_VALUE)),e.push(new Misc.Point(e[e.length-1].x,Number.MIN_VALUE)),e}}():null,this.setPolygon(e),c&&e&&(a.setAxes(c.xAxis(),c.yAxis()),c.plot().autoRefresh())},this.setLimits=function(e,t){u=e,h=t,this.refresh()},this.setLowerLimit=function(e){u=e,this.refresh()},this.setUpperLimit=function(e){h=e,this.refresh()},Static.bind("visibilityChange",function(e,t,n){t.rtti==Static.Rtti_PlotCurve&&(c&&t==c&&r&&n?a.setVisible(!0):(a.plot().curveShapeEnabledByPlotSettings()&&a.setEnabled(a.plot().tbar.isDropdownItemChecked("Watch",6)),t==c&&(a.setVisible(!1),a.setLimits()))),Static.trigger("curveAdjusted")}),Static.bind("axisChanged",function(e,t,n){n.rtti==Static.Rtti_PlotCurve&&c&&n===c&&a.setLimits()});var o=Number.MAX_VALUE,l=Number.MAX_VALUE;Static.bind("positionChanging",function(e,t,n){var i,r;l===t&&o===n||(r=(i=t.plot()).autoReplot(),i.setAutoReplot(!1),s(t,n),l=t,o=n,i.setAutoReplot(r),i.autoRefresh())}),Static.bind("positionChanged",function(e,t,n){var i,r;t&&(l===t&&o===n||(r=(i=t.plot()).autoReplot(),i.setAutoReplot(!1),s(t,n),l=t,o=n,i.setAutoReplot(r),i.autoRefresh()))}),Static.bind("currentCurveChanged",function(e,t){t&&a.setCurve(t)}),Static.bind("curveShapeColorChanged",function(e,t){var n=a.brush();n.color=t,a.setBrush(n);n=a.pen();n.color=t,a.setPen(n)}),Static.bind("watchEnabled",function(e,t,n){i.settings()&&i.settings().shadeWatchArea&&"Area below curve"==t.name()&&a.setEnabled(n)}),Static.bind("shadeWatchArea",function(e,t){i.setCurveShapeEnabledByPlotSettings(t),!t&&i.watchAreaBelowCurve.isEnable()||!t&&!i.watchAreaBelowCurve.isEnable()?a.setEnabled(!1):t&&i.watchAreaBelowCurve.isEnable()&&a.setEnabled(!0)}),Static.bind("itemAttached",function(e,t,n){t.rtti==Static.Rtti_PlotCurve&&(n?a.curve():i.itemList(Static.Rtti_PlotCurve).length&&i.hasVisiblePlotCurve()||a.setCurve(null),Static.trigger("visibilityChange",[t,n]),1==i.itemList(Static.Rtti_PlotCurve).length&&Static.trigger("currentCurveChanged",t))}),Static.bind("curveAdjusted",function(){a.isVisible()&&a.setLimits()}),Static.bind("autoScaleCurveShapeItem",function(e,t){a.setItemAttribute(AutoScale,t)}),this.attach(i),this.setEnabled(!1)}}define("curveShapeItem",["plotShapeItem"],function(){});class Watches{constructor(i){var r=[];function e(e,t,n){i.rv.addToWatchList(e),r.push(t),n&&e.setEnable(!1)}this.watchElements=function(){return r},e(new WatchCurveName,{text:"Curve name",tooltip:"Name of the curve that is the subject of watches.",checkboxState:"checked"}),e(new WatchLeftRulerPosition(i.rv),{text:"Left ruler position",tooltip:"Current position of the left ruler.",checkboxState:"checked"}),e(new WatchRightRulerPosition(i.rv),{text:"Right ruler position",tooltip:"Current position of the right ruler.",checkboxState:"checked"}),e(new WatchBottomRulerPosition(i.rv),{text:"Bottom ruler position",tooltip:"Current position of the bottom ruler."},!0),e(new WatchTopRulerPosition(i.rv),{text:"Top ruler position",tooltip:"Current position of the top ruler."},!0),e(new WatchSlope,{text:"Slope at left ruler",tooltip:"Slope (gradient) in the curve at the point where the left ruler intersects the curve."},!0),i.watchAreaBelowCurve=new WatchAreaBelowCurve,e(i.watchAreaBelowCurve,{text:"Area below curve",tooltip:"Area bounded by the curve, right ruler, x-axis and left ruler."},!0),e(new WatchVolumeOfRevolution,{text:"Volume of revolution(X)",tooltip:"Volume generated by a 360 degrees rotation about the x-axis of the area bounded by the curve, right ruler, x-axis and left ruler."},!0)}}define("watches",["basicWatch"],function(){});class AddRemovePointPicker extends PlotPicker{constructor(i){super(xBottom,yLeft,Static.NoRubberBand,Static.AlwaysOn,i);var r=this,a=null,s=!1;this.setStateMachine(new PickerClickPointMachine);var o=new CurveClosestPoint(i,function(e,t){s&&(e.removePoint(t),Static.trigger("curveAdjusted"))});function l(t){if(s){if(!a){(a=new MyCurve(Utility.generateCurveName(i))).attach(i);var n=Utility.randomColor();a.setPen(new Misc.Pen(n));n=new Symbol(MRect,new Misc.Brush(Static.invert(n)),new Misc.Pen(n),new Misc.Size(8,8));a.setSymbol(n);let e="";Static.showline&&Static.showsymbol?e="lineAndSymbol":Static.showline?e="line":Static.showsymbol&&(e="symbol"),Utility.setLegendAttribute(a,e,a.getLegendIconSize())}let e=a.data().samples();e.containsPoint(t)||e.push(t),e.sort(function(e,t){return e.x-t.x}),a.setSamples(e),i.autoRefresh(),Static.trigger("pointAdded",a),Static.trigger("curveAdjusted")}}this.setEnabled(!1),this.activate=function(e){s=e,this.setEnabled(e),o.setEnabled(e)},this.setAddRemoveMousePattern=function(e,t,n=Static.NoModifier){this.setMousePattern(e,t,n),o.setMousePattern(t,n)},Static.bind("currentCurveChanged",function(e,t){a!==t&&(a=t||null)&&r.setAxis(a.xAxis(),a.yAxis())}),Static.bind("pointSelected",function(){s&&r.setEnabled(!1)}),Static.bind("pointNotSelected",function(){s&&r.setEnabled(!0)});var c=new Misc.Point(Number.MAX_VALUE,Number.MAX_VALUE);Static.bind("selected",function(e,t){var n=r.selection()[0];n&&(c.isEqual(n)||(c=n,l(a?ScaleMap.invTransform(i.axisScaleDraw(a.xAxis()).scaleMap(),i.axisScaleDraw(a.yAxis()).scaleMap(),n):ScaleMap.invTransform(i.axisScaleDraw(xBottom).scaleMap(),i.axisScaleDraw(yLeft).scaleMap(),n))))});var e=this.trackerFont();e.fontColor="blue",this.setTrackerFont(e)}trackerText(e){var t,n=this.plot();e=this.invTransform(e);var i=1,i=!n.axisEnabled(xBottom)&&n.axisEnabled(xTop)?n.axisPrecision(xTop):n.axisPrecision(xBottom),r=1,r=!n.axisEnabled(yLeft)&&n.axisEnabled(yRight)?n.axisPrecision(yRight):n.axisPrecision(yLeft),a=Static.toPrecision(e.y,r),s=Static.toPrecision(e.x,i);switch(this.rubberBand()){case Static.HLineRubberBand:t=a.toString();break;case Static.VLineRubberBand:t=s.toString();break;default:t=s.toString()+", "+a.toString()}return t}}define("addRemovePointPicker",["plot","curveClosestPoint","plotpicker","plotcurve","symbol"],function(){});class MFontPickerDlg{constructor(){var e=this;e.labelFont=null;var t=_.once(function(){$("body").append($('                        <div class="modal fade" id="fontPickerModal" role="dialog">                        <div class="modal-dialog modal-sm">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal">&times;</button>                        <h4 class="modal-title">Font Picker</h4>                        </div>                        <div class="modal-body">                        <div class="row">                        <div class="col-sm-2">Font:</div>                        <div class="col-sm-7">                        <select id="fontPickerFont">                        <option value="Arial">Arial</option>\t\t\t\t\t\t<option value="Arial Black">Arial Black</option>\t\t\t\t\t\t<option value="Comic Sans MS">Comic Sans MS</option>\t\t\t\t\t\t<option value="Courier New">Courier New</option>\t\t\t\t\t\t<option value="Georgia">Georgia</option>\t\t\t\t\t\t<option value="Impact">Impact</option>\t\t\t\t\t\t<option value="Lucida Console">Lucida Console</option>\t\t\t\t\t\t<option value="Lucida Sans Unicode">Lucida Sans Unicode</option>\t\t\t\t\t\t<option value="PalatinoLinotype">PalatinoLinotype</option>\t\t\t\t\t\t<option value="Tahoma">Tahoma</option>\t\t\t\t\t\t<option value="Times New Roman">Times New Roman</option>\t\t\t\t\t\t<option value="Trebuchet MS">Trebuchet MS</option>\t\t\t\t\t\t<option value="Verdana">Verdana</option>\t\t\t\t\t\t<option value="Gill Sans">Gill Sans</option>                        </select>                        </div>                        </div>                        <br>                        <div class="row">                        <div class="col-sm-2">Point:</div>                        <div class="col-sm-4">                        <input id="fontPickerPoint" type="number" min=6 max=40 value=12>                        </div>\t\t\t\t\t\t<div class="col-sm-2">Bold:</div>                        <div class="col-sm-1">                        <input id="fontPickerBold" type="checkbox" >                        </div>                        </div>\t\t\t\t\t\t<br>                        <div class="row">                        <div class="col-sm-2">Color:</div>                        <div class="col-sm-4">                        <input id="fontPickerColor" type="color" >                        </div>\t\t\t\t\t\t</div>                        <br>                        <div class="modal-footer">                        <button id="axisDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Ok</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#fontPickerFont").change(function(){e.labelFont.name=$(this).val()}),$("#fontPickerColor").change(function(){e.labelFont.fontColor=$(this).val()}),$("#fontPickerPoint").change(function(){e.labelFont.th=$(this).val()}),$("#fontPickerBold").change(function(){e.labelFont.weight=$(this)[0].checked?"bold":"normal"})});this.fontPickerCb=function(){t(),$("#fontPickerColor").val(e.labelFont.fontColor),$("#fontPickerFont").val(e.labelFont.name),$("#fontPickerPoint").val(e.labelFont.th),"bold"==e.labelFont.weight?$("#fontPickerBold")[0].checked=!0:$("#fontPickerBold")[0].checked=!1,$("#fontPickerModal").modal({backdrop:"static"})}}}define("fontPicker",function(){});class MMarkerDlg{constructor(){const i=this;var r=null;let t=_.once(function(){r=new MFontPickerDlg,$("#markerModal").remove(),$("body").append($('                        <div class="modal fade" id="markerModal" role="dialog">                        <div class="modal-dialog modal-md">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class= "close" id="closeMarkerDlg">&times;</button>                        <h4 id="markerTitle" class="modal-title">Marker</h4>                        </div>                        <div class="modal-body">  \x3c!--div class="panel panel-default">    <div class="panel-heading">Panel Heading</div>    <div class="panel-body">    Panel Content    </div>  </div--\x3e  <div class="panel panel-default">    <div class="panel-heading">General</div>    <div class="panel-body">    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">Name</div>    <div class="col-sm-4"><input id="marker_name" type="text"      value="marker_1"></div>    <div class="col-sm-3">Show on legend</div><div class="col-sm-1"><input id="marker_legend" type="checkbox"></div>    </div>\x3c!--row end--\x3e    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">Horizontal axis:</div>    <div class="col-sm-4">       <select id="markerHorizontalAxis">         <option value="markerAxisBottom">Bottom</option>         <option value="markerAxisTop">Top</option>\t </select>    </div>    <div class="col-sm-3">Vertical axis:</div>    <div class="col-sm-2">       <select id="markerVerticalAxis">         <option value="markerAxisLeft">Left</option>         <option value="markerAxisRight">Right</option>       </select>     </div>    </div>\x3c!--row end--\x3e    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">X-value</div>    <div class="col-sm-4"><input id="marker_xValue" type="text"  value=0.0 size="6"></div>    <div class="col-sm-3">Y-value</div><div class="col-sm-2"><input id="marker_yValue" type="text" value=0.0 size="6"></div>    </div>\x3c!--row end--\x3e    </div>  </div><div class="panel panel-default">    <div class="panel-heading">Label</div>    <div class="panel-body">    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">Text</div>    <div class="col-sm-3"><input id="marker_label" type="text"  value="Marker 1" size=12></div>    <div class="col-sm-1">Font</div><div class="col-sm-1"><input id="marker_labelFont" type="button" value="//"></div>    <div class="col-sm-1">Space</div><div class="col-sm-1"><input id="marker_labelSpace" type="number" value=2 min=2 max=40></div>    </div>\x3c!--row end--\x3e    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">Alignment:</div>    <div class="col-sm-3">       <select id="markerLabelAlignment">        <option value="markerAlignmentLeftTop">Left-Top</option>\t\t<option value="markerAlignmentLeftCenter">Left-Center</option>        <option value="markerAlignmentLeftBottom">Left-Bottom </option>        <option value="markerAlignmentRightTop">Right-Top</option>\t\t<option value="markerAlignmentRightCenter">Right-Center</option>        <option value="markerAlignmentRightBottom">Right-Bottom</option>\t    <option value="markerAlignmentCenterTop">Center-Top</option>\t\t<option value="markerAlignmentCenterCenter">Center-Center</option>        <option value="markerAlignmentCenterBottom">Center-Bottom</option>       </select>    </div>    <div class="col-sm-3">Orientation:</div>    <div class="col-sm-3">       <select id="markerLabelOrientation">         <option value="markerLabelHorizontal">Horizontal</option>         <option value="markerLabelVertical">Vertical</option>       </select>    </div>    </div>\x3c!--row end--\x3e    </div>  </div><div class="panel panel-default">    <div class="panel-heading">Line</div>    <div class="panel-body">    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-1">Style:</div>    <div class="col-sm-3">      <select id="markerLineStyle">\t   <option value=NoLine>No line</option>        <option value=VLine>Vertical line</option>        <option value=HLine>Horizontal line</option>\t   <option value=Cross>Cross line</option>      </select>    </div>    <div class="col-sm-2">Pen color</div>    <div class="col-sm-1"><input id="marker_lineColor" type="color"></div>    <div class="col-sm-2">Pen type:</div>    <div class="col-sm-3">      <select id="markerLineType">\t   <option value=solid>solid</option>        <option value=dot>dot</option>        <option value=dash>dash</option>\t   <option value=dashDot>dash-dot</option>\t   <option value=dashDotDot>dash-dot-dot</option>\t </select>    </div>    </div>\x3c!--row end--\x3e    </div>  </div><div class="panel panel-default">    <div class="panel-heading">Symbol</div>    <div class="panel-body">    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-1">Style:</div>                        <div class="col-sm-3">                        <select id="markerSymbol">\t\t\t\t\t\t<option value=none>No symbol</option>                        <option value=arrow>Arrow</option>                        <option value=dotOnLine>Dot-on-line</option>\t\t\t\t\t\t</select>                        </div>\t\t\t\t\t\t<div class="col-sm-1">Angle:</div>                        <div class="col-sm-2"><input id="marker_symbolAngle" type="number" style="width:100%" value=0.0></div><div class="col-sm-3">Size(widthXheight)</div>                        <div class="col-sm-1" title="width x height">                        <select id="markerSymbolSize">\t\t\t\t\t<option value="6x6">6x6</option>                        \t<option value="6x8">6x8</option>                        \t<option value="6x10">6x10</option>\t\t\t\t\t<option value="6x12">6x12</option>                        \t<option value="6x14">6x14</option>\t\t\t\t\t<option value="8x6">8x6</option>                        \t<option value="8x8">8x8</option>                        \t<option value="8x10">8x10</option>\t\t\t\t\t<option value="8x12">8x12</option>                        \t<option value="8x14">8x14</option>\t\t\t\t\t<option value="10x6">10x6</option>                        \t<option value="10x8">10x8</option>                        \t<option value="10x10">10x10</option>\t\t\t\t\t<option value="10x12">10x12</option>                        \t<option value="10x14">10x14</option>\t\t\t\t\t<option value="12x6">12x6</option>                        \t<option value="12x8">12x8</option>                        \t<option value="12x10">12x10</option>\t\t\t\t\t<option value="12x12">12x12</option>                        \t<option value="12x14">12x14</option>\t\t\t\t\t<option value="14x6">14x6</option>                        \t<option value="14x8">14x8</option>                        \t<option value="14x10">14x10</option>\t\t\t\t\t<option value="14x12">14x12</option>                        \t<option value="14x14">14x14</option>\t\t\t\t  </select>                        </div>    </div>\x3c!--row end--\x3e    </div>  </div><div class="modal-footer">                        <button id="markerDlg_cancel" type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>\t\t\t\t\t\t<button id="markerDlg_remove" type="button" class="btn btn-default">Remove</button>                        <button id="markerDlg_ok" type="button" class="btn btn-default">Ok</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#markerSymbolSize").val("14x14"),$("#markerDlg_ok").click(l),$("#markerDlg_remove").click(e),$("#closeMarkerDlg").click(o),$("#marker_name").keyup(a),$("#marker_labelFont").click(s),$("#markerLineStyle").click(function(){"NoLine"==$(this).val()?($("#marker_lineColor").attr("disabled",!0),$("#markerLineType").attr("disabled",!0)):($("#marker_lineColor").attr("disabled",!1),$("#markerLineType").attr("disabled",!1))}),$("#markerModal").on("shown.bs.modal",function(){$("#markerDlg_ok").trigger("focus")})});function e(){var e=i.plot.findPlotMarker($("#marker_name").val());e&&(e.detach(),o())}function n(){var e,t,n=i.plot.findPlotMarker($("#marker_name").val());n?(r.labelFont=n.labelFont(),$("#markerDlg_remove").attr("disabled",!1),$("#marker_label").val(n.label()),$("#marker_xValue").val(n.xValue()),$("#marker_yValue").val(n.yValue()),$("#marker_labelSpace").val(n.spacing()),n.labelAlignment()&Static.AlignLeft&&n.labelAlignment()&Static.AlignTop?$("#markerLabelAlignment").val("markerAlignmentLeftTop"):n.labelAlignment()&Static.AlignLeft&&n.labelAlignment()&Static.AlignCenter?$("#markerLabelAlignment").val("markerAlignmentLeftCenter"):n.labelAlignment()&Static.AlignLeft&&n.labelAlignment()&Static.AlignBottom?$("#markerLabelAlignment").val("markerAlignmentLeftBottom"):n.labelAlignment()&Static.AlignRight&&n.labelAlignment()&Static.AlignTop?$("#markerLabelAlignment").val("markerAlignmentRightTop"):n.labelAlignment()&Static.AlignRight&&n.labelAlignment()&Static.AlignCenter?$("#markerLabelAlignment").val("markerAlignmentRightCenter"):n.labelAlignment()&Static.AlignRight&&n.labelAlignment()&Static.AlignBottom?$("#markerLabelAlignment").val("markerAlignmentRightBottom"):n.labelAlignment()&Static.AlignCenter&&n.labelAlignment()&Static.AlignTop?$("#markerLabelAlignment").val("markerAlignmentCenterTop"):n.labelAlignment()&Static.AlignCenter&&n.labelAlignment()&Static.AlignBottom?$("#markerLabelAlignment").val("markerAlignmentCenterBottom"):n.labelAlignment()&Static.AlignCenter&&$("#markerLabelAlignment").val("markerAlignmentCenterCenter"),n.labelOrientation()==Horizontal?$("#markerLabelOrientation").val("markerLabelHorizontal"):$("#markerLabelOrientation").val("markerLabelVertical"),n.testItemAttribute(Legend)?$("#marker_legend")[0].checked=!0:$("#marker_legend")[0].checked=!1,n.xAxis()===xBottom?$("#markerHorizontalAxis").val("markerAxisBottom"):$("#markerHorizontalAxis").val("markerAxisTop"),n.yAxis()===yLeft?$("#markerVerticalAxis").val("markerAxisLeft"):$("#markerVerticalAxis").val("markerAxisRight"),t="NoLine",(e=n.lineStyle())==VLine?t="VLine":e==HLine?t="HLine":e==Cross&&(t="Cross"),$("#markerLineStyle").val(t),$("#marker_lineColor").val(n.linePen().color),$("#markerLineType").val(n.linePen().style),(t=n.symbol())&&("arrow"===t.type?$("#markerSymbol").val("arrow"):"dotOnLine"===t.type&&$("#markerSymbol").val("dotOnLine"),(n=t.path())&&$("#marker_symbolAngle").val(parseFloat(n.data.rotation)))):$("#markerDlg_remove").attr("disabled",!0),"NoLine"==$("#markerLineStyle").val()?($("#marker_lineColor").attr("disabled",!0),$("#markerLineType").attr("disabled",!0)):($("#marker_lineColor").attr("disabled",!1),$("#markerLineType").attr("disabled",!1)),t&&(6==t.size().width&&6==t.size().height?$("#markerSymbolSize").val("6x6"):6==t.size().width&&8==t.size().height?$("#markerSymbolSize").val("6x8"):6==t.size().width&&10==t.size().height?$("#markerSymbolSize").val("6x10"):6==t.size().width&&12==t.size().height?$("#markerSymbolSize").val("6x12"):6==t.size().width&&14==t.size().height?$("#markerSymbolSize").val("6x14"):8==t.size().width&&6==t.size().height?$("#markerSymbolSize").val("8x6"):8==t.size().width&&8==t.size().height?$("#markerSymbolSize").val("8x8"):8==t.size().width&&10==t.size().height?$("#markerSymbolSize").val("8x10"):8==t.size().width&&12==t.size().height?$("#markerSymbolSize").val("8x12"):8==t.size().width&&14==t.size().height?$("#markerSymbolSize").val("8x14"):10==t.size().width&&6==t.size().height?$("#markerSymbolSize").val("10x6"):10==t.size().width&&8==t.size().height?$("#markerSymbolSize").val("10x8"):10==t.size().width&&10==t.size().height?$("#markerSymbolSize").val("10x10"):10==t.size().width&&12==t.size().height?$("#markerSymbolSize").val("10x12"):10==t.size().width&&14==t.size().height?$("#markerSymbolSize").val("10x14"):12==t.size().width&&6==t.size().height?$("#markerSymbolSize").val("12x6"):12==t.size().width&&8==t.size().height?$("#markerSymbolSize").val("12x8"):12==t.size().width&&10==t.size().height?$("#markerSymbolSize").val("12x10"):12==t.size().width&&12==t.size().height?$("#markerSymbolSize").val("12x12"):12==t.size().width&&14==t.size().height?$("#markerSymbolSize").val("12x14"):14==t.size().width&&6==t.size().height?$("#markerSymbolSize").val("14x6"):14==t.size().width&&8==t.size().height?$("#markerSymbolSize").val("14x8"):14==t.size().width&&10==t.size().height?$("#markerSymbolSize").val("14x10"):14==t.size().width&&12==t.size().height?$("#markerSymbolSize").val("14x12"):14==t.size().width&&14==t.size().height&&$("#markerSymbolSize").val("14x14"))}function a(){n()}function s(){var e=i.plot.findPlotMarker($("#marker_name").val());r.labelFont=e?e.labelFont():new Misc.Font,r.fontPickerCb()}function o(){$("#markerDlg_cancel").click()}function l(){var e=i.plot.findPlotMarker($("#marker_name").val());e&&e.detach(),(e=new PlotMarker($("#marker_name").val())).setSpacing(parseInt($("#marker_labelSpace").val())),r.labelFont||(r.labelFont=new Misc.Font),e.setLabelFont(r.labelFont),"markerAxisBottom"===$("#markerHorizontalAxis").val()?e.setXAxis(xBottom):e.setXAxis(xTop),"markerAxisLeft"===$("#markerVerticalAxis").val()?e.setYAxis(yLeft):e.setYAxis(yRight),"arrow"===$("#markerSymbol").val()?e.setSymbol(new ArrowSymbol(parseFloat($("#marker_symbolAngle").val()))):"dotOnLine"===$("#markerSymbol").val()&&e.setSymbol(new DotOnLineSymbol(parseFloat($("#marker_symbolAngle").val()))),e.setLinePen(new Misc.Pen($("#marker_lineColor").val(),1,$("#markerLineType").val())),"HLine"===$("#markerLineStyle").val()?e.setLineStyle(HLine):"VLine"===$("#markerLineStyle").val()?e.setLineStyle(VLine):"Cross"===$("#markerLineStyle").val()?e.setLineStyle(Cross):e.setLineStyle(NoLine),$("#marker_legend")[0].checked?e.setItemAttribute(Legend,!0):e.setItemAttribute(Legend,!1),e.setLegendIconSize(new Misc.Size(20,20));var t=math.evaluate(Static.expandDefines($("#marker_xValue").val())),n=math.evaluate(Static.expandDefines($("#marker_yValue").val()));e.setValue(new Misc.Point(t,n)),e.setLabel($("#marker_label").val()),"markerAlignmentLeftTop"==$("#markerLabelAlignment").val()?e.setLabelAlignment(Static.AlignLeft|Static.AlignTop):"markerAlignmentLeftCenter"==$("#markerLabelAlignment").val()?e.setLabelAlignment(Static.AlignLeft|Static.AlignCenter):"markerAlignmentLeftBottom"==$("#markerLabelAlignment").val()?e.setLabelAlignment(Static.AlignLeft|Static.AlignBottom):"markerAlignmentRightTop"==$("#markerLabelAlignment").val()?e.setLabelAlignment(Static.AlignRight|Static.AlignTop):"markerAlignmentRightCenter"==$("#markerLabelAlignment").val()?e.setLabelAlignment(Static.AlignRight|Static.AlignCenter):"markerAlignmentRightBottom"==$("#markerLabelAlignment").val()?e.setLabelAlignment(Static.AlignRight|Static.AlignBottom):"markerAlignmentCenterTop"==$("#markerLabelAlignment").val()?e.setLabelAlignment(Static.AlignCenter|Static.AlignTop):"markerAlignmentCenterCenter"==$("#markerLabelAlignment").val()?e.setLabelAlignment(Static.AlignCenter):"markerAlignmentCenterBottom"==$("#markerLabelAlignment").val()&&e.setLabelAlignment(Static.AlignCenter|Static.AlignBottom),"markerLabelHorizontal"==$("#markerLabelOrientation").val()?e.setLabelOrientation(Horizontal):"markerLabelVertical"==$("#markerLabelOrientation").val()&&e.setLabelOrientation(Vertical);n=e.symbol();n&&("6x6"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(6,6)):"6x10"===$("#markerSymbolSize").val()||"6x12"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(6,12)):"6x14"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(6,14)):"8x6"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(8,6)):"8x8"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(8,8)):"8x10"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(8,10)):"8x12"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(8,12)):"8x14"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(8,14)):"10x6"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(10,6)):"10x8"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(10,8)):"10x10"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(10,10)):"10x12"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(10,12)):"10x14"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(10,14)):"12x6"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(12,6)):"12x8"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(12,8)):"12x10"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(12,10)):"12x12"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(12,12)):"12x14"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(12,14)):"14x6"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(14,6)):"14x8"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(14,8)):"14x10"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(14,10)):"14x12"===$("#markerSymbolSize").val()?n.setSize(new Misc.Size(14,12)):"14x14"===$("#markerSymbolSize").val()&&n.setSize(new Misc.Size(14,14))),e.attach(i.plot),o(),i.plot.autoRefresh()}this.markerCb=function(e){t(),i.plot=e,n(),$("#markerModal").modal({backdrop:"static"})}}}define("markerDlg",["fontPicker"],function(){}),define("app/main",["curveLegendAttributeDlg","functionDlg","curveFitDlg","curveStyleDlg","axisDlg","pointEntryDlg","mtoolBar","file","watch","basicWatch","legendMenu","rulers","infoSidebar","infoPropertiesPane","plotSideBar","curvePropertiesPane","plotPropertiesPane","myPlot","myCurve","plotSpectroCurve","plotRasterItem","plotSpectrogram","rasterFileData","rasterFunctionData","pointData","symbol","legend","magnifier","plotGrid","widgetOverlay","myZoomer","curveFitter","spline","panner","contextMenu","plotMarker","curveClosestPoint","curveShapeItem","underscore","widgetOverlay","functionData","watches","addRemovePointPicker","markerDlg","fontPicker"],function(){Static.alert('This application is design to run in "chrome browser". While it may run in other browsers, some features may not behave as expected.',"small"),new MyPlot($("#plotDiv"),"Plot")}),requirejs.config({baseUrl:"lib",paths:{app:"../app",underscore:"https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min",addRemovePointPicker:"../app/src/addRemovePointPicker",axisDlg:"../app/src/axisDlg",basicWatch:"../app/src/basicWatch",curveClosestPoint:"../app/src/curveClosestPoint",curveFitDlg:"../app/src/curveFitDlg",curveLegendAttributeDlg:"../app/src/curveLegendAttributeDlg",curvePropertiesPane:"../app/src/curvePropertiesPane",curveSettings:"../app/src/curveSettings",curveShapeItem:"../app/src/curveShapeItem",curveStyleDlg:"../app/src/curveStyleDlg",fontPicker:"../app/src/fontPicker",functionData:"../app/src/functionData",functionDlg:"../app/src/functionDlg",infoPropertiesPane:"../app/src/infoPropertiesPane",infoSidebar:"../app/src/infoSidebar",legendMenu:"../app/src/legendMenu",markerDlg:"../app/src/markerDlg",mpicker:"../app/src/mpicker",mtoolBar:"../app/src/mtoolBar",myCurve:"../app/src/myCurve",myPlot:"../app/src/myPlot",myZoomer:"../app/src/myZoomer",pane:"../app/src/pane",plotPropertiesPane:"../app/src/plotPropertiesPane",plotSideBar:"../app/src/plotSideBar",pointEntryDlg:"../app/src/pointEntryDlg",propertiesPane:"../app/src/propertiesPane",rasterFileData:"../app/src/rasterFileData",rasterFunctionData:"../app/src/rasterFunctionData",ruler:"../app/src/ruler",rulers:"../app/src/rulers",settings:"../app/src/settings",sideBar:"../app/src/sideBar",spectrogram:"../app/src/spectrogram",toolBar:"../app/src/toolBar",watch:"../app/src/watch",watches:"../app/src/watches"},shim:{underscore:{exports:"_"},static:{deps:["miscObjects"]},file:{deps:["xlsx","upload"]},plot:{deps:["static","widget","scaleWidget","utility","miscObjects","painter","scaleDiv","interval","scaleMap","scaleWidget","transform","layout","scaleDraw","scaleEngine","pointMapper"]},plotItem:{deps:["static"]},scaleMap:{deps:["static","transform"]},canvas:{deps:["static"]},curveFitter:{deps:["static"]},spline:{deps:["static"]},symbol:{deps:["static","graphic"]},seriesData:{deps:["static","plotItem"]},pointMapper:{deps:["static"]},pointData:{deps:["static","seriesData"]},scaleEngine:{deps:["static"]},scaleDraw:{deps:["static","abstractScaleDraw"]},widget:{deps:["static","hObject"]},widgetOverlay:{deps:["static","widget"]},scaleWidget:{deps:["static","widget"]},picker:{deps:["static","widgetOverlay","pickermachine"]},plotpicker:{deps:["static","picker"]},plotzoomer:{deps:["plotpicker"]},plotGrid:{deps:["static","plotItem"]},plotZoneItem:{deps:["static"]},plotSpectrogram:{deps:["static","conrec","plotRasterItem"]},plotRasterItem:{deps:["static","plotItem"]},plotSpectroCurve:{deps:["static","colorMap","plotItem","seriesData"]},colorMap:{deps:["static"]},plotcurve:{deps:["static","seriesData"]},panner:{deps:["static","hObject"]},magnifier:{deps:["static","hObject"]},plotShapeItem:{deps:["static","plotItem"]},plotMarker:{deps:["static","plotItem"]},legend:{deps:["static"]},pickermachine:{deps:["static","eventpattern"]},addRemovePointPicker:{deps:["plot","curveClosestPoint","plotpicker","plotcurve","symbol"]},axisDlg:{deps:[]},basicWatch:{deps:["static","watch","plotMarker","symbol"]},curveClosestPoint:{deps:["static","widgetOverlay","plotMarker"]},curveFitDlg:{deps:[]},curveLegendAttributeDlg:{deps:[]},curvePropertiesPane:{deps:["propertiesPane"]},curveSettings:{deps:[]},curveShapeItem:{deps:["plotShapeItem"]},curveStyleDlg:{deps:[]},fontPicker:{deps:[]},functionData:{deps:["pointData"]},functionDlg:{deps:[]},infoPropertiesPane:{deps:["pane"]},infoSidebar:{deps:["sideBar"]},legendMenu:{deps:["static","contextMenu"]},markerDlg:{deps:["fontPicker"]},mpicker:{deps:["static","plotpicker"]},mtoolBar:{deps:["toolBar","curveSettings"]},myCurve:{deps:["plotcurve"]},myPlot:{deps:["curveClosestPoint","plot","functionData","plotGrid","spectrogram"]},myZoomer:{deps:["plotzoomer"]},pane:{deps:[]},plotPropertiesPane:{deps:["propertiesPane"]},plotSideBar:{deps:["sideBar"]},pointEntryDlg:{deps:[]},propertiesPane:{deps:["pane"]},rasterFileData:{deps:["rasterData"]},rasterFunctionData:{deps:["rasterData"]},ruler:{deps:["static","plotMarker"]},rulers:{deps:["static","mpicker","ruler"]},settings:{deps:[]},sideBar:{deps:[]},spectrogram:{deps:["static","plotSpectrogram","colorMap","rasterFileData","rasterFunctionData"]},toolBar:{deps:[]},watch:{deps:[]},watches:{deps:["basicWatch"]}}}),requirejs(["app/main"]),define("app",function(){});