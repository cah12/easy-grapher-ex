"include []";class MCurveLegendAttributeDlg{constructor(){var e=this,t=!1;function n(t){"small"==t?e.curve.setLegendIconSize(new Misc.Size(e.defaultIconSize.height-4,e.defaultIconSize.height-4)):"medium"==t?e.curve.setLegendIconSize(new Misc.Size(e.defaultIconSize.height,e.defaultIconSize.height)):e.curve.setLegendIconSize(new Misc.Size(e.defaultIconSize.height+4,e.defaultIconSize.height+4))}this.curveAttributeCb=function(n){t||($("body").append($('                    <div class="modal fade" id="curveLegendAttributeModal" role="dialog">                    <div class="modal-dialog modal-sm">                    <div class="modal-content">                    <div class="modal-header">                    <button type="button" class="close" data-dismiss="modal">&times;</button>                    <h4 class="modal-title">Curve Legend Attribute</h4>                    </div>                    <div class="modal-body">                    <div class="row">                    <div class="col-sm-5">Attribute:</div>                    <div class="col-sm-7">                    <select id="curveAttribute">                    <option value="default">Brush color(Default)</option>                    <option value="line">Line</option>                    <option value="symbol">Symbol</option>                    <option value="lineAndSymbol">Line and Symbol</option>                    </select>                    </div>                    </div>                    <br>                    <div class="row" id="iconSizeRow">                    <div class="col-sm-5">Icon size:</div>                    <div class="col-sm-7">                    <select id="iconSize">                    <option value="small">Small</option>                    <option value="medium">Medium</option>                    <option value="large">Large</option>                    </select>                    </div>                    </div>                    <br>                    <div class="modal-footer">                    <button id="curveAttributeDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Ok</button>                    </div>                    </div>                    </div>                    </div>                    </div>                    ')),e.init(),e.defaultIconSize=new Misc.Size(n.getLegendIconSize()),t=!0),e.curve=n,e.curveAttributeDlg(),"line"==$("#curveAttribute").val()||"symbol"==$("#curveAttribute").val()||"lineAndSymbol"==$("#curveAttribute").val()?$("#iconSizeRow").hide():$("#iconSizeRow").show()},this.init=function(){var e=this;$("#curveAttribute").change(function(){Utility.setLegendAttribute(e.curve,$(this).val(),e.defaultIconSize),"line"==$(this).val()?$("#iconSizeRow").hide():"symbol"==$(this).val()?$("#iconSizeRow").hide():"lineAndSymbol"==$(this).val()?$("#iconSizeRow").hide():(n($("#iconSize").val()),$("#iconSizeRow").show())}),$("#iconSize").change(function(){n($(this).val())})},this.curveAttributeDlg=function(){e.curve&&e.curve.rtti===Static.Rtti_PlotCurve&&(e.curve.testLegendAttribute(Static.LegendShowLine)&&e.curve.testLegendAttribute(Static.LegendShowSymbol)?$("#curveAttribute").val("lineAndSymbol"):e.curve.testLegendAttribute(Static.LegendShowSymbol)?$("#curveAttribute").val("symbol"):e.curve.testLegendAttribute(Static.LegendShowLine)?$("#curveAttribute").val("line"):$("#curveAttribute").val("default"),$("#curveLegendAttributeModal").modal({backdrop:"static"}),e.curve.getLegendIconSize().width==e.defaultIconSize.width-4?$("#iconSize").val("small"):e.curve.getLegendIconSize().width==e.defaultIconSize.width?$("#iconSize").val("medium"):e.curve.getLegendIconSize().width==e.defaultIconSize.width+4&&$("#iconSize").val("large"))}}}define("curveLegendAttributeDlg",function(){});class MFunctionDlg{constructor(){var e=$('                <div class="modal fade" id="functionModal" role="dialog">                <div class="modal-dialog modal-md">                <div class="modal-content">                <div class="modal-header">                \x3c!--button type="button" class="close" data-dismiss="modal">&times;</button--\x3e                <h4 class="modal-title">Curve Function</h4>                </div>                <div class="modal-body">                <div class="row">                <div class="col-sm-2">Three D:</div>                <div class="col-sm-1"><input id="fnDlg_threeD" type="checkbox"/></div>                <div id="threedTypeContainer">                <div class="col-sm-1">Type:</div>                <div class="col-sm-3"><select id="threeDType">                <option value="spectrocurve">Spectrocurve</option>                <option value="spectrogram">Spectrogram</option>                </select>                </div>                <div id="interpolationContainer">                <div class="col-sm-2">Interpolation:</div>                <div class="col-sm-3"><select id="interpolationType">                <option value="biLinear">Bi-linear</option>                <option value="biCubic">Bi-cubic</option>                </select>                </div>                </div>                </div>                </div>                <br>                <div class="row">                <div class="col-sm-2">Curve title:</div>                <div class="col-sm-4"><input id="fnDlg_title" style="width:100%" type="text" value="curve_1"/></div>                <div id="fx" class="col-sm-1">f(x):</div>                <div class="col-sm-5"><input id="fnDlg_function" style="width:100%" type="text" value="x^2"/></div>                </div>                <br>                <div id="limits" class="row">                <div class="col-sm-3">Lower limit(x):</div>                <div class="col-sm-3"><input id="fnDlg_lowerLimit" style="width:100%" type="text" value="-10.0"/></div>                <div class="col-sm-3">Upper limit(x):</div>                <div class="col-sm-3"><input id="fnDlg_upperLimit" style="width:100%" type="text" value="10.0"/></div>                </div>                <br>                <div id="limitsY" class="row">                <div class="col-sm-3">Lower limit(y):</div>                <div class="col-sm-3"><input id="fnDlg_lowerLimitY" style="width:100%" type="text" value="-10.0"/></div>                <div class="col-sm-3">Upper limit(y):</div>                <div class="col-sm-3"><input id="fnDlg_upperLimitY" style="width:100%" type="text" value="10.0"/></div>                </div>                <br>                <div id="colorInterval" class="row">                <div class="col-sm-3">Color1(min):</div>                <div class="col-sm-3"><input id="fnDlg_color1" type="color" value="#ff0000"/></div>                <div class="col-sm-3">Color2(max):</div>                <div class="col-sm-3"><input id="fnDlg_color2" type="color" value="#00ff00"/></div>                </div>                <br>                <div class="row">                <div id="unboundedContainer">                <div class="col-sm-3">Unbounded range:</div>                <div class="col-sm-3"><input id="fnDlg_unboundedRange" type="checkbox"/></div>                </div>                <div class="col-sm-3">Number of points:</div>                <div class="col-sm-3"><input id="fnDlg_numberOfPoints" style="width:100%" type="number" min="2" max="200" value="100"/></div>                </div>                <br>                <div id="cont_variable" class="row">                <div class="col-sm-3">Enter variable(x):</div>                <div class="col-sm-1"><input id="fnDlg_variable" style="width:100%" type="text" value="x" /></div>                </div>                <div id="cont_variableY" class="row">                <div class="col-sm-3">Enter variable(y):</div>                <div class="col-sm-1"><input id="fnDlg_variableY" style="width:100%" type="text" value="y" /></div>                </div>                <br>                <div class="modal-footer">                <button id="fnDlg_ok" type="button" class="btn btn-default" >Ok</button>                <button id="fnDlg_cancel" type="button" class="btn btn-default"  data-dismiss="modal">Cancel</button>                </div>                </div>                </div>                </div>                </div>                ');function t(e){var t=[];e=purgeKewords(e);for(var n=0;n<e.length;++n)Static.isAlpha(e[n])&&-1==t.indexOf(e[n])&&t.push(e[n]);return t}function n(e){if(function(e){for(var t=0;t<keywords.length;++t)for(;-1!=e.indexOf(keywords[t]);)return!0;return!1}(e))return e;var t="";t+=e[0];for(var n=1;n<e.length;++n)Static.isAlpha(e[n-1])&&Static.isAlpha(e[n])&&(t+="*"),_.isFinite(e[n-1])&&Static.isAlpha(e[n])&&(t+="*"),t+=e[n];return t}this.init=function(r){var i=this;$("body").append(e),$("#cont_variable").hide(),$("#cont_variableY").hide(),$("#threedTypeContainer").hide(),$("#colorInterval").hide(),$("#limitsY").hide(),$("#interpolationContainer").hide(),i.threeD=!1,$("#fnDlg_unboundedRange").change(function(){$(this)[0].checked?$("#limits").hide():$("#limits").show()}),$("#fnDlg_threeD").change(function(){i.threeD=$(this)[0].checked,i.threeD?($("#threedTypeContainer").show(),$("#limitsY").show(),$("#unboundedContainer").hide(),$("#fx").html("f(x,y):"),$("#fnDlg_function").val("x^2 + y^2"),$("#colorInterval").show()):($("#threedTypeContainer").hide(),$("#limitsY").hide(),$("#unboundedContainer").show(),$("#fx").html("f(x):"),$("#fnDlg_function").val("x^2"),$("#colorInterval").hide()),$("#cont_variable").hide(),$("#cont_variableY").hide(),$("#fnDlg_variable").val("x"),$("#fnDlg_variableY").val("y")}),$("#threeDType").change(function(){"spectrogram"==$(this).val()?$("#interpolationContainer").show():$("#interpolationContainer").hide()}),$("#fnDlg_ok").click(function(){if($("#fnDlg_numberOfPoints").val()>200||$("#fnDlg_numberOfPoints").val()<2)$("#fnDlg_numberOfPoints").val(60),Static.alert('"Number of points" cannot be \nless than 2 or greater than 200');else{var e=Static.expandDefines($("#fnDlg_function").val());try{i.lowerLimit=math.eval(Static.expandDefines($("#fnDlg_lowerLimit").val()))}catch(e){return void Static.alert("Please enter a valid lower(x) limit.")}try{i.upperLimit=math.eval(Static.expandDefines($("#fnDlg_upperLimit").val()))}catch(e){return void Static.alert("Please enter a valid upper(x) limit.")}if(i.title=$("#fnDlg_title").val(),i.variable=$("#fnDlg_variable").val(),i.fn=$("#fnDlg_function").val(),i.expandedFn=n(e),i.numOfPoints=parseInt($("#fnDlg_numberOfPoints").val()),i.threeD){i.threeDType=$("#threeDType").val(),"spectrogram"===i.threeDType&&(i.threeDInterpolationType=$("#interpolationType").val());try{i.lowerLimitY=math.eval($("#fnDlg_lowerLimitY").val())}catch(e){return void Static.alert("Please enter a valid lower(y) limit.")}try{i.upperLimitY=math.eval($("#fnDlg_upperLimitY").val())}catch(e){return void Static.alert("Please enter a valid upper(y) limit.")}i.variableY=$("#fnDlg_variableY").val(),i.color1=$("#fnDlg_color1").val(),i.color2=$("#fnDlg_color2").val()}else{var a=t(i.expandedFn);if(a.length>0&&-1==a.indexOf($("#fnDlg_variable").val()))return Static.alert("Please enter a valid variable."),void $("#cont_variable").show();if(l=parseFloat(i.lowerLimit),c=parseFloat(i.upperLimit),l>=c&&Static.alert("Upper limit is less than Lower limit. Scale will be inverted."),i.unboundedRange=$("#fnDlg_unboundedRange")[0].checked,i.coeffs=function(e){var t=[],n=e||$("#fnDlg_function").val();n=purgeKewords(n);for(var r=$("#fnDlg_variable").val();-1!=n.indexOf(r);)n=n.replace(r,"");for(var i=0;i<n.length;++i)Static.isAlpha(n[i])&&-1==t.indexOf(n[i])&&t.push(n[i]);return t}(i.expandedFn),i.expandedFn=(s=i.expandedFn,(o=s).includes("ln")&&(o=o.replace("ln","log")),o),i.coeffs.length>5)return Static.alert("Number of unknown coefficient cannot be greater than 5."),void $("#cont_variable").show()}r()}var s,o,l,c}),$("#fnDlg_function").on("input",function(){var e=$(this).val();i.threeD?t(e).length>2||-1==e.indexOf("x")||-1==e.indexOf("y")?($("#cont_variable").show(),$("#cont_variableY").show()):($("#cont_variable").hide(),$("#cont_variableY").hide()):t(e).length>1||-1==e.indexOf("x")?$("#cont_variable").show():$("#cont_variable").hide()})},this.functionDlg=function(e){$("#functionModal").modal({backdrop:"static"}),$("#fnDlg_title").val(e)},this.close=function(){$("#fnDlg_cancel").click()}}}define("functionDlg",function(){});class MCurveFitDlg{constructor(){var e=this,t="",n=!1,r=!1,i="",a="",s=-1,o=!1,l=-1,c=-1,u=null,h=null,d={precision:2},f=$('                <div class="modal fade" id="curveFitModal" role="dialog">                <div class="modal-dialog modal-sm">                <div class="modal-content">                <div class="modal-header">                <button type="button" class="close" data-dismiss="modal">&times;</button>                <h4 class="modal-title">Curve Fitter</h4>                </div>                <div class="modal-body">                <div class="row">                <div class="col-sm-5">Fitter type:</div>                <div class="col-sm-7">                <select id="curveFitDlg_type">                <option value="natural">Natural spline</option>                <option value="periodic">Periodic spline</option>                <option value="weeding">Weeding</option>                <option value="linear">Linear</option>                <option value="polynomial">Polynomial</option>                <option value="noFitting">No fitting</option>                </select>                </div>                </div>                <br>                                                <div id="cont_origin">                <div class="row">                <div class="col-sm-7">Through origin:</div>                <div class="col-sm-2"><input id="origin" type="checkbox"/></div>                </div>                <br>                </div>                                <div id="cont_order">                <div class="row">                <div class="col-sm-2">Order:</div>                <div class="col-sm-3"><input id="order" type="number" style="width:100%" value="2" min="1" max="20"/></div><div>Precision: <input id="curveFitDlg_precision" type="number" min="1" max="10" value="2" /></div>                <br>                                               </div>                <br>                </div>                                <div id="cont_tolerance">                <div class="row">                <div class="col-sm-5">Tolerance:</div>                <div class="col-sm-4"><input id="tolerance" type="number" style="width:100%" value="10.0" min="0.0" max="200.0"/></div>                </div>                <br>                </div>                                <div id="cont_chunksize">                <div class="row">                <div class="col-sm-5">Chunk size:</div>                <div class="col-sm-4"><input id="chunksize" type="number" style="width:100%" value="0" min="0" /></div>                </div>                <br>                </div>                \t\t\t\t<div id="cont_retain">                <div class="row">                <div class="col-sm-7">Retain original curve:</div>                <div class="col-sm-2"><input id="curveFitDlg_retain" type="checkbox"/></div>                </div>                <br>\t\t\t\t</div>                                <div id="cont_generate">\t\t\t\t<div class="row">                <div class="col-sm-7">Generate points:</div>                <div class="col-sm-2"><input id="curveFitDlg_generate" type="checkbox" checked/></div>                </div>                <br>\t\t\t\t</div>                                                <div id="attributes">                <div class="row">                <div class="col-sm-6">Fitted curve name:</div>                <div class="col-sm-6"><input id="curveFitDlg_name" type="text" style="width:100%"/></div>                </div>                <br>                <div class="row">                <div class="col-sm-6">Fitted curve color:</div>                <div class="col-sm-2"><input id="curveFitDlg_color" type="color"/></div>                </div>                <br>                </div>                </div>                <div class="modal-footer">                <button id="curveFitDlg_ok" type="button" class="btn btn-default" >Ok</button>                </div>                </div>                </div>                </div>                </div>                ');$("body").append(f),$("#cont_origin").hide(),$("#cont_order").hide(),$("#cont_tolerance").hide(),$("#cont_chunksize").hide(),$("#curveFitDlg_type").change(function(){"linear"==$(this).val()?$("#cont_origin").show():$("#cont_origin").hide(),"polynomial"==$(this).val()?($("#order").val(h.dataSize()-1),$("#cont_order").show()):$("#cont_order").hide(),"natural"==$(this).val()||"periodic"==$(this).val()||"weeding"==$(this).val()?$("#cont_generate").show():$("#cont_generate").hide(),"weeding"==$(this).val()?($("#cont_tolerance").show(),$("#cont_chunksize").show()):($("#cont_tolerance").hide(),$("#cont_chunksize").hide()),"noFitting"!==$(this).val()?($("#cont_retain").show(),$("#cont_retain").show()):($("#curveFitDlg_retain").prop("checked",!1),$("#cont_retain").hide(),$("#attributes").hide())}),$("#attributes").hide(),$("#curveFitDlg_retain")[0].checked=!1,$("#curveFitDlg_retain").change(function(){$(this)[0].checked?$("#attributes").show():$("#attributes").hide()}),this.curveFitCb=function(t){return $("#curveFitModal").css("zIndex",$("#curveSettingsModal").css("zIndex")+1),e.curveFitDlgInit,void 0==e.curveFitDlgInit&&(e.init(),e.curveFitDlgInit=!0),u=t.plot(),h=t,e.curveFitDlg(),e},this.cb=function(){if(n){var f=i;if(u.findPlotCurve(f))return void Static.alert(f+" already exist")}var p=u.autoReplot();u.setAutoReplot(!1);var m=new MyCurve;if(m.setPen(new Misc.Pen(a)),m.fn=h.fn,m.variable=h.variable,m.setAxes(h.xAxis(),h.yAxis()),m.origin=o,m.setStyle(h.style()),"natural"==t||"periodic"==t){m.setData(h.data());var v=new SplineCurveFitter,g=v.spline();if("periodic"==t?g.setSplineType(Static.SplineType.Periodic):g.setSplineType(Static.SplineType.Natural),m.setCurveFitter(v),r){for(var b=u.axisScaleDraw(h.xAxis()).scaleMap(),S=u.axisScaleDraw(h.yAxis()).scaleMap(),y=h.data().samples(),x=[],w=0;w<y.length;w++)x.push(new Misc.Point(b.transform(y[w].x),S.transform(y[w].y)));x=v.fitCurve(x),m.setCurveFitter(null);var _=[];for(w=0;w<x.length;w++)_.push(new Misc.Point(b.invTransform(x[w].x),S.invTransform(x[w].y)));m.setSamples(_)}else m.setSamples(h.data().samples())}else if("weeding"==t){m.setData(h.data());var C=new WeedingCurveFitter(10);if(C.setChunkSize(parseInt(c)),C.setTolerance(parseInt(l)),m.setCurveFitter(C),r){for(b=u.axisScaleDraw(h.xAxis()).scaleMap(),S=u.axisScaleDraw(h.yAxis()).scaleMap(),y=h.data().samples(),x=[],w=0;w<y.length;w++)x.push(new Misc.Point(b.transform(y[w].x),S.transform(y[w].y)));x=C.fitCurve(x),m.setCurveFitter(null);for(_=[],w=0;w<x.length;w++)_.push(new Misc.Point(b.invTransform(x[w].x),S.invTransform(x[w].y)));m.setSamples(_)}else m.setSamples(h.data().samples())}else if("noFitting"==t)m.setData(h.data()),m.setCurveFitter(null);else{for(var E=regress(h,t,parseInt(s),o,d),k=h.data().boundingRect(),R=E.string;-1!=R.indexOf("+ -");)R=R.replace("+ -","- ");m.equation=R,R=R.replace("y =",""),m.setSamples(Utility.makeSamples({fx:R,lowerX:k.left(),upperX:k.right(),numOfSamples:60}))}n?m.setTitle(f):(m.setTitle(h.title()),h.detach()),m.fitType=t,m.attach(u),u.setAutoReplot(p),u.autoRefresh(),e.close()},this.init=function(){var e=this;$("#curveFitDlg_ok").click(function(){t=$("#curveFitDlg_type").val(),n=$("#curveFitDlg_retain")[0].checked,r=$("#curveFitDlg_generate")[0].checked,i=$("#curveFitDlg_name").val(),a=$("#curveFitDlg_color").val(),s=$("#order").val()||1,d={precision:parseInt($("#curveFitDlg_precision").val())},o=$("#origin")[0].checked,l=$("#tolerance").val(),c=$("#chunksize").val(),e.cb()})},this.curveFitDlg=function(){h&&h.rtti===Static.Rtti_PlotCurve&&($("#curveFitDlg_name").val(Utility.generateCurveName(u,h.title()+"_fit")),$("#curveFitDlg_color").val(Static.colorNameToHex(h.pen().color)),$("#curveFitModal").modal({backdrop:"static"}))},this.curveFitInfoCb=function(e){var t="";return"natural"==e.fitType?t+="Fit type:Natural Spline":"periodic"==e.fitType?t+="Fit type:Periodic Spline":"polynomial"==e.fitType?(t+="Fit type:Polynomial",t+="; Equation:"+e.equation):"weeding"==e.fitType?(t+="Fit type:Weeding",t+="; Tolerance:"+l):"linear"==e.fitType&&(e.origin?t+="Fit type:Linear Through Origin":t+="Fit type:Linear",t+="; Equation:"+e.equation),t},this.close=function(){$(".close").click()}}}define("curveFitDlg",function(){});class MCurveStyleDlg{constructor(){var e=this,t={Lines:Lines,Sticks:Sticks,Steps:Steps,Dots:Dots,NoCurve:NoCurve},n=_.invert(t);this.curveStyleCb=function(t){e.curveStyleDlgInit,void 0==e.curveStyleDlgInit&&($("body").append($('                    <div class="modal fade" id="curveStyleModal" role="dialog">                    <div class="modal-dialog modal-sm">                    <div class="modal-content">                    <div class="modal-header">                    <button type="button" class="close" data-dismiss="modal">&times;</button>                    <h4 class="modal-title">Curve Style</h4>                    </div>                    <div class="modal-body">                    <div class="row">                    <div class="col-sm-5">Curve style:</div>                    <div class="col-sm-7">                    <select id="curveStyleDlgStyle">                    <option value="Lines">Lines (Default)</option>                    <option value="Sticks">Sticks</option>                    <option value="Steps">Steps</option>                    <option value="Dots">Dots</option>                    <option value="NoCurve">NoCurve</option>                    </select>                    </div>                    </div>                    <br>                    <div class="row">                    <div class="col-sm-7">                    </div>                    </div>                    <br>                    <div class="modal-footer">                    <button id="curveStyleDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Ok</button>                    </div>                    </div>                    </div>                    </div>                    </div>                    ')),e.init(),e.curveStyleDlgInit=!0),e.curve=t,e.curveStyleDlg()},this.init=function(){$("#curveStyleDlgStyle").change(function(){var n=t[$(this).val()];e.curve.setStyle(n),Static.trigger("curveStyleChanged",e.curve)})},this.curveStyleDlg=function(){e.curve&&e.curve.rtti===Static.Rtti_PlotCurve&&($("#curveStyleDlgStyle").val(n[e.curve.style()]),$("#curveStyleModal").modal({backdrop:"static"}))}}}define("curveStyleDlg",function(){});class MAxisDlg{constructor(){var e=null,t=_.once(function(){$("body").append($('                        <div class="modal fade" id="axisModal" role="dialog">                        <div class="modal-dialog modal-sm">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal">&times;</button>                        <h4 class="modal-title">Curve Axis</h4>                        </div>                        <div class="modal-body">                        <div class="row">                        <div class="col-sm-5">Horizontal:</div>                        <div class="col-sm-7">                        <select id="axisHorizontal1">                        <option value="bottomAxis">Bottom axis</option>                        <option value="topAxis">Top axis</option>                        </select>                        </div>                        </div>                        <br>                        <div class="row">                        <div class="col-sm-5">Vertical:</div>                        <div class="col-sm-7">                        <select id="axisVertical1">                        <option value="leftAxis">Left axis</option>                        <option value="rightAxis">Right axis</option>                        </select>                        </div>                        </div>                        <br>                        <div class="modal-footer">                        <button id="axisDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Ok</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#axisHorizontal1").change(function(){"bottomAxis"==$(this).val()?(e.setXAxis(xBottom),Static.trigger("axisChanged",[xBottom,e])):(e.setXAxis(xTop),Static.trigger("axisChanged",[xTop,e]))}),$("#axisVertical1").change(function(){"leftAxis"==$(this).val()?(e.setYAxis(yLeft),Static.trigger("axisChanged",[yLeft,e])):(e.setYAxis(yRight),Static.trigger("axisChanged",[yRight,e]))})});this.axisCb=function(n){t(),(e=n).xAxis()==xBottom?$("#axisHorizontal1").val("bottomAxis"):$("#axisHorizontal1").val("topAxis"),e.yAxis()==yLeft?$("#axisVertical1").val("leftAxis"):$("#axisVertical1").val("rightAxis"),$("#axisModal").modal({backdrop:"static"})}}}define("axisDlg",function(){});class MPointEntryDlg{constructor(){const e=this;let t=_.once(function(){$("#pointEntryModal").remove(),$("body").append($('                        <div class="modal fade" id="pointEntryModal" role="dialog">                        <div class="modal-dialog modal-sm">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class= "close" id="closePointEntryDlg">&times;</button>                        <h4 id="pointEntryTitle" class="modal-title">Add/Romve Point</h4>                        </div>                        <div class="modal-body">                        <div class="row">                        <div class="col-sm-4">Name:</div>                        <input id="curve_name" type="text" value="curve_1">                        </div>                        <br>                        <div class="row">                        <div class="col-sm-4">Abscissa(X):</div>                        <input id="abscissa" type="text" value=0.0>                        </div>                        <br>                        <div class="row">                        <div class="col-sm-4">Ordinate(Y):</div>                        <input id="ordinate" type="text" value=0.0>                        </div>                        <br>                        <div class="modal-footer">                        <button id="pointEntryDlg_enter" type="button" class="btn btn-default" >Add</button>                        <button id="pointEntryDlg_remove" type="button" class="btn btn-default" >Remove</button>                        <button id="pointEntryDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Finish</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#pointEntryDlg_enter").click(s),$("#pointEntryDlg_remove").click(a),$("#closePointEntryDlg").click(i),$("#curve_name, #abscissa, #ordinate").keyup(r),$("#pointEntryDlg_remove").attr("disabled",!1),$("#pointEntryDlg_enter").attr("disabled",!0)});function n(t){var n=e.plot.findPlotCurve($("#curve_name").val());if(!n)return!1;var r=n.data().samples();if(r.length>0)for(var i=0;i<r.length;++i)if(t.x==r[i].x&&t.y==r[i].y)return!0;return!1}function r(){var t,r,i,a=e.plot.findPlotCurve($("#curve_name").val());if(a&&(t=a.data().samples()),"-"==$("#abscissa").val())return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0);try{r=math.eval(Static.expandDefines($("#abscissa").val()))}catch(e){return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0)}if("-"==$("#ordinate").val())return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0);try{i=math.eval(Static.expandDefines($("#ordinate").val()))}catch(e){return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0)}if(void 0==i||void 0==r)return $("#pointEntryDlg_remove").attr("disabled",!0),void $("#pointEntryDlg_enter").attr("disabled",!0);n(new Misc.Point(r,i))?(t.length>1&&$("#pointEntryDlg_remove").attr("disabled",!1),$("#pointEntryDlg_enter").attr("disabled",!0)):($("#pointEntryDlg_remove").attr("disabled",!0),$("#pointEntryDlg_enter").attr("disabled",!1))}function i(){$("#pointEntryDlg_ok").click()}function a(){e.plot.findPlotCurve($("#curve_name").val()).removePoint(new Misc.Point(parseFloat($("#abscissa").val()),parseFloat($("#ordinate").val()))),$("#pointEntryDlg_remove").attr("disabled",!0),$("#pointEntryDlg_enter").attr("disabled",!1),Static.trigger("curveAdjusted")}function s(){let t=e.plot.findPlotCurve($("#curve_name").val());if(t)"Modify/Remove Point"==e.dlgTitle()&&(t.removePoint(e.point,!0),Static.trigger("curveAdjusted"));else{(t=new MyCurve($("#curve_name").val())).attach(e.plot);let n=Utility.randomColor();t.setPen(new Misc.Pen(n));let r=new Symbol(MRect,new Misc.Brush(Static.invert(n)),new Misc.Pen(n),new Misc.Size(8,8));t.setSymbol(r);let i="";Static.showline&&Static.showsymbol?i="lineAndSymbol":Static.showline?i="line":Static.showsymbol&&(i="symbol"),Utility.setLegendAttribute(t,i,t.getLegendIconSize())}let n=t.data().samples();var r=math.eval(Static.expandDefines($("#abscissa").val())),i=math.eval(Static.expandDefines($("#ordinate").val()));let a=new Misc.Point(r,i);e.point=a,n.containsPoint(a)||n.push(a),n.sort(function(e,t){return e.x-t.x}),t.setSamples(n),e.plot.autoRefresh(),Static.trigger("pointAdded",t),Static.trigger("curveAdjusted"),$("#pointEntryDlg_enter").attr("disabled",!0),n.length>1&&$("#pointEntryDlg_remove").attr("disabled",!1)}this.setDlgTitle=function(e){$("#pointEntryTitle").html(e),"Modify/Remove Point"==e?$("#pointEntryDlg_enter").html("Modify"):$("#pointEntryDlg_enter").html("Add")},this.dlgTitle=function(e){return $("#pointEntryTitle").html()},this.pointEntryCb=function(r,i,a,s){var o;e.curveName=a,e.point=s,t(),e.setDlgTitle(r),void 0!==a&&$("#curve_name").val(a),void 0!==s&&($("#abscissa").val(s.x),$("#ordinate").val(s.y)),e.plot=i,(o=e.plot.findPlotCurve($("#curve_name").val()))&&o.data().samples().length>1?$("#pointEntryDlg_remove").attr("disabled",!1):$("#pointEntryDlg_remove").attr("disabled",!0),$("#pointEntryModal").modal({backdrop:"static"}),"Modify/Remove Point"==r?($("#curve_name").attr("disabled",!0),$("#pointEntryDlg_enter").attr("disabled",!0)):($("#curve_name").attr("disabled",!1),n(new Misc.Point($("#abscissa").val(),$("#ordinate").val()))||$("#pointEntryDlg_enter").attr("disabled",!1))}}}define("pointEntryDlg",function(){});class ToolBar{constructor(e){var t=[];function n(){console.log("No callback defined for button")}e=e||{};var r=$('<div id="toolBar1" style="position:relative; border-style: ridge; background-color: lightBlue"></div>');function i(e){for(var n=0;n<t.length;++n)if(t[n][0].innerText.trim().split(" ")[0]==e)return n;return-1}void 0!==e.zIndex&&r.css("zIndex",e.zIndex),r.insertBefore($("#plotDiv")),$("#plotDiv").removeClass("noToolBar"),$("#plotDiv").addClass("toolBar");this.disable=function(e){"string"==typeof e&&(e=i(e)),t[e].attr("disabled",!0)},this.enable=function(e){"string"==typeof e&&(e=i(e)),t[e].attr("disabled",!1)},this.hide=function(n){"string"==typeof n&&(n=i(n)),void 0==n&&(n=-1),n>-1&&n<t.length?t[n].hide():(r.hide(),$("#plotDiv").removeClass("toolBar"),$("#plotDiv").addClass("noToolBar")),e.refreshCb&&refreshCb()},this.show=function(n){"string"==typeof n&&(n=i(n)),void 0==n&&(n=-1),n>-1&&n<t.length?t[n].show():(r.show(),$("#plotDiv").removeClass("noToolBar"),$("#plotDiv").addClass("toolBar")),e.refreshCb&&refreshCb()};this.addToolButton=function(e,i){return"pushbutton"==e?function(e){e.text=e.text,e.class=e.class||"btn btn-primary",e.innerHtmlId=e.innerHtmlId||"elem_"+t.length,e.duration=e.duration||40;var n=$("<button id="+e.innerHtmlId+' type="button" data-toggle="tooltip">');if(n.addClass(e.class),void 0!==e.icon){void 0!==e.text&&e.text.length&&n.text(e.text+" ");var i=$("<img src="+e.icon+' alt="Img" width=18px>');n.append(i)}else n.text(e.text);r.append(n),n.attr("title",e.tooltip);var a=e.cb||function(){console.log("No callback defined for button")},s="click",o="mousedown",l="mouseup";return Static.isMobile()&&(s="tap",o="touchstart",l="touchend"),e.repeat?(n.interval=null,n.bind(o,function(t){"mousedown"==o&&0!=t.button||(n.interval=setInterval(a,e.duration))}),$(window).bind(l,function(){clearInterval(n.interval)})):n.bind(s,a),t.push(n),t.length-1}(i):"checkbox"==e?function(e){var n=e.label||"Option 1",i="";e.checked&&(i="checked"),e.innerHtmlId=e.innerHtmlId||"elem_"+t.length;var a=$('<label data-toggle="tooltip" class="checkbox-inline">                                    <input id='+e.innerHtmlId+'  type="checkbox" value="" '+i+">"+n+"                                  </label>");a.css("marginLeft",e.marginLeft||8),a.css("marginRight",e.marginRight||8),r.append(a),e.disabled&&$("#"+e.innerHtmlId).attr("disabled",!0),a.attr("title",e.tooltip);var s=e.cb||function(){console.log("No callback defined for button")};return a.click(function(){s($("#"+e.innerHtmlId).is(":checked"))}),t.push($("#"+e.innerHtmlId)),t.length-1}(i):"toggleSwitch"==e?function(e){var n=e.label||"Option 1",i="";e.checked&&(i="checked"),e.innerHtmlId=e.innerHtmlId||"elem_"+t.length;var a=$('<label data-toggle="tooltip" class="checkbox-inline switch">                                    <input id='+e.innerHtmlId+'  type="checkbox" value="" '+i+'>                                    <span class="slider round" style="width:48px"></span>                                    <span style="margin-left:30px">'+n+"</span>                                  </label>");a.css("marginLeft",e.marginLeft||4),a.css("marginRight",e.marginRight||2),r.append(a),a.attr("title",e.tooltip);var s=e.cb||function(){console.log("No callback defined for button")};return $("#"+e.innerHtmlId).on("change",function(){s($(this)[0].checked)}),t.push(a),t.length-1}(i):"radio"==e?function(e){var i=e.label||"Option 1";e.value=e.value||i,e.innerHtmlId=e.innerHtmlId||"elem_"+t.length;var a=e.name||"optradio";e.checked;var s=null;s=e.checked?$("<input id="+e.innerHtmlId+' type="radio" checked value='+e.value+" name="+a+">"):$("<input id="+e.innerHtmlId+' type="radio" value='+e.value+" name="+a+">");var o=$('<label data-toggle="tooltip" class="checkbox-inline">                                    '+i+"                                  </label>");o.append(s),o.css("marginLeft",e.marginLeft||0),o.css("marginRight",e.marginRight||0),r.append(o),o.attr("title",e.tooltip),o.addClass(e.class);var l=e.cb||n;return o.click(l),t.push(o),t.length-1}(i):"dropdown"==e?function(e){e.label;e.text=e.text||"Button",e.innerHtmlId=e.innerHtmlId||"elem_"+t.length;var i=$('<span data-toggle="tooltip" class="dropdown">                              <button id='+e.innerHtmlId+' class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">'+e.text+'                              <span class="caret"></span></button>                              <ul class="dropdown-menu">'+function(e){for(var t="",n=e.hasCheckbox||!1,r=e.listElements||[],i=0;i<r.length;++i)r[i].icon=r[i].icon||"",r[i].checked=r[i].checked||"unchecked",n&&!r[i].icon.length&&(r[i].tooltip?t+='<li title="'+r[i].tooltip+'"><a href="#"><label><input type="checkbox" '+r[i].checkboxState+" value="+i+">"+r[i].text+"</label></a></li>":t+='<li><a href="#"><label><input type="checkbox" '+r[i].checkboxState+" value="+i+">"+r[i].text+"</label></a></li>"),!n&&r[i].icon.length&&(r[i].tooltip?t+='<li title="'+r[i].tooltip+'"><a href="#"><label><img src='+r[i].icon+' alt="Img" width=20px> '+r[i].text+"</label></a></li>":t+='<li><a href="#"><label>'+r[i].icon+r[i].text+"</label></a></li>"),n&&r[i].icon.length&&(r[i].tooltip?t+='<li title="'+r[i].tooltip+'"><a href="#"><label><img src='+r[i].icon+' alt="Img" width=20px><input type="checkbox" '+r[i].checkboxState+' value="">'+r[i].text+"</label></a></li>":t+='<li><a href="#"><label><input type="checkbox" '+r[i].checkboxState+' value="">'+r[i].icon+r[i].text+"</label></a></li>"),n||r[i].icon.length||(r[i].tooltip?t+='<li title="'+r[i].tooltip+'"><a href="#"><label>'+r[i].text+"</label></a></li>":t+='<li><a href="#"><label>'+r[i].text+"</label></a></li>");return t}(e)+"</ul>                          </span>");return i.css("marginLeft",e.marginLeft||0),i.css("marginRight",e.marginRight||0),i.addClass(e.class),i.attr("title",e.tooltip),r.append(i),e.cb=e.cb||n,i.on("click",function(t){if($(t.target).parent().parent().parent().hasClass("disabled"))return!1;if(!e.hasCheckbox){var n=$(t.target).closest("li").index();-1!=n&&e.cb(t,n)}}),i.on("change",function(t){var n=$(t.target);n.prop("checked"),e.cb(t,n.closest("li").index(),n.prop("checked"))}),t.push(i),t.length-1}(i):"select"==e?function(e){e.label=e.label||"Select One",e.innerHtmlId=e.innerHtmlId||"elem_"+t.length;var n=$("<select/>"),i=$('<span data-toggle="tooltip"><label for='+e.innerHtmlId+">"+e.label+":</label>                            </span>");i.append(n);for(var a=e.selections||[],s=0;s<a.length;++s)n.append($("<option>"+a[s]+"</option>"));i.css("marginLeft",e.marginLeft||8),i.css("marginRight",e.marginRight||8),i.addClass(e.class),i.attr("title",e.tooltip),r.append(i);var o=e.cb||function(){console.log("No callback defined for button")};return n.on("change",function(){o($(this)[0].selectedIndex)}),t.push(i),t.length-1}(i):"slider"==e?function(e){var n=e.label||"Option 1",i="";void 0!==e.min&&(i=' min="'+e.min+'"');var a="";void 0!==e.max&&(a=' max="'+e.max+'"');var s="";void 0!==e.value&&(s=" value="+e.value+" ");var o=" width:100px ";void 0!==e.width&&(o=" width:"+e.width+"px "),e.innerHtmlId=e.innerHtmlId||"elem_"+t.length;var l=$('<input style="position:absolute; '+o+'" id='+e.innerHtmlId+" "+s+'  type="range" '+i+" "+a+"/>"),c=$("<label for="+e.innerHtmlId+'data-toggle="tooltip">'+n+"</label>");c.append(l),c.css("marginLeft",e.marginLeft||8),c.css("marginRight",e.marginRight||8),l.css("marginLeft",e.marginLeft||8),l.css("marginTop",e.marginTop||2),r.append(c),l.css("top",r.css("top"));var u=$("#"+e.innerHtmlId).parent()[0],h=u.offsetLeft+u.offsetWidth;l.css("left",h),c.css("width",u.offsetWidth+parseInt(l.css("width"))),c.attr("title",e.tooltip);var d=e.cb||function(){console.log("No callback defined for button")};return l.on("change",function(){d(parseInt($(this).val()))}),t.push(c),t.length-1}(i):"number"==e?function(e){e.label=e.label||"Select One",e.innerHtmlId=e.innerHtmlId||"elem_"+t.length,e.min=e.min||-1e6,e.max=e.max||1e6,e.value=e.value||e.min,e.value>e.max&&(e.value=e.max),e.value<e.min&&(e.value=e.min);var n=$('<span data-toggle="tooltip"><label for="sel1">'+e.label+":</label>                                   </span>"),i=$("<input id="+e.innerHtmlId+'  type="number"                            value="10" name="some-name"/>');n.append(i),r.append(n),i.attr({width:200,min:e.min,max:e.max,step:e.step,value:e.value}),n.attr("title",e.tooltip),n.css("marginLeft",e.marginLeft||8),n.css("marginRight",e.marginRight||8),n.addClass(e.class);var a=e.cb||function(){console.log("No callback defined for button")};return i.on("change",function(){a(parseFloat($(this).val()))}),t.push(n),t.length-1}(i):"upload"==e?function(e){e.label=e.label||"Select One",e.innerHtmlId=e.innerHtmlId||"elem_"+t.length;var n=$("<input id="+e.innerHtmlId+'  type="file" name="files[]" multiple />'),i=$('<button data-toggle="tooltip"></button>');n.css("marginLeft",-8),n.css("marginRight",-8),n.css("marginTop",-3),n.css("marginBottom",-3),i.append(n),i.css("marginLeft",e.marginLeft||8),i.css("marginRight",e.marginRight||8),i.addClass(e.class),i.attr("title",e.tooltip),r.append(i),t.push(i);var a=!1;return i.click(function(){if(!a)return a=!0,n.trigger("click"),!1}),t.length-1}(i):"link"==e?function(e){e.text=e.text||"Button",e.innerHtmlId=e.innerHtmlId||"elem_"+t.length;var n=$("<A HREF="+e.href+"></a>");n.text(e.text),r.append(n),n.addClass(e.class),n.attr("title",e.tooltip),n.attr("target",e.target);var i=e.cb||function(){console.log("No callback defined for button")};return n.click(i),t.push(n),t.length-1}(i):void 0},this.setButtonCheck=function(e,n){"string"==typeof e&&(e=i(e)),t[e][0].children[0]?t[e][0].children[0].checked=n:t[e][0].checked=n},this.isDropdownItemChecked=function(e,n){return"string"==typeof e&&(e=i(e)),$($(t[e].children()[1]).children()[n]).children().children().children().prop("checked")},this.setDropdownItemCheck=function(e,n,r){"string"==typeof e&&(e=i(e)),$($(t[e].children()[1]).children()[n]).children().children().children().prop("checked",r)},this.hideDropdownItem=function(e,n){"string"==typeof e&&(e=i(e)),$($(t[e].children()[1]).children()[n]).hide()},this.showDropdownItem=function(e,n){"string"==typeof e&&(e=i(e)),$($(t[e].children()[1]).children()[n]).show()},this.enableDropdownItem=function(e,n,r){"string"==typeof e&&(e=i(e));var a=$($(t[e].children()[1]).children()[n]).addClass("disabled");r?a.removeClass("disabled"):a.addClass("disabled")}}}define("toolBar",function(){});class MCurveSettings{constructor(e){let t=null,n=null,r=null,i=null,a=null;function s(){let t=$("#curveSelect").children();for(let e=0;e<t.length;++e)$("#curveSelect")[0].removeChild(t[e]);let n=e.itemList(Static.Rtti_PlotCurve);for(let e=0;e<n.length;++e)if(n[e].isVisible()){let t=$("<option>"+n[e].title()+"</option>");t.attr("value",n[e].title()),$("#curveSelect").append(t)}return $("#sizeSymbol").val(10),n.length?n[0]:null}function o(e){e.brush().color==Static.NoBrush?$("#clearBrush").hide():$("#clearBrush").show()}function l(e){if(!e)return;$("#penColor").val(Static.colorNameToHex(e.pen().color)),$("#penWidth")[0].selectedIndex=e.pen().width-1,$("#penStyle")[0].selectedIndex=["solid","dot","dash","dashDot","dashDotDot"].indexOf(e.pen().style),$("#horizontalAxis")[0].selectedIndex=e.xAxis()-2,$("#verticalAxis")[0].selectedIndex=e.yAxis(),e.fitType?$("#fitInfo").show():$("#fitInfo").hide(),o(e);let t=e.symbol();if(t){let e=t.style();e==MRect&&$("#symbolType").val("MRect"),e==Cross&&$("#symbolType").val("Cross"),e==Diamond&&$("#symbolType").val("Diamond"),e==Ellipse&&$("#symbolType").val("Ellipse"),e==XCross&&$("#symbolType").val("XCross")}else $("#symbolType").val("None");"None"==$("#symbolType").val()?$("#symbolContainer").hide():($("#symbolContainer").show(),$("#penColorSymbol").val(t.pen().color),$("#penWidthSymbol").val(t.pen().width),$("#fillBrushSymbol").val(t.brush().color),$("#sizeSymbol").val(t.size().width))}$("body").append($('                \x3c!-- Modal --\x3e                <div class="modal fade" id="curveSettingsModal" role="dialog">                <div class="modal-dialog">                                \x3c!-- Modal content--\x3e                <div class="modal-content">                <div class="modal-header">                \x3c!--button type="button" class="close" data-dismiss="modal">&times;</button--\x3e                <h4 class="modal-title">Curve attributes</h4>                </div>                <div class="modal-body">                                                <div class="row">                <div class="col-sm-3">Curve name:</div>                <div class="col-sm-5"><select id="curveSelect" style="width:100%"></select></div>                <div class="col-sm-2"><button id="remove">Remove</button></div>                <div class="col-sm-2"><button id="rename">Rename</button></div>                </div>                                <br>                <div class="row">                <div class="col-sm-3">Pen color:<input id="penColor" type="color"/></div>                <div class="col-sm-4">Pen width:<select id="penWidth" style="width:50%"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>                <div class="col-sm-5">Pen style:<select id="penStyle" style="width:60%"><option>solid</option><option>dot</option><option>dash</option><option>dashDot</option><option>dashDotDot</option></select></div>                </div>                                <br>                <div class="row">                <div class="col-sm-6">Horizontal axis:<select id="horizontalAxis" style="width:50%"><option value="2">Bottom</option><option value="3">Top</option></select></div>                <div class="col-sm-5">Vertical axis:<select id="verticalAxis" style="width:60%"><option value="0">Left</option><option value="1">Right</option></select></div>                </div>                                <br>                <div class="row">                <div class="col-sm-1"><button id="fit">Fit</button></div><div class="col-sm-3"><button id="legendAttribute">Legend attribute</button></div><div class="col-sm-3"><button id="curveStyle">Curve style</button></div><div class="col-sm-2"><button id="curveBrush"> Brush</button></div><div class="col-sm-3"><button id="clearBrush">No brush</button></div>\x3c!--div class="col-sm-2"><button id="curveAxis">Axis</button></div--\x3e                <div class="col-sm-3"><button id="fitInfo">Curve Fit Info...</button></div>                </div>                                <br>                <div class="row">                <div class="col-sm-2">Symbols</div>                <div class="col-sm-8"><select id="symbolType"><option value="None">None</option><option value="MRect">Rectangle</option><option value="Cross">Cross</option><option value="Diamond">Diamond</option><option value="Ellipse">Ellipse</option><option value="XCross">Diagonal cross</option></select></div>                </div>                                <br>                <div id="symbolContainer">                <div class="row">                <div class="col-sm-6">Symbol pen color:<input id="penColorSymbol" type="color"/></div>                <div class="col-sm-6">Symbol pen width:<select id="penWidthSymbol" style="width:50%"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>                </div>                <br>                <div class="row">                <div class="col-sm-6">Symbol fill brush:<input id="fillBrushSymbol" type="color"/></div>                <div class="col-sm-6">Symbol size:<select id="sizeSymbol" style="width:50%"><option value="5">5x5</option><option value="6">6x6</option><option value="8">8x8</option><option value="10">10x10</option><option value="12">12x12</option><option value="15">15x15</option></select></div>                </div>                </div>                                                </div>                <div class="modal-footer">                <button id="cancelAxisDlg" type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>                <button type="button" class="btn btn-default" data-dismiss="modal">Ok</button>                </div>                </div>                                </div>                </div>                ')),$("#curveSelect").change(function(){l(e.findPlotCurve($("#curveSelect").val()))}),$("#remove").click(function(){if(e.findPlotCurve($("#curveSelect").val()).detach(),!e.hasPlotCurve())return void $("#cancelAxisDlg").click();let t=$("#curveSelect").children();$("#curveSelect")[0].removeChild(t[$("#curveSelect")[0].selectedIndex]),l(e.findPlotCurve($("#curveSelect").val()))}),$("#rename").click(function(){return Utility.curveRenameDlg($("#curveSelect").val(),e,function(){let e=$("#curveSelect")[0].selectedIndex;return s(),$("#curveSelect")[0].selectedIndex=e,!0}),!0}),$("#fit").click(function(){t(e.findPlotCurve($("#curveSelect").val()))}),$("#legendAttribute").click(function(){r(e.findPlotCurve($("#curveSelect").val()))}),$("#clearBrush").click(function(){Utility.removeCurveBrush(e.findPlotCurve($("#curveSelect").val())),o(e.findPlotCurve($("#curveSelect").val()))}),$("#curveBrush").click(function(){Utility.setCurveBrush(e.findPlotCurve($("#curveSelect").val()),o)}),$("#curveStyle").click(function(){i(e.findPlotCurve($("#curveSelect").val()))}),$("#curveAxis").click(function(){a(e.findPlotCurve($("#curveSelect").val()))}),$("#fitInfo").click(function(){let t=e.findPlotCurve($("#curveSelect").val()),r=n(t);r.length?Static.alert(r):Static.alert('No curve fitting equation found for "'+t.title()+'."')}),$("#penColor").change(function(){let t=e.findPlotCurve($("#curveSelect").val()),n=t.pen();n.color=$(this).val(),t.setPen(n)}),$("#penWidth").change(function(){let t=e.findPlotCurve($("#curveSelect").val()),n=t.pen();n.width=$(this).val(),t.setPen(n)}),$("#penStyle").change(function(){let t=e.findPlotCurve($("#curveSelect").val()),n=t.pen();n.style=$(this).val(),t.setPen(n)}),$("#horizontalAxis").change(function(){let t=e.findPlotCurve($("#curveSelect").val());t.setXAxis($(this).val()),Static.trigger("axisChanged",[$(this).val(),t])}),$("#verticalAxis").change(function(){let t=e.findPlotCurve($("#curveSelect").val());t.setYAxis($(this).val()),Static.trigger("axisChanged",[$(this).val(),t])}),$("#symbolType").change(function(){let t=e.findPlotCurve($("#curveSelect").val());"None"==$("#symbolType").val()?($("#symbolContainer").hide(),$("#penWidthSymbol").val(1),$("#penColorSymbol").val(Static.colorNameToHex("black")),$("#fillBrushSymbol").val(Static.colorNameToHex("transparent")),$("#sizeSymbol").val(10)):$("#symbolContainer").show(),function(e,t){if("None"==t)return void e.setSymbol(null);let n=-1;"MRect"==t&&(n=MRect);"Cross"==t&&(n=Cross);"Diamond"==t&&(n=Diamond);"Ellipse"==t&&(n=Ellipse);"XCross"==t&&(n=XCross);Utility.addSymbol(e,n)}(t,$(this).val())}),$("#penColorSymbol").change(function(){let t=e.findPlotCurve($("#curveSelect").val()),n=t.symbol();if(!n)return;let r=n.pen();r.color=$(this).val(),n.setPen(r),t.plot().autoRefresh(),t.plot().updateLegend(t)}),$("#penWidthSymbol").change(function(){!function(e,t){Utility.setSymbolPenWidth(e,t)}(e.findPlotCurve($("#curveSelect").val()),parseInt($(this).val()))}),$("#fillBrushSymbol").change(function(){let t=e.findPlotCurve($("#curveSelect").val()),n=t.symbol();if(!n)return;let r=n.brush();r.color=$(this).val(),n.setBrush(r),t.plot().autoRefresh(),t.plot().updateLegend(t)}),$("#sizeSymbol").change(function(){!function(e,t){Utility.setSymbolSize(e,t)}(e.findPlotCurve($("#curveSelect").val()),parseInt($(this).val()))}),this.init=function(){t=e.curveFitDlg.curveFitCb,n=e.curveFitDlg.curveFitInfoCb,r=e.curveAttributeDlg.curveAttributeCb,i=e.curveStyleDlg.curveStyleCb,a=e.axisDlg.axisCb},this.curveSettingsDlg=function(){e.itemList(Static.Rtti_PlotCurve).length?(l(s()),$("#curveSettingsModal").modal({backdrop:"static"})):Static.alert("No curves found","small")},this.init()}}define("curveSettings",function(){});class MToolBar extends ToolBar{constructor(e,t){super(t);var n=this,r=new Watches(e).watchElements();function i(){var t=$("input[name=optradio]").filter(":checked").val();"Zoom"==t&&(e.pan.setEnabled(!1),Utility.setAutoScale(e,!1),e.zm.setEnabled(!0),e.zm.setZoomBase(e.zm.scaleRect())),"Pan"==t&&(e.pan.setEnabled(!0),e.zm.setEnabled(!1),Utility.setAutoScale(e,!1)),"Auto"==t&&(e.pan.setEnabled(!1),e.zm.setEnabled(!1),Utility.setAutoScale(e,!0))}var a,s=[function(t){e.enableAxis(yLeft,t)},function(t){e.enableAxis(xBottom,t)},function(t){e.enableAxis(yRight,t)},function(t){e.enableAxis(xTop,t)},function(t){Utility.majorGridLines(e.grid,t),n.enableDropdownItem("View",5,t)},function(t){Utility.minorGridLines(e.grid,t)},function(t){t?e.showTitle():e.hideTitle()},function(t){t?e.showFooter():e.hideFooter()},function(t){e.enableLegend(t)}];Static.bind("majorGridLines",function(e,t,r){n.setDropdownItemCheck("View",4,r),n.enableDropdownItem("View",5,r)}),Static.bind("minorGridLines",function(e,t,r){n.setDropdownItemCheck("View",5,r)});var o=[e.file.save,function(){e._functionDlg.functionDlg(Utility.generateCurveName(e))},function(){e.pointEntryDlg.pointEntryCb("Add/Romve Point",e)},function(){a&&!a.closed||(a=window.open("https://www.tcsion.com/OnlineAssessment/ScientificCalculator/Calculator.html#nogo","_blank","width=480,height=345, top=200, left=200")),a.focus()},function(e){Static.defines()},function(t){e.markerDlg.markerCb(e)},Static.printFn];this.addToolButton("dropdown",{text:"File",cb:function(e,t){o[t]()},listElements:[{text:"Save",icon:"images/save.png",tooltip:"Save the current graph."},{text:"Function",icon:"images/function.png",tooltip:"Launches the function dialog."},{text:"Point entry",icon:"images/pointEntry.png",tooltip:"Launches the point entry dialog."},{text:"Calculator",icon:"images/calculator.png",tooltip:"Launches the calculator."},{text:"Defines",icon:"images/defines.png",tooltip:"Launches the defines dialog."},{text:"Marker",icon:"images/marker.png",tooltip:"Launches the marker dialog."},{text:"Print",icon:"images/print.png",tooltip:"Print the current graph."}]});var l=this.addToolButton("checkbox",{label:"C-Prop",cb:function(t){e.leftSidebar.showGridItem(0,t)},tooltip:"Show/Hide curve properties pane",disabled:!0}),c=this.addToolButton("checkbox",{label:"P-Prop",checked:!0,cb:function(t){e.leftSidebar.showGridItem(1,t)},tooltip:"Show/Hide plot properties pane"});Static.bind("showGridItem",function(e,t,r,i){"left"==t&&(0==r?n.setButtonCheck(l,i):n.setButtonCheck(c,i))}),this.addToolButton("upload",{innerHtmlId:"fileInput",class:"btn btn-primary",tooltip:"Upload data files"}),this.addToolButton("radio",{label:"Zoom",tooltip:"Enable zooming. Press the mouse left button and drag.",cb:i}),this.addToolButton("radio",{label:"Pan",tooltip:"Allow dragging of all plot items to new positions. Press the mouse left button and drag.",cb:i}),this.addToolButton("radio",{label:"Auto",tooltip:"Determine and and apply the scale that\nallows the extent of all curves to be shown.",cb:i,checked:!0}),this.addToolButton("dropdown",{text:"View",hasCheckbox:!0,cb:function(e,t,n){s[t](n)},listElements:[{text:"Left axis",icon:"images/axis.png",tooltip:"Enable left axis",checkboxState:"checked"},{text:"Bottom axis",icon:"images/axis.png",tooltip:"Enable bottom axis",checkboxState:"checked"},{text:"Right axis",icon:"images/axis.png",tooltip:"Enable right axis"},{text:"Top axis",icon:"images/axis.png",tooltip:"Enable top axis"},{text:"Major gridlines",icon:"images/major_grid.png",tooltip:"Enable major gridlines",checkboxState:"checked"},{text:"Minor gridlines",icon:"images/minor_grid.png",tooltip:"Enable minor gridlines",checkboxState:"checked"},{text:"Title",icon:"images/title.png",tooltip:"Enable title",checkboxState:"checked"},{text:"Footer",icon:"images/footer.png",tooltip:"Enable footor",checkboxState:"checked"},{text:"Legend",icon:"images/legend.png",tooltip:"Enable the legend (at least one curve should be present)",checkboxState:"checked"}]});var u=this.addToolButton("checkbox",{label:"S-Bar",cb:function(t){e.itemList(Static.Rtti_PlotCurve).length&&(e.rightSidebar.showGridItem(0,t),e.rv.updateWatchesAndTable()),t||e.sidebar.setSidebarReDisplay(!1)},tooltip:"Show/Hide sidbar",disabled:!0});this.addToolButton("checkbox",{label:"P-Sel",cb:function(t){e.curveClosestPoint.setEnabled(t),Static.trigger("pSel",t)},tooltip:"Turn on point selection. This may affect response."});this.addToolButton("pushbutton",{text:"+",icon:"images/zoom_in.png",repeat:!0,tooltip:"Zoom in.",cb:function(t){for(var n=0;n<axisCnt;n++){e.axisScaleDiv(n).range()>1e-9&&e.magnifier.rescale(.995)}}}),this.addToolButton("pushbutton",{text:"-",icon:"images/zoom_out.png",repeat:!0,tooltip:"Zoom out",cb:function(t){e.magnifier.rescale(1/.98)}}),this.addToolButton("dropdown",{text:"Watch",tooltip:"Enable/disable watches.",hasCheckbox:!0,cb:function(t,n,r){e.rv.watch(n).setEnable(r),e.rv.updateWatchesAndTable()},listElements:r}),this.addToolButton("link",{text:"Help",cb:function(){},href:"grapherHelp/Grapher.html",target:"_blank",class:"noSelect",tooltip:"Launches online help."}),Static.bind("showGridItem",function(t,r,i,a){"right"==r&&(a||(n.setButtonCheck(u,!1),e.sidebar&&e.sidebar.setSidebarReDisplay(!1)))}),Static.bind("visibilityChange",function(t,r,i){r.rtti==Static.Rtti_PlotCurve&&(e.sidebar&&e.sidebar.initSidebar(),e.hasVisiblePlotCurve()?(n.enable(u),e.sidebar&&e.sidebar.sidebarReDisplay()&&(e.rightSidebar.showSidebar(!0),e.sidebar.setSidebarReDisplay(!1))):(n.disable(u),e.tbar.hideDropdownItem("View",10),e.rightSidebar&&e.rightSidebar.isSideBarVisible()&&(Static.alert("Ooops!! No visible curves to watch."),e.rightSidebar.showSidebar(!1),e.sidebar.setSidebarReDisplay(!0))))}),Static.bind("itemChanged",function(t,n,r){n.rtti==Static.Rtti_PlotGrid&&(r?e.tbar.showDropdownItem("View",6):e.tbar.hideDropdownItem("View",6))}),Static.bind("rescaled",function(){n.setButtonCheck("Auto",!1)}),""==e.title()&&n.hideDropdownItem("View",7),Static.bind("titleAdded",function(e,t){t?n.showDropdownItem("View",7):n.hideDropdownItem("View",7)}),""==e.footer()&&n.hideDropdownItem("View",8),Static.bind("footerAdded",function(e,t){t?n.showDropdownItem("View",8):n.hideDropdownItem("View",8)}),Static.bind("itemAttached",function(t,r,i){r.rtti!=Static.Rtti_PlotCurve&&r.rtti!=Static.Rtti_PlotSpectroCurve&&r.rtti!=Static.Rtti_PlotSpectrogram||(i?(r.rtti==Static.Rtti_PlotCurve&&n.enable(u),n.enable(l)):(0==e.itemList(Static.Rtti_PlotCurve).length&&0==e.itemList(Static.Rtti_PlotSpectroCurve).length&&0==e.itemList(Static.Rtti_PlotSpectrogram).length&&n.disable(l),e.itemList(Static.Rtti_PlotCurve).length&&e.hasVisiblePlotCurve()||(n.disable(u),n.setButtonCheck(u,!1))),Static.trigger("visibilityChange",[r,i]))}),Static.bind("showSidebar",function(e,t,r){n.setButtonCheck(u,r)}),e.sidebar}}define("mtoolBar",["toolBar","curveSettings"],function(){});var DO_NOT_EXPORT_CODEPAGE=!0,DO_NOT_EXPORT_JSZIP=!0;!function(e){if("object"==typeof exports&&"undefined"!=typeof module&&void 0===DO_NOT_EXPORT_JSZIP)module.exports=e();else if("function"==typeof define&&define.amd&&void 0===DO_NOT_EXPORT_JSZIP)JSZipSync=e(),define("xlsx",[],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof $&&$.global?t=$.global:"undefined"!=typeof self&&(t=self),t.JSZipSync=e()}}(function(){return function e(t,n,r){function i(s,o){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return i(n||e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var a="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){"use strict";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e,t){for(var n,i,a,s,o,l,c,u="",h=0;h<e.length;)s=(n=e.charCodeAt(h++))>>2,o=(3&n)<<4|(i=e.charCodeAt(h++))>>4,l=(15&i)<<2|(a=e.charCodeAt(h++))>>6,c=63&a,isNaN(i)?l=c=64:isNaN(a)&&(c=64),u=u+r.charAt(s)+r.charAt(o)+r.charAt(l)+r.charAt(c);return u},n.decode=function(e,t){var n,i,a,s,o,l,c="",u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)n=r.indexOf(e.charAt(u++))<<2|(s=r.indexOf(e.charAt(u++)))>>4,i=(15&s)<<4|(o=r.indexOf(e.charAt(u++)))>>2,a=(3&o)<<6|(l=r.indexOf(e.charAt(u++))),c+=String.fromCharCode(n),64!=o&&(c+=String.fromCharCode(i)),64!=l&&(c+=String.fromCharCode(a));return c}},{}],2:[function(e,t,n){"use strict";function r(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}r.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},t.exports=r},{}],3:[function(e,t,n){"use strict";n.STORE={magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null},n.DEFLATE=e("./flate")},{"./flate":8}],4:[function(e,t,n){"use strict";var r=e("./utils"),i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];t.exports=function(e,t){if(void 0===e||!e.length)return 0;var n="string"!==r.getTypeOf(e);void 0===t&&(t=0);var a=0,s=0;t^=-1;for(var o=0,l=e.length;o<l;o++)s=n?e[o]:e.charCodeAt(o),a=i[255&(t^s)],t=t>>>8^a;return-1^t}},{"./utils":21}],5:[function(e,t,n){"use strict";var r=e("./utils");function i(e){this.data=null,this.length=0,this.index=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1)}},t.exports=i},{"./utils":21}],6:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!1,n.date=null,n.compression=null,n.comment=null},{}],7:[function(e,t,n){"use strict";var r=e("./utils");n.string2binary=function(e){return r.string2binary(e)},n.string2Uint8Array=function(e){return r.transformTo("uint8array",e)},n.uint8Array2String=function(e){return r.transformTo("string",e)},n.string2Blob=function(e){var t=r.transformTo("arraybuffer",e);return r.arrayBuffer2Blob(t)},n.arrayBuffer2Blob=function(e){return r.arrayBuffer2Blob(e)},n.transformTo=function(e,t){return r.transformTo(e,t)},n.getTypeOf=function(e){return r.getTypeOf(e)},n.checkSupport=function(e){return r.checkSupport(e)},n.MAX_VALUE_16BITS=r.MAX_VALUE_16BITS,n.MAX_VALUE_32BITS=r.MAX_VALUE_32BITS,n.pretty=function(e){return r.pretty(e)},n.findCompression=function(e){return r.findCompression(e)},n.isRegExp=function(e){return r.isRegExp(e)}},{"./utils":21}],8:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako");n.uncompressInputType=r?"uint8array":"array",n.compressInputType=r?"uint8array":"array",n.magic="\b\0",n.compress=function(e){return i.deflateRaw(e)},n.uncompress=function(e){return i.inflateRaw(e)}},{pako:24}],9:[function(e,t,n){"use strict";var r=e("./base64");function i(e,t){if(!(this instanceof i))return new i(e,t);this.files={},this.comment=null,this.root="",e&&this.load(e,t),this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}i.prototype=e("./object"),i.prototype.load=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.utils=e("./deprecatedPublicUtils"),i.base64={encode:function(e){return r.encode(e)},decode:function(e){return r.decode(e)}},i.compressions=e("./compressions"),t.exports=i},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(e,t,n){"use strict";var r=e("./base64"),i=e("./zipEntries");t.exports=function(e,t){var n,a,s,o;for((t=t||{}).base64&&(e=r.decode(e)),n=(a=new i(e,t)).files,s=0;s<n.length;s++)o=n[s],this.file(o.fileName,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileComment.length?o.fileComment:null,createFolders:t.createFolders});return a.zipComment.length&&(this.comment=a.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(e,t,n){(function(e){"use strict";var n=function(){};if(void 0!==e){var r=!e.from;if(!r)try{e.from("foo","utf8")}catch(e){r=!0}n=r?function(t,n){return n?new e(t,n):new e(t)}:e.from.bind(e),e.alloc||(e.alloc=function(t){return new e(t)})}t.exports=function(t,r){return"number"==typeof t?e.alloc(t):n(t,r)},t.exports.test=function(t){return e.isBuffer(t)}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],12:[function(e,t,n){"use strict";var r=e("./uint8ArrayReader");function i(e){this.data=e,this.length=this.data.length,this.index=0}i.prototype=new r,i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=i},{"./uint8ArrayReader":18}],13:[function(e,t,n){"use strict";var r=e("./support"),i=e("./utils"),a=e("./crc32"),s=e("./signature"),o=e("./defaults"),l=e("./base64"),c=e("./compressions"),u=e("./compressedObject"),h=e("./nodeBuffer"),d=e("./utf8"),f=e("./stringWriter"),p=e("./uint8ArrayWriter"),m=function(e){if(e._data instanceof u&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,"uint8array"===i.getTypeOf(e._data))){var t=e._data;e._data=new Uint8Array(t.length),0!==t.length&&e._data.set(t,0)}return e._data},v=function(e){var t=m(e);return"string"===i.getTypeOf(t)?!e.options.binary&&r.nodebuffer?h(t,"utf-8"):e.asBinary():t},g=function(e){var t=m(this);return null===t||void 0===t?"":(this.options.base64&&(t=l.decode(t)),t=e&&this.options.binary?k.utf8decode(t):i.transformTo("string",t),e||this.options.binary||(t=i.transformTo("string",k.utf8encode(t))),t)},b=function(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this._data=t,this.options=n,this._initialMetadata={dir:n.dir,date:n.date}};b.prototype={asText:function(){return g.call(this,!0)},asBinary:function(){return g.call(this,!1)},asNodeBuffer:function(){var e=v(this);return i.transformTo("nodebuffer",e)},asUint8Array:function(){var e=v(this);return i.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var S=function(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r},y=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},x=function(e,t,n){var r,a=i.getTypeOf(t);if((n=function(e){return!0!==(e=e||{}).base64||null!==e.binary&&void 0!==e.binary||(e.binary=!0),(e=y(e,o)).date=e.date||new Date,null!==e.compression&&(e.compression=e.compression.toUpperCase()),e}(n)).createFolders&&(r=w(e))&&_.call(this,r,!0),n.dir||null===t||void 0===t)n.base64=!1,n.binary=!1,t=null;else if("string"===a)n.binary&&!n.base64&&!0!==n.optimizedBinaryString&&(t=i.string2binary(t));else{if(n.base64=!1,n.binary=!0,!(a||t instanceof u))throw new Error("The data of '"+e+"' is in an unsupported format !");"arraybuffer"===a&&(t=i.transformTo("uint8array",t))}var s=new b(e,t,n);return this.files[e]=s,s},w=function(e){"/"==e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},_=function(e,t){return"/"!=e.slice(-1)&&(e+="/"),t=void 0!==t&&t,this.files[e]||x.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]},C=function(e,t){var n,r=new u;return e._data instanceof u?(r.uncompressedSize=e._data.uncompressedSize,r.crc32=e._data.crc32,0===r.uncompressedSize||e.dir?(t=c.STORE,r.compressedContent="",r.crc32=0):e._data.compressionMethod===t.magic?r.compressedContent=e._data.getCompressedContent():(n=e._data.getContent(),r.compressedContent=t.compress(i.transformTo(t.compressInputType,n)))):((n=v(e))&&0!==n.length&&!e.dir||(t=c.STORE,n=""),r.uncompressedSize=n.length,r.crc32=a(n),r.compressedContent=t.compress(i.transformTo(t.compressInputType,n))),r.compressedSize=r.compressedContent.length,r.compressionMethod=t.magic,r},E=function(e,t,n,r){n.compressedContent;var o,l,c,u,h=i.transformTo("string",d.utf8encode(t.name)),f=t.comment||"",p=i.transformTo("string",d.utf8encode(f)),m=h.length!==t.name.length,v=p.length!==f.length,g=t.options,b="",y="",x="";c=t._initialMetadata.dir!==t.dir?t.dir:g.dir,o=(u=t._initialMetadata.date!==t.date?t.date:g.date).getHours(),o<<=6,o|=u.getMinutes(),o<<=5,o|=u.getSeconds()/2,l=u.getFullYear()-1980,l<<=4,l|=u.getMonth()+1,l<<=5,l|=u.getDate(),m&&(y=S(1,1)+S(a(h),4)+h,b+="up"+S(y.length,2)+y),v&&(x=S(1,1)+S(this.crc32(p),4)+p,b+="uc"+S(x.length,2)+x);var w="";return w+="\n\0",w+=m||v?"\0\b":"\0\0",w+=n.compressionMethod,w+=S(o,2),w+=S(l,2),w+=S(n.crc32,4),w+=S(n.compressedSize,4),w+=S(n.uncompressedSize,4),w+=S(h.length,2),w+=S(b.length,2),{fileRecord:s.LOCAL_FILE_HEADER+w+h+b,dirRecord:s.CENTRAL_FILE_HEADER+"\0"+w+S(p.length,2)+"\0\0\0\0"+(!0===c?"\0\0\0":"\0\0\0\0")+S(r,4)+h+b+p,compressedObject:n}},k={load:function(e,t){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var t,n,r,i,a=[];for(t in this.files)this.files.hasOwnProperty(t)&&(r=this.files[t],i=new b(r.name,r._data,y(r.options)),n=t.slice(this.root.length,t.length),t.slice(0,this.root.length)===this.root&&e(n,i)&&a.push(i));return a},file:function(e,t,n){if(1===arguments.length){if(i.isRegExp(e)){var r=e;return this.filter(function(e,t){return!t.dir&&r.test(e)})}return this.filter(function(t,n){return!n.dir&&t===e})[0]||null}return e=this.root+e,x.call(this,e,t,n),this},folder:function(e){if(!e)return this;if(i.isRegExp(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=_.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!=e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(e){e=y(e||{},{base64:!0,compression:"STORE",type:"base64",comment:null}),i.checkSupport(e.type);var t,n,r=[],a=0,o=0,u=i.transformTo("string",this.utf8encode(e.comment||this.comment||""));for(var h in this.files)if(this.files.hasOwnProperty(h)){var d=this.files[h],m=d.options.compression||e.compression.toUpperCase(),v=c[m];if(!v)throw new Error(m+" is not a valid compression method !");var g=C.call(this,d,v),b=E.call(this,h,d,g,a);a+=b.fileRecord.length+g.compressedSize,o+=b.dirRecord.length,r.push(b)}var x;x=s.CENTRAL_DIRECTORY_END+"\0\0\0\0"+S(r.length,2)+S(r.length,2)+S(o,4)+S(a,4)+S(u.length,2)+u;var w=e.type.toLowerCase();for(t="uint8array"===w||"arraybuffer"===w||"blob"===w||"nodebuffer"===w?new p(a+o+x.length):new f(a+o+x.length),n=0;n<r.length;n++)t.append(r[n].fileRecord),t.append(r[n].compressedObject.compressedContent);for(n=0;n<r.length;n++)t.append(r[n].dirRecord);t.append(x);var _=t.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return i.transformTo(e.type.toLowerCase(),_);case"blob":return i.arrayBuffer2Blob(i.transformTo("arraybuffer",_));case"base64":return e.base64?l.encode(_):_;default:return _}},crc32:function(e,t){return a(e,t)},utf8encode:function(e){return i.transformTo("string",d.utf8encode(e))},utf8decode:function(e){return d.utf8decode(e)}};t.exports=k},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],15:[function(e,t,n){"use strict";var r=e("./dataReader"),i=e("./utils");function a(e,t){this.data=e,t||(this.data=i.string2binary(this.data)),this.length=this.data.length,this.index=0}a.prototype=new r,a.prototype.byteAt=function(e){return this.data.charCodeAt(e)},a.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)},a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=a},{"./dataReader":5,"./utils":21}],16:[function(e,t,n){"use strict";var r=e("./utils"),i=function(){this.data=[]};i.prototype={append:function(e){e=r.transformTo("string",e),this.data.push(e)},finalize:function(){return this.data.join("")}},t.exports=i},{"./utils":21}],17:[function(e,t,n){(function(e){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer=void 0!==e,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var t=new ArrayBuffer(0);try{n.blob=0===new Blob([t],{type:"application/zip"}).size}catch(e){try{var r=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);r.append(t),n.blob=0===r.getBlob("application/zip").size}catch(e){n.blob=!1}}}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],18:[function(e,t,n){"use strict";var r=e("./dataReader");function i(e){e&&(this.data=e,this.length=this.data.length,this.index=0)}i.prototype=new r,i.prototype.byteAt=function(e){return this.data[e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),a=this.length-4;a>=0;--a)if(this.data[a]===t&&this.data[a+1]===n&&this.data[a+2]===r&&this.data[a+3]===i)return a;return-1},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.index,this.index+e);return this.index+=e,t},t.exports=i},{"./dataReader":5}],19:[function(e,t,n){"use strict";var r=e("./utils"),i=function(e){this.data=new Uint8Array(e),this.index=0};i.prototype={append:function(e){0!==e.length&&(e=r.transformTo("uint8array",e),this.data.set(e,this.index),this.index+=e.length)},finalize:function(){return this.data}},t.exports=i},{"./utils":21}],20:[function(e,t,n){"use strict";for(var r=e("./utils"),i=e("./support"),a=e("./nodeBuffer"),s=new Array(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;s[254]=s[254]=1;var l=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+s[e[n]]>t?n:t},c=function(e){var t,n,i,a,o=e.length,l=new Array(2*o);for(n=0,t=0;t<o;)if((i=e[t++])<128)l[n++]=i;else if((a=s[i])>4)l[n++]=65533,t+=a-1;else{for(i&=2===a?31:3===a?15:7;a>1&&t<o;)i=i<<6|63&e[t++],a--;a>1?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),r.applyFromCharCode(l)};n.utf8encode=function(e){return i.nodebuffer?a(e,"utf-8"):function(e){var t,n,r,a,s,o=e.length,l=0;for(a=0;a<o;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),s=0,a=0;s<l;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t}(e)},n.utf8decode=function(e){if(i.nodebuffer)return r.transformTo("nodebuffer",e).toString("utf-8");for(var t=[],n=0,a=(e=r.transformTo(i.uint8array?"uint8array":"array",e)).length;n<a;){var s=l(e,Math.min(n+65536,a));i.uint8array?t.push(c(e.subarray(n,s))):t.push(c(e.slice(n,s))),n=s}return t.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(e,t,n){"use strict";var r=e("./support"),i=e("./compressions"),a=e("./nodeBuffer");function s(e){return e}function o(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}function l(e){var t=65536,r=[],i=e.length,s=n.getTypeOf(e),o=0,l=!0;try{switch(s){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,a(0))}}catch(e){l=!1}if(!l){for(var c="",u=0;u<e.length;u++)c+=String.fromCharCode(e[u]);return c}for(;o<i&&t>1;)try{"array"===s||"nodebuffer"===s?r.push(String.fromCharCode.apply(null,e.slice(o,Math.min(o+t,i)))):r.push(String.fromCharCode.apply(null,e.subarray(o,Math.min(o+t,i)))),o+=t}catch(e){t=Math.floor(t/2)}return r.join("")}function c(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.string2binary=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e.charCodeAt(n));return t},n.arrayBuffer2Blob=function(e){n.checkSupport("blob");try{return new Blob([e],{type:"application/zip"})}catch(n){try{var t=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return t.append(e),t.getBlob("application/zip")}catch(e){throw new Error("Bug : can't construct the Blob.")}}},n.applyFromCharCode=l;var u={};u.string={string:s,array:function(e){return o(e,new Array(e.length))},arraybuffer:function(e){return u.string.uint8array(e).buffer},uint8array:function(e){return o(e,new Uint8Array(e.length))},nodebuffer:function(e){return o(e,a(e.length))}},u.array={string:l,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a(e)}},u.arraybuffer={string:function(e){return l(new Uint8Array(e))},array:function(e){return c(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a(new Uint8Array(e))}},u.uint8array={string:l,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return a(e)}},u.nodebuffer={string:l,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return u.nodebuffer.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:s},n.transformTo=function(e,t){if(t||(t=""),!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return u[r][e](t)},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&a.test(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this browser")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},n.findCompression=function(e){for(var t in i)if(i.hasOwnProperty(t)&&i[t].magic===e)return i[t];return null},n.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(e,t,n){"use strict";var r=e("./stringReader"),i=e("./nodeBufferReader"),a=e("./uint8ArrayReader"),s=e("./utils"),o=e("./signature"),l=e("./zipEntry"),c=e("./support"),u=e("./object");function h(e,t){this.files=[],this.loadOptions=t,e&&this.load(e)}h.prototype={checkSignature:function(e){var t=this.reader.readString(4);if(t!==e)throw new Error("Corrupted zip or bug : unexpected signature ("+s.pretty(t)+", expected "+s.pretty(e)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=u.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readString(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===o.CENTRAL_FILE_HEADER;)(e=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(-1===e)throw new Error("Corrupted zip : can't find end of central directory");if(this.reader.setIndex(e),this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,-1===(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR)))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(e){var t=s.getTypeOf(e);"string"!==t||c.uint8array?this.reader="nodebuffer"===t?new i(e):new a(s.transformTo("uint8array",e)):this.reader=new r(e,this.loadOptions.optimizedBinaryString)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=h},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(e,t,n){"use strict";var r=e("./stringReader"),i=e("./utils"),a=e("./compressedObject"),s=e("./object");function o(e,t){this.options=e,this.loadOptions=t}o.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},prepareCompressedContent:function(e,t,n){return function(){var r=e.index;e.setIndex(t);var i=e.readData(n);return e.setIndex(r),i}},prepareContent:function(e,t,n,r,a){return function(){var e=i.transformTo(r.uncompressInputType,this.getCompressedContent()),t=r.uncompress(e);if(t.length!==a)throw new Error("Bug : uncompressed data size mismatch");return t}},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readString(this.fileNameLength),e.skip(n),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(null===(t=i.findCompression(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new a,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,t),this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,t,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=i.transformTo("string",this.decompressed.getContent()),s.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(e){if(this.versionMadeBy=e.readString(2),this.versionNeeded=e.readInt(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4),this.fileNameLength=e.readInt(2),this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=e.readString(this.fileNameLength),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readString(this.fileCommentLength),this.dir=!!(16&this.externalFileAttributes)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=new r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,n,r,i=e.index;for(this.extraFields=this.extraFields||{};e.index<i+this.extraFieldsLength;)t=e.readInt(2),n=e.readInt(2),r=e.readString(n),this.extraFields[t]={id:t,length:n,value:r}},handleUTF8:function(){if(this.useUTF8())this.fileName=s.utf8decode(this.fileName),this.fileComment=s.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();null!==e&&(this.fileName=e);var t=this.findExtraFieldUnicodeComment();null!==t&&(this.fileComment=t)}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=new r(e.value);return 1!==t.readInt(1)?null:s.crc32(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=new r(e.value);return 1!==t.readInt(1)?null:s.crc32(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readString(e.length-5))}return null}},t.exports=o},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(e,t,n){"use strict";var r=e("./zlib/deflate.js"),i=e("./utils/common"),a=e("./utils/strings"),s=e("./zlib/messages"),o=e("./zlib/zstream"),l=function(e){this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(s[n]);t.header&&r.deflateSetHeader(this.strm,t.header)};function c(e,t){var n=new l(t);if(n.push(e,!0),n.err)throw n.msg;return n.result}l.prototype.push=function(e,t){var n,s,o=this.strm,l=this.options.chunkSize;if(this.ended)return!1;s=t===~~t?t:!0===t?4:0,o.input="string"==typeof e?a.string2buf(e):e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new i.Buf8(l),o.next_out=0,o.avail_out=l),1!==(n=r.deflate(o,s))&&0!==n)return this.onEnd(n),this.ended=!0,!1;(0===o.avail_out||0===o.avail_in&&4===s)&&("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(o.output,o.next_out))):this.onData(i.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==n);return 4!==s||(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n)},l.prototype.onData=function(e){this.chunks.push(e)},l.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=l,n.deflate=c,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,c(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,c(e,t)}},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(e,t,n){"use strict";var r=e("./zlib/inflate.js"),i=e("./utils/common"),a=e("./utils/strings"),s=e("./zlib/constants"),o=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=function(e){this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==s.Z_OK)throw new Error(o[n]);this.header=new c,r.inflateGetHeader(this.strm,this.header)};function h(e,t){var n=new u(t);if(n.push(e,!0),n.err)throw n.msg;return n.result}u.prototype.push=function(e,t){var n,o,l,c,u,h=this.strm,d=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,h.input="string"==typeof e?a.binstring2buf(e):e,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new i.Buf8(d),h.next_out=0,h.avail_out=d),(n=r.inflate(h,s.Z_NO_FLUSH))!==s.Z_STREAM_END&&n!==s.Z_OK)return this.onEnd(n),this.ended=!0,!1;h.next_out&&(0===h.avail_out||n===s.Z_STREAM_END||0===h.avail_in&&o===s.Z_FINISH)&&("string"===this.options.to?(l=a.utf8border(h.output,h.next_out),c=h.next_out-l,u=a.buf2string(h.output,l),h.next_out=c,h.avail_out=d-c,c&&i.arraySet(h.output,h.output,l,c,0),this.onData(u)):this.onData(i.shrinkBuf(h.output,h.next_out)))}while(h.avail_in>0&&n!==s.Z_STREAM_END);return n===s.Z_STREAM_END&&(o=s.Z_FINISH),o!==s.Z_FINISH||(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===s.Z_OK)},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=u,n.inflate=h,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},n.ungzip=h},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){var t,n,r,i,a,s;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(s=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)a=e[t],s.set(a,i),i+=a.length;return s}},a={arraySet:function(e,t,n,r,i){for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(r)},{}],28:[function(e,t,n){"use strict";var r=e("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var s=new r.Buf8(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",s=0;s<t;s++)n+=String.fromCharCode(e[s]);return n}s[254]=s[254]=1,n.string2buf=function(e){var t,n,i,a,s,o=e.length,l=0;for(a=0;a<o;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),s=0,a=0;s<l;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,i,a,o=t||e.length,c=new Array(2*o);for(r=0,n=0;n<o;)if((i=e[n++])<128)c[r++]=i;else if((a=s[i])>4)c[r++]=65533,n+=a-1;else{for(i&=2===a?31:3===a?15:7;a>1&&n<o;)i=i<<6|63&e[n++],a--;a>1?c[r++]=65533:i<65536?c[r++]=i:(i-=65536,c[r++]=55296|i>>10&1023,c[r++]=56320|1023&i)}return l(c,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+s[e[n]]>t?n:t}},{"./common":27}],29:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var i=65535&e|0,a=e>>>16&65535|0,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{a=a+(i=i+t[r++]|0)|0}while(--s);i%=65521,a%=65521}return i|a<<16|0}},{}],30:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,i){var a=r,s=i+n;e^=-1;for(var o=i;o<s;o++)e=e>>>8^a[255&(e^t[o])];return-1^e}},{}],32:[function(e,t,n){"use strict";var r=e("../utils/common"),i=e("./trees"),a=e("./adler32"),s=e("./crc32"),o=e("./messages"),l=0,c=1,u=3,h=4,d=5,f=0,p=1,m=-2,v=-3,g=-5,b=-1,S=1,y=2,x=3,w=4,_=0,C=2,E=8,k=9,R=15,T=8,A=286,P=30,B=19,M=2*A+1,I=15,D=3,L=258,F=L+D+1,O=32,N=42,z=69,W=73,V=91,$=103,U=113,H=666,X=1,G=2,j=3,Y=4,K=3;function Z(e,t){return e.msg=o[t],t}function q(e){return(e<<1)-(e>4?9:0)}function Q(e){for(var t=e.length;--t>=0;)e[t]=0}function J(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(r.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function ee(e,t){i._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,J(e.strm)}function te(e,t){e.pending_buf[e.pending++]=t}function ne(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function re(e,t,n,i){var o=e.avail_in;return o>i&&(o=i),0===o?0:(e.avail_in-=o,r.arraySet(t,e.input,e.next_in,o,n),1===e.state.wrap?e.adler=a(e.adler,t,o,n):2===e.state.wrap&&(e.adler=s(e.adler,t,o,n)),e.next_in+=o,e.total_in+=o,o)}function ie(e,t){var n,r,i=e.max_chain_length,a=e.strstart,s=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-F?e.strstart-(e.w_size-F):0,c=e.window,u=e.w_mask,h=e.prev,d=e.strstart+L,f=c[a+s-1],p=c[a+s];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(c[(n=t)+s]===p&&c[n+s-1]===f&&c[n]===c[a]&&c[++n]===c[a+1]){a+=2,n++;do{}while(c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&a<d);if(r=L-(d-a),a=d-L,r>s){if(e.match_start=t,s=r,r>=o)break;f=c[a+s-1],p=c[a+s]}}}while((t=h[t&u])>l&&0!=--i);return s<=e.lookahead?s:e.lookahead}function ae(e){var t,n,i,a,s,o=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=o+(o-F)){r.arraySet(e.window,e.window,o,o,0),e.match_start-=o,e.strstart-=o,e.block_start-=o,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=o?i-o:0}while(--n);t=n=o;do{i=e.prev[--t],e.prev[t]=i>=o?i-o:0}while(--n);a+=o}if(0===e.strm.avail_in)break;if(n=re(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=n,e.lookahead+e.insert>=D)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+D-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<D)););}while(e.lookahead<F&&0!==e.strm.avail_in)}function se(e,t){for(var n,r;;){if(e.lookahead<F){if(ae(e),e.lookahead<F&&t===l)return X;if(0===e.lookahead)break}if(n=0,e.lookahead>=D&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+D-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-F&&(e.match_length=ie(e,n)),e.match_length>=D)if(r=i._tr_tally(e,e.strstart-e.match_start,e.match_length-D),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=D){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+D-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(ee(e,!1),0===e.strm.avail_out))return X}return e.insert=e.strstart<D-1?e.strstart:D-1,t===h?(ee(e,!0),0===e.strm.avail_out?j:Y):e.last_lit&&(ee(e,!1),0===e.strm.avail_out)?X:G}function oe(e,t){for(var n,r,a;;){if(e.lookahead<F){if(ae(e),e.lookahead<F&&t===l)return X;if(0===e.lookahead)break}if(n=0,e.lookahead>=D&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+D-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=D-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-F&&(e.match_length=ie(e,n),e.match_length<=5&&(e.strategy===S||e.match_length===D&&e.strstart-e.match_start>4096)&&(e.match_length=D-1)),e.prev_length>=D&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-D,r=i._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-D),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+D-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=D-1,e.strstart++,r&&(ee(e,!1),0===e.strm.avail_out))return X}else if(e.match_available){if((r=i._tr_tally(e,0,e.window[e.strstart-1]))&&ee(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return X}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=i._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<D-1?e.strstart:D-1,t===h?(ee(e,!0),0===e.strm.avail_out?j:Y):e.last_lit&&(ee(e,!1),0===e.strm.avail_out)?X:G}var le,ce=function(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i};function ue(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=C,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?N:U,e.adler=2===t.wrap?0:1,t.last_flush=l,i._tr_init(t),f):Z(e,m)}function he(e){var t=ue(e);return t===f&&function(e){e.window_size=2*e.w_size,Q(e.head),e.max_lazy_match=le[e.level].max_lazy,e.good_match=le[e.level].good_length,e.nice_match=le[e.level].nice_length,e.max_chain_length=le[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=D-1,e.match_available=0,e.ins_h=0}(e.state),t}function de(e,t,n,i,a,s){if(!e)return m;var o=1;if(t===b&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),a<1||a>k||n!==E||i<8||i>15||t<0||t>9||s<0||s>w)return Z(e,m);8===i&&(i=9);var l=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=E,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*M),this.dyn_dtree=new r.Buf16(2*(2*P+1)),this.bl_tree=new r.Buf16(2*(2*B+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(I+1),this.heap=new r.Buf16(2*A+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*A+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return e.state=l,l.strm=e,l.wrap=o,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+D-1)/D),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=l.lit_bufsize>>1,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=s,l.method=n,he(e)}le=[new ce(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(ae(e),0===e.lookahead&&t===l)return X;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,ee(e,!1),0===e.strm.avail_out))return X;if(e.strstart-e.block_start>=e.w_size-F&&(ee(e,!1),0===e.strm.avail_out))return X}return e.insert=0,t===h?(ee(e,!0),0===e.strm.avail_out?j:Y):(e.strstart>e.block_start&&(ee(e,!1),e.strm.avail_out),X)}),new ce(4,4,8,4,se),new ce(4,5,16,8,se),new ce(4,6,32,32,se),new ce(4,4,16,16,oe),new ce(8,16,32,32,oe),new ce(8,16,128,128,oe),new ce(8,32,128,256,oe),new ce(32,128,258,1024,oe),new ce(32,258,258,4096,oe)],n.deflateInit=function(e,t){return de(e,t,E,R,T,_)},n.deflateInit2=de,n.deflateReset=he,n.deflateResetKeep=ue,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?m:(e.state.gzhead=t,f):m},n.deflate=function(e,t){var n,r,a,o;if(!e||!e.state||t>d||t<0)return e?Z(e,m):m;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||r.status===H&&t!==h)return Z(e,0===e.avail_out?g:m);if(r.strm=e,n=r.last_flush,r.last_flush=t,r.status===N)if(2===r.wrap)e.adler=0,te(r,31),te(r,139),te(r,8),r.gzhead?(te(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),te(r,255&r.gzhead.time),te(r,r.gzhead.time>>8&255),te(r,r.gzhead.time>>16&255),te(r,r.gzhead.time>>24&255),te(r,9===r.level?2:r.strategy>=y||r.level<2?4:0),te(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(te(r,255&r.gzhead.extra.length),te(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=s(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=z):(te(r,0),te(r,0),te(r,0),te(r,0),te(r,0),te(r,9===r.level?2:r.strategy>=y||r.level<2?4:0),te(r,K),r.status=U);else{var v=E+(r.w_bits-8<<4)<<8;v|=(r.strategy>=y||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(v|=O),v+=31-v%31,r.status=U,ne(r,v),0!==r.strstart&&(ne(r,e.adler>>>16),ne(r,65535&e.adler)),e.adler=1}if(r.status===z)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),J(e),a=r.pending,r.pending!==r.pending_buf_size));)te(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=W)}else r.status=W;if(r.status===W)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),J(e),a=r.pending,r.pending===r.pending_buf_size)){o=1;break}o=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,te(r,o)}while(0!==o);r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),0===o&&(r.gzindex=0,r.status=V)}else r.status=V;if(r.status===V)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),J(e),a=r.pending,r.pending===r.pending_buf_size)){o=1;break}o=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,te(r,o)}while(0!==o);r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),0===o&&(r.status=$)}else r.status=$;if(r.status===$&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&J(e),r.pending+2<=r.pending_buf_size&&(te(r,255&e.adler),te(r,e.adler>>8&255),e.adler=0,r.status=U)):r.status=U),0!==r.pending){if(J(e),0===e.avail_out)return r.last_flush=-1,f}else if(0===e.avail_in&&q(t)<=q(n)&&t!==h)return Z(e,g);if(r.status===H&&0!==e.avail_in)return Z(e,g);if(0!==e.avail_in||0!==r.lookahead||t!==l&&r.status!==H){var b=r.strategy===y?function(e,t){for(var n;;){if(0===e.lookahead&&(ae(e),0===e.lookahead)){if(t===l)return X;break}if(e.match_length=0,n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(ee(e,!1),0===e.strm.avail_out))return X}return e.insert=0,t===h?(ee(e,!0),0===e.strm.avail_out?j:Y):e.last_lit&&(ee(e,!1),0===e.strm.avail_out)?X:G}(r,t):r.strategy===x?function(e,t){for(var n,r,a,s,o=e.window;;){if(e.lookahead<=L){if(ae(e),e.lookahead<=L&&t===l)return X;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=D&&e.strstart>0&&(r=o[a=e.strstart-1])===o[++a]&&r===o[++a]&&r===o[++a]){s=e.strstart+L;do{}while(r===o[++a]&&r===o[++a]&&r===o[++a]&&r===o[++a]&&r===o[++a]&&r===o[++a]&&r===o[++a]&&r===o[++a]&&a<s);e.match_length=L-(s-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=D?(n=i._tr_tally(e,1,e.match_length-D),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(ee(e,!1),0===e.strm.avail_out))return X}return e.insert=0,t===h?(ee(e,!0),0===e.strm.avail_out?j:Y):e.last_lit&&(ee(e,!1),0===e.strm.avail_out)?X:G}(r,t):le[r.level].func(r,t);if(b!==j&&b!==Y||(r.status=H),b===X||b===j)return 0===e.avail_out&&(r.last_flush=-1),f;if(b===G&&(t===c?i._tr_align(r):t!==d&&(i._tr_stored_block(r,0,0,!1),t===u&&(Q(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),J(e),0===e.avail_out))return r.last_flush=-1,f}return t!==h?f:r.wrap<=0?p:(2===r.wrap?(te(r,255&e.adler),te(r,e.adler>>8&255),te(r,e.adler>>16&255),te(r,e.adler>>24&255),te(r,255&e.total_in),te(r,e.total_in>>8&255),te(r,e.total_in>>16&255),te(r,e.total_in>>24&255)):(ne(r,e.adler>>>16),ne(r,65535&e.adler)),J(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?f:p)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==N&&t!==z&&t!==W&&t!==V&&t!==$&&t!==U&&t!==H?Z(e,m):(e.state=null,t===U?Z(e,v):f):m},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],34:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,i,a,s,o,l,c,u,h,d,f,p,m,v,g,b,S,y,x,w,_,C,E,k;n=e.state,r=e.next_in,E=e.input,i=r+(e.avail_in-5),a=e.next_out,k=e.output,s=a-(t-e.avail_out),o=a+(e.avail_out-257),l=n.dmax,c=n.wsize,u=n.whave,h=n.wnext,d=n.window,f=n.hold,p=n.bits,m=n.lencode,v=n.distcode,g=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;e:do{p<15&&(f+=E[r++]<<p,p+=8,f+=E[r++]<<p,p+=8),S=m[f&g];t:for(;;){if(f>>>=y=S>>>24,p-=y,0===(y=S>>>16&255))k[a++]=65535&S;else{if(!(16&y)){if(0==(64&y)){S=m[(65535&S)+(f&(1<<y)-1)];continue t}if(32&y){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}x=65535&S,(y&=15)&&(p<y&&(f+=E[r++]<<p,p+=8),x+=f&(1<<y)-1,f>>>=y,p-=y),p<15&&(f+=E[r++]<<p,p+=8,f+=E[r++]<<p,p+=8),S=v[f&b];n:for(;;){if(f>>>=y=S>>>24,p-=y,!(16&(y=S>>>16&255))){if(0==(64&y)){S=v[(65535&S)+(f&(1<<y)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(w=65535&S,p<(y&=15)&&(f+=E[r++]<<p,(p+=8)<y&&(f+=E[r++]<<p,p+=8)),(w+=f&(1<<y)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=y,p-=y,w>(y=a-s)){if((y=w-y)>u&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(_=0,C=d,0===h){if(_+=c-y,y<x){x-=y;do{k[a++]=d[_++]}while(--y);_=a-w,C=k}}else if(h<y){if(_+=c+h-y,(y-=h)<x){x-=y;do{k[a++]=d[_++]}while(--y);if(_=0,h<x){x-=y=h;do{k[a++]=d[_++]}while(--y);_=a-w,C=k}}}else if(_+=h-y,y<x){x-=y;do{k[a++]=d[_++]}while(--y);_=a-w,C=k}for(;x>2;)k[a++]=C[_++],k[a++]=C[_++],k[a++]=C[_++],x-=3;x&&(k[a++]=C[_++],x>1&&(k[a++]=C[_++]))}else{_=a-w;do{k[a++]=k[_++],k[a++]=k[_++],k[a++]=k[_++],x-=3}while(x>2);x&&(k[a++]=k[_++],x>1&&(k[a++]=k[_++]))}break}}break}}while(r<i&&a<o);r-=x=p>>3,f&=(1<<(p-=x<<3))-1,e.next_in=r,e.next_out=a,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=a<o?o-a+257:257-(a-o),n.hold=f,n.bits=p}},{}],35:[function(e,t,n){"use strict";var r=e("../utils/common"),i=e("./adler32"),a=e("./crc32"),s=e("./inffast"),o=e("./inftrees"),l=0,c=1,u=2,h=4,d=5,f=6,p=0,m=1,v=2,g=-2,b=-3,S=-4,y=-5,x=8,w=1,_=2,C=3,E=4,k=5,R=6,T=7,A=8,P=9,B=10,M=11,I=12,D=13,L=14,F=15,O=16,N=17,z=18,W=19,V=20,$=21,U=22,H=23,X=24,G=25,j=26,Y=27,K=28,Z=29,q=30,Q=31,J=32,ee=852,te=592,ne=15;function re(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function ie(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ae(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=w,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(ee),t.distcode=t.distdyn=new r.Buf32(te),t.sane=1,t.back=-1,p):g}function se(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,ae(e)):g}function oe(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?g:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,se(e))):g}function le(e,t){var n,r;return e?(r=new ie,e.state=r,r.window=null,(n=oe(e,t))!==p&&(e.state=null),n):g}var ce,ue,he=!0;function de(e){if(he){var t;for(ce=new r.Buf32(512),ue=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(c,e.lens,0,288,ce,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(u,e.lens,0,32,ue,0,e.work,{bits:5}),he=!1}e.lencode=ce,e.lenbits=9,e.distcode=ue,e.distbits=5}n.inflateReset=se,n.inflateReset2=oe,n.inflateResetKeep=ae,n.inflateInit=function(e){return le(e,ne)},n.inflateInit2=le,n.inflate=function(e,t){var n,ee,te,ne,ie,ae,se,oe,le,ce,ue,he,fe,pe,me,ve,ge,be,Se,ye,xe,we,_e,Ce,Ee=0,ke=new r.Buf8(4),Re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return g;(n=e.state).mode===I&&(n.mode=D),ie=e.next_out,te=e.output,se=e.avail_out,ne=e.next_in,ee=e.input,ae=e.avail_in,oe=n.hold,le=n.bits,ce=ae,ue=se,we=p;e:for(;;)switch(n.mode){case w:if(0===n.wrap){n.mode=D;break}for(;le<16;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}if(2&n.wrap&&35615===oe){n.check=0,ke[0]=255&oe,ke[1]=oe>>>8&255,n.check=a(n.check,ke,2,0),oe=0,le=0,n.mode=_;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&oe)<<8)+(oe>>8))%31){e.msg="incorrect header check",n.mode=q;break}if((15&oe)!==x){e.msg="unknown compression method",n.mode=q;break}if(le-=4,xe=8+(15&(oe>>>=4)),0===n.wbits)n.wbits=xe;else if(xe>n.wbits){e.msg="invalid window size",n.mode=q;break}n.dmax=1<<xe,e.adler=n.check=1,n.mode=512&oe?B:I,oe=0,le=0;break;case _:for(;le<16;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}if(n.flags=oe,(255&n.flags)!==x){e.msg="unknown compression method",n.mode=q;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=q;break}n.head&&(n.head.text=oe>>8&1),512&n.flags&&(ke[0]=255&oe,ke[1]=oe>>>8&255,n.check=a(n.check,ke,2,0)),oe=0,le=0,n.mode=C;case C:for(;le<32;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}n.head&&(n.head.time=oe),512&n.flags&&(ke[0]=255&oe,ke[1]=oe>>>8&255,ke[2]=oe>>>16&255,ke[3]=oe>>>24&255,n.check=a(n.check,ke,4,0)),oe=0,le=0,n.mode=E;case E:for(;le<16;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}n.head&&(n.head.xflags=255&oe,n.head.os=oe>>8),512&n.flags&&(ke[0]=255&oe,ke[1]=oe>>>8&255,n.check=a(n.check,ke,2,0)),oe=0,le=0,n.mode=k;case k:if(1024&n.flags){for(;le<16;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}n.length=oe,n.head&&(n.head.extra_len=oe),512&n.flags&&(ke[0]=255&oe,ke[1]=oe>>>8&255,n.check=a(n.check,ke,2,0)),oe=0,le=0}else n.head&&(n.head.extra=null);n.mode=R;case R:if(1024&n.flags&&((he=n.length)>ae&&(he=ae),he&&(n.head&&(xe=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,ee,ne,he,xe)),512&n.flags&&(n.check=a(n.check,ee,he,ne)),ae-=he,ne+=he,n.length-=he),n.length))break e;n.length=0,n.mode=T;case T:if(2048&n.flags){if(0===ae)break e;he=0;do{xe=ee[ne+he++],n.head&&xe&&n.length<65536&&(n.head.name+=String.fromCharCode(xe))}while(xe&&he<ae);if(512&n.flags&&(n.check=a(n.check,ee,he,ne)),ae-=he,ne+=he,xe)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=A;case A:if(4096&n.flags){if(0===ae)break e;he=0;do{xe=ee[ne+he++],n.head&&xe&&n.length<65536&&(n.head.comment+=String.fromCharCode(xe))}while(xe&&he<ae);if(512&n.flags&&(n.check=a(n.check,ee,he,ne)),ae-=he,ne+=he,xe)break e}else n.head&&(n.head.comment=null);n.mode=P;case P:if(512&n.flags){for(;le<16;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}if(oe!==(65535&n.check)){e.msg="header crc mismatch",n.mode=q;break}oe=0,le=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=I;break;case B:for(;le<32;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}e.adler=n.check=re(oe),oe=0,le=0,n.mode=M;case M:if(0===n.havedict)return e.next_out=ie,e.avail_out=se,e.next_in=ne,e.avail_in=ae,n.hold=oe,n.bits=le,v;e.adler=n.check=1,n.mode=I;case I:if(t===d||t===f)break e;case D:if(n.last){oe>>>=7&le,le-=7&le,n.mode=Y;break}for(;le<3;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}switch(n.last=1&oe,le-=1,3&(oe>>>=1)){case 0:n.mode=L;break;case 1:if(de(n),n.mode=V,t===f){oe>>>=2,le-=2;break e}break;case 2:n.mode=N;break;case 3:e.msg="invalid block type",n.mode=q}oe>>>=2,le-=2;break;case L:for(oe>>>=7&le,le-=7&le;le<32;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}if((65535&oe)!=(oe>>>16^65535)){e.msg="invalid stored block lengths",n.mode=q;break}if(n.length=65535&oe,oe=0,le=0,n.mode=F,t===f)break e;case F:n.mode=O;case O:if(he=n.length){if(he>ae&&(he=ae),he>se&&(he=se),0===he)break e;r.arraySet(te,ee,ne,he,ie),ae-=he,ne+=he,se-=he,ie+=he,n.length-=he;break}n.mode=I;break;case N:for(;le<14;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}if(n.nlen=257+(31&oe),oe>>>=5,le-=5,n.ndist=1+(31&oe),oe>>>=5,le-=5,n.ncode=4+(15&oe),oe>>>=4,le-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=q;break}n.have=0,n.mode=z;case z:for(;n.have<n.ncode;){for(;le<3;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}n.lens[Re[n.have++]]=7&oe,oe>>>=3,le-=3}for(;n.have<19;)n.lens[Re[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,_e={bits:n.lenbits},we=o(l,n.lens,0,19,n.lencode,0,n.work,_e),n.lenbits=_e.bits,we){e.msg="invalid code lengths set",n.mode=q;break}n.have=0,n.mode=W;case W:for(;n.have<n.nlen+n.ndist;){for(;ve=(Ee=n.lencode[oe&(1<<n.lenbits)-1])>>>16&255,ge=65535&Ee,!((me=Ee>>>24)<=le);){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}if(ge<16)oe>>>=me,le-=me,n.lens[n.have++]=ge;else{if(16===ge){for(Ce=me+2;le<Ce;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}if(oe>>>=me,le-=me,0===n.have){e.msg="invalid bit length repeat",n.mode=q;break}xe=n.lens[n.have-1],he=3+(3&oe),oe>>>=2,le-=2}else if(17===ge){for(Ce=me+3;le<Ce;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}le-=me,xe=0,he=3+(7&(oe>>>=me)),oe>>>=3,le-=3}else{for(Ce=me+7;le<Ce;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}le-=me,xe=0,he=11+(127&(oe>>>=me)),oe>>>=7,le-=7}if(n.have+he>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=q;break}for(;he--;)n.lens[n.have++]=xe}}if(n.mode===q)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=q;break}if(n.lenbits=9,_e={bits:n.lenbits},we=o(c,n.lens,0,n.nlen,n.lencode,0,n.work,_e),n.lenbits=_e.bits,we){e.msg="invalid literal/lengths set",n.mode=q;break}if(n.distbits=6,n.distcode=n.distdyn,_e={bits:n.distbits},we=o(u,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,_e),n.distbits=_e.bits,we){e.msg="invalid distances set",n.mode=q;break}if(n.mode=V,t===f)break e;case V:n.mode=$;case $:if(ae>=6&&se>=258){e.next_out=ie,e.avail_out=se,e.next_in=ne,e.avail_in=ae,n.hold=oe,n.bits=le,s(e,ue),ie=e.next_out,te=e.output,se=e.avail_out,ne=e.next_in,ee=e.input,ae=e.avail_in,oe=n.hold,le=n.bits,n.mode===I&&(n.back=-1);break}for(n.back=0;ve=(Ee=n.lencode[oe&(1<<n.lenbits)-1])>>>16&255,ge=65535&Ee,!((me=Ee>>>24)<=le);){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}if(ve&&0==(240&ve)){for(be=me,Se=ve,ye=ge;ve=(Ee=n.lencode[ye+((oe&(1<<be+Se)-1)>>be)])>>>16&255,ge=65535&Ee,!(be+(me=Ee>>>24)<=le);){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}oe>>>=be,le-=be,n.back+=be}if(oe>>>=me,le-=me,n.back+=me,n.length=ge,0===ve){n.mode=j;break}if(32&ve){n.back=-1,n.mode=I;break}if(64&ve){e.msg="invalid literal/length code",n.mode=q;break}n.extra=15&ve,n.mode=U;case U:if(n.extra){for(Ce=n.extra;le<Ce;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}n.length+=oe&(1<<n.extra)-1,oe>>>=n.extra,le-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=H;case H:for(;ve=(Ee=n.distcode[oe&(1<<n.distbits)-1])>>>16&255,ge=65535&Ee,!((me=Ee>>>24)<=le);){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}if(0==(240&ve)){for(be=me,Se=ve,ye=ge;ve=(Ee=n.distcode[ye+((oe&(1<<be+Se)-1)>>be)])>>>16&255,ge=65535&Ee,!(be+(me=Ee>>>24)<=le);){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}oe>>>=be,le-=be,n.back+=be}if(oe>>>=me,le-=me,n.back+=me,64&ve){e.msg="invalid distance code",n.mode=q;break}n.offset=ge,n.extra=15&ve,n.mode=X;case X:if(n.extra){for(Ce=n.extra;le<Ce;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}n.offset+=oe&(1<<n.extra)-1,oe>>>=n.extra,le-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=q;break}n.mode=G;case G:if(0===se)break e;if(he=ue-se,n.offset>he){if((he=n.offset-he)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=q;break}he>n.wnext?(he-=n.wnext,fe=n.wsize-he):fe=n.wnext-he,he>n.length&&(he=n.length),pe=n.window}else pe=te,fe=ie-n.offset,he=n.length;he>se&&(he=se),se-=he,n.length-=he;do{te[ie++]=pe[fe++]}while(--he);0===n.length&&(n.mode=$);break;case j:if(0===se)break e;te[ie++]=n.length,se--,n.mode=$;break;case Y:if(n.wrap){for(;le<32;){if(0===ae)break e;ae--,oe|=ee[ne++]<<le,le+=8}if(ue-=se,e.total_out+=ue,n.total+=ue,ue&&(e.adler=n.check=n.flags?a(n.check,te,ue,ie-ue):i(n.check,te,ue,ie-ue)),ue=se,(n.flags?oe:re(oe))!==n.check){e.msg="incorrect data check",n.mode=q;break}oe=0,le=0}n.mode=K;case K:if(n.wrap&&n.flags){for(;le<32;){if(0===ae)break e;ae--,oe+=ee[ne++]<<le,le+=8}if(oe!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=q;break}oe=0,le=0}n.mode=Z;case Z:we=m;break e;case q:we=b;break e;case Q:return S;case J:default:return g}return e.next_out=ie,e.avail_out=se,e.next_in=ne,e.avail_in=ae,n.hold=oe,n.bits=le,(n.wsize||ue!==e.avail_out&&n.mode<q&&(n.mode<Y||t!==h))&&function(e,t,n,i){var a,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new r.Buf8(s.wsize)),i>=s.wsize?(r.arraySet(s.window,t,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((a=s.wsize-s.wnext)>i&&(a=i),r.arraySet(s.window,t,n-i,a,s.wnext),(i-=a)?(r.arraySet(s.window,t,n-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0}(e,e.output,e.next_out,ue-e.avail_out)?(n.mode=Q,S):(ce-=e.avail_in,ue-=e.avail_out,e.total_in+=ce,e.total_out+=ue,n.total+=ue,n.wrap&&ue&&(e.adler=n.check=n.flags?a(n.check,te,ue,e.next_out-ue):i(n.check,te,ue,e.next_out-ue)),e.data_type=n.bits+(n.last?64:0)+(n.mode===I?128:0)+(n.mode===V||n.mode===F?256:0),(0===ce&&0===ue||t===h)&&we===p&&(we=y),we)},n.inflateEnd=function(e){if(!e||!e.state)return g;var t=e.state;return t.window&&(t.window=null),e.state=null,p},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?g:(n.head=t,t.done=!1,p):g},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(e,t,n){"use strict";var r=e("../utils/common"),i=15,a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,c,u,h,d,f){var p,m,v,g,b,S,y,x,w,_=f.bits,C=0,E=0,k=0,R=0,T=0,A=0,P=0,B=0,M=0,I=0,D=null,L=0,F=new r.Buf16(16),O=new r.Buf16(16),N=null,z=0;for(C=0;C<=i;C++)F[C]=0;for(E=0;E<c;E++)F[t[n+E]]++;for(T=_,R=i;R>=1&&0===F[R];R--);if(T>R&&(T=R),0===R)return u[h++]=20971520,u[h++]=20971520,f.bits=1,0;for(k=1;k<R&&0===F[k];k++);for(T<k&&(T=k),B=1,C=1;C<=i;C++)if(B<<=1,(B-=F[C])<0)return-1;if(B>0&&(0===e||1!==R))return-1;for(O[1]=0,C=1;C<i;C++)O[C+1]=O[C]+F[C];for(E=0;E<c;E++)0!==t[n+E]&&(d[O[t[n+E]]++]=E);if(0===e?(D=N=d,S=19):1===e?(D=a,L-=257,N=s,z-=257,S=256):(D=o,N=l,S=-1),I=0,E=0,C=k,b=h,A=T,P=0,v=-1,g=(M=1<<T)-1,1===e&&M>852||2===e&&M>592)return 1;for(;;){0,y=C-P,d[E]<S?(x=0,w=d[E]):d[E]>S?(x=N[z+d[E]],w=D[L+d[E]]):(x=96,w=0),p=1<<C-P,k=m=1<<A;do{u[b+(I>>P)+(m-=p)]=y<<24|x<<16|w|0}while(0!==m);for(p=1<<C-1;I&p;)p>>=1;if(0!==p?(I&=p-1,I+=p):I=0,E++,0==--F[C]){if(C===R)break;C=t[n+d[E]]}if(C>T&&(I&g)!==v){for(0===P&&(P=T),b+=k,B=1<<(A=C-P);A+P<R&&!((B-=F[A+P])<=0);)A++,B<<=1;if(M+=1<<A,1===e&&M>852||2===e&&M>592)return 1;u[v=I&g]=T<<24|A<<16|b-h|0}}return 0!==I&&(u[b+I]=C-P<<24|64<<16|0),f.bits=T,0}},{"../utils/common":27}],37:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(e,t,n){"use strict";var r=e("../utils/common"),i=4,a=0,s=1,o=2;function l(e){for(var t=e.length;--t>=0;)e[t]=0}var c=0,u=1,h=2,d=29,f=256,p=f+1+d,m=30,v=19,g=2*p+1,b=15,S=16,y=7,x=256,w=16,_=17,C=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],k=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],A=new Array(2*(p+2));l(A);var P=new Array(2*m);l(P);var B=new Array(512);l(B);var M=new Array(256);l(M);var I=new Array(d);l(I);var D=new Array(m);l(D);var L,F,O,N=function(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length},z=function(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t};function W(e){return e<256?B[e]:B[256+(e>>>7)]}function V(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function $(e,t,n){e.bi_valid>S-n?(e.bi_buf|=t<<e.bi_valid&65535,V(e,e.bi_buf),e.bi_buf=t>>S-e.bi_valid,e.bi_valid+=n-S):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function U(e,t,n){$(e,n[2*t],n[2*t+1])}function H(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function X(e,t,n){var r,i,a=new Array(b+1),s=0;for(r=1;r<=b;r++)a[r]=s=s+n[r-1]<<1;for(i=0;i<=t;i++){var o=e[2*i+1];0!==o&&(e[2*i]=H(a[o]++,o))}}function G(e){var t;for(t=0;t<p;t++)e.dyn_ltree[2*t]=0;for(t=0;t<m;t++)e.dyn_dtree[2*t]=0;for(t=0;t<v;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*x]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function j(e){e.bi_valid>8?V(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Y(e,t,n,i){j(e),i&&(V(e,n),V(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}function K(e,t,n,r){var i=2*t,a=2*n;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]}function Z(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&K(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!K(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function q(e,t,n){var r,i,a,s,o=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],i=e.pending_buf[e.l_buf+o],o++,0===r?U(e,i,t):(U(e,(a=M[i])+f+1,t),0!==(s=E[a])&&$(e,i-=I[a],s),U(e,a=W(--r),n),0!==(s=k[a])&&$(e,r-=D[a],s))}while(o<e.last_lit);U(e,x,t)}function Q(e,t){var n,r,i,a=t.dyn_tree,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=g,n=0;n<l;n++)0!==a[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,o&&(e.static_len-=s[2*i+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)Z(e,a,n);i=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Z(e,a,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,a[2*i]=a[2*n]+a[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,a[2*n+1]=a[2*r+1]=i,e.heap[1]=i++,Z(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,a,s,o,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(a=0;a<=b;a++)e.bl_count[a]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<g;n++)(a=l[2*l[2*(r=e.heap[n])+1]+1]+1)>p&&(a=p,m++),l[2*r+1]=a,r>c||(e.bl_count[a]++,s=0,r>=f&&(s=d[r-f]),o=l[2*r],e.opt_len+=o*(a+s),h&&(e.static_len+=o*(u[2*r+1]+s)));if(0!==m){do{for(a=p-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(a=p;0!==a;a--)for(r=e.bl_count[a];0!==r;)(i=e.heap[--n])>c||(l[2*i+1]!==a&&(e.opt_len+=(a-l[2*i+1])*l[2*i],l[2*i+1]=a),r--)}}(e,t),X(a,c,e.bl_count)}function J(e,t,n){var r,i,a=-1,s=t[1],o=0,l=7,c=4;for(0===s&&(l=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=t[2*(r+1)+1],++o<l&&i===s||(o<c?e.bl_tree[2*i]+=o:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[2*w]++):o<=10?e.bl_tree[2*_]++:e.bl_tree[2*C]++,o=0,a=i,0===s?(l=138,c=3):i===s?(l=6,c=3):(l=7,c=4))}function ee(e,t,n){var r,i,a=-1,s=t[1],o=0,l=7,c=4;for(0===s&&(l=138,c=3),r=0;r<=n;r++)if(i=s,s=t[2*(r+1)+1],!(++o<l&&i===s)){if(o<c)do{U(e,i,e.bl_tree)}while(0!=--o);else 0!==i?(i!==a&&(U(e,i,e.bl_tree),o--),U(e,w,e.bl_tree),$(e,o-3,2)):o<=10?(U(e,_,e.bl_tree),$(e,o-3,3)):(U(e,C,e.bl_tree),$(e,o-11,7));o=0,a=i,0===s?(l=138,c=3):i===s?(l=6,c=3):(l=7,c=4)}}function te(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return a;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return s;for(t=32;t<f;t++)if(0!==e.dyn_ltree[2*t])return s;return a}var ne=!1;function re(e,t,n,r){$(e,(c<<1)+(r?1:0),3),Y(e,t,n,!0)}n._tr_init=function(e){ne||(function(){var e,t,n,r,i,a=new Array(b+1);for(n=0,r=0;r<d-1;r++)for(I[r]=n,e=0;e<1<<E[r];e++)M[n++]=r;for(M[n-1]=r,i=0,r=0;r<16;r++)for(D[r]=i,e=0;e<1<<k[r];e++)B[i++]=r;for(i>>=7;r<m;r++)for(D[r]=i<<7,e=0;e<1<<k[r]-7;e++)B[256+i++]=r;for(t=0;t<=b;t++)a[t]=0;for(e=0;e<=143;)A[2*e+1]=8,e++,a[8]++;for(;e<=255;)A[2*e+1]=9,e++,a[9]++;for(;e<=279;)A[2*e+1]=7,e++,a[7]++;for(;e<=287;)A[2*e+1]=8,e++,a[8]++;for(X(A,p+1,a),e=0;e<m;e++)P[2*e+1]=5,P[2*e]=H(e,5);L=new N(A,E,f+1,p,b),F=new N(P,k,0,m,b),O=new N(new Array(0),R,0,v,y)}(),ne=!0),e.l_desc=new z(e.dyn_ltree,L),e.d_desc=new z(e.dyn_dtree,F),e.bl_desc=new z(e.bl_tree,O),e.bi_buf=0,e.bi_valid=0,G(e)},n._tr_stored_block=re,n._tr_flush_block=function(e,t,n,r){var a,s,l=0;e.level>0?(e.strm.data_type===o&&(e.strm.data_type=te(e)),Q(e,e.l_desc),Q(e,e.d_desc),l=function(e){var t;for(J(e,e.dyn_ltree,e.l_desc.max_code),J(e,e.dyn_dtree,e.d_desc.max_code),Q(e,e.bl_desc),t=v-1;t>=3&&0===e.bl_tree[2*T[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),a=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=a&&(a=s)):a=s=n+5,n+4<=a&&-1!==t?re(e,t,n,r):e.strategy===i||s===a?($(e,(u<<1)+(r?1:0),3),q(e,A,P)):($(e,(h<<1)+(r?1:0),3),function(e,t,n,r){var i;for($(e,t-257,5),$(e,n-1,5),$(e,r-4,4),i=0;i<r;i++)$(e,e.bl_tree[2*T[i]+1],3);ee(e,e.dyn_ltree,t-1),ee(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),q(e,e.dyn_ltree,e.dyn_dtree)),G(e),r&&j(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(M[n]+f+1)]++,e.dyn_dtree[2*W(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){$(e,u<<1,3),U(e,x,A),function(e){16===e.bi_valid?(V(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":27}],39:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}]},{},[9])(9)});var XLSX={};function make_xlsx_lib(e){e.version="0.15.5";var t=1200,n=1252;"undefined"!=typeof module&&"undefined"!=typeof require&&"undefined"==typeof cptable&&("undefined"!=typeof global?global.cptable=void 0:"undefined"!=typeof window&&(window.cptable=void 0));for(var r=[874,932,936,949,950],i=0;i<=8;++i)r.push(1250+i);var a={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},s=function(e){-1!=r.indexOf(e)&&(n=a[0]=e)};var o=function(e){t=e,s(e)};function l(){o(1200),s(1252)}function c(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}var u=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return 255==t&&254==n?function(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==n?function(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}(e.slice(2)):65279==t?e.slice(1):e},h=function(e){return String.fromCharCode(e)},d=function(e){return String.fromCharCode(e)};"undefined"!=typeof cptable&&(o=function(e){t=e,s(e)},u=function(e){return 255===e.charCodeAt(0)&&254===e.charCodeAt(1)?cptable.utils.decode(1200,c(e.slice(2))):e},h=function(e){return 1200===t?String.fromCharCode(e):cptable.utils.decode(t,[255&e,e>>8])[0]},d=function(e){return cptable.utils.decode(n,[e])[0]});var f=null,p=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(t){for(var n="",r=0,i=0,a=0,s=0,o=0,l=0,c=0,u=0;u<t.length;)s=(r=t.charCodeAt(u++))>>2,o=(3&r)<<4|(i=t.charCodeAt(u++))>>4,l=(15&i)<<2|(a=t.charCodeAt(u++))>>6,c=63&a,isNaN(i)?l=c=64:isNaN(a)&&(c=64),n+=e.charAt(s)+e.charAt(o)+e.charAt(l)+e.charAt(c);return n},decode:function(t){var n="",r=0,i=0,a=0,s=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)r=e.indexOf(t.charAt(c++))<<2|(s=e.indexOf(t.charAt(c++)))>>4,n+=String.fromCharCode(r),i=(15&s)<<4|(o=e.indexOf(t.charAt(c++)))>>2,64!==o&&(n+=String.fromCharCode(i)),a=(3&o)<<6|(l=e.indexOf(t.charAt(c++))),64!==l&&(n+=String.fromCharCode(a));return n}}}(),m="undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node,v=function(){};if("undefined"!=typeof Buffer){var g=!Buffer.from;if(!g)try{Buffer.from("foo","utf8")}catch(e){g=!0}v=g?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer),Buffer.alloc||(Buffer.alloc=function(e){return new Buffer(e)}),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(e){return new Buffer(e)})}function b(e){return m?Buffer.alloc(e):new Array(e)}function S(e){return m?Buffer.allocUnsafe(e):new Array(e)}var y=function(e){return m?v(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function x(e){if("undefined"==typeof ArrayBuffer)return y(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function w(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function _(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return _(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var C=function(e){return[].concat.apply([],e)},E=/\u0000/g,k=/[\u0001-\u0006]/g,R={},T=function(e){function t(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function n(e,t){for(var n="";n.length<t;)n+=e;return n}function r(e,t){var r=""+e;return r.length>=t?r:n("0",t-r.length)+r}function i(e,t){var r=""+e;return r.length>=t?r:n(" ",t-r.length)+r}function a(e,t){var r=""+e;return r.length>=t?r:r+n(" ",t-r.length)}function s(e,t){var r=""+Math.round(e);return r.length>=t?r:n("0",t-r.length)+r}function o(e,t){var r=""+e;return r.length>=t?r:n("0",t-r.length)+r}e.version="0.10.2";var l=Math.pow(2,32);function c(e,t){return e>l||e<-l?s(e,t):o(Math.round(e),t)}function u(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var h=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],d=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function f(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e[65535]="General"}var p={};function m(e,t,n){for(var r=e<0?-1:1,i=e*r,a=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(i);c<t&&(o=(h=Math.floor(i))*s+a,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),a=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=a):(u=c,o=s)),!n)return[0,r*o,u];var d=Math.floor(r*o/u);return[d,r*o-d*u,u]}function v(e,t,n){if(e>2958465||e<0)return null;var r=0|e,i=Math.floor(86400*(e-r)),a=0,s=[],o={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++i&&(o.T=i=0,++r,++o.D)),60===r)s=n?[1317,10,29]:[1900,2,29],a=3;else if(0===r)s=n?[1317,8,29]:[1900,1,0],a=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),r<60&&(a=(a+6)%7),n&&(a=0)}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}f(p),e.parse_date_code=v;var g=new Date(1899,11,31,0,0,0),b=g.getTime(),S=new Date(1900,2,1,0,0,0);function y(e,t){var n=e.getTime();return t?n-=1262304e5:e>=S&&(n+=864e5),(n-(b+6e4*(e.getTimezoneOffset()-g.getTimezoneOffset())))/864e5}function x(e){return e.toString(10)}e._general_int=x;var w=function(){var e=/\.(\d*[1-9])0+$/,t=/\.0*$/,n=/\.(\d*[1-9])0+/,r=/\.0*[Ee]/,i=/(E[+-])(\d)$/;function a(t){var n=t.toFixed(11).replace(e,".$1");return n.length>(t<0?12:11)&&(n=t.toPrecision(6)),n}function s(e){for(var t=0;t!=e.length;++t)if(101==(32|e.charCodeAt(t)))return e.replace(n,".$1").replace(r,"E").replace("e","E").replace(i,"$10$2");return e}function o(n){return n.indexOf(".")>-1?n.replace(t,"").replace(e,".$1"):n}return function(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return o(s(t>=-4&&t<=-1?e.toPrecision(10+t):Math.abs(t)<=9?function(e){var t=e<0?12:11,n=o(e.toFixed(12));return n.length<=t?n:(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===t?e.toFixed(10).substr(0,12):a(e)))}}();function _(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?x(e):w(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return D(14,y(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function C(e,t,n,i){var a,s="",o=0,l=0,c=n.y,u=0;switch(e){case 98:c=n.y+543;case 121:switch(t.length){case 1:case 2:a=c%100,u=2;break;default:a=c%1e4,u=4}break;case 109:switch(t.length){case 1:case 2:a=n.m,u=t.length;break;case 3:return d[n.m-1][1];case 5:return d[n.m-1][0];default:return d[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=n.d,u=t.length;break;case 3:return h[n.q][0];default:return h[n.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(n.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=n.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=n.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(l=i>=2?3===i?1e3:100:1===i?10:1,(o=Math.round(l*(n.S+n.u)))>=60*l&&(o=0),"s"===t?0===o?"0":""+o/l:(s=r(o,2+i),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):r(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*n.D+n.H;break;case"[m]":case"[mm]":a=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":a=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}u=3===t.length?1:2;break;case 101:a=c,u=1}return u>0?r(a,u):""}function E(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}e._general_num=w,e._general=_;var k=function(){var e=/%/g;function s(t,r,i){var a=r.replace(e,""),s=r.length-a.length;return k(t,a,i*Math.pow(10,2*s))+n("%",s)}var o=/# (\?+)( ?)\/( ?)(\d+)/;var l=/^#*0*\.([0#]+)/,u=/\).*[0#]/,h=/\(###\) ###\\?-####/;function d(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function f(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function p(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?0:Math.round((e-Math.floor(e))*Math.pow(10,t))}function v(e,g,b){if(40===e.charCodeAt(0)&&!g.match(u)){var S=g.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return b>=0?v("n",S,b):"("+v("n",S,-b)+")"}if(44===g.charCodeAt(g.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return k(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,g,b);if(-1!==g.indexOf("%"))return s(e,g,b);if(-1!==g.indexOf("E"))return function e(t,n){var r,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==n)return"0.0E+0";if(n<0)return"-"+e(t,-n);var a=t.indexOf(".");-1===a&&(a=t.indexOf("E"));var s=Math.floor(Math.log(n)*Math.LOG10E)%a;if(s<0&&(s+=a),-1===(r=(n/Math.pow(10,s)).toPrecision(i+1+(a+s)%a)).indexOf("e")){var o=Math.floor(Math.log(n)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(a+s)%a)+"."+r.substr(s)+"E"})}else r=n.toExponential(i);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}(g,b);if(36===g.charCodeAt(0))return"$"+v(e,g.substr(" "==g.charAt(1)?2:1),b);var y,x,w,_,C=Math.abs(b),R=b<0?"-":"";if(g.match(/^00+$/))return R+c(C,g.length);if(g.match(/^[#?]+$/))return"0"===(y=c(b,0))&&(y=""),y.length>g.length?y:d(g.substr(0,g.length-y.length))+y;if(x=g.match(o))return function(e,t,a){var s=parseInt(e[4],10),o=Math.round(t*s),l=Math.floor(o/s),c=o-l*s,u=s;return a+(0===l?"":""+l)+" "+(0===c?n(" ",e[1].length+1+e[4].length):i(c,e[1].length)+e[2]+"/"+e[3]+r(u,e[4].length))}(x,C,R);if(g.match(/^#+0+$/))return R+c(C,g.length-g.indexOf("0"));if(x=g.match(l))return y=f(b,x[1].length).replace(/^([^\.]+)$/,"$1."+d(x[1])).replace(/\.$/,"."+d(x[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+n("0",d(x[1]).length-t.length)}),-1!==g.indexOf("0.")?y:y.replace(/^0\./,".");if(g=g.replace(/^#+([0.])/,"$1"),x=g.match(/^(0*)\.(#*)$/))return R+f(C,x[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,x[1].length?"0.":".");if(x=g.match(/^#{1,3},##0(\.?)$/))return R+E(c(C,0));if(x=g.match(/^#,##0\.([#0]*0)$/))return b<0?"-"+v(e,g,-b):E(""+(Math.floor(b)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(b,x[1].length)))+"."+r(p(b,x[1].length),x[1].length);if(x=g.match(/^#,#*,#0/))return v(e,g.replace(/^#,#*,/,""),b);if(x=g.match(/^([0#]+)(\\?-([0#]+))+$/))return y=t(v(e,g.replace(/[\\-]/g,""),b)),w=0,t(t(g.replace(/\\/g,"")).replace(/[0#]/g,function(e){return w<y.length?y.charAt(w++):"0"===e?"0":""}));if(g.match(h))return"("+(y=v(e,"##########",b)).substr(0,3)+") "+y.substr(3,3)+"-"+y.substr(6);var T="";if(x=g.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return w=Math.min(x[4].length,7),_=m(C,Math.pow(10,w)-1,!1),y=""+R," "==(T=k("n",x[1],_[1])).charAt(T.length-1)&&(T=T.substr(0,T.length-1)+"0"),y+=T+x[2]+"/"+x[3],(T=a(_[2],w)).length<x[4].length&&(T=d(x[4].substr(x[4].length-T.length))+T),y+=T;if(x=g.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return w=Math.min(Math.max(x[1].length,x[4].length),7),R+((_=m(C,Math.pow(10,w)-1,!0))[0]||(_[1]?"":"0"))+" "+(_[1]?i(_[1],w)+x[2]+"/"+x[3]+a(_[2],w):n(" ",2*w+1+x[2].length+x[3].length));if(x=g.match(/^[#0?]+$/))return y=c(b,0),g.length<=y.length?y:d(g.substr(0,g.length-y.length))+y;if(x=g.match(/^([#0?]+)\.([#0]+)$/)){y=""+b.toFixed(Math.min(x[2].length,10)).replace(/([^0])0+$/,"$1"),w=y.indexOf(".");var A=g.indexOf(".")-w,P=g.length-y.length-A;return d(g.substr(0,A)+y+g.substr(g.length-P))}if(x=g.match(/^00,000\.([#0]*0)$/))return w=p(b,x[1].length),b<0?"-"+v(e,g,-b):E(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(b)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?r(0,3-e.length):"")+e})+"."+r(w,x[1].length);switch(g){case"###,##0.00":return v(e,"#,##0.00",b);case"###,###":case"##,###":case"#,###":var B=E(c(C,0));return"0"!==B?R+B:"";case"###,###.00":return v(e,"###,##0.00",b).replace(/^0\./,".");case"#,###.00":return v(e,"#,##0.00",b).replace(/^0\./,".")}throw new Error("unsupported format |"+g+"|")}function g(t,r,i){var a=r.replace(e,""),s=r.length-a.length;return k(t,a,i*Math.pow(10,2*s))+n("%",s)}function b(e,s,c){if(40===e.charCodeAt(0)&&!s.match(u)){var f=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return c>=0?b("n",f,c):"("+b("n",f,-c)+")"}if(44===s.charCodeAt(s.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return k(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,s,c);if(-1!==s.indexOf("%"))return g(e,s,c);if(-1!==s.indexOf("E"))return function e(t,n){var r,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==n)return"0.0E+0";if(n<0)return"-"+e(t,-n);var a=t.indexOf(".");-1===a&&(a=t.indexOf("E"));var s=Math.floor(Math.log(n)*Math.LOG10E)%a;if(s<0&&(s+=a),!(r=(n/Math.pow(10,s)).toPrecision(i+1+(a+s)%a)).match(/[Ee]/)){var o=Math.floor(Math.log(n)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(a+s)%a)+"."+r.substr(s)+"E"})}else r=n.toExponential(i);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}(s,c);if(36===s.charCodeAt(0))return"$"+b(e,s.substr(" "==s.charAt(1)?2:1),c);var p,v,S,y,x=Math.abs(c),w=c<0?"-":"";if(s.match(/^00+$/))return w+r(x,s.length);if(s.match(/^[#?]+$/))return p=""+c,0===c&&(p=""),p.length>s.length?p:d(s.substr(0,s.length-p.length))+p;if(v=s.match(o))return function(e,t,r){return r+(0===t?"":""+t)+n(" ",e[1].length+2+e[4].length)}(v,x,w);if(s.match(/^#+0+$/))return w+r(x,s.length-s.indexOf("0"));if(v=s.match(l))return p=(p=(""+c).replace(/^([^\.]+)$/,"$1."+d(v[1])).replace(/\.$/,"."+d(v[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+n("0",d(v[1]).length-t.length)}),-1!==s.indexOf("0.")?p:p.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),v=s.match(/^(0*)\.(#*)$/))return w+(""+x).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,v[1].length?"0.":".");if(v=s.match(/^#{1,3},##0(\.?)$/))return w+E(""+x);if(v=s.match(/^#,##0\.([#0]*0)$/))return c<0?"-"+b(e,s,-c):E(""+c)+"."+n("0",v[1].length);if(v=s.match(/^#,#*,#0/))return b(e,s.replace(/^#,#*,/,""),c);if(v=s.match(/^([0#]+)(\\?-([0#]+))+$/))return p=t(b(e,s.replace(/[\\-]/g,""),c)),S=0,t(t(s.replace(/\\/g,"")).replace(/[0#]/g,function(e){return S<p.length?p.charAt(S++):"0"===e?"0":""}));if(s.match(h))return"("+(p=b(e,"##########",c)).substr(0,3)+") "+p.substr(3,3)+"-"+p.substr(6);var _="";if(v=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return S=Math.min(v[4].length,7),y=m(x,Math.pow(10,S)-1,!1),p=""+w," "==(_=k("n",v[1],y[1])).charAt(_.length-1)&&(_=_.substr(0,_.length-1)+"0"),p+=_+v[2]+"/"+v[3],(_=a(y[2],S)).length<v[4].length&&(_=d(v[4].substr(v[4].length-_.length))+_),p+=_;if(v=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return S=Math.min(Math.max(v[1].length,v[4].length),7),w+((y=m(x,Math.pow(10,S)-1,!0))[0]||(y[1]?"":"0"))+" "+(y[1]?i(y[1],S)+v[2]+"/"+v[3]+a(y[2],S):n(" ",2*S+1+v[2].length+v[3].length));if(v=s.match(/^[#0?]+$/))return p=""+c,s.length<=p.length?p:d(s.substr(0,s.length-p.length))+p;if(v=s.match(/^([#0]+)\.([#0]+)$/)){p=""+c.toFixed(Math.min(v[2].length,10)).replace(/([^0])0+$/,"$1"),S=p.indexOf(".");var C=s.indexOf(".")-S,R=s.length-p.length-C;return d(s.substr(0,C)+p+s.substr(s.length-R))}if(v=s.match(/^00,000\.([#0]*0)$/))return c<0?"-"+b(e,s,-c):E(""+c).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?r(0,3-e.length):"")+e})+"."+r(0,v[1].length);switch(s){case"###,###":case"##,###":case"#,###":var T=E(""+x);return"0"!==T?w+T:"";default:if(s.match(/\.[0#?]*$/))return b(e,s.slice(0,s.lastIndexOf(".")),c)+d(s.slice(s.lastIndexOf(".")))}throw new Error("unsupported format |"+s+"|")}return function(e,t,n){return(0|n)===n?b(e,t,n):v(e,t,n)}}();function R(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}e._split=R;var T=/\[[HhMmSs]*\]/;function A(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":u(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;)++t;++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(T))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":default:++t}return!1}function P(e,t,n,r){for(var i,a,s,o=[],l="",c=0,h="",d="t",f="H";c<e.length;)switch(h=e.charAt(c)){case"G":if(!u(e,c))throw new Error("unrecognized character "+h+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);o[o.length]={t:"t",v:l},++c;break;case"\\":var p=e.charAt(++c),m="("===p||")"===p?p:"t";o[o.length]={t:m,v:p},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==i&&null==(i=v(t,n,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},d=h,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=v(t,n)))return"";for(l=h;++c<e.length&&e.charAt(c).toLowerCase()===h;)l+=h;"m"===h&&"h"===d.toLowerCase()&&(h="M"),"h"===h&&(h=f),o[o.length]={t:h,v:l},d=h;break;case"A":case"a":var g={t:h,v:h};if(null==i&&(i=v(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=i&&(g.v=i.H>=12?"P":"A"),g.t="T",f="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=i&&(g.v=i.H>=12?"PM":"AM"),g.t="T",c+=5,f="h"):(g.t="t",++c),null==i&&"T"===g.t)return"";o[o.length]=g,d=h;break;case"[":for(l=h;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(T)){if(null==i&&null==(i=v(t,n)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",A(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=i){for(l=h;++c<e.length&&"0"===(h=e.charAt(c));)l+=h;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=h;++c<e.length&&"0#?.,E+-%".indexOf(h=e.charAt(c))>-1||"\\"==h&&"-"==e.charAt(c+1)&&c<e.length-2&&"0#".indexOf(e.charAt(c+2))>-1;)l+=h;o[o.length]={t:"n",v:l};break;case"?":for(l=h;e.charAt(++c)===h;)l+=h;o[o.length]={t:h,v:l},d=h;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===r?"t":h,v:h},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=h;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:h,v:h},++c;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(h))throw new Error("unrecognized character "+h+" in "+e);o[o.length]={t:"t",v:h},++c}var b,S=0,y=0;for(c=o.length-1,d="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=f,d="h",S<1&&(S=1);break;case"s":(b=o[c].v.match(/\.0+$/))&&(y=Math.max(y,b[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":d=o[c].t;break;case"m":"s"===d&&(o[c].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&o[c].v.match(/[Hh]/)&&(S=1),S<2&&o[c].v.match(/[Mm]/)&&(S=2),S<3&&o[c].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M)}var x,w="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=C(o[c].t.charCodeAt(0),o[c].v,i,y),o[c].t="t";break;case"n":case"(":case"?":for(x=c+1;null!=o[x]&&("?"===(h=o[x].t)||"D"===h||(" "===h||"t"===h)&&null!=o[x+1]&&("?"===o[x+1].t||"t"===o[x+1].t&&"/"===o[x+1].v)||"("===o[c].t&&(" "===h||"n"===h||")"===h)||"t"===h&&("/"===o[x].v||" "===o[x].v&&null!=o[x+1]&&"?"==o[x+1].t));)o[c].v+=o[x].v,o[x]={v:"",t:";"},++x;w+=o[c].v,c=x-1;break;case"G":o[c].t="t",o[c].v=_(t,n)}var E,R,P="";if(w.length>0){40==w.charCodeAt(0)?(E=t<0&&45===w.charCodeAt(0)?-t:t,R=k("(",w,E)):(R=k("n",w,E=t<0&&r>1?-t:t),E<0&&o[0]&&"t"==o[0].t&&(R=R.substr(1),o[0].v="-"+o[0].v)),x=R.length-1;var B=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){B=c;break}var M=o.length;if(B===o.length&&-1===R.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?(".indexOf(o[c].t)&&(x>=o[c].v.length-1?(x-=o[c].v.length,o[c].v=R.substr(x+1,o[c].v.length)):x<0?o[c].v="":(o[c].v=R.substr(0,x+1),x=-1),o[c].t="t",M=c);x>=0&&M<o.length&&(o[M].v=R.substr(0,x+1)+o[M].v)}else if(B!==o.length&&-1===R.indexOf("E")){for(x=R.indexOf(".")-1,c=B;c>=0;--c)if(null!=o[c]&&-1!=="n?(".indexOf(o[c].t)){for(a=o[c].v.indexOf(".")>-1&&c===B?o[c].v.indexOf(".")-1:o[c].v.length-1,P=o[c].v.substr(a+1);a>=0;--a)x>=0&&("0"===o[c].v.charAt(a)||"#"===o[c].v.charAt(a))&&(P=R.charAt(x--)+P);o[c].v=P,o[c].t="t",M=c}for(x>=0&&M<o.length&&(o[M].v=R.substr(0,x+1)+o[M].v),x=R.indexOf(".")+1,c=B;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===B)){for(a=o[c].v.indexOf(".")>-1&&c===B?o[c].v.indexOf(".")+1:0,P=o[c].v.substr(0,a);a<o[c].v.length;++a)x<R.length&&(P+=R.charAt(x++));o[c].v=P,o[c].t="t",M=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n(?".indexOf(o[c].t)>-1&&(E=r>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=k(o[c].t,o[c].v,E),o[c].t="t");var I="";for(c=0;c!==o.length;++c)null!=o[c]&&(I+=o[c].v);return I}e.is_date=A,e._eval=P;var B=/\[[=<>]/,M=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function I(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function D(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:p)[e]}if(u(r,0))return _(t,n);t instanceof Date&&(t=y(t,n.date1904));var i=function(e,t){var n=R(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!=typeof t)return[4,4===n.length||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var a=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,a];if(null!=n[0].match(B)||null!=n[1].match(B)){var s=n[0].match(M),o=n[1].match(M);return I(t,s)?[r,n[0]]:I(t,o)?[r,n[1]]:[r,n[null!=s&&null!=o?2:1]]}return[r,a]}(r,t);if(u(i[1]))return _(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return P(i[1],t,n,i[0])}function L(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=p[n]){if(p[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return p[t]=e,t}e.load=L,e._table=p,e.get_table=function(){return p},e.load_table=function(e){for(var t=0;392!=t;++t)void 0!==e[t]&&L(e[t],t)},e.init_table=f,e.format=D};T(R);var A={"General Number":"General","General Date":R._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":R._table[15],"Short Date":R._table[14],"Long Time":R._table[19],"Medium Time":R._table[18],"Short Time":R._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:R._table[2],Standard:R._table[4],Percent:R._table[10],Scientific:R._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'},P={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},B=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var M;!function(e){e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}();e.table=t,e.bstr=function(e,n){for(var r=-1^n,i=e.length-1,a=0;a<i;)r=(r=r>>>8^t[255&(r^e.charCodeAt(a++))])>>>8^t[255&(r^e.charCodeAt(a++))];return a===i&&(r=r>>>8^t[255&(r^e.charCodeAt(a))]),-1^r},e.buf=function(e,n){if(e.length>1e4)return function(e,n){for(var r=-1^n,i=e.length-7,a=0;a<i;)r=(r=(r=(r=(r=(r=(r=(r=r>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])];for(;a<i+7;)r=r>>>8^t[255&(r^e[a++])];return-1^r}(e,n);for(var r=-1^n,i=e.length-3,a=0;a<i;)r=(r=(r=(r=r>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])];for(;a<i+3;)r=r>>>8^t[255&(r^e[a++])];return-1^r},e.str=function(e,n){for(var r,i,a=-1^n,s=0,o=e.length;s<o;)(r=e.charCodeAt(s++))<128?a=a>>>8^t[255&(a^r)]:r<2048?a=(a=a>>>8^t[255&(a^(192|r>>6&31))])>>>8^t[255&(a^(128|63&r))]:r>=55296&&r<57344?(r=64+(1023&r),i=1023&e.charCodeAt(s++),a=(a=(a=(a=a>>>8^t[255&(a^(240|r>>8&7))])>>>8^t[255&(a^(128|r>>2&63))])>>>8^t[255&(a^(128|i>>6&15|(3&r)<<4))])>>>8^t[255&(a^(128|63&i))]):a=(a=(a=a>>>8^t[255&(a^(224|r>>12&15))])>>>8^t[255&(a^(128|r>>6&63))])>>>8^t[255&(a^(128|63&r))];return-1^a}}(M={});var I,D=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function i(e,t){"string"==typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e._W(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e._W(2,r)}function a(e){Tt(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e._R(2),i=e._R(2),a=e.l+i,s={};switch(r){case 21589:1&(n=e._R(1))&&(s.mtime=e._R(4)),i>5&&(2&n&&(s.atime=e._R(4)),4&n&&(s.ctime=e._R(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime))}e.l=a,t[r]=s}return t}function s(){return e||(e=require("fs"))}function o(e,t){if(80==e[0]&&75==e[1])return le(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,i,a,s,o,l=512,c=[],h=e.slice(0,512);Tt(h,0);var d=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(_,"Header Signature: "),e.l+=16;var t=e._R(2,"u");return[e._R(2,"u"),t]}(h);switch(n=d[0]){case 3:l=512;break;case 4:l=4096;break;case 0:if(0==d[1])return le(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==l&&Tt(h=e.slice(0,l),28);var f=e.slice(0,l);!function(e,t){var n=9;switch(e.l+=2,n=e._R(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(h,n);var p=h._R(4,"i");if(3===n&&0!==p)throw new Error("# Directory Sectors: Expected 0 saw "+p);h.l+=4,a=h._R(4,"i"),h.l+=4,h.chk("00100000","Mini Stream Cutoff Size: "),s=h._R(4,"i"),r=h._R(4,"i"),o=h._R(4,"i"),i=h._R(4,"i");for(var m=-1,v=0;v<109&&!((m=h._R(4,"i"))<0);++v)c[v]=m;var g=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],i=1;i<n;++i)r[i-1]=e.slice(i*t,(i+1)*t);return r[n-1]=e.slice(n*t),r}(e,l);!function e(t,n,r,i,a){var s=w;if(t===w){if(0!==n)throw new Error("DIFAT chain shorter than expected")}else if(-1!==t){var o=r[t],l=(i>>>2)-1;if(!o)return;for(var c=0;c<l&&(s=yt(o,4*c))!==w;++c)a.push(s);e(yt(o,i-4),n-1,r,i,a)}}(o,i,g,l,c);var b=function(e,t,n,r){var i=e.length,a=[],s=[],o=[],l=[],c=r-1,u=0,h=0,d=0,f=0;for(u=0;u<i;++u)if(o=[],(d=u+t)>=i&&(d-=i),!s[d]){for(l=[],h=d;h>=0;){s[h]=!0,o[o.length]=h,l.push(e[h]);var p=n[Math.floor(4*h/r)];if(r<4+(f=4*h&c))throw new Error("FAT boundary crossed: "+h+" 4 "+r);if(!e[p])break;h=yt(e[p],f)}a[d]={nodes:o,data:qe([l])}}return a}(g,a,c,l);b[a].name="!Directory",r>0&&s!==w&&(b[s].name="!MiniFAT"),b[c[0]].name="!FAT",b.fat_addrs=c,b.ssz=l;var S=[],y=[],x=[];u(a,b,g,S,r,{},y,s),function(e,t,n){for(var r=0,i=0,a=0,s=0,o=0,l=n.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=n[r];for(;o<u.length;++o)r=u[o],i=e[r].L,a=e[r].R,s=e[r].C,c[r]===r&&(-1!==i&&c[i]!==i&&(c[r]=c[i]),-1!==a&&c[a]!==a&&(c[r]=c[a])),-1!==s&&(c[s]=r),-1!==i&&r!=c[r]&&(c[i]=c[r],u.lastIndexOf(i)<o&&u.push(i)),-1!==a&&r!=c[r]&&(c[a]=c[r],u.lastIndexOf(a)<o&&u.push(a));for(r=1;r<l;++r)c[r]===r&&(-1!==a&&c[a]!==a?c[r]=c[a]:-1!==i&&c[i]!==i&&(c[r]=c[i]));for(r=1;r<l;++r)if(0!==e[r].type){if((o=r)!=c[o])do{o=c[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(y,x,S),S.shift();var C={FileIndex:y,FullPaths:x};return t&&t.raw&&(C.raw={header:f,sectors:g}),C}function l(e,t,n){for(var r=e.start,i=e.size,a=[],s=r;n&&i>0&&s>=0;)a.push(t.slice(s*x,s*x+x)),i-=x,s=yt(n,4*s);return 0===a.length?Pt(0):C(a).slice(0,e.size)}function c(e,t,n,r,i){var a=[],s=[];i||(i=[]);var o=r-1,l=0,c=0;for(l=t;l>=0;){i[l]=!0,a[a.length]=l,s.push(e[l]);var u=n[Math.floor(4*l/r)];if(r<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=yt(e[u],c)}return{nodes:a,data:qe([s])}}function u(e,t,n,r,i,a,s,o){for(var u,d=0,f=r.length?2:0,p=t[e].data,m=0,v=0;m<p.length;m+=128){var g=p.slice(m,m+128);Tt(g,64),v=g._R(2),u=Je(g,0,v-f),r.push(u);var b={name:u,type:g._R(1),color:g._R(1),L:g._R(4,"i"),R:g._R(4,"i"),C:g._R(4,"i"),clsid:g._R(16),state:g._R(4,"i"),start:0,size:0};0!==g._R(2)+g._R(2)+g._R(2)+g._R(2)&&(b.ct=h(g,g.l-8)),0!==g._R(2)+g._R(2)+g._R(2)+g._R(2)&&(b.mt=h(g,g.l-8)),b.start=g._R(4,"i"),b.size=g._R(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=w,b.name=""),5===b.type?(d=b.start,i>0&&d!==w&&(t[d].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=c(n,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:d!==w&&b.start!==w&&t[d]&&(b.content=l(b,t[d].data,(t[o]||{}).data))),b.content&&Tt(b.content,0),a[u]=b,s.push(b)}}function h(e,t){return new Date(1e3*(St(e,t+4)/1e7*Math.pow(2,32)+St(e,t)/1e7-11644473600))}function d(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="Sh33tJ5";if(D.find(e,"/"+t))return;var n=Pt(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){d(e);for(var i=!1,a=!1,s=e.FullPaths.length-1;s>=0;--s){var o=e.FileIndex[s];switch(o.type){case 0:a?i=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:a=!0,isNaN(o.R*o.L*o.C)&&(i=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(i=!0);break;default:i=!0}}if(i||t){var l=new Date(1987,1,19),c=0,u=[];for(s=0;s<e.FullPaths.length;++s)0!==e.FileIndex[s].type&&u.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<u.length;++s){var h=n(u[s][0]);for(a=!1,c=0;c<u.length;++c)u[c][0]===h&&(a=!0);a||u.push([h,{name:r(h).replace("/",""),type:1,clsid:T,ct:l,mt:l,content:null}])}for(u.sort(function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0,a=0,s=Math.min(n.length,r.length);i<s;++i){if(a=n[i].length-r[i].length)return a;if(n[i]!=r[i])return n[i]<r[i]?-1:1}return n.length-r.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],s=0;s<u.length;++s)e.FullPaths[s]=u[s][0],e.FileIndex[s]=u[s][1];for(s=0;s<u.length;++s){var f=e.FileIndex[s],p=e.FullPaths[s];if(f.name=r(p).replace("/",""),f.L=f.R=f.C=-(f.color=1),f.size=f.content?f.content.length:0,f.start=0,f.clsid=f.clsid||T,0===s)f.C=u.length>1?1:-1,f.size=0,f.type=5;else if("/"==p.slice(-1)){for(c=s+1;c<u.length&&n(e.FullPaths[c])!=p;++c);for(f.C=c>=u.length?-1:c,c=s+1;c<u.length&&n(e.FullPaths[c])!=n(p);++c);f.R=c>=u.length?-1:c,f.type=1}else n(e.FullPaths[s+1]||"")==n(p)&&(f.R=s+1),f.type=2}}}function v(e,t){var n=t||{};if(f(e),"zip"==n.fileType)return ue(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var i=e.FileIndex[r];if(i.content){var a=i.content.length;a>0&&(a<4096?t+=a+63>>6:n+=a+511>>9)}}for(var s=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+n+s+o,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var h=[1,u,c,o,s,n,t,0];return e.FileIndex[0].size=t<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),i=Pt(r[7]<<9),a=0,s=0;for(a=0;a<8;++a)i._W(1,R[a]);for(a=0;a<8;++a)i._W(2,0);for(i._W(2,62),i._W(2,3),i._W(2,65534),i._W(2,9),i._W(2,6),a=0;a<3;++a)i._W(2,0);for(i._W(4,0),i._W(4,r[2]),i._W(4,r[0]+r[1]+r[2]+r[3]-1),i._W(4,0),i._W(4,4096),i._W(4,r[3]?r[0]+r[1]+r[2]-1:w),i._W(4,r[3]),i._W(-4,r[1]?r[0]-1:w),i._W(4,r[1]),a=0;a<109;++a)i._W(-4,a<r[2]?r[1]+a:-1);if(r[1])for(s=0;s<r[1];++s){for(;a<236+127*s;++a)i._W(-4,a<r[2]?r[1]+a:-1);i._W(-4,s===r[1]-1?w:s+1)}var o=function(e){for(s+=e;a<s-1;++a)i._W(-4,a+1);e&&(++a,i._W(-4,w))};for(s=a=0,s+=r[1];a<s;++a)i._W(-4,A.DIFSECT);for(s+=r[2];a<s;++a)i._W(-4,A.FATSECT);o(r[3]),o(r[4]);for(var l=0,c=0,u=e.FileIndex[0];l<e.FileIndex.length;++l)(u=e.FileIndex[l]).content&&((c=u.content.length)<4096||(u.start=s,o(c+511>>9)));for(o(r[6]+7>>3);511&i.l;)i._W(-4,A.ENDOFCHAIN);for(s=a=0,l=0;l<e.FileIndex.length;++l)(u=e.FileIndex[l]).content&&(!(c=u.content.length)||c>=4096||(u.start=s,o(c+63>>6)));for(;511&i.l;)i._W(-4,A.ENDOFCHAIN);for(a=0;a<r[4]<<2;++a){var h=e.FullPaths[a];if(h&&0!==h.length){u=e.FileIndex[a],0===a&&(u.start=u.size?u.start-1:w);var d=0===a&&n.root||u.name;if(c=2*(d.length+1),i._W(64,d,"utf16le"),i._W(2,c),i._W(1,u.type),i._W(1,u.color),i._W(-4,u.L),i._W(-4,u.R),i._W(-4,u.C),u.clsid)i._W(16,u.clsid,"hex");else for(l=0;l<4;++l)i._W(4,0);i._W(4,u.state||0),i._W(4,0),i._W(4,0),i._W(4,0),i._W(4,0),i._W(4,u.start),i._W(4,u.size),i._W(4,0)}else{for(l=0;l<17;++l)i._W(4,0);for(l=0;l<3;++l)i._W(4,-1);for(l=0;l<12;++l)i._W(4,0)}}for(a=1;a<e.FileIndex.length;++a)if((u=e.FileIndex[a]).size>=4096){for(i.l=u.start+1<<9,l=0;l<u.size;++l)i._W(1,u.content[l]);for(;511&l;++l)i._W(1,0)}for(a=1;a<e.FileIndex.length;++a)if((u=e.FileIndex[a]).size>0&&u.size<4096){for(l=0;l<u.size;++l)i._W(1,u.content[l]);for(;63&l;++l)i._W(1,0)}for(;i.l<i.length;)i._W(1,0);return i}t.version="1.1.3";var g,x=64,w=-2,_="d0cf11e0a1b11ae1",R=[208,207,17,224,161,177,26,225],T="00000000000000000000000000000000",A={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:w,FREESECT:-1,HEADER_SIGNATURE:_,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:T,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function P(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function B(e){return g?g.deflateRawSync(e):K(e)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],F=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function O(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var N="undefined"!=typeof Uint8Array,z=N?new Uint8Array(256):[],W=0;W<256;++W)z[W]=O(W);function V(e,t){var n=z[255&e];return t<=8?n>>>8-t:(n=n<<8|z[e>>8&255],t<=16?n>>>16-t:(n=n<<8|z[e>>16&255])>>>24-t)}function $(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function U(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function H(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function X(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function G(e,t,n){var r=7&t,i=t>>>3,a=(1<<n)-1,s=e[i]>>>r;return n<8-r?s&a:(s|=e[i+1]<<8-r,n<16-r?s&a:(s|=e[i+2]<<16-r,n<24-r?s&a:(s|=e[i+3]<<24-r)&a))}function j(e,t){var n=e.length,r=2*n>t?2*n:t+5,i=0;if(n>=t)return e;if(m){var a=S(r);if(e.copy)e.copy(a);else for(;i<e.length;++i)a[i]=e[i];return a}if(N){var s=new Uint8Array(r);if(s.set)s.set(e);else for(;i<e.length;++i)s[i]=e[i];return s}return e.length=r,e}function Y(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}var K=function(){var e=function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),i=n+r==e.length;for(t._W(1,+i),t._W(2,r),t._W(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l};return function(t){var n=Pt(50+Math.floor(1.1*t.length)),r=e(t,n);return n.slice(0,r)}}();function Z(e,t,n){var r=1,i=0,a=0,s=0,o=0,l=e.length,c=N?new Uint16Array(32):Y(32);for(a=0;a<32;++a)c[a]=0;for(a=l;a<n;++a)e[a]=0;l=e.length;var u=N?new Uint16Array(l):Y(l);for(a=0;a<l;++a)c[i=e[a]]++,r<i&&(r=i),u[a]=0;for(c[0]=0,a=1;a<=r;++a)c[a+16]=o=o+c[a-1]<<1;for(a=0;a<l;++a)0!=(o=e[a])&&(u[a]=c[o+16]++);var h=0;for(a=0;a<l;++a)if(0!=(h=e[a]))for(o=V(u[a],r)>>r-h,s=(1<<r+4-h)-1;s>=0;--s)t[o|s<<h]=15&h|a<<4;return r}var q=N?new Uint16Array(512):Y(512),Q=N?new Uint16Array(32):Y(32);if(!N){for(var J=0;J<512;++J)q[J]=0;for(J=0;J<32;++J)Q[J]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);Z(e,Q,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);Z(n,q,288)}();var ee=N?new Uint16Array(32768):Y(32768),te=N?new Uint16Array(32768):Y(32768),ne=N?new Uint16Array(128):Y(128),re=1,ie=1;function ae(e,t){var n=H(e,t)+257,r=H(e,t+=5)+1,i=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var a=0,s=N?new Uint8Array(19):Y(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=N?new Uint8Array(8):Y(8),u=N?new Uint8Array(8):Y(8),h=s.length,d=0;d<i;++d)s[I[d]]=a=U(e,t),l<a&&(l=a),c[a]++,t+=3;var f=0;for(c[0]=0,d=1;d<=l;++d)u[d]=f=f+c[d-1]<<1;for(d=0;d<h;++d)0!=(f=s[d])&&(o[d]=u[f]++);var p=0;for(d=0;d<h;++d)if(0!=(p=s[d])){f=z[o[d]]>>8-p;for(var m=(1<<7-p)-1;m>=0;--m)ne[f|m<<p]=7&p|d<<3}var v=[];for(l=1;v.length<n+r;)switch(t+=7&(f=ne[X(e,t)]),f>>>=3){case 16:for(a=3+$(e,t),t+=2,f=v[v.length-1];a-- >0;)v.push(f);break;case 17:for(a=3+U(e,t),t+=3;a-- >0;)v.push(0);break;case 18:for(a=11+X(e,t),t+=7;a-- >0;)v.push(0);break;default:v.push(f),l<f&&(l=f)}var g=v.slice(0,n),b=v.slice(n);for(d=n;d<286;++d)g[d]=0;for(d=r;d<30;++d)b[d]=0;return re=Z(g,ee,286),ie=Z(b,te,30),t}function se(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[b(t),2];for(var n=0,r=0,i=S(t||1<<18),a=0,s=i.length>>>0,o=0,l=0;0==(1&r);)if(r=U(e,n),n+=3,r>>>1!=0)for(r>>>1==1?(o=9,l=5):(n=ae(e,n),o=re,l=ie),!t&&s<a+32767&&(s=(i=j(i,a+32767)).length);;){var c=G(e,n,o),u=r>>>1==1?q[c]:ee[c];if(n+=15&u,0==((u>>>=4)>>>8&255))i[a++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var d=a+L[u];h>0&&(d+=G(e,n,h),n+=h),c=G(e,n,l),n+=15&(u=r>>>1==1?Q[c]:te[c]);var f=(u>>>=4)<4?0:u-2>>1,p=F[u];for(f>0&&(p+=G(e,n,f),n+=f),!t&&s<d&&(s=(i=j(i,d)).length);a<d;)i[a]=i[a-p],++a}}else{7&n&&(n+=8-(7&n));var m=e[n>>>3]|e[1+(n>>>3)]<<8;if(n+=32,!t&&s<a+m&&(s=(i=j(i,a+m)).length),"function"==typeof e.copy)e.copy(i,a,n>>>3,(n>>>3)+m),a+=m,n+=8*m;else for(;m-- >0;)i[a++]=e[n>>>3],n+=8}return[t?i:i.slice(0,a),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function oe(e,t){if(!e)throw new Error(t);"undefined"!=typeof console&&console.error(t)}function le(e,t){var n=e;Tt(n,0);var r={FileIndex:[],FullPaths:[]};d(r,{root:t.root});for(var i=n.length-4;(80!=n[i]||75!=n[i+1]||5!=n[i+2]||6!=n[i+3])&&i>=0;)--i;n.l=i+4,n.l+=4;var s=n._R(2);n.l+=6;var o=n._R(4);for(n.l=o,i=0;i<s;++i){n.l+=20;var l=n._R(4),c=n._R(4),u=n._R(2),h=n._R(2),f=n._R(2);n.l+=8;var p=n._R(4),m=a(n.slice(n.l+u,n.l+u+h));n.l+=u+h+f;var v=n.l;n.l=p+4,ce(n,l,c,r,m),n.l=v}return r}function ce(e,t,n,r,i){e.l+=2;var s=e._R(2),o=e._R(2),l=function(e){var t=65535&e._R(2),n=65535&e._R(2),r=new Date,i=31&n,a=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(a-1),r.setDate(i);var s=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(s<<1),r}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");for(var c=e._R(4),u=e._R(4),h=e._R(4),d=e._R(2),f=e._R(2),p="",m=0;m<d;++m)p+=String.fromCharCode(e[e.l++]);if(f){var v=a(e.slice(e.l,e.l+f));(v[21589]||{}).mt&&(l=v[21589].mt),((i||{})[21589]||{}).mt&&(l=i[21589].mt)}e.l+=f;var b=e.slice(e.l,e.l+u);switch(o){case 8:b=function(e,t){if(!g)return se(e,t);var n=new(0,g.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,h);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var S=!1;8&s&&(134695760==(c=e._R(4))&&(c=e._R(4),S=!0),u=e._R(4),h=e._R(4)),u!=t&&oe(S,"Bad compressed size: "+t+" != "+u),h!=n&&oe(S,"Bad uncompressed size: "+n+" != "+h);var y=M.buf(b,0);c>>0!=y>>0&&oe(S,"Bad CRC32 checksum: "+c+" != "+y),he(r,p,b,{unsafe:!0,mt:l})}function ue(e,t){var n=t||{},r=[],a=[],s=Pt(1),o=n.compression?8:0,l=0;var c=0,u=0,h=0,d=0,f=e.FullPaths[0],p=f,m=e.FileIndex[0],v=[],g=0;for(c=1;c<e.FullPaths.length;++c)if(p=e.FullPaths[c].slice(f.length),(m=e.FileIndex[c]).size&&m.content&&"Sh33tJ5"!=p){var b=h,S=Pt(p.length);for(u=0;u<p.length;++u)S._W(1,127&p.charCodeAt(u));S=S.slice(0,S.l),v[d]=M.buf(m.content,0);var y=m.content;8==o&&(y=B(y)),(s=Pt(30))._W(4,67324752),s._W(2,20),s._W(2,l),s._W(2,o),m.mt?i(s,m.mt):s._W(4,0),s._W(-4,8&l?0:v[d]),s._W(4,8&l?0:y.length),s._W(4,8&l?0:m.content.length),s._W(2,S.length),s._W(2,0),h+=s.length,r.push(s),h+=S.length,r.push(S),h+=y.length,r.push(y),8&l&&((s=Pt(12))._W(-4,v[d]),s._W(4,y.length),s._W(4,m.content.length),h+=s.l,r.push(s)),(s=Pt(46))._W(4,33639248),s._W(2,0),s._W(2,20),s._W(2,l),s._W(2,o),s._W(4,0),s._W(-4,v[d]),s._W(4,y.length),s._W(4,m.content.length),s._W(2,S.length),s._W(2,0),s._W(2,0),s._W(2,0),s._W(2,0),s._W(4,0),s._W(4,b),g+=s.l,a.push(s),g+=S.length,a.push(S),++d}return(s=Pt(22))._W(4,101010256),s._W(2,0),s._W(2,0),s._W(2,d),s._W(2,d),s._W(4,g),s._W(4,h),s._W(2,0),C([C(r),C(a),s])}function he(e,t,n,i){var a=i&&i.unsafe;a||d(e);var s=!a&&D.find(e,t);if(!s){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),s={name:r(t),type:2},e.FileIndex.push(s),e.FullPaths.push(o),a||D.utils.cfb_gc(e)}return s.content=n,s.size=n?n.length:0,i&&(i.CLSID&&(s.clsid=i.CLSID),i.mt&&(s.mt=i.mt),i.ct&&(s.ct=i.ct)),s}return t.find=function(e,t){var n=e.FullPaths.map(function(e){return e.toUpperCase()}),r=n.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),i=!1;47===t.charCodeAt(0)?(i=!0,t=n[0].slice(0,-1)+t):i=-1!==t.indexOf("/");var a=t.toUpperCase(),s=!0===i?n.indexOf(a):r.indexOf(a);if(-1!==s)return e.FileIndex[s];var o=!a.match(k);for(a=a.replace(E,""),o&&(a=a.replace(k,"!")),s=0;s<n.length;++s){if((o?n[s].replace(k,"!"):n[s]).replace(E,"")==a)return e.FileIndex[s];if((o?r[s].replace(k,"!"):r[s]).replace(E,"")==a)return e.FileIndex[s]}return null},t.read=function(t,n){switch(n&&n.type||"base64"){case"file":return function(t,n){return s(),o(e.readFileSync(t),n)}(t,n);case"base64":return o(y(p.decode(t)),n);case"binary":return o(y(t),n)}return o(t,n)},t.parse=o,t.write=function(t,n){var r=v(t,n);switch(n&&n.type){case"file":return s(),e.writeFileSync(n.filename,r),r;case"binary":return P(r);case"base64":return p.encode(P(r))}return r},t.writeFile=function(t,n,r){s();var i=v(t,r);e.writeFileSync(n,i)},t.utils={cfb_new:function(e){var t={};return d(t,e),t},cfb_add:he,cfb_del:function(e,t){d(e);var n=D.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){d(e);var i=D.find(e,t);if(i)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==i)return e.FileIndex[a].name=r(n),e.FullPaths[a]=n,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:wt,CheckField:Rt,prep_blob:Tt,bconcat:C,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");g=e}catch(e){console.error("cannot use native zlib: "+(e.message||e))}},_deflateRaw:K,_inflateRaw:se,consts:A},t}();if("undefined"!=typeof require)try{I=require("fs")}catch(e){}function L(e){return"string"==typeof e?x(e):Array.isArray(e)?function(e){if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function F(e,t,n){if(void 0!==I&&I.writeFileSync)return n?I.writeFileSync(e,t,n):I.writeFileSync(e,t);var r="utf8"==n?Me(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!=typeof Blob){var i=new Blob([L(r)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if("undefined"!=typeof saveAs)return saveAs(i,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=e,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=w(t)),o.write(t),o.close(),t}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("cannot save file "+e)}function O(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)e.hasOwnProperty(t[r])&&n.push(t[r]);return n}function N(e,t){for(var n=[],r=O(e),i=0;i!==r.length;++i)null==n[e[r[i]][t]]&&(n[e[r[i]][t]]=r[i]);return n}function z(e){for(var t=[],n=O(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function W(e){for(var t=[],n=O(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var V=new Date(1899,11,30,0,0,0),U=V.getTime()+6e4*((new Date).getTimezoneOffset()-V.getTimezoneOffset());function H(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-U)/864e5}function X(e){var t=new Date;return t.setTime(24*e*60*60*1e3+U),t}function G(e){var t=0,n=0,r=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(n=1,a>3&&(r=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":n*=24;case"H":n*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");n*=60}t+=n*parseInt(i[a],10)}return t}var j=new Date("2017-02-19T19:06:09.000Z");isNaN(j.getFullYear())&&(j=new Date("2/19/17"));var Y=2017==j.getFullYear();function K(e,t){var n=new Date(e);if(Y)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==j.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1?n:(n.setFullYear(n.getFullYear()+100),n)}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-60*a.getTimezoneOffset()*1e3)),a}function Z(e){for(var t="",n=0;n!=e.length;++n)t+=String.fromCharCode(e[n]);return t}function q(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=q(e[n]));return t}function Q(e,t){for(var n="";n.length<t;)n+=e;return n}function J(e){var t=Number(e);if(!isNaN(t))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,function(e,t){return n=-n,t}),isNaN(t=Number(r))?t:t/n):t/n}function ee(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),a=t.getDate();return isNaN(a)?n:r<0||r>8099?n:(i>0||a>1)&&101!=r?t:e.toLowerCase().match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)?t:e.match(/[^-0-9:,\/\\]/)?n:t}var te,ne=5=="abacaba".split(/(:?b)/i).length;function re(e){return e?e.data?u(e.data):e.asNodeBuffer&&m?u(e.asNodeBuffer().toString("binary")):e.asBinary?u(e.asBinary()):e._data&&e._data.getContent?u(Z(Array.prototype.slice.call(e._data.getContent(),0))):e.content&&e.type?u(Z(e.content)):null:null}function ie(e){return e&&".bin"===e.name.slice(-4)?function(e){if(!e)return null;if(e.data)return c(e.data);if(e.asNodeBuffer&&m)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?c(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}(e):re(e)}function ae(e,t){for(var n=e.FullPaths||O(e.files),r=t.toLowerCase(),i=r.replace(/\//g,"\\"),a=0;a<n.length;++a){var s=n[a].toLowerCase();if(r==s||i==s)return e.files[n[a]]}return null}function se(e,t){var n=ae(e,t);if(null==n)throw new Error("Cannot find file "+t+" in zip");return n}function oe(e,t,n){if(!n)return ie(se(e,t));if(!t)return null;try{return oe(e,t)}catch(e){return null}}function le(e,t,n){if(!n)return re(se(e,t));if(!t)return null;try{return le(e,t)}catch(e){return null}}function ce(e,t,n){e.FullPaths?D.utils.cfb_add(e,t,n):e.file(t,n)}function ue(){return te?new te:D.utils.cfb_new()}function he(e,t){if("/"==e.charAt(0))return e.slice(1);var n=t.split("/");"/"!=t.slice(-1)&&n.pop();for(var r=e.split("/");0!==r.length;){var i=r.shift();".."===i?n.pop():"."!==i&&n.push(i)}return n.join("/")}"undefined"!=typeof JSZipSync&&(te=JSZipSync),"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&void 0===te&&(te=void 0);var de='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',fe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,pe=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s?[\/\?]?>/g;de.match(pe)||(pe=/<[^>]*>/g);var me=/<\w*:/,ve=/<(\/?)\w+:/;function ge(e,t,n){for(var r={},i=0,a=0;i!==e.length&&(32!==(a=e.charCodeAt(i))&&10!==a&&13!==a);++i);if(t||(r[0]=e.slice(0,i)),i===e.length)return r;var s=e.match(fe),o=0,l="",c=0,u="",h="",d=1;if(s)for(c=0;c!=s.length;++c){for(h=s[c],a=0;a!=h.length&&61!==h.charCodeAt(a);++a);for(u=h.slice(0,a).trim();32==h.charCodeAt(a+1);)++a;for(d=34==(i=h.charCodeAt(a+1))||39==i?1:0,l=h.slice(a+1+d,h.length-d),o=0;o!=u.length&&58!==u.charCodeAt(o);++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),r[u]=l,n||(r[u.toLowerCase()]=l);else{var f=(5===o&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(o+1);if(r[f]&&"ext"==u.slice(o-3,o))continue;r[f]=l,n||(r[f.toLowerCase()]=l)}}return r}function be(e){return e.replace(ve,"<$1")}var Se={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ye=z(Se),xe=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/g,t=/_x([\da-fA-F]{4})_/g;return function n(r){var i=r+"",a=i.indexOf("<![CDATA[");if(-1==a)return i.replace(e,function(e,t){return Se[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var s=i.indexOf("]]>");return n(i.slice(0,a))+i.slice(a+9,s)+n(i.slice(s+3))}}(),we=/[&<>'"]/g,_e=/[\u0000-\u0008\u000b-\u001f]/g;function Ce(e){return(e+"").replace(we,function(e){return ye[e]}).replace(_e,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ee(e){return Ce(e).replace(/ /g,"_x0020_")}var ke=/[\u0000-\u001f]/g;function Re(e){return(e+"").replace(we,function(e){return ye[e]}).replace(/\n/g,"<br/>").replace(ke,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var Te=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(n){return n.replace(e,t)}}(),Ae=function(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")};function Pe(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}var Be=function(e){for(var t="",n=0,r=0,i=0,a=0,s=0,o=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(i=e.charCodeAt(n++),r>191&&r<224?(s=(31&r)<<6,s|=63&i,t+=String.fromCharCode(s)):(a=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&a):(o=((7&r)<<18|(63&i)<<12|(63&a)<<6|63&(s=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t},Me=function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(63&i)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")};if(m){var Ie=function(e){var t,n,r,i=Buffer.alloc(2*e.length),a=1,s=0,o=0;for(n=0;n<e.length;n+=a)a=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),a=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),a=3):(a=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(i[s++]=255&o,i[s++]=o>>>8,o=0),i[s++]=t%256,i[s++]=t>>>8;return i.slice(0,s).toString("ucs2")},De="foo bar bazâð£";Be(De)==Ie(De)&&(Be=Ie);var Le=function(e){return v(e,"binary").toString("utf8")};Be(De)==Le(De)&&(Be=Le),Me=function(e){return v(e,"utf8").toString("binary")}}var Fe=function(){var e={};return function(t,n){var r=t+"|"+(n||"");return e[r]?e[r]:e[r]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),Oe=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","g"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}(),Ne=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),ze=/<\/?(?:vt:)?variant>/g,We=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ve(e,t){var n=ge(e),r=e.match(Ne(n.baseType))||[],i=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return i}return r.forEach(function(e){var t=e.replace(ze,"").match(We);t&&i.push({v:Be(t[2]),t:t[1]})}),i}var $e=/(^\s|\s$|\n)/;function Ue(e,t){return"<"+e+(t.match($e)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function He(e){return O(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Xe(e,t,n){return"<"+e+(null!=n?He(n):"")+(null!=t?(t.match($e)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ge(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}var je={dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema",main:["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"]},Ye={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};var Ke,Ze,qe=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,i=e[0][n].length;r<i;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},Qe=qe,Je=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(gt(e,i)));return r.join("").replace(E,"")},et=Je,tt=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},nt=tt,rt=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(vt(e,i)));return r.join("")},it=rt,at=function(e,t){var n=St(e,t);return n>0?rt(e,t+4,t+4+n-1):""},st=at,ot=function(e,t){var n=St(e,t);return n>0?rt(e,t+4,t+4+n-1):""},lt=ot,ct=function(e,t){var n=2*St(e,t);return n>0?rt(e,t+4,t+4+n-1):""},ut=ct;Ke=Ze=function(e,t){var n=St(e,t);return n>0?Je(e,t+4,t+4+n):""};var ht,dt,ft=function(e,t){var n=St(e,t);return n>0?rt(e,t+4,t+4+n):""},pt=ft;ht=dt=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),i=15&e[t+6],a=5;a>=0;--a)i=256*i+e[t+a];return 2047==r?0==i?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}(e,t)};var mt=function(e){return Array.isArray(e)};m&&(Je=function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(E,""):et(e,t,n)},tt=function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):nt(e,t,n)},at=function(e,t){if(!Buffer.isBuffer(e))return st(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},ot=function(e,t){if(!Buffer.isBuffer(e))return lt(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},ct=function(e,t){if(!Buffer.isBuffer(e))return ut(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},Ke=function(e,t){if(!Buffer.isBuffer(e))return Ze(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},ft=function(e,t){if(!Buffer.isBuffer(e))return pt(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},rt=function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):it(e,t,n)},qe=function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0]):Qe(e)},C=function(e){return Buffer.isBuffer(e[0])?Buffer.concat(e):[].concat.apply([],e)},ht=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):dt(e,t)},mt=function(e){return Buffer.isBuffer(e)||Array.isArray(e)}),"undefined"!=typeof cptable&&(Je=function(e,t,n){return cptable.utils.decode(1200,e.slice(t,n)).replace(E,"")},rt=function(e,t,n){return cptable.utils.decode(65001,e.slice(t,n))},at=function(e,t){var r=St(e,t);return r>0?cptable.utils.decode(n,e.slice(t+4,t+4+r-1)):""},ot=function(e,n){var r=St(e,n);return r>0?cptable.utils.decode(t,e.slice(n+4,n+4+r-1)):""},ct=function(e,t){var n=2*St(e,t);return n>0?cptable.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},Ke=function(e,t){var n=St(e,t);return n>0?cptable.utils.decode(1200,e.slice(t+4,t+4+n)):""},ft=function(e,t){var n=St(e,t);return n>0?cptable.utils.decode(65001,e.slice(t+4,t+4+n)):""});var vt=function(e,t){return e[t]},gt=function(e,t){return 256*e[t+1]+e[t]},bt=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},St=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},yt=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},xt=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function wt(e,n){var r,i,a,s,o,l,c="",u=[];switch(n){case"dbcs":if(l=this.l,m&&Buffer.isBuffer(this))c=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)c+=String.fromCharCode(gt(this,l)),l+=2;e*=2;break;case"utf8":c=rt(this,this.l,this.l+e);break;case"utf16le":e*=2,c=Je(this,this.l,this.l+e);break;case"wstr":if("undefined"==typeof cptable)return wt.call(this,e,"dbcs");c=cptable.utils.decode(t,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":c=at(this,this.l),e=4+St(this,this.l);break;case"lpstr-cp":c=ot(this,this.l),e=4+St(this,this.l);break;case"lpwstr":c=ct(this,this.l),e=4+2*St(this,this.l);break;case"lpp4":e=4+St(this,this.l),c=Ke(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+St(this,this.l),c=ft(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,c="";0!==(a=vt(this,this.l+e++));)u.push(h(a));c=u.join("");break;case"_wstr":for(e=0,c="";0!==(a=gt(this,this.l+e));)u.push(h(a)),e+=2;e+=2,c=u.join("");break;case"dbcs-cont":for(c="",l=this.l,o=0;o<e;++o){if(this.lens&&-1!==this.lens.indexOf(l))return a=vt(this,l),this.l=l+1,s=wt.call(this,e-o,a?"dbcs-cont":"sbcs-cont"),u.join("")+s;u.push(h(gt(this,l))),l+=2}c=u.join(""),e*=2;break;case"cpstr":if("undefined"!=typeof cptable){c=cptable.utils.decode(t,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(c="",l=this.l,o=0;o!=e;++o){if(this.lens&&-1!==this.lens.indexOf(l))return a=vt(this,l),this.l=l+1,s=wt.call(this,e-o,a?"dbcs-cont":"sbcs-cont"),u.join("")+s;u.push(h(vt(this,l))),l+=1}c=u.join("");break;default:switch(e){case 1:return r=vt(this,this.l),this.l++,r;case 2:return r=("i"===n?bt:gt)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===n||0==(128&this[this.l+3])?(r=(e>0?yt:xt)(this,this.l),this.l+=4,r):(i=St(this,this.l),this.l+=4,i);case 8:case-8:if("f"===n)return i=8==e?ht(this,this.l):ht([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:c=tt(this,this.l,e)}}return this.l+=e,c}var _t=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},Ct=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},Et=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function kt(e,t,r){var i=0,a=0;if("dbcs"===r){for(a=0;a!=t.length;++a)Et(this,t.charCodeAt(a),this.l+2*a);i=2*t.length}else if("sbcs"===r){if("undefined"!=typeof cptable&&874==n)for(a=0;a!=t.length;++a){var s=cptable.utils.encode(n,t.charAt(a));this[this.l+a]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);i=t.length}else{if("hex"===r){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===r){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var l=t.charCodeAt(a);this[this.l++]=255&l,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}switch(e){case 1:i=1,this[this.l]=255&t;break;case 2:i=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:i=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:i=4,_t(this,t,this.l);break;case 8:if(i=8,"f"===r){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=r?-t:t;isFinite(s)?0==s?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[n+o]=255&a;e[n+6]=(15&i)<<4|15&a,e[n+7]=i>>4|r}(this,t,this.l);break}case 16:break;case-4:i=4,Ct(this,t,this.l)}}return this.l+=i,this}function Rt(e,t){var n=tt(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function Tt(e,t){e.l=t,e._R=wt,e.chk=Rt,e._W=kt}function At(e,t){e.l+=t}function Pt(e){var t=b(e);return Tt(t,0),t}function Bt(e,t,n){if(e){var r,i,a;Tt(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){128&(o=e._R(1))&&(o=(127&o)+((127&e._R(1))<<7));var c=jl[o]||jl[65535];for(a=127&(r=e._R(1)),i=1;i<4&&128&r;++i)a+=(127&(r=e._R(1)))<<7*i;l=e.l+a;var u=(c.f||At)(e,a,n);if(e.l=l,t(u,c.n,o))return}}}function Mt(){var e=[],t=m?256:2048,n=function(e){var t=Pt(e);return Tt(t,0),t},r=n(t),i=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},a=function(e){return r&&e<r.length-r.l?r:(i(),r=n(Math.max(e+1,t)))};return{next:a,push:function(e){i(),null==(r=e).l&&(r.l=r.length),a(t)},end:function(){return i(),qe([e])},_bufs:e}}function It(e,t,n,r){var i,a=+Yl[t];if(!isNaN(a)){r||(r=jl[a].p||(n||[]).length||0),i=1+(a>=128?1:0)+1,r>=128&&++i,r>=16384&&++i,r>=2097152&&++i;var s=e.next(i);a<=127?s._W(1,a):(s._W(1,128+(127&a)),s._W(1,a>>7));for(var o=0;4!=o;++o){if(!(r>=128)){s._W(1,r);break}s._W(1,128+(127&r)),r>>=7}r>0&&mt(n)&&e.push(n)}}function Dt(e,t,n){var r=q(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Lt(e,t,n){var r=q(e);return r.s=Dt(r.s,t.s,n),r.e=Dt(r.e,t.s,n),r}function Ft(e,t){if(e.cRel&&e.c<0)for(e=q(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=q(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=Ht(e);return e.cRel||null==e.cRel||(n=function(e){return e.replace(/^([A-Z])/,"$$$1")}(n)),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function Ot(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?65535:255)||e.e.cRel?Ft(e.s,t.biff)+":"+Ft(e.e,t.biff):(e.s.rRel?"":"$")+zt(e.s.r)+":"+(e.e.rRel?"":"$")+zt(e.e.r):(e.s.cRel?"":"$")+Vt(e.s.c)+":"+(e.e.cRel?"":"$")+Vt(e.e.c)}function Nt(e){return parseInt(function(e){return e.replace(/\$(\d+)$/,"$1")}(e),10)-1}function zt(e){return""+(e+1)}function Wt(e){for(var t=function(e){return e.replace(/^\$([A-Z])/,"$1")}(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Vt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function $t(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ut(e){var t=$t(e);return{c:Wt(t[0]),r:Nt(t[1])}}function Ht(e){return Vt(e.c)+zt(e.r)}function Xt(e){var t=e.split(":").map(Ut);return{s:t[0],e:t[t.length-1]}}function Gt(e,t){return void 0===t||"number"==typeof t?Gt(e.s,e.e):("string"!=typeof e&&(e=Ht(e)),"string"!=typeof t&&(t=Ht(t)),e==t?e:e+":"+t)}function jt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,a=e.length;for(n=0;r<a&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<a&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===a||58===e.charCodeAt(++r))return t.e.c=t.s.c,t.e.r=t.s.r,t;for(n=0;r!=a&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=a&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function Yt(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=R.format(e.z,n?H(t):t)}catch(e){}try{return e.w=R.format((e.XF||{}).numFmtId||(n?14:0),n?H(t):t)}catch(e){return""+t}}function Kt(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),Yt(e,void 0==t?e.v:t))}function Zt(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function qt(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense;null!=f&&null==i&&(i=f);var a=e||(i?[]:{}),s=0,o=0;if(a&&null!=r.origin)if("number"==typeof r.origin)s=r.origin;else{var l="string"==typeof r.origin?Ut(r.origin):r.origin;s=l.r,o=l.c}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=jt(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==s&&(c.e.r=s=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if(void 0!==t[h][d]){var p={v:t[h][d]},m=s+h,v=o+d;if(c.s.r>m&&(c.s.r=m),c.s.c>v&&(c.s.c=v),c.e.r<m&&(c.e.r=m),c.e.c<v&&(c.e.c=v),!t[h][d]||"object"!=typeof t[h][d]||Array.isArray(t[h][d])||t[h][d]instanceof Date)if(Array.isArray(p.v)&&(p.f=t[h][d][1],p.v=p.v[0]),null===p.v)if(p.f)p.t="n";else{if(!r.sheetStubs)continue;p.t="z"}else"number"==typeof p.v?p.t="n":"boolean"==typeof p.v?p.t="b":p.v instanceof Date?(p.z=r.dateNF||R._table[14],r.cellDates?(p.t="d",p.w=R.format(p.z,H(p.v))):(p.t="n",p.v=H(p.v),p.w=R.format(p.z,p.v))):p.t="s";else p=t[h][d];if(i)a[m]||(a[m]=[]),a[m][v]&&a[m][v].z&&(p.z=a[m][v].z),a[m][v]=p;else{var g=Ht({c:v,r:m});a[g]&&a[g].z&&(p.z=a[g].z),a[g]=p}}}return c.s.c<1e7&&(a["!ref"]=Gt(c)),a}function Qt(e,t){return qt(null,e,t)}function Jt(e,t){return t||(t=Pt(4)),t._W(4,e),t}function en(e){var t=e._R(4);return 0===t?"":e._R(t,"dbcs")}function tn(e,t){var n=!1;return null==t&&(n=!0,t=Pt(4+2*e.length)),t._W(4,e.length),e.length>0&&t._W(0,e,"dbcs"),n?t.slice(0,t.l):t}function nn(e){return{ich:e._R(2),ifnt:e._R(2)}}function rn(e,t){var n=e.l,r=e._R(1),i=en(e),a=[],s={t:i,h:i};if(0!=(1&r)){for(var o=e._R(4),l=0;l!=o;++l)a.push(nn(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=n+t,s}!function(e,t){var n;if(void 0!==t)n=t;else if("undefined"!=typeof require)try{n=void 0}catch(e){n=null}e.rc4=function(e,t){var n=new Array(256),r=0,i=0,a=0,s=0;for(i=0;256!=i;++i)n[i]=i;for(i=0;256!=i;++i)a=a+n[i]+e[i%e.length].charCodeAt(0)&255,s=n[i],n[i]=n[a],n[a]=s;i=a=0;var o=Buffer(t.length);for(r=0;r!=t.length;++r)a=(a+n[i=i+1&255])%256,s=n[i],n[i]=n[a],n[a]=s,o[r]=t[r]^n[n[i]+n[a]&255];return o},e.md5=function(e){if(!n)throw new Error("Unsupported crypto");return n.createHash("md5").update(e).digest("hex")}}({},"undefined"!=typeof crypto?crypto:void 0);var an=rn;function sn(e,t){var n=!1;return null==t&&(n=!0,t=Pt(23+4*e.t.length)),t._W(1,1),tn(e.t,t),t._W(4,1),function(e,t){t||(t=Pt(4)),t._W(2,e.ich||0),t._W(2,e.ifnt||0)}({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function on(e){var t=e._R(4),n=e._R(2);return n+=e._R(1)<<16,e.l++,{c:t,iStyleRef:n}}function ln(e,t){return null==t&&(t=Pt(8)),t._W(-4,e.c),t._W(3,e.iStyleRef||e.s),t._W(1,0),t}var cn=en,un=tn;function hn(e){var t=e._R(4);return 0===t||4294967295===t?"":e._R(t,"dbcs")}function dn(e,t){var n=!1;return null==t&&(n=!0,t=Pt(127)),t._W(4,e.length>0?e.length:4294967295),e.length>0&&t._W(0,e,"dbcs"),n?t.slice(0,t.l):t}var fn=en,pn=hn,mn=dn;function vn(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4,t[0]&=252;var i=0===r?ht([0,0,0,0,t[0],t[1],t[2],t[3]],0):yt(t,0)>>2;return n?i/100:i}function gn(e){var t={s:{},e:{}};return t.s.r=e._R(4),t.e.r=e._R(4),t.s.c=e._R(4),t.e.c=e._R(4),t}var bn=gn,Sn=function(e,t){return t||(t=Pt(16)),t._W(4,e.s.r),t._W(4,e.e.r),t._W(4,e.s.c),t._W(4,e.e.c),t};function yn(e){return e._R(8,"f")}function xn(e,t){return(t||Pt(8))._W(8,e,"f")}var wn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},_n=W(wn);function Cn(e,t){if(t||(t=Pt(8)),!e||e.auto)return t._W(4,0),t._W(4,0),t;null!=e.index?(t._W(1,2),t._W(1,e.index)):null!=e.theme?(t._W(1,6),t._W(1,e.theme)):(t._W(1,5),t._W(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t._W(2,n),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t._W(1,parseInt(r.slice(0,2),16)),t._W(1,parseInt(r.slice(2,4),16)),t._W(1,parseInt(r.slice(4,6),16)),t._W(1,255)}else t._W(2,0),t._W(1,0),t._W(1,0);return t}function En(e,t){var n=e._R(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e._R(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e._R(0,1==t?"lpstr":"lpwstr")}var kn=2,Rn=3,Tn=12,An=81,Pn=[80,An],Bn={1:{n:"CodePage",t:kn},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:Rn},5:{n:"LineCount",t:Rn},6:{n:"ParagraphCount",t:Rn},7:{n:"SlideCount",t:Rn},8:{n:"NoteCount",t:Rn},9:{n:"HiddenCount",t:Rn},10:{n:"MultimediaClipCount",t:Rn},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4096|Tn},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:Rn},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:Rn,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{}},Mn={1:{n:"CodePage",t:kn},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:Rn},15:{n:"WordCount",t:Rn},16:{n:"CharCount",t:Rn},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:Rn},255:{}},In={2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};!function(){for(var e in In)In.hasOwnProperty(e)&&(Bn[e]=Mn[e]=In[e])}();var Dn=N(Bn,"n"),Ln=N(Mn,"n"),Fn={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},On=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];var Nn=q(function(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),zn={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.sheetMetadata":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"TODO","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"vba","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Wn=function(){var e={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};return O(e).forEach(function(t){["xlsm","xlam"].forEach(function(n){e[t][n]||(e[t][n]=e[t].xlsx)})}),O(e).forEach(function(t){O(e[t]).forEach(function(n){zn[e[t][n]]=t})}),e}(),Vn=function(e){for(var t=[],n=O(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(zn);je.CT="http://schemas.openxmlformats.org/package/2006/content-types";var $n=Xe("Types",null,{xmlns:je.CT,"xmlns:xsd":je.xsd,"xmlns:xsi":je.xsi}),Un=[["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels",Vn.rels[0]]].map(function(e){return Xe("Default",null,{Extension:e[0],ContentType:e[1]})});var Hn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Xn(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Gn(e,t){var n={"!id":{}};if(!e)return n;"/"!==t.charAt(0)&&(t="/"+t);var r={};return(e.match(pe)||[]).forEach(function(e){var i=ge(e);if("<Relationship"===i[0]){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,a.TargetMode=i.TargetMode;var s="External"===i.TargetMode?i.Target:he(i.Target,t);n[s]=a,r[i.Id]=a}}),n["!id"]=r,n}je.RELS="http://schemas.openxmlformats.org/package/2006/relationships";var jn=Xe("Relationships",null,{xmlns:je.RELS});function Yn(e){var t=[de,jn];return O(e["!id"]).forEach(function(n){t[t.length]=Xe("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}var Kn=[Hn.HLINK,Hn.XPATH,Hn.XMISS];function Zn(e,t,n,r,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),t<0)for(t=1;e["!id"]["rId"+t];++t);if(i.Id="rId"+t,i.Type=r,i.Target=n,a?i.TargetMode=a:Kn.indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var qn="application/vnd.oasis.opendocument.spreadsheet";function Qn(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function Jn(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}var er=function(){var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+e.version+"</meta:generator></office:meta></office:document-meta>";return function(){return t}}(),tr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];je.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Hn.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties";var nr=function(){for(var e=new Array(tr.length),t=0;t<tr.length;++t){var n=tr[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function rr(e){var t={};e=Be(e);for(var n=0;n<tr.length;++n){var r=tr[n],i=e.match(nr[n]);null!=i&&i.length>0&&(t[r[1]]=xe(i[1])),"date"===r[2]&&t[r[1]]&&(t[r[1]]=K(t[r[1]]))}return t}var ir=Xe("cp:coreProperties",null,{"xmlns:cp":je.CORE_PROPS,"xmlns:dc":je.dc,"xmlns:dcterms":je.dcterms,"xmlns:dcmitype":je.dcmitype,"xmlns:xsi":je.xsi});function ar(e,t,n,r,i){null==i[e]&&null!=t&&""!==t&&(i[e]=t,t=Ce(t),r[r.length]=n?Xe(e,t,n):Ue(e,t))}var sr=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];je.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Hn.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties";function or(e,t,n,r){var i=[];if("string"==typeof e)i=Ve(e,r);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(e){return{v:e}}));var s="string"==typeof t?Ve(t,r).map(function(e){return e.v}):t,o=0,l=0;if(s.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":n.Worksheets=l,n.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":n.NamedRanges=l,n.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":n.Chartsheets=l,n.ChartNames=s.slice(o,o+l)}o+=l}}var lr=Xe("Properties",null,{xmlns:je.EXT_PROPS,"xmlns:vt":je.vt});je.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Hn.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties";var cr=/<[^>]+>[^<]*/g;var ur=Xe("Properties",null,{xmlns:je.CUST_PROPS,"xmlns:vt":je.vt});function hr(e){var t=[de,ur];if(!e)return t.join("");var n=1;return O(e).forEach(function(r){++n,t[t.length]=Xe("property",function(e){switch(typeof e){case"string":return Xe("vt:lpwstr",Ce(e));case"number":return Xe((0|e)==e?"vt:i4":"vt:r8",Ce(String(e)));case"boolean":return Xe("vt:bool",e?"true":"false")}if(e instanceof Date)return Xe("vt:filetime",Ge(e));throw new Error("Unable to serialize "+e)}(e[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Ce(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var dr={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},fr=z(dr);function pr(e,t,n){e[t=fr[t]||t]=n}function mr(e){var t=e._R(4),n=e._R(4);return new Date(1e3*(n/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function vr(e,t,n){var r=e.l,i=e._R(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return i}function gr(e,t,n){var r=e._R(0,"lpwstr");return n&&(e.l+=4-(r.length+1&3)&3),r}function br(e,t,n){return 31===t?gr(e):vr(e,0,n)}function Sr(e,t,n){return br(e,t,!1===n?0:4)}function yr(e){return function(e){for(var t=e._R(4),n=[],r=0;r!=t;++r)n[r]=e._R(0,"lpstr-cp").replace(E,"");return n}(e)}function xr(e){return[Er(e,An),Er(e,Rn)]}function wr(e){return function(e){for(var t=e._R(4),n=[],r=0;r!=t/2;++r)n.push(xr(e));return n}(e)}function _r(e,t){for(var n=e._R(4),r={},i=0;i!=n;++i){var a=e._R(4),s=e._R(4);r[a]=e._R(s,1200===t?"utf16le":"utf8").replace(E,"").replace(k,"!"),1200===t&&s%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),r}function Cr(e){var t=e._R(4),n=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),n}function Er(e,t,n){var r,i=e._R(2),a=n||{};if(e.l+=2,t!==Tn&&i!==t&&-1===Pn.indexOf(t))throw new Error("Expected type "+t+" saw "+i);switch(t===Tn?i:t){case 2:return r=e._R(2,"i"),a.raw||(e.l+=2),r;case 3:return r=e._R(4,"i");case 11:return 0!==e._R(4);case 19:return r=e._R(4);case 30:return vr(e,0,4).replace(E,"");case 31:return gr(e);case 64:return mr(e);case 65:return Cr(e);case 71:return function(e){var t={};return t.Size=e._R(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return Sr(e,i,!a.raw).replace(E,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return br(e,t,0)}(e,i).replace(E,"");case 4108:return wr(e);case 4126:return yr(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+i)}}function kr(e,t){var n=Pt(4),r=Pt(4);switch(n._W(4,80==e?31:e),e){case 3:r._W(-4,t);break;case 5:(r=Pt(8))._W(8,t,"f");break;case 11:r._W(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),r=(t-n)/Math.pow(2,32);r*=1e7;var i=(n*=1e7)/Math.pow(2,32)|0;i>0&&(n%=Math.pow(2,32),r+=i);var a=Pt(8);return a._W(4,n),a._W(4,r),a}(t);break;case 31:case 80:for((r=Pt(4+2*(t.length+1)+(t.length%2?0:2)))._W(4,t.length+1),r._W(0,t,"dbcs");r.l!=r.length;)r._W(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return C([n,r])}function Rr(e,t){var n=e.l,r=e._R(4),i=e._R(4),a=[],s=0,l=0,c=-1,u={};for(s=0;s!=i;++s){var h=e._R(4),d=e._R(4);a[s]=[h,d+n]}a.sort(function(e,t){return e[1]-t[1]});var f={};for(s=0;s!=i;++s){if(e.l!==a[s][1]){var p=!0;if(s>0&&t)switch(t[a[s-1][0]].t){case 2:e.l+2===a[s][1]&&(e.l+=2,p=!1);break;case 80:case 4108:e.l<=a[s][1]&&(e.l=a[s][1],p=!1)}if((!t||0==s)&&e.l<=a[s][1]&&(p=!1,e.l=a[s][1]),p)throw new Error("Read Error: Expected address "+a[s][1]+" at "+e.l+" :"+s)}if(t){var m=t[a[s][0]];if(f[m.n]=Er(e,m.t,{raw:!0}),"version"===m.p&&(f[m.n]=String(f[m.n]>>16)+"."+("0000"+String(65535&f[m.n])).slice(-4)),"CodePage"==m.n)switch(f[m.n]){case 0:f[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:o(l=f[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[m.n])}}else if(1===a[s][0]){if(l=f.CodePage=Er(e,kn),o(l),-1!==c){var v=e.l;e.l=a[c][1],u=_r(e,l),e.l=v}}else if(0===a[s][0]){if(0===l){c=s,e.l=a[s+1][1];continue}u=_r(e,l)}else{var g,b=u[a[s][0]];switch(e[e.l]){case 65:e.l+=4,g=Cr(e);break;case 30:case 31:e.l+=4,g=Sr(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e._R(4,"i");break;case 19:e.l+=4,g=e._R(4);break;case 5:e.l+=4,g=e._R(8,"f");break;case 11:e.l+=4,g=Dr(e,4);break;case 64:e.l+=4,g=K(mr(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[b]=g}}return e.l=n+r,f}var Tr=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"].concat(["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"]);function Ar(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Pr(e,t,n){var r=Pt(8),i=[],a=[],s=8,o=0,l=Pt(8),c=Pt(8);if(l._W(4,2),l._W(4,1200),c._W(4,1),a.push(l),i.push(c),s+=8+l.length,!t){(c=Pt(8))._W(4,0),i.unshift(c);var u=[Pt(4)];for(u[0]._W(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for((l=Pt(8+2*(h.length+1)+(h.length%2?0:2)))._W(4,o+2),l._W(4,h.length+1),l._W(0,h,"dbcs");l.l!=l.length;)l._W(1,0);u.push(l)}l=C(u),a.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(Tr.indexOf(e[o][0])>-1)&&null!=e[o][1]){var d=e[o][1],f=0;if(t){var p=n[f=+t[e[o][0]]];if("version"==p.p&&"string"==typeof d){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}l=kr(p.t,d)}else{var v=Ar(d);-1==v&&(v=31,d=String(d)),l=kr(v,d)}a.push(l),(c=Pt(8))._W(4,t?f:2+o),i.push(c),s+=8+l.length}var g=8*(a.length+1);for(o=0;o<a.length;++o)i[o]._W(4,g),g+=a[o].length;return r._W(4,s),r._W(4,a.length),C([r].concat(i).concat(a))}function Br(e,t,n){var r=e.content;if(!r)return{};Tt(r,0);var i,a,s,o,l=0;r.chk("feff","Byte Order: "),r._R(2);var c=r._R(4),u=r._R(16);if(u!==D.utils.consts.HEADER_CLSID&&u!==n)throw new Error("Bad PropertySet CLSID "+u);if(1!==(i=r._R(4))&&2!==i)throw new Error("Unrecognized #Sets: "+i);if(a=r._R(16),o=r._R(4),1===i&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);2===i&&(s=r._R(16),l=r._R(4));var h,d=Rr(r,t),f={SystemIdentifier:c};for(var p in d)f[p]=d[p];if(f.FMTID=a,1===i)return f;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);try{h=Rr(r,null)}catch(e){}for(p in h)f[p]=h[p];return f.FMTID=[a,s],f}function Mr(e,t,n,r,i,a){var s=Pt(i?68:48),o=[s];s._W(2,65534),s._W(2,0),s._W(4,842412599),s._W(16,D.utils.consts.HEADER_CLSID,"hex"),s._W(4,i?2:1),s._W(16,t,"hex"),s._W(4,i?68:48);var l=Pr(e,n,r);if(o.push(l),i){var c=Pr(i,null,null);s._W(16,a,"hex"),s._W(4,68+l.length),o.push(c)}return C(o)}function Ir(e,t){return e._R(t),null}function Dr(e,t){return 1===e._R(t)}function Lr(e,t){return t||(t=Pt(2)),t._W(2,+!!e),t}function Fr(e){return e._R(2,"u")}function Or(e,t){return t||(t=Pt(2)),t._W(2,e),t}function Nr(e,t){return function(e,t,n){for(var r=[],i=e.l+t;e.l<i;)r.push(n(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return r}(e,t,Fr)}function zr(e,n,r){var i=e._R(r&&r.biff>=12?2:1),a="sbcs-cont",s=t;(r&&r.biff>=8&&(t=1200),r&&8!=r.biff)?12==r.biff&&(a="wstr"):e._R(1)&&(a="dbcs-cont");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=i?e._R(i,a):"";return t=s,o}function Wr(e){var n=t;t=1200;var r,i=e._R(2),a=e._R(1),s=4&a,o=8&a,l=1+(1&a),c=0,u={};o&&(c=e._R(2)),s&&(r=e._R(4));var h=2==l?"dbcs-cont":"sbcs-cont",d=0===i?"":e._R(i,h);return o&&(e.l+=4*c),s&&(e.l+=r),u.t=d,o||(u.raw="<t>"+u.t+"</t>",u.r=u.t),t=n,u}function Vr(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e._R(t,"cpstr");if(n.biff>=12)return e._R(t,"dbcs-cont")}return 0===e._R(1)?e._R(t,"sbcs-cont"):e._R(t,"dbcs-cont")}function $r(e,t,n){var r=e._R(n&&2==n.biff?1:2);return 0===r?(e.l++,""):Vr(e,r,n)}function Ur(e,t,n){if(n.biff>5)return $r(e,0,n);var r=e._R(1);return 0===r?(e.l++,""):e._R(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Hr(e,t,n){return n||(n=Pt(3+2*e.length)),n._W(2,e.length),n._W(1,1),n._W(31,e,"utf16le"),n}function Xr(e,t){var n=e._R(16);switch(16,n){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e._R(4),n=e.l,r=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e._R(16)&&(r=!0),e.l=n);var i=e._R((r?t-24:t)>>1,"utf16le").replace(E,"");return r&&(e.l+=24),i}(e);case"0303000000000000c000000000000046":return function(e){e.l+=2;var t=e._R(0,"lpstr-ansi");if(e.l+=2,57005!=e._R(2))throw new Error("Bad FileMoniker");if(0===e._R(4))return t.replace(/\\/g,"/");var n=e._R(4);if(3!=e._R(2))throw new Error("Bad FileMoniker");return e._R(n>>1,"utf16le").replace(E,"")}(e);default:throw new Error("Unsupported Moniker "+n)}}function Gr(e){var t=e._R(4);return t>0?e._R(t,"utf16le").replace(E,""):""}function jr(e){return[e._R(1),e._R(1),e._R(1),e._R(1)]}function Yr(e,t){var n=jr(e);return n[3]=0,n}function Kr(e){return{r:e._R(2),c:e._R(2),ixfe:e._R(2)}}function Zr(e,t,n,r){return r||(r=Pt(6)),r._W(2,e),r._W(2,t),r._W(2,n||0),r}function qr(e,t,n){var r=n.biff>8?4:2;return[e._R(r),e._R(r,"i"),e._R(r,"i")]}function Qr(e){return[e._R(2),vn(e)]}function Jr(e){var t=e._R(2),n=e._R(2);return{s:{c:e._R(2),r:t},e:{c:e._R(2),r:n}}}function ei(e,t){return t||(t=Pt(8)),t._W(2,e.s.r),t._W(2,e.e.r),t._W(2,e.s.c),t._W(2,e.e.c),t}function ti(e){var t=e._R(2),n=e._R(2);return{s:{c:e._R(1),r:t},e:{c:e._R(1),r:n}}}var ni=ti;function ri(e){e.l+=4;var t=e._R(2),n=e._R(2),r=e._R(2);return e.l+=12,[n,t,r]}function ii(e){e.l+=2,e.l+=e._R(2)}var ai={0:ii,4:ii,5:ii,6:ii,7:function(e){return e.l+=4,e.cf=e._R(2),{}},8:ii,9:ii,10:ii,11:ii,12:ii,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e._R(2),e.l+=4,t},14:ii,15:ii,16:ii,17:ii,18:ii,19:ii,20:ii,21:ri};function si(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e._R(2),(t-=2)>=2&&(n.dt=e._R(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e._R(t),n}function oi(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Pt(i);return a._W(2,r),a._W(2,t),i>4&&a._W(2,29282),i>6&&a._W(2,1997),i>8&&(a._W(2,49161),a._W(2,1),a._W(2,1798),a._W(2,0)),a}function li(e,t){var n=!t||t.biff>=8?2:1,r=Pt(8+n*e.name.length);r._W(4,e.pos),r._W(1,e.hs||0),r._W(1,e.dt),r._W(1,e.name.length),t.biff>=8&&r._W(1,1),r._W(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function ci(e,t,n){var r=0;n&&2==n.biff||(r=e._R(2));var i=e._R(2);return n&&2==n.biff&&(r=1-(i>>15),i&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},i]}function ui(e,t,n,r){var i=n&&5==n.biff;r||(r=Pt(i?3+t.length:5+2*t.length)),r._W(2,e),r._W(i?1:2,t.length),i||r._W(1,1),r._W((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=r.length>r.l?r.slice(0,r.l):r;return null==a.l&&(a.l=a.length),a}var hi=Ur;function di(e,t,n){var r=e.l+t,i=8!=n.biff&&n.biff?2:4,a=e._R(i),s=e._R(i),o=e._R(2),l=e._R(2);return e.l=r,{s:{r:a,c:o},e:{r:s,c:l}}}function fi(e,t,n,r){var i=n&&5==n.biff;return r||(r=Pt(i?16:20)),r._W(2,0),e.style?(r._W(2,e.numFmtId||0),r._W(2,65524)):(r._W(2,e.numFmtId||0),r._W(2,t<<4)),r._W(4,0),r._W(4,0),i||r._W(4,0),r._W(2,0),r}function pi(e,t,n){var r=Kr(e);2==n.biff&&++e.l;var i=function(e){var t=e._R(1);return 1===e._R(1)?t:1===t}(e);return r.val=i,r.t=!0===i||!1===i?"b":"e",r}function mi(e,t,n,r,i,a){var s=Pt(8);return Zr(e,t,r,s),function(e,t,n){n||(n=Pt(2)),n._W(1,+e),n._W(1,"e"==t?1:0)}(n,a,s),s}var vi=function(e,t,n){return 0===t?"":Ur(e,0,n)};function gi(e,t,n){var r,i=e._R(2),a={fBuiltIn:1&i,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return 14849===n.sbcch&&(r=function(e,t,n){e.l+=4,t-=4;var r=e.l+t,i=zr(e,0,n),a=e._R(2);if(a!==(r-=e.l))throw new Error("Malformed AddinUdf: padding = "+r+" != "+a);return e.l+=a,i}(e,t-2,n)),a.body=r||e._R(t-2),"string"==typeof r&&(a.Name=r),a}var bi=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Si(e,t,n){var r=e.l+t,i=e._R(2),a=e._R(1),s=e._R(1),o=e._R(n&&2==n.biff?1:2),l=0;(!n||n.biff>=5)&&(5!=n.biff&&(e.l+=2),l=e._R(2),5==n.biff&&(e.l+=2),e.l+=4);var c=Vr(e,s,n);32&i&&(c=bi[c.charCodeAt(0)]);var u=r-e.l;return n&&2==n.biff&&--u,{chKey:a,Name:c,itab:l,rgce:r==e.l||0===o?[]:function(e,t,n,r){var i,a=e.l+t,s=Ls(e,r,n);a!==e.l&&(i=Ds(e,a-e.l,s,n));return[s,i]}(e,u,n,o)}}function yi(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=zr(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],i=e.l+t,a=e._R(n.biff>8?4:2);0!=a--;)r.push(qr(e,n.biff,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function xi(e,t,n){var r=ni(e,6);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,function(e,t,n){var r,i=e.l+t,a=2==n.biff?1:2,s=e._R(a);if(65535==s)return[[],At(e,t-2)];var o=Ls(e,s,n);t!==s+a&&(r=Ds(e,t-s-a,o,n));return e.l=i,[o,r]}(e,t,n)]}var wi=[];function _i(e){var t=Pt(24),n=Ut(e[0]);t._W(2,n.r),t._W(2,n.r),t._W(2,n.c),t._W(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t._W(1,parseInt(r[i],16));return C([t,function(e){var t=Pt(512),n=0,r=e.Target,i=r.indexOf("#")>-1?31:23;switch(r.charAt(0)){case"#":i=28;break;case".":i&=-3}t._W(4,2),t._W(4,i);var a=[8,6815827,6619237,4849780,83];for(n=0;n<a.length;++n)t._W(4,a[n]);if(28==i){for(r=r.slice(1),t._W(4,r.length+1),n=0;n<r.length;++n)t._W(2,r.charCodeAt(n));t._W(2,0)}else if(2&i){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<a.length;++n)t._W(1,parseInt(a[n],16));for(t._W(4,2*(r.length+1)),n=0;n<r.length;++n)t._W(2,r.charCodeAt(n));t._W(2,0)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<a.length;++n)t._W(1,parseInt(a[n],16));for(var s=0;"../"==r.slice(3*s,3*s+3)||"..\\"==r.slice(3*s,3*s+3);)++s;for(t._W(2,s),t._W(4,r.length+1),n=0;n<r.length;++n)t._W(1,255&r.charCodeAt(n));for(t._W(1,0),t._W(2,65535),t._W(2,57005),n=0;n<6;++n)t._W(4,0)}return t.slice(0,t.l)}(e[1])])}function Ci(e){var t=e[1].Tooltip,n=Pt(10+2*(t.length+1));n._W(2,2048);var r=Ut(e[0]);n._W(2,r.r),n._W(2,r.r),n._W(2,r.c),n._W(2,r.c);for(var i=0;i<t.length;++i)n._W(2,t.charCodeAt(i));return n._W(2,0),n}function Ei(e,t,n){if(!n.cellStyles)return At(e,t);var r=n&&n.biff>=12?4:2,i=e._R(r),a=e._R(r),s=e._R(r),o=e._R(r),l=e._R(2);2==r&&(e.l+=2);var c={s:i,e:a,w:s,ixfe:o,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}wi[8]=function(e,t){var n=e.l+t;e.l+=10;var r=e._R(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e._R(1);return e.l+=i,e.l=n,{fmt:r}};var ki=Kr,Ri=Nr,Ti=$r;var Ai=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,255:16969},t=z({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,n){var r=[],i=b(1);switch(n.type){case"base64":i=y(p.decode(t));break;case"binary":i=y(t);break;case"buffer":case"array":i=t}Tt(i,0);var a=i._R(1),s=!1,o=!1,l=!1;switch(a){case 2:case 3:break;case 48:o=!0,s=!0;break;case 49:o=!0;break;case 131:case 139:s=!0;break;case 140:s=!0,l=!0;break;case 245:s=!0;break;default:throw new Error("DBF Unsupported Version: "+a.toString(16))}var c=0,u=0;2==a&&(c=i._R(2)),i.l+=3,2!=a&&(c=i._R(4)),2!=a&&(u=i._R(2));var h=i._R(2),d=1252;2!=a&&(i.l+=16,i._R(1),0!==i[i.l]&&(d=e[i[i.l]]),i.l+=1,i.l+=2),l&&(i.l+=36);for(var f=[],m={},v=u-10-(o?264:0),g=l?32:11;2==a?i.l<i.length&&13!=i[i.l]:i.l<v;)switch((m={}).name=cptable.utils.decode(d,i.slice(i.l,i.l+g)).replace(/[\u0000\r\n].*$/g,""),i.l+=g,m.type=String.fromCharCode(i._R(1)),2==a||l||(m.offset=i._R(4)),m.len=i._R(1),2==a&&(m.offset=i._R(2)),m.dec=i._R(1),m.name.length&&f.push(m),2!=a&&(i.l+=l?13:14),m.type){case"B":o&&8==m.len||!n.WTF||console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":case"0":case"@":case"+":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==i[i.l]?i.l=u-1:2==a&&(i.l=521),2!=a){if(13!==i._R(1))throw new Error("DBF Terminator not found "+i.l+" "+i[i.l]);i.l=u}var S=0,x=0;for(r[0]=[],x=0;x!=f.length;++x)r[0][x]=f[x].name;for(;c-- >0;)if(42!==i[i.l])for(++i.l,r[++S]=[],x=0,x=0;x!=f.length;++x){var w=i.slice(i.l,i.l+f[x].len);i.l+=f[x].len,Tt(w,0);var _=cptable.utils.decode(d,w);switch(f[x].type){case"C":r[S][x]=cptable.utils.decode(d,w),r[S][x]=r[S][x].trim();break;case"D":8===_.length?r[S][x]=new Date(+_.slice(0,4),+_.slice(4,6)-1,+_.slice(6,8)):r[S][x]=_;break;case"F":r[S][x]=parseFloat(_.trim());break;case"+":case"I":r[S][x]=l?2147483648^w._R(-4,"i"):w._R(4,"i");break;case"L":switch(_.toUpperCase()){case"Y":case"T":r[S][x]=!0;break;case"N":case"F":r[S][x]=!1;break;case" ":case"?":r[S][x]=!1;break;default:throw new Error("DBF Unrecognized L:|"+_+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+a.toString(16));r[S][x]="##MEMO##"+(l?parseInt(_.trim(),10):w._R(4));break;case"N":r[S][x]=+_.replace(/\u0000/g,"").trim();break;case"@":r[S][x]=new Date(w._R(-8,"f")-621356832e5);break;case"T":r[S][x]=new Date(864e5*(w._R(4)-2440588)+w._R(4));break;case"Y":r[S][x]=w._R(4,"i")/1e4;break;case"O":r[S][x]=-w._R(-8,"f");break;case"B":if(o&&8==f[x].len){r[S][x]=w._R(8,"f");break}case"G":case"P":w.l+=f[x].len;break;case"0":if("_NullFlags"===f[x].name)break;default:throw new Error("DBF Unsupported data type "+f[x].type)}}else i.l+=h;if(2!=a&&i.l<i.length&&26!=i[i.l++])throw new Error("DBF EOF Marker missing "+(i.l-1)+" of "+i.length+" "+i[i.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),r}function i(e,t){var n=t||{};return n.dateNF||(n.dateNF="yyyymmdd"),Qt(r(e,n),n)}var a={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return Zt(i(e,t),t)}catch(e){if(t&&t.WTF)throw e}return{SheetNames:[],Sheets:{}}},to_sheet:i,from_sheet:function(e,r){var i=r||{};if(+i.codepage>=0&&o(+i.codepage),"string"==i.type)throw new Error("Cannot write DBF to JS string");var s=Mt(),l=jc(e,{header:1,raw:!0,cellDates:!0}),c=l[0],u=l.slice(1),h=0,d=0,f=0,p=1;for(h=0;h<c.length;++h)if(null!=h){if(++f,"number"==typeof c[h]&&(c[h]=c[h].toString(10)),"string"!=typeof c[h])throw new Error("DBF Invalid column name "+c[h]+" |"+typeof c[h]+"|");if(c.indexOf(c[h])!==h)for(d=0;d<1024;++d)if(-1==c.indexOf(c[h]+"_"+d)){c[h]+="_"+d;break}}var m=jt(e["!ref"]),v=[];for(h=0;h<=m.e.c-m.s.c;++h){var g=[];for(d=0;d<u.length;++d)null!=u[d][h]&&g.push(u[d][h]);if(0!=g.length&&null!=c[h]){var b="",S="";for(d=0;d<g.length;++d){switch(typeof g[d]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=g[d]instanceof Date?"D":"C";break;default:S="C"}if("C"==(b=b&&b!=S?"C":S))break}p+=a[b]||0,v[h]=b}else v[h]="?"}var y=s.next(32);for(y._W(4,318902576),y._W(4,u.length),y._W(2,296+32*f),y._W(2,p),h=0;h<4;++h)y._W(4,0);for(y._W(4,0|(+t[n]||3)<<8),h=0,d=0;h<c.length;++h)if(null!=c[h]){var x=s.next(32),w=(c[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);x._W(1,w,"sbcs"),x._W(1,"?"==v[h]?"C":v[h],"sbcs"),x._W(4,d),x._W(1,a[v[h]]||0),x._W(1,0),x._W(1,2),x._W(4,0),x._W(1,0),x._W(4,0),x._W(4,0),d+=a[v[h]]||0}var _=s.next(264);for(_._W(4,13),h=0;h<65;++h)_._W(4,0);for(h=0;h<u.length;++h){var C=s.next(p);for(C._W(1,0),d=0;d<c.length;++d)if(null!=c[d])switch(v[d]){case"L":C._W(1,null==u[h][d]?63:u[h][d]?84:70);break;case"B":C._W(8,u[h][d]||0,"f");break;case"D":u[h][d]?(C._W(4,("0000"+u[h][d].getFullYear()).slice(-4),"sbcs"),C._W(2,("00"+(u[h][d].getMonth()+1)).slice(-2),"sbcs"),C._W(2,("00"+u[h][d].getDate()).slice(-2),"sbcs")):C._W(8,"00000000","sbcs");break;case"C":var E=String(u[h][d]||"");for(C._W(1,E,"sbcs"),f=0;f<250-E.length;++f)C._W(1,32)}}return s.next(1)._W(1,26),s.end()}}}(),Pi=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,B:180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("N("+O(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?d(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:d(r)};function i(e,t){switch(t.type){case"base64":return a(p.decode(e),t);case"binary":return a(e,t);case"buffer":return a(e.toString("binary"),t);case"array":return a(Z(e),t)}throw new Error("Unrecognized type "+t.type)}function a(e,i){var a,s=e.split(/[\n\r]+/),l=-1,c=-1,u=0,h=0,d=[],f=[],p=null,m={},v=[],g=[],b=[],S=0;for(+i.codepage>=0&&o(+i.codepage);u!==s.length;++u){S=0;var y,x=s[u].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),w=x.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),_=w[0];if(x.length>0)switch(_){case"ID":case"E":case"B":case"O":break;case"P":"P"==w[1].charAt(0)&&f.push(x.slice(3).replace(/;;/g,";"));break;case"C":var C=!1,E=!1;for(h=1;h<w.length;++h)switch(w[h].charAt(0)){case"X":c=parseInt(w[h].slice(1))-1,E=!0;break;case"Y":for(l=parseInt(w[h].slice(1))-1,E||(c=0),a=d.length;a<=l;++a)d[a]=[];break;case"K":'"'===(y=w[h].slice(1)).charAt(0)?y=y.slice(1,y.length-1):"TRUE"===y?y=!0:"FALSE"===y?y=!1:isNaN(J(y))?isNaN(ee(y).getDate())||(y=K(y)):(y=J(y),null!==p&&R.is_date(p)&&(y=X(y))),"undefined"!=typeof cptable&&"string"==typeof y&&"string"!=(i||{}).type&&(i||{}).codepage&&(y=cptable.utils.decode(i.codepage,y)),C=!0;break;case"E":var k=rs(w[h].slice(1),{r:l,c:c});d[l][c]=[d[l][c],k];break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+x)}C&&(d[l][c]=y,p=null);break;case"F":var T=0;for(h=1;h<w.length;++h)switch(w[h].charAt(0)){case"X":c=parseInt(w[h].slice(1))-1,++T;break;case"Y":for(l=parseInt(w[h].slice(1))-1,a=d.length;a<=l;++a)d[a]=[];break;case"M":S=parseInt(w[h].slice(1))/20;break;case"F":case"G":break;case"P":p=f[parseInt(w[h].slice(1))];break;case"S":case"D":case"N":break;case"W":for(b=w[h].slice(1).split(" "),a=parseInt(b[0],10);a<=parseInt(b[1],10);++a)S=parseInt(b[2],10),g[a-1]=0===S?{hidden:!0}:{wch:S},ga(g[a-1]);break;case"C":g[c=parseInt(w[h].slice(1))-1]||(g[c]={});break;case"R":v[l=parseInt(w[h].slice(1))-1]||(v[l]={}),S>0?(v[l].hpt=S,v[l].hpx=ya(S)):0===S&&(v[l].hidden=!0);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+x)}T<1&&(p=null);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+x)}}return v.length>0&&(m["!rows"]=v),g.length>0&&(m["!cols"]=g),i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),[d,m]}function s(e,t){var n=i(e,t),r=n[0],a=n[1],s=Qt(r,t);return O(a).forEach(function(e){s[e]=a[e]}),s}function l(e,t,n,r){var i="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":i+=e.v||0,e.f&&!e.F&&(i+=";E"+as(e.f,{r:n,c:r}));break;case"b":i+=e.v?"TRUE":"FALSE";break;case"e":i+=e.w||e.v;break;case"d":i+='"'+(e.w||e.v)+'"';break;case"s":i+='"'+e.v.replace(/"/g,"")+'"'}return i}return e["|"]=254,{to_workbook:function(e,t){return Zt(s(e,t),t)},to_sheet:s,from_sheet:function(e,t){var n,r=["ID;PWXL;N;E"],i=[],a=jt(e["!ref"]),s=Array.isArray(e),o="\r\n";r.push("P;PGeneral"),r.push("F;P0;DG0G8;M255"),e["!cols"]&&function(e,t){t.forEach(function(t,n){var r="F;W"+(n+1)+" "+(n+1)+" ";t.hidden?r+="0":("number"==typeof t.width&&(t.wpx=da(t.width)),"number"==typeof t.wpx&&(t.wch=fa(t.wpx)),"number"==typeof t.wch&&(r+=Math.round(t.wch)))," "!=r.charAt(r.length-1)&&e.push(r)})}(r,e["!cols"]),e["!rows"]&&function(e,t){t.forEach(function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*Sa(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))})}(r,e["!rows"]),r.push("B;Y"+(a.e.r-a.s.r+1)+";X"+(a.e.c-a.s.c+1)+";D"+[a.s.c,a.s.r,a.e.c,a.e.r].join(" "));for(var c=a.s.r;c<=a.e.r;++c)for(var u=a.s.c;u<=a.e.c;++u){var h=Ht({r:c,c:u});(n=s?(e[c]||[])[u]:e[h])&&(null!=n.v||n.f&&!n.F)&&i.push(l(n,0,c,u))}return r.join(o)+o+i.join(o)+o+"E"+o}}}(),Bi=function(){function e(e,n){switch(n.type){case"base64":return t(p.decode(e),n);case"binary":return t(e,n);case"buffer":return t(e.toString("binary"),n);case"array":return t(Z(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){for(var n=e.split("\n"),r=-1,i=-1,a=0,s=[];a!==n.length;++a)if("BOT"!==n[a].trim()){if(!(r<0)){var o=n[a].trim().split(","),l=o[0],c=o[1],u=n[++a].trim();switch(+l){case-1:if("BOT"===u){s[++r]=[],i=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[r][i]=!0:"FALSE"===u?s[r][i]=!1:isNaN(J(c))?isNaN(ee(c).getDate())?s[r][i]=c:s[r][i]=K(c):s[r][i]=J(c),++i;break;case 1:u=u.slice(1,u.length-1),s[r][i++]=""!==u?u:null}if("EOD"===u)break}}else s[++r]=[],i=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function n(t,n){return Qt(e(t,n),n)}return{to_workbook:function(e,t){return Zt(n(e,t),t)},to_sheet:n,from_sheet:function(){var e=function(e,t,n,r,i){e.push(t),e.push(n+","+r),e.push('"'+i.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,i=[],a=jt(n["!ref"]),s=Array.isArray(n);e(i,"TABLE",0,1,"sheetjs"),e(i,"VECTORS",0,a.e.r-a.s.r+1,""),e(i,"TUPLES",0,a.e.c-a.s.c+1,""),e(i,"DATA",0,0,"");for(var o=a.s.r;o<=a.e.r;++o){t(i,-1,0,"BOT");for(var l=a.s.c;l<=a.e.c;++l){var c=Ht({r:o,c:l});if(r=s?(n[o]||[])[l]:n[c])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(i,1,0,"="+r.f):t(i,1,0,""):t(i,0,u,"V");break;case"b":t(i,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(i,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=R.format(r.z||R._table[14],H(K(r.v)))),t(i,0,r.w,"V");break;default:t(i,1,0,"")}else t(i,1,0,"")}}t(i,-1,0,"EOD");return i.join("\r\n")}}()}}(),Mi=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(t,n){for(var r=t.split("\n"),i=-1,a=-1,s=0,o=[];s!==r.length;++s){var l=r[s].trim().split(":");if("cell"===l[0]){var c=Ut(l[1]);if(o.length<=c.r)for(i=o.length;i<=c.r;++i)o[i]||(o[i]=[]);switch(i=c.r,a=c.c,l[2]){case"t":o[i][a]=e(l[3]);break;case"v":o[i][a]=+l[3];break;case"vtf":var u=l[l.length-1];case"vtc":switch(l[3]){case"nl":o[i][a]=!!+l[4];break;default:o[i][a]=+l[4]}"vtf"==l[2]&&(o[i][a]=[o[i][a],u])}}}return n&&n.sheetRows&&(o=o.slice(0,n.sheetRows)),o}function r(e,t){return Qt(n(e,t),t)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),o="--SocialCalcSpreadsheetControlSave--";return{to_workbook:function(e,t){return Zt(r(e,t),t)},to_sheet:r,from_sheet:function(e){return[i,a,s,a,function(e){if(!e||!e["!ref"])return"";for(var n,r=[],i=[],a="",s=Xt(e["!ref"]),o=Array.isArray(e),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c)if(a=Ht({r:l,c:c}),(n=o?(e[l]||[])[c]:e[a])&&null!=n.v&&"z"!==n.t){switch(i=["cell",a,"t"],n.t){case"s":case"str":i.push(t(n.v));break;case"n":n.f?(i[2]="vtf",i[3]="n",i[4]=n.v,i[5]=t(n.f)):(i[2]="v",i[3]=n.v);break;case"b":i[2]="vt"+(n.f?"f":"c"),i[3]="nl",i[4]=n.v?"1":"0",i[5]=t(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=H(K(n.v));i[2]="vtc",i[3]="nd",i[4]=""+u,i[5]=n.w||R.format(n.z||R._table[14],u);break;case"e":continue}r.push(i.join(":"))}return r.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}(e),o].join("\n")}}}(),Ii=function(){function e(e,t,n,r,i){i.raw?t[n][r]=e:"TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:""===e||(isNaN(J(e))?isNaN(ee(e).getDate())?t[n][r]=e:t[n][r]=K(e):t[n][r]=J(e))}function t(t,n){var r=n||{},i=[];if(!t||0===t.length)return i;for(var a=t.split(/[\r\n]/),s=a.length-1;s>=0&&0===a[s].length;)--s;for(var o=10,l=0,c=0;c<=s;++c)-1==(l=a[c].indexOf(" "))?l=a[c].length:l++,o=Math.max(o,l);for(c=0;c<=s;++c){i[c]=[];var u=0;for(e(a[c].slice(0,o).trim(),i,c,u,r),u=1;u<=(a[c].length-o)/10+1;++u)e(a[c].slice(o+10*(u-1),o+10*u).trim(),i,c,u,r)}return r.sheetRows&&(i=i.slice(0,r.sheetRows)),i}var n={44:",",9:"\t",59:";"},r={44:3,9:2,59:1};function i(e){for(var t={},i=!1,a=0,s=0;a<e.length;++a)34==(s=e.charCodeAt(a))?i=!i:!i&&s in n&&(t[s]=(t[s]||0)+1);for(a in s=[],t)t.hasOwnProperty(a)&&s.push([t[a],a]);if(!s.length)for(a in t=r)t.hasOwnProperty(a)&&s.push([t[a],a]);return s.sort(function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]}),n[s.pop()[1]]}function a(e,t){var n=t||{},r="";null!=f&&null==n.dense&&(n.dense=f);var a=n.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)&&10==e.charCodeAt(5)?(r=e.charAt(4),e=e.slice(6)):r=i(e.slice(0,1024));var o=0,l=0,c=0,u=0,h=0,d=r.charCodeAt(0),p=!1,m=0;e=e.replace(/\r\n/gm,"\n");var v=null!=n.dateNF?function(e){var t="number"==typeof e?R._table[e]:e;return t=t.replace(B,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function g(){var t=e.slice(u,h),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):!function(e){return 1!=e.length}(t)?(r.t="s",r.v=t):(r.t="n",r.f=t.slice(1));else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=J(t)))if(!isNaN(ee(t).getDate())||v&&t.match(v)){r.z=n.dateNF||R._table[14];var i=0;v&&t.match(v)&&(t=function(e,t,n){var r=-1,i=-1,a=-1,s=-1,o=-1,l=-1;(t.match(B)||[]).forEach(function(e,t){var c=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":a=c;break;case"h":s=c;break;case"s":l=c;break;case"m":s>=0?o=c:i=c}}),l>=0&&-1==o&&i>=0&&(o=i,i=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==s&&-1==o&&-1==l?c:-1==r&&-1==i&&-1==a?u:c+"T"+u}(0,n.dateNF,t.match(v)||[]),i=1),n.cellDates?(r.t="d",r.v=K(t,i)):(r.t="n",r.v=H(K(t,i))),!1!==n.cellText&&(r.w=R.format(r.z,r.v instanceof Date?H(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=c;if("z"==r.t||(n.dense?(a[o]||(a[o]=[]),a[o][l]=r):a[Ht({c:l,r:o})]=r),u=h+1,s.e.c<l&&(s.e.c=l),s.e.r<o&&(s.e.r=o),m==d)++l;else if(l=0,++o,n.sheetRows&&n.sheetRows<=o)return!0}e:for(;h<e.length;++h)switch(m=e.charCodeAt(h)){case 34:p=!p;break;case d:case 10:case 13:if(!p&&g())break e}return h-u>0&&g(),a["!ref"]=Gt(s),a}function s(e,n){return"sep="==e.slice(0,4)?a(e,n):e.indexOf("\t")>=0||e.indexOf(",")>=0||e.indexOf(";")>=0?a(e,n):Qt(t(e,n),n)}function o(e,t){var n="",r="string"==t.type?[0,0,0,0]:Dc(e,t);switch(t.type){case"base64":n=p.decode(e);break;case"binary":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!=typeof cptable?cptable.utils.decode(t.codepage,e):e.toString("binary");break;case"array":n=Z(e);break;case"string":n=e;break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=Be(n.slice(3)):"binary"==t.type&&"undefined"!=typeof cptable&&t.codepage&&(n=cptable.utils.decode(t.codepage,cptable.utils.encode(1252,n))),"socialcalc:version:"==n.slice(0,19)?Mi.to_sheet("string"==t.type?n:Be(n),t):s(n,t)}return{to_workbook:function(e,t){return Zt(o(e,t),t)},to_sheet:o,from_sheet:function(e){for(var t,n=[],r=jt(e["!ref"]),i=Array.isArray(e),a=r.s.r;a<=r.e.r;++a){for(var s=[],o=r.s.c;o<=r.e.c;++o){var l=Ht({r:a,c:o});if((t=i?(e[a]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(Kt(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";s.push(c+(0===o?" ":""))}else s.push("          ")}n.push(s.join(""))}return n.join("\n")}}}();var Di=function(){function e(e,t){if(!e)return e;var n=t||{};null!=f&&null==n.dense&&(n.dense=f);var r=n.dense?[]:{},i="Sheet1",a=0,l={},c=[i],u={s:{r:0,c:0},e:{r:0,c:0}},h=n.sheetRows||0;if(2==e[2])n.Enum=s;else if(26==e[2])n.Enum=o;else{if(14!=e[2])throw new Error("Unrecognized LOTUS BOF "+e[2]);n.Enum=o,n.qpro=!0,e.l=0}return function(e,t,n){if(e){Tt(e,e.l||0);for(var r=n.Enum||s;e.l<e.length;){var i=e._R(2),a=r[i]||r[255],o=e._R(2),l=e.l+o,c=(a.f||At)(e,o,n);if(e.l=l,t(c,a.n,i))return}}}(e,function(t,s,o){if(2==e[2])switch(o){case 0:n.vers=t,t>=4096&&(n.qpro=!0);break;case 6:u=t;break;case 15:n.qpro||(t[1].v=t[1].v.slice(1));case 13:case 14:case 16:case 51:14==o&&112==(112&t[2])&&(15&t[2])>1&&(15&t[2])<15&&(t[1].z=n.dateNF||R._table[14],n.cellDates&&(t[1].t="d",t[1].v=X(t[1].v))),n.dense?(r[t[0].r]||(r[t[0].r]=[]),r[t[0].r][t[0].c]=t[1]):r[Ht(t[0])]=t[1]}else switch(o){case 22:t[1].v=t[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(t[3]>a&&(r["!ref"]=Gt(u),l[i]=r,r=n.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},a=t[3],i="Sheet"+(a+1),c.push(i)),h>0&&t[0].r>=h)break;n.dense?(r[t[0].r]||(r[t[0].r]=[]),r[t[0].r][t[0].c]=t[1]):r[Ht(t[0])]=t[1],u.e.c<t[0].c&&(u.e.c=t[0].c),u.e.r<t[0].r&&(u.e.r=t[0].r)}},n),r["!ref"]=Gt(u),l[i]=r,{SheetNames:c,Sheets:l}}function t(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0];return n.qpro&&20768!=n.vers?(r[0].c=e._R(1),e.l++,r[0].r=e._R(2),e.l+=2):(r[2]=e._R(1),r[0].c=e._R(2),r[0].r=e._R(2)),r}function n(e,n,r){var i=e.l+n,a=t(e,0,r);if(a[1].t="s",20768==r.vers){e.l++;var s=e._R(1);return a[1].v=e._R(s,"utf8"),a}return r.qpro&&e.l++,a[1].v=e._R(i-e.l,"cstr"),a}function r(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e._R(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function i(e,t){var n=r(e),i=e._R(4),a=e._R(4),s=e._R(2);if(65535==s)return n[1].v=0,n;var o=32768&s;return s=(32767&s)-16446,n[1].v=(2*o-1)*((s>0?a<<s:a>>>-s)+(s>-32?i<<s+32:i>>>-(s+32))),n}function a(e,t){var n=r(e),i=e._R(8,"f");return n[1].v=i,n}var s={0:{n:"BOF",f:Fr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e){var t={s:{c:0,r:0},e:{c:0,r:0}};return t.s.c=e._R(2),t.s.r=e._R(2),t.e.c=e._R(2),t.e.r=e._R(2),65535==t.s.c&&(t.s.c=t.e.c=t.s.r=t.e.r=0),t}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,n,r){var i=t(e,0,r);return i[1].v=e._R(2,"i"),i}},14:{n:"NUMBER",f:function(e,n,r){var i=t(e,0,r);return i[1].v=e._R(8,"f"),i}},15:{n:"LABEL",f:n},16:{n:"FORMULA",f:function(e,n,r){var i=e.l+n,a=t(e,0,r);if(a[1].v=e._R(8,"f"),r.qpro)e.l=i;else{var s=e._R(2);e.l+=s}return a}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:n},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},255:{n:"",f:At}},o={0:{n:"BOF"},1:{n:"EOF"},3:{n:"??"},4:{n:"??"},5:{n:"??"},6:{n:"??"},7:{n:"??"},9:{n:"??"},10:{n:"??"},11:{n:"??"},12:{n:"??"},14:{n:"??"},15:{n:"??"},16:{n:"??"},17:{n:"??"},18:{n:"??"},19:{n:"??"},21:{n:"??"},22:{n:"LABEL16",f:function(e,t){var n=r(e);return n[1].t="s",n[1].v=e._R(t-4,"cstr"),n}},23:{n:"NUMBER17",f:i},24:{n:"NUMBER18",f:function(e,t){var n=r(e);n[1].v=e._R(2);var i=n[1].v>>1;if(1&n[1].v)switch(7&i){case 1:i=500*(i>>3);break;case 2:i=(i>>3)/20;break;case 4:i=(i>>3)/2e3;break;case 6:i=(i>>3)/16;break;case 7:i=(i>>3)/64;break;default:throw"unknown NUMBER_18 encoding "+(7&i)}return n[1].v=i,n}},25:{n:"FORMULA19",f:function(e,t){var n=i(e);return e.l+=t-14,n}},26:{n:"??"},27:{n:"??"},28:{n:"??"},29:{n:"??"},30:{n:"??"},31:{n:"??"},33:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=r(e),i=e._R(4);return n[1].v=i>>6,n}},39:{n:"NUMBER27",f:a},40:{n:"FORMULA28",f:function(e,t){var n=a(e);return e.l+=t-10,n}},255:{n:"",f:At}};return{to_workbook:function(t,n){switch(n.type){case"base64":return e(y(p.decode(t)),n);case"binary":return e(y(t),n);case"buffer":case"array":return e(t,n)}throw"Unsupported type "+n.type}}}();function Li(e){var t={},n=e.match(pe),r=0,i=!1;if(n)for(;r!=n.length;++r){var s=ge(n[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=a[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<family":t.family=s.val;break;case"<vertAlign":t.valign=s.val;break;case"<scheme":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(47!==s[0].charCodeAt(1)&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var Fi=function(){var e=Fe("t"),t=Fe("rPr");function n(n){var r=n.match(e);if(!r)return{t:"s",v:""};var i={t:"s",v:xe(r[1])},a=n.match(t);return a&&(i.s=Li(a[1])),i}var r=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(e){return e.replace(r,"").split(i).map(n).filter(function(e){return e.v})}}(),Oi=function(){var e=/(\r\n|\n)/g;function t(t){var n=[[],t.v,[]];return t.v?(t.s&&function(e,t,n){var r=[];e.u&&r.push("text-decoration: underline;"),e.uval&&r.push("text-underline-style:"+e.uval+";"),e.sz&&r.push("font-size:"+e.sz+"pt;"),e.outline&&r.push("text-effect: outline;"),e.shadow&&r.push("text-shadow: auto;"),t.push('<span style="'+r.join("")+'">'),e.b&&(t.push("<b>"),n.push("</b>")),e.i&&(t.push("<i>"),n.push("</i>")),e.strike&&(t.push("<s>"),n.push("</s>"));var i=e.valign||"";"superscript"==i||"super"==i?i="sup":"subscript"==i&&(i="sub"),""!=i&&(t.push("<"+i+">"),n.push("</"+i+">")),n.push("</span>")}(t.s,n[0],n[2]),n[0].join("")+n[1].replace(e,"<br/>")+n[2].join("")):""}return function(e){return e.map(t).join("")}}(),Ni=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,zi=/<(?:\w+:)?r>/,Wi=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Vi(e,t){var n=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=xe(Be(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Be(e),n&&(r.h=Re(r.t))):e.match(zi)&&(r.r=Be(e),r.t=xe(Be((e.replace(Wi,"").match(Ni)||[]).join("").replace(pe,""))),n&&(r.h=Oi(Fi(r.r)))),r):null}var $i=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Ui=/<(?:\w+:)?(?:si|sstItem)>/g,Hi=/<\/(?:\w+:)?(?:si|sstItem)>/;Hn.SST="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings";var Xi=/^\s|\s$|[\t\n\r]/;var Gi=function(e,t){var n=!1;return null==t&&(n=!0,t=Pt(15+4*e.t.length)),t._W(1,0),tn(e.t,t),n?t.slice(0,t.l):t};function ji(e){var t=Mt();It(t,"BrtBeginSst",function(e,t){return t||(t=Pt(8)),t._W(4,e.Count),t._W(4,e.Unique),t}(e));for(var n=0;n<e.length;++n)It(t,"BrtSSTItem",Gi(e[n]));return It(t,"BrtEndSst"),t.end()}function Yi(e){if("undefined"!=typeof cptable)return cptable.utils.encode(n,e);for(var t=[],r=e.split(""),i=0;i<r.length;++i)t[i]=r[i].charCodeAt(0);return t}function Ki(e,t){var n={};return n.Major=e._R(2),n.Minor=e._R(2),t>=4&&(e.l+=t-4),n}function Zi(e){for(var t=e._R(4),n=e.l+t-4,r={},i=e._R(4),a=[];i-- >0;)a.push({t:e._R(4),v:e._R(0,"lpp4")});if(r.name=e._R(0,"lpp4"),r.comps=a,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function qi(e){var t=function(e){var t={};return e._R(4),e.l+=4,t.id=e._R(0,"lpp4"),t.name=e._R(0,"lpp4"),t.R=Ki(e,4),t.U=Ki(e,4),t.W=Ki(e,4),t}(e);if(t.ename=e._R(0,"8lpp4"),t.blksz=e._R(4),t.cmode=e._R(4),4!=e._R(4))throw new Error("Bad !Primary record");return t}function Qi(e,t){var n=e.l+t,r={};r.Flags=63&e._R(4),e.l+=4,r.AlgID=e._R(4);var i=!1;switch(r.AlgID){case 26126:case 26127:case 26128:i=36==r.Flags;break;case 26625:i=4==r.Flags;break;case 0:i=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e._R(4),r.KeySize=e._R(4),r.ProviderType=e._R(4),e.l+=8,r.CSPName=e._R(n-e.l>>1,"utf16le"),e.l=n,r}function Ji(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e._R(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function ea(e){var t=Ki(e);switch(t.Minor){case 2:return[t.Minor,function(e){if(36!=(63&e._R(4)))throw new Error("EncryptionInfo mismatch");var t=e._R(4),n=Qi(e,t),r=Ji(e,e.length-e.l);return{t:"Std",h:n,v:r}}(e)];case 3:return[t.Minor,function(){throw new Error("File is password-protected: ECMA-376 Extensible")}()];case 4:return[t.Minor,function(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n={};return e._R(e.length-e.l,"utf8").replace(pe,function(e){var r=ge(e);switch(be(r[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(e){n[e]=r[e]});break;case"<dataIntegrity":n.encryptedHmacKey=r.encryptedHmacKey,n.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=r.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(r);break;default:throw r[0]}}),n}(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function ta(e){var t,n,r,i=0,a=Yi(e),s=a.length+1;for((t=b(s))[0]=a.length,n=1;n!=s;++n)t[n]=a[n-1];for(n=s-1;n>=0;--n)r=t[n],i=((0==(16384&i)?0:1)|i<<1&32767)^r;return 52811^i}var na=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(e,t){return function(e){return 255&(e/2|128*e)}(e^t)},i=function(e){for(var r=t[e.length-1],i=104,a=e.length-1;a>=0;--a)for(var s=e[a],o=0;7!=o;++o)64&s&&(r^=n[i]),s*=2,--i;return r};return function(t){for(var n,a,s,o=Yi(t),l=i(o),c=o.length,u=b(16),h=0;16!=h;++h)u[h]=0;for(1==(1&c)&&(n=l>>8,u[c]=r(e[0],n),--c,n=255&l,a=o[o.length-1],u[c]=r(a,n));c>0;)n=l>>8,u[--c]=r(o[c],n),n=255&l,u[--c]=r(o[c],n);for(c=15,s=15-o.length;s>0;)n=l>>8,u[c]=r(e[s],n),--s,n=255&l,u[--c]=r(o[c],n),--c,--s;return u}}(),ra=function(e){var t=0,n=na(e);return function(e){var r=function(e,t,n,r,i){var a,s;for(i||(i=t),r||(r=na(e)),a=0;a!=t.length;++a)s=t[a],s=255&((s^=r[n])>>5|s<<3),i[a]=s,++n;return[i,n,r]}("",e,t,n);return t=r[1],r[0]}};function ia(e,t,n){var r=n||{};return r.Info=e._R(2),e.l-=2,1===r.Info?r.Data=function(e){var t={},n=t.EncryptionVersionInfo=Ki(e,4);if(1!=n.Major||1!=n.Minor)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e._R(16),t.EncryptedVerifier=e._R(16),t.EncryptedVerifierHash=e._R(16),t}(e):r.Data=function(e,t){var n={},r=n.EncryptionVersionInfo=Ki(e,4);if(t-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e._R(4),t-=4;var i=e._R(4);return t-=4,n.EncryptionHeader=Qi(e,i),t-=i,n.EncryptionVerifier=Ji(e,t),n}(e,t),r}var aa=function(){function e(e,n){switch(n.type){case"base64":return t(p.decode(e),n);case"binary":return t(e,n);case"buffer":return t(e.toString("binary"),n);case"array":return t(Z(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{};if(!e.match(/\\trowd/))throw new Error("RTF missing table");return n["!ref"]=Gt({s:{c:0,r:0},e:{c:0,r:0}}),n}return{to_workbook:function(t,n){return Zt(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=jt(e["!ref"]),i=Array.isArray(e),a=r.s.r;a<=r.e.r;++a){n.push("\\trowd\\trautofit1");for(var s=r.s.c;s<=r.e.c;++s)n.push("\\cellx"+(s+1));for(n.push("\\pard\\intbl"),s=r.s.c;s<=r.e.c;++s){var o=Ht({r:a,c:s});(t=i?(e[a]||[])[s]:e[o])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(Kt(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function sa(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function oa(e,t){if(0===t)return e;var n=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.max(t,n,r),a=Math.min(t,n,r),s=i-a;if(0===s)return[0,0,t];var o,l=0,c=i+a;switch(o=s/(c>1?2-c:c),i){case t:l=((n-r)/s+6)%6;break;case n:l=(r-t)/s+2;break;case r:l=(t-n)/s+4}return[l/6,o,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return n[2]=t<0?n[2]*(1+t):1-(1-n[2])*(1-t),sa(function(e){var t,n=e[0],r=e[1],i=e[2],a=2*r*(i<.5?i:1-i),s=i-a/2,o=[s,s,s],l=6*n;if(0!==r)switch(0|l){case 0:case 6:t=a*l,o[0]+=a,o[1]+=t;break;case 1:t=a*(2-l),o[0]+=t,o[1]+=a;break;case 2:t=a*(l-2),o[1]+=a,o[2]+=t;break;case 3:t=a*(4-l),o[1]+=t,o[2]+=a;break;case 4:t=a*(l-4),o[2]+=a,o[0]+=t;break;case 5:t=a*(6-l),o[2]+=t,o[0]+=a}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(n))}var la=6,ca=15,ua=1,ha=la;function da(e){return Math.floor((e+Math.round(128/ha)/256)*ha)}function fa(e){return Math.floor((e-5)/ha*100+.5)/100}function pa(e){return Math.round((e*ha+5)/ha*256)/256}function ma(e){return pa(fa(da(e)))}function va(e){var t=Math.abs(e-ma(e)),n=ha;if(t>.005)for(ha=ua;ha<ca;++ha)Math.abs(e-ma(e))<=t&&(t=Math.abs(e-ma(e)),n=ha);ha=n}function ga(e){e.width?(e.wpx=da(e.width),e.wch=fa(e.wpx),e.MDW=ha):e.wpx?(e.wch=fa(e.wpx),e.width=pa(e.wch),e.MDW=ha):"number"==typeof e.wch&&(e.width=pa(e.wch),e.wpx=da(e.width),e.MDW=ha),e.customWidth&&delete e.customWidth}var ba=96;function Sa(e){return 96*e/ba}function ya(e){return e*ba/96}var xa={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function wa(e,t,n,r){t.Fonts=[];var i={},s=!1;(e[0].match(pe)||[]).forEach(function(e){var o=ge(e);switch(be(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=o.val);break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Pe(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Pe(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Pe(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Pe(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Pe(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Pe(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Pe(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if("1"==o.val)break;o.codepage=a[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Pe(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Nn[i.color.index];if(81==i.color.index&&(l=Nn[1]),!l)throw new Error(e);i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&n.themeElements&&n.themeElements.clrScheme&&(i.color.rgb=oa(n.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}var _a=["numFmtId","fillId","fontId","borderId","xfId"],Ca=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var Ea=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,s,o){var l,c={};return a?((l=(a=a.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,n){t.NumberFmt=[];for(var r=O(R._table),i=0;i<r.length;++i)t.NumberFmt[r[i]]=R._table[r[i]];var a=e[0].match(pe);if(a)for(i=0;i<a.length;++i){var s=ge(a[i]);switch(be(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var o=xe(Be(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}R.load(o,l)}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}(l,c,o),(l=a.match(r))&&wa(l,c,s,o),(l=a.match(n))&&function(e,t,n,r){t.Fills=[];var i={},a=!1;(e[0].match(pe)||[]).forEach(function(e){var n=ge(e);switch(be(n[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":n.patternType&&(i.patternType=n.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),n.indexed&&(i.bgColor.indexed=parseInt(n.indexed,10)),n.theme&&(i.bgColor.theme=parseInt(n.theme,10)),n.tint&&(i.bgColor.tint=parseFloat(n.tint)),n.rgb&&(i.bgColor.rgb=n.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),n.theme&&(i.fgColor.theme=parseInt(n.theme,10)),n.tint&&(i.fgColor.tint=parseFloat(n.tint)),null!=n.rgb&&(i.fgColor.rgb=n.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+n[0]+" in fills")}})}(l,c,0,o),(l=a.match(i))&&function(e,t,n,r){t.Borders=[];var i={},a=!1;(e[0].match(pe)||[]).forEach(function(e){var n=ge(e);switch(be(n[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},n.diagonalUp&&(i.diagonalUp=Pe(n.diagonalUp)),n.diagonalDown&&(i.diagonalDown=Pe(n.diagonalDown)),t.Borders.push(i);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+n[0]+" in borders")}})}(l,c,0,o),(l=a.match(t))&&function(e,t,n){var r;t.CellXf=[];var i=!1;(e[0].match(pe)||[]).forEach(function(e){var a=ge(e),s=0;switch(be(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(r=a)[0],s=0;s<_a.length;++s)r[_a[s]]&&(r[_a[s]]=parseInt(r[_a[s]],10));for(s=0;s<Ca.length;++s)r[Ca[s]]&&(r[Ca[s]]=Pe(r[Ca[s]]));if(r.numFmtId>392)for(s=392;s>60;--s)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[s]){r.numFmtId=s;break}t.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var o={};a.vertical&&(o.vertical=a.vertical),a.horizontal&&(o.horizontal=a.horizontal),null!=a.textRotation&&(o.textRotation=a.textRotation),a.indent&&(o.indent=a.indent),a.wrapText&&(o.wrapText=Pe(a.wrapText)),r.alignment=o;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}(l,c,o),c):c}}(),ka=Xe("styleSheet",null,{xmlns:je.main[0],"xmlns:vt":je.vt});function Ra(e,t){var n,r=[de,ka];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=Xe("numFmt",null,{numFmtId:r,formatCode:Ce(e[r])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Xe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=Xe("cellXfs",null),e.forEach(function(e){t[t.length]=Xe("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Xe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Ta(e,t,n){n||(n=Pt(6+4*t.length)),n._W(2,e),tn(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return null==n.l&&(n.l=n.length),r}function Aa(e,t){t||(t=Pt(153)),t._W(2,20*e.sz),function(e,t){t||(t=Pt(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t._W(1,n),t._W(1,0)}(e,t),t._W(2,e.bold?700:400);var n=0;"superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t._W(2,n),t._W(1,e.underline||0),t._W(1,e.family||0),t._W(1,e.charset||0),t._W(1,0),Cn(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t._W(1,r),tn(e.name,t),t.length>t.l?t.slice(0,t.l):t}Hn.STY="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles";var Pa=z(["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"]),Ba=At;function Ma(e,t){t||(t=Pt(84));var n=Pa[e.patternType];null==n&&(n=40),t._W(4,n);var r=0;if(40!=n)for(Cn({auto:1},t),Cn({auto:1},t);r<12;++r)t._W(4,0);else{for(;r<4;++r)t._W(4,0);for(;r<12;++r)t._W(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Ia(e,t,n){n||(n=Pt(16)),n._W(2,t||0),n._W(2,e.numFmtId||0),n._W(2,0),n._W(2,0),n._W(2,0),n._W(1,0),n._W(1,0);return n._W(1,0),n._W(1,0),n._W(1,0),n._W(1,0),n}function Da(e,t){return t||(t=Pt(10)),t._W(1,0),t._W(1,0),t._W(4,0),t._W(4,0),t}var La=At;function Fa(e){It(e,"BrtBeginBorders",Jt(1)),It(e,"BrtBorder",function(e,t){return t||(t=Pt(51)),t._W(1,0),Da(0,t),Da(0,t),Da(0,t),Da(0,t),Da(0,t),t.length>t.l?t.slice(0,t.l):t}()),It(e,"BrtEndBorders")}function Oa(e){It(e,"BrtBeginStyles",Jt(1)),It(e,"BrtStyle",function(e,t){return t||(t=Pt(52)),t._W(4,e.xfId),t._W(2,1),t._W(1,+e.builtinId),t._W(1,0),dn(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}({xfId:0,builtinId:0,name:"Normal"})),It(e,"BrtEndStyles")}function Na(e){It(e,"BrtBeginTableStyles",function(e,t,n){var r=Pt(2052);return r._W(4,e),dn(t,r),dn(n,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),It(e,"BrtEndTableStyles")}function za(e,t){var n=Mt();return It(n,"BrtBeginStyleSheet"),function(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++n}),0!=n&&(It(e,"BrtBeginFmts",Jt(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&It(e,"BrtFmt",Ta(r,t[r]))}),It(e,"BrtEndFmts"))}}(n,e.SSF),function(e){It(e,"BrtBeginFonts",Jt(1)),It(e,"BrtFont",Aa({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),It(e,"BrtEndFonts")}(n),function(e){It(e,"BrtBeginFills",Jt(2)),It(e,"BrtFill",Ma({patternType:"none"})),It(e,"BrtFill",Ma({patternType:"gray125"})),It(e,"BrtEndFills")}(n),Fa(n),function(e){It(e,"BrtBeginCellStyleXFs",Jt(1)),It(e,"BrtXF",Ia({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),It(e,"BrtEndCellStyleXFs")}(n),function(e,t){It(e,"BrtBeginCellXFs",Jt(t.length)),t.forEach(function(t){It(e,"BrtXF",Ia(t,0))}),It(e,"BrtEndCellXFs")}(n,t.cellXfs),Oa(n),function(e){It(e,"BrtBeginDXFs",Jt(0)),It(e,"BrtEndDXFs")}(n),Na(n),It(n,"BrtEndStyleSheet"),n.end()}Hn.THEME="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme";var Wa=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Va=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,$a=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Ua(e,t,n){var r;t.themeElements={},[["clrScheme",Wa,function(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(pe)||[]).forEach(function(e){var i=ge(e);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=i.val;break;case"<a:sysClr":r.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===i[0].charAt(1)?(t.themeElements.clrScheme.push(r),r={}):r.name=i[0].slice(3,i[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}],["fontScheme",Va,function(){}],["fmtScheme",$a,function(){}]].forEach(function(i){if(!(r=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](r,t,n)})}var Ha=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Xa(e,t){if(!e||0===e.length)return Xa(Ga());var n,r={};if(!(n=e.match(Ha)))throw new Error("themeElements not found in theme");return Ua(n[0],r,t),r.raw=e,r}function Ga(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[de];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function ja(e){var t={};switch(t.xclrType=e._R(2),t.nTintShade=e._R(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=function(e,t){return At(e,t)}(e,4);break;case 2:t.xclrValue=jr(e);break;case 3:t.xclrValue=function(e){return e._R(4)}(e);break;case 4:e.l+=4}return e.l+=8,t}function Ya(e){var t=e._R(2),n=e._R(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=ja(e);break;case 6:r[1]=function(e,t){return At(e,t)}(e,n);break;case 14:case 15:r[1]=e._R(1===n?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function Ka(e,t){t.forEach(function(e){e[0]})}Hn.IMG="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Hn.DRAW="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing";var Za=1024;function qa(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[Xe("xml",null,{"xmlns:v":Ye.v,"xmlns:o":Ye.o,"xmlns:x":Ye.x,"xmlns:mv":Ye.mv}).replace(/\/>/,">"),Xe("o:shapelayout",Xe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Xe("v:shapetype",[Xe("v:stroke",null,{joinstyle:"miter"}),Xe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Za<1e3*e;)Za+=1e3;return t.forEach(function(e){var t=Ut(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var r=Xe("v:fill","gradient"==n.type?Xe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,n);++Za,i=i.concat(["<v:shape"+He({id:"_x0000_s"+Za,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",r,Xe("v:shadow",null,{on:"t",obscured:"t"}),Xe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ue("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),Ue("x:AutoFill","False"),Ue("x:Row",String(t.r)),Ue("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}Hn.CMNT="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments";var Qa=Xe("comments",null,{xmlns:je.main[0]});var Ja=en;function es(e){var t=Mt(),n=[];return It(t,"BrtBeginComments"),It(t,"BrtBeginCommentAuthors"),e.forEach(function(e){e[1].forEach(function(e){n.indexOf(e.a)>-1||(n.push(e.a.slice(0,54)),It(t,"BrtCommentAuthor",function(e){return tn(e.slice(0,54))}(e.a)))})}),It(t,"BrtEndCommentAuthors"),It(t,"BrtBeginCommentList"),e.forEach(function(e){e[1].forEach(function(r){r.iauthor=n.indexOf(r.a);var i={s:Ut(e[0]),e:Ut(e[0])};It(t,"BrtBeginComment",function(e,t){return null==t&&(t=Pt(36)),t._W(4,e[1].iauthor),Sn(e[0],t),t._W(4,0),t._W(4,0),t._W(4,0),t._W(4,0),t}([i,r])),r.t&&r.t.length>0&&It(t,"BrtCommentText",sn(r)),It(t,"BrtEndComment"),delete r.iauthor})}),It(t,"BrtEndCommentList"),It(t,"BrtEndComments"),t.end()}var ts="application/vnd.ms-office.vbaProject";var ns=["xlsb","xlsm","xlam","biff8","xla"];Hn.DS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",Hn.MS="http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet";var rs=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,i){var a=!1,s=!1;0==r.length?s=!0:"["==r.charAt(0)&&(s=!0,r=r.slice(1,-1)),0==i.length?a=!0:"["==i.charAt(0)&&(a=!0,i=i.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,l=i.length>0?0|parseInt(i,10):0;return a?l+=t.c:--l,s?o+=t.r:--o,n+(a?"":"$")+Vt(l)+(s?"":"$")+zt(o)}return function(r,i){return t=i,r.replace(e,n)}}(),is=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)([1-9]\d{0,5}|10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6])(?![_.\(A-Za-z0-9])/g,as=function(e,t){return e.replace(is,function(e,n,r,i,a,s){var o=Wt(i)-(r?0:t.c),l=Nt(s)-(a?0:t.r);return n+"R"+(0==l?"":a?l+1:"["+l+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")})};function ss(e,t,n){var r=Xt(t).s,i=Ut(n);return function(e,t){return e.replace(is,function(e,n,r,i,a,s){return n+("$"==r?r+i:Vt(Wt(i)+t.c))+("$"==a?a+s:zt(Nt(s)+t.r))})}(e,{r:i.r-r.r,c:i.c-r.c})}function os(e){return e.replace(/_xlfn\./g,"")}function ls(e){e.l+=1}function cs(e,t){var n=e._R(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function us(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return hs(e);12==n.biff&&(r=4)}var i=e._R(r),a=e._R(r),s=cs(e,2),o=cs(e,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function hs(e){var t=cs(e,2),n=cs(e,2),r=e._R(1),i=e._R(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function ds(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=cs(e,2),n=e._R(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e._R(n&&12==n.biff?4:2),i=cs(e,2);return{r:r,c:i[0],cRel:i[1],rRel:i[2]}}function fs(e){return[e._R(1),e._R(1)]}function ps(e,t){var n=[e._R(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=Dr(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=wn[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=yn(e);break;case 2:n[1]=Ur(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function ms(e,t,n){for(var r=e._R(12==n.biff?4:2),i=[],a=0;a!=r;++a)i.push((12==n.biff?bn:Jr)(e,8));return i}function vs(e,t,n){var r=0,i=0;12==n.biff?(r=e._R(4),i=e._R(4)):(i=1+e._R(1),r=1+e._R(2)),n.biff>=2&&n.biff<8&&(--r,0==--i&&(i=256));for(var a=0,s=[];a!=r&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=ps(e,n.biff);return s}function gs(e,t,n){return e.l+=2,[function(e){var t=e._R(2),n=e._R(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}(e)]}function bs(e){return e.l+=6,[]}var Ss=gs,ys=bs,xs=bs,ws=gs;function _s(e){return e.l+=2,[Fr(e),1&e._R(2)]}var Cs=gs,Es=_s,ks=bs,Rs=gs,Ts=gs,As=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Ps={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e._R(4,"i"),0]:[e._R(2),e._R(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:At},3:{n:"PtgAdd",f:ls},4:{n:"PtgSub",f:ls},5:{n:"PtgMul",f:ls},6:{n:"PtgDiv",f:ls},7:{n:"PtgPower",f:ls},8:{n:"PtgConcat",f:ls},9:{n:"PtgLt",f:ls},10:{n:"PtgLe",f:ls},11:{n:"PtgEq",f:ls},12:{n:"PtgGe",f:ls},13:{n:"PtgGt",f:ls},14:{n:"PtgNe",f:ls},15:{n:"PtgIsect",f:ls},16:{n:"PtgUnion",f:ls},17:{n:"PtgRange",f:ls},18:{n:"PtgUplus",f:ls},19:{n:"PtgUminus",f:ls},20:{n:"PtgPercent",f:ls},21:{n:"PtgParen",f:ls},22:{n:"PtgMissArg",f:ls},23:{n:"PtgStr",f:function(e,t,n){return e.l++,zr(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,wn[e._R(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e._R(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e._R(2)}},31:{n:"PtgNum",f:function(e){return e.l++,yn(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=e._R(n&&n.biff<=3?1:2);return[Zs[i],Ks[i],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],i=e._R(1),a=n&&n.biff<=3?[88==r?-1:0,e._R(1)]:function(e){return[e[e.l+1]>>7,32767&e._R(2)]}(e);return[i,(0===a[0]?Ks:Ys)[a[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e._R(1)>>>5&3,i=!n||n.biff>=8?4:2,a=e._R(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,a]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,ds(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,us(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e._R(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e._R(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:At},40:{n:"PtgMemNoMem",f:At},41:{n:"PtgMemFunc",f:function(e,t,n){return[e._R(1)>>>5&3,e._R(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e._R(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e._R(2),n=e._R(1),r=(32768&t)>>15,i=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==i&&n>=128&&(n-=256),{r:t,c:n,cRel:i,rRel:r}}(e);var i=e._R(r>=12?4:2),a=e._R(2),s=(16384&a)>>14,o=(32768&a)>>15;if(a&=16383,1==o)for(;i>524287;)i-=1048576;if(1==s)for(;a>8191;)a-=16384;return{r:i,c:a,cRel:s,rRel:o}}(e,0,n)]}},45:{n:"PtgAreaN",f:function(e,t,n){return[(96&e[e.l++])>>5,function(e,t,n){if(n.biff<8)return hs(e);var r=e._R(12==n.biff?4:2),i=e._R(12==n.biff?4:2),a=cs(e,2),s=cs(e,2);return{s:{r:r,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}(e,0,n)]}},46:{n:"PtgMemAreaN",f:function(e){return[e._R(1)>>>5&3,e._R(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e._R(1)>>>5&3,e._R(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e._R(1)>>>5&3,n=e._R(2,"i");e.l+=8;var r=e._R(2);return e.l+=12,[t,n,r]}(e):[e._R(1)>>>5&3,e._R(2),e._R(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=e._R(2);return n&&5==n.biff&&(e.l+=12),[r,i,ds(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e._R(2,"i");if(n)switch(n.biff){case 5:e.l+=12}return[r,i,us(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e._R(2),a=4;if(n)switch(n.biff){case 5:a=15;break;case 12:a=6}return e.l+=a,[r,i]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e._R(2),a=8;if(n)switch(n.biff){case 5:e.l+=12,a=6;break;case 12:a=12}return e.l+=a,[r,i]}},255:{}},Bs={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61};!function(){for(var e in Bs)Ps[e]=Ps[Bs[e]]}();var Ms={1:{n:"PtgElfLel",f:_s},2:{n:"PtgElfRw",f:Rs},3:{n:"PtgElfCol",f:Ss},6:{n:"PtgElfRwV",f:Ts},7:{n:"PtgElfColV",f:ws},10:{n:"PtgElfRadical",f:Cs},11:{n:"PtgElfRadicalS",f:ks},13:{n:"PtgElfColS",f:ys},15:{n:"PtgElfColSV",f:xs},16:{n:"PtgElfRadicalLel",f:Es},25:{n:"PtgList",f:function(e){e.l+=2;var t=e._R(2),n=e._R(2),r=e._R(4),i=e._R(2),a=e._R(2);return{ixti:t,coltype:3&n,rt:As[n>>2&31],idx:r,c:i,C:a}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e._R(4)]}},255:{}},Is={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e._R(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e._R(n&&2==n.biff?1:2),i=[],a=0;a<=r;++a)i.push(e._R(n&&2==n.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e._R(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:function(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}},64:{n:"PtgAttrSpace",f:function(e){return e._R(2),fs(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e._R(2),fs(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e._R(2)]}},255:{}};function Ds(e,t,n,r){if(r.biff<8)return At(e,t);for(var i=e.l+t,a=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=vs(e,0,r),a.push(n[s][1]);break;case"PtgMemArea":n[s][2]=ms(e,n[s][1],r),a.push(n[s][2]);break;case"PtgExp":r&&12==r.biff&&(n[s][1][1]=e._R(4),a.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return 0!==(t=i-e.l)&&a.push(At(e,t)),a}function Ls(e,t,n){for(var r,i,a=e.l+t,s=[];a!=e.l;)t=a-e.l,i=e[e.l],r=Ps[i],24!==i&&25!==i||(r=(24===i?Ms:Is)[e[e.l+1]]),r&&r.f?s.push([r.n,r.f(e,t,n)]):At(e,t);return s}function Fs(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],a=0;a<r.length;++a){var s=r[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}Is[33]=Is[32];var Os={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ns(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[r[0]][0][3]?(i=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function zs(e,t,n){return function(e,t){if(!(e||t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return e.indexOf(" ")>-1?"'"+e+"'":e}(Ns(e,t,n),n)}function Ws(e,t,n,r,i){var a,s,o,l,c=i&&i.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},h=[],d=0,f=0,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,v="",g=0,b=e[0].length;g<b;++g){var S=e[0][g];switch(S[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(a=h.pop(),s=h.pop(),m>=0){switch(e[0][m][1][0]){case 0:v=Q(" ",e[0][m][1][1]);break;case 1:v=Q("\r",e[0][m][1][1]);break;default:if(v="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}s+=v,m=-1}h.push(s+Os[S[0]]+a);break;case"PtgIsect":a=h.pop(),s=h.pop(),h.push(s+" "+a);break;case"PtgUnion":a=h.pop(),s=h.pop(),h.push(s+","+a);break;case"PtgRange":a=h.pop(),s=h.pop(),h.push(s+":"+a);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":o=Dt(S[1][1],u,i),h.push(Ft(o,c));break;case"PtgRefN":o=n?Dt(S[1][1],n,i):S[1][1],h.push(Ft(o,c));break;case"PtgRef3d":d=S[1][1],o=Dt(S[1][2],u,i);p=zs(r,d,i);h.push(p+"!"+Ft(o,c));break;case"PtgFunc":case"PtgFuncVar":var y=S[1][0],x=S[1][1];y||(y=0);var w=0==(y&=127)?[]:h.slice(-y);h.length-=y,"User"===x&&(x=w.shift()),h.push(x+"("+w.join(",")+")");break;case"PtgBool":h.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(S[1]);break;case"PtgNum":h.push(String(S[1]));break;case"PtgStr":h.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(S[1]);break;case"PtgAreaN":l=Lt(S[1][1],n?{s:n}:u,i),h.push(Ot(l,i));break;case"PtgArea":l=Lt(S[1][1],u,i),h.push(Ot(l,i));break;case"PtgArea3d":d=S[1][1],l=S[1][2],p=zs(r,d,i),h.push(p+"!"+Ot(l,i));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=S[1][2];var _=(r.names||[])[f-1]||(r[0]||[])[f],C=_?_.Name:"SH33TJSNAME"+String(f);C in qs&&(C=qs[C]),h.push(C);break;case"PtgNameX":var E,k=S[1][1];if(f=S[1][2],!(i.biff<=5)){var R="";if(14849==((r[k]||[])[0]||[])[0]||(1025==((r[k]||[])[0]||[])[0]?r[k][f]&&r[k][f].itab>0&&(R=r.SheetNames[r[k][f].itab-1]+"!"):R=r.SheetNames[f-1]+"!"),r[k]&&r[k][f])R+=r[k][f].Name;else if(r[0]&&r[0][f])R+=r[0][f].Name;else{var T=Ns(r,k,i).split(";;");T[f-1]?R=T[f-1]:R+="SH33TJSERRX"}h.push(R);break}k<0&&(k=-k),r[k]&&(E=r[k][f]),E||(E={Name:"SH33TJSERRY"}),h.push(E.Name);break;case"PtgParen":var A="(",P=")";if(m>=0){switch(v="",e[0][m][1][0]){case 2:A=Q(" ",e[0][m][1][1])+A;break;case 3:A=Q("\r",e[0][m][1][1])+A;break;case 4:P=Q(" ",e[0][m][1][1])+P;break;case 5:P=Q("\r",e[0][m][1][1])+P;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}h.push(A+h.pop()+P);break;case"PtgRefErr":case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":o={c:S[1][1],r:S[1][0]};var B={c:n.c,r:n.r};if(r.sharedf[Ht(o)]){var M=r.sharedf[Ht(o)];h.push(Ws(M,u,B,r,i))}else{var I=!1;for(a=0;a!=r.arrayf.length;++a)if(s=r.arrayf[a],!(o.c<s[0].s.c||o.c>s[0].e.c||o.r<s[0].s.r||o.r>s[0].e.r)){h.push(Ws(s[1],u,B,r,i)),I=!0;break}I||h.push(S[1])}break;case"PtgArray":h.push("{"+Fs(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=g;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":default:throw new Error("Unrecognized Formula Token: "+String(S))}if(3!=i.biff&&m>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][g][0])){var D=!0;switch((S=e[0][m])[1][0]){case 4:D=!1;case 0:v=Q(" ",S[1][1]);break;case 5:D=!1;case 1:v=Q("\r",S[1][1]);break;default:if(v="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}h.push((D?v:"")+h.pop()+(D?"":v)),m=-1}}if(h.length>1&&i.WTF)throw new Error("bad formula stack");return h[0]}function Vs(e,t,n){var r=e.l+t,i=Kr(e);2==n.biff&&++e.l;var a=function(e){var t;if(65535!==gt(e,e.l+6))return[yn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),s=e._R(1);2!=n.biff&&(e._R(1),n.biff>=5&&e._R(4));var o=function(e,t,n){var r,i=e.l+t,a=2==n.biff?1:2,s=e._R(a);if(65535==s)return[[],At(e,t-2)];var o=Ls(e,s,n);return t!==s+a&&(r=Ds(e,t-s-a,o,n)),e.l=i,[o,r]}(e,r-e.l,n);return{cell:i,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function $s(e,t,n,r,i){var a=Zr(t,n,i),s=function(e){if(null==e){var t=Pt(8);return t._W(1,3),t._W(1,0),t._W(2,0),t._W(2,0),t._W(2,65535),t}return xn("number"==typeof e?e:0)}(e.v),o=Pt(6);o._W(2,33),o._W(4,0);for(var l=Pt(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return C([a,s,o,l])}function Us(e,t,n){var r=Ls(e,e._R(4),n),i=e._R(4);return[r,i>0?Ds(e,i,r,n):null]}var Hs=Us,Xs=Us,Gs=Us,js=Us,Ys={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ks={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Zs={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0},qs={"_xlfn.ACOT":"ACOT","_xlfn.ACOTH":"ACOTH","_xlfn.AGGREGATE":"AGGREGATE","_xlfn.ARABIC":"ARABIC","_xlfn.AVERAGEIF":"AVERAGEIF","_xlfn.AVERAGEIFS":"AVERAGEIFS","_xlfn.BASE":"BASE","_xlfn.BETA.DIST":"BETA.DIST","_xlfn.BETA.INV":"BETA.INV","_xlfn.BINOM.DIST":"BINOM.DIST","_xlfn.BINOM.DIST.RANGE":"BINOM.DIST.RANGE","_xlfn.BINOM.INV":"BINOM.INV","_xlfn.BITAND":"BITAND","_xlfn.BITLSHIFT":"BITLSHIFT","_xlfn.BITOR":"BITOR","_xlfn.BITRSHIFT":"BITRSHIFT","_xlfn.BITXOR":"BITXOR","_xlfn.CEILING.MATH":"CEILING.MATH","_xlfn.CEILING.PRECISE":"CEILING.PRECISE","_xlfn.CHISQ.DIST":"CHISQ.DIST","_xlfn.CHISQ.DIST.RT":"CHISQ.DIST.RT","_xlfn.CHISQ.INV":"CHISQ.INV","_xlfn.CHISQ.INV.RT":"CHISQ.INV.RT","_xlfn.CHISQ.TEST":"CHISQ.TEST","_xlfn.COMBINA":"COMBINA","_xlfn.CONCAT":"CONCAT","_xlfn.CONFIDENCE.NORM":"CONFIDENCE.NORM","_xlfn.CONFIDENCE.T":"CONFIDENCE.T","_xlfn.COT":"COT","_xlfn.COTH":"COTH","_xlfn.COUNTIFS":"COUNTIFS","_xlfn.COVARIANCE.P":"COVARIANCE.P","_xlfn.COVARIANCE.S":"COVARIANCE.S","_xlfn.CSC":"CSC","_xlfn.CSCH":"CSCH","_xlfn.DAYS":"DAYS","_xlfn.DECIMAL":"DECIMAL","_xlfn.ECMA.CEILING":"ECMA.CEILING","_xlfn.ERF.PRECISE":"ERF.PRECISE","_xlfn.ERFC.PRECISE":"ERFC.PRECISE","_xlfn.EXPON.DIST":"EXPON.DIST","_xlfn.F.DIST":"F.DIST","_xlfn.F.DIST.RT":"F.DIST.RT","_xlfn.F.INV":"F.INV","_xlfn.F.INV.RT":"F.INV.RT","_xlfn.F.TEST":"F.TEST","_xlfn.FILTERXML":"FILTERXML","_xlfn.FLOOR.MATH":"FLOOR.MATH","_xlfn.FLOOR.PRECISE":"FLOOR.PRECISE","_xlfn.FORECAST.ETS":"FORECAST.ETS","_xlfn.FORECAST.ETS.CONFINT":"FORECAST.ETS.CONFINT","_xlfn.FORECAST.ETS.SEASONALITY":"FORECAST.ETS.SEASONALITY","_xlfn.FORECAST.ETS.STAT":"FORECAST.ETS.STAT","_xlfn.FORECAST.LINEAR":"FORECAST.LINEAR","_xlfn.FORMULATEXT":"FORMULATEXT","_xlfn.GAMMA":"GAMMA","_xlfn.GAMMA.DIST":"GAMMA.DIST","_xlfn.GAMMA.INV":"GAMMA.INV","_xlfn.GAMMALN.PRECISE":"GAMMALN.PRECISE","_xlfn.GAUSS":"GAUSS","_xlfn.HYPGEOM.DIST":"HYPGEOM.DIST","_xlfn.IFERROR":"IFERROR","_xlfn.IFNA":"IFNA","_xlfn.IFS":"IFS","_xlfn.IMCOSH":"IMCOSH","_xlfn.IMCOT":"IMCOT","_xlfn.IMCSC":"IMCSC","_xlfn.IMCSCH":"IMCSCH","_xlfn.IMSEC":"IMSEC","_xlfn.IMSECH":"IMSECH","_xlfn.IMSINH":"IMSINH","_xlfn.IMTAN":"IMTAN","_xlfn.ISFORMULA":"ISFORMULA","_xlfn.ISO.CEILING":"ISO.CEILING","_xlfn.ISOWEEKNUM":"ISOWEEKNUM","_xlfn.LOGNORM.DIST":"LOGNORM.DIST","_xlfn.LOGNORM.INV":"LOGNORM.INV","_xlfn.MAXIFS":"MAXIFS","_xlfn.MINIFS":"MINIFS","_xlfn.MODE.MULT":"MODE.MULT","_xlfn.MODE.SNGL":"MODE.SNGL","_xlfn.MUNIT":"MUNIT","_xlfn.NEGBINOM.DIST":"NEGBINOM.DIST","_xlfn.NETWORKDAYS.INTL":"NETWORKDAYS.INTL","_xlfn.NIGBINOM":"NIGBINOM","_xlfn.NORM.DIST":"NORM.DIST","_xlfn.NORM.INV":"NORM.INV","_xlfn.NORM.S.DIST":"NORM.S.DIST","_xlfn.NORM.S.INV":"NORM.S.INV","_xlfn.NUMBERVALUE":"NUMBERVALUE","_xlfn.PDURATION":"PDURATION","_xlfn.PERCENTILE.EXC":"PERCENTILE.EXC","_xlfn.PERCENTILE.INC":"PERCENTILE.INC","_xlfn.PERCENTRANK.EXC":"PERCENTRANK.EXC","_xlfn.PERCENTRANK.INC":"PERCENTRANK.INC","_xlfn.PERMUTATIONA":"PERMUTATIONA","_xlfn.PHI":"PHI","_xlfn.POISSON.DIST":"POISSON.DIST","_xlfn.QUARTILE.EXC":"QUARTILE.EXC","_xlfn.QUARTILE.INC":"QUARTILE.INC","_xlfn.QUERYSTRING":"QUERYSTRING","_xlfn.RANK.AVG":"RANK.AVG","_xlfn.RANK.EQ":"RANK.EQ","_xlfn.RRI":"RRI","_xlfn.SEC":"SEC","_xlfn.SECH":"SECH","_xlfn.SHEET":"SHEET","_xlfn.SHEETS":"SHEETS","_xlfn.SKEW.P":"SKEW.P","_xlfn.STDEV.P":"STDEV.P","_xlfn.STDEV.S":"STDEV.S","_xlfn.SUMIFS":"SUMIFS","_xlfn.SWITCH":"SWITCH","_xlfn.T.DIST":"T.DIST","_xlfn.T.DIST.2T":"T.DIST.2T","_xlfn.T.DIST.RT":"T.DIST.RT","_xlfn.T.INV":"T.INV","_xlfn.T.INV.2T":"T.INV.2T","_xlfn.T.TEST":"T.TEST","_xlfn.TEXTJOIN":"TEXTJOIN","_xlfn.UNICHAR":"UNICHAR","_xlfn.UNICODE":"UNICODE","_xlfn.VAR.P":"VAR.P","_xlfn.VAR.S":"VAR.S","_xlfn.WEBSERVICE":"WEBSERVICE","_xlfn.WEIBULL.DIST":"WEIBULL.DIST","_xlfn.WORKDAY.INTL":"WORKDAY.INTL","_xlfn.XOR":"XOR","_xlfn.Z.TEST":"Z.TEST"};function Qs(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Js(e){return("of:="+e.replace(is,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function eo(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function to(e){return e.replace(/\./,"!")}var no={},ro={};Hn.WS=["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"];var io="undefined"!=typeof Map;function ao(e,t,n){var r=0,i=e.length;if(n){if(io?n.has(t):n.hasOwnProperty(t))for(var a=io?n.get(t):n[t];r<a.length;++r)if(e[a[r]].t===t)return e.Count++,a[r]}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t:t},e.Count++,e.Unique++,n&&(io?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(n.hasOwnProperty(t)||(n[t]=[]),n[t].push(i))),i}function so(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(ha=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?r=fa(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(n.width=pa(r),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),n}function oo(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function lo(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],i=60,a=e.length;if(null==r&&n.ssf)for(;i<392;++i)if(null==n.ssf[i]){R.load(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}for(i=0;i!=a;++i)if(e[i].numFmtId===r)return i;return e[a]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function co(e,t,n,r,i,a){try{r.cellNF&&(e.z=R._table[t])}catch(e){if(r.WTF)throw e}if("z"!==e.t){if("d"===e.t&&"string"==typeof e.v&&(e.v=K(e.v)),!r||!1!==r.cellText)try{if(null==R._table[t]&&R.load(P[t]||"General",t),"e"===e.t)e.w=e.w||wn[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=R._general_int(e.v):e.w=R._general_num(e.v);else if("d"===e.t){var s=H(e.v);e.w=(0|s)===s?R._general_int(s):R._general_num(s)}else{if(void 0===e.v)return"";e.w=R._general(e.v,ro)}else"d"===e.t?e.w=R.format(t,H(e.v),ro):e.w=R.format(t,e.v,ro)}catch(e){if(r.WTF)throw e}if(r.cellStyles&&null!=n)try{e.s=a.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=oa(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=oa(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(e){if(r.WTF&&a.Fills)throw e}}}function uo(e,t,n){if(e&&e["!ref"]){var r=jt(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var ho=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fo=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,po=/<(?:\w:)?hyperlink [^>]*>/gm,mo=/"(\w*:\w*)"/,vo=/<(?:\w:)?col\b[^>]*[\/]?>/g,go=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,bo=/<(?:\w:)?pageMargins[^>]*\/>/g,So=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,yo=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function xo(e,t,n,r,i,a,s){if(!e)return e;r||(r={"!id":{}}),null!=f&&null==t.dense&&(t.dense=f);var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(fo);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;var d=c.match(So);d&&wo(d[0],o,i,n);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var m=c.slice(p,p+50).match(mo);m&&function(e,t){var n=jt(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=Gt(n))}(o,m[1])}var v=c.match(yo);v&&v[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(Eo)||[]).forEach(function(e,n){var r=ge(e);t.Views[n]||(t.Views[n]={}),Pe(r.rightToLeft)&&(t.Views[n].RTL=!0)})}(v[1],i);var g=[];if(t.cellStyles){var b=c.match(vo);b&&function(e,t){for(var n=!1,r=0;r!=t.length;++r){var i=ge(t[r],!0);i.hidden&&(i.hidden=Pe(i.hidden));var a=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(delete i.min,delete i.max,i.width=+i.width,!n&&i.width&&(n=!0,va(i.width)),ga(i);a<=s;)e[a++]=q(i)}}(g,b)}h&&Ro(h[1],o,t,l,a,s);var S=u.match(go);S&&(o["!autofilter"]=function(e){return{ref:(e.match(/ref="([^"]*)"/)||[])[1]}}(S[0]));var y=[],x=u.match(ho);if(x)for(p=0;p!=x.length;++p)y[p]=jt(x[p].slice(x[p].indexOf('"')+1));var w=u.match(po);w&&function(e,t,n){for(var r=Array.isArray(e),i=0;i!=t.length;++i){var a=ge(Be(t[i]),!0);if(!a.ref)return;var s=((n||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+a.location)):(a.Target="#"+a.location,s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=jt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Ht({c:c,r:l});r?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=a):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=a)}}}(o,w,r);var _=u.match(bo);if(_&&(o["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}(ge(_[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Gt(l)),t.sheetRows>0&&o["!ref"]){var C=jt(o["!ref"]);t.sheetRows<=+C.e.r&&(C.e.r=t.sheetRows-1,C.e.r>l.e.r&&(C.e.r=l.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>l.e.c&&(C.e.c=l.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Gt(C))}return g.length>0&&(o["!cols"]=g),y.length>0&&(o["!merges"]=y),o}function wo(e,t,n,r){var i=ge(e);n.Sheets[r]||(n.Sheets[r]={}),i.codeName&&(n.Sheets[r].CodeName=i.codeName)}var _o=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Co=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var Eo=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ko(e,t,n,r){if(void 0===e.v&&void 0===e.f||"z"===e.t)return"";var i="",a=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=wn[e.v];break;case"d":r&&r.cellDates?i=K(e.v,-1).toISOString():((e=q(e)).t="n",i=""+(e.v=H(K(e.v)))),void 0===e.z&&(e.z=R._table[14]);break;default:i=e.v}var o=Ue("v",Ce(i)),l={r:t},c=lo(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(null==e.v){delete e.t;break}if(r&&r.bookSST){o=Ue("v",""+ao(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=a&&(e.t=a,e.v=s),e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Xe("f",Ce(e.f),u)+(null!=e.v?o:"")}return e.l&&n["!links"].push([t,e.l]),e.c&&n["!comments"].push([t,e.c]),Xe("c",o,l)}var Ro=function(){var e=/<(?:\w+:)?c[ >]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=Fe("v"),s=Fe("f");return function(o,l,c,u,h,d){for(var f,p,m,v,g,b=0,S="",y=[],x=[],w=0,_=0,C=0,E="",k=0,T=0,A=0,P=0,B=Array.isArray(d.CellXf),M=[],I=[],D=Array.isArray(l),L=[],F={},O=!1,N=o.split(t),z=0,W=N.length;z!=W;++z){var V=(S=N[z].trim()).length;if(0!==V){for(b=0;b<V&&62!==S.charCodeAt(b);++b);if(++b,k=null!=(p=ge(S.slice(0,b),!0)).r?parseInt(p.r,10):k+1,T=-1,!(c.sheetRows&&c.sheetRows<k)){u.s.r>k-1&&(u.s.r=k-1),u.e.r<k-1&&(u.e.r=k-1),c&&c.cellStyles&&(F={},O=!1,p.ht&&(O=!0,F.hpt=parseFloat(p.ht),F.hpx=ya(F.hpt)),"1"==p.hidden&&(O=!0,F.hidden=!0),null!=p.outlineLevel&&(O=!0,F.level=+p.outlineLevel),O&&(L[k-1]=F)),y=S.slice(b).split(e);for(var $=0;$!=y.length&&"<"==y[$].trim().charAt(0);++$);for(y=y.slice($),b=0;b!=y.length;++b)if(0!==(S=y[b].trim()).length){if(x=S.match(n),w=b,_=0,C=0,S="<c "+("<"==S.slice(0,1)?">":"")+S,null!=x&&2===x.length){for(w=0,E=x[1],_=0;_!=E.length&&!((C=E.charCodeAt(_)-64)<1||C>26);++_)w=26*w+C;T=--w}else++T;for(_=0;_!=S.length&&62!==S.charCodeAt(_);++_);if(++_,(p=ge(S.slice(0,_),!0)).r||(p.r=Ht({r:k-1,c:T})),f={t:""},null!=(x=(E=S.slice(_)).match(a))&&""!==x[1]&&(f.v=xe(x[1])),c.cellFormula){null!=(x=E.match(s))&&""!==x[1]?(f.f=os(xe(Be(x[1]))),x[0].indexOf('t="array"')>-1?(f.F=(E.match(i)||[])[1],f.F.indexOf(":")>-1&&M.push([jt(f.F),f.F])):x[0].indexOf('t="shared"')>-1&&(v=ge(x[0]),I[parseInt(v.si,10)]=[v,os(xe(Be(x[1]))),p.r])):(x=E.match(/<f[^>]*\/>/))&&I[(v=ge(x[0])).si]&&(f.f=ss(I[v.si][1],I[v.si][2],p.r));var U=Ut(p.r);for(_=0;_<M.length;++_)U.r>=M[_][0].s.r&&U.r<=M[_][0].e.r&&U.c>=M[_][0].s.c&&U.c<=M[_][0].e.c&&(f.F=M[_][1])}if(null==p.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!c.sheetStubs)continue;f.t="z"}else f.t=p.t||"n";switch(u.s.c>T&&(u.s.c=T),u.e.c<T&&(u.e.c=T),f.t){case"n":if(""==f.v||null==f.v){if(!c.sheetStubs)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if(void 0===f.v){if(!c.sheetStubs)continue;f.t="z"}else m=no[parseInt(f.v,10)],f.v=m.t,f.r=m.r,c.cellHTML&&(f.h=m.h);break;case"str":f.t="s",f.v=null!=f.v?Be(f.v):"",c.cellHTML&&(f.h=Re(f.v));break;case"inlineStr":x=E.match(r),f.t="s",null!=x&&(m=Vi(x[1]))?(f.v=m.t,c.cellHTML&&(f.h=m.h)):f.v="";break;case"b":f.v=Pe(f.v);break;case"d":c.cellDates?f.v=K(f.v,1):(f.v=H(K(f.v,1)),f.t="n");break;case"e":c&&!1===c.cellText||(f.w=f.v),f.v=_n[f.v]}if(A=P=0,g=null,B&&void 0!==p.s&&null!=(g=d.CellXf[p.s])&&(null!=g.numFmtId&&(A=g.numFmtId),c.cellStyles&&null!=g.fillId&&(P=g.fillId)),co(f,A,P,c,h,d),c.cellDates&&B&&"n"==f.t&&R.is_date(R._table[A])&&(f.t="d",f.v=X(f.v)),D){var G=Ut(p.r);l[G.r]||(l[G.r]=[]),l[G.r][G.c]=f}else l[p.r]=f}}}}L.length>0&&(l["!rows"]=L)}}();var To=Xe("worksheet",null,{xmlns:je.main[0],"xmlns:r":je.r});function Ao(e,t,n,r){var i,a=[de,To],s=n.SheetNames[e],o="",l=n.Sheets[s];null==l&&(l={});var c=l["!ref"]||"A1",u=jt(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Gt(u)}r||(r={}),l["!comments"]=[];var h=[];!function(e,t,n,r,i){var a=!1,s={};if("xlsx"!==r.bookType&&t.vbaraw){var o=t.SheetNames[n];try{t.Workbook&&(o=t.Workbook.Sheets[n].CodeName||o)}catch(e){}a=!0,s.codeName=Ce(o)}a&&(i[i.length]=Xe("sheetPr",null,s))}(0,n,e,t,a),a[a.length]=Xe("dimension",null,{ref:c}),a[a.length]=function(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Xe("sheetViews",Xe("sheetView",null,i),{})}(0,0,0,n),t.sheetFormat&&(a[a.length]=Xe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(a[a.length]=function(e,t){for(var n,r=["<cols>"],i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Xe("col",null,so(i,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),a[i=a.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,t,n,r){var i,a,s=[],o=[],l=jt(e["!ref"]),c="",u="",h=[],d=0,f=0,p=e["!rows"],m=Array.isArray(e),v={r:u},g=-1;for(f=l.s.c;f<=l.e.c;++f)h[f]=Vt(f);for(d=l.s.r;d<=l.e.r;++d){for(o=[],u=zt(d),f=l.s.c;f<=l.e.c;++f){i=h[f]+u;var b=m?(e[d]||[])[f]:e[i];void 0!==b&&null!=(c=ko(b,i,e,t))&&o.push(c)}(o.length>0||p&&p[d])&&(v={r:u},p&&p[d]&&((a=p[d]).hidden&&(v.hidden=1),g=-1,a.hpx?g=Sa(a.hpx):a.hpt&&(g=a.hpt),g>-1&&(v.ht=g,v.customHeight=1),a.level&&(v.outlineLevel=a.level)),s[s.length]=Xe("row",o.join(""),v))}if(p)for(;d<p.length;++d)p&&p[d]&&(v={r:d+1},(a=p[d]).hidden&&(v.hidden=1),g=-1,a.hpx?g=Sa(a.hpx):a.hpt&&(g=a.hpt),g>-1&&(v.ht=g,v.customHeight=1),a.level&&(v.outlineLevel=a.level),s[s.length]=Xe("row","",v));return s.join("")}(l,t,0,0)).length>0&&(a[a.length]=o),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),null!=l["!protect"]&&(a[a.length]=function(e){var t={sheet:1};return _o.forEach(function(n){null!=e[n]&&e[n]&&(t[n]="1")}),Co.forEach(function(n){null==e[n]||e[n]||(t[n]="0")}),e.password&&(t.password=ta(e.password).toString(16).toUpperCase()),Xe("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(a[a.length]=function(e,t,n,r){var i="string"==typeof e.ref?e.ref:Gt(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var a=n.Workbook.Names,s=Xt(i);s.s.r==s.e.r&&(s.e.r=Xt(t["!ref"]).e.r,i=Gt(s));for(var o=0;o<a.length;++o){var l=a[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),Xe("autoFilter",null,{ref:i})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(a[a.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+Gt(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var d,f=-1,p=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(d={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(p=Zn(r,-1,Ce(e[1].Target).replace(/#.*$/,""),Hn.HLINK),d["r:id"]="rId"+p),(f=e[1].Target.indexOf("#"))>-1&&(d.location=Ce(e[1].Target.slice(f+1))),e[1].Tooltip&&(d.tooltip=Ce(e[1].Tooltip)),a[a.length]=Xe("hyperlink",null,d))}),a[a.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(a[a.length]=function(e){return oo(e),Xe("pageMargins",null,e)}(l["!margins"])),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(a[a.length]=Ue("ignoredErrors",Xe("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(p=Zn(r,-1,"../drawings/drawing"+(e+1)+".xml",Hn.DRAW),a[a.length]=Xe("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=h),l["!comments"].length>0&&(p=Zn(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Hn.VML),a[a.length]=Xe("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Po(e,t,n,r){var i=function(e,t,n){var r=Pt(145),i=(n["!rows"]||[])[e]||{};r._W(4,e),r._W(4,0);var a=320;i.hpx?a=20*Sa(i.hpx):i.hpt&&(a=20*i.hpt),r._W(2,a),r._W(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),r._W(1,s),r._W(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,d=-1,f=u<<10;f<u+1<<10;++f)c.c=f,(Array.isArray(n)?(n[c.r]||[])[c.c]:n[Ht(c)])&&(h<0&&(h=f),d=f);h<0||(++o,r._W(4,h),r._W(4,d))}var p=r.l;return r.l=l,r._W(4,o),r.l=p,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&It(e,"BrtRowHdr",i)}var Bo=bn,Mo=Sn;function Io(e,t,n){return null==n&&(n=Pt(12)),ln(t,n),function(e,t){null==t&&(t=Pt(4));var n=0,r=0,i=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:i==(0|i)&&i>=-(1<<29)&&i<1<<29&&(r=1,n=1),!r)throw new Error("unsupported RkNumber "+e);t._W(-4,((n?i:e)<<2)+(n+2))}(e.v,n),n}var Do=bn,Lo=Sn;var Fo=["left","right","top","bottom","header","footer"];function Oo(e,t,n,r,i,a){if(void 0!==t.v){var s="";switch(t.t){case"b":s=t.v?"1":"0";break;case"d":(t=q(t)).z=t.z||R._table[14],t.v=H(K(t.v)),t.t="n";break;case"n":case"e":s=""+t.v;break;default:s=t.v}var o={r:n,c:r};switch(o.s=lo(i.cellXfs,t,i),t.l&&a["!links"].push([Ht(o),t.l]),t.c&&a["!comments"].push([Ht(o),t.c]),t.t){case"s":case"str":return void(i.bookSST?(s=ao(i.Strings,t.v,i.revStrings),o.t="s",o.v=s,It(e,"BrtCellIsst",function(e,t,n){return null==n&&(n=Pt(12)),ln(t,n),n._W(4,t.v),n}(0,o))):(o.t="str",It(e,"BrtCellSt",function(e,t,n){return null==n&&(n=Pt(12+4*e.v.length)),ln(t,n),tn(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,o))));case"n":return void(t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?It(e,"BrtCellRk",Io(t,o)):It(e,"BrtCellReal",function(e,t,n){return null==n&&(n=Pt(16)),ln(t,n),xn(e.v,n),n}(t,o)));case"b":return o.t="b",void It(e,"BrtCellBool",function(e,t,n){return null==n&&(n=Pt(9)),ln(t,n),n._W(1,e.v?1:0),n}(t,o));case"e":o.t="e"}It(e,"BrtCellBlank",function(e,t,n){return null==n&&(n=Pt(8)),ln(t,n)}(0,o))}}function No(e,t){t&&t["!merges"]&&(It(e,"BrtBeginMergeCells",function(e,t){return null==t&&(t=Pt(4)),t._W(4,e),t}(t["!merges"].length)),t["!merges"].forEach(function(t){It(e,"BrtMergeCell",Lo(t))}),It(e,"BrtEndMergeCells"))}function zo(e,t){t&&t["!cols"]&&(It(e,"BrtBeginColInfos"),t["!cols"].forEach(function(t,n){t&&It(e,"BrtColInfo",function(e,t,n){null==n&&(n=Pt(18));var r=so(e,t);n._W(-4,e),n._W(-4,e),n._W(4,256*(r.width||10)),n._W(4,0);var i=0;return t.hidden&&(i|=1),"number"==typeof r.width&&(i|=2),t.level&&(i|=t.level<<8),n._W(2,i),n}(n,t))}),It(e,"BrtEndColInfos"))}function Wo(e,t){t&&t["!ref"]&&(It(e,"BrtBeginCellIgnoreECs"),It(e,"BrtCellIgnoreEC",function(e){var t=Pt(24);return t._W(4,4),t._W(4,1),Sn(e,t),t}(jt(t["!ref"]))),It(e,"BrtEndCellIgnoreECs"))}function Vo(e,t,n){t["!links"].forEach(function(t){if(t[1].Target){var r=Zn(n,-1,t[1].Target.replace(/#.*$/,""),Hn.HLINK);It(e,"BrtHLink",function(e,t){var n=Pt(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Sn({s:Ut(e[0]),e:Ut(e[0])},n),mn("rId"+t,n);var r=e[1].Target.indexOf("#");return tn((-1==r?"":e[1].Target.slice(r+1))||"",n),tn(e[1].Tooltip||"",n),tn("",n),n.slice(0,n.l)}(t,r))}}),delete t["!links"]}function $o(e,t,n){It(e,"BrtBeginWsViews"),It(e,"BrtBeginWsView",function(e,t,n){null==n&&(n=Pt(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n._W(2,r),n._W(4,0),n._W(4,0),n._W(4,0),n._W(1,0),n._W(1,0),n._W(2,0),n._W(2,100),n._W(2,0),n._W(2,0),n._W(2,0),n._W(4,0),n}(0,n)),It(e,"BrtEndWsView"),It(e,"BrtEndWsViews")}function Uo(e,t){t["!protect"]&&It(e,"BrtSheetProtection",function(e,t){return null==t&&(t=Pt(66)),t._W(2,e.password?ta(e.password):0),t._W(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t._W(4,null==e[n[0]]||e[n[0]]?0:1):t._W(4,null!=e[n[0]]&&e[n[0]]?0:1)}),t}(t["!protect"]))}function Ho(e,t,n,r){var i=Mt(),a=n.SheetNames[e],s=n.Sheets[a]||{},o=a;try{n&&n.Workbook&&(o=n.Workbook.Sheets[e].CodeName||o)}catch(e){}var l=jt(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],It(i,"BrtBeginSheet"),n.vbaraw&&It(i,"BrtWsProp",function(e,t){null==t&&(t=Pt(84+4*e.length));for(var n=0;n<3;++n)t._W(1,0);return Cn({auto:1},t),t._W(-4,-1),t._W(-4,-1),un(e,t),t.slice(0,t.l)}(o)),It(i,"BrtWsDim",Mo(l)),$o(i,0,n.Workbook),zo(i,s),function(e,t,n,r){var i,a=jt(t["!ref"]||"A1"),s="",o=[];It(e,"BrtBeginSheetData");var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=c;++u)if(s=zt(u),Po(e,t,a,u),u<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){u===a.s.r&&(o[h]=Vt(h)),i=o[h]+s;var d=l?(t[u]||[])[h]:t[i];d&&Oo(e,d,u,h,r,t)}It(e,"BrtEndSheetData")}(i,s,0,t),Uo(i,s),function(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],a="string"==typeof i.ref?i.ref:Gt(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=Xt(a);o.s.r==o.e.r&&(o.e.r=Xt(t["!ref"]).e.r,a=Gt(o));for(var l=0;l<s.length;++l){var c=s[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+a;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),It(e,"BrtBeginAFilter",Sn(jt(a))),It(e,"BrtEndAFilter")}}(i,s,n,e),No(i,s),Vo(i,s,r),s["!margins"]&&It(i,"BrtMargins",function(e,t){return null==t&&(t=Pt(48)),oo(e),Fo.forEach(function(n){xn(e[n],t)}),t}(s["!margins"])),t&&!t.ignoreEC&&void 0!=t.ignoreEC||Wo(i,s),function(e,t,n,r){if(t["!comments"].length>0){var i=Zn(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Hn.VML);It(e,"BrtLegacyDrawing",mn("rId"+i)),t["!legacy"]=i}}(i,s,e,r),It(i,"BrtEndSheet"),i.end()}function Xo(e,t,n,r,i,a){var s=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,n=[],r=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(n[+t[1]]=r?+t[2]:t[2])});var i=xe((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[n,i,t]}(e);u.s.r=u.s.c=0,u.e.c=o,c=Vt(o),t[0].forEach(function(e,n){s[c+zt(n)]={t:"n",v:e,z:t[1]},l=n}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=Gt(u)),s}Hn.CHART="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",Hn.CHARTEX="http://schemas.microsoft.com/office/2014/relationships/chartEx",Hn.CS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet";Xe("chartsheet",null,{xmlns:je.main[0],"xmlns:r":je.r});var Go=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],jo=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Yo=[],Ko=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Zo(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],i=0;i!=t.length;++i){var a=t[i];if(null==r[a[0]])r[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof r[a[0]]&&(r[a[0]]=Pe(r[a[0]]));break;case"int":"string"==typeof r[a[0]]&&(r[a[0]]=parseInt(r[a[0]],10))}}}function qo(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(null==e[r[0]])e[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof e[r[0]]&&(e[r[0]]=Pe(e[r[0]]));break;case"int":"string"==typeof e[r[0]]&&(e[r[0]]=parseInt(e[r[0]],10))}}}function Qo(e){qo(e.WBProps,Go),qo(e.CalcPr,Ko),Zo(e.WBView,jo),Zo(e.Sheets,Yo),ro.date1904=Pe(e.WBProps.date1904)}var Jo="][*?/\\".split("");function el(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return Jo.forEach(function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}}),n}function tl(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];!function(e,t,n){e.forEach(function(r,i){el(r);for(var a=0;a<i;++a)if(r==e[a])throw new Error("Duplicate Sheet Name: "+r);if(n){var s=t&&t[i]&&t[i].CodeName||r;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)uo(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}var nl=/<\w+:workbook/;var rl=Xe("workbook",null,{xmlns:je.main[0],"xmlns:r":je.r});function il(e,t){return t||(t=Pt(127)),t._W(4,e.Hidden),t._W(4,e.iTabID),mn(e.strRelID,t),tn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function al(t,n){n||(n=Pt(127));for(var r=0;4!=r;++r)n._W(4,0);return tn("SheetJS",n),tn(e.version,n),tn(e.version,n),tn("7262",n),n.length=n.l,n.length>n.l?n.slice(0,n.l):n}function sl(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n=t.Workbook.Sheets,r=0,i=-1,a=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&-1==i?i=r:1==n[r].Hidden&&-1==a&&(a=r);a>i||(It(e,"BrtBeginBookViews"),It(e,"BrtBookView",function(e,t){return t||(t=Pt(29)),t._W(-4,0),t._W(-4,460),t._W(4,28800),t._W(4,17600),t._W(4,500),t._W(4,e),t._W(4,e),t._W(1,120),t.length>t.l?t.slice(0,t.l):t}(i)),It(e,"BrtEndBookViews"))}}function ol(e,t){var n=Mt();return It(n,"BrtBeginBook"),It(n,"BrtFileVersion",al()),It(n,"BrtWbProp",function(e,t){t||(t=Pt(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t._W(4,n),t._W(4,0),un(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),sl(n,e),function(e,t){It(e,"BrtBeginBundleShs");for(var n=0;n!=t.SheetNames.length;++n)It(e,"BrtBundleSh",il({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]}));It(e,"BrtEndBundleShs")}(n,e),It(n,"BrtEndBook"),n.end()}function ll(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],i=!1;t||(t={}),t.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],Bt(e,function(e,o,l){switch(l){case 156:s.SheetNames.push(e.name),n.Sheets.push(e);break;case 153:n.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=Ws(e.Ptg,0,null,s,t),delete t.SID,delete e.Ptg,a.push(e);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([l,e]):s[0]=[l,e],s[s.length-1].XTI=[];break;case 362:0===s.length&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(e),s.XTI=s.XTI.concat(e);break;case 361:break;case 3072:case 3073:case 2071:case 534:case 677:case 158:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(o),i=!0;break;case 36:r.pop(),i=!1;break;case 37:r.push(o),i=!0;break;case 38:r.pop(),i=!1;break;case 16:break;default:if((o||"").indexOf("Begin")>0);else if((o||"").indexOf("End")>0);else if(!i||t.WTF&&"BrtACBegin"!=r[r.length-1]&&"BrtFRTBegin"!=r[r.length-1])throw new Error("Unexpected record "+l+" "+o)}},t),Qo(n),n.Names=a,n.supbooks=s,n}(e,n):function(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,i="xmlns",a={},s=0;if(e.replace(pe,function(o,l){var c=ge(o);switch(be(c[0])){case"<?xml":break;case"<workbook":o.match(nl)&&(i="xmlns"+o.match(/<(\w+):/)[1]),n.xmlns=c[i];break;case"</workbook>":break;case"<fileVersion":delete c[0],n.AppVersion=c;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Go.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":n.WBProps[e[0]]=Pe(c[e[0]]);break;case"int":n.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:n.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(n.WBProps.CodeName=c.codeName);break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete c[0],n.WBView.push(c);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=xe(Be(c.name)),delete c[0],n.Sheets.push(c);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":(a={}).Name=Be(c.name),c.comment&&(a.Comment=c.comment),c.localSheetId&&(a.Sheet=+c.localSheetId),Pe(c.hidden||"0")&&(a.Hidden=!0),s=l+o.length;break;case"</definedName>":a.Ref=xe(Be(e.slice(s,l))),n.Names.push(a);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete c[0],n.CalcPr=c;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o}),-1===je.main.indexOf(n.xmlns))throw new Error("Unknown Namespace: "+n.xmlns);return Qo(n),n}(e,n)}function cl(e,t,n,r,i,a,s,o){return".bin"===t.slice(-4)?function(e,t,n,r,i,a,s){if(!e)return e;var o=t||{};r||(r={"!id":{}}),null!=f&&null==o.dense&&(o.dense=f);var l,c,u,h,d,p,m,v,g,b,S=o.dense?[]:{},y={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=[],w=!1,_=!1,C=[];o.biff=12,o["!row"]=0;var E=0,k=!1,T=[],A={},P=o.supbooks||i.supbooks||[[]];if(P.sharedf=A,P.arrayf=T,P.SheetNames=i.SheetNames||i.Sheets.map(function(e){return e.name}),!o.supbooks&&(o.supbooks=P,i.Names))for(var B=0;B<i.Names.length;++B)P[0][B+1]=i.Names[B];var M=[],I=[],D=!1;if(Bt(e,function(e,t,f){if(!_)switch(f){case 148:l=e;break;case 0:c=e,o.sheetRows&&o.sheetRows<=c.r&&(_=!0),g=zt(d=c.r),o["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=ya(e.hpt)),I[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":v=no[e[1]],u.v=v.t,u.r=v.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==o.cellText&&(u.w=wn[u.v]);break;case"str":u.t="s",u.v=e[1]}if((h=s.CellXf[e[0].iStyleRef])&&co(u,h.numFmtId,null,o,a,s),p=e[0].c,o.dense?(S[d]||(S[d]=[]),S[d][p]=u):S[Vt(p)+g]=u,o.cellFormula){for(k=!1,E=0;E<T.length;++E){var B=T[E];c.r>=B[0].s.r&&c.r<=B[0].e.r&&p>=B[0].s.c&&p<=B[0].e.c&&(u.F=Gt(B[0]),k=!0)}!k&&e.length>3&&(u.f=e[3])}if(y.s.r>c.r&&(y.s.r=c.r),y.s.c>p&&(y.s.c=p),y.e.r<c.r&&(y.e.r=c.r),y.e.c<p&&(y.e.c=p),o.cellDates&&h&&"n"==u.t&&R.is_date(R._table[h.numFmtId])){var L=R.parse_date_code(u.v);L&&(u.t="d",u.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}break;case 1:if(!o.sheetStubs||w)break;u={t:"z",v:void 0},p=e[0].c,o.dense?(S[d]||(S[d]=[]),S[d][p]=u):S[Vt(p)+g]=u,y.s.r>c.r&&(y.s.r=c.r),y.s.c>p&&(y.s.c=p),y.e.r<c.r&&(y.e.r=c.r),y.e.c<p&&(y.e.c=p);break;case 176:C.push(e);break;case 494:var F=r["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),d=e.rfx.s.r;d<=e.rfx.e.r;++d)for(p=e.rfx.s.c;p<=e.rfx.e.c;++p)o.dense?(S[d]||(S[d]=[]),S[d][p]||(S[d][p]={t:"z",v:void 0}),S[d][p].l=e):(m=Ht({c:p,r:d}),S[m]||(S[m]={t:"z",v:void 0}),S[m].l=e);break;case 426:if(!o.cellFormula)break;T.push(e),(b=o.dense?S[d][p]:S[Vt(p)+g]).f=Ws(e[1],0,{r:c.r,c:p},P,o),b.F=Gt(e[0]);break;case 427:if(!o.cellFormula)break;A[Ht(e[0].s)]=e[1],(b=o.dense?S[d][p]:S[Vt(p)+g]).f=Ws(e[1],0,{r:c.r,c:p},P,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)M[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},D||(D=!0,va(e.w/256)),ga(M[e.e+1]);break;case 161:S["!autofilter"]={ref:Gt(e)};break;case 476:S["!margins"]=e;break;case 147:i.Sheets[n]||(i.Sheets[n]={}),e.name&&(i.Sheets[n].CodeName=e.name);break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),e.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 49:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 152:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:w=!0;break;case 36:w=!1;break;case 37:x.push(t),w=!0;break;case 38:x.pop(),w=!1;break;default:if((t||"").indexOf("Begin")>0);else if((t||"").indexOf("End")>0);else if(!w||o.WTF)throw new Error("Unexpected record "+f+" "+t)}},o),delete o.supbooks,delete o["!row"],!S["!ref"]&&(y.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(S["!ref"]=Gt(l||y)),o.sheetRows&&S["!ref"]){var L=jt(S["!ref"]);o.sheetRows<=+L.e.r&&(L.e.r=o.sheetRows-1,L.e.r>y.e.r&&(L.e.r=y.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>y.e.c&&(L.e.c=y.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),S["!fullref"]=S["!ref"],S["!ref"]=Gt(L))}return C.length>0&&(S["!merges"]=C),M.length>0&&(S["!cols"]=M),I.length>0&&(S["!rows"]=I),S}(e,r,n,i,a,s,o):xo(e,r,n,i,a,s,o)}function ul(e,t,n,r,i,a,s,o){return".bin"===t.slice(-4)?function(e,t,n,r,i){if(!e)return e;r||(r={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return Bt(e,function(e,r,l){switch(l){case 550:a["!rel"]=e;break;case 651:i.Sheets[n]||(i.Sheets[n]={}),e.name&&(i.Sheets[n].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(r);break;case 38:s.pop();break;default:if((r||"").indexOf("Begin")>0)s.push(r);else if((r||"").indexOf("End")>0)s.pop();else if(!o||t.WTF)throw new Error("Unexpected record "+l+" "+r)}},t),r["!id"][a["!rel"]]&&(a["!drawel"]=r["!id"][a["!rel"]]),a}(e,r,n,i,a):function(e,t,n,r,i){if(!e)return e;r||(r={"!id":{}});var a,s={"!type":"chart","!drawel":null,"!rel":""},o=e.match(So);return o&&wo(o[0],0,i,n),(a=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}(e,0,n,i,a)}function hl(e,t,n,r){return".bin"===t.slice(-4)?function(e,t,n){var r={NumberFmt:[]};for(var i in R._table)r.NumberFmt[i]=R._table[i];r.CellXf=[],r.Fonts=[];var a=[],s=!1;return Bt(e,function(e,i,o){switch(o){case 44:r.NumberFmt[e[0]]=e[1],R.load(e[1],e[0]);break;case 43:r.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=oa(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:break;case 47:"BrtBeginCellXFs"==a[a.length-1]&&r.CellXf.push(e);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(i),s=!0;break;case 38:a.pop(),s=!1;break;default:if((i||"").indexOf("Begin")>0)a.push(i);else if((i||"").indexOf("End")>0)a.pop();else if(!s||n.WTF&&"BrtACBegin"!=a[a.length-1])throw new Error("Unexpected record "+o+" "+i)}}),r}(e,n,r):Ea(e,n,r)}function dl(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=!1;return Bt(e,function(e,i,a){switch(a){case 159:n.Count=e[0],n.Unique=e[1];break;case 19:n.push(e);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(i.indexOf("Begin")>0||i.indexOf("End"),!r||t.WTF)throw new Error("Unexpected record "+a+" "+i)}}),n}(e,n):function(e,t){var n=[],r="";if(!e)return n;var i=e.match($i);if(i){r=i[2].replace(Ui,"").split(Hi);for(var a=0;a!=r.length;++a){var s=Vi(r[a].trim(),t);null!=s&&(n[n.length]=s)}i=ge(i[1]),n.Count=i.count,n.Unique=i.uniqueCount}return n}(e,n)}function fl(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=[],i={},a=!1;return Bt(e,function(e,s,o){switch(o){case 632:r.push(e);break;case 635:i=e;break;case 637:i.t=e.t,i.h=e.h,i.r=e.r;break;case 636:if(i.author=r[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,n.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:case 38:break;default:if((s||"").indexOf("Begin")>0);else if((s||"").indexOf("End")>0);else if(!a||t.WTF)throw new Error("Unexpected record "+o+" "+s)}}),n}(e,n):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&n.push(t[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var i=e.match(/<(?:\w+:)?comment[^>]*>/);if(i){var a=ge(i[0]),s={author:a.authorId&&n[a.authorId]||"sheetjsghost",ref:a.ref,guid:a.guid},o=Ut(a.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&Vi(l[1])||{r:"",t:"",h:""};s.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),s.t=c.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(s.h=c.h),r.push(s)}}}}),r}(e,n)}function pl(e,t,n){return".bin"===t.slice(-4)?function(e,t,n){var r=[];return Bt(e,function(e,t,n){switch(n){case 63:r.push(e);break;default:if((t||"").indexOf("Begin")>0);else if(!((t||"").indexOf("End")>0))throw new Error("Unexpected record "+n+" "+t)}}),r}(e):function(e){var t=[];if(!e)return t;var n=1;return(e.match(pe)||[]).forEach(function(e){var r=ge(e);switch(r[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?n=r.i:r.i=n,t.push(r)}}),t}(e)}function ml(e,t,n,r){if(".bin"===n.slice(-4))return function(e,t,n,r){if(!e)return e;var i=r||{},a=!1;Bt(e,function(e,t,n){switch(n){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if((t||"").indexOf("Begin")>0);else if((t||"").indexOf("End")>0);else if(!a||i.WTF)throw new Error("Unexpected record "+n.toString(16)+" "+t)}},i)}(e,0,0,r)}function vl(e,t,n){return(".bin"===t.slice(-4)?ol:function(e){var t=[de];t[t.length]=rl;var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Go.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=Xe("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var s={name:Ce(e.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}t[t.length]=Xe("sheet",null,s)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=Xe("definedName",String(e.Ref).replace(/</g,"&lt;").replace(/>/g,"&gt;"),n))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")})(e,n)}function gl(e,t,n,r,i){return(".bin"===t.slice(-4)?Ho:Ao)(e,n,r,i)}function bl(e,t,n){return(".bin"===t.slice(-4)?ji:function(e,t){if(!t.bookSST)return"";var n=[de];n[n.length]=Xe("sst",null,{xmlns:je.main[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var i=e[r],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(Xi)&&(a+=' xml:space="preserve"'),a+=">"+Ce(i.t)+"</t>"),a+="</si>",n[n.length]=a}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")})(e,n)}function Sl(e,t,n){return(".bin"===t.slice(-4)?es:function(e){var t=[de,Qa],n=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var r=Ce(e.a);n.indexOf(r)>-1||(n.push(r),t.push("<author>"+r+"</author>"))})}),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){e[1].forEach(function(r){t.push('<comment ref="'+e[0]+'" authorId="'+n.indexOf(Ce(r.a))+'"><text>'),t.push(Ue("t",null==r.t?"":Ce(r.t))),t.push("</text></comment>")})}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")})(e,n)}var yl=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,xl=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function wl(e,t){var n=e.split(/\s+/),r=[];if(t||(r[0]=n[0]),1===n.length)return r;var i,a,s,o=e.match(yl);if(o)for(s=0;s!=o.length;++s)-1===(a=(i=o[s].match(xl))[1].indexOf(":"))?r[i[1]]=i[2].slice(1,i[2].length-1):r["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(a+1)]=i[2].slice(1,i[2].length-1);return r}function _l(e){var t={};if(1===e.split(/\s+/).length)return t;var n,r,i,a=e.match(yl);if(a)for(i=0;i!=a.length;++i)-1===(r=(n=a[i].match(xl))[1].indexOf(":"))?t[n[1]]=n[2].slice(1,n[2].length-1):t["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(r+1)]=n[2].slice(1,n[2].length-1);return t}function Cl(e,t,n,r){var i=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Pe(r);break;case"i2":case"int":i=parseInt(r,10);break;case"r4":case"float":i=parseFloat(r);break;case"date":case"dateTime.tz":i=K(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[xe(t)]=i}function El(e,t,n){if("z"!==e.t){if(!n||!1!==n.cellText)try{"e"===e.t?e.w=e.w||wn[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=R._general_int(e.v):e.w=R._general_num(e.v):e.w=R._general(e.v):e.w=function(e,t){var n=A[e]||xe(e);return"General"===n?R._general(t):R.format(n,t)}(t||"General",e.v)}catch(e){if(n.WTF)throw e}try{var r=A[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&"n"==e.t&&R.is_date(r)){var i=R.parse_date_code(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(e){if(n.WTF)throw e}}}function kl(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=xa[r.Pattern]||r.Pattern)}e[t.ID]=t}function Rl(e,t,n,r,i,a,s,o,l,c){var u="General",h=r.StyleID,d={};c=c||{};var f=[],p=0;for(void 0===h&&o&&(h=o.StyleID),void 0===h&&s&&(h=s.StyleID);void 0!==a[h]&&(a[h].nf&&(u=a[h].nf),a[h].Interior&&f.push(a[h].Interior),a[h].Parent);)h=a[h].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=Pe(e);break;case"String":r.t="s",r.r=Te(xe(e)),r.v=e.indexOf("<")>-1?xe(t||e):r.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),r.v=(K(e)-new Date(Date.UTC(1899,11,30)))/864e5,r.v!=r.v?r.v=xe(e):r.v<60&&(r.v=r.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=_n[e],!1!==c.cellText&&(r.w=e);break;default:r.t="s",r.v=Te(t||e)}if(El(r,u,c),!1!==c.cellFormula)if(r.Formula){var m=xe(r.Formula);61==m.charCodeAt(0)&&(m=m.slice(1)),r.f=rs(m,i),delete r.Formula,"RC"==r.ArrayRange?r.F=rs("RC:RC",i):r.ArrayRange&&(r.F=rs(r.ArrayRange,i),l.push([jt(r.F),r.F]))}else for(p=0;p<l.length;++p)i.r>=l[p][0].s.r&&i.r<=l[p][0].e.r&&i.c>=l[p][0].s.c&&i.c<=l[p][0].e.c&&(r.F=l[p][1]);c.cellStyles&&(f.forEach(function(e){!d.patternType&&e.patternType&&(d.patternType=e.patternType)}),r.s=d),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}function Tl(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function Al(e){if(m&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return Be(w(_(e)));throw new Error("Bad input format: expected Buffer or string")}var Pl=/<(\/?)([^\s?>!\/:]*:|)([^\s?>:\/]+)[^>]*>/gm;function Bl(e,t){var n=t||{};T(R);var r=u(Al(e));"binary"!=n.type&&"array"!=n.type&&"base64"!=n.type||(r="undefined"!=typeof cptable?cptable.utils.decode(65001,c(r)):Be(r));var i,a=r.slice(0,1024).toLowerCase(),s=!1;if(-1==a.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){a.indexOf("<"+e)>=0&&(s=!0)}),s)return sc.to_workbook(r,n);var o,l=[];null!=f&&null==n.dense&&(n.dense=f);var h,d={},p=[],m=n.dense?[]:{},v="",g={},b={},S=wl('<Data ss:Type="String">'),y=0,x=0,w=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},E={},k="",P=0,B=[],M={},I={},D=0,L=[],F=[],O={},N=[],z=!1,W=[],V=[],$={},U=0,H=0,X={Sheets:[],WBProps:{date1904:!1}},G={};for(Pl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,"");i=Pl.exec(r);)switch(i[3]){case"Data":if(l[l.length-1][1])break;"/"===i[1]?Rl(r.slice(y,i.index),k,S,"Comment"==l[l.length-1][0]?O:g,{c:x,r:w},C,N[x],b,W,n):(k="",S=wl(i[0]),y=i.index+i[0].length);break;case"Cell":if("/"===i[1])if(F.length>0&&(g.c=F),(!n.sheetRows||n.sheetRows>w)&&void 0!==g.v&&(n.dense?(m[w]||(m[w]=[]),m[w][x]=g):m[Vt(x)+zt(w)]=g),g.HRef&&(g.l={Target:g.HRef},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(U=x+(0|parseInt(g.MergeAcross,10)),H=w+(0|parseInt(g.MergeDown,10)),B.push({s:{c:x,r:w},e:{c:U,r:H}})),n.sheetStubs)if(g.MergeAcross||g.MergeDown){for(var j=x;j<=U;++j)for(var Y=w;Y<=H;++Y)(j>x||Y>w)&&(n.dense?(m[Y]||(m[Y]=[]),m[Y][j]={t:"z"}):m[Vt(j)+zt(Y)]={t:"z"});x=U+1}else++x;else g.MergeAcross?x=U+1:++x;else(g=_l(i[0])).Index&&(x=+g.Index-1),x<_.s.c&&(_.s.c=x),x>_.e.c&&(_.e.c=x),"/>"===i[0].slice(-2)&&++x,F=[];break;case"Row":"/"===i[1]||"/>"===i[0].slice(-2)?(w<_.s.r&&(_.s.r=w),w>_.e.r&&(_.e.r=w),"/>"===i[0].slice(-2)&&(b=wl(i[0])).Index&&(w=+b.Index-1),x=0,++w):((b=wl(i[0])).Index&&(w=+b.Index-1),$={},("0"==b.AutoFitHeight||b.Height)&&($.hpx=parseInt(b.Height,10),$.hpt=Sa($.hpx),V[w]=$),"1"==b.Hidden&&($.hidden=!0,V[w]=$));break;case"Worksheet":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"));p.push(v),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(m["!ref"]=Gt(_),n.sheetRows&&n.sheetRows<=_.e.r&&(m["!fullref"]=m["!ref"],_.e.r=n.sheetRows-1,m["!ref"]=Gt(_))),B.length&&(m["!merges"]=B),N.length>0&&(m["!cols"]=N),V.length>0&&(m["!rows"]=V),d[v]=m}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=x=0,l.push([i[3],!1]),o=wl(i[0]),v=xe(o.Name),m=n.dense?[]:{},B=[],W=[],V=[],G={name:v,Hidden:0},X.Sheets.push(G);break;case"Table":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"))}else{if("/>"==i[0].slice(-2))break;wl(i[0]),l.push([i[3],!1]),N=[],z=!1}break;case"Style":"/"===i[1]?kl(C,E,n):E=wl(i[0]);break;case"NumberFormat":E.nf=xe(wl(i[0]).Format||"General"),A[E.nf]&&(E.nf=A[E.nf]);for(var K=0;392!=K&&R._table[K]!=E.nf;++K);if(392==K)for(K=57;392!=K;++K)if(null==R._table[K]){R.load(E.nf,K);break}break;case"Column":if("Table"!==l[l.length-1][0])break;if((h=wl(i[0])).Hidden&&(h.hidden=!0,delete h.Hidden),h.Width&&(h.wpx=parseInt(h.Width,10)),!z&&h.wpx>10){z=!0,ha=la;for(var Z=0;Z<N.length;++Z)N[Z]&&ga(N[Z])}z&&ga(h),N[h.Index-1||N.length]=h;for(var Q=0;Q<+h.Span;++Q)N[N.length]=q(h);break;case"NamedRange":X.Names||(X.Names=[]);var J=ge(i[0]),ee={Name:J.Name,Ref:rs(J.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(ee.Sheet=X.Sheets.length-1),X.Names.push(ee);break;case"NamedCell":case"B":case"I":case"U":case"S":case"Sub":case"Sup":case"Span":case"Alignment":case"Borders":case"Border":break;case"Font":if("/>"===i[0].slice(-2))break;"/"===i[1]?k+=r.slice(P,i.index):P=i.index+i[0].length;break;case"Interior":if(!n.cellStyles)break;E.Interior=wl(i[0]);break;case"Protection":break;case"Author":case"Title":case"Description":case"Created":case"Keywords":case"Subject":case"Category":case"Company":case"LastAuthor":case"LastSaved":case"LastPrinted":case"Version":case"Revision":case"TotalTime":case"HyperlinkBase":case"Manager":case"ContentStatus":case"Identifier":case"Language":case"AppName":if("/>"===i[0].slice(-2))break;"/"===i[1]?pr(M,i[3],r.slice(D,i.index)):D=i.index+i[0].length;break;case"Paragraphs":break;case"Styles":case"Workbook":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"))}else l.push([i[3],!1]);break;case"Comment":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"));Tl(O),F.push(O)}else l.push([i[3],!1]),O={a:(o=wl(i[0])).Author};break;case"AutoFilter":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"))}else if("/"!==i[0].charAt(i[0].length-2)){var te=wl(i[0]);m["!autofilter"]={ref:rs(te.Range).replace(/\$/g,"")},l.push([i[3],!0])}break;case"Name":break;case"DataValidation":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&l.push([i[3],!0]);break;case"ComponentOptions":case"DocumentProperties":case"CustomDocumentProperties":case"OfficeDocumentSettings":case"PivotTable":case"PivotCache":case"Names":case"MapInfo":case"PageBreaks":case"QueryTable":case"Sorting":case"Schema":case"data":case"ConditionalFormatting":case"SmartTagType":case"SmartTags":case"ExcelWorkbook":case"WorkbookOptions":case"WorksheetOptions":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&l.push([i[3],!0]);break;default:if(0==l.length&&"document"==i[3])return hc(r,n);if(0==l.length&&"UOF"==i[3])return hc(r,n);var ne=!0;switch(l[l.length-1][0]){case"OfficeDocumentSettings":switch(i[3]){case"AllowPNG":case"RemovePersonalInformation":case"DownloadComponents":case"LocationOfComponents":case"Colors":case"Color":case"Index":case"RGB":case"PixelsPerInch":case"TargetScreenSize":case"ReadOnlyRecommended":break;default:ne=!1}break;case"ComponentOptions":switch(i[3]){case"Toolbar":case"HideOfficeLogo":case"SpreadsheetAutoFit":case"Label":case"Caption":case"MaxHeight":case"MaxWidth":case"NextSheetNumber":break;default:ne=!1}break;case"ExcelWorkbook":switch(i[3]){case"Date1904":X.WBProps.date1904=!0;break;case"WindowHeight":case"WindowWidth":case"WindowTopX":case"WindowTopY":case"TabRatio":case"ProtectStructure":case"ProtectWindow":case"ProtectWindows":case"ActiveSheet":case"DisplayInkNotes":case"FirstVisibleSheet":case"SupBook":case"SheetName":case"SheetIndex":case"SheetIndexFirst":case"SheetIndexLast":case"Dll":case"AcceptLabelsInFormulas":case"DoNotSaveLinkValues":case"Iteration":case"MaxIterations":case"MaxChange":case"Path":case"Xct":case"Count":case"SelectedSheets":case"Calculation":case"Uncalced":case"StartupPrompt":case"Crn":case"ExternName":case"Formula":case"ColFirst":case"ColLast":case"WantAdvise":case"Boolean":case"Error":case"Text":case"OLE":case"NoAutoRecover":case"PublishObjects":case"DoNotCalculateBeforeSave":case"Number":case"RefModeR1C1":case"EmbedSaveSmartTags":break;default:ne=!1}break;case"WorkbookOptions":switch(i[3]){case"OWCVersion":case"Height":case"Width":break;default:ne=!1}break;case"WorksheetOptions":switch(i[3]){case"Visible":if("/>"===i[0].slice(-2));else if("/"===i[1])switch(r.slice(D,i.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2}else D=i.index+i[0].length;break;case"Header":m["!margins"]||oo(m["!margins"]={},"xlml"),m["!margins"].header=ge(i[0]).Margin;break;case"Footer":m["!margins"]||oo(m["!margins"]={},"xlml"),m["!margins"].footer=ge(i[0]).Margin;break;case"PageMargins":var re=ge(i[0]);m["!margins"]||oo(m["!margins"]={},"xlml"),re.Top&&(m["!margins"].top=re.Top),re.Left&&(m["!margins"].left=re.Left),re.Right&&(m["!margins"].right=re.Right),re.Bottom&&(m["!margins"].bottom=re.Bottom);break;case"DisplayRightToLeft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"FreezePanes":case"FrozenNoSplit":break;case"SplitHorizontal":case"SplitVertical":case"DoNotDisplayGridlines":case"TopRowBottomPane":case"LeftColumnRightPane":case"Unsynced":case"Print":case"Panes":case"Scale":case"Pane":case"Number":case"Layout":case"PageSetup":case"Selected":case"ProtectObjects":case"EnableSelection":case"ProtectScenarios":case"ValidPrinterInfo":case"HorizontalResolution":case"VerticalResolution":case"NumberofCopies":case"ActiveRow":case"ActiveCol":case"ActivePane":case"TopRowVisible":case"LeftColumnVisible":case"FitToPage":case"RangeSelection":case"PaperSizeIndex":case"PageLayoutZoom":case"PageBreakZoom":case"FilterOn":case"FitWidth":case"FitHeight":case"CommentsLayout":case"Zoom":case"LeftToRight":case"Gridlines":case"AllowSort":case"AllowFilter":case"AllowInsertRows":case"AllowDeleteRows":case"AllowInsertCols":case"AllowDeleteCols":case"AllowInsertHyperlinks":case"AllowFormatCells":case"AllowSizeCols":case"AllowSizeRows":case"NoSummaryRowsBelowDetail":case"TabColorIndex":case"DoNotDisplayHeadings":case"ShowPageLayoutZoom":case"NoSummaryColumnsRightDetail":case"BlackAndWhite":case"DoNotDisplayZeros":case"DisplayPageBreak":case"RowColHeadings":case"DoNotDisplayOutline":case"NoOrientation":case"AllowUsePivotTables":case"ZeroHeight":case"ViewableRange":case"Selection":case"ProtectContents":break;default:ne=!1}break;case"PivotTable":case"PivotCache":switch(i[3]){case"ImmediateItemsOnDrop":case"ShowPageMultipleItemLabel":case"CompactRowIndent":case"Location":case"PivotField":case"Orientation":case"LayoutForm":case"LayoutSubtotalLocation":case"LayoutCompactRow":case"Position":case"PivotItem":case"DataType":case"DataField":case"SourceName":case"ParentField":case"PTLineItems":case"PTLineItem":case"CountOfSameItems":case"Item":case"ItemType":case"PTSource":case"CacheIndex":case"ConsolidationReference":case"FileName":case"Reference":case"NoColumnGrand":case"NoRowGrand":case"BlankLineAfterItems":case"Hidden":case"Subtotal":case"BaseField":case"MapChildItems":case"Function":case"RefreshOnFileOpen":case"PrintSetTitles":case"MergeLabels":case"DefaultVersion":case"RefreshName":case"RefreshDate":case"RefreshDateCopy":case"VersionLastRefresh":case"VersionLastUpdate":case"VersionUpdateableMin":case"VersionRefreshableMin":case"Calculation":break;default:ne=!1}break;case"PageBreaks":switch(i[3]){case"ColBreaks":case"ColBreak":case"RowBreaks":case"RowBreak":case"ColStart":case"ColEnd":case"RowEnd":break;default:ne=!1}break;case"AutoFilter":switch(i[3]){case"AutoFilterColumn":case"AutoFilterCondition":case"AutoFilterAnd":case"AutoFilterOr":break;default:ne=!1}break;case"QueryTable":switch(i[3]){case"Id":case"AutoFormatFont":case"AutoFormatPattern":case"QuerySource":case"QueryType":case"EnableRedirections":case"RefreshedInXl9":case"URLString":case"HTMLTables":case"Connection":case"CommandText":case"RefreshInfo":case"NoTitles":case"NextId":case"ColumnInfo":case"OverwriteCells":case"DoNotPromptForFile":case"TextWizardSettings":case"Source":case"Number":case"Decimal":case"ThousandSeparator":case"TrailingMinusNumbers":case"FormatSettings":case"FieldType":case"Delimiters":case"Tab":case"Comma":case"AutoFormatName":case"VersionLastEdit":case"VersionLastRefresh":break;default:ne=!1}break;case"DataValidation":switch(i[3]){case"Range":case"Type":case"Min":case"Max":case"Sort":case"Descending":case"Order":case"CaseSensitive":case"Value":case"ErrorStyle":case"ErrorMessage":case"ErrorTitle":case"InputMessage":case"InputTitle":case"ComboHide":case"InputHide":case"Condition":case"Qualifier":case"UseBlank":case"Value1":case"Value2":case"Format":case"CellRangeList":break;default:ne=!1}break;case"Sorting":case"ConditionalFormatting":switch(i[3]){case"Range":case"Type":case"Min":case"Max":case"Sort":case"Descending":case"Order":case"CaseSensitive":case"Value":case"ErrorStyle":case"ErrorMessage":case"ErrorTitle":case"CellRangeList":case"InputMessage":case"InputTitle":case"ComboHide":case"InputHide":case"Condition":case"Qualifier":case"UseBlank":case"Value1":case"Value2":case"Format":break;default:ne=!1}break;case"MapInfo":case"Schema":case"data":switch(i[3]){case"Map":case"Entry":case"Range":case"XPath":case"Field":case"XSDType":case"FilterOn":case"Aggregate":case"ElementType":case"AttributeType":break;case"schema":case"element":case"complexType":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:ne=!1}break;case"SmartTags":break;default:ne=!1}if(ne)break;if(i[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+i[3]+"|"+l.join("|");if("CustomDocumentProperties"===l[l.length-1][0]){if("/>"===i[0].slice(-2))break;"/"===i[1]?Cl(I,i[3],L,r.slice(D,i.index)):(L=i,D=i.index+i[0].length);break}if(n.WTF)throw"Unrecognized tag: "+i[3]+"|"+l.join("|")}var ie={};return n.bookSheets||n.bookProps||(ie.Sheets=d),ie.SheetNames=p,ie.Workbook=X,ie.SSF=R.get_table(),ie.Props=M,ie.Custprops=I,ie}function Ml(e,t){switch(kc(t=t||{}),t.type||"base64"){case"base64":return Bl(p.decode(e),t);case"binary":case"buffer":case"file":return Bl(e,t);case"array":return Bl(w(e),t)}}function Il(e,t){var n=[];return e.Props&&n.push(function(e,t){var n=[];return O(dr).map(function(e){for(var t=0;t<tr.length;++t)if(tr[t][1]==e)return tr[t];for(t=0;t<sr.length;++t)if(sr[t][1]==e)return sr[t];throw e}).forEach(function(r){if(null!=e[r[1]]){var i=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")}"number"==typeof i?i=String(i):!0===i||!1===i?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(Ue(dr[r[1]]||r[1],i))}}),Xe("DocumentProperties",n.join(""),{xmlns:Ye.o})}(e.Props,t)),e.Custprops&&n.push(function(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&O(e).forEach(function(t){if(e.hasOwnProperty(t)){for(var r=0;r<tr.length;++r)if(t==tr[r][1])return;for(r=0;r<sr.length;++r)if(t==sr[r][1])return;for(r=0;r<n.length;++r)if(t==n[r])return;var a=e[t],s="string";"number"==typeof a?(s="float",a=String(a)):!0===a||!1===a?(s="boolean",a=a?"1":"0"):a=String(a),i.push(Xe(Ee(t),a,{"dt:dt":s}))}}),t&&O(t).forEach(function(n){if(t.hasOwnProperty(n)&&(!e||!e.hasOwnProperty(n))){var r=t[n],a="string";"number"==typeof r?(a="float",r=String(r)):!0===r||!1===r?(a="boolean",r=r?"1":"0"):r instanceof Date?(a="dateTime.tz",r=r.toISOString()):r=String(r),i.push(Xe(Ee(n),r,{"dt:dt":a}))}}),"<"+r+' xmlns="'+Ye.o+'">'+i.join("")+"</"+r+">"}(e.Props,e.Custprops)),n.join("")}function Dl(e){return Xe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+as(e.Ref,{r:0,c:0})})}function Ll(e,t,n,r,i,a,s){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ce(as(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=Ut(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ce(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ce(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c==s.c&&c[u].s.r==s.r&&(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",d="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=wn[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||R._table[14]);break;case"s":h="String",d=function(e){return(e+"").replace(we,function(e){return ye[e]}).replace(ke,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}(e.v||"")}var f=lo(r.cellXfs,e,r);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=s.c+1;var p=null!=e.v?d:"",m="z"==e.t?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=function(e){return e.map(function(e){return Xe("Comment",Xe("ss:Data",Ae(e.t||""),{xmlns:"http://www.w3.org/TR/REC-html40"}),{"ss:Author":e.a})}).join("")}(e.c)),Xe("Cell",m,o)}function Fl(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ya(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function Ol(e,t,n){var r=[],i=n.SheetNames[e],a=n.Sheets[i],s=a?function(e,t,n,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,a=[],s=0;s<i.length;++s){var o=i[s];o.Sheet==n&&(o.Name.match(/^_xlfn\./)||a.push(Dl(o)))}return a.join("")}(a,0,e,n):"";return s.length>0&&r.push("<Names>"+s+"</Names>"),(s=a?function(e,t,n,r){if(!e["!ref"])return"";var i=jt(e["!ref"]),a=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(e,t){ga(e);var n=!!e.width,r=so(t,e),i={"ss:Index":t+1};n&&(i["ss:Width"]=da(r.width)),e.hidden&&(i["ss:Hidden"]="1"),o.push(Xe("Column",null,i))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var u=[Fl(c,(e["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>h||a[s].s.r>c||a[s].e.c<h||a[s].e.r<c)){a[s].s.c==h&&a[s].s.r==c||(d=!0);break}if(!d){var f={r:c,c:h},p=Ht(f),m=l?(e[c]||[])[h]:e[p];u.push(Ll(m,p,e,t,0,0,f))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}(a,t):"").length>0&&r.push("<Table>"+s+"</Table>"),r.push(function(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Xe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Xe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Xe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(Xe("Visible",1==r.Workbook.Sheets[n].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<n&&(!r.Workbook.Sheets[a]||r.Workbook.Sheets[a].Hidden);++a);a==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Ue("ProtectContents","True")),e["!protect"].objects&&i.push(Ue("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Ue("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||i.push(Ue("EnableSelection","UnlockedCells")):i.push(Ue("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&i.push("<"+t[1]+"/>")})),0==i.length?"":Xe("WorksheetOptions",i.join(""),{xmlns:Ye.x})}(a,0,e,n)),r.join("")}function Nl(e,t){t||(t={}),e.SSF||(e.SSF=R.get_table()),e.SSF&&(T(R),R.load_table(e.SSF),t.revssf=W(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],lo(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(Il(e,t)),n.push(""),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(Xe("Worksheet",Ol(r,t,e),{"ss:Name":Ce(e.SheetNames[r])}));return n[2]=function(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var r=[];r.push(Xe("NumberFormat",null,{"ss:Format":Ce(R._table[e.numFmtId])})),n.push(Xe("Style",r.join(""),{"ss:ID":"s"+(21+t)}))}),Xe("Styles",n.join(""))}(0,t),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];null==i.Sheet&&(i.Name.match(/^_xlfn\./)||n.push(Dl(i)))}return Xe("Names",n.join(""))}(e),de+Xe("Workbook",n.join(""),{xmlns:Ye.ss,"xmlns:o":Ye.o,"xmlns:x":Ye.x,"xmlns:ss":Ye.ss,"xmlns:dt":Ye.dt,"xmlns:html":Ye.html})}function zl(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n._R(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return En(e,1)}(n),n.length-n.l<=4)return t;var r=n._R(4);return 0==r||r>40?t:(n.l-=4,t.Reserved1=n._R(0,"lpstr-ansi"),n.length-n.l<=4?t:1907505652!==(r=n._R(4))?t:(t.UnicodeClipboardFormat=function(e){return En(e,2)}(n),0==(r=n._R(4))||r>40?t:(n.l-=4,void(t.Reserved2=n._R(0,"lpwstr")))))}function Wl(e,t,n,r){var i=n,a=[],s=t.slice(t.l,t.l+i);if(r&&r.enc&&r.enc.insitu)switch(e.n){case"BOF":case"FilePass":case"FileLock":case"InterfaceHdr":case"RRDInfo":case"RRDHead":case"UsrExcl":break;default:if(0===s.length)break;r.enc.insitu(s)}a.push(s),t.l+=i;for(var o=Kl[gt(t,t.l)],l=0;null!=o&&"Continue"===o.n.slice(0,8);)i=gt(t,t.l+2),l=t.l+4,"ContinueFrt"==o.n?l+=4:"ContinueFrt"==o.n.slice(0,11)&&(l+=12),a.push(t.slice(l,t.l+4+i)),t.l+=4+i,o=Kl[gt(t,t.l)];var c=C(a);Tt(c,0);var u=0;c.lens=[];for(var h=0;h<a.length;++h)c.lens.push(u),u+=a[h].length;return e.f(c,c.length,r)}function Vl(e,t,n){if("z"!==e.t&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=R._table[r])}catch(e){if(t.WTF)throw e}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||wn[e.v]:0===r||"General"==r?"n"===e.t?(0|e.v)===e.v?e.w=R._general_int(e.v):e.w=R._general_num(e.v):e.w=R._general(e.v):e.w=R.format(r,e.v,{date1904:!!n})}catch(e){if(t.WTF)throw e}if(t.cellDates&&r&&"n"==e.t&&R.is_date(R._table[r]||String(r))){var i=R.parse_date_code(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function $l(e,t,n){return{v:e,ixfe:t,t:n}}function Ul(e,t){var n={opts:{}},r={};null!=f&&null==t.dense&&(t.dense=f);var i,a,s,l,c,u,h,d,p=t.dense?[]:{},m={},v={},g=null,b=[],S="",y={},x="",w={},_=[],C=!0,E=[],k=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},P=function(e){return e<8?Nn[e]:e<64&&k[e-8]||Nn[e]},B=function(e,t,n){if(!($>1)&&(n.sheetRows&&e.r>=n.sheetRows&&(C=!1),C)){if(n.cellStyles&&t.XF&&t.XF.data&&function(e,t,n){var r,i=t.XF.data;i&&i.patternType&&n&&n.cellStyles&&(t.s={},t.s.patternType=i.patternType,(r=sa(P(i.icvFore)))&&(t.s.fgColor={rgb:r}),(r=sa(P(i.icvBack)))&&(t.s.bgColor={rgb:r}))}(0,t,n),delete t.ixfe,delete t.XF,i=e,x=Ht(e),v&&v.s&&v.e||(v={s:{r:0,c:0},e:{r:0,c:0}}),e.r<v.s.r&&(v.s.r=e.r),e.c<v.s.c&&(v.s.c=e.c),e.r+1>v.e.r&&(v.e.r=e.r+1),e.c+1>v.e.c&&(v.e.c=e.c+1),n.cellFormula&&t.f)for(var r=0;r<_.length;++r)if(!(_[r][0].s.c>e.c||_[r][0].s.r>e.r||_[r][0].e.c<e.c||_[r][0].e.r<e.r)){t.F=Gt(_[r][0]),_[r][0].s.c==e.c&&_[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+Ws(_[r][1],0,e,z,M));break}n.dense?(p[e.r]||(p[e.r]=[]),p[e.r][e.c]=t):p[x]=t}},M={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(M.password=t.password);var I=[],D=[],L=[],F=[],N=!1,z=[];z.SheetNames=M.snames,z.sharedf=M.sharedf,z.arrayf=M.arrayf,z.names=[],z.XTI=[];var W,V="",$=0,U=0,H=[],X=[];M.codepage=1200,o(1200);for(var G=!1;e.l<e.length-1;){var j=e.l,Y=e._R(2);if(0===Y&&"EOF"===V)break;var K=e.l===e.length?0:e._R(2),Z=Kl[Y];if(Z&&Z.f){if(t.bookSheets&&"BoundSheet8"===V&&"BoundSheet8"!==Z.n)break;if(V=Z.n,2===Z.r||12==Z.r){var q=e._R(2);if(K-=2,!M.enc&&q!==Y&&((255&q)<<8|q>>8)!==Y)throw new Error("rt mismatch: "+q+"!="+Y);12==Z.r&&(e.l+=10,K-=10)}var Q={};Q="EOF"===Z.n?Z.f(e,K,M):Wl(Z,e,K,M);var J=Z.n;if(0==$&&"BOF"!=J)continue;switch(J){case"Date1904":n.opts.Date1904=T.WBProps.date1904=Q;break;case"WriteProtect":n.opts.WriteProtect=!0;break;case"FilePass":if(M.enc||(e.l=0),M.enc=Q,!t.password)throw new Error("File is password-protected");if(null==Q.valid)throw new Error("Encryption scheme unsupported");if(!Q.valid)throw new Error("Password is incorrect");break;case"WriteAccess":M.lastuser=Q;break;case"FileSharing":break;case"CodePage":var ee=Number(Q);switch(ee){case 21010:ee=1200;break;case 32768:ee=1e4;break;case 32769:ee=1252}o(M.codepage=ee),G=!0;break;case"RRTabId":M.rrtabid=Q;break;case"WinProtect":M.winlocked=Q;break;case"Template":case"BookBool":case"UsesELFs":case"MTRSettings":break;case"RefreshAll":case"CalcCount":case"CalcDelta":case"CalcIter":case"CalcMode":case"CalcPrecision":case"CalcSaveRecalc":n.opts[J]=Q;break;case"CalcRefMode":M.CalcRefMode=Q;break;case"Uncalced":break;case"ForceFullCalculation":n.opts.FullCalc=Q;break;case"WsBool":Q.fDialog&&(p["!type"]="dialog");break;case"XF":E.push(Q);break;case"ExtSST":case"BookExt":case"RichTextStream":case"BkHim":break;case"SupBook":z.push([Q]),z[z.length-1].XTI=[];break;case"ExternName":z[z.length-1].push(Q);break;case"Index":break;case"Lbl":W={Name:Q.Name,Ref:Ws(Q.rgce,0,null,z,M)},Q.itab>0&&(W.Sheet=Q.itab-1),z.names.push(W),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(Q),"_xlnm._FilterDatabase"==Q.Name&&Q.itab>0&&Q.rgce&&Q.rgce[0]&&Q.rgce[0][0]&&"PtgArea3d"==Q.rgce[0][0][0]&&(X[Q.itab-1]={ref:Gt(Q.rgce[0][0][1][2])});break;case"ExternCount":M.ExternCount=Q;break;case"ExternSheet":0==z.length&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(Q),z.XTI=z.XTI.concat(Q);break;case"NameCmt":if(M.biff<8)break;null!=W&&(W.Comment=Q[1]);break;case"Protect":p["!protect"]=Q;break;case"Password":0!==Q&&M.WTF&&console.error("Password verifier: "+Q);break;case"Prot4Rev":case"Prot4RevPass":break;case"BoundSheet8":m[Q.pos]=Q,M.snames.push(Q.name);break;case"EOF":if(--$)break;if(v.e){if(v.e.r>0&&v.e.c>0){if(v.e.r--,v.e.c--,p["!ref"]=Gt(v),t.sheetRows&&t.sheetRows<=v.e.r){var te=v.e.r;v.e.r=t.sheetRows-1,p["!fullref"]=p["!ref"],p["!ref"]=Gt(v),v.e.r=te}v.e.r++,v.e.c++}I.length>0&&(p["!merges"]=I),D.length>0&&(p["!objects"]=D),L.length>0&&(p["!cols"]=L),F.length>0&&(p["!rows"]=F),T.Sheets.push(A)}""===S?y=p:r[S]=p,p=t.dense?[]:{};break;case"BOF":if(8===M.biff&&(M.biff={9:2,521:3,1033:4}[Y]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Q.BIFFVer]||8),8==M.biff&&0==Q.BIFFVer&&16==Q.dt&&(M.biff=2),$++)break;if(C=!0,p=t.dense?[]:{},M.biff<8&&!G&&(G=!0,o(M.codepage=t.codepage||1252)),M.biff<5){""===S&&(S="Sheet1"),v={s:{r:0,c:0},e:{r:0,c:0}};var ne={pos:e.l-K,name:S};m[ne.pos]=ne,M.snames.push(S)}else S=(m[j]||{name:""}).name;32==Q.dt&&(p["!type"]="chart"),64==Q.dt&&(p["!type"]="macro"),I=[],D=[],M.arrayf=_=[],L=[],F=[],0,N=!1,A={Hidden:(m[j]||{hs:0}).hs,name:S};break;case"Number":case"BIFF2NUM":case"BIFF2INT":"chart"==p["!type"]&&(t.dense?(p[Q.r]||[])[Q.c]:p[Ht({c:Q.c,r:Q.r})])&&++Q.c,u={ixfe:Q.ixfe,XF:E[Q.ixfe]||{},v:Q.val,t:"n"},U>0&&(u.z=H[u.ixfe>>8&31]),Vl(u,t,n.opts.Date1904),B({c:Q.c,r:Q.r},u,t);break;case"BoolErr":u={ixfe:Q.ixfe,XF:E[Q.ixfe],v:Q.val,t:Q.t},U>0&&(u.z=H[u.ixfe>>8&31]),Vl(u,t,n.opts.Date1904),B({c:Q.c,r:Q.r},u,t);break;case"RK":u={ixfe:Q.ixfe,XF:E[Q.ixfe],v:Q.rknum,t:"n"},U>0&&(u.z=H[u.ixfe>>8&31]),Vl(u,t,n.opts.Date1904),B({c:Q.c,r:Q.r},u,t);break;case"MulRk":for(var re=Q.c;re<=Q.C;++re){var ie=Q.rkrec[re-Q.c][0];u={ixfe:ie,XF:E[ie],v:Q.rkrec[re-Q.c][1],t:"n"},U>0&&(u.z=H[u.ixfe>>8&31]),Vl(u,t,n.opts.Date1904),B({c:re,r:Q.r},u,t)}break;case"Formula":if("String"==Q.val){g=Q;break}if((u=$l(Q.val,Q.cell.ixfe,Q.tt)).XF=E[u.ixfe],t.cellFormula){var ae=Q.formula;if(ae&&ae[0]&&ae[0][0]&&"PtgExp"==ae[0][0][0]){var se=ae[0][0][1][0],oe=ae[0][0][1][1],le=Ht({r:se,c:oe});w[le]?u.f=""+Ws(Q.formula,0,Q.cell,z,M):u.F=((t.dense?(p[se]||[])[oe]:p[le])||{}).F}else u.f=""+Ws(Q.formula,0,Q.cell,z,M)}U>0&&(u.z=H[u.ixfe>>8&31]),Vl(u,t,n.opts.Date1904),B(Q.cell,u,t),g=Q;break;case"String":if(!g)throw new Error("String record expects Formula");g.val=Q,(u=$l(Q,g.cell.ixfe,"s")).XF=E[u.ixfe],t.cellFormula&&(u.f=""+Ws(g.formula,0,g.cell,z,M)),U>0&&(u.z=H[u.ixfe>>8&31]),Vl(u,t,n.opts.Date1904),B(g.cell,u,t),g=null;break;case"Array":_.push(Q);var ce=Ht(Q[0].s);if(a=t.dense?(p[Q[0].s.r]||[])[Q[0].s.c]:p[ce],t.cellFormula&&a){if(!g)break;if(!ce||!a)break;a.f=""+Ws(Q[1],0,Q[0],z,M),a.F=Gt(Q[0])}break;case"ShrFmla":if(!C)break;if(!t.cellFormula)break;if(x){if(!g)break;w[Ht(g.cell)]=Q[0],((a=t.dense?(p[g.cell.r]||[])[g.cell.c]:p[Ht(g.cell)])||{}).f=""+Ws(Q[0],0,i,z,M)}break;case"LabelSst":u=$l(b[Q.isst].t,Q.ixfe,"s"),b[Q.isst].h&&(u.h=b[Q.isst].h),u.XF=E[u.ixfe],U>0&&(u.z=H[u.ixfe>>8&31]),Vl(u,t,n.opts.Date1904),B({c:Q.c,r:Q.r},u,t);break;case"Blank":t.sheetStubs&&(u={ixfe:Q.ixfe,XF:E[Q.ixfe],t:"z"},U>0&&(u.z=H[u.ixfe>>8&31]),Vl(u,t,n.opts.Date1904),B({c:Q.c,r:Q.r},u,t));break;case"MulBlank":if(t.sheetStubs)for(var ue=Q.c;ue<=Q.C;++ue){var he=Q.ixfe[ue-Q.c];u={ixfe:he,XF:E[he],t:"z"},U>0&&(u.z=H[u.ixfe>>8&31]),Vl(u,t,n.opts.Date1904),B({c:ue,r:Q.r},u,t)}break;case"RString":case"Label":case"BIFF2STR":(u=$l(Q.val,Q.ixfe,"s")).XF=E[u.ixfe],U>0&&(u.z=H[u.ixfe>>8&31]),Vl(u,t,n.opts.Date1904),B({c:Q.c,r:Q.r},u,t);break;case"Dimensions":1===$&&(v=Q);break;case"SST":b=Q;break;case"Format":if(4==M.biff){H[U++]=Q[1];for(var de=0;de<U+163&&R._table[de]!=Q[1];++de);de>=163&&R.load(Q[1],U+163)}else R.load(Q[1],Q[0]);break;case"BIFF2FORMAT":H[U++]=Q;for(var fe=0;fe<U+163&&R._table[fe]!=Q;++fe);fe>=163&&R.load(Q,U+163);break;case"MergeCells":I=I.concat(Q);break;case"Obj":D[Q.cmo[0]]=M.lastobj=Q;break;case"TxO":M.lastobj.TxO=Q;break;case"ImData":M.lastobj.ImData=Q;break;case"HLink":for(c=Q[0].s.r;c<=Q[0].e.r;++c)for(l=Q[0].s.c;l<=Q[0].e.c;++l)(a=t.dense?(p[c]||[])[l]:p[Ht({c:l,r:c})])&&(a.l=Q[1]);break;case"HLinkTooltip":for(c=Q[0].s.r;c<=Q[0].e.r;++c)for(l=Q[0].s.c;l<=Q[0].e.c;++l)(a=t.dense?(p[c]||[])[l]:p[Ht({c:l,r:c})])&&a.l&&(a.l.Tooltip=Q[1]);break;case"Note":if(M.biff<=5&&M.biff>=2)break;a=t.dense?(p[Q[0].r]||[])[Q[0].c]:p[Ht(Q[0])];var pe=D[Q[2]];a||(t.dense?(p[Q[0].r]||(p[Q[0].r]=[]),a=p[Q[0].r][Q[0].c]={t:"z"}):a=p[Ht(Q[0])]={t:"z"},v.e.r=Math.max(v.e.r,Q[0].r),v.s.r=Math.min(v.s.r,Q[0].r),v.e.c=Math.max(v.e.c,Q[0].c),v.s.c=Math.min(v.s.c,Q[0].c)),a.c||(a.c=[]),s={a:Q[1],t:pe.TxO.t},a.c.push(s);break;default:switch(Z.n){case"ClrtClient":break;case"XFExt":Ka(E[Q.ixfe],Q.ext);break;case"DefColWidth":Q;break;case"DefaultRowHeight":Q[1];break;case"ColInfo":if(!M.cellStyles)break;for(;Q.e>=Q.s;)L[Q.e--]={width:Q.w/256},N||(N=!0,va(Q.w/256)),ga(L[Q.e+1]);break;case"Row":var me={};null!=Q.level&&(F[Q.r]=me,me.level=Q.level),Q.hidden&&(F[Q.r]=me,me.hidden=!0),Q.hpt&&(F[Q.r]=me,me.hpt=Q.hpt,me.hpx=ya(Q.hpt));break;case"LeftMargin":case"RightMargin":case"TopMargin":case"BottomMargin":p["!margins"]||oo(p["!margins"]={}),p["!margins"][J.slice(0,-6).toLowerCase()]=Q;break;case"Setup":p["!margins"]||oo(p["!margins"]={}),p["!margins"].header=Q.header,p["!margins"].footer=Q.footer;break;case"Window2":Q.RTL&&(T.Views[0].RTL=!0);break;case"Header":case"Footer":case"HCenter":case"VCenter":case"Pls":case"GCW":case"LHRecord":case"DBCell":case"EntExU2":case"SxView":case"Sxvd":case"SXVI":case"SXVDEx":case"SxIvd":case"SXString":case"Sync":case"Addin":case"SXDI":case"SXLI":case"SXEx":case"QsiSXTag":case"Selection":case"Feat":break;case"FeatHdr":case"FeatHdr11":break;case"Feature11":case"Feature12":case"List12":break;case"Country":h=Q;break;case"RecalcId":case"DxGCol":break;case"Fbi":case"Fbi2":case"GelFrame":case"Font":case"XFCRC":case"Style":case"StyleExt":break;case"Palette":k=Q;break;case"Theme":d=Q;break;case"ScenarioProtect":case"ObjProtect":case"CondFmt12":case"Table":case"TableStyles":case"TableStyle":case"TableStyleElement":case"SXStreamID":case"SXVS":case"DConRef":case"SXAddl":case"DConBin":case"DConName":case"SXPI":case"SxFormat":case"SxSelect":case"SxRule":case"SxFilt":case"SxItm":case"SxDXF":case"ScenMan":case"DCon":case"CellWatch":case"PrintRowCol":case"PrintGrid":case"PrintSize":case"XCT":case"CRN":case"Scl":case"SheetExt":case"SheetExtOptional":case"ObNoMacros":case"ObProj":break;case"CodeName":S?A.CodeName=Q||A.name:T.WBProps.CodeName=Q||"ThisWorkbook";break;case"GUIDTypeLib":case"WOpt":case"PhoneticInfo":case"OleObjectSize":break;case"DXF":case"DXFN":case"DXFN12":case"DXFN12List":case"DXFN12NoCB":break;case"Dv":case"DVal":break;case"BRAI":case"Series":case"SeriesText":case"DConn":case"DbOrParamQry":case"DBQueryExt":case"OleDbConn":case"ExtString":case"IFmtRecord":break;case"CondFmt":case"CF":case"CF12":case"CFEx":case"Excel9File":case"Units":break;case"InterfaceHdr":case"Mms":case"InterfaceEnd":case"DSF":case"BuiltInFnGroupCount":break;case"Window1":case"HideObj":case"GridSet":case"Guts":case"UserBView":case"UserSViewBegin":case"UserSViewEnd":case"Pane":break;default:switch(Z.n){case"Dat":case"Begin":case"End":case"StartBlock":case"EndBlock":case"Frame":case"Area":case"Axis":case"AxisLine":case"Tick":break;case"AxesUsed":case"CrtLayout12":case"CrtLayout12A":case"CrtLink":case"CrtLine":case"CrtMlFrt":case"CrtMlFrtContinue":break;case"LineFormat":case"AreaFormat":case"Chart":case"Chart3d":case"Chart3DBarShape":case"ChartFormat":case"ChartFrtInfo":break;case"PlotArea":case"PlotGrowth":break;case"SeriesList":case"SerParent":case"SerAuxTrend":break;case"DataFormat":case"SerToCrt":case"FontX":break;case"CatSerRange":case"AxcExt":case"SerFmt":case"ShtProps":break;case"DefaultText":case"Text":case"CatLab":case"DataLabExtContents":break;case"Legend":case"LegendException":break;case"Pie":case"Scatter":break;case"PieFormat":case"MarkerFormat":break;case"StartObject":case"EndObject":break;case"AlRuns":case"ObjectLink":case"SIIndex":break;case"AttachedLabel":case"YMult":break;case"Line":case"Bar":case"Surf":case"AxisParent":case"Pos":case"ValueRange":case"SXViewEx9":case"SXViewLink":case"PivotChartBits":case"SBaseRef":case"TextPropsStream":case"LnExt":case"MkrExt":case"CrtCoopt":break;case"Qsi":case"Qsif":case"Qsir":case"QsiSXTag":case"TxtQry":case"FilterMode":break;case"AutoFilter":case"AutoFilterInfo":case"AutoFilter12":case"DropDownObjIds":case"Sort":case"SortData":case"ShapePropsStream":break;case"MsoDrawing":case"MsoDrawingGroup":case"MsoDrawingSelection":break;case"WebPub":case"AutoWebPub":break;case"HeaderFooter":case"HFPicture":case"PLV":case"HorizontalPageBreaks":case"VerticalPageBreaks":break;case"Backup":case"CompressPictures":case"Compat12":break;case"Continue":case"ContinueFrt12":break;case"FrtFontList":case"FrtWrapper":break;default:switch(Z.n){case"TabIdConf":case"Radar":case"RadarArea":case"DropBar":case"Intl":case"CoordList":case"SerAuxErrBar":break;case"BIFF2FONTCLR":case"BIFF2FMTCNT":case"BIFF2FONTXTRA":break;case"BIFF2XF":case"BIFF3XF":case"BIFF4XF":break;case"BIFF4FMTCNT":case"BIFF2ROW":case"BIFF2WINDOW2":break;case"SCENARIO":case"DConBin":case"PicF":case"DataLabExt":case"Lel":case"BopPop":case"BopPopCustom":case"RealTimeData":case"Name":break;case"LHNGraph":case"FnGroupName":case"AddMenu":case"LPr":break;case"ListObj":case"ListField":case"RRSort":case"BigName":break;case"ToolbarHdr":case"ToolbarEnd":case"DDEObjName":case"FRTArchId$":break;default:if(t.WTF)throw"Unrecognized Record "+Z.n}}}}}else e.l+=K}return n.SheetNames=O(m).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return m[e].name}),t.bookSheets||(n.Sheets=r),n.Sheets&&X.forEach(function(e,t){n.Sheets[n.SheetNames[t]]["!autofilter"]=e}),n.Preamble=y,n.Strings=b,n.SSF=R.get_table(),M.enc&&(n.Encryption=M.enc),d&&(n.Themes=d),n.Metadata={},void 0!==h&&(n.Metadata.Country=h),z.names.length>0&&(T.Names=z.names),n.Workbook=T,n}var Hl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Xl(e,t){var n,r,i,a;if(t||(t={}),kc(t),l(),t.codepage&&s(t.codepage),e.FullPaths){if(D.find(e,"/encryption"))throw new Error("File is password-protected");n=D.find(e,"!CompObj"),r=D.find(e,"/Workbook")||D.find(e,"/Book")}else{switch(t.type){case"base64":e=y(p.decode(e));break;case"binary":e=y(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Tt(e,0),r={content:e}}if(n&&zl(n),t.bookProps&&!t.bookSheets)i={};else{var o=m?"buffer":"array";if(r&&r.content)i=Ul(r.content,t);else if((a=D.find(e,"PerfectOffice_MAIN"))&&a.content)i=Di.to_workbook(a.content,(t.type=o,t));else{if(!(a=D.find(e,"NativeContent_MAIN"))||!a.content)throw new Error("Cannot find Workbook stream");i=Di.to_workbook(a.content,(t.type=o,t))}t.bookVBA&&e.FullPaths&&D.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=function(e){var t=D.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,r){if("/"!==n.slice(-1)&&n.match(/_VBA_PROJECT_CUR/)){var i=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");D.utils.cfb_add(t,i,e.FileIndex[r].content)}}),D.write(t)}(e))}var c={};return e.FullPaths&&function(e,t,n){var r=D.find(e,"!DocumentSummaryInformation");if(r&&r.size>0)try{var i=Br(r,Bn,Hl.DSI);for(var a in i)t[a]=i[a]}catch(e){if(n.WTF)throw e}var s=D.find(e,"!SummaryInformation");if(s&&s.size>0)try{var o=Br(s,Mn,Hl.SI);for(var l in o)null==t[l]&&(t[l]=o[l])}catch(e){if(n.WTF)throw e}t.HeadingPairs&&t.TitlesOfParts&&(or(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,c,t),i.Props=i.Custprops=c,t.bookFiles&&(i.cfb=e),i}function Gl(e,t){var n=t||{},r=D.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return D.utils.cfb_add(r,i,ac(e,n)),8==n.biff&&(e.Props||e.Custprops)&&function(e,t){var n,r=[],i=[],a=[],s=0;if(e.Props)for(n=O(e.Props),s=0;s<n.length;++s)(Dn.hasOwnProperty(n[s])?r:Ln.hasOwnProperty(n[s])?i:a).push([n[s],e.Props[n[s]]]);if(e.Custprops)for(n=O(e.Custprops),s=0;s<n.length;++s)(e.Props||{}).hasOwnProperty(n[s])||(Dn.hasOwnProperty(n[s])?r:Ln.hasOwnProperty(n[s])?i:a).push([n[s],e.Custprops[n[s]]]);var o=[];for(s=0;s<a.length;++s)Tr.indexOf(a[s][0])>-1||null!=a[s][1]&&o.push(a[s]);i.length&&D.utils.cfb_add(t,"/SummaryInformation",Mr(i,Hl.SI,Ln,Mn)),(r.length||o.length)&&D.utils.cfb_add(t,"/DocumentSummaryInformation",Mr(r,Hl.DSI,Dn,Bn,o.length?o:null,Hl.UDI))}(e,r),8==n.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(n,r){if(0!=r){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==i.slice(-1)&&D.utils.cfb_add(e,i,t.FileIndex[r].content)}})}(r,D.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var jl={0:{n:"BrtRowHdr",f:function(e,t){var n={},r=e.l+t;n.r=e._R(4),e.l+=4;var i=e._R(2);e.l+=1;var a=e._R(1);return e.l=r,7&a&&(n.level=7&a),16&a&&(n.hidden=!0),32&a&&(n.hpt=i/20),n}},1:{n:"BrtCellBlank",f:function(e){return[on(e)]}},2:{n:"BrtCellRk",f:function(e){return[on(e),vn(e),"n"]}},3:{n:"BrtCellError",f:function(e){return[on(e),e._R(1),"e"]}},4:{n:"BrtCellBool",f:function(e){return[on(e),e._R(1),"b"]}},5:{n:"BrtCellReal",f:function(e){return[on(e),yn(e),"n"]}},6:{n:"BrtCellSt",f:function(e){return[on(e),en(e),"str"]}},7:{n:"BrtCellIsst",f:function(e){return[on(e),e._R(4),"s"]}},8:{n:"BrtFmlaString",f:function(e,t,n){var r=e.l+t,i=on(e);i.r=n["!row"];var a=[i,en(e),"str"];if(n.cellFormula){e.l+=2;var s=Xs(e,r-e.l,n);a[3]=Ws(s,0,i,n.supbooks,n)}else e.l=r;return a}},9:{n:"BrtFmlaNum",f:function(e,t,n){var r=e.l+t,i=on(e);i.r=n["!row"];var a=[i,yn(e),"n"];if(n.cellFormula){e.l+=2;var s=Xs(e,r-e.l,n);a[3]=Ws(s,0,i,n.supbooks,n)}else e.l=r;return a}},10:{n:"BrtFmlaBool",f:function(e,t,n){var r=e.l+t,i=on(e);i.r=n["!row"];var a=[i,e._R(1),"b"];if(n.cellFormula){e.l+=2;var s=Xs(e,r-e.l,n);a[3]=Ws(s,0,i,n.supbooks,n)}else e.l=r;return a}},11:{n:"BrtFmlaError",f:function(e,t,n){var r=e.l+t,i=on(e);i.r=n["!row"];var a=[i,e._R(1),"e"];if(n.cellFormula){e.l+=2;var s=Xs(e,r-e.l,n);a[3]=Ws(s,0,i,n.supbooks,n)}else e.l=r;return a}},16:{n:"BrtFRTArchID$",f:function(e,t){var n={};return e._R(4),n.ArchID=e._R(4),e.l+=t-8,n}},19:{n:"BrtSSTItem",f:rn},20:{n:"BrtPCDIMissing"},21:{n:"BrtPCDINumber"},22:{n:"BrtPCDIBoolean"},23:{n:"BrtPCDIError"},24:{n:"BrtPCDIString"},25:{n:"BrtPCDIDatetime"},26:{n:"BrtPCDIIndex"},27:{n:"BrtPCDIAMissing"},28:{n:"BrtPCDIANumber"},29:{n:"BrtPCDIABoolean"},30:{n:"BrtPCDIAError"},31:{n:"BrtPCDIAString"},32:{n:"BrtPCDIADatetime"},33:{n:"BrtPCRRecord"},34:{n:"BrtPCRRecordDt"},35:{n:"BrtFRTBegin"},36:{n:"BrtFRTEnd"},37:{n:"BrtACBegin"},38:{n:"BrtACEnd"},39:{n:"BrtName",f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e._R(4),a=fn(e),s=Gs(e,0,n),o=hn(e);e.l=r;var l={Name:a,Ptg:s};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}},40:{n:"BrtIndexRowBlock"},42:{n:"BrtIndexBlock"},43:{n:"BrtFont",f:function(e,t,n){var r={};r.sz=e._R(2)/20;var i=function(e){var t=e._R(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1),700===e._R(2)&&(r.bold=1),e._R(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var a=e._R(1);0!=a&&(r.underline=a);var s=e._R(1);s>0&&(r.family=s);var o=e._R(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},n=e._R(1)>>>1,r=e._R(1),i=e._R(2,"i"),a=e._R(1),s=e._R(1),o=e._R(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=Nn[r];l&&(t.rgb=sa(l));break;case 2:t.rgb=sa([a,s,o]);break;case 3:t.theme=r}return 0!=i&&(t.tint=i>0?i/32767:i/32768),t}(e),e._R(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=en(e),r}},44:{n:"BrtFmt",f:function(e,t){return[e._R(2),en(e)]}},45:{n:"BrtFill",f:Ba},46:{n:"BrtBorder",f:La},47:{n:"BrtXF",f:function(e,t){var n=e.l+t,r=e._R(2),i=e._R(2);return e.l=n,{ixfe:r,numFmtId:i}}},48:{n:"BrtStyle"},49:{n:"BrtCellMeta"},50:{n:"BrtValueMeta"},51:{n:"BrtMdb"},52:{n:"BrtBeginFmd"},53:{n:"BrtEndFmd"},54:{n:"BrtBeginMdx"},55:{n:"BrtEndMdx"},56:{n:"BrtBeginMdxTuple"},57:{n:"BrtEndMdxTuple"},58:{n:"BrtMdxMbrIstr"},59:{n:"BrtStr"},60:{n:"BrtColInfo",f:Ei},62:{n:"BrtCellRString"},63:{n:"BrtCalcChainItem$",f:function(e){var t={};t.i=e._R(4);var n={};n.r=e._R(4),n.c=e._R(4),t.r=Ht(n);var r=e._R(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{n:"BrtDVal",f:function(){}},65:{n:"BrtSxvcellNum"},66:{n:"BrtSxvcellStr"},67:{n:"BrtSxvcellBool"},68:{n:"BrtSxvcellErr"},69:{n:"BrtSxvcellDate"},70:{n:"BrtSxvcellNil"},128:{n:"BrtFileVersion"},129:{n:"BrtBeginSheet"},130:{n:"BrtEndSheet"},131:{n:"BrtBeginBook",f:At,p:0},132:{n:"BrtEndBook"},133:{n:"BrtBeginWsViews"},134:{n:"BrtEndWsViews"},135:{n:"BrtBeginBookViews"},136:{n:"BrtEndBookViews"},137:{n:"BrtBeginWsView",f:function(e){var t=e._R(2);return e.l+=28,{RTL:32&t}}},138:{n:"BrtEndWsView"},139:{n:"BrtBeginCsViews"},140:{n:"BrtEndCsViews"},141:{n:"BrtBeginCsView"},142:{n:"BrtEndCsView"},143:{n:"BrtBeginBundleShs"},144:{n:"BrtEndBundleShs"},145:{n:"BrtBeginSheetData"},146:{n:"BrtEndSheetData"},147:{n:"BrtWsProp",f:function(e,t){var n={};return e.l+=19,n.name=cn(e,t-19),n}},148:{n:"BrtWsDim",f:Bo,p:16},151:{n:"BrtPane",f:function(){}},152:{n:"BrtSel"},153:{n:"BrtWbProp",f:function(e,t){var n={},r=e._R(4);n.defaultThemeVersion=e._R(4);var i=t>8?en(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{n:"BrtWbFactoid"},155:{n:"BrtFileRecover"},156:{n:"BrtBundleSh",f:function(e,t){var n={};return n.Hidden=e._R(4),n.iTabID=e._R(4),n.strRelID=pn(e,t-8),n.name=en(e),n}},157:{n:"BrtCalcProp"},158:{n:"BrtBookView"},159:{n:"BrtBeginSst",f:function(e){return[e._R(4),e._R(4)]}},160:{n:"BrtEndSst"},161:{n:"BrtBeginAFilter",f:bn},162:{n:"BrtEndAFilter"},163:{n:"BrtBeginFilterColumn"},164:{n:"BrtEndFilterColumn"},165:{n:"BrtBeginFilters"},166:{n:"BrtEndFilters"},167:{n:"BrtFilter"},168:{n:"BrtColorFilter"},169:{n:"BrtIconFilter"},170:{n:"BrtTop10Filter"},171:{n:"BrtDynamicFilter"},172:{n:"BrtBeginCustomFilters"},173:{n:"BrtEndCustomFilters"},174:{n:"BrtCustomFilter"},175:{n:"BrtAFilterDateGroupItem"},176:{n:"BrtMergeCell",f:Do},177:{n:"BrtBeginMergeCells"},178:{n:"BrtEndMergeCells"},179:{n:"BrtBeginPivotCacheDef"},180:{n:"BrtEndPivotCacheDef"},181:{n:"BrtBeginPCDFields"},182:{n:"BrtEndPCDFields"},183:{n:"BrtBeginPCDField"},184:{n:"BrtEndPCDField"},185:{n:"BrtBeginPCDSource"},186:{n:"BrtEndPCDSource"},187:{n:"BrtBeginPCDSRange"},188:{n:"BrtEndPCDSRange"},189:{n:"BrtBeginPCDFAtbl"},190:{n:"BrtEndPCDFAtbl"},191:{n:"BrtBeginPCDIRun"},192:{n:"BrtEndPCDIRun"},193:{n:"BrtBeginPivotCacheRecords"},194:{n:"BrtEndPivotCacheRecords"},195:{n:"BrtBeginPCDHierarchies"},196:{n:"BrtEndPCDHierarchies"},197:{n:"BrtBeginPCDHierarchy"},198:{n:"BrtEndPCDHierarchy"},199:{n:"BrtBeginPCDHFieldsUsage"},200:{n:"BrtEndPCDHFieldsUsage"},201:{n:"BrtBeginExtConnection"},202:{n:"BrtEndExtConnection"},203:{n:"BrtBeginECDbProps"},204:{n:"BrtEndECDbProps"},205:{n:"BrtBeginECOlapProps"},206:{n:"BrtEndECOlapProps"},207:{n:"BrtBeginPCDSConsol"},208:{n:"BrtEndPCDSConsol"},209:{n:"BrtBeginPCDSCPages"},210:{n:"BrtEndPCDSCPages"},211:{n:"BrtBeginPCDSCPage"},212:{n:"BrtEndPCDSCPage"},213:{n:"BrtBeginPCDSCPItem"},214:{n:"BrtEndPCDSCPItem"},215:{n:"BrtBeginPCDSCSets"},216:{n:"BrtEndPCDSCSets"},217:{n:"BrtBeginPCDSCSet"},218:{n:"BrtEndPCDSCSet"},219:{n:"BrtBeginPCDFGroup"},220:{n:"BrtEndPCDFGroup"},221:{n:"BrtBeginPCDFGItems"},222:{n:"BrtEndPCDFGItems"},223:{n:"BrtBeginPCDFGRange"},224:{n:"BrtEndPCDFGRange"},225:{n:"BrtBeginPCDFGDiscrete"},226:{n:"BrtEndPCDFGDiscrete"},227:{n:"BrtBeginPCDSDTupleCache"},228:{n:"BrtEndPCDSDTupleCache"},229:{n:"BrtBeginPCDSDTCEntries"},230:{n:"BrtEndPCDSDTCEntries"},231:{n:"BrtBeginPCDSDTCEMembers"},232:{n:"BrtEndPCDSDTCEMembers"},233:{n:"BrtBeginPCDSDTCEMember"},234:{n:"BrtEndPCDSDTCEMember"},235:{n:"BrtBeginPCDSDTCQueries"},236:{n:"BrtEndPCDSDTCQueries"},237:{n:"BrtBeginPCDSDTCQuery"},238:{n:"BrtEndPCDSDTCQuery"},239:{n:"BrtBeginPCDSDTCSets"},240:{n:"BrtEndPCDSDTCSets"},241:{n:"BrtBeginPCDSDTCSet"},242:{n:"BrtEndPCDSDTCSet"},243:{n:"BrtBeginPCDCalcItems"},244:{n:"BrtEndPCDCalcItems"},245:{n:"BrtBeginPCDCalcItem"},246:{n:"BrtEndPCDCalcItem"},247:{n:"BrtBeginPRule"},248:{n:"BrtEndPRule"},249:{n:"BrtBeginPRFilters"},250:{n:"BrtEndPRFilters"},251:{n:"BrtBeginPRFilter"},252:{n:"BrtEndPRFilter"},253:{n:"BrtBeginPNames"},254:{n:"BrtEndPNames"},255:{n:"BrtBeginPName"},256:{n:"BrtEndPName"},257:{n:"BrtBeginPNPairs"},258:{n:"BrtEndPNPairs"},259:{n:"BrtBeginPNPair"},260:{n:"BrtEndPNPair"},261:{n:"BrtBeginECWebProps"},262:{n:"BrtEndECWebProps"},263:{n:"BrtBeginEcWpTables"},264:{n:"BrtEndECWPTables"},265:{n:"BrtBeginECParams"},266:{n:"BrtEndECParams"},267:{n:"BrtBeginECParam"},268:{n:"BrtEndECParam"},269:{n:"BrtBeginPCDKPIs"},270:{n:"BrtEndPCDKPIs"},271:{n:"BrtBeginPCDKPI"},272:{n:"BrtEndPCDKPI"},273:{n:"BrtBeginDims"},274:{n:"BrtEndDims"},275:{n:"BrtBeginDim"},276:{n:"BrtEndDim"},277:{n:"BrtIndexPartEnd"},278:{n:"BrtBeginStyleSheet"},279:{n:"BrtEndStyleSheet"},280:{n:"BrtBeginSXView"},281:{n:"BrtEndSXVI"},282:{n:"BrtBeginSXVI"},283:{n:"BrtBeginSXVIs"},284:{n:"BrtEndSXVIs"},285:{n:"BrtBeginSXVD"},286:{n:"BrtEndSXVD"},287:{n:"BrtBeginSXVDs"},288:{n:"BrtEndSXVDs"},289:{n:"BrtBeginSXPI"},290:{n:"BrtEndSXPI"},291:{n:"BrtBeginSXPIs"},292:{n:"BrtEndSXPIs"},293:{n:"BrtBeginSXDI"},294:{n:"BrtEndSXDI"},295:{n:"BrtBeginSXDIs"},296:{n:"BrtEndSXDIs"},297:{n:"BrtBeginSXLI"},298:{n:"BrtEndSXLI"},299:{n:"BrtBeginSXLIRws"},300:{n:"BrtEndSXLIRws"},301:{n:"BrtBeginSXLICols"},302:{n:"BrtEndSXLICols"},303:{n:"BrtBeginSXFormat"},304:{n:"BrtEndSXFormat"},305:{n:"BrtBeginSXFormats"},306:{n:"BrtEndSxFormats"},307:{n:"BrtBeginSxSelect"},308:{n:"BrtEndSxSelect"},309:{n:"BrtBeginISXVDRws"},310:{n:"BrtEndISXVDRws"},311:{n:"BrtBeginISXVDCols"},312:{n:"BrtEndISXVDCols"},313:{n:"BrtEndSXLocation"},314:{n:"BrtBeginSXLocation"},315:{n:"BrtEndSXView"},316:{n:"BrtBeginSXTHs"},317:{n:"BrtEndSXTHs"},318:{n:"BrtBeginSXTH"},319:{n:"BrtEndSXTH"},320:{n:"BrtBeginISXTHRws"},321:{n:"BrtEndISXTHRws"},322:{n:"BrtBeginISXTHCols"},323:{n:"BrtEndISXTHCols"},324:{n:"BrtBeginSXTDMPS"},325:{n:"BrtEndSXTDMPs"},326:{n:"BrtBeginSXTDMP"},327:{n:"BrtEndSXTDMP"},328:{n:"BrtBeginSXTHItems"},329:{n:"BrtEndSXTHItems"},330:{n:"BrtBeginSXTHItem"},331:{n:"BrtEndSXTHItem"},332:{n:"BrtBeginMetadata"},333:{n:"BrtEndMetadata"},334:{n:"BrtBeginEsmdtinfo"},335:{n:"BrtMdtinfo"},336:{n:"BrtEndEsmdtinfo"},337:{n:"BrtBeginEsmdb"},338:{n:"BrtEndEsmdb"},339:{n:"BrtBeginEsfmd"},340:{n:"BrtEndEsfmd"},341:{n:"BrtBeginSingleCells"},342:{n:"BrtEndSingleCells"},343:{n:"BrtBeginList"},344:{n:"BrtEndList"},345:{n:"BrtBeginListCols"},346:{n:"BrtEndListCols"},347:{n:"BrtBeginListCol"},348:{n:"BrtEndListCol"},349:{n:"BrtBeginListXmlCPr"},350:{n:"BrtEndListXmlCPr"},351:{n:"BrtListCCFmla"},352:{n:"BrtListTrFmla"},353:{n:"BrtBeginExternals"},354:{n:"BrtEndExternals"},355:{n:"BrtSupBookSrc",f:pn},357:{n:"BrtSupSelf"},358:{n:"BrtSupSame"},359:{n:"BrtSupTabs"},360:{n:"BrtBeginSupBook"},361:{n:"BrtPlaceholderName"},362:{n:"BrtExternSheet",f:yi},363:{n:"BrtExternTableStart"},364:{n:"BrtExternTableEnd"},366:{n:"BrtExternRowHdr"},367:{n:"BrtExternCellBlank"},368:{n:"BrtExternCellReal"},369:{n:"BrtExternCellBool"},370:{n:"BrtExternCellError"},371:{n:"BrtExternCellString"},372:{n:"BrtBeginEsmdx"},373:{n:"BrtEndEsmdx"},374:{n:"BrtBeginMdxSet"},375:{n:"BrtEndMdxSet"},376:{n:"BrtBeginMdxMbrProp"},377:{n:"BrtEndMdxMbrProp"},378:{n:"BrtBeginMdxKPI"},379:{n:"BrtEndMdxKPI"},380:{n:"BrtBeginEsstr"},381:{n:"BrtEndEsstr"},382:{n:"BrtBeginPRFItem"},383:{n:"BrtEndPRFItem"},384:{n:"BrtBeginPivotCacheIDs"},385:{n:"BrtEndPivotCacheIDs"},386:{n:"BrtBeginPivotCacheID"},387:{n:"BrtEndPivotCacheID"},388:{n:"BrtBeginISXVIs"},389:{n:"BrtEndISXVIs"},390:{n:"BrtBeginColInfos"},391:{n:"BrtEndColInfos"},392:{n:"BrtBeginRwBrk"},393:{n:"BrtEndRwBrk"},394:{n:"BrtBeginColBrk"},395:{n:"BrtEndColBrk"},396:{n:"BrtBrk"},397:{n:"BrtUserBookView"},398:{n:"BrtInfo"},399:{n:"BrtCUsr"},400:{n:"BrtUsr"},401:{n:"BrtBeginUsers"},403:{n:"BrtEOF"},404:{n:"BrtUCR"},405:{n:"BrtRRInsDel"},406:{n:"BrtRREndInsDel"},407:{n:"BrtRRMove"},408:{n:"BrtRREndMove"},409:{n:"BrtRRChgCell"},410:{n:"BrtRREndChgCell"},411:{n:"BrtRRHeader"},412:{n:"BrtRRUserView"},413:{n:"BrtRRRenSheet"},414:{n:"BrtRRInsertSh"},415:{n:"BrtRRDefName"},416:{n:"BrtRRNote"},417:{n:"BrtRRConflict"},418:{n:"BrtRRTQSIF"},419:{n:"BrtRRFormat"},420:{n:"BrtRREndFormat"},421:{n:"BrtRRAutoFmt"},422:{n:"BrtBeginUserShViews"},423:{n:"BrtBeginUserShView"},424:{n:"BrtEndUserShView"},425:{n:"BrtEndUserShViews"},426:{n:"BrtArrFmla",f:function(e,t,n){var r=e.l+t,i=gn(e),a=e._R(1),s=[i];if(s[2]=a,n.cellFormula){var o=Hs(e,r-e.l,n);s[1]=o}else e.l=r;return s}},427:{n:"BrtShrFmla",f:function(e,t,n){var r=e.l+t,i=[bn(e,16)];if(n.cellFormula){var a=js(e,r-e.l,n);i[1]=a,e.l=r}else e.l=r;return i}},428:{n:"BrtTable"},429:{n:"BrtBeginExtConnections"},430:{n:"BrtEndExtConnections"},431:{n:"BrtBeginPCDCalcMems"},432:{n:"BrtEndPCDCalcMems"},433:{n:"BrtBeginPCDCalcMem"},434:{n:"BrtEndPCDCalcMem"},435:{n:"BrtBeginPCDHGLevels"},436:{n:"BrtEndPCDHGLevels"},437:{n:"BrtBeginPCDHGLevel"},438:{n:"BrtEndPCDHGLevel"},439:{n:"BrtBeginPCDHGLGroups"},440:{n:"BrtEndPCDHGLGroups"},441:{n:"BrtBeginPCDHGLGroup"},442:{n:"BrtEndPCDHGLGroup"},443:{n:"BrtBeginPCDHGLGMembers"},444:{n:"BrtEndPCDHGLGMembers"},445:{n:"BrtBeginPCDHGLGMember"},446:{n:"BrtEndPCDHGLGMember"},447:{n:"BrtBeginQSI"},448:{n:"BrtEndQSI"},449:{n:"BrtBeginQSIR"},450:{n:"BrtEndQSIR"},451:{n:"BrtBeginDeletedNames"},452:{n:"BrtEndDeletedNames"},453:{n:"BrtBeginDeletedName"},454:{n:"BrtEndDeletedName"},455:{n:"BrtBeginQSIFs"},456:{n:"BrtEndQSIFs"},457:{n:"BrtBeginQSIF"},458:{n:"BrtEndQSIF"},459:{n:"BrtBeginAutoSortScope"},460:{n:"BrtEndAutoSortScope"},461:{n:"BrtBeginConditionalFormatting"},462:{n:"BrtEndConditionalFormatting"},463:{n:"BrtBeginCFRule"},464:{n:"BrtEndCFRule"},465:{n:"BrtBeginIconSet"},466:{n:"BrtEndIconSet"},467:{n:"BrtBeginDatabar"},468:{n:"BrtEndDatabar"},469:{n:"BrtBeginColorScale"},470:{n:"BrtEndColorScale"},471:{n:"BrtCFVO"},472:{n:"BrtExternValueMeta"},473:{n:"BrtBeginColorPalette"},474:{n:"BrtEndColorPalette"},475:{n:"BrtIndexedColor"},476:{n:"BrtMargins",f:function(e){var t={};return Fo.forEach(function(n){t[n]=yn(e)}),t}},477:{n:"BrtPrintOptions"},478:{n:"BrtPageSetup"},479:{n:"BrtBeginHeaderFooter"},480:{n:"BrtEndHeaderFooter"},481:{n:"BrtBeginSXCrtFormat"},482:{n:"BrtEndSXCrtFormat"},483:{n:"BrtBeginSXCrtFormats"},484:{n:"BrtEndSXCrtFormats"},485:{n:"BrtWsFmtInfo",f:function(){}},486:{n:"BrtBeginMgs"},487:{n:"BrtEndMGs"},488:{n:"BrtBeginMGMaps"},489:{n:"BrtEndMGMaps"},490:{n:"BrtBeginMG"},491:{n:"BrtEndMG"},492:{n:"BrtBeginMap"},493:{n:"BrtEndMap"},494:{n:"BrtHLink",f:function(e,t){var n=e.l+t,r=bn(e,16),i=hn(e),a=en(e),s=en(e),o=en(e);e.l=n;var l={rfx:r,relId:i,loc:a,display:o};return s&&(l.Tooltip=s),l}},495:{n:"BrtBeginDCon"},496:{n:"BrtEndDCon"},497:{n:"BrtBeginDRefs"},498:{n:"BrtEndDRefs"},499:{n:"BrtDRef"},500:{n:"BrtBeginScenMan"},501:{n:"BrtEndScenMan"},502:{n:"BrtBeginSct"},503:{n:"BrtEndSct"},504:{n:"BrtSlc"},505:{n:"BrtBeginDXFs"},506:{n:"BrtEndDXFs"},507:{n:"BrtDXF"},508:{n:"BrtBeginTableStyles"},509:{n:"BrtEndTableStyles"},510:{n:"BrtBeginTableStyle"},511:{n:"BrtEndTableStyle"},512:{n:"BrtTableStyleElement"},513:{n:"BrtTableStyleClient"},514:{n:"BrtBeginVolDeps"},515:{n:"BrtEndVolDeps"},516:{n:"BrtBeginVolType"},517:{n:"BrtEndVolType"},518:{n:"BrtBeginVolMain"},519:{n:"BrtEndVolMain"},520:{n:"BrtBeginVolTopic"},521:{n:"BrtEndVolTopic"},522:{n:"BrtVolSubtopic"},523:{n:"BrtVolRef"},524:{n:"BrtVolNum"},525:{n:"BrtVolErr"},526:{n:"BrtVolStr"},527:{n:"BrtVolBool"},528:{n:"BrtBeginCalcChain$"},529:{n:"BrtEndCalcChain$"},530:{n:"BrtBeginSortState"},531:{n:"BrtEndSortState"},532:{n:"BrtBeginSortCond"},533:{n:"BrtEndSortCond"},534:{n:"BrtBookProtection"},535:{n:"BrtSheetProtection"},536:{n:"BrtRangeProtection"},537:{n:"BrtPhoneticInfo"},538:{n:"BrtBeginECTxtWiz"},539:{n:"BrtEndECTxtWiz"},540:{n:"BrtBeginECTWFldInfoLst"},541:{n:"BrtEndECTWFldInfoLst"},542:{n:"BrtBeginECTwFldInfo"},548:{n:"BrtFileSharing"},549:{n:"BrtOleSize"},550:{n:"BrtDrawing",f:pn},551:{n:"BrtLegacyDrawing"},552:{n:"BrtLegacyDrawingHF"},553:{n:"BrtWebOpt"},554:{n:"BrtBeginWebPubItems"},555:{n:"BrtEndWebPubItems"},556:{n:"BrtBeginWebPubItem"},557:{n:"BrtEndWebPubItem"},558:{n:"BrtBeginSXCondFmt"},559:{n:"BrtEndSXCondFmt"},560:{n:"BrtBeginSXCondFmts"},561:{n:"BrtEndSXCondFmts"},562:{n:"BrtBkHim"},564:{n:"BrtColor"},565:{n:"BrtBeginIndexedColors"},566:{n:"BrtEndIndexedColors"},569:{n:"BrtBeginMRUColors"},570:{n:"BrtEndMRUColors"},572:{n:"BrtMRUColor"},573:{n:"BrtBeginDVals"},574:{n:"BrtEndDVals"},577:{n:"BrtSupNameStart"},578:{n:"BrtSupNameValueStart"},579:{n:"BrtSupNameValueEnd"},580:{n:"BrtSupNameNum"},581:{n:"BrtSupNameErr"},582:{n:"BrtSupNameSt"},583:{n:"BrtSupNameNil"},584:{n:"BrtSupNameBool"},585:{n:"BrtSupNameFmla"},586:{n:"BrtSupNameBits"},587:{n:"BrtSupNameEnd"},588:{n:"BrtEndSupBook"},589:{n:"BrtCellSmartTagProperty"},590:{n:"BrtBeginCellSmartTag"},591:{n:"BrtEndCellSmartTag"},592:{n:"BrtBeginCellSmartTags"},593:{n:"BrtEndCellSmartTags"},594:{n:"BrtBeginSmartTags"},595:{n:"BrtEndSmartTags"},596:{n:"BrtSmartTagType"},597:{n:"BrtBeginSmartTagTypes"},598:{n:"BrtEndSmartTagTypes"},599:{n:"BrtBeginSXFilters"},600:{n:"BrtEndSXFilters"},601:{n:"BrtBeginSXFILTER"},602:{n:"BrtEndSXFilter"},603:{n:"BrtBeginFills"},604:{n:"BrtEndFills"},605:{n:"BrtBeginCellWatches"},606:{n:"BrtEndCellWatches"},607:{n:"BrtCellWatch"},608:{n:"BrtBeginCRErrs"},609:{n:"BrtEndCRErrs"},610:{n:"BrtCrashRecErr"},611:{n:"BrtBeginFonts"},612:{n:"BrtEndFonts"},613:{n:"BrtBeginBorders"},614:{n:"BrtEndBorders"},615:{n:"BrtBeginFmts"},616:{n:"BrtEndFmts"},617:{n:"BrtBeginCellXFs"},618:{n:"BrtEndCellXFs"},619:{n:"BrtBeginStyles"},620:{n:"BrtEndStyles"},625:{n:"BrtBigName"},626:{n:"BrtBeginCellStyleXFs"},627:{n:"BrtEndCellStyleXFs"},628:{n:"BrtBeginComments"},629:{n:"BrtEndComments"},630:{n:"BrtBeginCommentAuthors"},631:{n:"BrtEndCommentAuthors"},632:{n:"BrtCommentAuthor",f:Ja},633:{n:"BrtBeginCommentList"},634:{n:"BrtEndCommentList"},635:{n:"BrtBeginComment",f:function(e){var t={};t.iauthor=e._R(4);var n=bn(e,16);return t.rfx=n.s,t.ref=Ht(n.s),e.l+=16,t}},636:{n:"BrtEndComment"},637:{n:"BrtCommentText",f:an},638:{n:"BrtBeginOleObjects"},639:{n:"BrtOleObject"},640:{n:"BrtEndOleObjects"},641:{n:"BrtBeginSxrules"},642:{n:"BrtEndSxRules"},643:{n:"BrtBeginActiveXControls"},644:{n:"BrtActiveX"},645:{n:"BrtEndActiveXControls"},646:{n:"BrtBeginPCDSDTCEMembersSortBy"},648:{n:"BrtBeginCellIgnoreECs"},649:{n:"BrtCellIgnoreEC"},650:{n:"BrtEndCellIgnoreECs"},651:{n:"BrtCsProp",f:function(e,t){return e.l+=10,{name:en(e)}}},652:{n:"BrtCsPageSetup"},653:{n:"BrtBeginUserCsViews"},654:{n:"BrtEndUserCsViews"},655:{n:"BrtBeginUserCsView"},656:{n:"BrtEndUserCsView"},657:{n:"BrtBeginPcdSFCIEntries"},658:{n:"BrtEndPCDSFCIEntries"},659:{n:"BrtPCDSFCIEntry"},660:{n:"BrtBeginListParts"},661:{n:"BrtListPart"},662:{n:"BrtEndListParts"},663:{n:"BrtSheetCalcProp"},664:{n:"BrtBeginFnGroup"},665:{n:"BrtFnGroup"},666:{n:"BrtEndFnGroup"},667:{n:"BrtSupAddin"},668:{n:"BrtSXTDMPOrder"},669:{n:"BrtCsProtection"},671:{n:"BrtBeginWsSortMap"},672:{n:"BrtEndWsSortMap"},673:{n:"BrtBeginRRSort"},674:{n:"BrtEndRRSort"},675:{n:"BrtRRSortItem"},676:{n:"BrtFileSharingIso"},677:{n:"BrtBookProtectionIso"},678:{n:"BrtSheetProtectionIso"},679:{n:"BrtCsProtectionIso"},680:{n:"BrtRangeProtectionIso"},681:{n:"BrtDValList"},1024:{n:"BrtRwDescent"},1025:{n:"BrtKnownFonts"},1026:{n:"BrtBeginSXTupleSet"},1027:{n:"BrtEndSXTupleSet"},1028:{n:"BrtBeginSXTupleSetHeader"},1029:{n:"BrtEndSXTupleSetHeader"},1030:{n:"BrtSXTupleSetHeaderItem"},1031:{n:"BrtBeginSXTupleSetData"},1032:{n:"BrtEndSXTupleSetData"},1033:{n:"BrtBeginSXTupleSetRow"},1034:{n:"BrtEndSXTupleSetRow"},1035:{n:"BrtSXTupleSetRowItem"},1036:{n:"BrtNameExt"},1037:{n:"BrtPCDH14"},1038:{n:"BrtBeginPCDCalcMem14"},1039:{n:"BrtEndPCDCalcMem14"},1040:{n:"BrtSXTH14"},1041:{n:"BrtBeginSparklineGroup"},1042:{n:"BrtEndSparklineGroup"},1043:{n:"BrtSparkline"},1044:{n:"BrtSXDI14"},1045:{n:"BrtWsFmtInfoEx14"},1046:{n:"BrtBeginConditionalFormatting14"},1047:{n:"BrtEndConditionalFormatting14"},1048:{n:"BrtBeginCFRule14"},1049:{n:"BrtEndCFRule14"},1050:{n:"BrtCFVO14"},1051:{n:"BrtBeginDatabar14"},1052:{n:"BrtBeginIconSet14"},1053:{n:"BrtDVal14",f:function(){}},1054:{n:"BrtBeginDVals14"},1055:{n:"BrtColor14"},1056:{n:"BrtBeginSparklines"},1057:{n:"BrtEndSparklines"},1058:{n:"BrtBeginSparklineGroups"},1059:{n:"BrtEndSparklineGroups"},1061:{n:"BrtSXVD14"},1062:{n:"BrtBeginSXView14"},1063:{n:"BrtEndSXView14"},1064:{n:"BrtBeginSXView16"},1065:{n:"BrtEndSXView16"},1066:{n:"BrtBeginPCD14"},1067:{n:"BrtEndPCD14"},1068:{n:"BrtBeginExtConn14"},1069:{n:"BrtEndExtConn14"},1070:{n:"BrtBeginSlicerCacheIDs"},1071:{n:"BrtEndSlicerCacheIDs"},1072:{n:"BrtBeginSlicerCacheID"},1073:{n:"BrtEndSlicerCacheID"},1075:{n:"BrtBeginSlicerCache"},1076:{n:"BrtEndSlicerCache"},1077:{n:"BrtBeginSlicerCacheDef"},1078:{n:"BrtEndSlicerCacheDef"},1079:{n:"BrtBeginSlicersEx"},1080:{n:"BrtEndSlicersEx"},1081:{n:"BrtBeginSlicerEx"},1082:{n:"BrtEndSlicerEx"},1083:{n:"BrtBeginSlicer"},1084:{n:"BrtEndSlicer"},1085:{n:"BrtSlicerCachePivotTables"},1086:{n:"BrtBeginSlicerCacheOlapImpl"},1087:{n:"BrtEndSlicerCacheOlapImpl"},1088:{n:"BrtBeginSlicerCacheLevelsData"},1089:{n:"BrtEndSlicerCacheLevelsData"},1090:{n:"BrtBeginSlicerCacheLevelData"},1091:{n:"BrtEndSlicerCacheLevelData"},1092:{n:"BrtBeginSlicerCacheSiRanges"},1093:{n:"BrtEndSlicerCacheSiRanges"},1094:{n:"BrtBeginSlicerCacheSiRange"},1095:{n:"BrtEndSlicerCacheSiRange"},1096:{n:"BrtSlicerCacheOlapItem"},1097:{n:"BrtBeginSlicerCacheSelections"},1098:{n:"BrtSlicerCacheSelection"},1099:{n:"BrtEndSlicerCacheSelections"},1100:{n:"BrtBeginSlicerCacheNative"},1101:{n:"BrtEndSlicerCacheNative"},1102:{n:"BrtSlicerCacheNativeItem"},1103:{n:"BrtRangeProtection14"},1104:{n:"BrtRangeProtectionIso14"},1105:{n:"BrtCellIgnoreEC14"},1111:{n:"BrtList14"},1112:{n:"BrtCFIcon"},1113:{n:"BrtBeginSlicerCachesPivotCacheIDs"},1114:{n:"BrtEndSlicerCachesPivotCacheIDs"},1115:{n:"BrtBeginSlicers"},1116:{n:"BrtEndSlicers"},1117:{n:"BrtWbProp14"},1118:{n:"BrtBeginSXEdit"},1119:{n:"BrtEndSXEdit"},1120:{n:"BrtBeginSXEdits"},1121:{n:"BrtEndSXEdits"},1122:{n:"BrtBeginSXChange"},1123:{n:"BrtEndSXChange"},1124:{n:"BrtBeginSXChanges"},1125:{n:"BrtEndSXChanges"},1126:{n:"BrtSXTupleItems"},1128:{n:"BrtBeginSlicerStyle"},1129:{n:"BrtEndSlicerStyle"},1130:{n:"BrtSlicerStyleElement"},1131:{n:"BrtBeginStyleSheetExt14"},1132:{n:"BrtEndStyleSheetExt14"},1133:{n:"BrtBeginSlicerCachesPivotCacheID"},1134:{n:"BrtEndSlicerCachesPivotCacheID"},1135:{n:"BrtBeginConditionalFormattings"},1136:{n:"BrtEndConditionalFormattings"},1137:{n:"BrtBeginPCDCalcMemExt"},1138:{n:"BrtEndPCDCalcMemExt"},1139:{n:"BrtBeginPCDCalcMemsExt"},1140:{n:"BrtEndPCDCalcMemsExt"},1141:{n:"BrtPCDField14"},1142:{n:"BrtBeginSlicerStyles"},1143:{n:"BrtEndSlicerStyles"},1144:{n:"BrtBeginSlicerStyleElements"},1145:{n:"BrtEndSlicerStyleElements"},1146:{n:"BrtCFRuleExt"},1147:{n:"BrtBeginSXCondFmt14"},1148:{n:"BrtEndSXCondFmt14"},1149:{n:"BrtBeginSXCondFmts14"},1150:{n:"BrtEndSXCondFmts14"},1152:{n:"BrtBeginSortCond14"},1153:{n:"BrtEndSortCond14"},1154:{n:"BrtEndDVals14"},1155:{n:"BrtEndIconSet14"},1156:{n:"BrtEndDatabar14"},1157:{n:"BrtBeginColorScale14"},1158:{n:"BrtEndColorScale14"},1159:{n:"BrtBeginSxrules14"},1160:{n:"BrtEndSxrules14"},1161:{n:"BrtBeginPRule14"},1162:{n:"BrtEndPRule14"},1163:{n:"BrtBeginPRFilters14"},1164:{n:"BrtEndPRFilters14"},1165:{n:"BrtBeginPRFilter14"},1166:{n:"BrtEndPRFilter14"},1167:{n:"BrtBeginPRFItem14"},1168:{n:"BrtEndPRFItem14"},1169:{n:"BrtBeginCellIgnoreECs14"},1170:{n:"BrtEndCellIgnoreECs14"},1171:{n:"BrtDxf14"},1172:{n:"BrtBeginDxF14s"},1173:{n:"BrtEndDxf14s"},1177:{n:"BrtFilter14"},1178:{n:"BrtBeginCustomFilters14"},1180:{n:"BrtCustomFilter14"},1181:{n:"BrtIconFilter14"},1182:{n:"BrtPivotCacheConnectionName"},2048:{n:"BrtBeginDecoupledPivotCacheIDs"},2049:{n:"BrtEndDecoupledPivotCacheIDs"},2050:{n:"BrtDecoupledPivotCacheID"},2051:{n:"BrtBeginPivotTableRefs"},2052:{n:"BrtEndPivotTableRefs"},2053:{n:"BrtPivotTableRef"},2054:{n:"BrtSlicerCacheBookPivotTables"},2055:{n:"BrtBeginSxvcells"},2056:{n:"BrtEndSxvcells"},2057:{n:"BrtBeginSxRow"},2058:{n:"BrtEndSxRow"},2060:{n:"BrtPcdCalcMem15"},2067:{n:"BrtQsi15"},2068:{n:"BrtBeginWebExtensions"},2069:{n:"BrtEndWebExtensions"},2070:{n:"BrtWebExtension"},2071:{n:"BrtAbsPath15"},2072:{n:"BrtBeginPivotTableUISettings"},2073:{n:"BrtEndPivotTableUISettings"},2075:{n:"BrtTableSlicerCacheIDs"},2076:{n:"BrtTableSlicerCacheID"},2077:{n:"BrtBeginTableSlicerCache"},2078:{n:"BrtEndTableSlicerCache"},2079:{n:"BrtSxFilter15"},2080:{n:"BrtBeginTimelineCachePivotCacheIDs"},2081:{n:"BrtEndTimelineCachePivotCacheIDs"},2082:{n:"BrtTimelineCachePivotCacheID"},2083:{n:"BrtBeginTimelineCacheIDs"},2084:{n:"BrtEndTimelineCacheIDs"},2085:{n:"BrtBeginTimelineCacheID"},2086:{n:"BrtEndTimelineCacheID"},2087:{n:"BrtBeginTimelinesEx"},2088:{n:"BrtEndTimelinesEx"},2089:{n:"BrtBeginTimelineEx"},2090:{n:"BrtEndTimelineEx"},2091:{n:"BrtWorkBookPr15"},2092:{n:"BrtPCDH15"},2093:{n:"BrtBeginTimelineStyle"},2094:{n:"BrtEndTimelineStyle"},2095:{n:"BrtTimelineStyleElement"},2096:{n:"BrtBeginTimelineStylesheetExt15"},2097:{n:"BrtEndTimelineStylesheetExt15"},2098:{n:"BrtBeginTimelineStyles"},2099:{n:"BrtEndTimelineStyles"},2100:{n:"BrtBeginTimelineStyleElements"},2101:{n:"BrtEndTimelineStyleElements"},2102:{n:"BrtDxf15"},2103:{n:"BrtBeginDxfs15"},2104:{n:"brtEndDxfs15"},2105:{n:"BrtSlicerCacheHideItemsWithNoData"},2106:{n:"BrtBeginItemUniqueNames"},2107:{n:"BrtEndItemUniqueNames"},2108:{n:"BrtItemUniqueName"},2109:{n:"BrtBeginExtConn15"},2110:{n:"BrtEndExtConn15"},2111:{n:"BrtBeginOledbPr15"},2112:{n:"BrtEndOledbPr15"},2113:{n:"BrtBeginDataFeedPr15"},2114:{n:"BrtEndDataFeedPr15"},2115:{n:"BrtTextPr15"},2116:{n:"BrtRangePr15"},2117:{n:"BrtDbCommand15"},2118:{n:"BrtBeginDbTables15"},2119:{n:"BrtEndDbTables15"},2120:{n:"BrtDbTable15"},2121:{n:"BrtBeginDataModel"},2122:{n:"BrtEndDataModel"},2123:{n:"BrtBeginModelTables"},2124:{n:"BrtEndModelTables"},2125:{n:"BrtModelTable"},2126:{n:"BrtBeginModelRelationships"},2127:{n:"BrtEndModelRelationships"},2128:{n:"BrtModelRelationship"},2129:{n:"BrtBeginECTxtWiz15"},2130:{n:"BrtEndECTxtWiz15"},2131:{n:"BrtBeginECTWFldInfoLst15"},2132:{n:"BrtEndECTWFldInfoLst15"},2133:{n:"BrtBeginECTWFldInfo15"},2134:{n:"BrtFieldListActiveItem"},2135:{n:"BrtPivotCacheIdVersion"},2136:{n:"BrtSXDI15"},2137:{n:"BrtBeginModelTimeGroupings"},2138:{n:"BrtEndModelTimeGroupings"},2139:{n:"BrtBeginModelTimeGrouping"},2140:{n:"BrtEndModelTimeGrouping"},2141:{n:"BrtModelTimeGroupingCalcCol"},3072:{n:"BrtUid"},3073:{n:"BrtRevisionPtr"},5095:{n:"BrtBeginCalcFeatures"},5096:{n:"BrtEndCalcFeatures"},5097:{n:"BrtCalcFeature"},65535:{n:""}},Yl=N(jl,"n"),Kl={3:{n:"BIFF2NUM",f:function(e){var t=Kr(e);++e.l;var n=yn(e);return t.t="n",t.val=n,t}},4:{n:"BIFF2STR",f:function(e,t,n){var r=Kr(e);++e.l;var i=Ur(e,0,n);return r.t="str",r.val=i,r}},6:{n:"Formula",f:Vs},9:{n:"BOF",f:si},10:{n:"EOF",f:Ir},12:{n:"CalcCount",f:Fr},13:{n:"CalcMode",f:Fr},14:{n:"CalcPrecision",f:Dr},15:{n:"CalcRefMode",f:Dr},16:{n:"CalcDelta",f:yn},17:{n:"CalcIter",f:Dr},18:{n:"Protect",f:Dr},19:{n:"Password",f:Fr},20:{n:"Header",f:vi},21:{n:"Footer",f:vi},23:{n:"ExternSheet",f:yi},24:{n:"Lbl",f:Si},25:{n:"WinProtect",f:Dr},26:{n:"VerticalPageBreaks"},27:{n:"HorizontalPageBreaks"},28:{n:"Note",f:function(e,t,n){return function(e,t,n){if(!(n.biff<8)){var r=e._R(2),i=e._R(2),a=e._R(2),s=e._R(2),o=Ur(e,0,n);return n.biff<8&&e._R(1),[{r:r,c:i},o,s,a]}}(e,0,n)}},29:{n:"Selection"},34:{n:"Date1904",f:Dr},35:{n:"ExternName",f:gi},36:{n:"COLWIDTH"},38:{n:"LeftMargin",f:yn},39:{n:"RightMargin",f:yn},40:{n:"TopMargin",f:yn},41:{n:"BottomMargin",f:yn},42:{n:"PrintRowCol",f:Dr},43:{n:"PrintGrid",f:Dr},47:{n:"FilePass",f:function(e,t,n){var r={Type:n.biff>=8?e._R(2):0};return r.Type?ia(e,t-2,r):function(e,t,n,r){var i={key:Fr(e),verificationBytes:Fr(e)};n.password&&(i.verifier=ta(n.password)),r.valid=i.verificationBytes===i.verifier,r.valid&&(r.insitu=ra(n.password))}(e,n.biff,n,r),r}},49:{n:"Font",f:function(e,t,n){var r={dyHeight:e._R(2),fl:e._R(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return r.name=zr(e,0,n),r}},51:{n:"PrintSize",f:Fr},60:{n:"Continue"},61:{n:"Window1",f:function(e){return{Pos:[e._R(2),e._R(2)],Dim:[e._R(2),e._R(2)],Flags:e._R(2),CurTab:e._R(2),FirstTab:e._R(2),Selected:e._R(2),TabRatio:e._R(2)}}},64:{n:"Backup",f:Dr},65:{n:"Pane",f:function(){}},66:{n:"CodePage",f:Fr},77:{n:"Pls"},80:{n:"DCon"},81:{n:"DConRef"},82:{n:"DConName"},85:{n:"DefColWidth",f:Fr},89:{n:"XCT"},90:{n:"CRN"},91:{n:"FileSharing"},92:{n:"WriteAccess",f:function(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,i=Ur(e,0,n);return e._R(t+r-e.l),i}},93:{n:"Obj",f:function(e,t,n){if(n&&n.biff<8)return function(e,t,n){e.l+=4;var r=e._R(2),i=e._R(2),a=e._R(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((wi[r]||At)(e,t,n)),{cmo:[i,r,a],ft:s}}(e,t,n);var r=ri(e);return{cmo:r,ft:function(e,t){for(var n=e.l+t,r=[];e.l<n;){var i=e._R(2);e.l-=2;try{r.push(ai[i](e,n-e.l))}catch(t){return e.l=n,r}}return e.l!=n&&(e.l=n),r}(e,t-22,r[1])}}},94:{n:"Uncalced"},95:{n:"CalcSaveRecalc",f:Dr},96:{n:"Template"},97:{n:"Intl"},99:{n:"ObjProtect",f:Dr},125:{n:"ColInfo",f:Ei},128:{n:"Guts",f:function(e){e.l+=4;var t=[e._R(2),e._R(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{n:"WsBool",f:function(e,t,n){return{fDialog:16&(n&&8==n.biff||2==t?e._R(2):(e.l+=t,0))}}},130:{n:"GridSet",f:Fr},131:{n:"HCenter",f:Dr},132:{n:"VCenter",f:Dr},133:{n:"BoundSheet8",f:function(e,t,n){var r=e._R(4),i=3&e._R(1),a=e._R(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule"}var s=zr(e,0,n);return 0===s.length&&(s="Sheet1"),{pos:r,hs:i,dt:a,name:s}}},134:{n:"WriteProtect"},140:{n:"Country",f:function(e){var t,n=[0,0];return t=e._R(2),n[0]=Fn[t]||t,t=e._R(2),n[1]=Fn[t]||t,n}},141:{n:"HideObj",f:Fr},144:{n:"Sort"},146:{n:"Palette",f:function(e){for(var t=e._R(2),n=[];t-- >0;)n.push(Yr(e));return n}},151:{n:"Sync"},152:{n:"LPr"},153:{n:"DxGCol"},154:{n:"FnGroupName"},155:{n:"FilterMode"},156:{n:"BuiltInFnGroupCount",f:Fr},157:{n:"AutoFilterInfo"},158:{n:"AutoFilter"},160:{n:"Scl",f:Ri},161:{n:"Setup",f:function(e,t){var n={};return t<32?n:(e.l+=16,n.header=yn(e),n.footer=yn(e),e.l+=2,n)}},174:{n:"ScenMan"},175:{n:"SCENARIO"},176:{n:"SxView"},177:{n:"Sxvd"},178:{n:"SXVI"},180:{n:"SxIvd"},181:{n:"SXLI"},182:{n:"SXPI"},184:{n:"DocRoute"},185:{n:"RecipName"},189:{n:"MulRk",f:function(e,t){for(var n=e.l+t-2,r=e._R(2),i=e._R(2),a=[];e.l<n;)a.push(Qr(e));if(e.l!==n)throw new Error("MulRK read error");var s=e._R(2);if(a.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:r,c:i,C:s,rkrec:a}}},190:{n:"MulBlank",f:function(e,t){for(var n=e.l+t-2,r=e._R(2),i=e._R(2),a=[];e.l<n;)a.push(e._R(2));if(e.l!==n)throw new Error("MulBlank read error");var s=e._R(2);if(a.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:r,c:i,C:s,ixfe:a}}},193:{n:"Mms",f:Ir},197:{n:"SXDI"},198:{n:"SXDB"},199:{n:"SXFDB"},200:{n:"SXDBB"},201:{n:"SXNum"},202:{n:"SxBool",f:Dr},203:{n:"SxErr"},204:{n:"SXInt"},205:{n:"SXString"},206:{n:"SXDtr"},207:{n:"SxNil"},208:{n:"SXTbl"},209:{n:"SXTBRGIITM"},210:{n:"SxTbpg"},211:{n:"ObProj"},213:{n:"SXStreamID"},215:{n:"DBCell"},216:{n:"SXRng"},217:{n:"SxIsxoper"},218:{n:"BookBool",f:Fr},220:{n:"DbOrParamQry"},221:{n:"ScenarioProtect",f:Dr},222:{n:"OleObjectSize"},224:{n:"XF",f:function(e,t,n){var r={};return r.ifnt=e._R(2),r.numFmtId=e._R(2),r.flags=e._R(2),r.fStyle=r.flags>>2&1,r.data=function(e,t,n,r){var i={},a=e._R(4),s=e._R(4),o=e._R(4),l=e._R(2);return i.patternType=On[o>>26],r.cellStyles?(i.alc=7&a,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=15&s,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=127&o,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=127&l,i.icvBack=l>>7&127,i.fsxButton=l>>14&1,i):i}(e,0,r.fStyle,n),r}},225:{n:"InterfaceHdr",f:function(e,t){return 0===t?1200:(e._R(2),1200)}},226:{n:"InterfaceEnd",f:Ir},227:{n:"SXVS"},229:{n:"MergeCells",f:function(e,t){for(var n=[],r=e._R(2);r--;)n.push(Jr(e));return n}},233:{n:"BkHim"},235:{n:"MsoDrawingGroup"},236:{n:"MsoDrawing"},237:{n:"MsoDrawingSelection"},239:{n:"PhoneticInfo"},240:{n:"SxRule"},241:{n:"SXEx"},242:{n:"SxFilt"},244:{n:"SxDXF"},245:{n:"SxItm"},246:{n:"SxName"},247:{n:"SxSelect"},248:{n:"SXPair"},249:{n:"SxFmla"},251:{n:"SxFormat"},252:{n:"SST",f:function(e,t){for(var n=e.l+t,r=e._R(4),i=e._R(4),a=[],s=0;s!=i&&e.l<n;++s)a.push(Wr(e));return a.Count=r,a.Unique=i,a}},253:{n:"LabelSst",f:function(e){var t=Kr(e);return t.isst=e._R(4),t}},255:{n:"ExtSST",f:function(e,t){var n={};return n.dsst=e._R(2),e.l+=t-2,n}},256:{n:"SXVDEx"},259:{n:"SXFormula"},290:{n:"SXDBEx"},311:{n:"RRDInsDel"},312:{n:"RRDHead"},315:{n:"RRDChgCell"},317:{n:"RRTabId",f:Nr},318:{n:"RRDRenSheet"},319:{n:"RRSort"},320:{n:"RRDMove"},330:{n:"RRFormat"},331:{n:"RRAutoFmt"},333:{n:"RRInsertSh"},334:{n:"RRDMoveBegin"},335:{n:"RRDMoveEnd"},336:{n:"RRDInsDelBegin"},337:{n:"RRDInsDelEnd"},338:{n:"RRDConflict"},339:{n:"RRDDefName"},340:{n:"RRDRstEtxp"},351:{n:"LRng"},352:{n:"UsesELFs",f:Dr},353:{n:"DSF",f:Ir},401:{n:"CUsr"},402:{n:"CbUsr"},403:{n:"UsrInfo"},404:{n:"UsrExcl"},405:{n:"FileLock"},406:{n:"RRDInfo"},407:{n:"BCUsrs"},408:{n:"UsrChk"},425:{n:"UserBView"},426:{n:"UserSViewBegin"},427:{n:"UserSViewEnd"},428:{n:"RRDUserView"},429:{n:"Qsi"},430:{n:"SupBook",f:function(e,t,n){var r=e.l+t,i=e._R(2),a=e._R(2);if(n.sbcch=a,1025==a||14849==a)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=Vr(e,a),o=[];r>e.l;)o.push($r(e));return[a,i,s,o]}},431:{n:"Prot4Rev",f:Dr},432:{n:"CondFmt"},433:{n:"CF"},434:{n:"DVal"},437:{n:"DConBin"},438:{n:"TxO",f:function(e,t,n){var r=e.l,i="";try{e.l+=4;var a=(n.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(a)?e.l+=6:function(e){var t=e._R(1);e.l++;var n=e._R(2);e.l+=2}(e);var s=e._R(2);e._R(2),Fr(e);var o=e._R(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-r!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((i+=Vr(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?s:2*s))break}if(i.length!==s&&i.length!==2*s)throw new Error("cchText: "+s+" != "+i.length);return e.l=r+t,{t:i}}catch(n){return e.l=r+t,{t:i}}}},439:{n:"RefreshAll",f:Dr},440:{n:"HLink",f:function(e,t){var n=Jr(e);return e.l+=16,[n,function(e,t){var n=e.l+t,r=e._R(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);var i=e._R(2);e.l+=2;var a,s,o,l,c,u,h="";16&i&&(a=Gr(e,e.l)),128&i&&(s=Gr(e,e.l)),257==(257&i)&&(o=Gr(e,e.l)),1==(257&i)&&(l=Xr(e,e.l)),8&i&&(h=Gr(e,e.l)),32&i&&(c=e._R(16)),64&i&&(u=mr(e)),e.l=n;var d=s||o||l||"";d&&h&&(d+="#"+h),d||(d="#"+h);var f={Target:d};return c&&(f.guid=c),u&&(f.time=u),a&&(f.Tooltip=a),f}(e,t-24)]}},441:{n:"Lel"},442:{n:"CodeName",f:$r},443:{n:"SXFDBType"},444:{n:"Prot4RevPass",f:Fr},445:{n:"ObNoMacros"},446:{n:"Dv"},448:{n:"Excel9File",f:Ir},449:{n:"RecalcId",f:function(e){return e._R(2),e._R(4)},r:2},450:{n:"EntExU2",f:Ir},512:{n:"Dimensions",f:di},513:{n:"Blank",f:ki},515:{n:"Number",f:function(e){var t=Kr(e),n=yn(e);return t.val=n,t}},516:{n:"Label",f:function(e,t,n){e.l;var r=Kr(e);2==n.biff&&e.l++;var i=$r(e,e.l,n);return r.val=i,r}},517:{n:"BoolErr",f:pi},518:{n:"Formula",f:Vs},519:{n:"String",f:Ti},520:{n:"Row",f:function(e){var t={};t.r=e._R(2),t.c=e._R(2),t.cnt=e._R(2)-t.c;var n=e._R(2);e.l+=4;var r=e._R(1);return e.l+=3,7&r&&(t.level=7&r),32&r&&(t.hidden=!0),64&r&&(t.hpt=n/20),t}},523:{n:"Index"},545:{n:"Array",f:xi},549:{n:"DefaultRowHeight",f:ci},566:{n:"Table"},574:{n:"Window2",f:function(e,t,n){return n&&n.biff>=2&&n.biff<8?{}:{RTL:64&e._R(2)}}},638:{n:"RK",f:function(e){var t=e._R(2),n=e._R(2),r=Qr(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}},659:{n:"Style"},1030:{n:"Formula",f:Vs},1048:{n:"BigName"},1054:{n:"Format",f:function(e,t,n){return[e._R(2),Ur(e,0,n)]}},1084:{n:"ContinueBigName"},1212:{n:"ShrFmla",f:function(e,t,n){var r=ti(e);e.l++;var i=e._R(1);return[function(e,t,n){var r,i=e.l+t,a=e._R(2),s=Ls(e,a,n);return 65535==a?[[],At(e,t-2)]:(t!==a+2&&(r=Ds(e,i-a-2,s,n)),[s,r])}(e,t-=8,n),i,r]}},2048:{n:"HLinkTooltip",f:function(e,t){e._R(2);var n=Jr(e),r=e._R((t-10)/2,"dbcs-cont");return[n,r=r.replace(E,"")]}},2049:{n:"WebPub"},2050:{n:"QsiSXTag"},2051:{n:"DBQueryExt"},2052:{n:"ExtString"},2053:{n:"TxtQry"},2054:{n:"Qsir"},2055:{n:"Qsif"},2056:{n:"RRDTQSIF"},2057:{n:"BOF",f:si},2058:{n:"OleDbConn"},2059:{n:"WOpt"},2060:{n:"SXViewEx"},2061:{n:"SXTH"},2062:{n:"SXPIEx"},2063:{n:"SXVDTEx"},2064:{n:"SXViewEx9"},2066:{n:"ContinueFrt"},2067:{n:"RealTimeData"},2128:{n:"ChartFrtInfo"},2129:{n:"FrtWrapper"},2130:{n:"StartBlock"},2131:{n:"EndBlock"},2132:{n:"StartObject"},2133:{n:"EndObject"},2134:{n:"CatLab"},2135:{n:"YMult"},2136:{n:"SXViewLink"},2137:{n:"PivotChartBits"},2138:{n:"FrtFontList"},2146:{n:"SheetExt"},2147:{n:"BookExt",r:12},2148:{n:"SXAddl"},2149:{n:"CrErr"},2150:{n:"HFPicture"},2151:{n:"FeatHdr",f:Ir},2152:{n:"Feat"},2154:{n:"DataLabExt"},2155:{n:"DataLabExtContents"},2156:{n:"CellWatch"},2161:{n:"FeatHdr11"},2162:{n:"Feature11"},2164:{n:"DropDownObjIds"},2165:{n:"ContinueFrt11"},2166:{n:"DConn"},2167:{n:"List12"},2168:{n:"Feature12"},2169:{n:"CondFmt12"},2170:{n:"CF12"},2171:{n:"CFEx"},2172:{n:"XFCRC",f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e._R(2),t.crc=e._R(4),t},r:12},2173:{n:"XFExt",f:function(e,t){e.l,e.l+=2;var n=e._R(2);e.l+=2;for(var r=e._R(2),i=[];r-- >0;)i.push(Ya(e,e.l));return{ixfe:n,ext:i}},r:12},2174:{n:"AutoFilter12"},2175:{n:"ContinueFrt12"},2180:{n:"MDTInfo"},2181:{n:"MDXStr"},2182:{n:"MDXTuple"},2183:{n:"MDXSet"},2184:{n:"MDXProp"},2185:{n:"MDXKPI"},2186:{n:"MDB"},2187:{n:"PLV"},2188:{n:"Compat12",f:Dr,r:12},2189:{n:"DXF"},2190:{n:"TableStyles",r:12},2191:{n:"TableStyle"},2192:{n:"TableStyleElement"},2194:{n:"StyleExt"},2195:{n:"NamePublish"},2196:{n:"NameCmt",f:function(e,t,n){if(!(n.biff<8)){var r=e._R(2),i=e._R(2);return[Vr(e,r,n),Vr(e,i,n)]}e.l+=t},r:12},2197:{n:"SortData"},2198:{n:"Theme",f:function(e,t,n){var r=e.l+t;if(124226!==e._R(4))if(n.cellStyles&&te){var i,a=e.slice(e.l);e.l=r;try{i=new te(a)}catch(e){return}var s=le(i,"theme/theme/theme1.xml",!0);if(s)return Xa(s,n)}else e.l=r},r:12},2199:{n:"GUIDTypeLib"},2200:{n:"FnGrp12"},2201:{n:"NameFnGrp12"},2202:{n:"MTRSettings",f:function(e){return[0!==e._R(4),0!==e._R(4),e._R(4)]},r:12},2203:{n:"CompressPictures",f:Ir},2204:{n:"HeaderFooter"},2205:{n:"CrtLayout12"},2206:{n:"CrtMlFrt"},2207:{n:"CrtMlFrtContinue"},2211:{n:"ForceFullCalculation",f:function(e){var t=function(e){var t=e._R(2),n=e._R(2);return e.l+=8,{type:t,flags:n}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e._R(4)}},2212:{n:"ShapePropsStream"},2213:{n:"TextPropsStream"},2214:{n:"RichTextStream"},2215:{n:"CrtLayout12A"},4097:{n:"Units"},4098:{n:"Chart"},4099:{n:"Series"},4102:{n:"DataFormat"},4103:{n:"LineFormat"},4105:{n:"MarkerFormat"},4106:{n:"AreaFormat"},4107:{n:"PieFormat"},4108:{n:"AttachedLabel"},4109:{n:"SeriesText"},4116:{n:"ChartFormat"},4117:{n:"Legend"},4118:{n:"SeriesList"},4119:{n:"Bar"},4120:{n:"Line"},4121:{n:"Pie"},4122:{n:"Area"},4123:{n:"Scatter"},4124:{n:"CrtLine"},4125:{n:"Axis"},4126:{n:"Tick"},4127:{n:"ValueRange"},4128:{n:"CatSerRange"},4129:{n:"AxisLine"},4130:{n:"CrtLink"},4132:{n:"DefaultText"},4133:{n:"Text"},4134:{n:"FontX",f:Fr},4135:{n:"ObjectLink"},4146:{n:"Frame"},4147:{n:"Begin"},4148:{n:"End"},4149:{n:"PlotArea"},4154:{n:"Chart3d"},4156:{n:"PicF"},4157:{n:"DropBar"},4158:{n:"Radar"},4159:{n:"Surf"},4160:{n:"RadarArea"},4161:{n:"AxisParent"},4163:{n:"LegendException"},4164:{n:"ShtProps",f:function(e,t,n){var r={area:!1};if(5!=n.biff)return e.l+=t,r;var i=e._R(1);return e.l+=3,16&i&&(r.area=!0),r}},4165:{n:"SerToCrt"},4166:{n:"AxesUsed"},4168:{n:"SBaseRef"},4170:{n:"SerParent"},4171:{n:"SerAuxTrend"},4174:{n:"IFmtRecord"},4175:{n:"Pos"},4176:{n:"AlRuns"},4177:{n:"BRAI"},4187:{n:"SerAuxErrBar"},4188:{n:"ClrtClient",f:function(e){for(var t=e._R(2),n=[];t-- >0;)n.push(Yr(e));return n}},4189:{n:"SerFmt"},4191:{n:"Chart3DBarShape"},4192:{n:"Fbi"},4193:{n:"BopPop"},4194:{n:"AxcExt"},4195:{n:"Dat"},4196:{n:"PlotGrowth"},4197:{n:"SIIndex"},4198:{n:"GelFrame"},4199:{n:"BopPopCustom"},4200:{n:"Fbi2"},0:{n:"Dimensions",f:di},2:{n:"BIFF2INT",f:function(e){var t=Kr(e);++e.l;var n=e._R(2);return t.t="n",t.val=n,t}},5:{n:"BoolErr",f:pi},7:{n:"String",f:function(e){var t=e._R(1);return 0===t?(e.l++,""):e._R(t,"sbcs-cont")}},8:{n:"BIFF2ROW"},11:{n:"Index"},22:{n:"ExternCount",f:Fr},30:{n:"BIFF2FORMAT",f:hi},31:{n:"BIFF2FMTCNT"},32:{n:"BIFF2COLINFO"},33:{n:"Array",f:xi},37:{n:"DefaultRowHeight",f:ci},50:{n:"BIFF2FONTXTRA",f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},52:{n:"DDEObjName"},62:{n:"BIFF2WINDOW2"},67:{n:"BIFF2XF"},69:{n:"BIFF2FONTCLR"},86:{n:"BIFF4FMTCNT"},126:{n:"RK"},127:{n:"ImData",f:function(e){var t=e._R(2),n=e._R(2),r=e._R(4),i={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,i}},135:{n:"Addin"},136:{n:"Edg"},137:{n:"Pub"},145:{n:"Sub"},148:{n:"LHRecord"},149:{n:"LHNGraph"},150:{n:"Sound"},169:{n:"CoordList"},171:{n:"GCW"},188:{n:"ShrFmla"},191:{n:"ToolbarHdr"},192:{n:"ToolbarEnd"},194:{n:"AddMenu"},195:{n:"DelMenu"},214:{n:"RString",f:function(e,t,n){var r=e.l+t,i=Kr(e),a=Vr(e,e._R(2),n);return e.l=r,i.t="str",i.val=a,i}},223:{n:"UDDesc"},234:{n:"TabIdConf"},354:{n:"XL5Modify"},421:{n:"FileSharing2"},521:{n:"BOF",f:si},536:{n:"Lbl",f:Si},547:{n:"ExternName",f:gi},561:{n:"Font"},579:{n:"BIFF3XF"},1033:{n:"BOF",f:si},1091:{n:"BIFF4XF"},2157:{n:"FeatInfo"},2163:{n:"FeatInfo11"},2177:{n:"SXAddl12"},2240:{n:"AutoWebPub"},2241:{n:"ListObj"},2242:{n:"ListField"},2243:{n:"ListDV"},2244:{n:"ListCondFmt"},2245:{n:"ListCF"},2246:{n:"FMQry"},2247:{n:"FMSQry"},2248:{n:"PLV"},2249:{n:"LnExt"},2250:{n:"MkrExt"},2251:{n:"CrtCoopt"},2262:{n:"FRTArchId$",r:12},29282:{}},Zl=N(Kl,"n");function ql(e,t,n,r){var i=+t||+Zl[t];if(!isNaN(i)){var a=r||(n||[]).length||0,s=e.next(4);s._W(2,i),s._W(2,a),a>0&&mt(n)&&e.push(n)}}function Ql(e,t,n){return e||(e=Pt(7)),e._W(2,t),e._W(2,n),e._W(2,0),e._W(1,0),e}function Jl(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var i="d"==t.t?H(K(t.v)):t.v;return void(i==(0|i)&&i>=0&&i<65536?ql(e,2,function(e,t,n){var r=Pt(9);return Ql(r,e,t),r._W(2,n),r}(n,r,i)):ql(e,3,function(e,t,n){var r=Pt(15);return Ql(r,e,t),r._W(8,n,"f"),r}(n,r,i)));case"b":case"e":return void ql(e,5,function(e,t,n,r){var i=Pt(9);return Ql(i,e,t),"e"==r?(i._W(1,n),i._W(1,1)):(i._W(1,n?1:0),i._W(1,0)),i}(n,r,t.v,t.t));case"s":case"str":return void ql(e,4,function(e,t,n){var r=Pt(8+2*n.length);return Ql(r,e,t),r._W(1,n.length),r._W(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(n,r,t.v))}ql(e,1,Ql(null,n,r))}function ec(e,t){var n=t||{};null!=f&&null==n.dense&&(n.dense=f);for(var r=Mt(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==n.sheet&&(i=a);if(0==i&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return ql(r,9,oi(0,16,n)),function(e,t,n,r){var i,a=Array.isArray(t),s=jt(t["!ref"]||"A1"),o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=Gt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=zt(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=Vt(u)),i=l[u]+o;var h=a?(t[c]||[])[u]:t[i];h&&Jl(e,h,c,u)}}}(r,e.Sheets[e.SheetNames[i]],0,n),ql(r,10),r.end()}function tc(e,t,n){ql(e,"Font",function(e,t){var n=e.name||"Arial",r=t&&5==t.biff,i=Pt(r?15+n.length:16+2*n.length);return i._W(2,20*(e.sz||12)),i._W(4,0),i._W(2,400),i._W(4,0),i._W(2,0),i._W(1,n.length),r||i._W(1,1),i._W((r?1:2)*n.length,n,r?"sbcs":"utf16le"),i}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function nc(e,t,n,r,i){var a=16+lo(i.cellXfs,t,i);if(null!=t.v||t.bf)if(t.bf)ql(e,"Formula",$s(t,n,r,0,a));else switch(t.t){case"d":case"n":ql(e,"Number",function(e,t,n,r){var i=Pt(14);return Zr(e,t,r,i),xn(n,i),i}(n,r,"d"==t.t?H(K(t.v)):t.v,a));break;case"b":case"e":ql(e,517,mi(n,r,t.v,a,0,t.t));break;case"s":case"str":ql(e,"Label",function(e,t,n,r,i){var a=!i||8==i.biff,s=Pt(+a+8+(1+a)*n.length);return Zr(e,t,r,s),s._W(2,n.length),a&&s._W(1,1),s._W((1+a)*n.length,n,a?"utf16le":"sbcs"),s}(n,r,t.v,a,i));break;default:ql(e,"Blank",Zr(n,r,a))}else ql(e,"Blank",Zr(n,r,a))}function rc(e,t,n){var r,i=Mt(),a=n.SheetNames[e],s=n.Sheets[a]||{},o=(n||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=8==t.biff,h="",d=[],f=jt(s["!ref"]||"A1"),p=u?65536:16384;if(f.e.c>255||f.e.r>=p){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,p-1)}ql(i,2057,oi(0,16,t)),ql(i,"CalcMode",Or(1)),ql(i,"CalcCount",Or(100)),ql(i,"CalcRefMode",Lr(!0)),ql(i,"CalcIter",Lr(!1)),ql(i,"CalcDelta",xn(.001)),ql(i,"CalcSaveRecalc",Lr(!0)),ql(i,"PrintRowCol",Lr(!1)),ql(i,"PrintGrid",Lr(!1)),ql(i,"GridSet",Or(1)),ql(i,"Guts",function(e){var t=Pt(8);return t._W(4,0),t._W(2,e[0]?e[0]+1:0),t._W(2,e[1]?e[1]+1:0),t}([0,0])),ql(i,"HCenter",Lr(!1)),ql(i,"VCenter",Lr(!1)),ql(i,512,function(e,t){var n=8!=t.biff&&t.biff?2:4,r=Pt(2*n+6);return r._W(n,e.s.r),r._W(n,e.e.r+1),r._W(2,e.s.c),r._W(2,e.e.c+1),r._W(2,0),r}(f,t)),u&&(s["!links"]=[]);for(var m=f.s.r;m<=f.e.r;++m){h=zt(m);for(var v=f.s.c;v<=f.e.c;++v){m===f.s.r&&(d[v]=Vt(v)),r=d[v]+h;var g=c?(s[m]||[])[v]:s[r];g&&(nc(i,g,m,v,t),u&&g.l&&s["!links"].push([r,g.l]))}}var b=l.CodeName||l.name||a;return u&&o.Views&&ql(i,"Window2",function(e){var t=Pt(18),n=1718;return e&&e.RTL&&(n|=64),t._W(2,n),t._W(4,0),t._W(4,64),t._W(4,0),t._W(4,0),t}(o.Views[0])),u&&(s["!merges"]||[]).length&&ql(i,"MergeCells",function(e){var t=Pt(2+8*e.length);t._W(2,e.length);for(var n=0;n<e.length;++n)ei(e[n],t);return t}(s["!merges"])),u&&function(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];ql(e,"HLink",_i(r)),r[1].Tooltip&&ql(e,"HLinkTooltip",Ci(r))}delete t["!links"]}(i,s),ql(i,"CodeName",Hr(b)),u&&function(e,t){var n=Pt(19);n._W(4,2151),n._W(4,0),n._W(4,0),n._W(2,3),n._W(1,1),n._W(4,0),ql(e,"FeatHdr",n),(n=Pt(39))._W(4,2152),n._W(4,0),n._W(4,0),n._W(2,3),n._W(1,0),n._W(4,0),n._W(2,1),n._W(4,4),n._W(2,0),ei(jt(t["!ref"]||"A1"),n),n._W(4,4),ql(e,"Feat",n)}(i,s),ql(i,"EOF"),i.end()}function ic(e,t,n){var r=Mt(),i=(e||{}).Workbook||{},a=i.Sheets||[],s=i.WBProps||{},o=8==n.biff,l=5==n.biff;(ql(r,2057,oi(0,5,n)),"xla"==n.bookType&&ql(r,"Addin"),ql(r,"InterfaceHdr",o?Or(1200):null),ql(r,"Mms",function(e,t){t||(t=Pt(e));for(var n=0;n<e;++n)t._W(1,0);return t}(2)),l&&ql(r,"ToolbarHdr"),l&&ql(r,"ToolbarEnd"),ql(r,"InterfaceEnd"),ql(r,"WriteAccess",function(e,t){var n=!t||8==t.biff,r=Pt(n?112:54);for(r._W(8==t.biff?2:1,7),n&&r._W(1,0),r._W(4,859007059),r._W(4,5458548|(n?0:536870912));r.l<r.length;)r._W(1,n?0:32);return r}(0,n)),ql(r,"CodePage",Or(o?1200:1252)),o&&ql(r,"DSF",Or(0)),o&&ql(r,"Excel9File"),ql(r,"RRTabId",function(e){for(var t=Pt(2*e),n=0;n<e;++n)t._W(2,n+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&ql(r,"ObProj"),o&&e.vbaraw)&&ql(r,"CodeName",Hr(s.CodeName||"ThisWorkbook"));ql(r,"BuiltInFnGroupCount",Or(17)),ql(r,"WinProtect",Lr(!1)),ql(r,"Protect",Lr(!1)),ql(r,"Password",Or(0)),o&&ql(r,"Prot4Rev",Lr(!1)),o&&ql(r,"Prot4RevPass",Or(0)),ql(r,"Window1",function(){var e=Pt(18);return e._W(2,0),e._W(2,0),e._W(2,29280),e._W(2,17600),e._W(2,56),e._W(2,0),e._W(2,0),e._W(2,1),e._W(2,500),e}()),ql(r,"Backup",Lr(!1)),ql(r,"HideObj",Or(0)),ql(r,"Date1904",Lr("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&Pe(e.Workbook.WBProps.date1904)?"true":"false"}(e))),ql(r,"CalcPrecision",Lr(!0)),o&&ql(r,"RefreshAll",Lr(!1)),ql(r,"BookBool",Or(0)),tc(r,0,n),function(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)null!=t[i]&&ql(e,"Format",ui(i,t[i],n))})}(r,e.SSF,n),function(e,t){for(var n=0;n<16;++n)ql(e,"XF",fi({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ql(e,"XF",fi(n,0,t))})}(r,n),o&&ql(r,"UsesELFs",Lr(!1));var c=r.end(),u=Mt();o&&ql(u,"Country",function(e){return e||(e=Pt(4)),e._W(2,1),e._W(2,1),e}()),ql(u,"EOF");var h=u.end(),d=Mt(),f=0,p=0;for(p=0;p<e.SheetNames.length;++p)f+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var m=c.length+f+h.length;for(p=0;p<e.SheetNames.length;++p){ql(d,"BoundSheet8",li({pos:m,hs:(a[p]||{}).Hidden||0,dt:0,name:e.SheetNames[p]},n)),m+=t[p].length}var v=d.end();if(f!=v.length)throw new Error("BS8 "+f+" != "+v.length);var g=[];return c.length&&g.push(c),v.length&&g.push(v),h.length&&g.push(h),qe([g])}function ac(e,t){var n=t||{};switch(n.biff||2){case 8:case 5:return function(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=R.get_table()),e&&e.SSF&&(T(R),R.load_table(e.SSF),n.revssf=W(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Rc(n),n.cellXfs=[],lo(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=rc(i,n,e);return r.unshift(ic(e,r,n)),qe([r])}(e,t);case 4:case 3:case 2:return ec(e,t)}throw new Error("invalid type "+n.bookType+" for BIFF")}var sc=function(){function e(e,t){var n=t||{};null!=f&&null==n.dense&&(n.dense=f);var r=n.dense?[]:{},i=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),s=i.index,o=a&&a.index||e.length,l=function(e,t,n){if(ne||"string"==typeof t)return e.split(t);for(var r=e.split(t),i=[r[0]],a=1;a<r.length;++a)i.push(n),i.push(r[a]);return i}(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(s=0;s<l.length;++s){var v=l[s].trim(),g=v.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var b=v.split(/<\/t[dh]>/i);for(o=0;o<b.length;++o){var S=b[o].trim();if(S.match(/<t[dh]/i)){for(var y=S,x=0;"<"==y.charAt(0)&&(x=y.indexOf(">"))>-1;)y=y.slice(x+1);for(var w=0;w<m.length;++w){var _=m[w];_.s.c==u&&_.s.r<c&&c<=_.e.r&&(u=_.e.c+1,w=-1)}var C=ge(S.slice(0,S.indexOf(">")));d=C.colspan?+C.colspan:1,((h=+C.rowspan)>1||d>1)&&m.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+d-1}});var E=C.t||"";if(y.length){if(y=Oe(y),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),y.length){var k={t:"s",v:y};n.raw||!y.trim().length||"s"==E||("TRUE"===y?k={t:"b",v:!0}:"FALSE"===y?k={t:"b",v:!1}:isNaN(J(y))?isNaN(ee(y).getDate())||(k={t:"d",v:K(y)},n.cellDates||(k={t:"n",v:H(k.v)}),k.z=n.dateNF||R._table[14]):k={t:"n",v:J(y)}),n.dense?(r[c]||(r[c]=[]),r[c][u]=k):r[Ht({r:c,c:u})]=k,u+=d}}else u+=d}}}}else{if(++c,n.sheetRows&&n.sheetRows<=c){--c;break}u=0}}return r["!ref"]=Gt(p),m.length&&(r["!merges"]=m),r}function t(e,t,n,r){for(var i=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>n||i[c].s.c>s||i[c].e.r<n||i[c].e.c<s)){if(i[c].s.r<n||i[c].s.c<s){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=Ht({r:n,c:s}),h=r.dense?(e[n]||[])[s]:e[u],d=h&&null!=h.v&&(h.h||Re(h.w||(Kt(h),h.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),f.t=h&&h.t||"z",r.editable&&(d='<span contenteditable="true">'+d+"</span>"),f.id=(r.id||"sjs")+"-"+u,a.push(Xe("td",d,f))}}return"<tr>"+a.join("")+"</tr>"}function n(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}var r='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',i="</body></html>";return{to_workbook:function(t,n){return Zt(e(t,n),n)},to_sheet:e,_row:t,BEGIN:r,END:i,_preamble:n,from_sheet:function(e,a){var s=a||{},o=null!=s.header?s.header:r,l=null!=s.footer?s.footer:i,c=[o],u=Xt(e["!ref"]);s.dense=Array.isArray(e),c.push(n(0,0,s));for(var h=u.s.r;h<=u.e.r;++h)c.push(t(e,u,h,s));return c.push("</table>"+l),c.join("")}}}();function oc(e,t){var n=t||{};null!=f&&(n.dense=f);for(var r=n.dense?[]:{},i=e.getElementsByTagName("tr"),a=n.sheetRows||1e7,s={s:{r:0,c:0},e:{r:0,c:0}},o=[],l=0,c=[],u=0,h=0,d=0,p=0,m=0,v=0;u<i.length&&h<a;++u){var g=i[u];if(lc(g)){if(n.display)continue;c[h]={hidden:!0}}var b=g.children;for(d=p=0;d<b.length;++d){var S=b[d];if(!n.display||!lc(S)){var y=Oe(S.innerHTML);for(l=0;l<o.length;++l){var x=o[l];x.s.c==p&&x.s.r<=h&&h<=x.e.r&&(p=x.e.c+1,l=-1)}v=+S.getAttribute("colspan")||1,((m=+S.getAttribute("rowspan"))>0||v>1)&&o.push({s:{r:h,c:p},e:{r:h+(m||1)-1,c:p+v-1}});var w={t:"s",v:y},_=S.getAttribute("t")||"";null!=y&&(0==y.length?w.t=_||"z":n.raw||0==y.trim().length||"s"==_||("TRUE"===y?w={t:"b",v:!0}:"FALSE"===y?w={t:"b",v:!1}:isNaN(J(y))?isNaN(ee(y).getDate())||(w={t:"d",v:K(y)},n.cellDates||(w={t:"n",v:H(w.v)}),w.z=n.dateNF||R._table[14]):w={t:"n",v:J(y)})),n.dense?(r[h]||(r[h]=[]),r[h][p]=w):r[Ht({c:p,r:h})]=w,s.e.c<p&&(s.e.c=p),p+=v}}++h}return o.length&&(r["!merges"]=o),c.length&&(r["!rows"]=c),s.e.r=h-1,r["!ref"]=Gt(s),h>=a&&(r["!fullref"]=Gt((s.e.r=i.length-u+h-1,s))),r}function lc(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style.display),"none"===t}var cc=function(){var e=function(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[xe(t.replace(/<[^>]*>/g,""))]},t={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};return function(n,r){var i=r||{};null!=f&&null==i.dense&&(i.dense=f);var a,s,o,l,c,u,h=Al(n),d=[],p={name:""},m="",v=0,g={},b=[],S=i.dense?[]:{},y={value:""},x="",w=0,_=[],C=-1,E=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,T={},A=[],P={},B=[],M=1,I=1,D=[],L={Names:[]},F={},O=["",""],N=[],z={},W="",V=0,$=!1,U=!1,X=0;for(Pl.lastIndex=0,h=h.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");c=Pl.exec(h);)switch(c[3]=c[3].replace(/_.*$/,"")){case"table":case"工作表":"/"===c[1]?(k.e.c>=k.s.c&&k.e.r>=k.s.r&&(S["!ref"]=Gt(k)),i.sheetRows>0&&i.sheetRows<=k.e.r&&(S["!fullref"]=S["!ref"],k.e.r=i.sheetRows-1,S["!ref"]=Gt(k)),A.length&&(S["!merges"]=A),B.length&&(S["!rows"]=B),o.name=o["名称"]||o.name,"undefined"!=typeof JSON&&JSON.stringify(o),b.push(o.name),g[o.name]=S,U=!1):"/"!==c[0].charAt(c[0].length-2)&&(o=ge(c[0],!1),C=E=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,S=i.dense?[]:{},A=[],B=[],U=!0);break;case"table-row-group":"/"===c[1]?--R:++R;break;case"table-row":case"行":if("/"===c[1]){C+=M,M=1;break}if((l=ge(c[0],!1))["行号"]?C=l["行号"]-1:-1==C&&(C=0),(M=+l["number-rows-repeated"]||1)<10)for(X=0;X<M;++X)R>0&&(B[C+X]={level:R});E=-1;break;case"covered-table-cell":"/"!==c[1]&&++E,i.sheetStubs&&(i.dense?(S[C]||(S[C]=[]),S[C][E]={t:"z"}):S[Ht({r:C,c:E})]={t:"z"}),x="",_=[];break;case"table-cell":case"数据":if("/"===c[0].charAt(c[0].length-2))++E,y=ge(c[0],!1),I=parseInt(y["number-columns-repeated"]||"1",10),u={t:"z",v:null},y.formula&&0!=i.cellFormula&&(u.f=Qs(xe(y.formula))),"string"==(y["数据类型"]||y["value-type"])&&(u.t="s",u.v=xe(y["string-value"]||""),i.dense?(S[C]||(S[C]=[]),S[C][E]=u):S[Ht({r:C,c:E})]=u),E+=I-1;else if("/"!==c[1]){++E,I=1;var j=M?C+M-1:C;if(E>k.e.c&&(k.e.c=E),E<k.s.c&&(k.s.c=E),C<k.s.r&&(k.s.r=C),j>k.e.r&&(k.e.r=j),N=[],z={},u={t:(y=ge(c[0],!1))["数据类型"]||y["value-type"],v:null},i.cellFormula)if(y.formula&&(y.formula=xe(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(P={s:{r:C,c:E},e:{r:C+(parseInt(y["number-matrix-rows-spanned"],10)||0)-1,c:E+(parseInt(y["number-matrix-columns-spanned"],10)||0)-1}},u.F=Gt(P),D.push([P,u.F])),y.formula)u.f=Qs(y.formula);else for(X=0;X<D.length;++X)C>=D[X][0].s.r&&C<=D[X][0].e.r&&E>=D[X][0].s.c&&E<=D[X][0].e.c&&(u.F=D[X][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(P={s:{r:C,c:E},e:{r:C+(parseInt(y["number-rows-spanned"],10)||0)-1,c:E+(parseInt(y["number-columns-spanned"],10)||0)-1}},A.push(P)),y["number-columns-repeated"]&&(I=parseInt(y["number-columns-repeated"],10)),u.t){case"boolean":u.t="b",u.v=Pe(y["boolean-value"]);break;case"float":case"percentage":case"currency":u.t="n",u.v=parseFloat(y.value);break;case"date":u.t="d",u.v=K(y["date-value"]),i.cellDates||(u.t="n",u.v=H(u.v)),u.z="m/d/yy";break;case"time":u.t="n",u.v=G(y["time-value"])/86400;break;case"number":u.t="n",u.v=parseFloat(y["数据数值"]);break;default:if("string"!==u.t&&"text"!==u.t&&u.t)throw new Error("Unsupported value type "+u.t);u.t="s",null!=y["string-value"]&&(x=xe(y["string-value"]),_=[])}}else{if($=!1,"s"===u.t&&(u.v=x||"",_.length&&(u.R=_),$=0==w),F.Target&&(u.l=F),N.length>0&&(u.c=N,N=[]),x&&!1!==i.cellText&&(u.w=x),(!$||i.sheetStubs)&&!(i.sheetRows&&i.sheetRows<=C))for(var Y=0;Y<M;++Y){if(I=parseInt(y["number-columns-repeated"]||"1",10),i.dense)for(S[C+Y]||(S[C+Y]=[]),S[C+Y][E]=0==Y?u:q(u);--I>0;)S[C+Y][E+I]=q(u);else for(S[Ht({r:C+Y,c:E})]=u;--I>0;)S[Ht({r:C+Y,c:E+I})]=q(u);k.e.c<=E&&(k.e.c=E)}E+=(I=parseInt(y["number-columns-repeated"]||"1",10))-1,I=0,u={},x="",_=[]}F={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":if("/"===c[1]){if((a=d.pop())[0]!==c[3])throw"Bad state: "+a}else"/"!==c[0].charAt(c[0].length-2)&&d.push([c[3],!0]);break;case"annotation":if("/"===c[1]){if((a=d.pop())[0]!==c[3])throw"Bad state: "+a;z.t=x,_.length&&(z.R=_),z.a=W,N.push(z)}else"/"!==c[0].charAt(c[0].length-2)&&d.push([c[3],!1]);W="",V=0,x="",w=0,_=[];break;case"creator":"/"===c[1]?W=h.slice(V,c.index):V=c.index+c[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===c[1]){if((a=d.pop())[0]!==c[3])throw"Bad state: "+a}else"/"!==c[0].charAt(c[0].length-2)&&d.push([c[3],!1]);x="",w=0,_=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===c[1]){if(T[p.name]=m,(a=d.pop())[0]!==c[3])throw"Bad state: "+a}else"/"!==c[0].charAt(c[0].length-2)&&(m="",p=ge(c[0],!1),d.push([c[3],!0]));break;case"script":case"libraries":case"automatic-styles":case"master-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(d[d.length-1][0]){case"time-style":case"date-style":s=ge(c[0],!1),m+=t[c[3]]["long"===s.style?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(d[d.length-1][0]){case"time-style":case"date-style":s=ge(c[0],!1),m+=t[c[3]]["long"===s.style?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if("/>"===c[0].slice(-2))break;if("/"===c[1])switch(d[d.length-1][0]){case"number-style":case"date-style":case"time-style":m+=h.slice(v,c.index)}else v=c.index+c[0].length;break;case"named-range":O=eo((s=ge(c[0],!1))["cell-range-address"]);var Z={Name:s.name,Ref:O[0]+"!"+O[1]};U&&(Z.Sheet=b.length),L.Names.push(Z);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"电子表格":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"文本串":if("/"!==c[1]||y&&y["string-value"])ge(c[0],!1),w=c.index+c[0].length;else{var Q=e(h.slice(w,c.index));x=(x.length>0?x+"\n":"")+Q[0]}break;case"s":break;case"database-range":if("/"===c[1])break;try{g[(O=eo(ge(c[0])["target-range-address"]))[0]]["!autofilter"]={ref:O[1]}}catch(e){}break;case"date":case"object":break;case"title":case"标题":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if("/"!==c[1]){if(!(F=ge(c[0],!1)).href)break;F.Target=F.href,delete F.href,"#"==F.Target.charAt(0)&&F.Target.indexOf(".")>-1&&(O=eo(F.Target.slice(1)),F.Target="#"+O[0]+"!"+O[1])}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(c[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(i.WTF)throw new Error(c)}}var J={Sheets:g,SheetNames:b,Workbook:L};return i.bookSheets&&delete J.Sheets,J}}();function uc(e,t){t=t||{};var n=!!ae(e,"objectdata");n&&function(e,t){for(var n,r,i=Al(e);n=Pl.exec(i);)switch(n[3]){case"manifest":break;case"file-entry":if("/"==(r=ge(n[0],!1)).path&&r.type!==qn)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}(oe(e,"META-INF/manifest.xml"),t);var r=le(e,"content.xml");if(!r)throw new Error("Missing content.xml in "+(n?"ODS":"UOF")+" file");var i=cc(n?r:Be(r),t);return ae(e,"meta.xml")&&(i.Props=rr(oe(e,"meta.xml"))),i}function hc(e,t){return cc(e,t)}var dc=function(){var e="<office:document-styles "+He({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+"></office:document-styles>";return function(){return de+e}}(),fc=function(){var e=function(e){return Ce(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"<text:line-break/>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",n=function(n,r,i){var a=[];a.push('      <table:table table:name="'+Ce(r.SheetNames[i])+'">\n');var s=0,o=0,l=Xt(n["!ref"]),c=n["!merges"]||[],u=0,h=Array.isArray(n);for(s=0;s<l.s.r;++s)a.push("        <table:table-row></table:table-row>\n");for(;s<=l.e.r;++s){for(a.push("        <table:table-row>\n"),o=0;o<l.s.c;++o)a.push(t);for(;o<=l.e.c;++o){var d=!1,f={},p="";for(u=0;u!=c.length;++u)if(!(c[u].s.c>o||c[u].s.r>s||c[u].e.c<o||c[u].e.r<s)){c[u].s.c==o&&c[u].s.r==s||(d=!0),f["table:number-columns-spanned"]=c[u].e.c-c[u].s.c+1,f["table:number-rows-spanned"]=c[u].e.r-c[u].s.r+1;break}if(d)a.push("          <table:covered-table-cell/>\n");else{var m=Ht({r:s,c:o}),v=h?(n[s]||[])[o]:n[m];if(v&&v.f&&(f["table:formula"]=Ce(Js(v.f)),v.F&&v.F.slice(0,m.length)==m)){var g=Xt(v.F);f["table:number-matrix-columns-spanned"]=g.e.c-g.s.c+1,f["table:number-matrix-rows-spanned"]=g.e.r-g.s.r+1}if(v){switch(v.t){case"b":p=v.v?"TRUE":"FALSE",f["office:value-type"]="boolean",f["office:boolean-value"]=v.v?"true":"false";break;case"n":p=v.w||String(v.v||0),f["office:value-type"]="float",f["office:value"]=v.v||0;break;case"s":case"str":p=v.v,f["office:value-type"]="string";break;case"d":p=v.w||K(v.v).toISOString(),f["office:value-type"]="date",f["office:date-value"]=K(v.v).toISOString(),f["table:style-name"]="ce1";break;default:a.push(t);continue}var b=e(p);if(v.l&&v.l.Target){var S=v.l.Target;b=Xe("text:a",b,{"xlink:href":S="#"==S.charAt(0)?"#"+to(S.slice(1)):S})}a.push("          "+Xe("table:table-cell",Xe("text:p",b,{}),f)+"\n")}else a.push(t)}}a.push("        </table:table-row>\n")}return a.push("      </table:table>\n"),a.join("")};return function(e,t){var r=[de],i=He({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),a=He({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?r.push("<office:document"+i+a+">\n"):r.push("<office:document-content"+i+">\n"),function(e){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var s=0;s!=e.SheetNames.length;++s)r.push(n(e.Sheets[e.SheetNames[s]],e,s));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function pc(e,t){if("fods"==t.bookType)return fc(e,t);var n=ue(),r="",i=[],a=[];return ce(n,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),ce(n,r="content.xml",fc(e,t)),i.push([r,"text/xml"]),a.push([r,"ContentFile"]),ce(n,r="styles.xml",dc(e,t)),i.push([r,"text/xml"]),a.push([r,"StylesFile"]),ce(n,r="meta.xml",er()),i.push([r,"text/xml"]),a.push([r,"MetadataFile"]),ce(n,r="manifest.rdf",function(e){var t=[de];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var n=0;n!=e.length;++n)t.push(Qn(e[n][0],e[n][1])),t.push(Jn("",e[n][0]));return t.push(Qn("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(a)),i.push([r,"application/rdf+xml"]),ce(n,r="META-INF/manifest.xml",function(e){var t=[de];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(i)),n}function mc(e){return function(t,n){var r=function(e,t){if(!t)return 0;var n=e.SheetNames.indexOf(t);if(-1==n)throw new Error("Sheet not found: "+t);return n}(t,n.sheet);return e.from_sheet(t.Sheets[t.SheetNames[r]],n,t)}}var vc=mc(sc),gc=mc({from_sheet:Zc}),bc=mc(void 0!==Pi?Pi:{}),Sc=mc(void 0!==Bi?Bi:{}),yc=mc(void 0!==Ii?Ii:{}),xc=mc(void 0!==aa?aa:{}),wc=mc({from_sheet:qc}),_c=mc(void 0!==Ai?Ai:{}),Cc=mc(void 0!==Mi?Mi:{});function Ec(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}var kc=Ec([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]]),Rc=Ec([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]]);function Tc(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,function(e){return Hn.WS.indexOf(e)>-1?"sheet":Hn.CS&&e==Hn.CS?"chart":Hn.DS&&e==Hn.DS?"dialog":Hn.MS&&e==Hn.MS?"macro":e&&e.length?e:"sheet"}(e["!id"][t.id].Type)]})}catch(e){return null}return e&&0!==e.length?e:null}function Ac(e,t,n,r,i,a,s,o,l,c,u,h){try{a[r]=Gn(le(e,n,!0),t);var d,f=oe(e,t);switch(o){case"sheet":d=cl(f,t,i,l,a[r],c,u,h);break;case"chart":if(!(d=ul(f,t,i,l,a[r],c))||!d["!drawel"])break;var p=he(d["!drawel"].Target,t),m=Xn(p),v=he(function(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}(le(e,p,!0),Gn(le(e,m,!0),p)),p),g=Xn(v);d=Xo(le(e,v,!0),0,0,Gn(le(e,g,!0),v),0,d);break;case"macro":d=function(e,t,n,r,i,a,s,o){return t.slice(-4),{"!type":"macro"}}(0,t,0,0,a[r]);break;case"dialog":d=function(e,t,n,r,i,a,s,o){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,a[r]);break;default:throw new Error("Unrecognized sheet type "+o)}s[r]=d;var b=[];a&&a[r]&&O(a[r]).forEach(function(n){if(a[r][n].Type==Hn.CMNT){var i=he(a[r][n].Target,t);if(!(b=fl(oe(e,i,!0),i,l))||!b.length)return;!function(e,t){var n,r=Array.isArray(e);t.forEach(function(t){var i=Ut(t.ref);if(r?(e[i.r]||(e[i.r]=[]),n=e[i.r][i.c]):n=e[t.ref],!n){n={t:"z"},r?e[i.r][i.c]=n:e[t.ref]=n;var a=jt(e["!ref"]||"BDWGO1000001:A1");a.s.r>i.r&&(a.s.r=i.r),a.e.r<i.r&&(a.e.r=i.r),a.s.c>i.c&&(a.s.c=i.c),a.e.c<i.c&&(a.e.c=i.c);var s=Gt(a);s!==e["!ref"]&&(e["!ref"]=s)}n.c||(n.c=[]);var o={a:t.author,t:t.t,r:t.r};t.h&&(o.h=t.h),n.c.push(o)})}(d,b)}})}catch(e){if(l.WTF)throw e}}function Pc(e){return"/"==e.charAt(0)?e.slice(1):e}function Bc(e,t){if(T(R),kc(t=t||{}),ae(e,"META-INF/manifest.xml"))return uc(e,t);if(ae(e,"objectdata.xml"))return uc(e,t);if(ae(e,"Index/Document.iwa"))throw new Error("Unsupported NUMBERS file");var n,r,i=function(e){for(var t=e.FullPaths||O(e.files),n=[],r=0;r<t.length;++r)"/"!=t[r].slice(-1)&&n.push(t[r]);return n.sort()}(e),a=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var n={};if((e.match(pe)||[]).forEach(function(e){var r=ge(e);switch(r[0].replace(me,"<")){case"<?xml":break;case"<Types":t.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[r.Extension]=r.ContentType;break;case"<Override":void 0!==t[zn[r.ContentType]]&&t[zn[r.ContentType]].push(r.PartName)}}),t.xmlns!==je.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}(le(e,"[Content_Types].xml")),s=!1;if(0===a.workbooks.length&&oe(e,r="xl/workbook.xml",!0)&&a.workbooks.push(r),0===a.workbooks.length){if(!oe(e,r="xl/workbook.bin",!0))throw new Error("Could not find workbook");a.workbooks.push(r),s=!0}"bin"==a.workbooks[0].slice(-3)&&(s=!0);var o={},l={};if(!t.bookSheets&&!t.bookProps){if(no=[],a.sst)try{no=dl(oe(e,Pc(a.sst)),a.sst,t)}catch(e){if(t.WTF)throw e}t.cellStyles&&a.themes.length&&(o=function(e,t,n){return Xa(e,n)}(le(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(l=hl(oe(e,Pc(a.style)),a.style,o,t))}a.links.map(function(n){try{Gn(le(e,Xn(Pc(n))),n);return ml(oe(e,Pc(n)),0,n,t)}catch(e){}});var c=ll(oe(e,Pc(a.workbooks[0])),a.workbooks[0],t),u={},h="";a.coreprops.length&&((h=oe(e,Pc(a.coreprops[0]),!0))&&(u=rr(h)),0!==a.extprops.length&&(h=oe(e,Pc(a.extprops[0]),!0))&&function(e,t,n){var r={};t||(t={}),e=Be(e),sr.forEach(function(n){var i=(e.match(Fe(n[0]))||[])[1];switch(n[2]){case"string":t[n[1]]=xe(i||"");break;case"bool":t[n[1]]="true"===i;break;case"raw":var a=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));a&&a.length>0&&(r[n[1]]=a[1])}}),r.HeadingPairs&&r.TitlesOfParts&&or(r.HeadingPairs,r.TitlesOfParts,t,n)}(h,u,t));var d={};t.bookSheets&&!t.bookProps||0!==a.custprops.length&&(h=le(e,Pc(a.custprops[0]),!0))&&(d=function(e,t){var n={},r="",i=e.match(cr);if(i)for(var a=0;a!=i.length;++a){var s=i[a],o=ge(s);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":r=xe(o.name);break;case"</property>":r=null;break;default:if(0===s.indexOf("<vt:")){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":n[r]=xe(u);break;case"bool":n[r]=Pe(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(u,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(u);break;case"filetime":case"date":n[r]=K(u);break;case"cy":case"error":n[r]=xe(u);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",s,c,l)}}else if("</"===s.slice(0,2));else if(t.WTF)throw new Error(s)}}return n}(h,t));var f={};if((t.bookSheets||t.bookProps)&&(c.Sheets?n=c.Sheets.map(function(e){return e.name}):u.Worksheets&&u.SheetNames.length>0&&(n=u.SheetNames),t.bookProps&&(f.Props=u,f.Custprops=d),t.bookSheets&&void 0!==n&&(f.SheetNames=n),t.bookSheets?f.SheetNames:t.bookProps))return f;n={};var p={};t.bookDeps&&a.calcchain&&(p=pl(oe(e,Pc(a.calcchain)),a.calcchain));var m,v,g=0,b={},S=c.Sheets;u.Worksheets=S.length,u.SheetNames=[];for(var y=0;y!=S.length;++y)u.SheetNames[y]=S[y].name;var x=s?"bin":"xml",w=a.workbooks[0].lastIndexOf("/"),_=(a.workbooks[0].slice(0,w+1)+"_rels/"+a.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");ae(e,_)||(_="xl/_rels/workbook."+x+".rels");var C=Gn(le(e,_,!0),_);C&&(C=Tc(C,c.Sheets));var E=oe(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=u.Worksheets;++g){var k="sheet";if(C&&C[g]?(m="xl/"+C[g][1].replace(/[\/]?xl\//,""),ae(e,m)||(m=C[g][1]),ae(e,m)||(m=_.replace(/_rels\/.*$/,"")+C[g][1]),k=C[g][2]):m=(m="xl/worksheets/sheet"+(g+1-E)+"."+x).replace(/sheet0\./,"sheet."),v=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(u.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,P=0;P!=t.sheets.length;++P)"number"==typeof t.sheets[P]&&t.sheets[P]==g&&(A=1),"string"==typeof t.sheets[P]&&t.sheets[P].toLowerCase()==u.SheetNames[g].toLowerCase()&&(A=1);if(!A)continue e}}Ac(e,m,v,u.SheetNames[g],g,b,n,k,t,c,o,l)}return f={Directory:a,Workbook:c,Props:u,Custprops:d,Deps:p,Sheets:n,SheetNames:u.SheetNames,Strings:no,Styles:l,Themes:o,SSF:R.get_table()},t&&t.bookFiles&&(f.keys=i,f.files=e.files),t&&t.bookVBA&&(a.vba.length>0?f.vbaraw=oe(e,Pc(a.vba[0]),!0):a.defaults&&a.defaults.bin===ts&&(f.vbaraw=oe(e,"xl/vbaProject.bin",!0))),f}function Mc(e,t){var n=t||{},r="Workbook",i=D.find(e,r);try{if(r="/!DataSpaces/Version",!(i=D.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(function(e){var t={};t.id=e._R(0,"lpp4"),t.R=Ki(e,4),t.U=Ki(e,4),t.W=Ki(e,4)}(i.content),r="/!DataSpaces/DataSpaceMap",!(i=D.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var a=function(e){var t=[];e.l+=4;for(var n=e._R(4);n-- >0;)t.push(Zi(e));return t}(i.content);if(1!==a.length||1!==a[0].comps.length||0!==a[0].comps[0].t||"StrongEncryptionDataSpace"!==a[0].name||"EncryptedPackage"!==a[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(i=D.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=function(e){var t=[];e.l+=4;for(var n=e._R(4);n-- >0;)t.push(e._R(0,"lpp4"));return t}(i.content);if(1!=s.length||"StrongEncryptionTransform"!=s[0])throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(i=D.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);qi(i.content)}catch(e){}if(r="/EncryptionInfo",!(i=D.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=ea(i.content);if(r="/EncryptedPackage",!(i=D.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(4==o[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(o[1],i.content,n.password||"",n);if(2==o[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(o[1],i.content,n.password||"",n);throw new Error("File is password-protected")}function Ic(e,t){if(Za=1024,"ods"==t.bookType)return pc(e,t);e&&!e.SSF&&(e.SSF=R.get_table()),e&&e.SSF&&(T(R),R.load_table(e.SSF),t.revssf=W(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,io?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",r=ns.indexOf(t.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],TODO:[],xmlns:""};Rc(t=t||{});var a=ue(),s="",o=0;if(t.cellXfs=[],lo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),ce(a,s="docProps/core.xml",function(e,t){var n=t||{},r=[de,ir],i={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&ar("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:Ge(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),null!=e.ModifiedDate&&ar("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:Ge(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var a=0;a!=tr.length;++a){var s=tr[a],o=n.Props&&null!=n.Props[s[1]]?n.Props[s[1]]:e?e[s[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&ar(s[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}(e.Props,t)),i.coreprops.push(s),Zn(t.rels,2,s,Hn.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;for(e.Props.Worksheets=e.Props.SheetNames.length,ce(a,s,function(e){var t=[],n=Xe;return e||(e={}),e.Application="SheetJS",t[t.length]=de,t[t.length]=lr,sr.forEach(function(r){if(void 0!==e[r[1]]){var i;switch(r[2]){case"string":i=Ce(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false"}void 0!==i&&(t[t.length]=n(r[0],i))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+Ce(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}(e.Props)),i.extprops.push(s),Zn(t.rels,3,s,Hn.EXT_PROPS),e.Custprops!==e.Props&&O(e.Custprops||{}).length>0&&(ce(a,s="docProps/custom.xml",hr(e.Custprops)),i.custprops.push(s),Zn(t.rels,4,s,Hn.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]];switch((h||{})["!type"]||"sheet"){case"chart":default:ce(a,s="xl/worksheets/sheet"+o+"."+n,gl(o-1,s,t,e,u)),i.sheets.push(s),Zn(t.wbrels,-1,"worksheets/sheet"+o+"."+n,Hn.WS[0])}if(h){var d=h["!comments"],f=!1;if(d&&d.length>0){var p="xl/comments"+o+"."+n;ce(a,p,Sl(d,p,t)),i.comments.push(p),Zn(u,-1,"../comments"+o+"."+n,Hn.CMNT),f=!0}h["!legacy"]&&f&&ce(a,"xl/drawings/vmlDrawing"+o+".vml",qa(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&ce(a,Xn(s),Yn(u))}return null!=t.Strings&&t.Strings.length>0&&(ce(a,s="xl/sharedStrings."+n,bl(t.Strings,s,t)),i.strs.push(s),Zn(t.wbrels,-1,"sharedStrings."+n,Hn.SST)),ce(a,s="xl/workbook."+n,vl(e,s,t)),i.workbooks.push(s),Zn(t.rels,1,s,Hn.WB),ce(a,s="xl/theme/theme1.xml",Ga(e.Themes,t)),i.themes.push(s),Zn(t.wbrels,-1,"theme/theme1.xml",Hn.THEME),ce(a,s="xl/styles."+n,function(e,t,n){return(".bin"===t.slice(-4)?za:Ra)(e,n)}(e,s,t)),i.styles.push(s),Zn(t.wbrels,-1,"styles."+n,Hn.STY),e.vbaraw&&r&&(ce(a,s="xl/vbaProject.bin",e.vbaraw),i.vba.push(s),Zn(t.wbrels,-1,"vbaProject.bin",Hn.VBA)),ce(a,"[Content_Types].xml",function(e,t){var n,r=[];r[r.length]=de,r[r.length]=$n,r=r.concat(Un);var i=function(i){e[i]&&e[i].length>0&&(n=e[i][0],r[r.length]=Xe("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:Wn[i][t.bookType||"xlsx"]}))},a=function(n){(e[n]||[]).forEach(function(e){r[r.length]=Xe("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Wn[n][t.bookType||"xlsx"]})})},s=function(t){(e[t]||[]).forEach(function(e){r[r.length]=Xe("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Vn[t][0]})})};return i("workbooks"),a("sheets"),a("charts"),s("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("drawings"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}(i,t)),ce(a,"_rels/.rels",Yn(t.rels)),ce(a,"xl/_rels/workbook."+n+".rels",Yn(t.wbrels)),delete t.revssf,delete t.ssf,a}function Dc(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3]];case"base64":n=p.decode(e.slice(0,24));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3)]}function Lc(e,t){var n=e,r=t||{};return r.type||(r.type=m&&Buffer.isBuffer(e)?"buffer":"base64"),Bc(function(e,t){var n;if(te)switch(t.type){case"base64":n=new te(e,{base64:!0});break;case"binary":case"array":n=new te(e,{base64:!1});break;case"buffer":n=new te(e);break;default:throw new Error("Unrecognized type "+t.type)}else switch(t.type){case"base64":n=D.read(e,{type:"base64"});break;case"binary":n=D.read(e,{type:"binary"});break;case"buffer":case"array":n=D.read(e,{type:"buffer"});break;default:throw new Error("Unrecognized type "+t.type)}return n}(n,r),r)}function Fc(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return Ml(e.slice(n),t);default:break e}return Ii.to_workbook(e,t)}function Oc(e,t,n,r){return r?(n.type="string",Ii.to_workbook(e,n)):Ii.to_workbook(t,n)}function Nc(e,t){if(l(),"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return Nc(new Uint8Array(e),t);var n,r=e,i=!1,a=t||{};if(a.cellStyles&&(a.cellNF=!0),ro={},a.dateNF&&(ro.dateNF=a.dateNF),a.type||(a.type=m&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==a.type&&(a.type=m?"buffer":"binary",r=function(e){if(void 0!==I)return I.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("Cannot access file "+e)}(e)),"string"==a.type&&(i=!0,a.type="binary",a.codepage=65001,r=function(e){return e.match(/[^\x00-\x7F]/)?Me(e):e}(e)),"array"==a.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return(a=q(a)).type="array",Nc(_(r),a)}switch((n=Dc(r,a))[0]){case 208:return function(e,t){return D.find(e,"EncryptedPackage")?Mc(e,t):Xl(e,t)}(D.read(r,a),a);case 9:if(n[1]<=4)return Xl(r,a);break;case 60:return Ml(r,a);case 73:if(68===n[1])return function(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var i=Pi.to_workbook(e,n);return n.WTF=r,i}catch(i){if(n.WTF=r,!i.message.match(/SYLK bad record ID/)&&r)throw i;return Ii.to_workbook(e,t)}}(r,a);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return Bi.to_workbook(r,a);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?Lc(r,a):Oc(e,r,a,i);case 239:return 60===n[3]?Ml(r,a):Oc(e,r,a,i);case 255:if(254===n[1])return function(e,t){var n=e;return"base64"==t.type&&(n=p.decode(n)),n=cptable.utils.decode(1200,n.slice(2),"str"),t.type="binary",Fc(n,t)}(r,a);break;case 0:if(0===n[1]&&n[2]>=2&&0===n[3])return Di.to_workbook(r,a);break;case 3:case 131:case 139:case 140:return Ai.to_workbook(r,a);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return aa.to_workbook(r,a);break;case 10:case 13:case 32:return function(e,t){var n="",r=Dc(e,t);switch(t.type){case"base64":n=p.decode(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=Z(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]&&(n=Be(n)),Fc(n,t)}(r,a)}return n[2]<=12&&n[3]<=31?Ai.to_workbook(r,a):Oc(e,r,a,i)}function zc(e,t){var n=t||{};return n.type="file",Nc(e,n)}function Wc(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return F(t.file,D.write(e,{type:m?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return D.write(e,t)}function Vc(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return p.encode(Me(r));case"binary":return Me(r);case"string":return e;case"file":return F(t.file,r,"utf8");case"buffer":return m?v(r,"utf8"):Vc(r,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $c(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?p.encode(n):"string"==t.type?Be(n):n;case"file":return F(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Uc(e,t){l(),tl(e);var n=t||{};if(n.cellStyles&&(n.cellNF=!0),"array"==n.type){n.type="binary";var r=Uc(e,n);return n.type="array",x(r)}switch(n.bookType||"xlsb"){case"xml":case"xlml":return Vc(Nl(e,n),n);case"slk":case"sylk":return Vc(bc(e,n),n);case"htm":case"html":return Vc(vc(e,n),n);case"txt":return function(e,t){switch(t.type){case"base64":return p.encode(e);case"binary":case"string":return e;case"file":return F(t.file,e,"binary");case"buffer":return m?v(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(wc(e,n),n);case"csv":return Vc(gc(e,n),n,"\ufeff");case"dif":return Vc(Sc(e,n),n);case"dbf":return $c(_c(e,n),n);case"prn":return Vc(yc(e,n),n);case"rtf":return Vc(xc(e,n),n);case"eth":return Vc(Cc(e,n),n);case"fods":return Vc(pc(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),$c(ac(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),function(e,t){var n=t||{};return Wc(Gl(e,n),n)}(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"ods":return function(e,t){var n=t||{},r=Ic(e,n),i={};if(n.compression&&(i.compression="DEFLATE"),n.password)i.type=m?"nodebuffer":"string";else switch(n.type){case"base64":i.type="base64";break;case"binary":i.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":i.type=m?"nodebuffer":"string";break;default:throw new Error("Unrecognized type "+n.type)}var a=r.FullPaths?D.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[i.type]||i.type}):r.generate(i);return n.password&&"undefined"!=typeof encrypt_agile?Wc(encrypt_agile(a,n.password),n):"file"===n.type?F(n.file,a):"string"==n.type?Be(a):a}(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function Hc(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function Xc(e,t,n){var r=n||{};return r.type="file",r.file=t,Hc(r),Uc(e,r)}function Gc(e,t,n,r,i,a,s,o){var l=zt(n),c=o.defval,u=o.raw||!o.hasOwnProperty("raw"),h=!0,d=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:n,enumerable:!1})}catch(e){d.__rowNum__=n}else d.__rowNum__=n;if(!s||e[n])for(var f=t.s.c;f<=t.e.c;++f){var p=s?e[n][f]:e[r[f]+l];if(void 0!==p&&void 0!==p.t){var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=a[f]){if(null==m)if(void 0!==c)d[a[f]]=c;else{if(!u||null!==m)continue;d[a[f]]=null}else d[a[f]]=u?m:Kt(p,m,o);null!=m&&(h=!1)}}else{if(void 0===c)continue;null!=a[f]&&(d[a[f]]=c)}}return{row:d,isempty:h}}function jc(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,i=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=jt(u);break;case"number":(l=jt(e["!ref"])).s.r=u;break;default:l=u}r>0&&(i=0);var h=zt(l.s.r),d=[],f=[],p=0,m=0,v=Array.isArray(e),g=l.s.r,b=0,S=0;for(v&&!e[g]&&(e[g]=[]),b=l.s.c;b<=l.e.c;++b)switch(d[b]=Vt(b),n=v?e[g][b]:e[d[b]+h],r){case 1:a[b]=b-l.s.c;break;case 2:a[b]=d[b];break;case 3:a[b]=c.header[b-l.s.c];break;default:for(null==n&&(n={w:"__EMPTY",t:"s"}),o=s=Kt(n,null,c),m=0,S=0;S<a.length;++S)a[S]==o&&(o=s+"_"+ ++m);a[b]=o}for(g=l.s.r+i;g<=l.e.r;++g){var y=Gc(e,l,g,d,r,a,v,c);(!1===y.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(f[p++]=y.row)}return f.length=p,f}var Yc=/"/g;function Kc(e,t,n,r,i,a,s,o){for(var l=!0,c=[],u="",h=zt(n),d=t.s.c;d<=t.e.c;++d)if(r[d]){var f=o.dense?(e[n]||[])[d]:e[r[d]+h];if(null==f)u="";else if(null!=f.v){l=!1,u=""+Kt(f,null,o);for(var p=0,m=0;p!==u.length;++p)if((m=u.charCodeAt(p))===i||m===a||34===m){u='"'+u.replace(Yc,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(l=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(Yc,'""')+'"'));c.push(u)}return!1===o.blankrows&&l?null:c.join(s)}function Zc(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var i=jt(e["!ref"]),a=void 0!==r.FS?r.FS:",",s=a.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==a?"\\|":a)+"+$"),u="",h=[];r.dense=Array.isArray(e);for(var d=r.skipHidden&&e["!cols"]||[],f=r.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(d[p]||{}).hidden||(h[p]=Vt(p));for(var m=i.s.r;m<=i.e.r;++m)(f[m]||{}).hidden||null!=(u=Kc(e,i,m,h,s,l,a,r))&&(r.strip&&(u=u.replace(c,"")),n.push(u+o));return delete r.dense,n.join("")}function qc(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=Zc(e,t);if("undefined"==typeof cptable||"string"==t.type)return n;var r=cptable.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function Qc(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var i,a=jt(e["!ref"]),s="",o=[],l=[],c=Array.isArray(e);for(i=a.s.c;i<=a.e.c;++i)o[i]=Vt(i);for(var u=a.s.r;u<=a.e.r;++u)for(s=zt(u),i=a.s.c;i<=a.e.c;++i)if(n=o[i]+s,r="",void 0!==(t=c?(e[u]||[])[i]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l}function Jc(e,t,n){var r,i=n||{},a=+!i.skipHeader,s=e||{},o=0,l=0;if(s&&null!=i.origin)if("number"==typeof i.origin)o=i.origin;else{var c="string"==typeof i.origin?Ut(i.origin):i.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(s["!ref"]){var h=jt(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==o&&(o=u.e.r+1,u.e.r=o+t.length-1+a)}var d=i.header||[],f=0;t.forEach(function(e,t){O(e).forEach(function(n){-1==(f=d.indexOf(n))&&(d[f=d.length]=n);var c=e[n],u="z",h="",p=Ht({c:l+f,r:o+t+a});r=eu.sheet_get_cell(s,p),!c||"object"!=typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date&&(u="d",i.cellDates||(u="n",c=H(c)),h=i.dateNF||R._table[14]),r?(r.t=u,r.v=c,delete r.w,delete r.R,h&&(r.z=h)):s[p]=r={t:u,v:c},h&&(r.z=h)):s[p]=c})}),u.e.c=Math.max(u.e.c,l+d.length-1);var p=zt(o);if(a)for(f=0;f<d.length;++f)s[Vt(f+l)+p]={t:"s",v:d[f]};return s["!ref"]=Gt(u),s}var eu={encode_col:Vt,encode_row:zt,encode_cell:Ht,encode_range:Gt,decode_col:Wt,decode_row:Nt,split_cell:$t,decode_cell:Ut,decode_range:Xt,format_cell:Kt,get_formulae:Qc,make_csv:Zc,make_json:jc,make_formulae:Qc,sheet_add_aoa:qt,sheet_add_json:Jc,aoa_to_sheet:Qt,json_to_sheet:function(e,t){return Jc(null,e,t)},table_to_sheet:oc,table_to_book:function(e,t){return Zt(oc(e,t),t)},sheet_to_csv:Zc,sheet_to_txt:qc,sheet_to_json:jc,sheet_to_html:sc.from_sheet,sheet_to_formulae:Qc,sheet_to_row_object_array:jc};!function(e){function t(e,t,n){return null!=e[t]?e[t]:e[t]=n}function n(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var i=Ut(t);return e[i.r]||(e[i.r]=[]),e[i.r][i.c]||(e[i.r][i.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return n(e,Ht("number"!=typeof t?t:{r:t,c:r||0}))}e.consts=e.consts||{},e.sheet_get_cell=n,e.book_new=function(){return{SheetNames:[],Sheets:{}}},e.book_append_sheet=function(e,t,n){if(!n)for(var r=1;r<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+r);++r);if(!n)throw new Error("Too many worksheets");if(el(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");e.SheetNames.push(n),e.Sheets[n]=t},e.book_set_sheet_visibility=function(e,n,r){t(e,"Workbook",{}),t(e.Workbook,"Sheets",[]);var i=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,n);switch(t(e.Workbook.Sheets,i,{}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[i].Hidden=r},function(t){t.forEach(function(t){e.consts[t[0]]=t[1]})}([["SHEET_VISIBLE",0],["SHEET_HIDDEN",1],["SHEET_VERY_HIDDEN",2]]),e.cell_set_number_format=function(e,t){return e.z=t,e},e.cell_set_hyperlink=function(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e},e.cell_set_internal_link=function(t,n,r){return e.cell_set_hyperlink(t,"#"+n,r)},e.cell_add_comment=function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},e.sheet_set_array_formula=function(e,t,r){for(var i="string"!=typeof t?t:jt(t),a="string"==typeof t?t:Gt(t),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var l=n(e,s,o);l.t="n",l.F=a,delete l.v,s==i.s.r&&o==i.s.c&&(l.f=r)}return e}}(eu),m&&"undefined"!=typeof require&&function(){var t={}.Readable;e.stream={to_json:function(e,n){var r=t({objectMode:!0});if(null==e||null==e["!ref"])return r.push(null),r;var i={t:"n",v:0},a=0,s=1,o=[],l=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},h=n||{},d=null!=h.range?h.range:e["!ref"];switch(1===h.header?a=1:"A"===h.header?a=2:Array.isArray(h.header)&&(a=3),typeof d){case"string":u=jt(d);break;case"number":(u=jt(e["!ref"])).s.r=d;break;default:u=d}a>0&&(s=0);var f=zt(u.s.r),p=[],m=0,v=Array.isArray(e),g=u.s.r,b=0,S=0;for(v&&!e[g]&&(e[g]=[]),b=u.s.c;b<=u.e.c;++b)switch(p[b]=Vt(b),i=v?e[g][b]:e[p[b]+f],a){case 1:o[b]=b-u.s.c;break;case 2:o[b]=p[b];break;case 3:o[b]=h.header[b-u.s.c];break;default:for(null==i&&(i={w:"__EMPTY",t:"s"}),c=l=Kt(i,null,h),m=0,S=0;S<o.length;++S)o[S]==c&&(c=l+"_"+ ++m);o[b]=c}return g=u.s.r+s,r._read=function(){if(g>u.e.r)return r.push(null);for(;g<=u.e.r;){var t=Gc(e,u,g,p,a,o,v,h);if(++g,!1===t.isempty||(1===a?!1!==h.blankrows:h.blankrows)){r.push(t.row);break}}},r},to_html:function(e,n){var r=t(),i=n||{},a=null!=i.header?i.header:sc.BEGIN,s=null!=i.footer?i.footer:sc.END;r.push(a);var o=Xt(e["!ref"]);i.dense=Array.isArray(e),r.push(sc._preamble(e,o,i));var l=o.s.r,c=!1;return r._read=function(){if(l>o.e.r)return c||(c=!0,r.push("</table>"+s)),r.push(null);for(;l<=o.e.r;){r.push(sc._row(e,o,l,i)),++l;break}},r},to_csv:function(e,n){var r=t(),i=null==n?{}:n;if(null==e||null==e["!ref"])return r.push(null),r;var a=jt(e["!ref"]),s=void 0!==i.FS?i.FS:",",o=s.charCodeAt(0),l=void 0!==i.RS?i.RS:"\n",c=l.charCodeAt(0),u=new RegExp(("|"==s?"\\|":s)+"+$"),h="",d=[];i.dense=Array.isArray(e);for(var f=i.skipHidden&&e["!cols"]||[],p=i.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(f[m]||{}).hidden||(d[m]=Vt(m));var v=a.s.r,g=!1;return r._read=function(){if(!g)return g=!0,r.push("\ufeff");for(;v<=a.e.r;)if(!(p[++v-1]||{}).hidden&&null!=(h=Kc(e,a,v-1,d,o,c,s,i))){i.strip&&(h=h.replace(u,"")),r.push(h+l);break}return v>a.e.r?r.push(null):void 0},r}}}(),void 0!==Xl&&(e.parse_xlscfb=Xl),e.parse_zip=Bc,e.read=Nc,e.readFile=zc,e.readFileSync=zc,e.write=Uc,e.writeFile=Xc,e.writeFileSync=Xc,e.writeFileAsync=function(e,t,n,r){var i=n||{};i.type="file",i.file=e,Hc(i),i.type="buffer";var a=r;return a instanceof Function||(a=n),I.writeFile(e,Uc(t,i),a)},e.utils=eu,e.SSF=R,void 0!==D&&(e.CFB=D)}"undefined"!=typeof exports?make_xlsx_lib(exports):"undefined"!=typeof module&&module.exports?make_xlsx_lib(module.exports):"function"==typeof define&&define.amd?define("xlsx",[],function(){return XLSX.version||make_xlsx_lib(XLSX),XLSX}):make_xlsx_lib(XLSX);var XLS=XLSX,ODS=XLSX;class UpLoad{constructor(e,t,n){var r=this;this.cb=null,this.reset=function(e){e[0].value=""},this.setInputElement=function(e){Static.bind("itemAttached",function(e,t,n){t.rtti>Static.Rtti_PlotMarker&&t.rtti<Static.Rtti_PlotShape&&$("#fileInput").val().includes(t.title())&&!n&&r.reset($("#fileInput"))}),e.change(function(e){for(var t,n=e.target.files,i=0;t=n[i];i++){var a=t.name.split(".")[1];if("txt"==a||"xls"==a||"xlsx"==a||"plt"==a){var s=new FileReader;s.onload=function(e){return function(t){r.cb?r.cb({fileName:e.name,content:t.target.result}):console.log({fileName:e.name,content:t.target.result})}}(t),"xls"==a||"xlsx"==a?s.readAsBinaryString(t):s.readAsText(t)}}})}}}define("upload",function(){});class MFile{constructor(e,t){var n=new UpLoad,r=this,i=null;function a(e){var r=JSON.parse(e.content),a=r[0];"[LogScaleEngine]"==a.rightScaleEngineType&&i.setAxisScaleEngine(yRight,new LogScaleEngine),"[LogScaleEngine]"==a.leftScaleEngineType&&i.setAxisScaleEngine(yLeft,new LogScaleEngine),"[LogScaleEngine]"==a.bottomScaleEngineType&&i.setAxisScaleEngine(xBottom,new LogScaleEngine),"[LogScaleEngine]"==a.topScaleEngineType&&i.setAxisScaleEngine(xTop,new LogScaleEngine),"[LinearScaleEngine]"==a.rightScaleEngineType&&i.setAxisScaleEngine(yRight,new LinearScaleEngine),"[LinearScaleEngine]"==a.leftScaleEngineType&&i.setAxisScaleEngine(yLeft,new LinearScaleEngine),"[LinearScaleEngine]"==a.bottomScaleEngineType&&i.setAxisScaleEngine(xBottom,new LinearScaleEngine),"[LinearScaleEngine]"==a.topScaleEngineType&&i.setAxisScaleEngine(xTop,new LinearScaleEngine),a.autoScale?setAutoScale(!0):(i.setAxisScale(xBottom,a.xBottomMin,a.xBottomMax),i.setAxisScale(yLeft,a.yLeftMin,a.yLeftMax),i.setAxisScale(xTop,a.xTopMin,a.xTopMax),i.setAxisScale(yRight,a.yRightMin,a.yRightMax)),i.setTitleFont(new Misc.Font(a.titleFont)),i.setFooterFont(new Misc.Font(a.footerFont)),i.setAxisTitleFont(xBottom,new Misc.Font(a.axisTitleFont)),i.setAxisTitleFont(xTop,new Misc.Font(a.axisTitleFont)),i.setAxisTitleFont(yLeft,new Misc.Font(a.axisTitleFont)),i.setAxisTitleFont(yRight,new Misc.Font(a.axisTitleFont)),i.setTitle(a.title),i.setFooter(a.footer),i.setAxisTitle(xBottom,a.xBottomAxisTitle),i.setAxisTitle(xTop,a.xTopAxisTitle),i.setAxisTitle(yLeft,a.yLeftAxisTitle),i.setAxisTitle(yRight,a.yRightAxisTitle);for(var s=1;s<r.length;++s)if(i.findPlotCurve(r[s].title))return Static.alert(r[s].title+" already exist"),void n.reset($("#fileInput"));for(s=1;s<r.length;++s){var o=new t(r[s].title);if(r[s].symbolType!==NoSymbol){var l=new Symbol;l.setStyle(r[s].symbolType),l.setSize(new Misc.Size(r[s].symbolWidth,r[s].symbolWidth)),l.setPen(new Misc.Pen(r[s].symbolPenColor,r[s].symbolPenWidth)),l.setBrush(new Misc.Brush(r[s].symbolBrushColor)),o.setSymbol(l)}if(r[s].fitType&&(o.fitType=r[s].fitType),o.setSamples(Utility.pointsFromXYObjectArray(r[s].samples)),"natural"==r[s].fitType||"periodic"==r[s].fitType){var c=new SplineCurveFitter,u=c.spline();"periodic"==r[s].fitType?u.setSplineType(Static.SplineType.Periodic):u.setSplineType(Static.SplineType.Natural),o.setCurveFitter(c)}o.setPen(new Misc.Pen(r[s].pen.color,r[s].pen.width,r[s].pen.style)),o.setAxes(r[s].xAxis,r[s].yAxis),o.attach(i)}n.reset($("#fileInput"))}this.init=function(e){i=e,n.cb=this.upload},this.setInputElement=function(e){n.setInputElement(e)},this.upload=function(e){var t=e.fileName.split(".")[1];if("xls"==t||"xlsx"==t||"txt"==t){var s=null,o=null;if("xls"==t||"xlsx"==t){var l=XLSX.read(e.content,{type:"binary"}),c=l.SheetNames[0];o=Utility.toArrays(XLSX.utils.sheet_to_csv(l.Sheets[c]))}else o=Utility.toArrays(e.content);if(!o.dataType)if(o.array.length&&o.array[0].hasOwnProperty("z")){for(var u=[],h=0;h<o.array.length;h++)u.push(o.array[h].x);u.length===_.uniq(u).length?o.dataType="spectrocurve":o.dataType="spectrogram"}else o.dataType="curve";if("curve"===o.dataType){s=Utility.makePoints(o.array);Static.trigger("addCurve",[e.fileName,s,!0])}else"spectrocurve"===o.dataType?Static.trigger("addSpectrocurve",[e.fileName,o,!0]):"spectrogram"===o.dataType&&Static.trigger("addSpectrogram",[e.fileName,o,!0])}else if("plt"==t){var d=i.itemList(Static.Rtti_PlotCurve);d.length?Static.alertYesNo("Do you want to save the changes to the Grapher?",function(t){if(t!=Static.Cancel){if(t==Static.Yes)return r.save(),void n.reset($("#fileInput"));if(t!=Static.No);else{for(var i=0;i<d.length;++i)d[i].detach();a(e)}}else n.reset($("#fileInput"))}):a(e)}},this.save=function(){Static.prompt("Enter a filename without extensions","plot_1",function(e){return e+=".plt",function(e,t){var n=document.createElement("a");document.body.appendChild(n),n.style="display: none";var r=JSON.stringify(e),i=new Blob([r],{type:"octet/stream"}),a=window.URL.createObjectURL(i);n.href=a,n.download=t,n.click(),window.URL.revokeObjectURL(a)}(function(){var e=[],t={};t.bottomScaleEngineType=i.axisScaleEngine(xBottom).toString(),t.leftScaleEngineType=i.axisScaleEngine(yLeft).toString(),t.topScaleEngineType=i.axisScaleEngine(xTop).toString(),t.rightScaleEngineType=i.axisScaleEngine(yRight).toString(),t.title=i.title(),t.titleFont=i.titleFont(),t.footer=i.footer(),t.footerFont=i.footerFont(),t.axisTitleFont=i.axisTitleFont(xBottom),t.xBottomAxisTitle=i.axisTitle(xBottom),t.xTopAxisTitle=i.axisTitle(xTop),t.yLeftAxisTitle=i.axisTitle(yLeft),t.yRightAxisTitle=i.axisTitle(yRight),t.autoScale=i.axisAutoScale(xBottom),t.autoScale||(t.xBottomMin=i.axisInterval(xBottom).minValue(),t.xBottomMax=i.axisInterval(xBottom).maxValue(),t.yLeftMin=i.axisInterval(yLeft).minValue(),t.yLeftMax=i.axisInterval(yLeft).maxValue(),t.xTopMin=i.axisInterval(xTop).minValue(),t.xTopMax=i.axisInterval(xTop).maxValue(),t.yRightMin=i.axisInterval(yRight).minValue(),t.yRightMax=i.axisInterval(yRight).maxValue()),e.push(t);for(var n=i.itemList(Static.Rtti_PlotCurve),r=0;r<n.length;++r){var a={};a.title=n[r].title(),a.samples=Utility.pointsToXYObjectArray(n[r].data().samples()),a.fn=n[r].fn,a.pen=n[r].pen(),a.fitType=n[r].fitType;var s=n[r].symbol();s&&(a.symbolType=s.style(),a.symbolWidth=s.size().width,a.symbolPenColor=s.pen().color,a.symbolPenWidth=s.pen().width,a.symbolBrushColor=s.brush().color),a.xAxis=n[r].xAxis(),a.yAxis=n[r].yAxis(),e.push(a)}return e}(),e),!0},"small")},this.init(e)}}define("file",["xlsx","upload"],function(){});class Watch{constructor(e,t){this._dependentRuler=t||Static.NoRuler,this._rulerGroup=e;var n=!0;this._curveName="",this._curve=null,this._rulerLeft=Number.MAX_VALUE,this._rulerRight=Number.MAX_VALUE,this._rulerBottom=Number.MAX_VALUE,this._rulerTop=Number.MAX_VALUE,this._value,this.name=function(){},this.computeWatch=function(){},this.value=function(){return this._value},this.setCurveName=function(e){this._curveName=e},this.setCurve=function(e){this._curve=e},this.setRulerLeft=function(e){this._rulerLeft=e},this.setRulerRight=function(e){this._rulerRight=e},this.setRulerBottom=function(e){this._curve&&this._curve.plot()&&(e=Static.adjustForDecimalPlaces(e,this._curve.plot().axisDecimalPlaces(this._curve.yAxis()))),this._rulerBottom=e},this.setRulerTop=function(e){this._curve&&this._curve.plot()&&(e=Static.adjustForDecimalPlaces(e,this._curve.plot().axisDecimalPlaces(this._curve.yAxis()))),this._rulerTop=e},this.setEnable=function(e){n=e,Static.trigger("watchEnabled",[this,e])},this.isEnable=function(){return n}}}define("watch",function(){});var MoveToElement=0,LineToElement=1,CurveToElement=2,CurveToDataElement=3,Misc={EPSILON:1e-20,Image:function(e,t){var n=e,r=t,i=null;"object"==typeof e&&_.has(e,"width")&&_.has(e,"height")&&(n=e.width,r=e.height),void 0==e&&(n=0,r=0);var a=$("<canvas/>")[0].getContext("2d"),s=null;0!==n&&0!==r&&(s=a.createImageData(n,r)),this.data=function(){return s.data},this.scaleImageData=function(e){if(s){for(var t=a.createImageData(s.width*e,s.height*e),n=a.createImageData(e,1).data,r=0;r<s.height;r++)for(var i=0;i<s.width;i++){for(var o=s.data.subarray(4*(r*s.width+i),4*(r*s.width+i)+4),l=0;l<e;l++)n.set(o,4*l);for(var c=0;c<e;c++){var u=r*e+c,h=i*e;t.data.set(n,4*(u*t.width+h))}}s=t}},this.imageData=function(){return s},this.setImageData=function(e){s=e},this.width=function(){return n},this.height=function(){return r},this.size=function(){return new Misc.Size(n,r)},this.isNull=function(){return null==s},this.copy=function(){var e=new Misc.Image(this.width(),this.height()),t=new ImageData(new Uint8ClampedArray(this.imageData().data),this.imageData().width,this.imageData().height);return e.setImageData(t),e},this.setAlpha=function(e){var t,n=s.data,r=n.length;for(t=3;t<r;t+=4)n[t]=e},this.setPixel=function(e,t,r){"number"==typeof r&&(r=i[Math.round(r)]);var a=t*(4*n)+4*e;s.data[a]=r.r,s.data[a+1]=r.g,s.data[a+2]=r.b,s.data[a+3]=255,r.a&&(r.a>255&&(r.a=255),r.a<0&&(r.a=0),s.data[a+3]=r.a)},this.setColorTable=function(e){i=e},this.pixel=function(e,t){if(void 0==t&&i)return i[Math.round(e)];var r=t*(4*n)+4*e;return{r:s.data[r],g:s.data[r+1],b:s.data[r+2],a:s.data[r+3]}}},Pen:function(e,t,n){if("object"==typeof e)return new Misc.Pen(e.color,e.width,e.style);this.color="black",this.width=1,this.style="solid",e!=Static.NoPen&&n!=Static.NoPen||(this.style=Static.NoPen),void 0!==n&&(this.style=n),void 0!==t&&(this.width=t),void 0!==e&&(this.color=e)}};Misc.Pen.prototype.toString=function(){return"[color:"+this.color+", width:"+this.width+", style:"+this.style+"]"},Misc.Pen.prototype.isEqual=function(e){return void 0!=e&&(this.color==e.color&&this.style==e.style&&this.width==e.width)},Misc.Brush=function(e){this.color=Static.NoBrush,void 0!==e&&(this.color=e)},Misc.Brush.prototype.toString=function(){return"[Brush: "+this.color+"]"},Misc.Brush.prototype.isEqual=function(e){return this.color==e.color},Misc.Line=function(e,t){var n=e,r=t;this.p1=function(){return n},this.p2=function(){return r}},Misc.Line.prototype.x1=function(){return this.p1().x},Misc.Line.prototype.x2=function(){return this.p2().x},Misc.Line.prototype.y1=function(){return this.p1().y},Misc.Line.prototype.y2=function(){return this.p2().y},Misc.Line.prototype.x2=function(){return this.p2().x},Misc.Line.prototype.length=function(){return Math.sqrt((this.p2().x-this.p1().x)*(this.p2().x-this.p1().x)+(this.p2().y-this.p1().y)*(this.p2().y-this.p1().y))},Misc.Size=function(e,t){e instanceof Misc.Size&&(t=e.height,e=e.width),this.width=0,this.height=0,void 0!==t&&(this.width=e,this.height=t)},Misc.Size.prototype.isValid=function(){return!(this.width<0||this.height<0)},Misc.Size.prototype.isEmpty=function(){return this.width<=0||this.height<=0},Misc.Size.prototype.copy=function(){return new Misc.Size(this.width,this.height)},Misc.Size.prototype.isEqual=function(e){var t=this.width-e.width,n=this.height-e.height;return t*t+n*n<Misc.EPSILON},Misc.Size.prototype.expandedTo=function(e){return new Misc.Size(Math.max(this.width,e.width),Math.max(this.height,e.height))},Misc.Size.prototype.boundedTo=function(e){return new Misc.Size(Math.min(this.width,e.width),Math.min(this.height,e.height))},Misc.Size.prototype.toString=function(){return"["+this.width+", "+this.height+"]"},Misc.Point=function(e,t){this.x=0,this.y=0,void 0!==t&&(this.y=t),void 0!==e&&(this.x=e)},Misc.Point.prototype.interpolatedPoint=function(e,t){if(t==e.x)return e;if(t==this.x)return this;var n=(this.y-e.y)/(this.x-e.x)*(t-e.x)+e.y;return new Misc.Point(t,n)},Misc.Point.prototype.logInterpolatedPoint=function(e,t){if(t==e.x)return e;if(t==this.x)return this;var n=(this.y-e.y)/(math.log(this.x,10)-math.log(e.x,10))*(math.log(t,10)-math.log(e.x,10))+e.y;return new Misc.Point(t,n)},Misc.Point.prototype.isEqual=function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n<Misc.EPSILON},Misc.Point.prototype.toString=function(){return"("+this.x+", "+this.y+")"},Misc.Rect=function(e,t,n,r){var i=0,a=0,s=-1,o=-1,l=-1,c=-1;void 0!==r?(s=(i=e)+(l=n),o=(a=t)+(c=r)):void 0!==n?(i=e.x,a=e.y,s=i+(l=t),o=a+(c=n)):void 0!==t&&(i=e.x,a=e.y,void 0!==t.x?(s=t.x,o=t.y,l=s-i,c=o-a):(l=t.width,c=t.height,s=i+l,o=a+c)),this.left=function(){return i},this.setLeft=function(e){i!==e&&(l=s-(i=e))},this.top=function(){return a},this.setTop=function(e){a!==e&&(c=o-(a=e))},this.right=function(){return s},this.setRight=function(e){s!==e&&(l=(s=e)-i)},this.bottom=function(){return o},this.setBottom=function(e){o!==e&&(c=(o=e)-a)},this.width=function(){return l},this.height=function(){return c}},Misc.Rect.prototype.setWidth=function(e){this.width()!==e&&this.setRight(this.left()+e)},Misc.Rect.prototype.isValid=function(){return!(this.width()<=0||this.height()<=0)},Misc.Rect.prototype.copy=function(){return new Misc.Rect(this.left(),this.top(),this.width(),this.height())},Misc.Rect.prototype.setHeight=function(e){this.height()!==e&&this.setBottom(this.top()+e)},Misc.Rect.prototype.adjust=function(e,t,n,r){this.setLeft(this.left()+e),this.setTop(this.top()+t),this.setRight(this.right()+n),this.setBottom(this.bottom()+r)},Misc.Rect.prototype.size=function(){return new Misc.Size(this.width(),this.height())},Misc.Rect.prototype.setSize=function(e){this.setWidth(e.width),this.setHeight(e.height)},Misc.Rect.prototype.setRect=function(e,t,n,r){this.setLeft(e),this.setTop(t),this.setWidth(n),this.setHeight(r)},Misc.Rect.prototype.united=function(e){return new Misc.Rect(Math.min(this.left(),e.left()),Math.min(this.top(),e.top()),Math.max(this.right(),e.right())-Math.min(this.left(),e.left()),Math.max(this.bottom(),e.bottom())-Math.min(this.top(),e.top()))},Misc.Rect.prototype.normalized=function(){var e=new Misc.Rect(this.left(),this.top(),this.width(),this.height());if(e.width()<0){var t=e.right();e.setRight(e.left()),e.setLeft(t)}if(this.height()<0){t=e.bottom();e.setBottom(e.top()),e.setTop(t)}return e},Misc.Rect.prototype.toRect=function(){return new Misc.Rect(Math.round(this.left()),Math.round(this.top()),Math.round(this.width()),Math.round(this.height()))},Misc.Rect.prototype.center=function(){return new Misc.Point(.5*(this.left()+this.right()),.5*(this.top()+this.bottom()))},Misc.Rect.prototype.moveTopLeft=function(e){var t=this.width(),n=this.height();this.setLeft(e.x),this.setTop(e.y),this.setRight(e.x+t),this.setBottom(e.y+n)},Misc.Rect.prototype.moveBottomRight=function(e){var t=this.width(),n=this.height();this.setRight(e.x),this.setBottom(e.y),this.setLeft(e.x-t),this.setTop(e.y-n)},Misc.Rect.prototype.moveCenter=function(e){var t=this.width(),n=this.height();this.setRight(e.x+.5*t),this.setBottom(e.y+.5*n),this.setLeft(e.x-.5*t),this.setTop(e.y-.5*n)},Misc.Rect.prototype.intersects=function(e){var t=Math.max(this.left(),e.left()),n=this.left()+this.width(),r=e.left()+e.width();if(Math.min(n,r)>t){var i=Math.max(this.top(),e.top()),a=this.top()+this.height(),s=e.top()+e.height();if(Math.min(a,s)>i)return!0}return!1},Misc.Rect.prototype.intersected=function(e){if(e.contains(new Misc.Point(this.left(),this.top()),!1)||e.contains(new Misc.Point(this.right(),this.top()),!1)||e.contains(new Misc.Point(this.right(),this.bottom()),!1)||e.contains(new Misc.Point(this.left(),this.bottom()),!1)||this.contains(new Misc.Point(e.left(),e.top()),!1)||this.contains(new Misc.Point(e.right(),e.top()),!1)||this.contains(new Misc.Point(e.right(),e.bottom()),!1)||this.contains(new Misc.Point(e.left(),e.bottom()),!1)){var t=Math.max(this.left(),e.left()),n=Math.max(this.top(),e.top()),r=Math.min(this.right()-t,e.right()-t),i=Math.min(this.bottom()-n,e.bottom()-n);return new Misc.Rect(t,n,r,i)}return new Misc.Rect},Misc.Rect.prototype.adjusted=function(e,t,n,r){var i=new Misc.Point(this.left()+e,this.top()+t),a=new Misc.Point(this.right()+n,this.bottom()+r);return new Misc.Rect(i,a)},Misc.Rect.prototype.contains=function(e,t){return void 0===t||!0===t?e.x>this.left()&&e.y>this.top()&&e.x<this.right()&&e.y<this.bottom():e.x>=this.left()&&e.y>=this.top()&&e.x<=this.right()&&e.y<=this.bottom()},Misc.Rect.prototype.isEqual=function(e){var t=new Misc.Point(e.left(),e.top());if(new Misc.Point(this.left(),this.top()).isEqual(t)){var n=this.width()-e.width(),r=this.height()-e.height();return n*n+r*r<Misc.EPSILON}return!1},Misc.Rect.prototype.leftTop=function(){return new Misc.Point(this.left(),this.top())},Misc.Rect.prototype.topLeft=function(){return this.leftTop()},Misc.Rect.prototype.rightTop=function(){return new Misc.Point(this.right(),this.top())},Misc.Rect.prototype.leftBottom=function(){return new Misc.Point(this.left(),this.bottom())},Misc.Rect.prototype.rightBottom=function(){return new Misc.Point(this.right(),this.bottom())},Misc.Rect.prototype.bottomRight=function(){return this.rightBottom()},Misc.Rect.prototype.toString=function(){return"["+this.left()+", "+this.top()+", "+this.width()+", "+this.height()+"]"},Misc.Rect.prototype.isEmpty=function(){return this.width()<=0||this.height()<=0},Misc.Rect.prototype.x=function(){return this.left()},Misc.Rect.prototype.y=function(){return this.top()},Misc.Font=function(e,t,n,r,i){"object"==typeof e?(this.th=e.th,this.name=e.name,this.style=e.style,this.weight=e.weight,this.fontColor=e.fontColor):(this.th=12,this.name="Arial",this.style="normal",this.weight="normal",this.fontColor="black"),"object"!=typeof e&&(void 0!==i&&(this.fontColor=i),void 0!==r&&(this.weight=r),void 0!==n&&(this.style=n),void 0!==t&&(this.name=t),void 0!==e&&(this.th=e))},Misc.Font.prototype.textSize=function(e){if(""==e||void 0===e)return new Misc.Size(0,0);var t=$("<canvas />"),n=t[0].getContext("2d");n.font=this.weight+" "+this.style+" "+this.th+"px "+this.name;var r=1.16*n.measureText(e).width,i=n.measureText("M").width;return t.remove(),new Misc.Size(r,i)},Misc.Font.prototype.toString=function(){return"[th:"+this.th+", name:"+this.name+", style:"+this.style+", weight:"+this.weight+", color:"+this.fontColor+"]"},Misc.MPathElement=function(e,t,n){this.type=MoveToElement,this.x=0,this.y=0,void 0!==t&&(this.x=t),void 0!==n&&(this.y=n),void 0!==e&&(this.type=e)},Misc.MPathElement.prototype.toString=function(){return"[MPathElement: type("+this.type+"), point"+new Misc.Point(this.x,this.y)+"]"},Misc.MPath=function(){var e=[];this.data={},this.elements=function(){return e}},Misc.MPath.prototype.elementCount=function(){return this.elements().length},Misc.MPath.prototype.elementAt=function(e){return e<0||e>=this.elements().length?null:this.elements()[e]},Misc.MPath.prototype.moveTo=function(e,t){this.elements().push(new Misc.MPathElement(MoveToElement,e,t))},Misc.MPath.prototype.lineTo=function(e,t){this.elements().push(new Misc.MPathElement(LineToElement,e,t))},Misc.MPath.prototype.cubicTo=function(e,t,n,r,i,a){var s=this.elements();s.push(new Misc.MPathElement(CurveToElement,e,t)),s.push(new Misc.MPathElement(CurveToElement,n,r)),s.push(new Misc.MPathElement(CurveToElement,i,a))},Misc.MPath.prototype.toString=function(){return"[MPath: elementCount = "+this.elements().length+"]"},Misc.MPath.prototype.isEmpty=function(){return 0==this.elements().length},Misc.MPath.prototype.addRect=function(e){var t=this.elements();t.push(new Misc.MPathElement(MoveToElement,e.left(),e.top())),t.push(new Misc.MPathElement(LineToElement,e.right(),e.top())),t.push(new Misc.MPathElement(LineToElement,e.right(),e.bottom())),t.push(new Misc.MPathElement(LineToElement,e.left(),e.bottom())),t.push(new Misc.MPathElement(LineToElement,e.left(),e.top()))},Misc.MPath.prototype.addPolygon=function(e){if(e&&e.length){this.elements().push(new Misc.MPathElement(MoveToElement,e[0].x,e[0].y));for(var t=1;t<e.length;++t)this.elements().push(new Misc.MPathElement(LineToElement,e[t].x,e[t].y))}},Misc.MPath.prototype.boundingRect=function(){for(var e=0,t=0,n=0,r=0,i=!1,a=0;a<this.elements().length;a++){var s=this.elements()[a];switch(s.type){case LineToElement:case MoveToElement:case CurveToElement:i||(e=s.x,t=s.y,n=s.x,r=s.y,i=!0),e=Math.min(e,s.x),n=Math.max(n,s.x),t=Math.min(t,s.y),r=Math.max(r,s.y)}}return new Misc.Rect(e,t,n-e,r-t)},define("miscObjects",function(){}),function(e,t){"function"==typeof define&&define.amd?define("regression",t):"undefined"!=typeof module?module.exports=t():e.regression=t()}(this,function(){"use strict";function e(e,t){var n=e.reduce(function(e,t){return e+t[1]},0)/e.length,r=e.reduce(function(e,t){var r=t[1]-n;return e+r*r},0);return 1-e.reduce(function(e,n,r){var i=t[r],a=n[1]-i[1];return e+a*a},0)/r}function t(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}var n={linear:function(n,r,i){for(var a,s,o,l=[0,0,0,0,0],c=n.length,u=0;u<c;u++)null!==n[u][1]&&(l[0]+=n[u][0],l[1]+=n[u][1],l[2]+=n[u][0]*n[u][0],l[3]+=n[u][0]*n[u][1],l[4]+=n[u][1]*n[u][1]);return s=(c*l[3]-l[0]*l[1])/(c*l[2]-l[0]*l[0]),o=l[1]/c-s*l[0]/c,{r2:e(n,a=n.map(function(e){var t=e[0];return[t,s*t+o]})),equation:[s,o],points:a,string:"y = "+t(s,i.precision)+"x + "+t(o,i.precision)}},linearthroughorigin:function(n,r,i){for(var a,s,o=[0,0],l=0;l<n.length;l++)null!==n[l][1]&&(o[0]+=n[l][0]*n[l][0],o[1]+=n[l][0]*n[l][1]);return a=o[1]/o[0],{r2:e(n,s=n.map(function(e){var t=e[0];return[t,a*t]})),equation:[a],points:s,string:"y = "+t(a,i.precision)+"x"}},exponential:function(n,r,i){for(var a,s,o,l,c=[0,0,0,0,0,0],u=0;u<n.length;u++)null!==n[u][1]&&(c[0]+=n[u][0],c[1]+=n[u][1],c[2]+=n[u][0]*n[u][0]*n[u][1],c[3]+=n[u][1]*Math.log(n[u][1]),c[4]+=n[u][0]*n[u][1]*Math.log(n[u][1]),c[5]+=n[u][0]*n[u][1]);return a=c[1]*c[2]-c[5]*c[5],s=Math.exp((c[2]*c[3]-c[5]*c[4])/a),o=(c[1]*c[4]-c[5]*c[3])/a,{r2:e(n,l=n.map(function(e){var t=e[0];return[t,s*Math.exp(o*t)]})),equation:[s,o],points:l,string:"y = "+t(s,i.precision)+"e^("+t(o,i.precision)+"x)"}},logarithmic:function(n,r,i){for(var a,s,o,l=[0,0,0,0],c=n.length,u=0;u<c;u++)null!==n[u][1]&&(l[0]+=Math.log(n[u][0]),l[1]+=n[u][1]*Math.log(n[u][0]),l[2]+=n[u][1],l[3]+=Math.pow(Math.log(n[u][0]),2));return s=(c*l[1]-l[2]*l[0])/(c*l[3]-l[0]*l[0]),a=(l[2]-s*l[0])/c,{r2:e(n,o=n.map(function(e){var t=e[0];return[t,a+s*Math.log(t)]})),equation:[a,s],points:o,string:"y = "+t(a,i.precision)+" + "+t(s,i.precision)+" ln(x)"}},power:function(n,r,i){for(var a,s,o,l=[0,0,0,0],c=n.length,u=0;u<c;u++)null!==n[u][1]&&(l[0]+=Math.log(n[u][0]),l[1]+=Math.log(n[u][1])*Math.log(n[u][0]),l[2]+=Math.log(n[u][1]),l[3]+=Math.pow(Math.log(n[u][0]),2));return s=(c*l[1]-l[2]*l[0])/(c*l[3]-l[0]*l[0]),a=Math.exp((l[2]-s*l[0])/c),{r2:e(n,o=n.map(function(e){var t=e[0];return[t,a*Math.pow(t,s)]})),equation:[a,s],points:o,string:"y = "+t(a,i.precision)+"x^"+t(s,i.precision)}},polynomial:function(n,r,i){var a,s,o,l,c,u,h,d,f=[],p=[],m=0,v=0,g=n.length;for(s=void 0===r?3:r+1,o=0;o<s;o++){for(c=0;c<g;c++)null!==n[c][1]&&(m+=Math.pow(n[c][0],o)*n[c][1]);for(f.push(m),m=0,a=[],l=0;l<s;l++){for(c=0;c<g;c++)null!==n[c][1]&&(v+=Math.pow(n[c][0],o+l));a.push(v),v=0}p.push(a)}for(p.push(f),h=function(e,t){var n=0,r=0,i=0,a=0,s=0,o=e.length-1,l=new Array(t);for(n=0;n<o;n++){for(a=n,r=n+1;r<o;r++)Math.abs(e[n][r])>Math.abs(e[n][a])&&(a=r);for(i=n;i<o+1;i++)s=e[i][n],e[i][n]=e[i][a],e[i][a]=s;for(r=n+1;r<o;r++)for(i=o;i>=n;i--)e[i][r]-=e[i][n]*e[n][r]/e[n][n]}for(r=o-1;r>=0;r--){for(s=0,i=r+1;i<o;i++)s+=e[i][r]*l[i];l[r]=(e[o][r]-s)/e[r][r]}return l}(p,s),u=n.map(function(e){var t=e[0],n=h.reduce(function(e,n,r){return e+n*Math.pow(t,r)},0);return[t,n]}),d="y = ",o=h.length-1;o>=0;o--)d+=o>1?t(h[o],i.precision)+"x^"+o+" + ":1===o?t(h[o],i.precision)+"x + ":t(h[o],i.precision);return{r2:e(n,u),equation:h,points:u,string:d}},lastvalue:function(n,r,i){for(var a=[],s=null,o=0;o<n.length;o++)null!==n[o][1]&&isFinite(n[o][1])?(s=n[o][1],a.push([n[o][0],n[o][1]])):a.push([n[o][0],s]);return{r2:e(n,a),equation:[s],points:a,string:""+t(s,i.precision)}}};return function(e,t,r,i){var a="object"==typeof r&&void 0===i?r:i||{};return a.precision||(a.precision=2),"string"==typeof e?n[e.toLowerCase()](t,r,a):null}});var Static={},Enum={MousePatternCode:{MouseSelect1:0,MouseSelect2:1,MouseSelect3:2,MouseSelect4:3,MouseSelect5:4,MouseSelect6:5,MousePatternCount:6},KeyPatternCode:{KeySelect1:0,KeySelect2:1,KeyAbort:2,KeyLeft:3,KeyRight:4,KeyUp:5,KeyDown:6,KeyRedo:7,KeyUndo:8,KeyHome:9,KeyPatternCount:10},ScaleComponent:{Backbone:1,Ticks:2,Labels:4},Format:{RGB:0,Indexed:1},Mode:{FixedColors:0,ScaledColors:1},FitMode:{Auto:0,Spline:1,ParametricSpline:2}};Static.makeAbstract=function(e,t){if(e.constructor==t)throw new Error("Abstract classes can't be instantiated.")},Static.qBound=function(e,t,n){return Math.max(e,Math.min(t,n))},Array.prototype.mid=function(e,t=-1){return-1==t?this.slice(e+1):(t=Math.max(t,0),this.slice(e,e+t))},String.prototype.insertAt=function(e,t,n){return this.slice(0,e)+n+this.slice(e+Math.abs(t))},String.prototype.replaceAt=function(e,t){return this.substr(0,e)+t+this.substr(e+t.length)},Array.prototype.resize=function(e,t){for(;e>this.length;)this.push(t)},Array.prototype.containsPoint=function(e){for(var t=0;t<this.length;++t)if(this[t].isEqual(e))return!0;return!1},Static.MagnifierEnabled=1,Static.ZoomEnabled=2,Static.PanEnabled=4,Static.Locked=8,Static.LeftButtonDown=16,Static.DragCursor=32,Static.PanningInProgress=64,Static.MagnifierSearch=128,Static.ZoomerSearch=256,Static.PannerSearch=512,Static.NoRuler=1024,Static.Left=0,Static.Right=1,Static.Bottom=2,Static.Top=3,Static.LeftAndRight=75776,Static.BottomAndTop=153088,Static.NoTrackingText=0,Static.FullTrackingText=1,Static.PartialTrackingText=2,Static.ReadOnly=0,Static.Clickable=1,Static.Checkable=2,Static.ModeRole=0,Static.TitleRole=1,Static.IconRole=2,Static.UserRole=32,Static.NoRubberBand=0,Static.HLineRubberBand=1,Static.VLineRubberBand=2,Static.CrossRubberBand=3,Static.RectRubberBand=4,Static.EllipseRubberBand=5,Static.PolygonRubberBand=6,Static.UserRubberBand=100,Static.NoSelection=-1,Static.PointSelection=0,Static.RectSelection=1,Static.PolygonSelection=2,Static.AlwaysOff=0,Static.AlwaysOn=1,Static.ActiveOnly=2,Static.NoPen="noPen",Static.NoBrush="noBrush",Static.accuracyBase=3e5,Static.accuracyMaxSteps=.5*Static.accuracyBase;var _eps=1e-6,NoTick=-1,MinorTick=0,MediumTick=1,MajorTick=2,NTickTypes=3,BottomScale=0,TopScale=1,LeftScale=2,RightScale=3,Horizontal=1,Vertical=2,ScaleInterest=1,IncludeBorders=0,ExcludeMinimum=1,ExcludeMaximum=2,ExcludeBorders=3,XAxis=0,YAxis=1,ZAxis=2,yLeft=0,yRight=1,xBottom=2,xTop=3,axisCnt=4,Legend=1,AutoScale=2,Margins=4,NoCurve=-1,Lines=0,Sticks=1,Steps=2,Dots=3,UserCurve=100,Inverted=1,Fitted=2,RoundPoints=1,WeedOutPoints=2,FilterPoints=1,MinimizeMemory=2,NoLine=0,NoSymbol=-1,Ellipse=0,MRect=2,Diamond=3,Triangle=4,DTriangle=5,UTriangle=6,LTriangle=7,RTriangle=8,Cross=9,XCross=10,HLine=11,VLine=12,Star1=13,Star2=14,Hexagon=15,Path=16,Pixmap=17,MGraphic=18,SvgDocument=19,UserStyle=1e3;function insertLogBase(e,t){var n=e;if(e.includes(t))for(var r=t.replace("log","");-1!==n.indexOf(t);)for(var i=n.indexOf(t)+t.length,a=0,s=0;i<n.length;++i)if("("==n[i]&&a++,")"==n[i]&&s++,a==s){n=(n=n.insertAt(i,0,","+r)).replace(t,"log");break}return n}function logBaseAdjust(e){for(var t=["log2","log3","log4","log5","log6","log7","log8","log9","log10"],n=0;n<t.length;n++)e=insertLogBase(e,t[n]);return e}function EvaluateExp(e){var t,n=e;this.error=!1;var r=this;function i(){var e=Static.expandDefines(n);try{t=math.parse(e),n.includes("log")||(t=math.simplify(t))}catch(t){var i=parseInt(t.message.match(/(\d+)/)[0]);return Static.alert("Invalid character in function: "+e[i-1]),void(r.error=!0)}t=t.compile()}void 0!==n&&(n=logBaseAdjust(n),i()),this.setExpString=function(e){n=e,i()},this.getExpString=function(){return n},this.eval=function(e){this.error=!1;try{return t.eval(e)}catch(e){return this.errorMessage=e.message,this.error=!0,0}}}Static.NoButton=-1,Static.LeftButton=0,Static.MiddleButton=1,Static.MidButton=1,Static.RightButton=2,Static.Key_Escape=27,Static.Key_Plus=107,Static.Key_Minus=109,Static.Key_Ctrl=17,Static.Key_Shift=16,Static.Key_Return=13,Static.Key_Space=32,Static.Key_Left=37,Static.Key_Right=39,Static.Key_Up=38,Static.Key_Down=40,Static.Key_Undo=90,Static.Key_Redo=89,Static.Key_Home=36,Static.Key_I=73,Static.Key_O=79,Static.Key_unknown=-1,Static.NoModifier=0,Static.ShiftModifier=33554432,Static.ControlModifier=67108864,Static.AltModifier=134217728,Static.AlignRight=1,Static.AlignLeft=2,Static.AlignBottom=4,Static.AlignTop=8,Static.AlignCenter=16,Static.adjustForDecimalPlaces=function(e,t){void 0==t&&(t=5);var n=Math.pow(10,t);return Math.round(e*n)/n},Static.mFuzzyCompare=function(e,t){return Math.abs(e-t)<_eps},Static.m3FuzzyCompare=function(e,t,n){var r=Math.abs(1e-6*n);return t-e>r?-1:e-t>r?1:0},Static.bind=function(e,t,n){$(window).on(e,t,n)},Static.unbind=function(e,t){$(window).off(e,t)},Static.trigger=function(e,t){$(window).trigger(e,t)},Static.invert=function(e){e=[].slice.call(arguments).join(",").replace(/rgb\(|\)|rgba\(|\)|\s/gi,"").split(",");for(var t=0;t<e.length;t++)e[t]=(3===t?1:255)-e[t];return"rgb("+e.join(", ")+")"},Static.RGB2HTML=function(e,t,n){if("string"==typeof e){var r=e;r=r.replace("rgb(",""),e=parseInt(r),r=(r=r.replace(",","")).replace(e,""),t=parseInt(r),r=(r=r.replace(",","")).replace(t,""),n=parseInt(r)}if(void 0!==e.r){var i=e;e=e.r,t=i.g,n=i.b}return"#"+(16777216+n+256*t+65536*e).toString(16).substr(1)},Static.HTMLToRGB=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},Static.mRgb=function(e,t,n){return{r:e,g:t,b:n,toString:function(){return"rgb("+e+","+t+","+n+")"}}},Static.mRgba=function(e,t,n,r){return{r:e,g:t,b:n,a:r,toString:function(){return"rgb("+e+","+t+","+n+","+r+")"}}},Static.colorNameToHex=function(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return"r"==e[0]&&"g"==e[1]&&"b"==e[2]?Static.RGB2HTML(e):"#"==e[0]?e:void 0!==t[e.toLowerCase()]?t[e.toLowerCase()]:"#000000"},Static.sqr=function(e){return Math.pow(e,2)},Static.setElementIndex=function(e,t){var n=$(e).parent().children(),r=n[t];$(e).index()>t?(null==r&&(r=n[0]),r!=e&&null!=r&&$(r).before(e)):(null==r&&(r=n[n.length-1]),r!=e&&null!=r&&$(r).after(e))},Static.elementsFromPoint=function(e,t,n){var r,i=n[0],a=[];do{(r=document.elementFromPoint(e,t))!==i?(a.push(r),r.style.pointerEvents="none"):r=!1}while(r);return a.forEach(function(e){return e.style.pointerEvents="all"}),$(a)},Static.stopkeyPressPropagation=function(e){e.keydown(function(e){e.stopPropagation()})},window.matchMedia("print").addListener(function(e){e.matches?Static.trigger("beforePrint"):Static.trigger("afterPrint")}),window.onbeforeprint=function(e){Static.trigger("beforePrint")},window.onafterprint=function(e){Static.trigger("afterPrint")},Static.Cancel=0,Static.No=1,Static.Yes=2,Static.alertDlg=function(){var e=$('<div class="modal fade" id="alert_Modal" role="dialog">            <div id="dlg" class="modal-dialog">            \x3c!-- Modal content--\x3e            <div class="modal-content">            <div class="modal-header">            <button type="button" class="close" data-dismiss="modal">&times;</button>            <h4 class="modal-title"><b>Alert</b></h4>            </div>            <div class="modal-body">            <p id="msg"></p>            </div>            <div id="alertDlgFooter1" class="modal-footer">            <button type="button" class="btn btn-default" data-dismiss="modal">Ok</button>            </div>            <div id="alertDlgFooter2" class="modal-footer">            <button id="yes" type="button" class="btn btn-default">Yes</button>            <button id="no" type="button" class="btn btn-default">No</button>            <button id="cancel" type="button" class="btn btn-default">Cancel</button>            </div>            </div>            </div>            </div>');$("body").append(e),e.css("z-index",1e9),this.alert=function(t,n){$("#alertDlgFooter2").hide(),$("#alertDlgFooter1").show(),$("#msg").text(t),"small"==n?$("#dlg").addClass("modal-sm"):$("#dlg").removeClass("modal-sm"),e.modal({backdrop:"static"})};var t=this;this.alertYesNo=function(t,n,r){$(".close").hide(),this.alertYesCb=n,$("#alertDlgFooter1").hide(),$("#alertDlgFooter2").show(),$("#msg").text(t),"small"==r?$("#dlg").addClass("modal-sm"):$("#dlg").removeClass("modal-sm"),e.modal({backdrop:"static"})},$("#yes").click(function(){$(".close").click(),t.alertYesCb(Static.Yes)}),$("#no").click(function(){$(".close").click(),t.alertYesCb(Static.No)}),$("#cancel").click(function(){$(".close").click(),t.alertYesCb(Static.Cancel)})},Static.alert=function(e,t){void 0==Static.alertObj&&(Static.alertObj=new Static.alertDlg),Static.alertObj.alert(e,t)},Static.alertYesNo=function(e,t,n){void 0==Static.alertObj&&(Static.alertObj=new Static.alertDlg),Static.alertObj.alertYesNo(e,t,n)},Static.promptDlg=function(){var e=$('<div class="modal fade" id="promptModal" role="dialog">            <div id="prompt_dlg" class="modal-dialog">            \x3c!-- Modal content--\x3e            <div class="modal-content">            <div class="modal-header">            <button type="button" class="close" data-dismiss="modal"></button>            <h4 class="modal-title" id="prompt_title">Alert</h4>            </div>            <div class="modal-body">            <input id="prompt_msg" style="width:100%" autofocus />            </div>            <div class="modal-footer">            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>            <button id="prompt_ok" type="button" class="btn btn-default">Ok</button>            </div>            </div>            </div>            </div>');$("body").append(e);var t=this;this.prompt=function(t,n,r,i){"small"==i&&$("#prompt_dlg").addClass("modal-sm"),$("#prompt_title").text(t),$("#prompt_msg").val(n),$("#prompt_msg").select(),this.cb=r,e.modal({backdrop:"static"})},$("#prompt_ok").on("click",function(){t.cb($("#prompt_msg").val())?$(".close").click():$("#prompt_msg").select()})},Static.prompt=function(e,t,n,r){void 0==Static.promptObj&&(Static.promptObj=new Static.promptDlg),Static.promptObj.prompt(e,t,n,r)},Static.isMobile=function(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i.test(navigator.userAgent||navigator.vendor||window.opera)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test((navigator.userAgent||navigator.vendor||window.opera).substr(0,4))},Static.expandDefines=function(e){for(var t=purgeAndMarkKeywords(t=e.slice()),n=0;n<Static.m_defines.length;n++)for(var r=0;r<Static.m_defines.length;r++)for(;-1!==t.search(Static.m_defines[r].name);)t=t.replace(Static.m_defines[r].name,purgeAndMarkKeywords(Static.getDefined(Static.m_defines[r].name)));return t=replaceKeywordMarkers(t)};var keywords=["asinh","acosh","atanh","acoth","asech","acsch","asin","acos","atan","acot","asec","acsc","sinh","cosh","tanh","coth","sech","csch","sin","cos","tan","sec","csc","cot","ln","log","log2","log3","log4","log5","log6","log7","log8","log9","log10","deg","pi","PI","e","E"];function containsKeyword(e){for(var t=0;t<keywords.length;t++)if(-1!=e.indexOf(keywords[t]))return keywords[t];return null}function purgeKewords(e){for(var t=0;t<keywords.length;++t)for(;-1!=e.indexOf(keywords[t]);)e=e.replace(keywords[t],"");return e}var keywordMarkers=[];function purgeAndMarkKeywords(e){for(var t=0;t<keywords.length;++t)for(;-1!=e.indexOf(keywords[t]);){var n="%"+keywordMarkers.length+"%";e=e.replace(keywords[t],n),keywordMarkers.push({marker:n,keyword:keywords[t]})}return e}function replaceKeywordMarkers(e){for(var t=0;t<keywordMarkers.length;++t)for(;-1!=e.indexOf(keywordMarkers[t].marker);)e=e.replace(keywordMarkers[t].marker,keywordMarkers[t].keyword);return keywordMarkers=[],e}function findIndepVar(e){for(var t=0,n=purgeKewords(e);t<n.length;){for(var r=n.charAt(t),i="";-1!="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(r)&&t<n.length;)i+=r,++t,r=n.charAt(t);if(1===i.length)return i;++t}}function regress(e,t,n,r,i){"linear"==t&&r&&(t="linearthroughorigin");for(var a=e.data().samples(),s=[],o=0;o<a.length;++o)s.push([a[o].x,a[o].y]);return Static.regression(t,s,n,i)}function integrate(e,t,n,r,i){Static.total_area=0,Static.total_volume=0,r=r||!1;for(var a=t;a<n;a+=i){var s=a+i/2;s>n&&(i-=s-n);var o=e(a+i/2);r?Static.total_volume+=o*i*o*Math.PI:Static.total_area+=o*i}return r?Static.total_volume:Static.total_area}define("static",["regression"],function(e){Static.regression=e}),$("body").on("contextmenu",function(e){e.preventDefault()}),integrate.transform=function(e,t,n){if(!(e[1]instanceof t.expression.node.SymbolNode))throw new Error("Second argument must be a symbol");var r=e[1].name,i=e[2].compile().eval(n),a=e[3].compile().eval(n),s=e[4]&&e[4].compile().eval(n),o=e[5]&&e[5].compile().eval(n),l=Object.create(n),c=e[0].compile();return integrate(function(e){return l[r]=e,c.eval(l)},i,a,s,o)},integrate.transform.rawArgs=!0,math.import({integrate:integrate}),Static.isAlpha=function(e){return(e=e.toLowerCase().charCodeAt(0))>96&&e<122},Static.printFn=function(){window.print()},Static.calcStep=function(e){return(e.maxXValue()-e.minXValue())/Static.accuracyMaxSteps},Static.addCSS=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=e,n.media="all",t.appendChild(n)},Static.m_defines=[],Static.define=function(e,t){Static.m_defines.push({name:e,value:t})},Static.containsDefine=function(e){for(var t=0;t<Static.m_defines.length;t++)if(-1!=e.indexOf(Static.m_defines[t].name))return Static.m_defines[t].name;for(t=0;t<Static.m_defines.length;t++)if(-1!=Static.m_defines[t].name.indexOf(e))return Static.m_defines[t].name;return null},Enum.DefineError={noError:0,start:1,contain:2,keyword:3},Static.validateDefineName=function(e){if(!Static.isAlpha(e[0]))return{errorType:Enum.DefineError.start,name:e};var t=Static.containsDefine(e);if(t)return{errorType:Enum.DefineError.contain,name:t};var n=containsKeyword(e);return n?{errorType:Enum.DefineError.keyword,name:n}:{errorType:Enum.DefineError.noError,name:e}},Static.getDefined=function(e){for(var t=0;t<Static.m_defines.length;t++)if(Static.m_defines[t].name===e)return"("+Static.m_defines[t].value+")";return console.warn('"'+e+'" is not predefined!'),""};class DefinesDlg{constructor(){var e=_.once(function(){function e(){n($("#definesName").val())?($("#definesRemove").attr("disabled",!1),$("#definesRemoveAll").attr("disabled",!1)):($("#definesRemove").attr("disabled",!0),$("#definesRemoveAll").attr("disabled",!0))}function a(e){var n=e.fileName.split(".")[1];if("xls"==n||"xlsx"==n||"txt"==n){var r=null;if("xls"==n||"xlsx"==n){var i=XLSX.read(e.content,{type:"binary"}),a=i.SheetNames[0];r=XLSX.utils.sheet_to_csv(i.Sheets[a]).split("\n")}else r=e.content.split("\n");for(var s=!1,o=0;o<r.length;o++){var l=r[o].split(",");if(2===l.length){var c=l[0],u=l[1];if(c.length&&u.length){var h=Static.validateDefineName(c);!s&&h.errorType>Enum.DefineError.noError&&(s=!0),h.errorType==Enum.DefineError.noError&&t(c,u)}}}s&&Static.alert("One or more invalid names found or an attempt to load the same file more than once.")}$("#definesUpload")[0].value=""}$("body").append($('                        <div class="modal fade" id="definesModal" role="dialog">                        <div class="modal-dialog modal-md">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal">&times;</button>                        <h4 class="modal-title">Defines</h4>                        </div>                        <div class="modal-body">                        <div class="row">                        <div class="col-md-3">Name:</div>                        <div class="col-md-8">                        <input id="definesName" type="text" style="width:100%">                        </input>                        </div>                        </div>                        <br>                        <div class="row">                        <div class="col-md-3">Value:</div>                        <div class="col-md-8">                        <input id="definesValue" type="text" style="width:100%">                        </input>                        </div>                        </div>                        <br>                                                <table>                        <tr style="border: 1px solid black">                        <th style="border: 0px"> Name</th>                        <th style="text-align: right; border: 0px">Value </th>                        </tr>                        </table>                        <div style="position:relative; overflow: auto;height: 100px">                        <table id="definesTable" style="border: 1px solid black">                        <col width="15%">                        </table>                        </div>                                                <div class="modal-footer">\t\t\t\t\t\t<button id="definesUploadButton" type="button" class="btn btn-default">\t\t\t\t\t\tLoad\t\t\t\t\t\t</button>                        <label>                        <input id="definesUpload" type="file" style="display: none;" name="files[]" multiple />                        </label>                        <button id="definesAdd" type="button" class="btn btn-default" >Add</button>                        <button id="definesRemove" type="button" class="btn btn-default" >Remove</button>                        <button id="definesRemoveAll" type="button" class="btn btn-default" >Remove All</button>                        <button type="button" class="btn btn-default"  data-dismiss="modal">Close</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#definesAdd").click(i),$("#definesRemove").click(r),$("#definesAdd").attr("disabled",!0),$("#definesRemove").attr("disabled",!0),Static.m_defines.length||($("#definesRemoveAll").attr("disabled",!0),$("#definesRemove").attr("disabled",!0)),$("#definesRemoveAll").on("click",function(){for(var e=0;e<Static.m_defines.length;e++){var t="#"+Static.m_defines[e].name;$(t).remove()}$("#definesRemoveAll").attr("disabled",!0),$("#definesRemove").attr("disabled",!0),Static.m_defines=[]}),$("#definesUploadButton").on("click",function(){$("#definesUpload").trigger("click")}),$("#definesUpload").on("change",function(e){for(var t,n=e.target.files,r=0;t=n[r];r++){var i=t.name.split(".")[1];if("txt"==i||"xls"==i||"xlsx"==i||"plt"==i){var s=new FileReader;s.onload=function(e){return function(t){a({fileName:e.name,content:t.target.result})}}(t),"xls"==i||"xlsx"==i?s.readAsBinaryString(t):s.readAsText(t)}}}),$("#definesName").on("input",function(t){if($("#definesName").val().length&&_.isString($("#definesName").val())){var r=n($("#definesName").val());r&&$("#definesValue").val(r.value)}$("#definesName").val().length&&_.isString($("#definesName").val())&&$("#definesValue").val().length&&_.isString($("#definesValue").val())?(e(),$("#definesAdd").attr("disabled",!1)):($("#definesAdd").attr("disabled",!0),$("#definesRemove").attr("disabled",!0),$("#definesRemoveAll").attr("disabled",!0))}),$("#definesValue").on("input",function(t){$("#definesName").val().length&&_.isString($("#definesName").val())&&$("#definesValue").val().length&&_.isString($("#definesValue").val())?(e(),$("#definesAdd").attr("disabled",!1)):($("#definesAdd").attr("disabled",!0),$("#definesRemove").attr("disabled",!0),$("#definesRemoveAll").attr("disabled",!0))});for(var s=0;s<Static.m_defines.length;s++)$("#definesTable").append($("<tr id="+Static.m_defines[s].name+' style="border: 1px solid black">                            <td style="border: 1px solid black">'+Static.m_defines[s].name+'</td>                            <td style="border: 1px solid black">'+Static.m_defines[s].value+"</td>                            </tr>"))});function t(e,t){e=e.trim(),t=t.trim();var r=n(e);r?(r.value=t,$("#"+e)[0].children[1].innerText=t):(Static.define(e,t),$("#definesRemoveAll").attr("disabled",!1),$("#definesTable").append($("<tr id="+e+' style="border: 1px solid black">                        <td style="border: 1px solid black">'+e+"</td>                        <td>"+t+"</td>                        </tr>"))),$("#definesName").val(""),$("#definesValue").val(""),$("#definesName").focus(),$("#definesAdd").attr("disabled",!0),$("#definesRemove").attr("disabled",!0)}function n(e){for(var t=0;t<Static.m_defines.length;t++)if(Static.m_defines[t].name===e)return Static.m_defines[t];return null}function r(){var e="#"+$("#definesName").val();!function(e){var t=Static.m_defines.slice();Static.m_defines=[];for(var n=0;n<t.length;n++)t[n].name!==e&&Static.m_defines.push(t[n]);Static.m_defines.length||($("#definesRemove").attr("disabled",!0),$("#definesRemoveAll").attr("disabled",!0),$("#definesAdd").attr("disabled",!0))}($("#definesName").val()),$(e).remove(),$("#definesName").val(""),$("#definesValue").val(""),$("#definesName").focus(),$("#definesRemove").attr("disabled",!0),$("#definesAdd").attr("disabled",!0)}function i(){var e=$("#definesName").val(),n=Static.validateDefineName($("#definesName").val());return n.errorType==Enum.DefineError.start?(Static.alert('Define name,"'+e+'", must start with alpha character.'),$("#definesName").val(""),void(Static.m_defines.length&&$("#definesRemoveAll").attr("disabled",!1))):n.errorType==Enum.DefineError.contain?(Static.alert('Define name,"'+e+'", contains, or is part of, the earlier define, "'+n.name+'".'),$("#definesName").val(""),void(Static.m_defines.length&&$("#definesRemoveAll").attr("disabled",!1))):n.errorType==Enum.DefineError.keyword?(Static.alert('Define name,"'+e+'", contains "'+n.name+'" keyword!'),$("#definesName").val(""),void(Static.m_defines.length&&$("#definesRemoveAll").attr("disabled",!1))):void t(e,$("#definesValue").val())}this.defines=function(){e(),$("#definesModal").modal({backdrop:"static"})}}}var definesDlg=null;Static.defines=function(){definesDlg||(definesDlg=new DefinesDlg),definesDlg.defines()};class PlotItem{constructor(e){Static.Rtti_PlotItem=0,Static.Rtti_PlotGrid=1,Static.Rtti_PlotScale=2,Static.Rtti_PlotLegend=3,Static.Rtti_PlotMarker=4,Static.Rtti_PlotCurve=5,Static.Rtti_PlotSpectroCurve=6,Static.Rtti_PlotIntervalCurve=7,Static.Rtti_PlotHistogram=8,Static.Rtti_PlotSpectrogram=9,Static.Rtti_PlotSVG=10,Static.Rtti_PlotTradingCurve=11,Static.Rtti_PlotBarChart=12,Static.Rtti_PlotMultiBarChart=13,Static.Rtti_PlotShape=14,Static.Rtti_PlotTextLabel=15,Static.Rtti_PlotZone=16,Static.Rtti_PlotUserItem=1e3;this.plotId="";var t,n=null,r=null,i=($("#centralDiv"),!0),a=0,s=0,o=xBottom,l=yLeft,c=e||"";this.rtti=Static.Rtti_PlotItem;var u=new Misc.Size(10,10);this.getLegendIconSize=function(){return u},this.setLegendIconSize=function(e){u=e,n&&n.updateLegend(this)},this.setItemInterest=function(e,n){n?t|=e:t&=~e,this.itemChanged()},this.testItemInterest=function(e){return t&e},this.plot=function(){return n},this.title=function(){return c},this.setTitle=function(e){c!==e&&(c=e,this.legendChanged(),this.itemChanged(),Static.trigger("titleChange",[this,e]))},this.clearCanvas=function(){this.getContext().clearRect(0,0,r[0].width,r[0].height)},this.attach=function(e){e!=n&&(n&&(this.getContext().clearRect(0,0,r[0].width,r[0].height),r.hide(),r=null,n.attachItem(this,!1)),(n=e)&&(null===r&&(r=$("<canvas />").attr({style:"position: absolute; background-color: transparent"}),n.getLayout().getCentralDiv().append(r),r.css({"border-radius":"inherit"}),0!=s&&r.css("zIndex",s)),n.attachItem(this,!0)))},this.detach=function(){this.attach(null)},this.setZ=function(e){s!==e&&(s=e,r&&r.css("zIndex",s),this.itemChanged())},this.getZ=function(e){return s},this.getCanvas=function(){return r},this.syncSizes=function(){var e=n.getLayout().getCentralDiv();r[0].width=parseFloat(e.css("width")),r[0].height=parseFloat(e.css("height"))},this.getContext=function(){return this.syncSizes(),r[0].getContext("2d")},this._setAxes=function(e,t){e!=xBottom&&e!=xTop||(o=e),t!=yLeft&&t!=yRight||(l=t),this.itemChanged()},this.setItemAttribute=function(e,t){t?a|=e:a&=~e,e==Legend&&this.legendChanged(),this.itemChanged()},this.testItemAttribute=function(e){return a&e},this.show=function(){this.setVisible(!0)},this.hide=function(){this.setVisible(!1)},this.doSetVisible=function(e){e!==i&&(i=e,e?r.show():r.hide(),this.itemChanged(),Static.trigger("visibilityChange",[this,e]))},this.isVisible=function(){return i},this.itemChanged=function(){n&&n.autoRefresh()},this.legendChanged=function(){this.testItemAttribute(Legend)&&n&&n.updateLegend(this)},this._setXAxis=function(e){e!=xBottom&&e!=xTop||(o=e,this.itemChanged())},this._setYAxis=function(e){e!=yLeft&&e!=yRight||(l=e,this.itemChanged())},this.xAxis=function(){return o},this.yAxis=function(){return l},this.getCanvasRect=function(){return this.syncSizes(),new Misc.Rect(new Misc.Point,r[0].width,r[0].height)},this.legendIconSize=function(){return this.getLegendIconSize()},this.legendIcon=function(e,t){return null},this.defaultIcon=function(e,t){var n=null;if(t.width>0&&t.height>0){var r=new Misc.Rect(0,0,t.width,t.height);n=new GraphicUtil.Graphic(null,t.width+1,t.height+1),new GraphicPainter(n).fillRect(r,e)}return n},this.legendData=function(){var e=new LegendData,t=this.title();e.setValue(Static.TitleRole,t);var n=this.legendIcon(0,this.legendIconSize());return n&&e.setValue(Static.IconRole,n),[e]},this.toString=function(){return'[PlotItem "'+this.plotId+'"]'}}boundingRect(){return new Misc.Rect}setVisible(e){this.doSetVisible(e)}setXAxis(e){this._setXAxis(e)}setYAxis(e){this._setYAxis(e)}setAxes(e,t){this._setAxes(e,t)}draw(e,t){console.log("No drawing mehod define in subclass")}}define("plotItem",["static"],function(){});class PlotMarker extends PlotItem{constructor(e){super(e);var t="",n=new Misc.Font,r=Static.AlignCenter,i=Horizontal,a=2,s=new Misc.Pen,o=null,l=NoLine,c=0,u=0;this.rtti=Static.Rtti_PlotMarker,this.labelFont=function(){return n},this.setLabelFont=function(e){n=e},this.value=function(){return new Misc.Point(c,u)},this.xValue=function(){return c},this.yValue=function(){return u},this.setValue=function(e,t){if("object"==typeof e){var n=e;e=n.x,t=n.y}e==c&&t==u||(c=e,u=t,this.plot()&&this.plot().autoRefresh())},this.setXValue=function(e){this.setValue(e,u)},this.setYValue=function(e){this.setValue(c,e)},this.setLabel=function(e){e!=t&&(t=e)},this.label=function(){return t},this.setLabelAlignment=function(e){e!==r&&(r=e)},this.labelAlignment=function(){return r},this.setLabelOrientation=function(e){e!=i&&(i=e)},this.labelOrientation=function(){return i},this.setSpacing=function(e){e<0&&(e=0),e!=a&&(a=e)},this.spacing=function(){return a},this.setSymbol=function(e){o=e},this.symbol=function(){return o},this.draw=function(e,t){var n=this.getCanvasRect(),r=new Misc.Point(e.transform(c),t.transform(u)),i=this.getContext();if(this.drawLines(i,n,r),o&&o.style()!==NoSymbol){var a=o.size();n.adjusted(-a.width,-a.height,a.width,a.height).contains(r)&&o.drawSymbol(i,r)}this.drawLabel(i,n,r)},this.drawLabel=function(e,c,u){if(""!==t){var h=r,d=u,f=new Misc.Size(0,0);switch(l){case VLine:r&Static.AlignTop?(d.y=c.top(),h&=~Static.AlignTop,h|=Static.AlignBottom):r&Static.AlignBottom?(d.y=c.bottom()-1,h&=~Static.AlignBottom,h|=Static.AlignTop):d.y=c.center().y;break;case HLine:r&Static.AlignLeft?(d.x=c.left(),h&=~Static.AlignLeft,h|=Static.AlignRight):r&Static.AlignRight?(d.x=c.right()-1,h&=~Static.AlignRight,h|=Static.AlignLeft):d.x=c.center().x;break;default:if(o&&o.style()!==NoSymbol){var p=o.size();f=new Misc.Size((p.width+1)/2,(p.height+1)/2)}}var m=s.width/2;0==m&&(m=.5);var v=a,g=Math.max(m,f.width),b=Math.max(m,f.height),S=n.textSize(t);h&Static.AlignLeft?(d.x-=g+v,d.x-=i==Vertical?S.height:S.width):h&Static.AlignRight?(d.x+=g+v,i==Vertical&&(d.x+=S.height)):d.x-=i==Vertical?S.height/2:S.width/2,h&Static.AlignTop?(d.y-=b+v,i!=Vertical&&(d.y-=S.height)):h&Static.AlignBottom?(d.y+=b+v,i==Vertical&&(d.y+=S.width)):i==Vertical?d.y+=S.width/2:d.y-=S.height/2;var y=new PaintUtil.Painter(e);y.translate(d.x,d.y),y.setFont(n);var x=new Misc.Rect(0,0,S.width,S.height);i==Vertical?y.drawVerticalText(t,x.left()+.3*S.height,x.bottom()-.75*S.width):y.drawText(t,x.left(),x.bottom()-2)}},this.drawLines=function(e,t,n){if(l!=NoLine){var r=new PaintUtil.Painter(e);if(r.setPen(s),l==HLine||l==Cross){var i=n.y;r.drawLine(t.left(),i,t.right()-1,i)}if(l==VLine||l==Cross){var a=n.x;r.drawLine(a,t.top(),a,t.bottom()-1)}r=null}},this.setLineStyle=function(e){e!=l&&(l=e)},this.lineStyle=function(){return l},this.setLinePen=function(e){s=e,this.plot()&&this.plot().autoRefresh()},this.linePen=function(){return s},this.setZ(30),this.toString=function(){return"[PlotMarker]"},this.legendIcon=function(e,t){if(0===t.width&&0===t.height)return null;var n=new GraphicUtil.Graphic(null,t.width,t.height),r=new PaintUtil.Painter(n);return this.lineStyle(),this.symbol()&&this.symbol().drawGraphicSymbol(r,new Misc.Point(t.width,t.height),t),r=null,n}}}define("plotMarker",["static","plotItem"],function(){});class CGMarker extends PlotMarker{constructor(){super("cgMarker@12345");var e=this;e.setSymbol(new class extends Symbol{constructor(){super(),this.type="arrow",this.setPen(new Misc.Pen("black",2)),this.setBrush(new Misc.Brush("red"));var e=new Misc.MPath;e.moveTo(5,10),e.lineTo(5,0),e.moveTo(0,5),e.lineTo(10,5),this.setPath(e),this.setPinPoint(new Misc.Point(6,6)),this.setSize(new Misc.Size(12,12))}}),e.setLabel("CG"),e.setLabelAlignment(Static.AlignCenter|Static.AlignBottom);var t=!1;Static.bind("watchEnabled",function(n,r,i){"Area below curve"===r.name()&&(e.setVisible(i),t=i)}),Static.bind("showSidebar",function(n,r,i){i&&t?e.setVisible(!0):e.setVisible(!1)}),Static.bind("currentCurveChanged",function(t,n){void 0!=n&&e.setAxes(n.xAxis(),n.yAxis())})}}class WatchCurveName extends Watch{constructor(){super(),this.name=function(){return"Curve name"},this.computeWatch=function(){this._value=this._curveName}}}class WatchLeftRulerPosition extends Watch{constructor(e){super(e,Static.Left);var t=this;this.name=function(){return"Left ruler position"},this.valueType="number",this.computeWatch=function(){this._rulerLeft==Number.MAX_VALUE?this._value="Invalid":this._value=Static.adjustForDecimalPlaces(this._rulerLeft,this._curve.plot().axisDecimalPlaces(this._curve.xAxis()))},this.cb=function(){var e=t._value,n=t._rulerGroup.setPosition(0,$(this).val());e!==n?Static.trigger("positionChanged",[t._rulerGroup.ruler(0),n]):$(this).val(n)}}}class WatchRightRulerPosition extends Watch{constructor(e){super(e,Static.Right);var t=this;this.name=function(){return"Right ruler position"},this.valueType="number",this.computeWatch=function(){this._rulerLeft==Number.MAX_VALUE?this._value="Invalid":this._value=Static.adjustForDecimalPlaces(this._rulerRight,this._curve.plot().axisDecimalPlaces(this._curve.xAxis()))},this.cb=function(){var e=t._value,n=t._rulerGroup.setPosition(1,$(this).val());e!==n?Static.trigger("positionChanged",[t._rulerGroup.ruler(1),n]):$(this).val(n)}}}class WatchBottomRulerPosition extends Watch{constructor(e){super(e,Static.Bottom);var t=this;this.valueType="number",this.name=function(){return"Bottom ruler position"},this.computeWatch=function(){this._rulerBottom==Number.MAX_VALUE?this._value="Invalid":this._value=Static.adjustForDecimalPlaces(this._rulerBottom,this._curve.plot().axisDecimalPlaces(this._curve.xAxis()))},this.cb=function(){var e=t._value,n=t._rulerGroup.setPosition(2,$(this).val());e!==n?Static.trigger("positionChanged",[t._rulerGroup.ruler(2),n]):$(this).val(n)}}}class WatchTopRulerPosition extends Watch{constructor(e){super(e,Static.Top);var t=this;this.valueType="number",this.name=function(){return"Top ruler position"},this.computeWatch=function(){this._rulerTop==Number.MAX_VALUE?this._value="Invalid":this._value=Static.adjustForDecimalPlaces(this._rulerTop,this._curve.plot().axisDecimalPlaces(this._curve.xAxis()))},this.cb=function(){var e=t._value,n=t._rulerGroup.setPosition(3,$(this).val());e!==n?Static.trigger("positionChanged",[t._rulerGroup.ruler(3),n]):$(this).val(n)}}}class WatchSlope extends Watch{constructor(){super(Static.Left),this.name=function(){return"Slope at left ruler"},this.computeWatch=function(){var e=this._curve.plot().getNonExponentNotationLimits();if(this._rulerLeft!=Number.MAX_VALUE&&isFinite(this._rulerLeft)){if(this._curve.expandedFn&&!this._curve.expandedFn.includes("log")){var t=this._curve.expandedFn;if("z"!=this._curve.variable)for(;-1!=t.indexOf(this._curve.variable);)t=t.replace(this._curve.variable,"z");if(this._curve.coeffs)for(var n=0;n<this._curve.coeffs.length;++n)for(;-1!=t.indexOf(this._curve.coeffs[n]);)t=t.replace(this._curve.coeffs[n],this._curve.coeffsVal[n]);var r=Math.max(this._curve.plot().axisDecimalPlaces(this._curve.yAxis()),this._curve.plot().axisDecimalPlaces(this._curve.xAxis()));return this._value=math.derivative(t,"z").eval({z:this._rulerLeft}),this._value=Static.adjustForDecimalPlaces(this._value,r),void((this._value>e.upper||this._value<e.lower)&&(this._value=this._value.toExponential(r)))}var i=this._curve.dataSize(),a=this._rulerLeft;for(r=Math.max(this._curve.plot().axisDecimalPlaces(this._curve.yAxis()),this._curve.plot().axisDecimalPlaces(this._curve.xAxis())),n=0;n<i;++n)if(this._curve.sample(n).x>a){var s=this._curve.sample(n),o=this._curve.sample(n-1);return this._value=(s.y-o.y)/(s.x-o.x),this._value=Static.adjustForDecimalPlaces(this._value,r),void((this._value>e.upper||this._value<e.lower)&&(this._value=this._value.toExponential(r)))}}else this._value="Invalid"}}}class WatchAreaBelowCurve extends Watch{constructor(){super(Static.LeftAndRight);var e=null,t=null;this.name=function(){return"Area below curve"},this.computeWatch=function(){var n=this._curve.plot().getNonExponentNotationLimits();if(e||((e=new CGMarker).setAxes(this._curve.xAxis(),this._curve.yAxis()),t=this._curve.plot(),e.attach(t)),this._rulerLeft!=Number.MAX_VALUE&&isFinite(this._rulerLeft)&&this._rulerRight!=Number.MAX_VALUE&&isFinite(this._rulerRight)){if(this._curve.expandedFn){if(p=logBaseAdjust(p=this._curve.expandedFn),"z"!=this._curve.variable)for(;-1!=p.indexOf(this._curve.variable);)p=p.replace(this._curve.variable,"z");if(this._curve.coeffs)for(var r=0;r<this._curve.coeffs.length;++r)for(;-1!=p.indexOf(this._curve.coeffs[r]);)p=p.replace(this._curve.coeffs[r],this._curve.coeffsVal[r]);var i=Math.max(this._curve.plot().axisDecimalPlaces(this._curve.yAxis()),this._curve.plot().axisDecimalPlaces(this._curve.xAxis())),a=Static.calcStep(this._curve);this._value=math.eval("integrate("+p+", z,"+this._rulerLeft+","+this._rulerRight+",false,"+a+")");var s=math.eval("integrate((("+p+")*("+p+")), z,"+this._rulerLeft+","+this._rulerRight+",false,"+a+")"),o=math.eval("integrate(z * ("+p+"), z,"+this._rulerLeft+","+this._rulerRight+",false,"+a+")"),l=this._value;this._value=Static.adjustForDecimalPlaces(this._value,i),(this._value>n.upper||this._value<n.lower)&&(this._value=this._value.toExponential(i));var c=Static.adjustForDecimalPlaces(s/(2*l),i),u=Static.adjustForDecimalPlaces(o/l,i);return(c>n.upper||c<n.lower)&&(c=c.toExponential(i)),(u>n.upper||u<n.lower)&&(u=u.toExponential(i)),void(Static.watchCentroidWithArea?(0==this._value&&(u=c="Infinity"),this._value+=" centroid:("+u+", "+c+")",e.setValue(u,c),e.setVisible(!0)):e.setVisible(!1))}var h=this._curve.dataSize();this._value=0;for(s=0,o=0,r=1;r<h;++r){var d=this._curve.sample(r),f=this._curve.sample(r-1),p=Utility.linearEquationFromPoints(f,d),m=f.x;if(!(d.x<this._rulerLeft)&&!(f.x>this._rulerRight)){m<this._rulerLeft&&(m=this._rulerLeft);var v=d.x;v>this._rulerRight&&(v=this._rulerRight);i=Math.max(this._curve.plot().axisDecimalPlaces(this._curve.yAxis()),this._curve.plot().axisDecimalPlaces(this._curve.xAxis())),a=Static.calcStep(this._curve);this._value+=math.eval("integrate("+p+", x,"+m+","+v+",false,"+a+")"),s+=math.eval("integrate((("+p+")*("+p+")), x,"+m+","+v+",false,"+a+")"),o+=math.eval("integrate(x * ("+p+"), x,"+m+","+v+",false,"+a+")");l=this._value;this._value=Static.adjustForDecimalPlaces(this._value,i),(this._value>n.upper||this._value<n.lower)&&(this._value=this._value.toExponential(i))}}c=Static.adjustForDecimalPlaces(s/(2*l),i),u=Static.adjustForDecimalPlaces(o/l,i);(c>n.upper||c<n.lower)&&(c=c.toExponential(i)),(u>n.upper||u<n.lower)&&(u=u.toExponential(i)),Static.watchCentroidWithArea?(0==this._value&&(u=c="Infinity"),this._value+=" centroid:("+u+", "+c+")",e.setValue(u,c),e.setVisible(!0)):e.setVisible(!1)}else this._value="Invalid"}}}class WatchVolumeOfRevolution extends Watch{constructor(){function e(e,t,n){var r=e*n*Math.PI*e;return r+=.5*(t-e)*n*(e+(t-e)/3)*2*Math.PI}super(Static.LeftAndRight),this.name=function(){return"Volume of revolution"},this.computeWatch=function(){var t=this._curve.plot().getNonExponentNotationLimits();if(this._rulerLeft!=Number.MAX_VALUE&&isFinite(this._rulerLeft)){if(this._curve.expandedFn){var n=this._curve.expandedFn;if(n=logBaseAdjust(n),"x"!=this._curve.variable)for(;-1!=n.indexOf(this._curve.variable);)n=n.replace(this._curve.variable,"x");if(this._curve.coeffs)for(var r=0;r<this._curve.coeffs.length;++r)for(;-1!=n.indexOf(this._curve.coeffs[r]);)n=n.replace(this._curve.coeffs[r],this._curve.coeffsVal[r]);var i=Math.max(this._curve.plot().axisDecimalPlaces(this._curve.yAxis()),this._curve.plot().axisDecimalPlaces(this._curve.xAxis())),a=Static.calcStep(this._curve);return this._value=math.eval("integrate("+n+", x,"+this._rulerLeft+","+this._rulerRight+",true,"+a+")"),this._value=Static.adjustForDecimalPlaces(this._value,i),void((this._value>t.upper||this._value<t.lower)&&(this._value=this._value.toExponential(i)))}var s=this._curve.dataSize(),o=this._rulerLeft,l=this._rulerRight,c=0,u=0,h=0;for(r=1;r<s;++r){var d=this._curve.sample(r),f=this._curve.sample(r-1);if(!c&&d.x>o&&d.x<=l)c=e(f.y+(d.y-f.y)*(o-f.x)/(d.x-f.x),d.y,d.x-o);else if(c&&d.x<=l)h+=e(d.y,f.y,d.x-f.x);else if(d.x>l){if(f.x>=o){u=e(d.y+(d.y-f.y)*(l-d.x)/(d.x-f.x),f.y,l-f.x);break}u=e(d.y+(d.y-f.y)*(l-d.x)/(d.x-f.x),f.y+(d.y-f.y)*(o-f.x)/(d.x-f.x),l-o);break}}i=Math.max(this._curve.plot().axisDecimalPlaces(this._curve.yAxis()),this._curve.plot().axisDecimalPlaces(this._curve.xAxis()));this._value=Static.adjustForDecimalPlaces(c+h+u,i),(this._value>t.upper||this._value<t.lower)&&(this._value=this._value.toExponential(i))}else this._value="Invalid"}}}define("basicWatch",["static","watch","plotMarker"],function(){}),function(e,t,n,r){"use strict";var i;e.single=(i=e({}),function(e){return i[0]=e,i}),e.fn.contextMenu=function(t,n,r){a[t]?n&&(n instanceof Array||"string"==typeof n||n.nodeType||n.jquery||(r=n,n=null)):(r=n,n=t,t="popup"),n instanceof Array&&"update"!=t&&(t="menu");var i=r;return e.inArray(t,["menu","popup","close","destroy"])>-1?(r=s.optionOtimizer(t,r),this.each(function(){var s=e(this);(i=e.extend({},e.fn.contextMenu.defaults,r)).baseTrigger||(i.baseTrigger=s),a[t].call(s,n,i)})):a[t].call(this,n,i),this},e.fn.contextMenu.defaults={triggerOn:"click",subMenuTriggerOn:"hover click",displayAround:"cursor",mouseClick:"left",verAdjust:0,horAdjust:0,top:"auto",left:"auto",closeOther:!0,containment:t,winEventClose:!0,position:"auto",closeOnClick:!0,onOpen:function(e,t){},afterOpen:function(e,t){},onClose:function(e,t){}};var a={menu:function(e,t){e=s.createMenuList(this,e,t),s.contextMenuBind.call(this,e,t,"menu")},popup:function(t,n){e(t).addClass("iw-contextMenu"),s.contextMenuBind.call(this,t,n,"popup")},update:function(t,n){var r=this;n=n||{},this.each(function(){var i=e(this),a=i.data("iw-menuData");a||(r.contextMenu("refresh"),a=i.data("iw-menuData"));var o=a.menu;if("object"==typeof t)for(var l=0;l<t.length;l++){var c=t[l].name,u=t[l].disable,h=t[l].fun,d=t[l].icon,f=t[l].img,p=t[l].title,m=t[l].className,v=o.children("li").filter(function(){return e(this).contents().filter(function(){return 3==this.nodeType}).text()==c}),g=t[l].subMenu;void 0!=u&&(u?v.addClass("iw-mDisable"):v.removeClass("iw-mDisable")),h&&v.unbind("click.contextMenu").bind("click.contextMenu",h),void 0!=p&&v.attr("title",p),void 0!=m&&v.attr("class",m);var b=v.find(".iw-mIcon");b.length&&b.remove(),f?v.prepend('<img src="'+f+'" align="absmiddle" class="iw-mIcon" />'):d&&v.prepend('<span align="absmiddle" class="iw-mIcon '+d+'" />'),g&&v.contextMenu("update",g)}s.onOff(o);var S=n.triggerOn;if(S){i.unbind(".contextMenu");for(var y=[],x=(l=0,(S=S.split(" ")).length);l<x;l++)y.push(S[l]+".contextMenu");i.bind(y.join(" "),s.eventHandler)}a.option=e.extend({},a.option,n),i.data("iw-menuData",a)})},refresh:function(){var t=this.filter(function(){return!!e(this).data("iw-menuData")}).data("iw-menuData"),n=this.filter(function(){return!e(this).data("iw-menuData")});t.option.baseTrigger=this,s.contextMenuBind.call(n,t.menuSelector,t.option)},open:function(t,n){var r=(n=n||{}).event||e.Event("click");n.top&&(r.clientY=n.top),n.left&&(r.clientX=n.left),this.each(function(){s.eventHandler.call(this,r)})},close:function(){var e=this.data("iw-menuData");e&&s.closeContextMenu(e.option,this,e.menu,null)},value:function(e){var t=this.data("iw-menuData");return t[e]?t[e]:t.option?t.option[e]:null},destroy:function(){var t=this.data("iw-menuData").menuId,n=e(".iw-contextMenu[menuId="+t+"]"),r=n.data("iw-menuData");r&&(1==r.noTrigger?n.hasClass("iw-created")?n.remove():(n.removeClass("iw-contextMenu "+t).removeAttr("menuId").removeData("iw-menuData"),n.find("li.iw-mTrigger").contextMenu("destroy")):(r.noTrigger--,n.data("iw-menuData",r)),this.unbind(".contextMenu").removeClass("iw-mTrigger").removeData("iw-menuData"))}},s={contextMenuBind:function(t,n,r){var i=this,a=e(t),o=a.data("iw-menuData");if(0!=a.length||0!=(a=i.find(t)).length){"menu"==r&&s.menuHover(a);var l=n.baseTrigger;if(o)o.noTrigger++,a.data("iw-menuData",o);else{var c;l.data("iw-menuData")?c=l.data("iw-menuData").menuId:(c=Math.ceil(1e5*Math.random()),l.data("iw-menuData",{menuId:c}));var u=a.clone();u.appendTo("body"),o={menuId:c,menuWidth:u.outerWidth(!0),menuHeight:u.outerHeight(!0),noTrigger:1,trigger:i},a.data("iw-menuData",o).attr("menuId",c),u.remove()}i.addClass("iw-mTrigger").data("iw-menuData",{menuId:o.menuId,option:n,menu:a,menuSelector:t,method:r});var h=n.triggerOn;-1!=h.indexOf("hover")&&(h=h.replace("hover","mouseenter"),-1!=l.index(i)&&l.add(a).bind("mouseleave.contextMenu",function(t){0==e(t.relatedTarget).closest(".iw-contextMenu").length&&e('.iw-contextMenu[menuId="'+o.menuId+'"]').fadeOut(100)})),i.delegate("input,a,.needs-click","click",function(e){e.stopImmediatePropagation()});for(var d=[],f=0,p=(h=h.split(" ")).length;f<p;f++)d.push(h[f]+".contextMenu");i.bind(d.join(" "),s.eventHandler),a.bind("click mouseenter",function(e){e.stopPropagation()}),a.delegate("li","click",function(t){n.closeOnClick&&!e.single(this).hasClass("iw-has-submenu")&&s.closeContextMenu(n,i,a,t)})}},eventHandler:function(r){r.preventDefault();var i=e(this),a=i.data("iw-menuData"),o=a.menu,l=o.data("iw-menuData"),c=a.option,u=c.containment,h={trigger:i,menu:o},d=u==t,f=-1==c.baseTrigger.index(i);!f&&c.closeOther&&e(".iw-contextMenu").css("display","none"),o.find(".iw-mSelected").removeClass("iw-mSelected"),c.onOpen.call(this,h,r);var p,m,v,g,b=e(u),S=b.innerHeight(),y=b.innerWidth(),x=0,w=0,_=l.menuHeight,C=l.menuWidth,E=0,k=0,R=p=parseInt(c.verAdjust),T=m=parseInt(c.horAdjust);if(d||(x=b.offset().top,w=b.offset().left,"static"==b.css("position")&&b.css("position","relative")),"cursor"==c.displayAround)g=(E=d?r.clientX:r.clientX+e(t).scrollLeft()-w)+C,(v=(k=d?r.clientY:r.clientY+e(t).scrollTop()-x)+_)>S&&(k-_<0?v-S<_-k?(k=S-_,p*=-1):(k=0,p=0):(k-=_,p*=-1)),g>y&&(E-C<0?g-y<C-E?(E=y-C,m*=-1):(E=0,m=0):(E-=C,m*=-1));else if("trigger"==c.displayAround){var A=i.outerHeight(!0),P=i.outerWidth(!0),B=d?i.offset().left-b.scrollLeft():i.offset().left-w,M=d?i.offset().top-b.scrollTop():i.offset().top-x,I=P;g=(E=B+P)+C,(v=(k=M)+_)>S&&(k-_<0?v-S<_-k?(k=S-_,p*=-1):(k=0,p=0):(k=k-_+A,p*=-1)),g>y&&(E-C<0?g-y<C-E?(E=y-C,m*=-1,I=-P):(E=0,m=0,I=0):(E=E-C-P,m*=-1,I=-P)),"top"==c.position?(k=M-_,p=R,E-=I):"left"==c.position?(E=B-C,m=T):"bottom"==c.position?(k=M+A,p=R,E-=I):"right"==c.position&&(E=B+P,m=T)}var D={position:d||f?"fixed":"absolute",display:"inline-block",height:"",width:""};if("auto"!=c.left&&(E=s.getPxSize(c.left,y)),"auto"!=c.top&&(k=s.getPxSize(c.top,S)),!d){var L=i.offsetParent().offset();f?(E=E+w-e(t).scrollLeft(),k=k+x-e(t).scrollTop()):(E-=w-L.left,k-=x-L.top)}D.left=E+m+"px",D.top=k+p+"px",o.css(D),c.afterOpen.call(this,h,r),0==i.closest(".iw-contextMenu").length&&(e(".iw-curMenu").removeClass("iw-curMenu"),o.addClass("iw-curMenu"));var F={trigger:i,menu:o,option:c,method:a.method};e("html").unbind("click",s.clickEvent).click(F,s.clickEvent),e(n).unbind("keydown",s.keyEvent).keydown(F,s.keyEvent),c.winEventClose&&e(t).bind("scroll resize",F,s.scrollEvent)},scrollEvent:function(e){s.closeContextMenu(e.data.option,e.data.trigger,e.data.menu,e)},clickEvent:function(t){t.data.trigger.get(0)!==t.target&&0==e(t.target).closest(".iw-contextMenu").length&&s.closeContextMenu(t.data.option,t.data.trigger,t.data.menu,t)},keyEvent:function(t){t.preventDefault();var n=t.data.menu,r=t.data.option,i=t.keyCode;if(27==i&&s.closeContextMenu(r,t.data.trigger,n,t),"menu"==t.data.method){var a=e(".iw-curMenu"),o=a.children("li:not(.iw-mDisable)"),l=o.filter(".iw-mSelected"),c=o.index(l),u=function(e){s.selectMenu(a,e),e.data("iw-menuData")&&s.eventHandler.call(e[0],t)},h=function(){u(o.filter(":first"))},d=function(){u(o.filter(":last"))};switch(i){case 13:l.click();break;case 40:c==o.length-1||0==l.length?h():u(o.filter(":eq("+(c+1)+")"));break;case 38:0==c||0==l.length?d():u(o.filter(":eq("+(c-1)+")"));break;case 33:h();break;case 34:d();break;case 37:!function(){var e=a.data("iw-menuData").trigger.closest(".iw-contextMenu");0!=e.length&&(a.removeClass("iw-curMenu").css("display","none"),e.addClass("iw-curMenu"))}();break;case 39:!function(){var e=l.data("iw-menuData");if(e){s.eventHandler.call(l[0],t);var n=e.menu;n.addClass("iw-curMenu"),a.removeClass("iw-curMenu"),o=(a=n).children("li:not(.iw-mDisable)"),l=o.filter(".iw-mSelected"),h()}}()}}},closeContextMenu:function(r,i,a,o){e(n).unbind("keydown",s.keyEvent),e("html").unbind("click",s.clickEvent),e(t).unbind("scroll resize",s.scrollEvent),e(".iw-contextMenu").css("display","none"),e(n).focus(),r.onClose.call(this,{trigger:i,menu:a},o)},getPxSize:function(e,t){return isNaN(e)?-1!=e.indexOf("%")?parseInt(e)*t/100:parseInt(e):e},selectMenu:function(e,t){var n=e.find("li.iw-mSelected"),r=n.find(".iw-contextMenu");0!=r.length&&n[0]!=t[0]&&r.fadeOut(100),n.removeClass("iw-mSelected"),t.addClass("iw-mSelected")},menuHover:function(t){Date.now();t.children("li").bind("mouseenter.contextMenu click.contextMenu",function(n){e(".iw-curMenu").removeClass("iw-curMenu"),t.addClass("iw-curMenu"),s.selectMenu(t,e(this))})},createMenuList:function(n,r,i){var a=i.baseTrigger,o=Math.floor(1e4*Math.random());if("object"==typeof r&&!r.nodeType&&!r.jquery){var l=e('<ul class="iw-contextMenu iw-created iw-cm-menu" id="iw-contextMenu'+o+'"></ul>'),c=i.zIndex||n.css("zIndex");if(l.css("zIndex",c),e.each(r,function(t,n){var r=n.name,o=n.fun||function(){},c=n.subMenu,u=n.img||"",h=n.icon||"",d=n.title||"",f=n.className||"",p=n.disable,m=e('<li title="'+d+'" class="'+f+'">'+r+"</li>");u?m.prepend('<img src="'+u+'" align="absmiddle" class="iw-mIcon" />'):h&&m.prepend('<span align="absmiddle" class="iw-mIcon '+h+'" />'),p&&m.addClass("iw-mDisable"),c||m.bind("click.contextMenu",function(e){o.call(this,{trigger:a,menu:l},e)}),l.append(m),c&&(m.addClass("iw-has-submenu").append('<div class="iw-cm-arrow-right" />'),s.subMenu(m,c,a,i))}),-1==a.index(n[0]))n.append(l);else{var u=i.containment==t?"body":i.containment;e(u).append(l)}return s.onOff(e("#iw-contextMenu"+o)),"#iw-contextMenu"+o}if(0!=e(r).length){var h=e(r);return h.removeClass("iw-contextMenuCurrent").addClass("iw-contextMenu iw-cm-menu iw-contextMenu"+o).attr("menuId","iw-contextMenu"+o).css("display","none"),h.find("ul").each(function(t,n){var r=e(this),o=r.parent("li");o.append('<div class="iw-cm-arrow-right" />'),r.addClass("iw-contextMenuCurrent"),s.subMenu(o,".iw-contextMenuCurrent",a,i)}),s.onOff(e(".iw-contextMenu"+o)),".iw-contextMenu"+o}},subMenu:function(e,t,n,r){e.contextMenu("menu",t,{triggerOn:r.subMenuTriggerOn,displayAround:"trigger",position:"auto",mouseClick:"left",baseTrigger:n,containment:r.containment})},onOff:function(t){t.find(".iw-mOverlay").remove(),t.find(".iw-mDisable").each(function(){var t=e(this);t.append('<div class="iw-mOverlay"/>'),t.find(".iw-mOverlay").bind("click mouseenter",function(e){e.stopPropagation()})})},optionOtimizer:function(t,n){if(n)return"menu"==t&&(n.mouseClick||(n.mouseClick="right")),"right"==n.mouseClick&&"click"==n.triggerOn&&(n.triggerOn="contextmenu"),-1!=e.inArray(n.triggerOn,["hover","mouseenter","mouseover","mouseleave","mouseout","focusin","focusout"])&&(n.displayAround="trigger"),n}}}(jQuery,window,document),define("contextMenu",function(){});class LegendMenu{constructor(e){var t=null,n=null,r=[{name:"1",fun:function(){var e=n;if(e&&e.rtti==Static.Rtti_PlotSpectroCurve)return e.setPenWidth(1),void Static.trigger("penAttributeChanged",e);if(e&&e.rtti===Static.Rtti_PlotCurve){var t=e.pen();t.width=1,e.setPen(t),Static.trigger("penAttributeChanged",e)}}},{name:"2",fun:function(){var e=n;if(e&&e.rtti==Static.Rtti_PlotSpectroCurve)return e.setPenWidth(2),void Static.trigger("penAttributeChanged",e);if(e&&e.rtti===Static.Rtti_PlotCurve){var t=e.pen();t.width=2,e.setPen(t),Static.trigger("penAttributeChanged",e)}}},{name:"3",fun:function(){var e=n;if(e&&e.rtti==Static.Rtti_PlotSpectroCurve)return e.setPenWidth(3),void Static.trigger("penAttributeChanged",e);if(e&&e.rtti===Static.Rtti_PlotCurve){var t=e.pen();t.width=3,e.setPen(t),Static.trigger("penAttributeChanged",e)}}},{name:"4",fun:function(){var e=n;if(e&&e.rtti==Static.Rtti_PlotSpectroCurve)return e.setPenWidth(4),void Static.trigger("penAttributeChanged",e);if(e&&e.rtti===Static.Rtti_PlotCurve){var t=e.pen();t.width=4,e.setPen(t),Static.trigger("penAttributeChanged",e)}}},{name:"5",fun:function(){var e=n;if(e&&e.rtti==Static.Rtti_PlotSpectroCurve)return e.setPenWidth(5),void Static.trigger("penAttributeChanged",e);if(e&&e.rtti===Static.Rtti_PlotCurve){var t=e.pen();t.width=5,e.setPen(t),Static.trigger("penAttributeChanged",e)}}}];this.getPenWidthSubMenu=function(){return r};var i=[{name:"color",fun:function(){var e=$('<input type="color" style="opacity:0;">'),t=n;t&&t.rtti===Static.Rtti_PlotCurve&&(e.val(Static.colorNameToHex(t.pen().color)),e.change(function(){var e=t.pen();e.color=$(this).val(),t.setPen(e),Static.trigger("penAttributeChanged",t)}),e.trigger("click"))}},{name:"line style",subMenu:[{name:"solid",fun:function(){var e=n;if(e&&e.rtti===Static.Rtti_PlotCurve){var t=e.pen();t.style="solid",e.setPen(t),Static.trigger("penAttributeChanged",e)}}},{name:"dot",fun:function(){var e=n;if(e&&e.rtti===Static.Rtti_PlotCurve){var t=e.pen();t.style="dot",e.setPen(t),Static.trigger("penAttributeChanged",e)}}},{name:"dash",fun:function(){var e=n;if(e&&e.rtti===Static.Rtti_PlotCurve){var t=e.pen();t.style="dash",e.setPen(t),Static.trigger("penAttributeChanged",e)}}},{name:"dashDot",fun:function(){var e=n;if(e&&e.rtti===Static.Rtti_PlotCurve){var t=e.pen();t.style="dashDot",e.setPen(t),Static.trigger("penAttributeChanged",e)}}},{name:"dashDotDot",fun:function(){var e=n;if(e&&e.rtti===Static.Rtti_PlotCurve){var t=e.pen();t.style="dashDotDot",e.setPen(t),Static.trigger("penAttributeChanged",e)}}}]},{name:"pen width",subMenu:r}];this.getPenSubMenu=function(){return i};var a=[{name:"style",subMenu:[{name:"Rectangle",fun:function(){Utility.addSymbol(n,MRect)}},{name:"Cross",fun:function(){Utility.addSymbol(n,Cross)}},{name:"Diamond",fun:function(){Utility.addSymbol(n,Diamond)}},{name:"Ellipse",fun:function(){Utility.addSymbol(n,Ellipse)}},{name:"Diagonal cross",fun:function(){Utility.addSymbol(n,XCross)}},{name:"None",fun:function(){var e=n;e&&e.rtti===Static.Rtti_PlotCurve&&e.setSymbol(null)}}]}],s=[{name:"style",subMenu:[{name:"Rectangle",fun:function(){Utility.addSymbol(n,MRect)}},{name:"Cross",fun:function(){Utility.addSymbol(n,Cross)}},{name:"Diamond",fun:function(){Utility.addSymbol(n,Diamond)}},{name:"Ellipse",fun:function(){Utility.addSymbol(n,Ellipse)}},{name:"Diagonal cross",fun:function(){Utility.addSymbol(n,XCross)}},{name:"None",fun:function(){n&&Utility.addSymbol(n,NoSymbol)}}]},{name:"size",subMenu:[{name:"5x5",fun:function(){Utility.setSymbolSize(n,5)}},{name:"6x6",fun:function(){Utility.setSymbolSize(n,6)}},{name:"8x8",fun:function(){Utility.setSymbolSize(n,8)}},{name:"10x10",fun:function(){Utility.setSymbolSize(n,10)}},{name:"12x12",fun:function(){Utility.setSymbolSize(n,12)}},{name:"15x15",fun:function(){Utility.setSymbolSize(n,15)}}]},{name:"fill brush",fun:function(){var t=$('<input type="color" style="opacity:0;">'),r=n;if(r){var i=r.symbol();if(i){var a=i.brush(),s=a.color;"noBrush"==s&&(s="#000000"),t.val(Static.colorNameToHex(s)),t.change(function(){$(this).remove(),a.color=$(this).val(),i.setBrush(a),e.autoRefresh(),e.updateLegend(r),Static.trigger("symbolAttributeChanged",r)}),t.trigger("click")}}}},{name:"pen",subMenu:[{name:"color",fun:function(){var t=$('<input type="color" style="opacity:0;">'),r=n;if(r){var i=r.symbol();i&&(t.val(Static.colorNameToHex(i.pen().color)),t.change(function(){var t=i.pen();t.color=$(this).val(),i.setPen(t),e.autoRefresh(),e.updateLegend(r),Static.trigger("symbolAttributeChanged",r)}),t.trigger("click"))}}},{name:"pen width",subMenu:[{name:"1",fun:function(){Utility.setSymbolPenWidth(n,1)}},{name:"2",fun:function(){Utility.setSymbolPenWidth(n,2)}},{name:"3",fun:function(){Utility.setSymbolPenWidth(n,3)}},{name:"4",fun:function(){Utility.setSymbolPenWidth(n,4)}},{name:"5",fun:function(){Utility.setSymbolPenWidth(n,5)}}]}]}],o=[{pos:0,name:"curve brush",img:"images/brush.png",title:"Set the fill color.",fun:function(){Utility.setCurveBrush(n,function(e){Static.trigger("curveBrushChanged",e)})}},{pos:4,name:"remove",img:"images/scissors.png",title:"Removes the curve from the plot.",fun:function(){n&&n.detach()}},{pos:5,name:"rename",img:"images/rename.png",title:"Renames the curve.",fun:function(){var e=n;e&&Utility.curveRenameDlg(e.title(),e.plot())}},{pos:7,name:"symbol",img:"images/symbol.png",title:"attach/modify curve symbol",subMenu:null},{pos:8,name:"pen",img:"images/pen.png",title:"modify/change curve pen",subMenu:i}];this.getCurve=function(){return n};var l=function(){};this.setMenuModificationCb=function(e){l=e};var c=function(){var r="";function i(e){return e.name==r}$(e.getLayout().getLegendDiv().children()[0]).mousedown(function(c){if(2==c.button){for(var u=c.pageX,h=c.pageY,d=[],f=document.elementFromPoint(u,h);f&&"BODY"!=f.tagName&&"HTML"!=f.tagName;)d.push(f),f.style.display="none",f=document.elementFromPoint(u,h);for(var p=0;p<d.length;p++)d[p].style.display="";var m=null;for(p=0;p<d.length;p++)if("LABEL"===d[p].tagName){m=d[p];break}t&&void 0!==t.menuAppended&&t.menuAppended&&t.contextMenu("destroy"),t=$(m).parent();var v=n=function(){if(void 0==t)return null;var n=t.text().replace(" ","");return e.findPlotCurve(n)}();if(v){l();var g=(r="symbol",o.findIndex(i));g>-1&&(o[g].subMenu=a,v&&v.rtti==Static.Rtti_PlotCurve&&v.symbol()&&(o[g].subMenu=s)),t.menuAppended=!0,t.contextMenu(o,{triggerOn:"contextmenu touchstart",zIndex:1})}}})};function u(){o=o.sort(function(e,t){return e.pos-t.pos})}this.modifyMenu=function(e,t){if(null!=e){var n,r=-1,i=_.find(o,function(t,n){return r=n,t.name==e});if(void 0!=i)if(_.isEmpty(t))(n=r)>-1&&o.splice(n,1);else i.pos=t.pos||i.pos,i.name=t.name||i.name,i.img=t.img||i.img,i.title=t.title||i.title,i.fun=t.fun||i.fun,o=u()}else{_.isArray(t)?function(e){for(var t=0;t<e.length;++t)void 0===_.find(o,function(n){return n.name==e[t].name})&&o.push(e[t])}(t):void 0==_.find(o,function(e){return e.name==t.name})&&o.push(t),u()}},e.legend()?c():Static.bind("legendInserted",function(){c(),Static.unbind("legendInserted")})}}define("legendMenu",["static","contextMenu"],function(){});class HObject{constructor(e){let t=this,n=!1,r=$("body");this.m_objectName="jObject",this.m_mouseTracking=!0,this.m_filterObjs=[],void 0!==e&&(r=e&&e instanceof HObject?e.getElement():e);let i="click",a="mousedown",s="mouseup",o="mousemove";Static.isMobile()&&(i="tap",a="touchstart",s="touchend",o="touchmove"),this.mapToElement=function(e){if(!r)return;let t=new Misc.Point,n=r[0].getBoundingClientRect();return t.x=e.x-n.left,t.y=e.y-n.top,t},this.setElement=function(e){r=e},this.getElement=function(){return r},this.setEnabled_1=function(e){n!=e&&(n=e,this.elementEvent(n),n&&Static.trigger("enabled"))},this.event=function(e){return!0},this.elementEventOnCb=function(e){if(!t.m_filterObjs.length)return t.event(e);t.m_filterObjs.forEach(function(n){if(!n.eventFilter(t,e))return t.event(e)})},this.elementEvent=function(e){if(this instanceof HObject){let t=this;e?(t.getElement().on(a+" "+s+" "+o+" mouseenter mouseleave mousewheel",function(e){t.elementEventOnCb(e)}),$("body").on("keydown keyup",function(e){if(!t.m_filterObjs.length)return t.event(e);t.m_filterObjs.forEach(function(n){if(!n.eventFilter(t,e))return t.event(e)})})):(t.getElement().off(a+" "+s+" "+o+" mouseenter mouseleave mousewheel"),$("body").off("keydown keyup"))}},this.installEventFilter=function(e){this.m_filterObjs.push(e)},this.removeEventFilter=function(e){let t=this.m_filterObjs.indexOf(e);t>-1&&this.m_filterObjs.splice(t,1)},this.hasSameElement=function(e){return this.getElement()==e.getElement()},this.isEnabled=function(){return n},this.toString=function(){return"[HObject]"}}eventFilter(e,t){console.log("eventFilter() called")}setMouseTracking(e){if(this.getElement()&&e){let e=this;this.getElement().on("mousemove touchmove",function(t){e.elementEventOnCb(t)}),this.m_mouseTracking=!0}else this.getElement().off("mousemove touchmove"),this.m_mouseTracking=!1}hasMouseTracking(){return this.m_mouseTracking}setObjectName(e){this.m_objectName=e}objectName(){return this.m_objectName}isWidget(){return"[Widget]"==this.toString()}}define("hObject",function(){});class Widget extends HObject{constructor(e){super(e);let t=!0,n=0;var r=new Misc.Font(12);let i=$("<canvas />").attr({style:"position: absolute; background-color: transparent"});this.getElement()&&this.getElement().append(i),this.clearCanvas=function(){let e=this.getContext();e&&e.clearRect(0,0,i[0].width,i[0].height)},this.getContext=function(){let e=null;return this.getElement()?(i[0].width=parseFloat(this.getElement().css("width")),i[0].height=parseFloat(this.getElement().css("height")),e=i[0].getContext("2d")):null},this.width=function(){return i[0].width},this.height=function(){return i[0].height},this.setCanvasParent=function(e){this.getElement().append(i)},this.getCanvas=function(){return i},this.contentsRect=function(){let e=this.getElement();return new Misc.Rect(0,0,parseFloat(e.css("width")),parseFloat(e.css("height")))},this.setVisible=function(e){e||void 0===e?(this.getCanvas().show(),t=!0):(this.getCanvas().hide(),t=!1)},this.hide=function(){this.setVisible(!1)},this.show=function(){this.setVisible(!0)},this.font=function(){return r},this.setFont=function(e){r=e},this.isVisible=function(){return t},this.setZ=function(e){n!==e&&(n=e,i&&i.css("zIndex",n))},this.getZ=function(e){return n},this.toString=function(){return"[Widget]"}}setElement(e){this.super(e),this.setCanvasParent(e)}}define("widget",["static","hObject"],function(){});class WidgetOverlay extends Widget{constructor(e){super(e);this.draw=function(){let e=new PaintUtil.Painter(this);this.drawOverlay(e),e=null},this.toString=function(){return"[WidgetOverlay]"}}updateOverlay(){this.draw()}drawOverlay(e){console.warn("drawOverlay() not reimplemented")}}define("widgetOverlay",["static","widget"],function(){});class MousePattern{constructor(e,t){this.button=Static.NoButton,this.modifiers=Static.NoModifier,void 0!==e&&(this.button=e),void 0!==t&&(this.modifiers=t)}}function KeyPattern(e,t){this.key=Static.Key_unknown,this.modifiers=Static.NoModifier,void 0!==e&&(this.key=e),void 0!==t&&(this.modifiers=t)}class EventPattern extends HObject{constructor(e){super(e);const t=Enum.MousePatternCode.MouseSelect1,n=Enum.MousePatternCode.MouseSelect2,r=Enum.MousePatternCode.MouseSelect3,i=Enum.MousePatternCode.MouseSelect4,a=Enum.MousePatternCode.MouseSelect5,s=Enum.MousePatternCode.MouseSelect6,o=Enum.MousePatternCode.MousePatternCount;var l=[],c=[];this.initMousePattern=function(e){for(var c=0;c<o;++c)l.push(new MousePattern);switch(e){case 1:this.setMousePattern(t,Static.LeftButton),this.setMousePattern(n,Static.LeftButton,Static.ControlModifier),this.setMousePattern(r,Static.LeftButton,Static.AltModifier);break;case 2:this.setMousePattern(t,Static.LeftButton),this.setMousePattern(n,Static.RightButton),this.setMousePattern(r,Static.LeftButton,Static.AltModifier);break;default:this.setMousePattern(t,Static.LeftButton),this.setMousePattern(n,Static.RightButton),this.setMousePattern(r,Static.MidButton)}this.setMousePattern(i,l[t].button,l[t].modifiers|Static.ShiftModifier),this.setMousePattern(a,l[n].button,l[n].modifiers|Static.ShiftModifier),this.setMousePattern(s,l[r].button,l[r].modifiers|Static.ShiftModifier)},this.initKeyPattern=function(){for(var e=0;e<Enum.KeyPatternCode.KeyPatternCount;++e)c.push(new KeyPattern);this.setKeyPattern(Enum.KeyPatternCode.KeySelect1,Static.Key_Return),this.setKeyPattern(Enum.KeyPatternCode.KeySelect2,Static.Key_Space),this.setKeyPattern(Enum.KeyPatternCode.KeyAbort,Static.Key_Escape),this.setKeyPattern(Enum.KeyPatternCode.KeyLeft,Static.Key_Left),this.setKeyPattern(Enum.KeyPatternCode.KeyRight,Static.Key_Right),this.setKeyPattern(Enum.KeyPatternCode.KeyUp,Static.Key_Up),this.setKeyPattern(Enum.KeyPatternCode.KeyDown,Static.Key_Down),this.setKeyPattern(Enum.KeyPatternCode.KeyRedo,Static.Key_Plus),this.setKeyPattern(Enum.KeyPatternCode.KeyUndo,Static.Key_Minus),this.setKeyPattern(Enum.KeyPatternCode.KeyHome,Static.Key_Escape)},this.setMousePattern=function(e,t,n){void 0==t?l=e:(void 0==n&&(n=Static.NoModifier),e>=0&&e<o&&(l[e].button=t,l[e].modifiers=n))},this.setKeyPattern=function(e,t,n){void 0==t?l=e:(void 0==n&&(n=Static.NoModifier),e>=0&&e<Enum.KeyPatternCode.KeyPatternCount&&(c[e].key=t,c[e].modifiers=n))},this.mouseMatch=function(e,t){return e>=0&&e<o&&this.mouseMatch2(l[e],t)},this.mouseMatch2=function(e,t){return null!=t&&(e.button==Utility.button(t)&&e.modifiers==Utility.modifiers(t))},this.keyPattern=function(){return c},this.key=function(e){return null!=e&&e.keyCode},this.keyMatch=function(e,t){return e>=0&&e<Enum.KeyPatternCode.KeyPatternCount&&this.keyMatch2(c[e],t)},this.keyMatch2=function(e,t){return null!=t&&(e.key==this.key(t)&&e.modifiers==Utility.modifiers(t))},this.initKeyPattern(),this.initMousePattern(3)}}define("eventpattern",function(){});class PickerMachine{constructor(e){Static.Begin=0,Static.Append=1,Static.Move=2,Static.Remove=3,Static.End=4;var t=e,n=0;this.selectionType=function(){return t},this.state=function(){return n},this.setState=function(e){n=e},this.reset=function(){this.setState(0)}}}class PickerTrackerMachine extends PickerMachine{constructor(){super(Static.NoSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mouseenter":case"mousemove":case"touchmove":0==this.state()?(n.push(Static.Begin),n.push(Static.Append),this.setState(1)):n.push(Static.Move);break;case"mouseleave":n.push(Static.Remove),n.push(Static.End),this.setState(0)}return n}}}class PickerClickPointMachine extends PickerMachine{constructor(){super(Static.PointSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mousedown":case"touchstart":e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t)&&(n.push(Static.Begin),n.push(Static.Append),n.push(Static.End));break;case"keydown":var r=t;e.keyMatch(Enum.KeyPatternCode.KeySelect1,r)&&(n.push(Static.Begin),n.push(Static.Append),n.push(Static.End))}return n}}toString(){return"[PickerClickPointMachine]"}}class PickerDragPointMachine extends PickerMachine{constructor(){super(Static.PointSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mousedown":case"touchstart":e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t)&&0==this.state()&&(n.push(Static.Begin),n.push(Static.Append),this.setState(1));break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&n.push(Static.Move);break;case"mouseup":case"touchend":0!=this.state()&&(n.push(Static.End),this.setState(0));break;case"keydown":var r=t;e.keyMatch(Enum.KeyPatternCode.KeySelect1,r)&&(0==this.state()?(n.push(Static.Begin),n.push(Static.Append),this.setState(1)):(n.push(Static.End),this.setState(0)))}return n}}toString(){return"[PickerDragPointMachine]"}}class PickerClickRectMachine extends PickerMachine{constructor(){super(Static.RectSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mousedown":case"touchstart":if(e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t))switch(this.state()){case 0:n.push(Static.Begin),n.push(Static.Append),this.setState(1);break;case 1:break;default:n.push(Static.End),this.setState(0)}break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&n.push(Static.Move);break;case"mouseup":case"touchend":e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t)&&1==this.state()&&(n.push(Static.Append),this.setState(2));break;case"keydown":var r=t;e.keyMatch(Enum.KeyPatternCode.KeySelect1,r)&&(0==this.state()?(n.push(Static.Begin),n.push(Static.Append),this.setState(1)):1==this.state()?(n.push(Static.Append),this.setState(2)):2==this.state()&&(n.push(Static.End),this.setState(0)))}return n}}toString(){return"[PickerClickRectMachine]"}}class PickerDragRectMachine extends PickerMachine{constructor(){super(Static.RectSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mousedown":case"touchstart":("touchstart"==t.type||e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t))&&0==this.state()&&(n.push(Static.Begin),n.push(Static.Append),n.push(Static.Append),this.setState(2));break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&n.push(Static.Move);break;case"mouseup":case"touchend":2==this.state()&&(n.push(Static.End),this.setState(0));break;case"keydown":e.keyMatch(Enum.KeyPatternCode.KeySelect1,t)&&(0==this.state()?(n.push(Static.Begin),n.push(Static.Append),n.push(Static.Append),this.setState(2)):(n.push(Static.End),this.setState(0)))}return n}}toString(){return"[PickerDragRectMachine]"}}class PickerPolygonMachine extends PickerMachine{constructor(){super(Static.PolygonSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mousedown":case"touchstart":e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t)&&(0==this.state()?(n.push(Static.Begin),n.push(Static.Append),n.push(Static.Append),this.setState(1)):n.push(Static.Append)),e.mouseMatch(Enum.MousePatternCode.MouseSelect2,t)&&1==this.state()&&(n.push(Static.End),this.setState(0));break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&n.push(Static.Move);break;case"keydown":var r=t;e.keyMatch(Enum.KeyPatternCode.KeySelect1,r)?0==this.state()?(n.push(Static.Begin),n.push(Static.Append),n.push(Static.Append),this.setState(1)):n.push(Static.Append):e.keyMatch(Enum.KeyPatternCode.KeySelect2,r)&&1==this.state()&&(n.push(Static.End),this.setState(0))}return n}}toString(){return"[PickerPolygonMachine]"}}class PickerDragLineMachine extends PickerMachine{constructor(){super(Static.PolygonSelection),this.transition=function(e,t){var n=[];switch(t.type){case"mousedown":case"touchstart":e.mouseMatch(Enum.MousePatternCode.MouseSelect1,t)&&0==this.state()&&(n.push(Static.Begin),n.push(Static.Append),n.push(Static.Append),this.setState(1));break;case"keydown":e.keyMatch(Enum.KeyPatternCode.KeySelect1,t)&&(0==this.state()?(n.push(Static.Begin),n.push(Static.Append),n.push(Static.Append),this.setState(1)):(n.push(Static.End),this.setState(0)));break;case"mousemove":case"touchmove":case"mousewheel":0!=this.state()&&n.push(Static.Move);break;case"mouseup":case"touchend":0!=this.state()&&(n.push(Static.End),this.setState(0))}return n}}toString(){return"[PickerDragLineMachine]"}}define("pickermachine",["static","eventpattern"],function(){});class PickerRubberband extends WidgetOverlay{constructor(e,t){super(t),this.setZ(30);var n=e;this.drawOverlay=function(e){e.setPen(n.rubberBandPen()),e.setBrush(Static.NoBrush),n.drawRubberBand(e)}}}class PickerTracker extends WidgetOverlay{constructor(e,t){super(t),this.setZ(30);var n=e;this.drawOverlay=function(e){n.trackerOverlay().clearCanvas(),e.save(),e.setPen(n.trackerPen()),n.drawTracker(e),e.restore()}}}function PickerPrivateData(){this.enabled=!1,this.stateMachine=null,this.resizeMode,this.rubberBand=Static.NoRubberBand,this.rubberBandPen=new Misc.Pen("red",1,"solid"),this.trackerMode=Static.AlwaysOff,this.trackerPen=new Misc.Pen("red"),this.trackerFont,this.pickedPoints=[],this.isActive=!1,this.trackerPosition=new Misc.Point,this.mouseTracking=!1,this.rubberBandOverlay=null,this.trackerOverlay=null}class Picker extends EventPattern{constructor(e,t,n){super(n);let r="click",i="mousedown",a="mouseup",s="mousemove";var o;Static.isMobile()&&(r="tap",i="touchstart",a="touchend",s="touchmove");var l=[],c=null;void 0!==n&&"[Widget]"==n.toString()&&(c=n),this.init=function(e,t,n){(o=new PickerPrivateData).rubberBand=t,e&&(o.trackerFont=new Misc.Font(12),this.setEnabled_1(!0)),this.setTrackerMode(n),Picker.pickers.push(this)},this.getPickerData=function(){return o},this.setStateMachine=function(e){o.stateMachine!=e&&(this.reset(),o.stateMachine=e,o.stateMachine&&o.stateMachine.reset())},this.stateMachine=function(){return o.stateMachine},this.parentWidget=function(){return c},this.setRubberBand=function(e){o.rubberBand=e},this.rubberBand=function(){return o.rubberBand},this.setTrackerMode=function(e){o.trackerMode!=e&&(o.trackerMode=e)},this.trackerMode=function(){return o.trackerMode},this.setEnabled=function(e){if(o.enabled!=e){o.enabled=e;var t=this.parentWidget();t&&(e?t.installEventFilter(this):t.removeEventFilter(this)),this.updateDisplay()}},this.isEnabled=function(){return o.enabled},this.setTrackerFont=function(e){e!=o.trackerFont&&(o.trackerFont=e,this.updateDisplay())},this.trackerFont=function(){return o.trackerFont},this.setTrackerPen=function(e){e!=o.trackerPen&&(o.trackerPen=e,this.updateDisplay())},this.trackerPen=function(){return o.trackerPen},this.setRubberBandPen=function(e){e!=o.rubberBandPen&&(o.rubberBandPen=e,this.updateDisplay())},this.rubberBandPen=function(){return o.rubberBandPen},this.drawRubberBand=function(e){if(this.isActive()&&this.rubberBand()!=Static.NoRubberBand&&this.rubberBandPen().style!=Static.NoPen){var t=this.adjustedPoints(o.pickedPoints),n=Static.NoSelection;switch(o.stateMachine&&(n=o.stateMachine.selectionType()),n){case Static.NoSelection:case Static.PointSelection:if(t.length<1)return;var r=t[0],i=this.pickArea();switch(this.rubberBand()){case Static.VLineRubberBand:e.drawLine(r.x,i.top(),r.x,i.bottom());break;case Static.HLineRubberBand:e.drawLine(i.left(),r.y,i.right(),r.y);break;case Static.CrossRubberBand:e.drawLine(r.x,i.top(),r.x,i.bottom()),e.drawLine(i.left(),r.y,i.right(),r.y)}break;case Static.RectSelection:if(t.length<2)return;var a=new Misc.Rect(t[0],t[t.length-1]);switch(a=a.normalized(),this.rubberBand()){case Static.EllipseRubberBand:e.drawEllipse(a);break;case Static.RectRubberBand:e.drawRect(a)}break;case Static.PolygonSelection:if(t.length<2)return;this.rubberBand()==Static.PolygonRubberBand&&e.drawPolyline(t)}}},this.drawTracker=function(e){var t=this.trackerRect(this.trackerFont());if(null!==t){var n=this.trackerText(o.trackerPosition);""!==n&&(e.setFont(o.trackerFont),e.drawText(n,t.left(),t.bottom()))}},this.adjustedPoints=function(e){return e},this.selection=function(){return this.adjustedPoints(o.pickedPoints)},this.trackerPosition=function(){return o.trackerPosition},this.trackerRect=function(e){if(this.trackerMode()===Static.AlwaysOff)return null;if(this.trackerPosition().x<0||this.trackerPosition().y<0)return null;var t=this.trackerText(this.trackerPosition());if(""==t)return null;var n=e.textSize(t),r=new Misc.Rect(new Misc.Point,n.width,n.height),i=this.trackerPosition(),a=0;if(l.length.length>1&&this.rubberBand()!=Static.NoRubberBand){var s=l[0];a|=i.x>=s.x?Static.AlignRight:Static.AlignLeft,a|=i.y>s.y?Static.AlignBottom:Static.AlignTop}else a=Static.AlignTop|Static.AlignRight;var o=i.x;a&Static.AlignLeft?o-=r.width()+5:a&Static.AlignRight&&(o+=5);var c=i.y;a&Static.AlignBottom?c+=5:a&Static.AlignTop&&(c-=r.height()+5),r.moveTopLeft(new Misc.Point(o,c));var u=new Misc.Rect(new Misc.Point,this.trackerOverlay().width(),this.trackerOverlay().height()),h=Math.min(r.right(),u.right()-5),d=Math.min(r.bottom(),u.bottom()-5);r.moveBottomRight(new Misc.Point(h,d));var f=Math.max(r.left(),u.left()+5),p=Math.max(r.top(),u.top()+5);return r.moveTopLeft(new Misc.Point(f,p)),r},this.eventFilter=function(e,t){if(!this.isEnabled())return!1;if(e&&e==this.parentWidget())switch(t.type){case"mouseenter":this.widgetEnterEvent(t);break;case"mouseleave":this.widgetLeaveEvent(t);break;case i:this.widgetMousePressEvent(t);break;case a:this.widgetMouseReleaseEvent(t);break;case"dblclick":this.widgetMouseDoubleClickEvent(t);break;case s:this.widgetMouseMoveEvent(t);break;case"keydown":this.widgetKeyPressEvent(t);break;case"keyup":this.widgetKeyReleaseEvent(t);break;case"mousewheel":this.widgetWheelEvent(t)}return!1},this.transition=function(e){if(o.stateMachine){var t=o.stateMachine.transition(this,e);switch(e.type){case i:case a:case s:var n=e,r=new Misc.Point(n.clientX,n.clientY);Static.isMobile()&&(r=new Misc.Point(e.originalEvent.changedTouches[0].clientX,e.originalEvent.changedTouches[0].clientY)),r=this.parentWidget().mapToElement(r);break;default:r=this.parentWidget().mapToElement(new Misc.Point(0,0))}for(var l=0;l<t.length;l++)switch(t[l]){case Static.Begin:this.begin();break;case Static.Append:this.append(r);break;case Static.Move:this.move(r);break;case Static.Remove:this.remove();break;case Static.End:this.end()}}},this.reset=function(){o.stateMachine&&o.stateMachine.reset(),this.isActive()&&this.end(!1)},this.append=function(e){o.isActive&&(o.pickedPoints.push(e),this.updateDisplay(),Static.trigger("appended",e))},this.move=function(e){if(o.isActive){var t=o.pickedPoints.length-1;t>=0&&o.pickedPoints[t]!=e&&(o.pickedPoints[t]=e,this.updateDisplay(),Static.trigger("moved",e))}},this.remove=function(){if(o.isActive&&o.pickedPoints.length-1>0){var e=o.pickedPoints.pop();this.updateDisplay(),Static.trigger("removed",e)}},this.accept=function(e){return!0},this.isActive=function(){return o.isActive},this.pickedPoints=function(){return o.pickedPoints},this.setMouseTracking=function(e){var t=this.parentWidget();t&&(e?(o.mouseTracking=t.hasMouseTracking(),t.setMouseTracking(!0)):t.setMouseTracking(o.mouseTracking))},this.pickArea=function(){var e=this.parentWidget();return e?e.contentsRect():null},this.updateDisplay=function(){var e=this.parentWidget(),t=!1,n=!1;e&&e.isVisible()&&o.enabled&&(this.rubberBand()!==Static.NoRubberBand&&this.isActive()&&this.rubberBandPen().style!==Static.NoPen&&(t=!0),(this.trackerMode()==Static.AlwaysOn||this.trackerMode()==Static.ActiveOnly&&this.isActive())&&this.trackerPen()!=Static.NoPen&&(n=!0));var r=o.rubberBandOverlay;t?(null==r&&((r=new PickerRubberband(this,e)).setObjectName("PickerRubberBand"),o.rubberBandOverlay=r),r.updateOverlay()):r&&(o.rubberBandOverlay.getCanvas().hide(),o.rubberBandOverlay.getCanvas(),o.rubberBandOverlay=null);var i=o.trackerOverlay;n?(null==i&&((i=new PickerTracker(this,e)).setObjectName("PickerTracker"),o.trackerOverlay=i),i.setFont(o.trackerFont),i.updateOverlay()):i&&(o.trackerOverlay.getCanvas().hide(),o.trackerOverlay.getCanvas(),o.trackerOverlay=null)},this.rubberBandOverlay=function(){return o.rubberBandOverlay},this.trackerOverlay=function(){return o.trackerOverlay},void 0==e&&void 0==t?this.init(n,Static.NoRubberBand,Static.AlwaysOff):this.init(n,e,t)}widgetEnterEvent(e){this.transition(e)}widgetLeaveEvent(e){this.transition(e),this.getPickerData().trackerPosition=new Misc.Point(-1,-1),this.isActive()||this.updateDisplay()}widgetKeyReleaseEvent(e){this.transition(e)}widgetWheelEvent(e){var t=new Misc.Point(e.clientX,e.clientY);this.pickArea().contains(t)?this.getPickerData().trackerPosition=t:this.getPickerData().trackerPosition=new Misc.Point(-1,-1),this.updateDisplay(),this.transition(e)}widgetMouseDoubleClickEvent(e){this.transition(e)}widgetMouseMoveEvent(e){var t=new Misc.Point(e.clientX,e.clientY);Static.isMobile()&&(t=new Misc.Point(e.originalEvent.changedTouches[0].clientX,e.originalEvent.changedTouches[0].clientY)),t=this.mapToElement(t),this.pickArea().contains(t)?this.getPickerData().trackerPosition=t:this.getPickerData().trackerPosition=new Misc.Point(-1,-1),this.isActive()||this.updateDisplay(),this.transition(e)}widgetMousePressEvent(e){this.transition(e)}widgetKeyPressEvent(e){var t=0,n=0;if(this.keyMatch(Enum.KeyPatternCode.KeyLeft,e)?t=-1:this.keyMatch(Enum.KeyPatternCode.KeyRight,e)?t=1:this.keyMatch(Enum.KeyPatternCode.KeyUp,e)?n=-1:this.keyMatch(Enum.KeyPatternCode.KeyDown,e)?n=1:this.keyMatch(Enum.KeyPatternCode.KeyAbort,e)?this.reset():this.transition(e),0!==t||0!==n){var r=pickArea(),i=this.parentWidget().mapToElement(new Misc.Point(clientX,clientY)),a=i.x+t;a=Math.max(r.left(),a),a=Math.min(r.right(),a);var s=i.y+n;s=Math.max(r.top(),s),s=Math.min(r.bottom(),s)}}widgetMouseReleaseEvent(e){this.transition(e)}end(e){var t=this.getPickerData();return t.isActive?(this.setMouseTracking(!1),t.isActive=!1,Static.trigger("activated",!1),this.trackerMode()==Static.ActiveOnly&&(t.trackerPosition=new Misc.Point(-1,-1)),e&&(e=this.accept(t.pickedPoints)),e?Static.trigger("selected",t.pickedPoints):t.pickedPoints=[],this.updateDisplay()):e=!1,e}begin(){var e=this.getPickerData();if(e&&!e.isActive){if(e.pickedPoints=[],e.isActive=!0,Static.trigger("activated",!0),this.trackerMode()!==Static.AlwaysOff&&(e.trackerPosition.x<0||e.trackerPosition.y<0)){var t=this.parentWidget();t&&(e.trackerPosition=t.mapToElement(new Misc.Point(0,0)))}this.updateDisplay(),this.setMouseTracking(!0)}}trackerText(e){var t;switch(this.rubberBand()){case Static.HLineRubberBand:t=e.y.toString();break;case Static.VLineRubberBand:t=e.x.toString();break;default:t=e.x.toString()+", "+e.y.toString()}return t}}Picker.pickers=[],define("picker",["static","widgetOverlay","pickermachine"],function(){});class PlotPicker extends Picker{constructor(e,t,n,r,i){var a=0;if("number"!=typeof e&&(i=e,e=-1,t=-1,n=Static.NoRubberBand,r=Static.AlwaysOff,a=1),"number"!=typeof n&&(i=n,n=Static.NoRubberBand,r=Static.AlwaysOff,a=2),i instanceof Plot&&(i=i.getCentralWidget()),super(n,r,i),this.d_xAxis=-1,this.d_yAxis=-1,1==a){var s=this.plot();e=xBottom;s&&!s.axisEnabled(xBottom)&&s.axisEnabled(xTop)&&(e=xTop);t=yLeft;s&&!s.axisEnabled(yLeft)&&s.axisEnabled(yRight)&&(t=yRight),this.setAxis(e,t)}else this.d_xAxis=e,this.d_yAxis=t;this.setEnabled(!0),i&&i.setEnabled_1(!0)}setAxis(e,t){this.plot()&&(e==this.d_xAxis&&t==this.d_yAxis||(this.d_xAxis=e,this.d_yAxis=t))}xAxis(){return this.d_xAxis}yAxis(){return this.d_yAxis}plot(){var e=this.parentWidget();return e?e.plot:null}canvas(){return this.parentWidget()}scaleRect(){var e=null;if(this.plot()){var t=this.plot().axisScaleDiv(this.xAxis()),n=this.plot().axisScaleDiv(this.yAxis());e=(e=new Misc.Rect(t.lowerBound(),n.lowerBound(),t.range(),n.range())).normalized()}return e}invTransform(e){var t=this.plot().canvasMap(this.d_xAxis),n=this.plot().canvasMap(this.d_yAxis);if(_.has(e,"x")&&_.has(e,"y")){var r=e;return new Misc.Point(t.invTransform(r.x),n.invTransform(r.y))}return ScaleMap.invTransform_Rect(t,n,e)}transform(e){var t=this.plot().canvasMap(this.d_xAxis),n=this.plot().canvasMap(this.d_yAxis);if(void 0!==e.x){var r=e;return new Misc.Point(t.transform(r.x),n.transform(r.y))}return Static.mTransform(t,n,e)}trackerText(e){var t;switch(e=this.invTransform(e),this.rubberBand()){case Static.HLineRubberBand:t=e.y.toString();break;case Static.VLineRubberBand:t=e.x.toString();break;default:t=e.x.toString()+", "+e.y.toString()}return t}move(e){super.method(move(e)),Static.trigger("moved",invTransform(e))}append(e){super.method(append(e)),Static.trigger("appended",invTransform(e))}end(e=!0){if(!(e=super.end(e)))return!1;if(!this.plot())return!1;var t=this.selection();if(0==t.length)return!1;var n=Static.NoSelection;switch(this.stateMachine()&&(n=this.stateMachine().selectionType()),n){case Static.PointSelection:var r=this.invTransform(t[0]);Static.trigger("selected",r);break;case Static.RectSelection:if(t.length>=2){var i=t[0],a=t[t.length-1],s=new Misc.Rect(i,a).normalized();Static.trigger("selected",this.invTransform(s))}break;case Static.PolygonSelection:for(var o=[],l=0;l<t.length;l++)o.push(this.invTransform(t[l]));Static.trigger("selected",o)}return!0}}define("plotpicker",["static","picker"],function(){});class MPicker extends PlotPicker{constructor(e,t,n){super(e);var r=this;this._rulerPos=t,this._ruler=n;var i=0,a=0,s=0,o="",l=null,c=null,u=!1,h=0;this._ruler&&this._ruler.setAxes(this.xAxis(),this.yAxis());var d=Static.FullTrackingText;this.plot()&&(o=this.plot().cursor()),this.preventDragging=function(e){u=e},this.controlFlag=function(e){return Boolean(h&e)},this.setControlFlag=function(e,t){t?h|=e:h&=~e},this.prohibit=function(){i&&this.controlFlag(Static.ZoomerSearch)&&(this.setControlFlag(Static.ZoomEnabled,i.isEnabled()),this.controlFlag(Static.ZoomEnabled)&&i.setEnabled(!1)),a&&this.controlFlag(Static.PannerSearch)&&(this.setControlFlag(Static.PanEnabled,a.isEnabled()),this.controlFlag(Static.PanEnabled)&&a.setEnabled(!1)),s&&this.controlFlag(Static.MagnifierSearch)&&(this.setControlFlag(Static.MagnifierEnabled,s.isEnabled()),this.controlFlag(Static.MagnifierEnabled)&&s.setEnabled(!1))},this.restore=function(){i&&this.controlFlag(Static.ZoomEnabled)&&(i.setEnabled(!0),this.setControlFlag(Static.ZoomEnabled,!1)),a&&this.controlFlag(Static.PanEnabled)&&(a.setEnabled(!0),this.setControlFlag(Static.PanEnabled,!1)),s&&this.controlFlag(Static.MagnifierEnabled)&&(s.setEnabled(!0),this.setControlFlag(Static.MagnifierEnabled,!1))},this.setDragCursor=function(){u||this.controlFlag(Static.DragCursor)||e.cursor()==o&&(l=e.cursor(),c=this._dragCursorShape,e.setCursor(c),this.setControlFlag(Static.DragCursor,!0),this.prohibit(),Static.trigger("rulerSelected",r._ruler))},this.clearDragCursor=function(){this.controlFlag(Static.DragCursor)&&(this._ruler.plot().setCursor(l),this.setControlFlag(Static.DragCursor,!1),this.restore(),Static.trigger("rulerDeselected",r._ruler))},this.setTrackingTextStyle=function(e){d=e},this.trackerText=function(e){if(this._ruler.lock()||d==Static.NoTrackingText||!this.controlFlag(Static.LeftButtonDown)&&!this.controlFlag(Static.ZoomEnabled))return"";if(d==Static.FullTrackingText){var t=this.axisTitle();return t.length?t+"="+this._rulerPos:this._rulerPos}return d==Static.PartialTrackingText?this._rulerPos:""},this.panningFinished=function(){this.setControlFlag(Static.PanningInProgress,!1)},this.panningStarted=function(){this.setControlFlag(Static.PanningInProgress,!0)},$("#plotDivContainer").on("mouseup touchend",function(){Static.LeftButtonDown&&(Static.isMobile()&&r.clearDragCursor(),r.setControlFlag(Static.LeftButtonDown,!1))}),this.initMagnifier=function(){this.controlFlag(Static.MagnifierSearch)&&!s&&e.magnifier&&(s=e.magnifier)},this.initZoomer=function(){!this.controlFlag(Static.ZoomerSearch)&&i||e.zoomer&&(i=e.zoomer)},this.initPanner=function(){!this.controlFlag(Static.PannerSearch)&&a||e.panner&&(a=e.panner)},this.doMouseReleaseEvent=function(e){this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)&&(e.button==Static.LeftButton&&(this.controlFlag(Static.LeftButtonDown)&&Static.trigger("positionChanged",[this._ruler,this._rulerPos]),this.setControlFlag(Static.LeftButtonDown,!1)),Static.isMobile()&&(this.controlFlag(Static.LeftButtonDown)&&Static.trigger("positionChanged",[this._ruler,this._rulerPos]),this.setControlFlag(Static.LeftButtonDown,!1)))}}widgetMouseReleaseEvent(e){this.doMouseReleaseEvent(e),super.widgetMouseReleaseEvent(e)}widgetLeaveEvent(e){this.doMouseReleaseEvent(e),super.widgetMouseReleaseEvent(e)}}class PickerV extends MPicker{constructor(e,t,n){super(e,t,n),this._dragCursorShape="w-resize",this.axisTitle=function(){return this._ruler.plot().axisTitle(this.xAxis())}}widgetMousePressEvent(e){if(this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)){if(2==e.button)return this.controlFlag(Static.DragCursor),!0;if(Static.isMobile()){var t=this._ruler.plot().transform(this.xAxis(),this._rulerPos),n=e.originalEvent.touches[0].clientX,r=e.originalEvent.touches[0].clientY,i=this.mapToElement(new Misc.Point(n,r)).x;!this.controlFlag(Static.LeftButtonDown)&&i<t+12&&i>t-12&&(this.setDragCursor(),this.setControlFlag(Static.LeftButtonDown,!0))}else if(e.button==Static.LeftButton||Static.isMobile())return this.controlFlag(Static.DragCursor)&&this.setControlFlag(Static.LeftButtonDown,!0),!0}}widgetMouseMoveEvent(e){if(e.preventDefault(),this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)&&!this.controlFlag(Static.Locked)){var t=this._ruler.plot(),n=e.clientX,r=e.clientY;if(Static.isMobile()){var i=e.originalEvent.changedTouches[0];n=parseInt(i.clientX),r=parseInt(i.clientY)}var a=this.mapToElement(new Misc.Point(n,r)).x,s=this._ruler.plot().transform(this.xAxis(),this._rulerPos);this.controlFlag(Static.LeftButtonDown)&&(this._rulerPos=t.invTransform(this.xAxis(),a),this._rulerPos=this._ruler._rulers.setPosition(this._ruler._rulers.rulerId(this._ruler),this._rulerPos),Static.trigger("positionChanging",[this._ruler,this._ruler._pos])),!this.controlFlag(Static.LeftButtonDown)&&a<s+2&&a>s-2&&this.setDragCursor(),this.controlFlag(Static.LeftButtonDown)||a<s+2&&a>s-2||this.clearDragCursor()}}}class PickerH extends MPicker{constructor(e,t,n){super(e,t,n),this._dragCursorShape="s-resize",this.axisTitle=function(){return this._ruler.plot().axisTitle(this.yAxis())}}widgetMousePressEvent(e){if(this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)){if(2==e.button)return this.controlFlag(Static.DragCursor),!0;if(Static.isMobile()){var t=this._ruler.plot().transform(this.yAxis(),this._rulerPos),n=e.originalEvent.touches[0].clientX,r=e.originalEvent.touches[0].clientY,i=this.mapToElement(new Misc.Point(n,r)).y;!this.controlFlag(Static.LeftButtonDown)&&i<t+12&&i>t-12&&(this.setDragCursor(),this.setControlFlag(Static.LeftButtonDown,!0))}else if(e.button==Static.LeftButton||Static.isMobile())return this.controlFlag(Static.DragCursor)&&this.setControlFlag(Static.LeftButtonDown,!0),!0}}widgetMouseMoveEvent(e){if(e.preventDefault(),this._ruler.isVisible()&&!this.controlFlag(Static.PanningInProgress)&&!this.controlFlag(Static.Locked)){var t=this._ruler.plot(),n=e.clientX,r=e.clientY;if(Static.isMobile()){var i=e.originalEvent.changedTouches[0];n=parseInt(i.clientX),r=parseInt(i.clientY)}var a=this.mapToElement(new Misc.Point(n,r)).y,s=this._ruler.plot().transform(this.yAxis(),this._rulerPos);this.controlFlag(Static.LeftButtonDown)&&(this._rulerPos=t.invTransform(this.yAxis(),a),this._rulerPos=this._ruler._rulers.setPosition(this._ruler._rulers.rulerId(this._ruler),this._rulerPos),Static.trigger("positionChanging",[this._ruler,this._ruler._pos])),!this.controlFlag(Static.LeftButtonDown)&&a<s+2&&a>s-2&&this.setDragCursor(),this.controlFlag(Static.LeftButtonDown)||a<s+2&&a>s-2||this.clearDragCursor()}}}define("mpicker",["static","plotpicker"],function(){});class Ruler extends PlotMarker{constructor(e,t,n){super(t),this._picker=0,this._pos=Number.MAX_VALUE,this._rightClickMenu=0,this._rulers=null,n!=VLine&&n!=HLine||(this.setLineStyle(n),this.setLinePen(new Misc.Pen("blue"))),this.attach(e),this.setMouseTracking=function(e){this._picker.setMouseTracking(e)}}}Ruler.prototype.toString=function(){return"[Ruler]"},Ruler.prototype.setPicker=function(e){return!!e&&(this._picker=e,!0)},Ruler.prototype.setZoomerSearch=function(e){this._picker.setControlFlag(Static.ZoomerSearch,e),this._picker.initZoomer()},Ruler.prototype.setPannerSearch=function(e){this._picker.setControlFlag(Static.PannerSearch,e)},Ruler.prototype.setLock=function(e){this._picker.setControlFlag(Static.Locked,e),this._picker.clearDragCursor()},Ruler.prototype.lock=function(){return this._picker.controlFlag(Static.Locked)},Ruler.prototype.setTrackingTextStyle=function(e){this._picker.setTrackingTextStyle(e)},Ruler.prototype.trackingTextStyle=function(){return this._picker.trackingTextStyle()},Ruler.prototype.setTrackingTextFont=function(e){this._picker.setTrackerFont(e)},Ruler.prototype.trackingTextFont=function(){return this._picker.trackerFont()},Ruler.prototype.setTrackingTextColor=function(e){var t=this._picker.trackerFont();t.fontColor=e,this._picker.setTrackerFont(t)},Ruler.prototype.trackingTextColor=function(){return this._picker.trackerFont().color},Ruler.prototype.validatePosition=function(e,t){},Ruler.prototype.dragCursorShape=function(){return this._picker.dragCursorShape()},Ruler.prototype.setDragCursorShape=function(e){this._picker.setDragCursorShape(e)},Ruler.prototype.setRightClickMenu=function(e){};class RulerV extends Ruler{constructor(e,t,n){super(e,t,VLine),n&&(this._rulers=n),this._picker=new PickerV(e,this._pos,this)}}RulerV.prototype.setPosition=function(e){this._pos=e,this._picker._rulerPos=e,this.setXValue(this._pos)};class RulerH extends Ruler{constructor(e,t,n){super(e,t,HLine),n&&(this._rulers=n),this._picker=new PickerH(e,this._pos,this)}}RulerH.prototype.setPosition=function(e){this._pos=e,this._picker._rulerPos=e,this.setYValue(this._pos)},define("ruler",["static","plotMarker"],function(){});class MRulerV extends RulerV{constructor(e,t,n){super(e,t,n),this.rulers=function(){return this._rulers},this.validatePosition=function(){var e=!1,t=this.plot(),n=t.axisInterval(this.xAxis()),r=n.minValue(),i=n.maxValue(),a=t.transform(this._picker.xAxis(),r),s=t.transform(this._picker.xAxis(),i),o=t.transform(this._picker.xAxis(),this._pos),l=this._rulers.minX(),c=this._rulers.maxX(),u=2;Static.isMobile()&&(u=12);var h,d=.5*(this.rulers().ruler(0).linePen().width+this.rulers().ruler(1).linePen().width)+u,f=this._rulers.rulerId(this);0==f&&(this._rulers.ruler(1).isVisible()?(o>=(h=t.transform(this._picker.xAxis(),this._rulers.ruler(1)._pos))-d&&(this._pos=t.invTransform(this._picker.xAxis(),h-d),e=!0),o<a&&(this._pos=t.invTransform(this._picker.xAxis(),a),e=!0),this._rulers._curve&&this._pos<l&&(this._pos=l,e=!0)):(o<a&&(this._pos=t.invTransform(this._picker.xAxis(),a),e=!0),o>s&&(this._pos=t.invTransform(this._picker.xAxis(),s),e=!0),this._rulers._curve&&this._pos<l&&(this._pos=l,e=!0),this._rulers._curve&&this._pos>c&&(this._pos=c,e=!0)));1==f&&(this._rulers.ruler(0).isVisible()?(o<=(h=t.transform(this._picker.xAxis(),this._rulers.ruler(0)._pos))+d&&(this._pos=t.invTransform(this._picker.xAxis(),h+d),e=!0),o>s&&(this._pos=t.invTransform(this._picker.xAxis(),s),e=!0),this._rulers._curve&&this._pos>c&&(this._pos=c,e=!0)):(o<a&&(this._pos=t.invTransform(this._picker.xAxis(),a),e=!0),o>s&&(this._pos=t.invTransform(this._picker.xAxis(),s),e=!0),this._rulers._curve&&this._pos<l&&(this._pos=l,e=!0),this._rulers._curve&&this._pos>c&&(this._pos=c,e=!0)));return e}}setVisible(e){if(super.setVisible(e),e&&this._rulers){var t=this._rulers.rulerId(this);0==t&&this._rulers.ruler(1).isVisible()||1==t&&this._rulers.ruler(0).isVisible()}else this._pos=Number.MAX_VALUE,this._rulers.updateWatchesAndTable()}setLockAt(e){this.setPosition(e),this.setLock(!0),Static.trigger("positionChanged",[this,e])}}class MRulerH extends RulerH{constructor(e,t,n){super(e,t,n),this.rulers=function(){return this._rulers},this.validatePosition=function(){var e=this.plot(),t=e.axisInterval(this.yAxis()),n=t.minValue(),r=t.maxValue(),i=e.transform(this.yAxis(),n),a=e.transform(this.yAxis(),r),s=e.transform(this.yAxis(),this._pos),o=this._rulers.minY(),l=this._rulers.maxY(),c=2;Static.isMobile()&&(c=12);var u,h=.5*(this.rulers().ruler(2).linePen().width+this.rulers().ruler(3).linePen().width)+c,d=this._rulers.rulerId(this);2==d&&(this._rulers.ruler(3).isVisible()?(s<=(u=e.transform(this.yAxis(),this._rulers.ruler(3)._pos))+h&&(this._pos=e.invTransform(this.yAxis(),u+h)),s>i&&(this._pos=e.invTransform(this.yAxis(),i)),this._rulers._curve&&this._pos<o&&(this._pos=o)):(s<a&&(this._pos=e.invTransform(this.yAxis(),a)),s>i&&(this._pos=e.invTransform(this.yAxis(),i)),this._rulers._curve&&this._pos<o&&(this._pos=o),this._rulers._curve&&this._pos>l&&(this._pos=l)));3==d&&(this._rulers.ruler(2).isVisible()?(s>=(u=e.transform(this.yAxis(),this._rulers.ruler(2)._pos))-h&&(this._pos=e.invTransform(this.yAxis(),u-h)),s<a&&(this._pos=e.invTransform(this.yAxis(),a)),this._rulers._curve&&this._pos>l&&(this._pos=l)):(s>i&&(this._pos=e.invTransform(this.yAxis(),i)),s<a&&(this._pos=e.invTransform(this.yAxis(),a)),this._rulers._curve&&this._pos<o&&(this._pos=o),this._rulers._curve&&this._pos>l&&(this._pos=l)))}}setVisible(e){if(super.setVisible(e),e&&this._rulers){var t=this._rulers.rulerId(this);2==t&&this._rulers.ruler(3).isVisible()||3==t&&this._rulers.ruler(2).isVisible()}else this._pos=Number.MAX_VALUE,this._rulers.updateWatchesAndTable()}setLockAt(e){this.setPosition(e),this.setLock(!0),Static.trigger("positionChanged",[this,e])}}function Rulers(e,t){var n=this,r=[{name:"hide...",img:"images/hide.png",title:"hide the ruler.",fun:function(){e.rv.currentRuler.setVisible(!1),e.rv.currentRuler._picker.clearDragCursor(),e.rv.hasVisibleRuler()}},{name:"lock...",img:"images/lock.png",title:"lock the ruler in its current position.",fun:function(){e.rv.currentRuler.setLock(!0),e.rv.hasLockedRuler()}},{name:"lock at...",img:"images/lockAt.png",title:"lock the ruler at a specific position.",fun:function(){var t=0;t=e.rv.currentRuler instanceof RulerH?e.rv.currentRuler.yValue():e.rv.currentRuler.xValue(),Static.prompt("Enter a position",t,function(t){return e.rv.currentRuler.setLockAt(parseFloat(t)),!0},"small")}}],i=[{name:"Hide rulers",img:"images/hide.png",title:"Hide all rulers",fun:function(){e.rv.setVisible(!1)}},{name:"Show rulers",img:"images/show.png",title:"Show any hidden rulers",fun:function(){e.rv.setVisible(!0)}},{name:"Unlock rulers",img:"images/unlock.png",title:"Unlock any locked rulers",fun:function(){e.rv.unlockAllRulers()}}];if(this.setRulerDeselectMenu=function(e){i=e||[]},this._curve=0,this._watchTable=new WatchTable(this),this._editor=0,this._curveShapeItem=0,this._watchSetter=0,this._rulerList=null,this._watchList=[],this.sidebarVisible=!1,e.setAutoReplot(!0),this._rulerList=[new MRulerV(e,"v_ruler1",n),new MRulerV(e,"v_ruler2",n),new MRulerH(e,"h_ruler1",n),new MRulerH(e,"h_ruler2",n)],Static.isMobile())for(var a=0;a<4;++a){var s=this._rulerList[a].linePen();s.width=2*s.width}this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this.minX=function(){return this._minX},this.maxX=function(){return this._maxX},this.minY=function(){return this._minY},this.maxY=function(){return this._maxY},this.currentRuler=null;var o=e.getLayout().getCentralDiv(),l=!1;Static.bind("rulerSelected",function(e,t){n.currentRuler=t,l&&o.contextMenu("destroy"),l=!0,o.contextMenu(r,{triggerOn:"contextmenu",zIndex:1})}),Static.bind("rulerDeselected",function(){l&&o.contextMenu("destroy"),l=!0,o.contextMenu(i,{triggerOn:"contextmenu",zIndex:1})}),this.init(e),this.position=function(e){return e>-1&&e<4&&this._rulerList[e].isVisible()?this._rulerList[e]._pos:Number.MAX_VALUE},this.watch=function(e){return e>=0&&e<this._watchList.length?this._watchList[e]:null},this.addToWatchList=function(e){return this._watchList.push(e),this._watchList.length-1},this.setWatchEnabled=function(e,t){if(e>=0&&e<this._watchList.length){if(this._watchList[e].isEnable()==t)return;this._watchList[e].setEnable(t),t&&this.updateWatch(this._watchList[e]),this._watchTable.updateWatchTable()}},this.isWatchEnabled=function(e){return e>=0&&e<this._watchList.length&&this._watchList[e].isEnable()},Static.bind("showSidebar",function(e,t,r){"right"==t&&(n.sidebarVisible=r)}),this.updateWatchesAndTable=function(){n.sidebarVisible&&this._curve&&(this.updateWatches(),this._watchTable&&this._watchTable.updateWatchTable())},this.setVisible=function(e){this._rulerList.forEach(function(t){t.setVisible(e)}),e&&Static.trigger("curveAdjusted"),this.refresh()},this.hasVisibleRuler=function(){for(var e=0;e<4;++e)if(this._rulerList[e].isVisible())return!0;return!1},this.hasLockedRuler=function(){for(var e=0;e<4;++e)if(this._rulerList[e].lock())return!0;return!1},this.updateWatch=function(t){if(t.isEnable()){var n=e.autoReplot();e.setAutoReplot(!1),t.setCurveName(this._curve.title()),t.setRulerLeft(this.position(0)),t.setRulerRight(this.position(1)),t.setRulerBottom(this.position(2)),t.setRulerTop(this.position(3)),this._curve&&t.setCurve(this._curve),e.setAutoReplot(n),e.autoRefresh(),t.computeWatch()}},this.updateWatches=function(){var t=e.autoReplot();e.setAutoReplot(!1),this._watchList.forEach(function(e){n.updateWatch(e)}),e.setAutoReplot(t),e.autoRefresh()},this.setEnabled=function(e){this._rulerList.forEach(function(t){t._picker.setEnabled(e)})},this.setMouseTracking=function(e){this._rulerList.forEach(function(t){t._picker.setMouseTracking(e)})},this.setZoomerSearch(!0),this.setPannerSearch(!0),this.setMouseTracking(!0),Static.bind("zoomerAdded",function(e,t){n.setZoomerSearch(n._rulerList[0]._picker.controlFlag(Static.ZoomerSearch)),n.setMouseTracking(!0)}),Static.bind("pannerAdded",function(e,t){n.setPannerSearch(n._rulerList[0]._picker.controlFlag(Static.PannerSearch)),n.setMouseTracking(!0)}),Static.bind("currentCurveChanged",function(e,t){n.setCurrentCurve(t)}),e.rv=this,Static.trigger("rulerDeselected")}Rulers.prototype.unlockAllRulers=function(){for(var e=0;e<this._rulerList.length;++e)this._rulerList[e].setLock(!1)},Rulers.prototype.setCurrentCurve=function(e){this._curve!=e&&this.doSetCurrentCurve(e)},Rulers.prototype.refresh=function(){var e=this._rulerList[0].plot();if(this._curve&&this._curve.isVisible()){var t=e.axisInterval(this._rulerList[0].xAxis()),n=t.minValue(),r=t.maxValue(),i=e.axisInterval(this._rulerList[0].yAxis()),a=i.minValue(),s=i.maxValue();n=this._minX<n?n:this._minX,this._rulerList[0].setPosition(n),r=this._maxX<r?this._maxX:r,this._rulerList[1].setPosition(r),a=this._minY<a?a:this._minY,this._rulerList[2].setPosition(a),s=this._maxY<s?this._maxY:s,this._rulerList[3].setPosition(s),this.updateWatchesAndTable()}else this.resetXPositions(),this.resetYPositions()},Rulers.prototype.doSetRulersAxes=function(e,t){var n=this._rulerList[0].plot(),r=n.autoReplot();n.setAutoReplot(!1);this._rulerList[0].xAxis(),this._rulerList[0].yAxis();for(var i=0;i<this._rulerList.length;++i)this._rulerList[i].setAxes(e,t),this._rulerList[i]._picker.setAxis(e,t);n.setAutoReplot(r),n.autoRefresh()},Rulers.prototype.adjustToCurve=function(e){this._curve=e,this._curve&&(this._curve.isVisible()&&(this._minX=this._curve.minXValue(),this._maxX=this._curve.maxXValue(),this._minY=this._curve.minYValue(),this._maxY=this._curve.maxYValue()),this.doSetRulersAxes(this._curve.xAxis(),this._curve.yAxis()),this._curveShapeItem),this.refresh()},Rulers.prototype.doSetCurrentCurve=function(e){this._curve;this.adjustToCurve(e)},Rulers.prototype.setCurrentCurve=function(e){this._curve!=e&&this.doSetCurrentCurve(e)},Rulers.prototype.currentCurve=function(){return this._curve},Rulers.prototype.init=function(e){var t=this;this._rulerList;Static.bind("positionChanged",function(e,n,r){t.updateWatchesAndTable()}),Static.bind("curveAdjusted",function(){t.refresh()}),Static.bind("pointAdded pointRemoved",function(e,n){t.doSetCurrentCurve(n)}),Static.bind("axisChanged",function(e,n,r){t.currentCurve()===r&&t.adjustToCurve(r)}),this._rulerList[0].linePen().color="red",this._rulerList[2].linePen().color="red",this.resetXPositions(),this.resetYPositions()},Rulers.prototype.setZoomerSearch=function(e){this._rulerList.forEach(function(t){t.setZoomerSearch(e),t._picker.initZoomer()})},Rulers.prototype.setPannerSearch=function(e){this._rulerList.forEach(function(t){t.setPannerSearch(e),t._picker.initPanner()})},Rulers.prototype.setPosition=function(e,t){if(t=parseFloat(t),this._rulerList[e]._pos==t)return t;var n=this._rulerList[e]._pos;return this._rulerList[e]._pos=t,this._rulerList[e].validatePosition(),this._rulerList[e]._pos!==n&&this._rulerList[e].setPosition(this._rulerList[e]._pos),this._rulerList[e]._pos},Rulers.prototype.resetXPositions=function(){var e=this._rulerList[0].plot(),t=e.autoReplot();e.setAutoReplot(!1);var n=e.axisInterval(this._rulerList[0].xAxis());this._curve&&this._curve.isVisible()?(n.minValue()>this._minX?this._rulerList[0].setPosition(n.minValue()):this._rulerList[0].setPosition(this._minX),n.maxValue()<this._maxX?this._rulerList[1].setPosition(n.maxValue()):this._rulerList[1].setPosition(this._maxX)):(this._rulerList[0].setPosition(n.minValue()),this._rulerList[1].setPosition(n.maxValue())),e.setAutoReplot(t),e.autoRefresh()},Rulers.prototype.resetYPositions=function(){var e=this._rulerList[0].plot(),t=e.autoReplot();e.setAutoReplot(!1);var n=e.axisInterval(this._rulerList[0].yAxis());this._curve&&this._curve.isVisible()?(this._rulerList[2].setPosition(this._minY),this._rulerList[3].setPosition(this._maxY),n.minValue()>this._minY?this._rulerList[2].setPosition(n.minValue()):this._rulerList[2].setPosition(this._minY),n.maxValue()<this._maxY?this._rulerList[3].setPosition(n.maxValue()):this._rulerList[3].setPosition(this._maxY)):(this._rulerList[2].setPosition(n.minValue()),this._rulerList[3].setPosition(n.maxValue())),e.setAutoReplot(t),e.autoRefresh()},Rulers.prototype.ruler=function(e){return e<4&&e>=0?this._rulerList[e]:0},Rulers.prototype.rulerId=function(e){return e?this._rulerList.indexOf(e):-1},Rulers.prototype.preventDragging=function(e){for(var t=0;t<this._rulerList.length;++t)this._rulerList[t]._picker.preventDragging(e)},Rulers.prototype.setRulersXAxis=function(e){var t=this._rulerList[0].plot(),n=t.autoReplot();t.setAutoReplot(!1);for(var r=0;r<this._rulerList.length;++r)this._rulerList[r].setXAxis(e),this._rulerList[r]._picker.setAxis(e,this._rulerList[r].yAxis());this._curveShapeItem&&this._curveShapeItem.setAxes(e,this._rulerList[0].yAxis()),t.setAutoReplot(n),t.autoRefresh()},Rulers.prototype.setRulersYAxis=function(e){var t=this._rulerList[0].plot(),n=t.autoReplot();t.setAutoReplot(!1);for(var r=0;r<this._rulerList.length;++r)this._rulerList[r].setYAxis(e),this._rulerList[r]._picker.setAxis(this._rulerList[r].xAxis(),e);this._curveShapeItem&&this._curveShapeItem.setAxes(_rulerList[0].xAxis(),e),t.setAutoReplot(n),t.autoRefresh()};class WatchTable{constructor(e){this.removeAllRows=function(){for(var e=$("#watchTableBody").children(),t=0;t<e.length;++t)$("#watchTableBody")[0].removeChild(e[t])},this.insertInfoRow=function(e){!function(e){var t=e.name(),n=e.value();if("number"==e.valueType||"text"==e.valueType){for(var r=t;-1!=r.indexOf(" ");)r=r.replace(" ","");var i=$("<tr><td>"+t+"</td></tr>");$("#watchTableBody").append(i);var a=$("<td><input id="+r+" type="+e.valueType+'  style="width:100%" value='+n+" /></td>");i.append(a),$("#"+r).on("change",e.cb)}else $("#watchTableBody").append($("<tr><td>"+t+"</td><td>"+n+"</td></tr>"))}(e)},this.updateWatchTable=function(){if(this.removeAllRows(),e._curve&&e._curve.isVisible())for(var t=e._watchList.length,n=0;n<t;++n){var r=e.watch(n);r.isEnable()&&this.insertInfoRow(r)}}}}define("rulers",["static","mpicker","ruler"],function(){});class SideBar{constructor(e,t,n){var r=this;r.sideBarVisible=!1;var i=n||"right",a=$('<div class="grid-container" style="position: absolute; border: 1px solid lightgray;"/>');e.append(a),a.css("bottom",0),a.css("top",0);class s{constructor(){this.visible=!0,this.headerElement=null,this.bodyElement=null,this.element=null,this.anchorPosition=""}}for(var o=[],l=0,c=0;c<t;++c){var u=new s;u.anchorPosition=i,u.element=$('<div class="grid-item"></div>'),a.append(u.element),u.headerElement=$('<div class="grid-item-header"></div>'),u.element.append(u.headerElement),u.bodyElement=$('<div class="grid-item-body"></div>'),u.element.append(u.bodyElement),o.push(u),++l}this.hideAllGridItems=function(){for(var e=0;e<t;++e)this.doShowGridItem(e,!1)},this.setHeaderElement=function(e,t){o[e].headerElement.css("height",t+"px"),this.setGridItemHeigth()},this.setGridItemHeigth=function(){parseInt(a.css("height"));for(var e=1/l*100,t=0;t<o.length;++t)if(o[t].visible){o[t].element.css("height",e+"%");var n=parseInt(o[t].element.css("height")),r=100*(1-parseInt(o[t].headerElement.css("height"))/n);o[t].bodyElement.css("height",r+"%")}},this.doShowGridItem=function(e,t){if(o[e].visible!=t)return t?(this.sideBarVisible||this.showSidebar(!0),o[e].element.show(),++l):(o[e].element.hide(),0===--l&&this.showSidebar(!1)),o[e].visible=t,this.setGridItemHeigth(),Static.trigger("showGridItem",[i,e,t]),l},this.gridItem=function(e){return e<o.length?o[e]:null},this.gridItemCount=function(){return o.length},this.setGridItemHeigth(),a.css("width","20%"),this.isSideBarVisible=function(){return r.sideBarVisible},this.sideBarWidth=function(){return 20},this.setTop=function(e){a.css("top",e)},this.setBorderStyle=function(e){a.css("border-style",e)},this.setBorderWidth=function(e){a.css("border-width",e)},this.setBackgroundColor=function(e){a.css("background-color",e)},this.html=function(){return a};var h=!1;Static.bind("beforePrint",function(){r.sideBarVisible&&(h=!0,r.showSidebar(!1))}),Static.bind("afterPrint",function(){h&&(h=!1,r.showSidebar(!0))}),this.anchorPosition=function(){return i},this.getIndexFromHeaderElement=function(e){for(var t=0;t<r.gridItemCount();++t)if(r.gridItem(t).headerElement[0].offsetTop==e.offsetTop&&r.gridItem(t).headerElement[0].innerText==e.innerText)return t;return-1},this.hideGridItemWithHeaderElement=function(e){for(var t=0;t<r.gridItemCount();++t)if(r.gridItem(t).headerElement[0].offsetTop==e.offsetTop&&r.gridItem(t).headerElement[0].innerText==e.innerText)return r.showGridItem(t,!1);return-1},this.hideAllGridItems(),a.hide()}showSidebar(e){if(this.isSideBarVisible()!=e){this.sideBarVisible=e,e?(this.html().show(),"right"==this.anchorPosition()?this.html().css("right","0.5%"):"left"==this.anchorPosition()&&this.html().css("left","0.5%")):this.html().hide();var t=parseFloat($("#plotDiv").css("width"))/parseFloat($("#plotDiv").parent().css("width"))*100;e?"right"==this.anchorPosition()?$("#plotDiv").css("width",t-this.sideBarWidth()+"%"):"left"==this.anchorPosition()&&($("#plotDiv").css("left",this.sideBarWidth()+"%"),$("#plotDiv").css("width",t-this.sideBarWidth()+"%")):($("#plotDiv").css("width",t+this.sideBarWidth()+"%"),"left"==this.anchorPosition()&&$("#plotDiv").css("left","0%")),Static.trigger("showSidebar",[this.anchorPosition(),e])}}showGridItem(e,t){this.doShowGridItem(e,t)}}define("sideBar",function(){});class InfoSideBar extends SideBar{constructor(e){super($("#plotDiv").parent(),1,"right");var t=this,n=e;this.plot=function(){return n},Static.bind("paneClose",function(e,n){t.hideGridItemWithHeaderElement(n)}),this.setHeaderElement(0,40)}showGridItem(e,t){this.doShowGridItem(e,t)}showSidebar(e){this.isSideBarVisible()!=e&&(super.showSidebar(e),this.plot().autoRefresh())}}define("infoSidebar",["sideBar"],function(){}),function(e){"use strict";var t,n,r;t=function(){function t(t,n,r){var i;this.row=t,this.tree=n,this.settings=r,this.id=this.row.data(this.settings.nodeIdAttr),null!=(i=this.row.data(this.settings.parentIdAttr))&&""!==i&&(this.parentId=i),this.treeCell=e(this.row.children(this.settings.columnElType)[this.settings.column]),this.expander=e(this.settings.expanderTemplate),this.indenter=e(this.settings.indenterTemplate),this.cell=e(this.settings.cellTemplate),this.children=[],this.initialized=!1,this.treeCell.prepend(this.indenter),this.treeCell.wrapInner(this.cell)}return t.prototype.addChild=function(e){return this.children.push(e)},t.prototype.ancestors=function(){var e,t;for(t=this,e=[];t=t.parentNode();)e.push(t);return e},t.prototype.collapse=function(){return this.collapsed()?this:(this.row.removeClass("expanded").addClass("collapsed"),this._hideChildren(),this.expander.attr("title",this.settings.stringExpand),this.initialized&&null!=this.settings.onNodeCollapse&&this.settings.onNodeCollapse.apply(this),this)},t.prototype.collapsed=function(){return this.row.hasClass("collapsed")},t.prototype.expand=function(){return this.expanded()?this:(this.row.removeClass("collapsed").addClass("expanded"),this.initialized&&null!=this.settings.onNodeExpand&&this.settings.onNodeExpand.apply(this),e(this.row).is(":visible")&&this._showChildren(),this.expander.attr("title",this.settings.stringCollapse),this)},t.prototype.expanded=function(){return this.row.hasClass("expanded")},t.prototype.hide=function(){return this._hideChildren(),this.row.hide(),this},t.prototype.isBranchNode=function(){return this.children.length>0||!0===this.row.data(this.settings.branchAttr)},t.prototype.updateBranchLeafClass=function(){this.row.removeClass("branch"),this.row.removeClass("leaf"),this.row.addClass(this.isBranchNode()?"branch":"leaf")},t.prototype.level=function(){return this.ancestors().length},t.prototype.parentNode=function(){return null!=this.parentId?this.tree[this.parentId]:null},t.prototype.removeChild=function(t){var n=e.inArray(t,this.children);return this.children.splice(n,1)},t.prototype.render=function(){var t,n,r=this.settings;return!0===r.expandable&&this.isBranchNode()&&(t=function(t){return e(this).parents("table").treetable("node",e(this).parents("tr").data(r.nodeIdAttr)).toggle(),t.preventDefault()},this.indenter.html(this.expander),(n=!0===r.clickableNodeNames?this.treeCell:this.expander).off("click.treetable").on("click.treetable",t),n.off("keydown.treetable").on("keydown.treetable",function(e){13==e.keyCode&&t.apply(this,[e])})),this.indenter[0].style.paddingLeft=this.level()*r.indent+"px",this},t.prototype.reveal=function(){return null!=this.parentId&&this.parentNode().reveal(),this.expand()},t.prototype.setParent=function(e){return null!=this.parentId&&this.tree[this.parentId].removeChild(this),this.parentId=e.id,this.row.data(this.settings.parentIdAttr,e.id),e.addChild(this)},t.prototype.show=function(){return this.initialized||this._initialize(),this.row.show(),this.expanded()&&this._showChildren(),this},t.prototype.toggle=function(){return this.expanded()?this.collapse():this.expand(),this},t.prototype._hideChildren=function(){var e,t,n,r,i;for(i=[],t=0,n=(r=this.children).length;t<n;t++)e=r[t],i.push(e.hide());return i},t.prototype._initialize=function(){var e=this.settings;return this.render(),!0===e.expandable&&"collapsed"===e.initialState?this.collapse():this.expand(),null!=e.onNodeInitialized&&e.onNodeInitialized.apply(this),this.initialized=!0},t.prototype._showChildren=function(){var e,t,n,r,i;for(i=[],t=0,n=(r=this.children).length;t<n;t++)e=r[t],i.push(e.show());return i},t}(),n=function(){function n(e,t){this.table=e,this.settings=t,this.tree={},this.nodes=[],this.roots=[]}return n.prototype.collapseAll=function(){var e,t,n,r,i;for(i=[],t=0,n=(r=this.nodes).length;t<n;t++)e=r[t],i.push(e.collapse());return i},n.prototype.expandAll=function(){var e,t,n,r,i;for(i=[],t=0,n=(r=this.nodes).length;t<n;t++)e=r[t],i.push(e.expand());return i},n.prototype.findLastNode=function(e){return e.children.length>0?this.findLastNode(e.children[e.children.length-1]):e},n.prototype.loadRows=function(n){var r,i,a;if(null!=n)for(a=0;a<n.length;a++)null!=(i=e(n[a])).data(this.settings.nodeIdAttr)&&(r=new t(i,this.tree,this.settings),this.nodes.push(r),this.tree[r.id]=r,null!=r.parentId&&this.tree[r.parentId]?this.tree[r.parentId].addChild(r):this.roots.push(r));for(a=0;a<this.nodes.length;a++)r=this.nodes[a].updateBranchLeafClass();return this},n.prototype.move=function(t,n){var r=t.parentNode();return t!==n&&n.id!==t.parentId&&-1===e.inArray(t,n.ancestors())&&(t.setParent(n),this._moveRows(t,n),1===t.parentNode().children.length&&t.parentNode().render()),r&&r.updateBranchLeafClass(),t.parentNode()&&t.parentNode().updateBranchLeafClass(),t.updateBranchLeafClass(),this},n.prototype.removeNode=function(t){return this.unloadBranch(t),t.row.remove(),null!=t.parentId&&t.parentNode().removeChild(t),delete this.tree[t.id],this.nodes.splice(e.inArray(t,this.nodes),1),this},n.prototype.render=function(){var e,t,n;for(e=0,t=(n=this.roots).length;e<t;e++)n[e].show();return this},n.prototype.sortBranch=function(e,t){return e.children.sort(t),this._sortChildRows(e),this},n.prototype.unloadBranch=function(e){var t,n=e.children.slice(0);for(t=0;t<n.length;t++)this.removeNode(n[t]);return e.children=[],e.updateBranchLeafClass(),this},n.prototype._moveRows=function(e,t){var n,r=e.children;for(e.row.insertAfter(t.row),e.render(),n=r.length-1;n>=0;n--)this._moveRows(r[n],e)},n.prototype._sortChildRows=function(e){return this._moveRows(e,e)},n}(),r={init:function(t,r){var i;return i=e.extend({branchAttr:"ttBranch",clickableNodeNames:!1,column:0,columnElType:"td",expandable:!1,expanderTemplate:"<a href='#'>&nbsp;</a>",indent:19,indenterTemplate:"<span class='indenter'></span>",cellTemplate:"",initialState:"collapsed",nodeIdAttr:"ttId",parentIdAttr:"ttParentId",stringExpand:"Expand",stringCollapse:"Collapse",onInitialized:null,onNodeCollapse:null,onNodeExpand:null,onNodeInitialized:null},t),this.each(function(){var t,a=e(this);return(r||void 0===a.data("treetable"))&&((t=new n(this,i)).loadRows(this.rows).render(),a.addClass("treetable").data("treetable",t),null!=i.onInitialized&&i.onInitialized.apply(t)),a})},destroy:function(){return this.each(function(){return e(this).removeData("treetable").removeClass("treetable")})},collapseAll:function(){return this.data("treetable").collapseAll(),this},collapseNode:function(e){var t=this.data("treetable").tree[e];if(!t)throw new Error("Unknown node '"+e+"'");return t.collapse(),this},expandAll:function(){return this.data("treetable").expandAll(),this},expandNode:function(e){var t=this.data("treetable").tree[e];if(!t)throw new Error("Unknown node '"+e+"'");return t.initialized||t._initialize(),t.expand(),this},loadBranch:function(t,n){var r=this.data("treetable").settings,i=this.data("treetable").tree;if(n=e(n),null==t)this.append(n);else{var a=this.data("treetable").findLastNode(t);n.insertAfter(a.row)}return this.data("treetable").loadRows(n),n.filter("tr").each(function(){i[e(this).data(r.nodeIdAttr)].show()}),null!=t&&t.render().expand(),this},move:function(e,t){var n,r;return r=this.data("treetable").tree[e],n=this.data("treetable").tree[t],this.data("treetable").move(r,n),this},node:function(e){return this.data("treetable").tree[e]},removeNode:function(e){var t=this.data("treetable").tree[e];if(!t)throw new Error("Unknown node '"+e+"'");return this.data("treetable").removeNode(t),this},reveal:function(e){var t=this.data("treetable").tree[e];if(!t)throw new Error("Unknown node '"+e+"'");return t.reveal(),this},sortBranch:function(t,n){var r,i=this.data("treetable").settings;return r=n=n||i.column,e.isNumeric(n)&&(r=function(t,r){var i,a,s;return(a=(i=function(t){var r=t.row.find("td:eq("+n+")").text();return e.trim(r).toUpperCase()})(t))<(s=i(r))?-1:a>s?1:0}),this.data("treetable").sortBranch(t,r),this},unloadBranch:function(e){return this.data("treetable").unloadBranch(e),this}},e.fn.treetable=function(t){return r[t]?r[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?e.error("Method "+t+" does not exist on jQuery.treetable"):r.init.apply(this,arguments)},window.TreeTable||(window.TreeTable={}),window.TreeTable.Node=t,window.TreeTable.Tree=n}(jQuery),define("treetable",function(){});class Pane{constructor(e){var t=this;t.paneParent=$("<div/>"),e.append(t.paneParent),this.setPaneHeight=function(e){t.paneParent.css("height",e)},this.setHeader=function(e,t,n){n=n||!1;var r=this.header(t);if(n){var i=$('<div><button style="position: absolute; right:1px">X</button></div>');e.append(i),i.on("click",function(){Static.trigger("paneClose",e)})}e.append(r)}}header(e){var t=$('<div style="text-align:center; padding-top: 10px; border-style: solid; border-width:1px; border-color:#666666; font-size: 16px; color:#666666"/>');return t.append("<label>"+e+"</label>"),t}}define("pane",["treetable"],function(){});class InfoPropertiesPane extends Pane{constructor(e,t){super(e);this.setHeader(t.rightSidebar.gridItem(0).headerElement,"Sidebar",!0);var n=$('<div style="background-color:rgba(249, 251, 221, 0.8);  ">                <div style="margin:4px">                <select id="currentCurve" style="width:100%">                </select></div>                <div><input type="text" id="fnDisplay" style="width:100%; background-color:rgba(255, 255, 255, 0.8); padding-left:6px" readonly /></div>                <div><label style="padding-left:6px">onchcange: <input id="onchange" type="checkbox" readonly /> </label>\t\t\t\tdamp: <input id="damp" style="width:30%" type="number" min="1" value="30000" step="500"/>\t\t\t\t</div>                                <div style="height:30%; overflow: auto">                <div id="coeff_cont0" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff0">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val0" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                <br>                <div id="coeff_cont1" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff1">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val1" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                <br>                <div id="coeff_cont2" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff2">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val2" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                <br>                <div id="coeff_cont3" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff3">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val3" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                <br>                <div id="coeff_cont4" style="background-color:lightBlue; margin:2px; border-radius:4px">                <div style="">Coefficient:<b><span id="coeff4">?</span></b></div>                <div style="margin:4px">                <div style="" title="A coefficient in the function that could be ajusted">                value:<input id="coeff_val4" style="width:60%" type="number" value="1" />                </div>                </div>                </div>                </div>                                <div style="text-align:center"><h4>Watches</h4></div>                <div class="table-responsive" style="height: 47%">                                                <table class="table table-bordered" id="watchTable">                <thead>                <tr>                <th>Watch</th>                <th>Value</th>                </tr>                </thead>                <tbody id="watchTableBody">                </tbody>                </table>                                                </div>                </div>');function r(){t.itemList(Static.Rtti_PlotCurve);!function(){for(var e=0;e<5;++e)$("#coeff_cont"+e).hide()}();var e=t.findPlotCurve($("#currentCurve").val());if(e){$("#fnDisplay").val(""),e.fn&&$("#fnDisplay").val("f("+e.variable+")="+e.fn);for(var n=3e4,r=(e.upperX-e.lowerX)/(n/1e4),i=e.coeffs||[],a=i.length,s=0;s<a;++s)$("#coeff_val"+s).attr("step",r);$("#damp").on("input",function(){var t=parseInt($("#damp").val());!_.isFinite(t)||t<1?$("#damp").val(n):n=t,r=(e.upperX-e.lowerX)/(n/1e4);for(var i=0;i<a;++i)$("#coeff_val"+i).attr("step",r)}),a>5&&(a=5);for(s=0;s<a;++s)$("#coeff"+s).html(i[s]),$("#coeff_val"+s).attr("step",r),$("#coeff_val"+s).val(e.coeffsVal[s]),$("#coeff_cont"+s).show()}}function i(){!function(){for(var e=$("#currentCurve").children(),n=0;n<e.length;++n)$("#currentCurve")[0].removeChild(e[n]);var r=t.itemList(Static.Rtti_PlotCurve);for(n=0;n<r.length;++n)if(r[n].isVisible()){var i=$("<option>"+r[n].title()+"</option>");i.attr("value",r[n].title()),$("#currentCurve").append(i)}}(),r(),Static.trigger("currentCurveChanged",t.findPlotCurve($("#currentCurve").val()))}this.paneParent.append(n),t.sidebar=this,this.sidebarDlg=function(){return n};var a=!1;this.sidebarReDisplay=function(){return a},this.setSidebarReDisplay=function(e){a=e},this.setTop=function(e){n.css("top",e)};var s=_.once(function(){$("#currentCurve").change(function(){Static.total_volume=void 0,Static.total_area=void 0,Static.prevStart=void 0,Static.prevEnd=void 0,r(),Static.trigger("currentCurveChanged",t.findPlotCurve($("#currentCurve").val()))}),$("#coeff_val0, #coeff_val1, #coeff_val2, #coeff_val3, #coeff_val4").on("input",function(){$("#onchange")[0].checked||l($(this))&&o()}),$("#coeff_val0, #coeff_val1, #coeff_val2, #coeff_val3, #coeff_val4").on("change",function(){var e;l($(this))?$("#onchange")[0].checked&&o():$(this).val((e=$(this),t.findPlotCurve($("#currentCurve").val()).coeffsVal[["coeff_val0","coeff_val1","coeff_val2","coeff_val3","coeff_val4"].indexOf(e[0].id)]))})});this.initSidebar=function(){i(),s()},this.currentCurveName=function(){return $("#currentCurve").val()};function o(){for(var e=t.findPlotCurve($("#currentCurve").val()),n=e.coeffs,r=e.fn,i=0;i<n.length;++i){for(;-1!=r.indexOf(n[i]);)r=r.replace(n[i],$("#coeff_val"+i).val());e.coeffsVal[i]=$("#coeff_val"+i).val()}e.expandedFn=r;var a=e.data();e.unboundedRange?a.setFn(r):a.setSamples(Utility.makeSamples({fx:r,lowerX:e.lowerX,upperX:e.upperX,numOfSamples:e.numOfSamples})),Static.trigger("curveAdjusted"),t.autoRefresh()}function l(e){var n;t.findPlotCurve($("#currentCurve").val()).coeffsVal,["coeff_val0","coeff_val1","coeff_val2","coeff_val3","coeff_val4"].indexOf(e[0].id);return n=e.val(),!!_.isFinite(parseFloat(n))}Static.bind("titleChange",function(){i()}),Static.bind("pointAdded pointRemoved",function(e,t){$("#currentCurve").val(t.title)}),Static.bind("itemAttached",function(e,n,r){n.rtti==Static.Rtti_PlotCurve&&(r||!t.itemList(Static.Rtti_PlotCurve).length||t.hasVisiblePlotCurve(),Static.trigger("visibilityChange",[n,r]))}),this.initSidebar()}}define("infoPropertiesPane",["pane"],function(){});class PlotSideBar extends SideBar{constructor(e){super($("#plotDiv").parent(),2,"left");var t=this,n=e;this.plot=function(){return n},Static.bind("paneClose",function(e,n){t.hideGridItemWithHeaderElement(n)})}showSidebar(e){this.isSideBarVisible()!=e&&(super.showSidebar(e),this.plot().autoRefresh())}showGridItem(e,t){this.doShowGridItem(e,t)}}define("plotSideBar",["sideBar"],function(){});class PropertiesPane extends Pane{static fontsDisplay(){return["Arial","Arial Black","Comic Sans MS","Courier New","Georgia","Impact","Lucida Console","Lucida Sans Unicode","PalatinoLinotype","Tahoma","Times New Roman","Trebuchet MS","Verdana","Gill Sans"]}static fontGroup(e){return["Arial,Arial,Helvetica,sans-serif","Arial Black,Arial Black,Gadget,sans-serif","Comic Sans MS,Comic Sans MS,cursive","Courier New,Courier New,Courier,monospace","Georgia,Georgia,serif","Impact,Charcoal,sans-serif","Lucida Console,Monaco,monospace","Lucida Sans Unicode,Lucida Grande,sans-serif","Palatino Linotype,Book Antiqua,Palatino,serif","Tahoma,Geneva,sans-serif","Times New Roman,Times,serif","Trebuchet MS,Helvetica,sans-serif","Verdana,Geneva,sans-serif","Gill Sans,Geneva,sans-serif"][e]}constructor(e){super(e);var t=$("<table/>");this.paneParent.append(t),this.table=function(){return t},this.init=function(e){var n=e||{expandable:!0,clickableNodeNames:!0};t.treetable(n)},this.hide=function(e){var n=t.treetable("node",e);n?n.hide():console.error("invalid id: "+e)},this.show=function(e){var n=t.treetable("node",e);n?n.show():console.error("invalid id: "+e)},this.getElementValueDataAttribute=function(e){for(var n=null,r=t[0].getElementsByTagName("TR"),i=0;i<r.length;++i)if(r[i].getAttribute("data-tt-id")==e){n=r[i];break}if(n){var a=n.children;return 2!==a.length?null:$(a[1].children[0])}return null},this.getTableRowByPropertyName=function(e){for(var n=t[0].getElementsByTagName("TR"),r=0;r<n.length;++r)if(n[r].cells[0].innerText==e)return $(n[r]);return null},this.getTableRowByPropertyId=function(e){for(var n=t[0].getElementsByTagName("TR"),r=0;r<n.length;++r)if(n[r].getAttribute("data-tt-id")==e)return $(n[r]);return null},this.getElementValueDataByPropertyName=function(e){for(var n=null,r=t[0].getElementsByTagName("TR"),i=0;i<r.length;++i)if(r[i].cells[0].innerText==e){n=r[i];break}if(n){var a=n.children;return 2!==a.length?null:$(a[1].children[0])}return null},this.setFontSize=function(e){t.css("font-size",e)},this.addProperty=function(e){var n=function(e){void 0==e.type&&(e.type="span");var t="";e.disabled&&(t="disabled");var n="";e.checked&&(n="checked");var r="";void 0!==e.value&&(r="value="+e.value);var i=null;if("text"==e.type)return $("<tr><td>"+e.name+'</td><td><input type="text" '+t+" "+r+' style="width:100%"/></td></tr>');if("button"==e.type)return $("<tr><td>"+e.name+'</td><td><input type="button" '+t+' value="..." /></td></tr>');if("number"==e.type)return $("<tr><td>"+e.name+'</td><td><input type="number" '+t+" step ="+e.step+" min ="+e.min+" max="+e.max+" "+r+' style="width:100%"/></td></tr>');if("checkbox"==e.type)return $("<tr><td>"+e.name+"</td><td><input "+t+' type="checkbox" style="width:100%" '+n+"/></td></tr>");if("radio"==e.type)return $("<tr><td>"+e.name+"</td><td><input "+t+' type="radio" name='+e.group+' style="width:100%" '+n+"/></td></tr>");if("color"==e.type){var a="#000000";return e.value&&(a=Static.colorNameToHex(e.value)),$("<tr><td>"+e.name+"</td><td><input "+t+' type="color" value='+a+" /></td></tr>")}if("span"==e.type)return $("<tr><td>"+e.name+'</td><td><span style="width:100%"/></td></tr>');if("select"==e.type){i=$("<tr><td>"+e.name+"</td></tr>");var s=$("<select "+t+" />");if(e.selectorOptions)for(var o=0;o<e.selectorOptions.length;++o)s.append($("<option>"+e.selectorOptions[o]+"</option>"));return i.append($("<td/>").append(s))}return i}(e);if(!n)return null;var r=null;return n.attr("data-tt-id",e.id),void 0!==e.parentId&&n.attr("data-tt-parent-id",e.parentId),"text"!=e.type&&"number"!=e.type&&"color"!=e.type&&"checkbox"!=e.type&&"radio"!=e.type||(r=$(n[0].getElementsByTagName("INPUT"))).on("change",function(){e.fun&&("checkbox"==e.type?e.fun($(this)[0].checked):e.fun($(this).val()))}),"select"==e.type&&(r=$(n[0].getElementsByTagName("SELECT"))).on("change",function(){e.fun&&e.fun($(this)[0].selectedIndex)}),"button"==e.type&&(r=$(n[0].getElementsByTagName("INPUT"))).on("click",function(){e.fun&&e.fun()}),"span"==e.type&&(r=$(n[0].getElementsByTagName("SPAN"))),t.append(n),e.title&&n.attr("title",e.title),r}}header(e){var t=$("<table />");return t.append('<caption style="text-align:center; border-width:4px; color:black"><b>'+e+"</b></caption>"),t.append('<thead style="background-color:lightgray">                <tr style="border-style:solid; border-width:1px">                <th style="border-style:none;"><label>Property</label></th>                <th style="border-style:none; text-align:right"><label style="margin-right:4px">Value</label></th>                </tr>                </thead>'),t}}define("propertiesPane",["pane"],function(){});class CurvePropertiesPane extends PropertiesPane{constructor(e,t){super(e);var n=this;n.setHeader(t.leftSidebar.gridItem(0).headerElement,"Curve Properties",!0);var r=this.addProperty({name:"Curve",id:"currentCurve",type:"select",title:"Curve being modified",fun:function(e){let n=t.findPlotCurve(r.val());X(n),Static.trigger("currentCurveChangedViaPropertiesPane",n)}});this.addProperty({name:"Rename",id:"renameCurve",type:"button",title:"Give the curve a different unique name",fun:function(){h=r[0].selectedIndex,Utility.curveRenameDlg(r.val(),t)}}),this.addProperty({name:"Remove",id:"removeCurve",type:"button",title:"Permanently remove the currently selected curve",fun:function(){t.findPlotCurve(r.val()).detach()}}),this.addProperty({name:"Fit",id:"fitCurve",type:"button",title:"Assign a curve fitter to the currently selected curve",fun:function(){t.curveFitDlg.curveFitCb(t.findPlotCurve(r.val()))}}),this.addProperty({name:"Legend Attributes",id:"legendAttributes",type:"button",title:"Configure how the curve is represented on the legend",fun:function(){t.curveAttributeDlg.curveAttributeCb(t.findPlotCurve(r.val()))}}),this.addProperty({name:"Orientation",id:"orientation",type:"select",selectorOptions:["Vertical","Horizontal"],title:"Set the orientation of the curve. This affect how the step and stick styles are displayed",fun:function(e){let n=t.findPlotCurve(r.val());1==e?n.setOrientation(Horizontal):n.setOrientation(Vertical)}});var i=this.addProperty({name:"Style",id:"curveStyle",type:"select",selectorOptions:["Lines (Default)","Sticks","Steps","Dots","NoCurve"],title:"Set the curve's drawing style",fun:function(e){t.findPlotCurve(r.val()).setStyle(d[e])}}),a=this.addProperty({name:"Axes",id:"curveAxes",title:"Set X and Y axis. The curve is drawn according to the coordinates of its Axes."}),s=this.addProperty({name:"Horizontal",id:"horizontal",parentId:"curveAxes",type:"select",selectorOptions:["Bottom","Top"],title:"Set X axis.",fun:function(e){let n=t.findPlotCurve(r.val());var i=0==e?xBottom:xTop;n.setXAxis(i),m(n),Static.trigger("curveAxisChangedViaPropertiesPane",[i,n])}}),o=this.addProperty({name:"Vertical",id:"vertical",parentId:"curveAxes",type:"select",selectorOptions:["Left","Right"],title:"Set Y axis.",fun:function(e){let n=t.findPlotCurve(r.val());var i=0==e?yLeft:yRight;n.setYAxis(i),m(n),Static.trigger("curveAxisChangedViaPropertiesPane",[i,n])}});this.addProperty({name:"Pen",title:"Build and assign a pen.",id:"curvePen"}),this.addProperty({name:"Color",id:"curvePenColor",parentId:"curvePen",type:"color",title:"Set the pen color",fun:function(e){let n=t.findPlotCurve(r.val()),i=n.pen();i.color=e,n.setPen(i),X(n)}}),this.addProperty({name:"Style",id:"curvePenStyle",parentId:"curvePen",type:"select",selectorOptions:["solid","dot","dash","dash-dot","dash-dot-dot"],title:"Set the pen style",fun:function(e){let n=t.findPlotCurve(r.val()),i=n.pen();i.style=b[e],n.setPen(i),X(n)}}),this.addProperty({name:"Width",id:"curvePenWidth",parentId:"curvePen",type:"select",selectorOptions:[1,2,3,4,5],title:"Set the pen width",fun:function(e){let n=t.findPlotCurve(r.val()),i=n.pen();i.width=e+1,n.setPen(i),X(n)}}),this.addProperty({name:"Curve Symbol",title:"Assign a symbol. Any previously set symbol is removed by setting a new one.",id:"curveSymbol"}),this.addProperty({name:"Pen",title:"Build and assign a pen.",id:"curveSymPen",parentId:"curveSymbol"}),this.addProperty({name:"Color",id:"curveSymbolPenColor",parentId:"curveSymPen",type:"color",title:"Set the pen color",fun:function(e){let n=t.findPlotCurve(r.val()),i=n.symbol();if(!i)return;let a=i.pen();a.color=e,i.setPen(a),X(n),n.plot().autoRefresh(),n.plot().updateLegend(n)}}),this.addProperty({name:"Width",id:"curveSymbolPenWidth",parentId:"curveSymPen",type:"select",selectorOptions:[1,2,3,4,5],title:"Set the pen width",fun:function(e){let i=t.findPlotCurve(r.val());Utility.setSymbolPenWidth(i,e+1),n.setSymbolIcon()}}),this.addProperty({name:"Fill Brush",id:"curveSymbolBrushColor",parentId:"curveSymbol",type:"color",title:"Assign a brush. The brush is used to draw the interior of the symbol.",fun:function(e){let i=t.findPlotCurve(r.val()),a=i.symbol();if(!a)return;let s=a.brush();s.color=e,a.setBrush(s),i.plot().autoRefresh(),i.plot().updateLegend(i),n.setSymbolIcon()}}),this.addProperty({name:"Style",id:"curveSymbolStyle",parentId:"curveSymbol",type:"select",selectorOptions:["None","Rectangle","Cross","Diamond","Ellipse","Diagonal cross"],title:"Specify the symbol style",fun:function(e){let n=t.findPlotCurve(r.val());"None"==T[e]&&(E.val(1),C.val(Static.colorNameToHex("black")),k.val(Static.colorNameToHex("transparent")),x.val(10));!function(e,t){let n=NoSymbol;"MRect"==t&&(n=MRect);"Cross"==t&&(n=Cross);"Diamond"==t&&(n=Diamond);"Ellipse"==t&&(n=Ellipse);"XCross"==t&&(n=XCross);Utility.addSymbol(e,n)}(n,T[e])}}),this.addProperty({name:"Size",id:"curveSymbolSize",parentId:"curveSymbol",type:"select",selectorOptions:["5x5","6x6","8x8","10x10","12x12","15x15"],title:"Specify the symbol's size.",fun:function(e){let i=t.findPlotCurve(r.val());Utility.setSymbolSize(i,P[e]),n.setSymbolIcon()}}),this.addProperty({name:"Fill",title:"If the curve style is not equal to Sticks, the area between the curve and the baseline can be filled.",id:"curveFill"}),this.addProperty({name:"Brush",id:"curveFillBrushColor",parentId:"curveFill",type:"color",title:"Assign the brush used to fill the curve.",fun:function(e){var i=t.findPlotCurve(r.val());if(i.fill){let t=i.brush();t.color=e,i.setBrush(t)}n.setBrushIcon()}}),this.addProperty({name:"Fill Curve",id:"fillCurve",parentId:"curveFill",type:"checkbox",title:"If checked, curve filling is enabled.",fun:function(e){var i=t.findPlotCurve(r.val());if(i.fill=e,e){let e=i.brush();e.color=M.val(),i.setBrush(e)}else Utility.removeCurveBrush(i);n.setBrushIcon()}}),this.addProperty({name:"Baseline",id:"baseline",type:"number",value:0,step:.5,title:"Set the value of the baseline. The baseline is required for filling the curve with a brush or the Sticks curve style.",fun:function(e){t.findPlotCurve(r.val()).setBaseline(e)}}),this.addProperty({name:"Pen Width",id:"penWidth",type:"select",selectorOptions:[1,2,3,4,5],title:"Assign a pen width.",fun:function(e){t.findPlotCurve(r.val()).setPenWidth(e+1)}}),this.addProperty({name:"Colormap",id:"colormap",type:"select",selectorOptions:["RGB-map","Indexed-map"],title:"Change the color map. Color Maps are used for mapping the intensity values to colors",fun:function(e){let n=t.findPlotCurve(r.val());0==e?n.setSpectrogramColorMap(Enum.ColorMap.RGBMap):n.setSpectrogramColorMap(Enum.ColorMap.IndexMap)}}),this.addProperty({name:"Interpolation",id:"interpolation",type:"select",selectorOptions:["Bi-Linear","Bi-Cubic"],title:"Select the interpolation type.",fun:function(e){let n=t.findPlotCurve(r.val());var i=n.data();if(!i.hasOwnProperty("_interpolationType"))return;0==e?i.setInterpolaionType(Enum.InterpolationType.linear):i.setInterpolaionType(Enum.InterpolationType.cubic);n.invalidateCache(),n.itemChanged()}});var l=this.addProperty({name:"Spectrogram",title:"Configure how the spectrogram is drawn.",id:"spectrogram"});this.addProperty({name:"show",id:"showSpectrogram",parentId:"spectrogram",type:"checkbox",checked:!0,title:"If checked, the spectrogram is drawn.",fun:function(e){let n=t.findPlotCurve(r.val());n.showSpectrogram(e),p(n)}}),this.addProperty({name:"alpha",id:"alpha",parentId:"spectrogram",type:"number",min:0,max:255,value:255,step:1,title:"Set an alpha value for the raster data.",fun:function(e){let n=t.findPlotCurve(r.val());n.setAlpha(e),p(n)}});var c=this.addProperty({name:"Contours",title:"Configure contours.",id:"contours"});function u(){let e=r.children();for(let t=0;t<e.length;++t)r[0].removeChild(e[t]);for(var n=t.itemList(),i=[],a=0;a<n.length;++a)n[a].rtti!==Static.Rtti_PlotCurve&&n[a].rtti!==Static.Rtti_PlotSpectroCurve&&n[a].rtti!==Static.Rtti_PlotSpectrogram||i.push(n[a]);for(let e=0;e<i.length;++e){let t=$("<option>"+i[e].title()+"</option>");t.attr("value",i[e].title()),r.append(t)}return Static.trigger("currentCurveChangedViaPropertiesPane",i[0]),null}this.addProperty({name:"show",id:"showContours",parentId:"contours",type:"checkbox",title:"If checked, contours are drawn.",fun:function(e){let n=t.findPlotCurve(r.val());n.showContour(e),f(n)}}),this.addProperty({name:"Number of planes",id:"numberOfPlanes",parentId:"contours",type:"number",min:0,max:20,value:10,step:1,title:"Set the number of contour planes.",fun:function(e){let n=t.findPlotCurve(r.val());n.setContourLevels(n.calculateContourLevels(e)),f(n)}}),this.addProperty({name:"Color interval",title:"Set the color range.",id:"colorInterval"}),this.addProperty({name:"color1",id:"color1",parentId:"colorInterval",type:"color",title:"Color used for the minimum value of the value interval.",fun:function(e){let n=t.findPlotCurve(r.val());n.setColorInterval(e,Static.RGB2HTML(n.color2()))}}),this.addProperty({name:"color2",id:"color2",parentId:"colorInterval",type:"color",title:"Color used for the maximum value of the value interval.",fun:function(e){let n=t.findPlotCurve(r.val());n.setColorInterval(Static.RGB2HTML(n.color1()),e)}}),this.addProperty({name:"Color range",title:"Set the value interval, that corresponds to the color map.",id:"colorRange"}),this.addProperty({name:"minimum Z",id:"minimumZ",parentId:"colorRange",type:"number",title:"Lower limit of the interval.",fun:function(e){t.findPlotCurve(r.val()).colorRange().setMinValue(e),t.autoRefresh()}}),this.addProperty({name:"maximum Z",id:"maximumZ",parentId:"colorRange",type:"number",title:"Upper limit of the interval.",fun:function(e){t.findPlotCurve(r.val()).colorRange().setMaxValue(e),t.autoRefresh()}}),this.init(),this.setFontSize("12px"),Static.bind("showGridItem",function(e,n,i,a){if("left"==n&&0==i&&a){X(t.findPlotCurve(r.val()))}}),Static.bind("itemAttached",function(e,n,i){n.rtti!=Static.Rtti_PlotCurve&&n.rtti!=Static.Rtti_PlotSpectroCurve&&n.rtti!=Static.Rtti_PlotSpectrogram||(i||(t.hasVisiblePlotCurve()||t.hasVisiblePlotSpectroCurve()||t.hasVisiblePlotSpectrogram()||t.leftSidebar.showGridItem(0,!1),t.hasPlotCurve()),u(),X(t.findPlotCurve(r.val())))}),t.leftSidebar.showGridItem(0,!1);var h=-1;Static.bind("curveRenamed",function(){-1==h&&(h=r[0].selectedIndex),u(),r[0].selectedIndex=h;t.findPlotCurve(r.val());h=-1});var d=[Lines,Sticks,Steps,Dots,NoCurve];function f(e){var t="Visible";e.testDisplayMode(Enum.DisplayMode.ContourMode)||(t="Hidden"),c.html(t+", planes:"+e.contourLevels().length)}function p(e){var t="Visible";e.testDisplayMode(Enum.DisplayMode.ImageMode)||(t="Hidden"),l.html(t+", alpha:"+e.alpha())}function m(e){var t="Left";e.yAxis()==yRight&&(t="Right");var n="Bottom";e.xAxis()==xTop&&(n="Top"),a.html(n+", "+t)}Static.bind("curveStyleChanged",function(e,t){X(t)}),Static.bind("axisChanged",function(e,t,n){X(n)}),this.penIcon=function(e){if(!e)return null;var t=new Graphic(null,50,16),n=new PaintUtil.Painter(t);if(e.pen().color!=Static.NoPen){var r=e.pen();n.setPen(r);n.drawLine(0,8,50,8)}return n=null,t},this.spanElem=null;var v=this.getElementValueDataAttribute("curvePen").parent();this.setPenIcon=function(){var e=t.findPlotCurve(r.val()),n=v,i=this.penIcon(e);this.spanElem&&this.spanElem.remove(),this.spanElem=$('<span id="spanElem" />'),i&&i.setParent(this.spanElem),this.spanElem.appendTo(n)};var g=this.getElementValueDataAttribute("curvePenColor");Static.bind("penAttributeChanged",function(e,t){X(t)});var b=["solid","dot","dash","dashDot","dashDotDot"],S=this.getElementValueDataAttribute("curvePenStyle");var y=this.getElementValueDataAttribute("curvePenWidth");var x=this.getElementValueDataAttribute("curveSymbolSize");this.symbolIcon=function(e){if(!e)return null;var t=new Misc.Size(10,10),n=new Graphic(null,10,10),r=new PaintUtil.Painter(n);if(e.symbol()){e.symbol().style(),r.setPen(e.symbol().pen()),e.symbol().drawGraphicSymbol(r,new Misc.Point(5,5),t)}return r=null,n},this.spanElem2=null;var w=this.getElementValueDataAttribute("curveSymbol").parent();this.setSymbolIcon=function(){var e=t.findPlotCurve(r.val()),n=w,i=this.symbolIcon(e);this.spanElem2&&this.spanElem2.remove(),this.spanElem2=$('<span id="spanElem2" />'),i&&i.setParent(this.spanElem2),this.spanElem2.appendTo(n)},Static.bind("symbolAdded symbolAttributeChanged",function(e,t){X(t)});var C=this.getElementValueDataAttribute("curveSymbolPenColor");var E=this.getElementValueDataAttribute("curveSymbolPenWidth");var k=this.getElementValueDataAttribute("curveSymbolBrushColor");x=this.getElementValueDataAttribute("curveSymbolSize");var R=this.getElementValueDataAttribute("curveSymbolStyle"),T=["None","MRect","Cross","Diamond","Ellipse","XCross"],A=[MRect,Cross,Diamond,Ellipse,XCross];var P=[5,6,8,10,12,15];var B=this.getElementValueDataAttribute("curveFill").parent();this.brushIcon=function(e,t){if(!e)return null;new Misc.Size(12,12);var n=new Graphic(null,12,12),r=new PaintUtil.Painter(n);if("noBrush"==e.brush().color)return null;r.setBrush(e.brush());var i=new Misc.Rect(new Misc.Point,new Misc.Size(12,12));return i.moveCenter(new Misc.Point(6,6)),r.drawRect(i.left(),i.top(),i.width(),i.height()),r=null,n},this.spanElem3=null;var M=this.getElementValueDataAttribute("curveFillBrushColor");M.parent();this.setBrushIcon=function(){var e=t.findPlotCurve(r.val()),i=B,a=n.brushIcon(e);this.spanElem3&&this.spanElem3.remove(),this.spanElem3=$('<span id="spanElem" />'),a&&a.setParent(this.spanElem3),this.spanElem3.appendTo(i)};var I=this.getElementValueDataAttribute("fillCurve");Static.bind("curveBrushChanged",function(e,t){X(t)});var D=this.getElementValueDataAttribute("baseline");var L=n.getElementValueDataAttribute("showContours"),F=n.getElementValueDataAttribute("numberOfPlanes"),O=n.getElementValueDataAttribute("showSpectrogram"),N=n.getElementValueDataAttribute("alpha"),z=n.getElementValueDataAttribute("penWidth"),W=n.getElementValueDataAttribute("color1"),V=n.getElementValueDataAttribute("color2"),U=n.getElementValueDataAttribute("minimumZ"),H=n.getElementValueDataAttribute("maximumZ");function X(e){if(e&&e.title()===r.val()){if(e.rtti===Static.Rtti_PlotSpectroCurve){n.show("penWidth"),n.show("colorInterval"),n.show("colorRange"),z[0].selectedIndex=e.penWidth()-1,W.val(Static.RGB2HTML(e.color1())),V.val(Static.RGB2HTML(e.color2()));var t=e.colorRange();U.val(t.minValue()),H.val(t.maxValue())}else n.hide("penWidth"),n.hide("colorInterval"),n.hide("colorRange");if(e.rtti===Static.Rtti_PlotSpectrogram){e.isVisible()?(n.show("spectrogram"),n.show("contours")):(n.hide("spectrogram"),n.hide("contours")),n.show("colormap"),e.data().hasOwnProperty("_interpolationType")?n.show("interpolation"):n.hide("interpolation");e.testDisplayMode(Enum.DisplayMode.ImageMode);O[0].checked=e.testDisplayMode(Enum.DisplayMode.ImageMode),N.val(e.alpha()),L[0].checked=e.testDisplayMode(Enum.DisplayMode.ContourMode),F.val(e.contourLevels().length),p(e),f(e)}else n.hide("spectrogram"),n.hide("contours"),n.hide("interpolation"),n.hide("colormap");if(e.rtti===Static.Rtti_PlotSpectroCurve||e.rtti===Static.Rtti_PlotSpectrogram?(n.hide("fitCurve"),n.hide("curveSymbol"),n.hide("legendAttributes"),n.hide("orientation"),n.hide("curveStyle"),n.hide("curveFill"),n.hide("baseline"),n.hide("curvePen")):(n.show("fitCurve"),n.show("curveSymbol"),n.show("legendAttributes"),n.show("orientation"),n.show("curveStyle"),n.show("curveFill"),n.show("baseline"),n.show("curvePen")),e.rtti===Static.Rtti_PlotCurve)if(g.val(Static.colorNameToHex(e.pen().color)),S[0].selectedIndex=b.indexOf(e.pen().style),y[0].selectedIndex=e.pen().width-1,e.symbol()){C.val(Static.colorNameToHex(e.symbol().pen().color)),E[0].selectedIndex=e.symbol().pen().width-1,k.val(Static.colorNameToHex(e.symbol().brush().color));var a=-1;a="None"==e.symbol().style()?0:A.indexOf(e.symbol().style())+1,R[0].selectedIndex=a,x[0].selectedIndex=P.indexOf(e.symbol().size().height)}else C.val(Static.colorNameToHex("black")),E[0].selectedIndex=0,k.val(Static.colorNameToHex("black")),R[0].selectedIndex=0,x[0].selectedIndex=3;if(e.rtti===Static.Rtti_PlotCurve&&(i[0].selectedIndex=_.keys(d)[_.values(d).indexOf(e.style())]),s[0].selectedIndex=e.xAxis()==xBottom?0:1,o[0].selectedIndex=e.yAxis()==yLeft?0:1,m(e),e.rtti===Static.Rtti_PlotCurve){n.setPenIcon(),n.setSymbolIcon(),I[0].checked=e.fill,M.val(e.brush().color),n.setBrushIcon(),D.val(e.baseline());var l=n.getElementValueDataAttribute("orientation");e.orientation()==Vertical?l[0].selectedIndex=0:l[0].selectedIndex=1}}}Static.bind("visibilityChange",function(e,t,i){t.rtti==Static.Rtti_PlotSpectrogram&&t.title()==r.val()&&t.rtti===Static.Rtti_PlotSpectrogram&&(i?(n.show("spectrogram"),n.show("contours")):(n.hide("spectrogram"),n.hide("contours")))})}}define("curvePropertiesPane",["propertiesPane"],function(){});class PlotPropertiesPane extends PropertiesPane{constructor(e,t){super(e);var n=this;n.setHeader(t.leftSidebar.gridItem(1).headerElement,"Plot Properties",!0),this.shadeWatchArea=!0,this.addProperty({name:"General Settings",title:"General properties",id:"generalSettings"}),this.addProperty({name:"Plot Title",title:"Configure plot title",id:"plotTitle",parentId:"generalSettings"});var r=this.addProperty({name:"Title",id:"plotTitleTitle",parentId:"plotTitle",type:"text",title:"Set a plot title",fun:function(e){t.setTitle(e)}});this.addProperty({name:"Font",id:"plotTitleFont",parentId:"plotTitle",type:"select",selectorOptions:PropertiesPane.fontsDisplay(),title:"Set plot title font type",fun:function(e){var n=t.titleFont();n.name=PropertiesPane.fontGroup(e),t.setTitleFont(n)}}),this.addProperty({name:"Point",id:"plotTitlePoint",parentId:"plotTitle",type:"number",value:"20",min:"6",max:"32",title:"Set plot title font size",fun:function(e){var n=t.titleFont();n.th=e,t.setTitleFont(n)}}),this.addProperty({name:"Color",id:"plotTitleColor",parentId:"plotTitle",type:"color",title:"Set plot title font color",title:"Set plot title font color",fun:function(e){var n=t.titleFont();n.fontColor=e,t.setTitleFont(n)}}),this.addProperty({name:"Bold",id:"plotTitleBold",parentId:"plotTitle",type:"checkbox",checked:!0,title:"Set plot title font weight",fun:function(e){var n=t.titleFont();n.weight=e?"bold":"normal";t.setTitleFont(n)}}),this.addProperty({name:"Plot Footer",title:"Configure plot footer",id:"plotFooter",parentId:"generalSettings"}),this.addProperty({name:"Footer",id:"plotFooterFooter",parentId:"plotFooter",type:"text",value:"Footer",title:"Set a plot footer",fun:function(e){t.setFooter(e)}}),this.addProperty({name:"Font",id:"plotFooterFont",parentId:"plotFooter",type:"select",selectorOptions:PropertiesPane.fontsDisplay(),title:"Set plot footer font type",fun:function(e){var n=t.footerFont();n.name=PropertiesPane.fontGroup(e),t.setFooterFont(n)}}),this.addProperty({name:"Point",id:"plotFooterPoint",parentId:"plotFooter",type:"number",value:"20",min:"6",max:"32",title:"Set plot footer font size",fun:function(e){var n=t.footerFont();n.th=e,t.setFooterFont(n)}}),this.addProperty({name:"Color",id:"plotFooterColor",parentId:"plotFooter",type:"color",title:"Set plot footer font color",fun:function(e){var n=t.footerFont();n.fontColor=e,t.setFooterFont(n)}}),this.addProperty({name:"Bold",id:"plotFooterBold",parentId:"plotFooter",type:"checkbox",checked:!0,title:"Set plot footer font weight",fun:function(e){var n=t.footerFont();n.weight=e?"bold":"normal";t.setFooterFont(n)}}),this.addProperty({name:"Background",id:"plotBackground",parentId:"generalSettings",type:"color",value:"#ffffc8",title:"Set plot background color",fun:function(e){t.setPlotBackground(e)}}),this.addProperty({name:"Legend",title:"Configure legend",id:"plotLegend",parentId:"generalSettings"}),this.addProperty({name:"Background",id:"plotLegendBackground",parentId:"plotLegend",type:"color",value:"#ffffff",title:"Set legend background color",fun:function(e){var n=t.getLayout().getLegendDiv().children()[0];$(n).css("background-color",e)}}),this.addProperty({name:"Show Line",id:"plotLegendShowLine",parentId:"plotLegend",type:"checkbox",title:"If checked, curve is represented by a line on the legend",fun:function(e){Static.showline=e}}),this.addProperty({name:"Show Symbol",id:"plotLegendShowSymbol",parentId:"plotLegend",type:"checkbox",title:"If checked, attached symbols are represented on the legend",fun:function(e){Static.showsymbol=e}}),this.addProperty({name:"Scale Settings",title:"Configure scales",id:"scaleSettings"}),this.addProperty({name:"Title",title:"Configure scale title",id:"scaleTitle",parentId:"scaleSettings"});var i=this.addProperty({name:"Bottom",id:"bottomScaleTitle",parentId:"scaleTitle",type:"text",value:"Bottom-Scale",title:"Set bottom scale title",fun:i}),a=this.addProperty({name:"Top",id:"topScaleTitle",parentId:"scaleTitle",type:"text",value:"Top-Scale",title:"Set top scale title",fun:a}),s=this.addProperty({name:"Left",id:"leftScaleTitle",parentId:"scaleTitle",type:"text",value:"Left-Scale",title:"Set left scale title",fun:s}),o=this.addProperty({name:"Right",id:"rightScaleTitle",parentId:"scaleTitle",type:"text",value:"Right-Scale",title:"Set right scale title",fun:o});this.addProperty({name:"Font",id:"scaleTitleFont",parentId:"scaleTitle",type:"select",selectorOptions:PropertiesPane.fontsDisplay(),title:"Set scale title font type",fun:function(e){var n=t.axisTitleFont(xBottom);n.name=PropertiesPane.fontGroup(e),t.setAxisTitleFont(xBottom,n),t.setAxisTitleFont(xTop,n),t.setAxisTitleFont(yLeft,n),t.setAxisTitleFont(yRight,n)}}),this.addProperty({name:"Point",id:"scaleTitlePoint",parentId:"scaleTitle",type:"number",value:"20",min:"6",max:"32",title:"Set scale title font size",fun:function(e){var n=t.axisTitleFont(xBottom);n.th=.86*e,t.setAxisTitleFont(xBottom,n),t.setAxisTitleFont(xTop,n),t.setAxisTitleFont(yLeft,n),t.setAxisTitleFont(yRight,n)}}),this.addProperty({name:"Color",id:"scaleTitleColor",parentId:"scaleTitle",type:"color",title:"Set scale title font color",fun:function(e){var n=t.axisTitleFont(xBottom);n.fontColor=e,t.setAxisTitleFont(xBottom,n),t.setAxisTitleFont(xTop,n),t.setAxisTitleFont(yLeft,n),t.setAxisTitleFont(yRight,n)}}),this.addProperty({name:"Bold",id:"scaleTitleBold",parentId:"scaleTitle",type:"checkbox",title:"Set scale title font weight",fun:function(e){var n=t.axisTitleFont(xBottom);n.weight=e?"bold":"normal";t.setAxisTitleFont(xBottom,n),t.setAxisTitleFont(xTop,n),t.setAxisTitleFont(yLeft,n),t.setAxisTitleFont(yRight,n)}}),this.addProperty({name:"Type",title:"Configure scale type",id:"scaleType",parentId:"scaleSettings"}),this.addProperty({name:"Bottom",title:"Configure bottom scale type",id:"scaleTypeBottom",parentId:"scaleType"});var l=this.addProperty({name:"Linear",title:"Linear scale",id:"scaleTypeBottomLinear",parentId:"scaleTypeBottom",type:"radio",checked:!0,group:"scaleTypeBottomGroup"}),c=this.addProperty({name:"Log",title:"Log scale",id:"scaleTypeBottomLog",parentId:"scaleTypeBottom",type:"radio",group:"scaleTypeBottomGroup"}),u=this.addProperty({name:"Base",title:"Set the base of Log scale",id:"scaleTypeBottomBase",parentId:"scaleTypeBottom",disabled:!0,type:"number",value:"10",min:"2",max:"10"}),h=this.addProperty({name:"Decimal",title:"Set the maximum decimal places displayed",id:"scaleTypeBottomBottom",parentId:"scaleTypeBottom",type:"number",value:"3",min:"0",max:"10"});this.addProperty({name:"Top",title:"Configure top scale type",id:"scaleTypeTop",parentId:"scaleType"});var d=this.addProperty({name:"Linear",title:"Linear scale",id:"scaleTypeTopLinear",parentId:"scaleTypeTop",type:"radio",checked:!0,group:"scaleTypeTopGroup"}),f=this.addProperty({name:"Log",title:"Log scale",id:"scaleTypeTopLog",parentId:"scaleTypeTop",type:"radio",group:"scaleTypeTopGroup"}),p=this.addProperty({name:"Base",title:"Set the base of Log scale",id:"scaleTypeTopBase",parentId:"scaleTypeTop",disabled:!0,type:"number",value:"10",min:"2",max:"10"}),m=this.addProperty({name:"Decimal",title:"Set the maximum decimal places displayed",id:"scaleTypeTopTop",parentId:"scaleTypeTop",type:"number",value:"3",min:"0",max:"10"});this.addProperty({name:"Left",title:"Configure left scale type",id:"scaleTypeLeft",parentId:"scaleType"});var v=this.addProperty({name:"Linear",title:"Linear scale",id:"scaleTypeLeftLinear",parentId:"scaleTypeLeft",type:"radio",checked:!0,group:"scaleTypeLeftGroup"}),g=this.addProperty({name:"Log",title:"Log scale",id:"scaleTypeLeftLog",parentId:"scaleTypeLeft",type:"radio",group:"scaleTypeLeftGroup"}),b=this.addProperty({name:"Base",title:"Set the base of Log scale",id:"scaleTypeLeftBase",parentId:"scaleTypeLeft",disabled:!0,type:"number",value:"10",min:"2",max:"10"}),S=this.addProperty({name:"Decimal",title:"Set the maximum decimal places displayed",id:"scaleTypeLeftLeft",parentId:"scaleTypeLeft",type:"number",value:"3",min:"0",max:"10"});this.addProperty({name:"Right",title:"Configure right scale type",id:"scaleTypeRight",parentId:"scaleType"});var y=this.addProperty({name:"Linear",title:"Linear scale",id:"scaleTypeRightLinear",parentId:"scaleTypeRight",type:"radio",checked:!0,group:"scaleTypeRightGroup"}),x=this.addProperty({name:"Log",title:"Log scale",id:"scaleTypeRightLog",parentId:"scaleTypeRight",type:"radio",group:"scaleTypeRightGroup"}),w=this.addProperty({name:"Base",title:"Set the base of Log scale",id:"scaleTypeRightBase",parentId:"scaleTypeRight",disabled:!0,type:"number",value:"10",min:"2",max:"10"}),_=this.addProperty({name:"Decimal",title:"Set the maximum decimal places displayed",id:"scaleTypeRightRight",parentId:"scaleTypeRight",type:"number",value:"3",min:"0",max:"10"});this.addProperty({name:"Limits",title:"Configure scale limits",id:"scaleLimits",parentId:"scaleSettings"});var C=this.addProperty({name:"Enable user scale",id:"limitsEnableUserScale",parentId:"scaleLimits",type:"checkbox"});this.addProperty({name:"Bottom",id:"limitsBottom",parentId:"scaleLimits"});var E=this.addProperty({name:"minimum",id:"limitsBottomMinimum",parentId:"limitsBottom",type:"number",value:"0",disabled:!0}),k=this.addProperty({name:"maximum",id:"limitsBottomMaximum",parentId:"limitsBottom",type:"number",value:"0",disabled:!0});this.addProperty({name:"Left",id:"limitsLeft",parentId:"scaleLimits"});var R=this.addProperty({name:"minimum",id:"limitsLeftMinimum",parentId:"limitsLeft",type:"number",value:"0",disabled:!0}),T=this.addProperty({name:"maximum",id:"limitsLeftMaximum",parentId:"limitsLeft",type:"number",value:"0",disabled:!0});this.addProperty({name:"Top",id:"limitsTop",parentId:"scaleLimits"});var A=this.addProperty({name:"minimum",id:"limitsTopMinimum",parentId:"limitsTop",type:"number",value:"0",disabled:!0}),P=this.addProperty({name:"maximum",id:"limitsTopMaximum",parentId:"limitsTop",type:"number",value:"0",disabled:!0});this.addProperty({name:"Right",id:"limitsRight",parentId:"scaleLimits"});var B=this.addProperty({name:"minimum",id:"limitsRightMinimum",parentId:"limitsRight",type:"number",value:"0",disabled:!0}),M=this.addProperty({name:"maximum",id:"limitsRightMaximum",parentId:"limitsRight",type:"number",value:"0",disabled:!0});this.addProperty({name:"Exp. Notation",title:"Set Exp. Notation limits",id:"scaleExpNotation",parentId:"scaleSettings"});var I=this.addProperty({name:"Values less than",id:"expNotationValuesLessThan",parentId:"scaleExpNotation",type:"number",value:"-10000"}),D=this.addProperty({name:"Values greater than",id:"expNotationValuesGreaterThan",parentId:"scaleExpNotation",type:"number",value:"10000"});this.addProperty({name:"Margins",title:"Set scale margins",id:"scaleMargins",parentId:"scaleSettings"});var L=this.addProperty({name:"Left axis",id:"scaleMarginsLeftAxis",parentId:"scaleMargins",type:"number",min:"0",value:"0.0"}),F=this.addProperty({name:"Right axis",id:"scaleMarginsRightAxis",parentId:"scaleMargins",type:"number",min:"0",value:"0.0"}),O=this.addProperty({name:"Bottom axis",id:"scaleMarginsBottomAxis",parentId:"scaleMargins",type:"number",min:"0",value:"0.0"}),N=this.addProperty({name:"Top axis",id:"scaleMarginsTopAxis",parentId:"scaleMargins",type:"number",min:"0",value:"0.0"});this.addProperty({name:"Components",title:"Configure plot components",id:"scaleComponents",parentId:"scaleSettings"});var z=this.addProperty({name:"Show backbone",id:"scaleComponentsShowBackbone",parentId:"scaleComponents",type:"checkbox",checked:!0}),W=this.addProperty({name:"Show labels",id:"scaleComponentsShowLabels",parentId:"scaleComponents",type:"checkbox",checked:!0}),V=this.addProperty({name:"Show ticks",id:"scaleComponentsShowTicks",parentId:"scaleComponents",type:"checkbox",checked:!0}),U=this.addProperty({name:"Tick length",id:"scaleComponentsTickLength",parentId:"scaleComponents",type:"select",selectorOptions:["Small","Medium","Large"]});this.addProperty({name:"Error Settings",title:"Configure error handling",id:"errorSettings"});var H=this.addProperty({name:"When an error occurs",id:"errorResponse",parentId:"errorSettings",type:"select",selectorOptions:["Stop and warn","Silently ignore","Allow for ignore"]}),X=this.addProperty({name:"Zoomer Settings",title:"Configure zoomer",id:"zoomerSettings"}),G=this.addProperty({name:"Zoom according to the current curve axes",id:"zoomerAxes",parentId:"zoomerSettings",type:"checkbox",checked:!0}),j=this.addProperty({name:"Horizontal",id:"zoomerHorizontalAxes",parentId:"zoomerSettings",type:"select",selectorOptions:["Bottom","Top"],disabled:!0}),Y=this.addProperty({name:"Vertical",id:"zoomerVerticalAxes",parentId:"zoomerSettings",type:"select",selectorOptions:["Left","Right"],disabled:!0}),K=this.addProperty({name:"Magnifier Settings",title:"Configure magnifier",id:"magnifierSettings"}),Z=this.addProperty({name:"Left axis enabled",id:"magnifierLeftAxis",parentId:"magnifierSettings",type:"checkbox",checked:!0}),q=this.addProperty({name:"Right axis enabled",id:"magnifierRightAxis",parentId:"magnifierSettings",type:"checkbox"}),Q=this.addProperty({name:"Bottom axis enabled",id:"magnifierBottomAxis",parentId:"magnifierSettings",type:"checkbox",checked:!0}),J=this.addProperty({name:"Top axis enabled",id:"magnifierTopAxis",parentId:"magnifierSettings",type:"checkbox"}),ee=this.addProperty({name:"Watch Settings",title:"Configure watch",id:"watchSettings"}),te=this.addProperty({name:"Calculation accuracy",id:"watchCalculationAccuracy",parentId:"watchSettings"}),ne=this.addProperty({name:"Low",id:"watchCalculationAccuracyLow",parentId:"watchCalculationAccuracy",type:"radio",group:"watchCalculationAccuracyGroup"}),re=this.addProperty({name:"Moderate",id:"watchCalculationAccuracyModerate",parentId:"watchCalculationAccuracy",type:"radio",group:"watchCalculationAccuracyGroup",checked:!0}),ie=this.addProperty({name:"High",id:"watchCalculationAccuracyHigh",parentId:"watchCalculationAccuracy",type:"radio",group:"watchCalculationAccuracyGroup"}),ae=this.addProperty({name:"Shading",id:"watchShading",parentId:"watchSettings"}),se=this.addProperty({name:"Shade watch area",id:"watchShadeWatchArea",parentId:"watchShading",type:"checkbox",checked:!0}),oe=this.addProperty({name:"Scale shaded area",id:"watchShadeAutoScale",parentId:"watchShading",type:"checkbox",checked:!0}),le=this.addProperty({name:"Shade color",id:"watchShadeColor",parentId:"watchShading",value:"#006464",type:"color"}),ce=this.addProperty({name:"Watch centroid with area",id:"watchCentroidWithArea",parentId:"watchSettings",type:"checkbox",checked:!0});this.addProperty({name:"Grid Settings",title:"Configure grid",id:"gridSettings"}),this.addProperty({name:"Minor Lines",id:"gridMinorLines",parentId:"gridSettings"});var ue=this.addProperty({name:"Show",id:"gridMinorLinesShow",parentId:"gridMinorLines",type:"checkbox",checked:!0}),he=this.addProperty({name:"Minors per major",id:"gridMinorsPerMajor",parentId:"gridMinorLines",type:"number",value:"5",min:"2",max:"20"}),de=this.addProperty({name:"Color",id:"gridMinorLinesColor",parentId:"gridMinorLines",type:"color"});this.addProperty({name:"Major Lines",id:"gridMajorLines",parentId:"gridSettings"});var fe=this.addProperty({name:"Show",id:"gridMajorLinesShow",parentId:"gridMajorLines",type:"checkbox",checked:!0}),pe=this.addProperty({name:"Majors",id:"gridMajorMajors",parentId:"gridMajorLines",type:"number",value:"8",min:"1",max:"40"}),me=this.addProperty({name:"Color",id:"gridMajorLinesColor",parentId:"gridMajorLines",type:"color"}),ve=this.addProperty({name:"Grid Axes",id:"gridAxes",parentId:"gridSettings"}),ge=this.addProperty({name:"According to current curve",id:"gridAxesAccordingToCurve",parentId:"gridAxes",type:"checkbox",checked:!0}),be=this.addProperty({name:"Horizontal",id:"gridHorizontalAxes",parentId:"gridAxes",type:"select",selectorOptions:["Bottom","Top"],disabled:!0}),Se=this.addProperty({name:"Vertical",id:"gridVerticalAxes",parentId:"gridAxes",type:"select",selectorOptions:["Left","Right"],disabled:!0}),ye=this.addProperty({name:"When a point is selected",title:"Set what happens to selected point",id:"pointSelected",type:"select",selectorOptions:["Display data","remove it","Modify it"]}),xe=this.addProperty({name:"Add/Remove Point",title:"If checked, point addition/removal with Shift-Left click is enabled.",id:"addRemovePoint",type:"checkbox"});function i(e){t.setAxisTitle(xBottom,e)}function a(e){t.setAxisTitle(xTop,e)}function s(e){t.setAxisTitle(yLeft,e)}function o(e){t.setAxisTitle(yRight,e)}function we(e){E.attr("disabled",e),k.attr("disabled",e),R.attr("disabled",e),T.attr("disabled",e),A.attr("disabled",e),P.attr("disabled",e),B.attr("disabled",e),M.attr("disabled",e)}this.init(),c.change(function(){u.attr("disabled",!1),t.setAxisScaleEngine(xBottom,new LogScaleEngine)}),u.change(function(){t.axisScaleEngine(yLeft).setBase($(this).val()),t.autoRefresh()}),l.change(function(){u.attr("disabled",!0),t.setAxisScaleEngine(xBottom,new LinearScaleEngine)}),g.change(function(){b.attr("disabled",!1),t.setAxisScaleEngine(yLeft,new LogScaleEngine)}),$("#left_logBase").change(function(){m_plot.axisScaleEngine(yLeft).setBase($(this).val()),m_plot.autoRefresh()}),v.change(function(){b.attr("disabled",!0),t.setAxisScaleEngine(yLeft,new LinearScaleEngine)}),f.change(function(){p.attr("disabled",!1),t.setAxisScaleEngine(xTop,new LogScaleEngine)}),p.change(function(){t.axisScaleEngine(yLeft).setBase($(this).val()),t.autoRefresh()}),d.change(function(){$("#top_logBase").attr("disabled",!0),t.setAxisScaleEngine(xTop,new LinearScaleEngine)}),x.change(function(){w.attr("disabled",!1),t.setAxisScaleEngine(yRight,new LogScaleEngine)}),w.change(function(){t.axisScaleEngine(yLeft).setBase($(this).val()),t.autoRefresh()}),y.change(function(){$("#right_logBase").attr("disabled",!0),t.setAxisScaleEngine(yRight,new LinearScaleEngine)}),h.change(function(){t.setAxisDecimalPlaces(xBottom,parseInt($(this).val()))}),m.change(function(){t.setAxisDecimalPlaces(xTop,parseInt($(this).val()))}),S.change(function(){t.setAxisDecimalPlaces(yLeft,parseInt($(this).val()))}),_.change(function(){t.setAxisDecimalPlaces(yRight,parseInt($(this).val()))}),C.change(function(){we(!this.checked),R.val()!==T.val()&&t.setAxisScale(yLeft,parseFloat(R.val()),parseFloat(T.val())),E.val()!==k.val()&&t.setAxisScale(xBottom,parseFloat(E.val()),parseFloat(k.val())),B.val()!==M.val()&&t.setAxisScale(yRight,parseFloat(B.val()),parseFloat(M.val())),A.val()!==P.val()&&t.setAxisScale(xTop,parseFloat(A.val()),parseFloat(P.val()))}),Static.bind("autoScaleChanged",function(e,t){we(t),C.prop("checked",!t)});var _e=null;function Ce(){var e=t.axisInterval(xBottom);E.val(e.minValue()),k.val(e.maxValue()),e=t.axisInterval(yLeft),R.val(e.minValue()),T.val(e.maxValue()),e=t.axisInterval(xTop),A.val(e.minValue()),P.val(e.maxValue()),e=t.axisInterval(yRight),B.val(e.minValue()),M.val(e.maxValue())}function Ee(e){j.attr("disabled",e),Y.attr("disabled",e)}function ke(){var e="Bottom",n="Left";t.zm;G[0].checked&&_e?(_e.yAxis()==yRight&&(n="Right"),_e.xAxis()==xTop&&(e="Top")):(1==j[0].selectedIndex&&(e="Top"),1==Y[0].selectedIndex&&(n="Right")),X.html(e+", "+n)}function Re(){var e="",n="",r="",i="",a="",s=t.magnifier;s.isAxisEnabled(yLeft)&&(n="Left"),s.isAxisEnabled(yRight)&&(r="Right"),s.isAxisEnabled(xBottom)&&(i="Bottom"),s.isAxisEnabled(xTop)&&(a="Top");var o=0;(e+=n).length>o&&(r.length||i.length||a.length)&&(e+=", "),o=e.length,(e+=r).length>o&&(i.length||a.length)&&(e+=", "),o=e.length,(e+=i).length>o&&a.length&&(e+=", "),""==(e+=a)&&(e="No axis enabled"),K.html(e)}function Te(e){new Misc.Size(12,12);var t=new Graphic(null,12,12),n=new PaintUtil.Painter(t);n.setBrush(new Misc.Brush(e));var r=new Misc.Rect(new Misc.Point,new Misc.Size(12,12));return r.moveCenter(new Misc.Point(6,6)),n.drawRect(r.left(),r.top(),r.width(),r.height()),n=null,t}function Ae(e){var t=Te(e);ae[0].children&&$(ae[0].children[0]).remove(),t&&se[0].checked&&t.setParent(ae)}function Pe(){var e="",t="No shade";Static.accuracyMaxSteps==.5*Static.accuracyBase*.5&&(e="Low"),Static.accuracyMaxSteps==.5*Static.accuracyBase&&(e="Moderate"),Static.accuracyMaxSteps==Static.accuracyBase&&(e="High"),se[0].checked&&(t="Shade "),te.html(e),ee.html(e+"; "+t),se[0].checked&&Te(le.val()).setParent(ee)}function Be(e){be.attr("disabled",e),Se.attr("disabled",e)}function Me(){var e="Bottom",n="Left";t.itemList(Static.Rtti_PlotGrid)[0];ge[0].checked&&_e?(_e.yAxis()==yRight&&(n="Right"),_e.xAxis()==xTop&&(e="Top")):(1==be[0].selectedIndex&&(e="Top"),1==Se[0].selectedIndex&&(n="Right")),ve.html(e+", "+n)}Static.bind("itemAttached",function(e,t,n){t.rtti==Static.Rtti_PlotCurve&&Ce()}),E.change(function(){E.val()!==k.val()&&t.setAxisScale(xBottom,parseFloat(E.val()),parseFloat(k.val()))}),k.change(function(){E.val()!==k.val()&&t.setAxisScale(xBottom,parseFloat(E.val()),parseFloat(k.val()))}),A.change(function(){A.val()!==P.val()&&t.setAxisScale(xTop,parseFloat(A.val()),parseFloat(P.val()))}),P.change(function(){A.val()!==P.val()&&t.setAxisScale(xTop,parseFloat(A.val()),parseFloat(P.val()))}),R.change(function(){R.val()!==T.val()&&t.setAxisScale(yLeft,parseFloat(R.val()),parseFloat(T.val()))}),T.change(function(){R.val()!==T.val()&&t.setAxisScale(yLeft,parseFloat(R.val()),parseFloat(T.val()))}),B.change(function(){B.val()!==M.val()&&t.setAxisScale(yRight,parseFloat(B.val()),parseFloat(M.val()))}),M.change(function(){B.val()!==M.val()&&t.setAxisScale(yRight,parseFloat(B.val()),parseFloat(M.val()))}),I.change(function(){t.setNonExponentNotationLimits($(this).val(),D.val())}),D.change(function(){t.setNonExponentNotationLimits(I.val(),$(this).val())}),L.change(function(){var e=0,n=t.axisScaleEngine(yLeft);if(n instanceof LogScaleEngine){t.axisScaleDiv(yLeft);e=Static.mLog(n.base(),$(this).val())}else{t.axisInterval(yLeft);e=$(this).val()}t.axisScaleEngine(yLeft).setMargins(e,e),t.autoRefresh()}),F.change(function(){var e=0,n=t.axisScaleEngine(yRight);if(n instanceof LogScaleEngine){t.axisScaleDiv(yRight);e=Static.mLog(n.base(),$(this).val())}else{t.axisInterval(yRight);e=$(this).val()}t.axisScaleEngine(yRight).setMargins(e,e),t.autoRefresh()}),O.change(function(){var e=0,n=t.axisScaleEngine(xBottom);if(n instanceof LogScaleEngine){t.axisScaleDiv(xBottom);e=Static.mLog(n.base(),$(this).val())}else{t.axisInterval(xBottom);e=$(this).val()}t.axisScaleEngine(xBottom).setMargins(e,e),t.autoRefresh()}),N.change(function(){var e=0,n=t.axisScaleEngine(xTop);if(n instanceof LogScaleEngine){t.axisScaleDiv(xTop);e=Static.mLog(n.base(),$(this).val())}else{t.axisInterval(xTop);e=$(this).val()}t.axisScaleEngine(xTop).setMargins(e,e),t.autoRefresh()}),z.change(function(){Utility.enableComponent(t,Enum.ScaleComponent.Backbone,this.checked)}),V.change(function(){Utility.enableComponent(t,Enum.ScaleComponent.Ticks,this.checked),tickLengthRow.toggle(this.checked)}),U.change(function(){Utility.setTickLength(t,["small","medium","large"][$(this)[0].selectedIndex])}),W.change(function(){Utility.enableComponent(t,Enum.ScaleComponent.Labels,this.checked)}),ye.change(function(){var e=$(this)[0].selectedIndex;1==e?(console.log("remove"),t.curveClosestPoint.setCb(function(e,t){e.removePoint(t)})):2==e?(console.log("modify"),t.curveClosestPoint.setCb(function(e,n){t.pointEntryDlg.pointEntryCb("Modify/Remove Point",t,e.title(),n)})):(console.log("display"),t.curveClosestPoint.setCb(null))}),xe.change(function(){t.addRemovePoint.activate(this.checked),this.checked?t.zm.setTrackerMode(Static.AlwaysOff):t.zm.setTrackerMode(Static.ActiveOnly)}),H.change(function(){var e=$(this)[0].selectedIndex;1==e?(console.log("Static.silentIgnore"),Static.errorResponse=Static.silentIgnore):2==e?(console.log("Static.warnIgnore"),Static.errorResponse=Static.warnIgnore):(console.log("Static.warn"),Static.errorResponse=Static.warn)}),Static.bind("currentCurveChanged",function(e,n){var r=n;r&&G[0].checked&&t.zm.setAxis(r.xAxis(),r.yAxis());ke()}),Static.bind("curveAxisChangedViaPropertiesPane axisChanged",function(e,n,r){var i=t.zm;G[0].checked?i.setAxis(r.xAxis(),r.yAxis()):(0==j[0].selectedIndex?i.setAxis(xBottom,i.yAxis()):i.setAxis(xTop,i.yAxis()),0==Y[0].selectedIndex?i.setAxis(i.xAxis(),yLeft):i.setAxis(i.xAxis(),yRight)),ke()}),Y.change(function(){var e=t.zm;0==$(this)[0].selectedIndex?e.setAxis(e.xAxis(),yLeft):e.setAxis(e.xAxis(),yRight),ke()}),j.change(function(){var e=t.zm;0==$(this)[0].selectedIndex?e.setAxis(xBottom,e.yAxis()):e.setAxis(xTop,e.yAxis()),ke()}),G.click(function(){if($(this)[0].checked)Ee(!0);else{Ee(!1);var e=t.zm;0==j[0].selectedIndex?e.setAxis(xBottom,e.yAxis()):e.setAxis(xTop,e.yAxis()),0==Y[0].selectedIndex?e.setAxis(e.xAxis(),yLeft):e.setAxis(e.xAxis(),yRight)}ke(),Static.trigger("zoomAccordingToCurve",$(this)[0].checked)}),Z.change(function(){t.magnifier.setAxisEnabled(yLeft,this.checked),Re()}),q.change(function(){t.magnifier.setAxisEnabled(yRight,this.checked),Re()}),Q.change(function(){t.magnifier.setAxisEnabled(xBottom,this.checked),Re()}),J.change(function(){t.magnifier.setAxisEnabled(xTop,this.checked),Re()}),ne.change(function(){console.log("Low"),Static.accuracyMaxSteps=.5*Static.accuracyBase*.5,Pe()}),re.change(function(){console.log("Moderate"),Static.accuracyMaxSteps=.5*Static.accuracyBase,Pe()}),ie.change(function(){console.log("High"),Static.accuracyMaxSteps=Static.accuracyBase,Pe()}),se.change(function(){n.shadeWatchArea=se[0].checked,n.shadeWatchArea?le.attr("disabled",!1):le.attr("disabled",!0),Pe(),Ae(le.val()),Static.trigger("shadeWatchArea",n.shadeWatchArea)}),le.change(function(){Ae($(this).val()),Pe(),Static.trigger("curveShapeColorChanged",$(this).val())}),oe.change(function(){Static.trigger("autoScaleCurveShapeItem",$(this)[0].checked)}),ce.change(function(){Static.trigger("watchCentroidWithArea",$(this)[0].checked)}),he.change(function(){var e=Math.min(Math.max(2,$(this).val()),20);he.val(e),t.setAxisMaxMinor(yLeft,e),t.setAxisMaxMinor(yRight,e),t.setAxisMaxMinor(xTop,e),t.setAxisMaxMinor(xBottom,e)}),pe.change(function(){var e=Math.min(Math.max(1,$(this).val()),40);pe.val(e),t.setAxisMaxMajor(yLeft,$(this).val()),t.setAxisMaxMajor(yRight,$(this).val()),t.setAxisMaxMajor(xTop,$(this).val()),t.setAxisMaxMajor(xBottom,$(this).val())}),de.change(function(){t.itemList(Static.Rtti_PlotGrid)[0].setMinorPen(de[0].value)}),me.change(function(){t.itemList(Static.Rtti_PlotGrid)[0].setMajorPen(me[0].value)}),fe.change(function(){var e=t.itemList(Static.Rtti_PlotGrid)[0];Utility.majorGridLines(e,$(this)[0].checked),ue.attr("disabled",!$(this)[0].checked)}),Static.bind("majorGridLines",function(e,t,n){fe[0].checked=n,ue.attr("disabled",!n)}),ue.change(function(){var e=t.itemList(Static.Rtti_PlotGrid)[0];Utility.minorGridLines(e,$(this)[0].checked)}),Static.bind("minorGridLines",function(e,t,n){ue[0].checked=n}),Static.bind("currentCurveChanged",function(e,n){var r=n;r&&ge[0].checked&&t.itemList(Static.Rtti_PlotGrid)[0].setAxes(r.xAxis(),r.yAxis());Me()}),Static.bind("curveAxisChangedViaPropertiesPane axisChanged",function(e,n,r){var i=t.itemList(Static.Rtti_PlotGrid)[0];ge[0].checked?i.setAxes(r.xAxis(),r.yAxis()):(0==be[0].selectedIndex?i.setAxes(xBottom,i.yAxis()):i.setAxes(xTop,i.yAxis()),0==Y[0].selectedIndex?i.setAxes(i.xAxis(),yLeft):i.setAxes(i.xAxis(),yRight)),Me()}),Static.bind("pSel",function(e,t){t?n.show("pointSelected"):n.hide("pointSelected")}),Se.change(function(){var e=t.itemList(Static.Rtti_PlotGrid)[0];0==$(this)[0].selectedIndex?e.setAxes(e.xAxis(),yLeft):e.setAxes(e.xAxis(),yRight),Me()}),be.change(function(){var e=t.itemList(Static.Rtti_PlotGrid)[0];0==$(this)[0].selectedIndex?e.setAxes(xBottom,e.yAxis()):e.setAxes(xTop,e.yAxis()),Me()}),ge.click(function(){if($(this)[0].checked)Be(!0);else{Be(!1);var e=t.itemList(Static.Rtti_PlotGrid)[0];0==be[0].selectedIndex?e.setAxes(xBottom,e.yAxis()):e.setAxes(xTop,e.yAxis()),0==Se[0].selectedIndex?e.setAxes(e.xAxis(),yLeft):e.setAxes(e.xAxis(),yRight)}Me()}),function(){Ee(!0),ke(),Me(),Re(),Pe(),Ae(le.val()),r.val(t.title()),Ce();var e=t.itemList(Static.Rtti_PlotGrid)[0];ue[0].checked=e.xMinEnabled(),fe[0].checked=e.xEnabled(),i.val(t.axisTitle(xBottom)),a.val(t.axisTitle(xTop)),s.val(t.axisTitle(yLeft)),o.val(t.axisTitle(yRight)),de.val(Static.colorNameToHex(e.minorPen())),me.val(Static.colorNameToHex(e.majorPen())),n.hide("pointSelected")}()}}define("plotPropertiesPane",["propertiesPane"],function(){});class MyOverlay extends WidgetOverlay{constructor(e,t){super(e);this.eventObject=t,this.curve=null,this.toString=function(){return"[MyOverlay]"}}drawOverlay(e){let t=this.curve.plot().canvasMap(this.curve.xAxis()),n=this.curve.plot().canvasMap(this.curve.yAxis()),r=t.transform(this.eventObject.p.x),i=n.transform(this.eventObject.p.y);e.setBrush(new Misc.Brush("lightGrey")),e.drawCircle(r,i,8)}}class MyObject extends HObject{constructor(e,t){super();var n=this;this._plot=e,this._dmin=10,this._cb,this.selected=!1,this.button=Static.LeftButton,this.modifiers=Static.NoModifier,void 0!==t&&(this._cb=t),this.selectorWidgetOverlay=new MyOverlay(e.getCentralWidget(),this),Static.bind("visibilityChange",function(e,t,r){n.selectorWidgetOverlay.curve===t&&(r||(n.selectorWidgetOverlay.clearCanvas(),this.selected=!1))}),this.toString=function(){return"[MyObject]"},this.mouseDown=function(e){return e.button==this.button&&Utility.modifiers(e)==this.modifiers&&this.selected&&(null==this._cb?alert("Curve: "+this.selectorWidgetOverlay.curve.title()+"; point: ("+this.p.x+", "+this.p.y+")"):this._cb(this.selectorWidgetOverlay.curve,this.p)),!0},this.showMarker=function(t){var r=e.autoReplot();e.setAutoReplot(!1);var i=this.selectorWidgetOverlay.curve;n.mPos.setAxes(i.xAxis(),i.yAxis()),function(t){var r=n.selectorWidgetOverlay.curve,i=e.axisScaleDiv(r.xAxis()),a=e.axisScaleDiv(r.yAxis()),s=new Misc.Rect(i.lowerBound(),a.lowerBound(),i.range(),a.range());s=s.normalized();var o=0;o|=t.x<s.left()+.3*s.width()?Static.AlignRight:Static.AlignLeft,o|=t.y-.3*s.height()>s.top()?Static.AlignBottom:Static.AlignTop,n.mPos.setLabelAlignment(o)}(t),n.mPos.setVisible(!0),n.mPos.setValue(t);var a=e.getNonExponentNotationLimits(),s=Static.adjustForDecimalPlaces(t.x,e.axisDecimalPlaces(i.xAxis())),o=Static.adjustForDecimalPlaces(t.y,e.axisDecimalPlaces(i.yAxis()));(s>a.upper||s<a.lower)&&(s=s.toExponential(e.axisDecimalPlaces(i.xAxis()))),(o>a.upper||o<a.lower)&&(o=o.toExponential(e.axisDecimalPlaces(i.yAxis()))),n.mPos.setLabel("("+s.toString()+", "+o.toString()+")"),e.setAutoReplot(r),e.autoRefresh()},this.hideMarker=function(){n.mPos.setVisible(!1)}}eventFilter(e,t){if(!Static.isMobile()){if("mousedown"==t.type)this.mouseDown(t);else if("mouseleave"==t.type)this.selected&&(this.selectorWidgetOverlay.clearCanvas(),this.selected=!1);else if("mousemove"==t.type){t.preventDefault();let i=this._plot.itemList(Static.Rtti_PlotCurve);if(!i.length)return;n=e.mapToElement({x:t.clientX,y:t.clientY});let a={distance:-1},s=-1,o=-1,l=1e10,c=-1;for(r=0;r<i.length;++r)(i[r].isVisible()||"[SyntheticPointData]"!=i[r].data().toString())&&(s=i[r].closestPoint(n,a),a.distance<l&&(l=a.distance,c=r,o=s));if(-1==o)return;if("[SyntheticPointData]"==i[c].data().toString())return;this.p=i[c].data().samples()[o],this.selected||this.selectorWidgetOverlay.clearCanvas(),l<this._dmin?(this.selectorWidgetOverlay.curve=i[c],this.selected||(this.selectorWidgetOverlay.draw(),this.selected=!0,this.showMarker(this.p),Static.trigger("pointSelected"))):(this.selected=!1,this.hideMarker(),Static.trigger("pointNotSelected"))}return!0}if("touchstart"==t.type){let i=this._plot.itemList(Static.Rtti_PlotCurve);if(!i.length)return;var n=e.mapToElement({x:t.originalEvent.touches[0].clientX,y:t.originalEvent.touches[0].clientY});let a={distance:-1},s=-1,o=-1,l=1e10,c=-1;for(var r=0;r<i.length;++r)(i[r].isVisible()||"[SyntheticPointData]"!=i[r].data().toString())&&(s=i[r].closestPoint(n,a),a.distance<l&&(l=a.distance,c=r,o=s));if(-1==o)return;this.p=i[c].data().samples()[o],l<this._dmin&&(null==this._cb?alert("Curve: "+i[c].title()+"; point: ("+this.p.x+", "+this.p.y+")"):this._cb(i[c],this.p))}}}class CurveClosestPoint{constructor(e,t){this.eventHandlingObject=new MyObject(e,t),void 0!==t&&(this.eventHandlingObject.cb=t),this.cw=e.getCentralWidget(),this.cw.setEnabled_1(!0),this.eventHandlingObject.mPos=new PlotMarker("Marker");var n=this.eventHandlingObject.mPos.labelFont();n.th=14,n.fontColor="red",this.eventHandlingObject.mPos.setLabelFont(n),this.eventHandlingObject.mPos.setLabel("AAAAAb"),this.eventHandlingObject.mPos.attach(e),this.eventHandlingObject.mPos.setVisible(!1)}setDistance(e){this.eventHandlingObject._dmin=e}setEnabled(e){e?this.cw.installEventFilter(this.eventHandlingObject):(this.cw.removeEventFilter(this.eventHandlingObject),this.eventHandlingObject.selectorWidgetOverlay.clearCanvas())}setCb(e){this.eventHandlingObject._cb=e}setMousePattern(e,t){this.eventHandlingObject.button=e,this.eventHandlingObject.modifiers=t}}define("curveClosestPoint",["static","widgetOverlay","plotMarker"],function(){});class ScaleWidget extends Widget{constructor(e,t,n){super(t);var r=this.getElement(),i=null,a="",s=e,o=[],l=[],c=new Misc.Font(14),u=new Misc.Font(12);this.setBorderDist=function(e,t){e==l[0]&&t==l[1]||(l[0]=e,l[1]=t)},this.getBorderDistHint=function(e){i.getBorderDistHint(u,e),e.start<o[0]&&(e.start=o[0]),e.end<o[1]&&(e.end=o[1])},this.setLabelFont=function(e){e.th<0||""===e.name||""===e.style||(u=e,s.getLayout().adjustLayout(t,e.th))},this.labelFont=function(){return u},this.setTitleFont=function(e){e.th<0||""===e.name||""===e.style||(c=e,s.getLayout().adjustLayout(t,e.th))},this.titleFont=function(){return c},this.setScaleDraw=function(e){if(void 0!==e&&e!=i){if(i){e.setScaleDiv(i.scaleDiv());var t=null;i.scaleMap().transformation()&&(t=i.scaleMap().transformation().copy()),e.setTransformation(t)}i=e}},this.scaleDraw=function(){return i},this.initScale=function(e){(i=new ScaleDraw).setAlignment(e);var t=new LinearScaleEngine;i.setScaleDiv(t.divideScale(0,100,10,5))},void 0===n?this.initScale(LeftScale):this.initScale(n),this.setTitle=function(e){a!==e&&(""!==e?(""===a&&(this.alignment()===LeftScale||this.alignment()===RightScale?s.getLayout().adjustLayout(r,parseFloat(r.css("width"))+c.th):s.getLayout().adjustLayout(r,parseFloat(r.css("height"))+c.th),Static.trigger("axisTitleAdded",!0)),a=e):(this.alignment()===LeftScale||this.alignment()===RightScale?s.getLayout().adjustLayout(r,parseFloat(r.css("width"))-c.th):s.getLayout().adjustLayout(r,parseFloat(r.css("height"))-c.th),a="",Static.trigger("axisTitleAdded",!1)),s.getLayout().updateLayout())},this.title=function(){return a},this.setAlignment=function(e){i&&i.setAlignment(e)},this.alignment=function(){return null==i?LeftScale:i.alignment()},this.labelWidth=function(e){return u.textSize(e).width},this.draw=function(){var e=i.maxTickLength(),t=i.spacing();if(i.orientation()===Vertical){var n=e+t+this.labelWidth(i.longestLabel())+10+(""!==a?c.th:0)+10;s.getLayout().adjustLayout(r,n)}if(i.orientation()===Horizontal){var o=e+t+10+(""!==a?c.th:0)+10;s.getLayout().adjustLayout(r,o)}s.getLayout().updateLayout();var l=new PaintUtil.Painter(this);l.setFont(u),i.draw(l),""!==a&&(l.setFont(c),this.drawTitle(l)),l=null},this.drawTitle=function(e){var t=e.canvasWidth(),n=e.canvasHeight();e.save(),e.setFont(c),i.alignment()===LeftScale?""!==a&&e.drawVerticalText(a,c.th,n/2):i.alignment()===RightScale?""!==a&&e.drawVerticalText(a,t-c.th,n/2,!0):i.alignment()===BottomScale?""!==a&&e.drawText(a,t/2,n-2,"center"):i.alignment()===TopScale&&""!==a&&e.drawText(a,t/2,c.th,"center"),e.restore()},this.setScaleDiv=function(e){i.scaleDiv()!==e&&(i.setScaleDiv(e),Static.trigger("scaleDivChanged"))},Static.bind("scaleDivChanged",this.scaleChange),this.setTransformation=function(e){i.setTransformation(e)},this.toString=function(){return"[ScaleWidget]"}}}ScaleWidget.prototype.scaleChange=function(){},define("scaleWidget",["static","widget"],function(){});class Utility{static BicubicInterpolation(e,t,n){function r(e,t,n,r,i){return.5*(r-t+(2*t-5*n+4*r-i+(3*(n-r)+i-t)*e)*e)*e+n}return r(n,r(t,e[0][0],e[1][0],e[2][0],e[3][0]),r(t,e[0][1],e[1][1],e[2][1],e[3][1]),r(t,e[0][2],e[1][2],e[2][2],e[3][2]),r(t,e[0][3],e[1][3],e[2][3],e[3][3]))}static bicubicInterpolate(e,t,n){for(var r,i,a=e.length,s=e[0].length,o=(e[e.length-1][0].x-e[0][0].x)/(e.length-1),l=Math.floor((t-e[0][0].x)/o);l<a;l++)if(e[l][0].x>t){r=l;break}void 0==r&&(r=a-1);var c=e[0],u=(c[c.length-1].y-c[0].y)/(c.length-1);for(l=Math.floor((n-c[0].y)/u);l<s;l++)if(c[l].y>n){i=l;break}if(void 0==i&&(i=s-1),t>e[r][0].x||t<e[0][0].x)throw"x out of range";if(n>e[0][i].y||n<e[0][0].y)throw"y out of range";var h=r-2,d=i-2;if(h>=0&&d>=0&&r+1<a&&i+1<s){var f=[e[r-2][i-2].z,e[r-2][i-1].z,e[r-2][i].z,e[r-2][i+1].z],p=[e[r-1][i-2].z,e[r-1][i-1].z,e[r-1][i].z,e[r-1][i+1].z],m=[e[r][i-2].z,e[r][i-1].z,e[r][i].z,e[r][i+1].z],v=[e[r+1][i-2].z,e[r+1][i-1].z,e[r+1][i].z,e[r+1][i+1].z];return Utility.BicubicInterpolation([f,p,m,v],(t-e[r-1][0].x)/(e[r][0].x-e[r-1][0].x),(n-c[i-1].y)/(c[i].y-c[i-1].y))}if(h<0&&d>=0&&r+1<a&&i+1<s){f=[e[r-1][i-2].z,e[r-1][i-1].z,e[r-1][i].z,e[r-1][i+1].z],p=[e[r-1][i-2].z,e[r-1][i-1].z,e[r-1][i].z,e[r-1][i+1].z],m=[e[r][i-2].z,e[r][i-1].z,e[r][i].z,e[r][i+1].z],v=[e[r+1][i-2].z,e[r+1][i-1].z,e[r+1][i].z,e[r+1][i+1].z];return Utility.BicubicInterpolation([f,p,m,v],(t-e[r-1][0].x)/(e[r][0].x-e[r-1][0].x),(n-c[i-1].y)/(c[i].y-c[i-1].y))}if(h>=0&&d<0&&r+1<a&&i<s){f=[e[r-2][i-1].z,e[r-2][i-1].z,e[r-2][i].z,e[r-2][i+1].z],p=[e[r-1][i-1].z,e[r-1][i-1].z,e[r-1][i].z,e[r-1][i+1].z],m=[e[r][i-1].z,e[r][i-1].z,e[r][i].z,e[r][i+1].z],v=[e[r+1][i-1].z,e[r+1][i-1].z,e[r+1][i].z,e[r+1][i+1].z];return Utility.BicubicInterpolation([f,p,m,v],(t-e[r-1][0].x)/(e[r][0].x-e[r-1][0].x),(n-c[i-1].y)/(c[i].y-c[i-1].y))}if(h>=0&&d>=0&&r+1>=a&&i+1<s){f=[e[r-2][i-2].z,e[r-2][i-1].z,e[r-2][i].z,e[r-2][i+1].z],p=[e[r-1][i-2].z,e[r-1][i-1].z,e[r-1][i].z,e[r-1][i+1].z],m=[e[r][i-2].z,e[r][i-1].z,e[r][i].z,e[r][i+1].z],v=[e[r][i-2].z,e[r][i-1].z,e[r][i].z,e[r][i+1].z];return Utility.BicubicInterpolation([f,p,m,v],(t-e[r-1][0].x)/(e[r][0].x-e[r-1][0].x),(n-c[i-1].y)/(c[i].y-c[i-1].y))}if(h>=0&&d>=0&&r+1<a&&i+1>=s){f=[e[r-2][i-2].z,e[r-2][i-1].z,e[r-2][i].z,e[r-2][i].z],p=[e[r-1][i-2].z,e[r-1][i-1].z,e[r-1][i].z,e[r-1][i].z],m=[e[r][i-2].z,e[r][i-1].z,e[r][i].z,e[r][i].z],v=[e[r+1][i-2].z,e[r+1][i-1].z,e[r+1][i].z,e[r+1][i].z];return Utility.BicubicInterpolation([f,p,m,v],(t-e[r-1][0].x)/(e[r][0].x-e[r-1][0].x),(n-c[i-1].y)/(c[i].y-c[i-1].y))}if(h<0&&d<0&&r+1<a&&i<s){f=[e[r-1][i-1].z,e[r-1][i-1].z,e[r-1][i].z,e[r-1][i+1].z],p=[e[r-1][i-1].z,e[r-1][i-1].z,e[r-1][i].z,e[r-1][i+1].z],m=[e[r][i-1].z,e[r][i-1].z,e[r][i].z,e[r][i+1].z],v=[e[r+1][i-1].z,e[r+1][i-1].z,e[r+1][i].z,e[r+1][i+1].z];return Utility.BicubicInterpolation([f,p,m,v],(t-e[r-1][0].x)/(e[r][0].x-e[r-1][0].x),(n-c[i-1].y)/(c[i].y-c[i-1].y))}if(h>=0&&d<0&&r+1>=a&&i<s){f=[e[r-2][i-1].z,e[r-2][i-1].z,e[r-2][i].z,e[r-2][i+1].z],p=[e[r-1][i-1].z,e[r-1][i-1].z,e[r-1][i].z,e[r-1][i+1].z],m=[e[r][i-1].z,e[r][i-1].z,e[r][i].z,e[r][i+1].z],v=[e[r][i-1].z,e[r][i-1].z,e[r][i].z,e[r][i+1].z];return Utility.BicubicInterpolation([f,p,m,v],(t-e[r-1][0].x)/(e[r][0].x-e[r-1][0].x),(n-c[i-1].y)/(c[i].y-c[i-1].y))}if(h<0&&d>=0&&r+1<a&&i+1>=s){f=[e[r-1][i-2].z,e[r-1][i-1].z,e[r-1][i].z,e[r-1][i].z],p=[e[r-1][i-2].z,e[r-1][i-1].z,e[r-1][i].z,e[r-1][i].z],m=[e[r][i-2].z,e[r][i-1].z,e[r][i].z,e[r][i].z],v=[e[r+1][i-2].z,e[r+1][i-1].z,e[r+1][i].z,e[r+1][i].z];return Utility.BicubicInterpolation([f,p,m,v],(t-e[r-1][0].x)/(e[r][0].x-e[r-1][0].x),(n-c[i-1].y)/(c[i].y-c[i-1].y))}if(h>=0&&d>=0&&r+1>=a&&i+1>=s){f=[e[r-2][i-2].z,e[r-2][i-1].z,e[r-2][i].z,e[r-2][i].z],p=[e[r-1][i-2].z,e[r-1][i-1].z,e[r-1][i].z,e[r-1][i].z],m=[e[r][i-2].z,e[r][i-1].z,e[r][i].z,e[r][i].z],v=[e[r][i-2].z,e[r][i-1].z,e[r][i].z,e[r][i].z];return Utility.BicubicInterpolation([f,p,m,v],(t-e[r-1][0].x)/(e[r][0].x-e[r-1][0].x),(n-c[i-1].y)/(c[i].y-c[i-1].y))}}static BilinearInterpolation(e,t,n,r,i,a,s,o,l,c){return 1/((a-i)*(o-s))*(e*(a-l)*(o-c)+n*(l-i)*(o-c)+t*(a-l)*(c-s)+r*(l-i)*(c-s))}static bilinearInterpolate(e,t,n){for(var r,i,a=e.length,s=e[0].length,o=(e[e.length-1][0].x-e[0][0].x)/(e.length-1),l=Math.floor((t-e[0][0].x)/o);l<a;l++)if(e[l][0].x>t){r=l;break}void 0==r&&(r=a-1);var c=e[0],u=(c[c.length-1].y-c[0].y)/(c.length-1);for(l=Math.floor((n-c[0].y)/u);l<s;l++)if(c[l].y>n){i=l;break}if(void 0==i&&(i=s-1),t>e[r][0].x||t<e[0][0].x)throw"x out of range";if(n>e[0][i].y||n<e[0][0].y)throw"y out of range";var h,d,f,p,m,v,g,b,S=r-1,y=i-1;return h=e[S][0].x,f=e[r][0].x,d=e[0][i].y,p=e[0][y].y,m=e[S][i].z,v=e[S][y].z,g=e[r][i].z,b=e[r][y].z,Utility.BilinearInterpolation(m,v,g,b,h,f,d,p,t,n)}static generateCurveName(e,t){let n=1,r=t||"curve_",i=r.concat(n);for(;e.findPlotCurve(i);)i=r.concat(++n);return i}static modifiers(e){var t=Static.NoModifier;return e.altKey&&e.ctrlKey&&e.shiftKey?t|Static.AltModifier|Static.ControlModifier|Static.ShiftModifier:e.altKey&&e.ctrlKey?t|Static.AltModifier|Static.ControlModifier:e.altKey&&e.shiftKey?t|Static.AltModifier|Static.ShiftModifier:e.ctrlKey&&e.shiftKey?t|Static.ControlModifier|Static.ShiftModifier:e.altKey?t|Static.AltModifier:e.ctrlKey?t|Static.ControlModifier:e.shiftKey?t|Static.ShiftModifier:t}static button(e){return null!=e&&e.button}static colorList(){return["black","red","green","blue","yellow","brown"]}static makePoints(e){var t=[];return e.forEach(function(e){t.push(new Misc.Point(parseFloat(e[0]),parseFloat(e[1])))}),t}static makeSpectrocurvePoints(e){var t=[],n=Number.MAX_VALUE,r=Number.MIN_VALUE;return e.forEach(function(e){var i=parseFloat(e[2]);i<n&&(n=e[2]),i>r&&(r=e[2]),t.push({x:parseFloat(e[0]),y:parseFloat(e[1]),z:i})}),{points:t,zMin:n,zMax:r}}static pointsToXYObjectArray(e){var t=[];return e.forEach(function(e){t.push({x:e.x,y:e.y})}),t}static pointsFromXYObjectArray(e){var t=[];return e.forEach(function(e){t.push(new Misc.Point(e.x,e.y))}),t}static linearEquationFromPoints(e,t){var n=(t.y-e.y)/(t.x-e.x),r=-n*e.x+e.y,i=n.toString();return i+="x+",i+=r.toString()}static toArrays(e){var t=Number.MAX_VALUE,n=Number.MIN_VALUE,r=null,i=e.split("\n"),a=i[0].toLowerCase();a.includes("curve")?r="curve":a.includes("spectrocurve")?r="spectrocurve":a.includes("spectrogram")&&(r="spectrogram");for(var s=[],o=0;o<i.length;++o){var l=i[o].split(",");isNaN(parseFloat(l))||(3==(l=l.map(function(e){return parseFloat(e)})).length?(s.push({x:l[0],y:l[1],z:l[2]}),s[s.length-1].z<t&&(t=s[s.length-1].z),s[s.length-1].z>n&&(n=s[s.length-1].z)):s.push(l))}return{array:s,dataType:r,minZ:t,maxZ:n}}static setAutoScale(e,t){e.setAxisAutoScale(xBottom,t),e.setAxisAutoScale(yLeft,t),e.setAxisAutoScale(xTop,t),e.setAxisAutoScale(yRight,t)}static majorGridLines(e,t){e.enableX(t),e.enableY(t),Static.trigger("majorGridLines",[e,t])}static minorGridLines(e,t){e.enableXMin(t),e.enableYMin(t),Static.trigger("minorGridLines",[e,t])}static randomColor(e=0){var t=[256*Math.random(),256*Math.random(),256*Math.random()],n=[51*e,51*e,51*e];return"rgb("+[t[0]+n[0],t[1]+n[1],t[2]+n[2]].map(function(e){return Math.round(e/2)}).join(",")+")"}static setCurveBrush(e,t){var n=$('<input type="color" style="opacity:0;">');e&&e.rtti===Static.Rtti_PlotCurve&&(e.brush().color==Static.NoBrush?n.val(Static.colorNameToHex("rgb(255, 255, 254)")):n.val(Static.colorNameToHex(e.brush().color)),n.change(function(){var n=e.brush();n.color=$(this).val(),e.setBrush(n),void 0!==t&&t(e)}),n.trigger("click"))}static removeCurveBrush(e){var t=e.brush();t.color=Static.NoBrush,e.setBrush(t)}static setSymbolPenWidth(e,t){var n=e.symbol();n&&(n.pen().width=t,e.plot().autoRefresh(),Utility.updateLegendIconSize(e),e.plot().updateLegend(e),Static.trigger("symbolAttributeChanged",e))}static updateLegendIconSize(e){var t=e.getLegendIconSize();if(e.symbol()&&(t=e.symbol().boundingRect().size()),e.symbol()&&e.testLegendAttribute(Static.LegendShowSymbol)){if(e.testLegendAttribute(Static.LegendShowLine)){var n=Math.ceil(1.5*t.width);n%2&&n++,t.width=Math.max(40,n)}e.setLegendIconSize(t)}else e.testLegendAttribute(Static.LegendShowLine)&&(t.width=40,e.setLegendIconSize(t))}static setSymbolSize(e,t){var n=e.symbol();if(n){var r=n.size();r.width=t,r.height=t,n.setSize(r),e.plot().autoRefresh(),Utility.updateLegendIconSize(e),e.plot().updateLegend(e),Static.trigger("symbolAttributeChanged",e)}}static addSymbol(e,t){if(e&&e.rtti===Static.Rtti_PlotCurve){t==NoSymbol&&e.setSymbol(null);var n=e.symbol();null==n&&((n=new Symbol).setBrush(new Misc.Brush(Static.NoBrush)),n.setSize(new Misc.Size(10,10)),e.setSymbol(n)),n.size().width<=0&&n.setSize(new Misc.Size(10,10)),n.setStyle(t),e.itemChanged(),e.legendChanged(),Static.trigger("symbolAdded",e)}}static curveRenameDlg(e,t,n){Static.prompt('Enter a new name for "'+e+'"',e,function(r){if(e==r)return Static.alert("You did not change the name!"),!1;var i=t.findPlotCurve(e);return t.findPlotCurve(r)?(Static.alert(r+" already exist"),!1):(i.setTitle(r),void 0!==n&&n(r,i),Static.trigger("curveRenamed",i),!0)},"small")}static setLegendAttribute(e,t,n){return"line"==t?(e.setLegendIconSize(new Misc.Size(n)),e.setLegendAttribute(Static.LegendShowSymbol,!1),void e.setLegendAttribute(Static.LegendShowLine,!0)):"symbol"==t?(e.setLegendIconSize(new Misc.Size(n)),e.setLegendAttribute(Static.LegendShowLine,!1),void e.setLegendAttribute(Static.LegendShowSymbol,!0)):"lineAndSymbol"==t?(e.setLegendIconSize(new Misc.Size(n)),e.setLegendAttribute(Static.LegendShowLine,!0),void e.setLegendAttribute(Static.LegendShowSymbol,!0)):(e.setLegendAttribute(Static.LegendShowLine,!1),void e.setLegendAttribute(Static.LegendShowSymbol,!1))}static enableComponent(e,t,n){for(var r=0;r<axisCnt;++r)e.axisScaleDraw(r).enableComponent(t,n);e.autoRefresh()}static setTickLength(e,t){for(var n=null,r=0;r<axisCnt;++r)n=e.axisScaleDraw(r),"small"==t?(n.setTickLength(MajorTick,6),n.setTickLength(MinorTick,3)):"medium"==t?(n.setTickLength(MajorTick,8),n.setTickLength(MinorTick,4)):"large"==t&&(n.setTickLength(MajorTick,12),n.setTickLength(MinorTick,6));e.autoRefresh()}static mVerifyRange(e,t,n){if(e<1)return 0;if((t=Math.max(0,Math.min(t,e-1)))>(n=Math.max(0,Math.min(n,e-1)))){var r=t;t=n,n=r}return n-t+1}static makeSamples(e){var t,n=e.fx,r=e.lowerX,i=e.upperX,a=e.numOfSamples,s=(e.indepVarIsDegree,e.variable||findIndepVar(n)),o=e.variableY;if(void 0===a&&(a=_numOfSamples),"x"!==s)for(;-1!=n.indexOf(s);)n=n.replace(s,"x");if(e.threeD&&"y"!==o){for(;-1!=n.indexOf(o);)n=n.replace(o,"y");t=e.lowerY;var l=e.upperY}e.threeD&&(t=e.lowerY,l=e.upperY);var c=[],u=new EvaluateExp(n);if(u.error)return Static.alert(u.errorMessage),null;var h,d,f,p=(i-r)/(a-1);e.threeD&&(h=(l-t)/(a-1));for(var m=Number.MAX_VALUE,v=Number.MIN_VALUE,g=0;g<=a-1;++g){var b=r+g*p;if(e.threeD?(d=t+g*h,(f=u.eval({x:b,y:d}))<m&&(m=f),f>v&&(v=f)):d=u.eval({x:b}),isFinite(d))if(!e.threeD||isFinite(f)){if(u.error)return Static.alert(u.errorMessage),null;e.threeD?c.push({x:b,y:d,z:f}):c.push(new Misc.Point(b,d))}else{if(Static.errorResponse==Static.warn)return Static.alert("f("+b+","+d+'): yields infinity. Probably a "divide by zero" error. Try changing the limits or adjusting number of points.'),null;if(Static.errorResponse==Static.warnIgnore){Static.alertYesNo("Error found!!! Do you want to silently ignore errors?",function(e){return e==Static.Cancel?(console.log("C"),null):e==Static.Yes?(console.log("Y"),Static.errorResponse=Static.silentIgnore,Static.errorResponseChanged=!0,null):e==Static.No?(console.log("N"),null):void 0}),c=[];break}}else{if(Static.errorResponse==Static.warn)return Static.alert("f("+b+'): yields infinity. Probably a "divide by zero" error. Try changing the limits or adjusting number of points.'),null;if(Static.errorResponse==Static.warnIgnore){Static.alertYesNo("Error found!!! Do you want to silently ignore errors?",function(e){return e==Static.Cancel?(console.log("C"),null):e==Static.Yes?(console.log("Y"),Static.errorResponse=Static.silentIgnore,Static.errorResponseChanged=!0,null):e==Static.No?(console.log("N"),null):void 0}),c=[];break}}}return Static.errorResponseChanged&&(Static.errorResponseChanged=!1,Static.errorResponse=Static.warnIgnore),e.threeD?{data:c,zLimits:{min:m,max:v}}:c}}function PaintUtil(){function e(e){var t=e,n="",r=null;this.getTransform=function(e,n){return new class{constructor(){var e=t.getTransform();this.dx=function(){return e.m41},this.dy=function(){return e.m42},this.mapRect=function(t){var n=t.left(),r=t.top();return new Misc.Rect(e.m11*n+e.m21*r+this.dx(),e.m22*r+e.m12*n+this.dy(),t.width(),t.height())},this.map=function(t){var n=t.x,r=t.y;return new Misc.Point(e.m11*n+e.m21*r+this.dx(),e.m22*r+e.m12*n+this.dy())}}}},this.textSize=function(e){t.save(),t.font=r.weight+" "+r.style+" "+r.th+"px "+r.name;var n=t.measureText(e).width,i=t.measureText("M").width;return t.restore(),new Misc.Size(n,i)},this.context=function(){return t},this.canvasWidth=function(){return t.canvas.width},this.canvasHeight=function(){return t.canvas.height},this.save=function(){t.save()},this.restore=function(){t.restore()},this.translate=function(e,n){t.translate(e,n)},this.rotate=function(e){t.rotate(e*Math.PI/180)},this.scale=function(e,n){t.scale(e,n)},this.setPen=function(e){this.style==Static.NoPen?t.strokeStyle="transparent":t.strokeStyle=e.color,t.lineWidth=e.width,"dash"===e.style?t.setLineDash([10,5]):"dot"===e.style?t.setLineDash([3,8]):"dashDot"===e.style?t.setLineDash([12,5,3,5]):"dashDotDot"===e.style&&t.setLineDash([12,5,3,5,3,5]),n=e.style},this.pen=function(){var e="";return e="transparent"==t.strokeStyle?NoPen:t.strokeStyle,new Misc.Pen(e,t.lineWidth,n)},this.setBrush=function(e){void 0===e.color||e.color===Static.NoBrush?t.fillStyle="transparent":t.fillStyle=e.color},this.brush=function(){return t.fillStyle},this.setFont=function(e){t.font=e.weight+" "+e.style+" "+e.th+"px "+e.name,""!=typeof e.fontColor&&(t.fillStyle=e.fontColor),r=e},this.font=function(){return r},this.fillRect=function(e,n){n.style!==NoBrush&&(this.setBrush(n),t.rect(e.left(),e.top(),e.width(),e.height()),t.fill())},this.drawPath=function(e){t.beginPath();for(var n=0;n<e.elementCount();n++){var r=e.elementAt(n),i=r.x,a=r.y;switch(r.type){case MoveToElement:t.moveTo(i,a);break;case LineToElement:t.lineTo(i,a);break;case CurveToElement:var s=e.elementAt(++n),o=s.x,l=s.y,c=e.elementAt(++n),u=c.x,h=c.y;t.bezierCurveTo(i,a,o,l,u,h)}}t.stroke(),t.fill()},this.drawPoint=function(e){var n=this.pen().width;t.fillStyle=this.pen().color,t.fillRect(e.x-1*n,e.y-1*n,1.9*n,2*n)},this.drawPoints=function(e){t.fillStyle=this.pen().color;for(var n=this.pen().width,r=0;r<e.length;++r)t.fillRect(e[r].x-1*n,e[r].y-1*n,1.9*n,2*n)},this.drawLine=function(e,n,r,i){t.beginPath(),void 0!==i&&void 0!==r?(t.moveTo(e,n),t.lineTo(r,i)):(t.moveTo(e.x,e.y),t.lineTo(n.x,n.y)),t.stroke()},this.drawImage=function(e,n,r,i,a){var s=0,o=0,l=e.width(),c=e.height();"object"==typeof n&&(s=n.left(),o=n.top(),l=n.width(),c=n.height()),"number"==typeof n&&"number"==typeof r&&(s=n,o=r),"number"==typeof i&&"number"==typeof a&&(l=i,c=a),e.width()>0&&e.height()>0&&t.putImageData(e.imageData(),s,o,0,0,l,c)},this.drawPolyline=function(e){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var n=1;n<e.length;++n)t.lineTo(e[n].x,e[n].y);t.stroke()},this.drawPolygon=function(e){e[0].x===e[e.length-1].x&&e[0].y===e[e.length-1].y||e.push(e[0]),t.beginPath(),this.drawPolyline(e),t.closePath(),t.fill()},this.drawRect=function(e,n,r,i){if(t.beginPath(),"number"==typeof e)t.rect(e,n,r,i);else{var a=e;t.rect(a.left(),a.top(),a.width(),a.height())}t.stroke(),t.fill(),t.closePath()},this.drawCircle=function(e,n,r){if(t.beginPath(),"number"==typeof e)t.arc(e,n,r,0,2*Math.PI,!1);else{var i=e;r=n,t.arc(i.x,i.y,r,0,2*Math.PI,!1)}t.stroke(),t.fill(),t.closePath()},this.drawEllipse=function(e){var n=(e.left()+e.right())/2,r=(e.top()+e.bottom())/2,i=e.width(),a=e.height();t.beginPath(),t.moveTo(n,r-a/2),t.bezierCurveTo(n+i/2,r-a/2,n+i/2,r+a/2,n,r+a/2),t.bezierCurveTo(n-i/2,r+a/2,n-i/2,r-a/2,n,r-a/2),t.stroke(),t.fill(),t.closePath(),t.closePath()},this.drawVerticalText=function(e,n,r,i){var a=-1;void 0!==i&&!0===i&&(a=1);var s=t.measureText(e);t.save();var o=n,l=r-a*s.width/2;t.translate(o,l),t.rotate(a*Math.PI/2),t.translate(-o,-l),-1===a&&(t.textAlign="left"),t.fillText(e,o,l),t.restore()},this.drawText=function(e,n,i,a,s){void 0!==s&&(e=function(e,t){for(var n=e,i=r.textSize(n).width;i>t&&n.substring;)n=n.substring(0,n.length-1),i=r.textSize(n).width;return n}(e,s)),void 0!==a&&(t.textAlign=a),t.fillText(e,n,i)},this.toString=function(){return"[Painter: "+t+"]"}}function t(e){var t="http://www.w3.org/2000/svg",n=e,r=new Misc.Pen;r.style=Static.NoPen;var i=new Misc.Brush,a=new Misc.Font,s=null;function o(){r.style===Static.NoPen?s.attr("stroke","transparent"):s.attr("stroke",r.color),s.attr("stroke-Width",r.width),"dash"===r.style?s.attr("stroke-dasharray",[10,5]):"dot"===r.style?s.attr("stroke-dasharray",[3,8]):"dashDot"===r.style?s.attr("stroke-dasharray",[12,5,3,5]):"dashDotDot"===r.style&&s.attr("stroke-dasharray",[12,5,3,5,3,5])}function l(){i.color===Static.NoBrush?s.attr("fill","transparent"):s.attr("fill",i.color)}this.setBrush=function(e){i=e},this.setPen=function(e){r=e},this.pen=function(){return r},this.rotate=function(e,t,n){xCenter=t||0,yCenter=n||0,e&&s.attr("transform"," rotate("+e+" "+xCenter+" "+yCenter+")")},this.transform=function(e){var t=e.translateX||0,n=e.translateY||0,r=e.scaleX||1,i=e.scaleY||1,a=e.rotation||0,o=e.rotationX||0,l=e.rotationY||0,c="";1==r&&1==i||(c+=" scale("+r+" "+i+")"),a&&(c+=" rotate("+a+" "+o+" "+l+")"),1==t&&1==n||(c+=" translate("+t+" "+n+")"),s.attr("transform",c)},this.drawRect=function(e,r,i,a){(s=$(document.createElementNS(t,"rect"))).attr("x",e),s.attr("y",r),s.attr("width",i),s.attr("height",a),l(),o(),s.appendTo($(n.svg()))},this.drawPath=function(e){s=$(document.createElementNS(t,"path"));for(var r=e.data,i="",a=0;a<e.elementCount();a++){var c=e.elementAt(a),u=c.x+r.xOffset,h=c.y+r.yOffset;switch(c.type){case MoveToElement:i+="M"+u+" "+h+" ";break;case LineToElement:i+="L"+u+" "+h+" ";break;case CurveToElement:var d=e.elementAt(++a),f=d.x+r.xOffset,p=d.y+r.yOffset,m=e.elementAt(++a);i+="C "+u+" "+h+" "+f+" "+p+" "+(m.x+r.xOffset)+" "+(m.y+r.yOffset)+" "}}s.attr("d",i),s.attr("transform"," scale("+r.scale+") rotate("+r.rotation+" "+r.xCenter+" "+r.yCenter+")"),l(),o(),s.appendTo($(n.svg()))},this.fillRect=function(e,r){(s=$(document.createElementNS(t,"rect"))).attr("x",e.left),s.attr("y",e.top),s.attr("width",e.width),s.attr("height",e.height),s.attr("fill",r.color),o(),s.appendTo($(n.svg()))},this.drawCircle=function(e,r,i){(s=$(document.createElementNS(t,"circle"))).attr("cx",e),s.attr("cy",r),s.attr("r",i),l(),o(),s.appendTo($(n.svg()))},this.drawLine=function(e,r,i,a){(s=$(document.createElementNS(t,"line"))).attr("x1",e),s.attr("y1",r),s.attr("x2",i),s.attr("y2",a),o(),s.appendTo($(n.svg()))},this.drawText=function(e,r,i){(s=$(document.createElementNS(t,"text"))).attr("x",r),s.attr("y",i),s.attr("font-size",a.th),s.attr("font-family",a.name),s.attr("font-weight",a.weight),s.attr("font-style",a.style),o(),l(),s[0].textContent=e,s.appendTo($(n.svg()))},this.textSize=function(e){return a.textSize(e)},this.setFont=function(e){a=e},this.font=function(){return a},this.toString=function(){return"[GraphicPainter]"}}PaintUtil.Painter=function(n){var r=null,i=!1;"[Graphic]"===n.toString()?(i=!0,r=new t(n)):r="[object CanvasRenderingContext2D]"===n.toString()?new e(n):new e(n.getContext()),this.isGraphicPainter=function(){return i},this.textSize=function(e){return r.textSize(e)},this.context=function(){if(!i)return r.context()},this.canvasWidth=function(){if(!i)return r.canvasWidth()},this.canvasHeight=function(){if(!i)return r.canvasHeight()},this.save=function(){i||r.save()},this.restore=function(){i||r.restore()},this.translate=function(e,t){i||r.translate(e,t)},this.scale=function(e,t){i||r.scale(e,t)},this.rotate=function(e,t,n){i||r.rotate(e,t,n)},this.transform=function(e){if(void 0==e)return r.getTransform();i&&r.transform(e)},this.setPen=function(e){r.setPen(e)},this.pen=function(){return r.pen()},this.setBrush=function(e){r.setBrush(e)},this.brush=function(){return r.brush()},this.setFont=function(e){r.setFont(e)},this.font=function(){return r.font()},this.fillRect=function(e,t){r.fillRect(e,t)},this.drawPath=function(e){r.drawPath(e)},this.drawPoint=function(e){i||r.drawPoint(e)},this.drawPoints=function(e){i||r.drawPoints(e)},this.drawLine=function(e,t,n,i){r.drawLine(e,t,n,i)},this.drawImage=function(e,t,n,i,a){r.drawImage(e,t,n,i,a)},this.drawPolyline=function(e){i||r.drawPolyline(e)},this.drawPolygon=function(e){i||r.drawPolygon(e)},this.drawRect=function(e,t,n,i){r.drawRect(e,t,n,i)},this.drawVerticalText=function(e,t,n,a){i||r.drawVerticalText(e,t,n,a)},this.drawText=function(e,t,n,i,a){r.drawText(e,t,n,i,a)},this.drawCircle=function(e,t,n){r.drawCircle(e,t,n)},this.drawEllipse=function(e){r.drawEllipse(e)},this.toString=function(){return r.toString()}}}define("utility",function(){}),PaintUtil(),define("painter",function(){});var ScaleDiv=function(e,t,n,r,i){var a=0,s=0,o=[];if(void 0===e||void 0===t);else if(void 0===n&&"object"==typeof e&&"object"==typeof t){var l=e,c=t;a=l.minValue(),s=l.maxValue();for(var u=0;u<NTickTypes;u++)o[u]=c[u]}else if(void 0===r)for(lowerBound=e,upperBound=t,c=n,a=lowerBound,s=upperBound,u=0;u<NTickTypes;u++)o[u]=c[u];else void 0===e&&void 0===t&&void 0===n&&void 0===r&&void 0===i&&(lowerBound=e,upperBound=t,minorTicks=n,mediumTicks=r,majorTicks=i,a=lowerBound,s=upperBound,o[MinorTick]=minorTicks,o[MediumTick]=mediumTicks,o[MajorTick]=majorTicks);this.setInterval=function(e,t){"number"==typeof e&&"number"==typeof t?(lowerBound=e,upperBound=t,a=lowerBound,s=upperBound):"object"==typeof e&&void 0===t&&(a=(l=e).minValue(),s=l.maxValue())},this.interval=function(){return new Interval(a,s)},this.setLowerBound=function(e){a=e},this.lowerBound=function(){return a},this.setUpperBound=function(e){s=e},this.upperBound=function(){return s},this.range=function(){return s-a},this.isEmpty=function(){return a==s},this.isIncreasing=function(){return a<=s},this.contains=function(e){var t=Math.min(a,s),n=Math.max(a,s);return e>=t&&e<=n},this.invert=function(){var e=a;a=s,s=e;for(var t=0;t<NTickTypes;t++){for(var n=o[t],r=n.length,i=r/2,l=0;l<i;l++)e=n[l],n[l]=n[r-1-l],n[r-1-l]=e;o[t]=n}},this.inverted=function(){var e=new ScaleDiv(a,s,o);return e.invert(),e},this.bounded=function(e,t){var n=Math.min(e,t),r=Math.max(e,t),i=new ScaleDiv;for(i.setInterval(e,t),tickType=0;tickType<NTickTypes;tickType++){var a=o[tickType],s=[];for(u=0;u<a.size();u++){var l=a[u];l>=n&&l<=r&&s.push(l)}i.setTicks(tickType,s)}return i},this.setTicks=function(e,t){e>=0&&e<NTickTypes&&(o[e]=t)},this.ticks=function(e){return e>=0&&e<NTickTypes?o[e]:[]}};ScaleDiv.prototype.toString=function(){return"[ScaleDiv]"},define("scaleDiv",function(){});class Interval{constructor(e,t,n){var r=0,i=-1,a=IncludeBorders;void 0!==e&&void 0!==t&&(r=e,i=t),void 0!==n&&(a=n),this.setBorderFlags=function(e){a=e},this.borderFlags=function(){return a},this.setMinValue=function(e){r=e},this.setMaxValue=function(e){i=e},this.minValue=function(){return r},this.maxValue=function(){return i}}toString(){return"[Interval]"}setInterval(e,t,n){this.setMinValue(e),this.setMaxValue(t),this.setBorderFlags(n)}isValid(){return 0==(this.borderFlags()&ExcludeBorders)?this.minValue()<=this.maxValue():this.minValue()<this.maxValue()}width(){return this.isValid()?this.maxValue()-this.minValue():0}isNull(){return this.isValid()&&this.minValue()>=this.maxValue()}invalidate(){this.setMinValue(0),this.setMaxValue(-1)}normalized(){return this.minValue()>this.maxValue()?this.inverted():this.minValue()==this.maxValue()&&this.borderFlags()==ExcludeMinimum?this.inverted():this}inverted(){var e=IncludeBorders;return this.borderFlags()&ExcludeMinimum&&(e|=ExcludeMaximum),this.borderFlags()&ExcludeMaximum&&(e|=ExcludeMinimum),new Interval(this.maxValue(),this.minValue(),e)}contains(e){return!!this.isValid()&&(!(e<this.minValue()||e>this.maxValue())&&(!(e==this.minValue()&&this.borderFlags()&ExcludeMinimum)&&!(e==this.maxValue()&&this.borderFlags()&ExcludeMaximum)))}limited(e,t){if(!this.isValid()||e>t)return new Interval;var n=Math.max(this.minValue(),e);n=Math.min(n,t);var r=Math.max(this.maxValue(),e);return r=Math.min(r,t),new Interval(n,r,this.borderFlags())}}define("interval",function(){});var Transform=function(){};Transform.prototype.toString=function(){return"[Transform]"},Transform.prototype.bounded=function(e){return e};var NullTransform=function(){Transform.call(this)};NullTransform.prototype=Object.create(Transform.prototype),NullTransform.prototype.constructor=NullTransform,NullTransform.prototype.toString=function(){return"[NullTransform]"},NullTransform.prototype.transform=function(e){return e},NullTransform.prototype.invTransform=function(e){return e},NullTransform.prototype.copy=function(){return new NullTransform};var LogTransform=function(){Transform.call(this)};LogTransform.prototype=Object.create(Transform.prototype),LogTransform.prototype.constructor=LogTransform,LogTransform.prototype.toString=function(){return"[LogTransform]"},LogTransform.prototype.transform=function(e){return Math.log(e)},LogTransform.prototype.invTransform=function(e){return Math.exp(e)},LogTransform.prototype.bounded=function(e){return e>Number.MAX_VALUE?Number.MAX_VALUE:e<Number.MIN_VALUE?Number.MIN_VALUE:e},LogTransform.prototype.copy=function(){return new LogTransform};var PowerTransform=function(e){Transform.call(this),this.d_exponent=e};PowerTransform.prototype=Object.create(Transform.prototype),PowerTransform.prototype.constructor=PowerTransform,PowerTransform.prototype.toString=function(){return"[PowerTransform]"},PowerTransform.prototype.transform=function(e){return e<0?-Math.pow(-e,1/d_exponent):Math.pow(e,1/d_exponent)},PowerTransform.prototype.invTransform=function(e){return e<0?-Math.pow(-e,d_exponent):Math.pow(e,d_exponent)},PowerTransform.prototype.copy=function(){return new PowerTransform(d_exponent)},define("transform",function(){});class ScaleMap{static invTransform_Rect(e,t,n){var r=e.invTransform(n.left()),i=e.invTransform(n.right()-1),a=t.invTransform(n.top()),s=t.invTransform(n.bottom()-1);return new Misc.Rect(new Misc.Point(r,a),i-r,s-a).normalized()}static transform_Rect(e,t,n){var r=e.transform(n.left()),i=e.transform(n.right()),a=t.transform(n.top()),s=t.transform(n.bottom());return new Misc.Rect(new Misc.Point(r,a),i-r,s-a).normalized()}static invTransform(e,t,n){return new Misc.Point(e.invTransform1(n.x),t.invTransform1(n.y))}static transform(e,t,n){return new Misc.Point(e.transform1(n.x),t.transform1(n.y))}static transformPath(e,t,n,r){for(var i=new Misc.MPath,a=0;a<n.elementCount();a++){var s=n.elementAt(a),o=e.transform(s.x),l=t.transform(s.y);switch(s.type){case MoveToElement:r&&(o=Math.round(o),l=Math.round(l)),i.moveTo(o,l);break;case LineToElement:r&&(o=Math.round(o),l=Math.round(l)),i.lineTo(o,l);break;case CurveToElement:var c=n.elementAt(++a),u=e.transform(c.x),h=t.transform(c.y),d=n.elementAt(++a),f=e.transform(d.x),p=t.transform(d.y);i.cubicTo(o,l,u,h,f,p)}}return i}constructor(){var e=0,t=1,n=0,r=1,i=1,a=0,s=null;this.setd_cnv=function(e){i=e},this.setd_ts1=function(e){a=e},this.setTransformation=function(n){n!==s&&(s=n),this.setScaleInterval(e,t)},this.transformation=function(){return s},this.setScaleInterval=function(n,r){e=n,t=r,s&&(e=s.bounded(e),t=s.bounded(t)),this.updateFactor()},this.setPaintInterval=function(e,t){n=e,r=t,this.updateFactor()},this.copy=function(){var e=new ScaleMap;return e.setScaleInterval(this.s1(),this.s2()),e.setPaintInterval(this.p1(),this.p2()),e},this.updateFactor=function(){a=e;var o=t;s&&(a=s.transform(a),o=s.transform(o)),i=1,a!=o&&(i=(r-n)/(o-a))},this.invTransform=function(e){return this.invTransform1(e)},this.transform=function(e){return this.transform1(e)},this.transform1=function(e){return s&&(e=s.transform(e)),n+(e-a)*i},this.invTransform1=function(e){var t=a+(e-n)/i;return s&&(t=s.invTransform(t)),t},this.s1=function(){return e},this.s2=function(){return t},this.p1=function(){return n},this.p2=function(){return r},this.copy=function(){var s=new ScaleMap;return s.setScaleInterval(e,t),s.setPaintInterval(n,r),s.setd_cnv(i),s.setd_ts1(a),this.transformation()&&s.setTransformation(this.transformation().copy()),s},this.isInverting=function(){return n<r!=e<t},this.toString=function(){return'[ScaleMap "'+i+'"]'}}}define("scaleMap",["static","transform"],function(){});class Layout{constructor(e,t){var n=t;if(e){e.parent()[0]===document.body&&e.css("position","absolute");var r=$("<div />").attr({id:"titleDiv"});e.append(r);var i=$("<div />").attr({id:"topScaleDiv"});e.append(i),"auto"!==i.css("top")&&parseFloat(i.css("top"));var a=$("<div />").attr({id:"leftScaleDiv"});e.append(a),"auto"!==a.css("left")&&parseFloat(a.css("left"));var s=$("<div />").attr({id:"centralDiv"});e.append(s),"auto"!==s.css("top")&&parseFloat(s.css("top")),"auto"!==s.css("bottom")&&parseFloat(s.css("bottom")),"auto"!==s.css("right")&&parseFloat(s.css("right")),"auto"!==s.css("left")&&parseFloat(s.css("left")),this.getCentralDiv=function(){return s};var o=$("<div />").attr({id:"rightScaleDiv"});e.append(o),"auto"!==o.css("right")&&parseFloat(o.css("right"));var l=$("<div/>").attr({id:"legendDiv"});e.append(l),"auto"!==l.css("right")&&parseFloat(l.css("right"));var c=$("<div />").attr({id:"bottomScaleDiv"});e.append(c),"auto"!==c.css("bottom")&&parseFloat(c.css("bottom"));var u=$("<div />").attr({id:"footerDiv"});e.append(u),"auto"!==u.css("bottom")&&parseFloat(u.css("bottom")),this.getPlotDiv=function(){return e},this.getLegendDiv=function(){return l},this.getTitleDiv=function(){return r},this.getFooterDiv=function(){return u};var h=[a,o,c,i];this.getScaleDivElement=function(e){return e<0||e>=axisCnt?null:h[e]},this.adjustLayout=function(e,t){var n="width";"footerDiv"!==e[0].id&&"titleDiv"!==e[0].id&&"topScaleDiv"!==e[0].id&&"bottomScaleDiv"!==e[0].id||(n="height"),e.css(n,t)},this.updateLayout=function(){var e,t,o;void 0!==n&&(e="none"==r.css("display"),n.axisEnabled(xTop)?e?d():f():e?p():m(),"none"!==r.css("display")?n.axisEnabled(xTop)?d():p():n.axisEnabled(xTop)?f():m(),t="none"==u.css("display"),n.axisEnabled(xBottom)?t?v():g():t?b():S(),"none"!=u.css("display")?n.axisEnabled(xBottom)?v():b():n.axisEnabled(xBottom)?g():S(),n.legend()&&l.css("width",n.legend().legendDivWidth()),n.axisEnabled(yRight)?n.isLegendEnabled()?y():x():n.isLegendEnabled()?w():_(),n.isLegendEnabled()?n.axisEnabled(yRight)?y():w():n.axisEnabled(yRight)?x():_(),o=parseFloat(a.css("width")),n.axisEnabled(yLeft)?(r.css("left",o),i.css("left",o),u.css("left",o),c.css("left",o),s.css("left",o)):(r.css("left",0),i.css("left",0),u.css("left",0),c.css("left",0),s.css("left",0)))},this.isLegendDivVisible=function(){return"block"===l[0].style.display},this.setPlot=function(e){n=e},this.toString=function(){return"[Layout]"}}function d(){var e=parseFloat(r.css("height")),t=parseFloat(i.css("height"));l.css("top",e),i.css("top",e),s.css("top",e+t),a.css("top",e+t),o.css("top",e+t)}function f(){var e=parseFloat(i.css("height"));l.css("top",0),i.css("top",0),s.css("top",e),a.css("top",e),o.css("top",e)}function p(){var e=parseFloat(r.css("height"));l.css("top",e),s.css("top",e),a.css("top",e),o.css("top",e)}function m(){l.css("top",0),s.css("top",0),a.css("top",0),o.css("top",0)}function v(){var e=parseFloat(u.css("height")),t=parseFloat(c.css("height"));l.css("bottom",e),c.css("bottom",e),s.css("bottom",e+t),a.css("bottom",e+t),o.css("bottom",e+t)}function g(){var e=parseFloat(c.css("height"));l.css("bottom",0),c.css("bottom",0),s.css("bottom",e),a.css("bottom",e),o.css("bottom",e)}function b(){var e=parseFloat(u.css("height"));l.css("bottom",e),s.css("bottom",e),a.css("bottom",e),o.css("bottom",e)}function S(){l.css("bottom",0),s.css("bottom",0),a.css("bottom",0),o.css("bottom",0)}function y(){var e=parseFloat(l.css("width")),t=parseFloat(o.css("width"));r.css("right",e+t+14+3),i.css("right",e+t+14+3),u.css("right",e+t+14+3),c.css("right",e+t+14+3),l.css("right",3),s.css("right",e+t+14+3),o.css("right",e+14+3)}function x(){var e=parseFloat(o.css("width"));r.css("right",e),i.css("right",e),u.css("right",e),c.css("right",e),s.css("right",e),o.css("right",0)}function w(){var e=parseFloat(l.css("width"));s.css("right",e+3+14),r.css("right",e+3+14),i.css("right",e+3+14),u.css("right",e+3+14),c.css("right",e+3+14),l.css("right",3)}function _(){r.css("right",0),i.css("right",0),u.css("right",0),c.css("right",0),s.css("right",0)}}}define("layout",function(){});class AbstractScaleDraw{constructor(){Static.makeAbstract(this,AbstractScaleDraw);var e=Enum.ScaleComponent.Backbone|Enum.ScaleComponent.Ticks|Enum.ScaleComponent.Labels,t=[];t[MinorTick]=4,t[MediumTick]=6,t[MajorTick]=8;var n=new ScaleMap,r=null,i=3,a=-1e4,s=1e4,o=4,l=1;this.data={},this.setNonExponentLimits=function(e,t){a=e,s=t},this.getNonExponentNotationLimits=function(){return{lower:a,upper:s}},this.decimalPlaces=function(){return i},this.setDecimalPlaces=function(e){i=e},this.longestLabel=function(){var e="",t=r.ticks(MajorTick);return t.forEach(function(n,o){0!==o&&o!==t.length-1&&r.contains(n)&&(((n=Static.adjustForDecimalPlaces(n,i))>s||n<a)&&(n=n.toExponential(i)),n.toString().length>e.length&&(e=n.toString()))}),e},this.enableComponent=function(t,n){n?e|=t:e&=~t},this.hasComponent=function(t){return e&t},this.setScaleDiv=function(e){r=e,n.setScaleInterval(r.lowerBound(),r.upperBound())},this.setTransformation=function(e){n.setTransformation(e)},this.scaleMap=function(){return n},this.scaleDiv=function(){return r},this.setPenWidth=function(e){e<=0&&(e=1),e!==l&&(l=e)},this.penWidth=function(){return l},this.draw=function(e){if(this.orientation()===Horizontal?n.setPaintInterval(0,e.canvasWidth()):n.setPaintInterval(e.canvasHeight(),0),this.hasComponent(Enum.ScaleComponent.Labels))for(var i=r.ticks(MajorTick),a=0;a<i.length;a++){var s=i[a];r.contains(s)&&this.drawLabel(e,s)}if(this.hasComponent(Enum.ScaleComponent.Ticks)){e.save(),e.setPen(new Misc.Pen("grey",l));for(var o=MinorTick;o<NTickTypes;o++){var c=r.ticks(o);for(a=0;a<c.length;a++){s=c[a];r.contains(s)&&this.drawTick(e,s,t[o])}}e.restore()}this.hasComponent(Enum.ScaleComponent.Backbone)&&(e.save(),e.setPen(new Misc.Pen("grey",l)),this.drawBackbone(e),e.restore())},this.setSpacing=function(e){e<0&&(e=0),o=e},this.spacing=function(){return o},this.setTickLength=function(e,n){if(!(e<MinorTick||e>MajorTick)){n<0&&(n=0);n>1e3&&(n=1e3),t[e]=n}},this.tickLength=function(e){return e<MinorTick||e>MajorTick?0:t[e]},this.maxTickLength=function(){for(var e=0,n=0;n<NTickTypes;n++)e=Math.max(e,t[n]);return e},this.label=function(e){return Static.mFuzzyCompare(e+1,1)&&(e=0),e.toString()},this.toString=function(){return"[AbstractScaleDraw]"}}}define("abstractScaleDraw",function(){});class ScaleDraw extends AbstractScaleDraw{constructor(){super();var e=BottomScale;this.orientation=function(){return e===TopScale||e===BottomScale?Horizontal:Vertical},this.alignment=function(){return e},this.setAlignment=function(t){e=t},this.getBorderDistHint=function(e,t){},this.toString=function(){return"[ScaleDraw]"},this.drawTick=function(e,t,n){if(!(n<=0)){var r=this.scaleMap().transform(t)+0,i=this.hasComponent(Enum.ScaleComponent.Backbone);switch(this.alignment()){case LeftScale:var a=e.canvasWidth();i&&(a-=2);var s=a-n;e.drawLine(a,r,s,r);break;case RightScale:a=0;i&&(a+=2);s=a+n;e.drawLine(a,r,s,r);break;case BottomScale:var o=0;i&&(o+=2);var l=o+n;e.drawLine(r,o,r,l);break;case TopScale:o=e.canvasHeight();i&&(o-=2);l=o-n;e.drawLine(r,o,r,l)}}},this.drawBackbone=function(e){var t=.5*e.pen().width,n=this.hasComponent(Enum.ScaleComponent.Backbone);switch(this.alignment()){case LeftScale:var r=e.canvasWidth()-t;n&&(r-=2),e.drawLine(r,0,r,e.canvasHeight());break;case RightScale:r=t;n&&(r+=2),e.drawLine(r,0,r,e.canvasHeight());break;case TopScale:var i=e.canvasHeight()-t;n&&(i-=2),e.drawLine(0,i,e.canvasWidth(),i);break;case BottomScale:i=t;n&&(i+=2),e.drawLine(0,i,e.canvasWidth(),i)}},this.labelPosition=function(e,t){e.save();var n=this.scaleMap().transform(t),r=this.spacing();this.hasComponent(Enum.ScaleComponent.Backbone)&&(r+=1),this.hasComponent(Enum.ScaleComponent.Ticks)&&(r+=this.tickLength(MajorTick));var i=0,a=0,s=e.measureText("M").width;switch(this.alignment()){case RightScale:i=r,a=n+.5*s+0;break;case LeftScale:i=e.canvas.width-r,a=n+.5*s+0;break;case BottomScale:i=n+0,a=r+s;break;case TopScale:i=n+0,a=e.canvas.height-r}return e.restore(),new Misc.Point(i,a)},this.drawLabel=function(e,t){t=Static.adjustForDecimalPlaces(t,this.decimalPlaces());var n=this.getNonExponentNotationLimits();(t>n.upper||t<n.lower)&&(t=t.toExponential(this.decimalPlaces()));var r=this.label(t);if(""!==r){var i=this.labelPosition(e.context(),t);if(this.orientation()!=Horizontal||0!==i.x&&i.x!=e.canvasWidth()){var a=e.textSize(r),s=a.height;if(this.orientation()!=Vertical||!(Math.abs(i.y-.5*s-0)<s||Math.abs(i.y-.5*s-e.canvasHeight())<s)){var o="center",l="undefined";if(this.alignment()===LeftScale)o="right",l="undefined";else if(this.alignment()===RightScale)o="left",l="undefined";else{l=e.canvasWidth()/(this.scaleDiv().ticks(MajorTick).length-1)-5;var c=a.width;if(c>l&&(c=l),i.x-c/2<0||i.x+c/2>e.canvasWidth())return}e.drawText(r,i.x,i.y,o,l)}}}}}}function ceilEps(e,t){return e=(e-_eps*t)/t,Math.ceil(e)*t}function floorEps(e,t){return e=(e+_eps*t)/t,Math.floor(e)*t}function divideEps(e,t){return 0===t||0===e?0:(e-_eps*e)/t}define("scaleDraw",["static","abstractScaleDraw"],function(){}),Static.mLog=function(e,t){return Math.log(t)/Math.log(e)},Static.mLogInterval=function(e,t){return new Interval(Static.mLog(e,t.minValue()),Static.mLog(e,t.maxValue()))},Static.mPowInterval=function(e,t){return new Interval(Math.pow(e,t.minValue()),Math.pow(e,t.maxValue()))},Static.mStepSize=function(e,t,n){if(t<=0)return 0;if(t>2)for(var r=t;r>1;r--)for(var i=e/r,a=Math.floor(Math.log(i)/Math.log(n)),s=Math.pow(n,a),o=n;o>1;o/=2){if(Static.mFuzzyCompare(i,o*s))return i;if(3===o&&n%2==0&&Static.mFuzzyCompare(i,2*s))return i}return.5*e},Static.divideInterval=function(e,t,n){if(t<=0)return 0;var r=divideEps(e,t);if(0===r)return 0;for(var i=Static.mLog(n,Math.abs(r)),a=Math.floor(i),s=Math.pow(n,i-a),o=n;o>1&&s<=o/2;)o/=2;var l=o*Math.pow(n,a);return r<0&&(l=-l),l};class ScaleEngine{constructor(e){var t=10,n=0,r=0;void 0!==e&&(t=e);var i=null,a=0;this.lowerMargin=function(){return n},this.upperMargin=function(){return r},this.setMargins=function(e,t){n=Math.max(e,0),r=Math.max(t,0)},this.setTransformation=function(e){e!==i&&(i=e)},this.transformation=function(){var e=null;return i&&(e=i.copy()),e},this.divideInterval=function(e,n){return Static.divideInterval(e,n,t)},this.contains=function(e,t){return!!e.isValid()&&(!(Static.m3FuzzyCompare(t,e.minValue(),e.width())<0)&&!(Static.m3FuzzyCompare(t,e.maxValue(),e.width())>0))},this.strip=function(e,t){if(!t.isValid()||0===e.length)return[];if(this.contains(t,e[0])&&this.contains(t,e[e.length-1]))return e;for(var n=[],r=0;r<e.length;r++)this.contains(t,e[r])&&n.push(e[r]);return n},this.buildInterval=function(e){var t=0===e?.5:Math.abs(.5*e);return Number.MAX_VALUE-t<e?new Interval(Number.MAX_VALUE-t,Number.MAX_VALUE):-Number.MAX_VALUE+t>e?new Interval(-Number.MAX_VALUE,-Number.MAX_VALUE+t):new Interval(e-t,e+t)},this.setBase=function(e){t=Math.max(e,2)},this.base=function(){return t},this.setReference=function(e){a=e},this.reference=function(){return a}}toString(){return"[ScaleEngine]"}}class LinearScaleEngine extends ScaleEngine{constructor(e){super(e),this.autoScale=function(e,t,n){var r=new Interval(t.x1,t.x2);(r=r.normalized()).setMinValue(r.minValue()-this.lowerMargin()),r.setMaxValue(r.maxValue()+this.upperMargin()),0===r.width()&&(r=this.buildInterval(r.minValue())),Static.divideInterval(r.width(),Math.max(e,1),this.base()),t.x1=r.minValue(),t.x2=r.maxValue()},this.divideScale=function(e,t,n,r,i){void 0===i&&(i=0);var a=new Interval(e,t).normalized();if(a.width()<=0)return new ScaleDiv;0===(i=Math.abs(i))&&(n<1&&(n=1),i=Static.divideInterval(a.width(),n,this.base()));var s=new ScaleDiv;if(0!==i){var o=[];this.buildTicks(a,i,r,o),s=new ScaleDiv(a,o)}return e>t&&s.invert(),s},this.buildTicks=function(e,t,n,r){var i=this.align(e,t);if(r[MajorTick]=this.buildMajorTicks(i,t),n>0){var a=[],s=[];this.buildMinorTicks(r[MajorTick],n,t,a,s),r[MinorTick]=a,r[MediumTick]=s}for(var o=0;o<NTickTypes;o++){var l=this.strip(r[o],e);r[o]=[],r[o]=l;for(var c=0;c<r[o].length;c++)0===Static.m3FuzzyCompare(r[o][c],0,t)&&(r[o][c]=0)}},this.buildMajorTicks=function(e,t){var n=Math.round(e.width()/t)+1;n>1e4&&(n=1e4);var r=[];r.push(e.minValue());for(var i=1;i<n-1;i++)r.push(e.minValue()+i*t);return r.push(e.maxValue()),r},this.buildMinorTicks=function(e,t,n,r,i){var a=Static.mStepSize(n,t,this.base());if(0!==a){var s=Math.ceil(Math.abs(n/a))-1,o=-1;s%2&&(o=s/2);for(var l=0;l<e.length;l++)for(var c=e[l],u=0;u<s;u++){var h=c+=a;0===Static.m3FuzzyCompare(c,0,n)&&(h=0),u==o?i.push(h):r.push(h)}}},this.align=function(e,t){var n=e.minValue(),r=e.maxValue();if(-Number.MAX_VALUE+t<=n){var i=floorEps(n,t);0!==Static.m3FuzzyCompare(n,i,t)&&(n=i)}if(Number.MAX_VALUE-t>=r){i=ceilEps(r,t);0!==Static.m3FuzzyCompare(r,i,t)&&(r=i)}return new Interval(n,r)}}toString(){return"[LinearScaleEngine]"}}class LogScaleEngine extends ScaleEngine{constructor(e){super(e),this.setTransformation(new LogTransform),this.autoScale=function(e,t,n){var r=this.base(),i=new Interval(t.x1/Math.pow(r,this.lowerMargin()),t.x2*Math.pow(r,this.upperMargin()));if(i.maxValue()/i.minValue()<r){var a=new LinearScaleEngine;a.setReference(this.reference()),a.setMargins(this.lowerMargin(),this.upperMargin()),a.autoScale(e,t,n);var s=new Interval(t.x1,t.x2);if(s.normalized(),(s=s.limited(1e-100,1e100)).maxValue()/s.minValue()<r)return void(n=n<0?-Static.mLog(r,Math.abs(n)):Static.mLog(r,n))}this.reference()>5e-101&&Math.min(this.reference(),5e99),0==(i=i.limited(1e-100,1e100)).width()&&(i=this.buildInterval(i.minValue())),(n=Static.divideInterval(Static.mLogInterval(r,i).width(),Math.max(e,1)))<1&&(n=1),t.x1=i.minValue(),t.x2=i.maxValue()},this.divideScale=function(e,t,n,r,i){var a=new Interval(e,t);if(a.normalized(),(a=a.limited(1e-100,1e100)).width()<=0)return new ScaleDiv;var s=this.base();if(a.maxValue()/a.minValue()<s){var o=new LinearScaleEngine;return o.setReference(this.reference()),o.setMargins(this.lowerMargin(),this.upperMargin()),0!=i&&(i=i<0?-Math.pow(s,-i):Math.pow(s,i)),o.divideScale(e,t,n,r,i)}0==(i=Math.abs(i))&&(n<1&&(n=1),(i=Static.divideInterval(Static.mLogInterval(s,a).width(),n,this.base()))<1&&(i=1));var l=new ScaleDiv;if(0!=i){var c=[];this.buildTicks(a,i,r,c),l=new ScaleDiv(a,c)}return e>t&&l.invert(),l},this.buildTicks=function(e,t,n,r){var i=this.align(e,t);if(r[MajorTick]=this.buildMajorTicks(i,t),n>0){var a=[],s=[];this.buildMinorTicks(r[MajorTick],n,t,a,s),r[MinorTick]=a,r[MediumTick]=s}for(var o=0;o<NTickTypes;o++){var l=this.strip(r[o],e);r[o]=[],r[o]=l;for(var c=0;c<r[o].length;c++)0===Static.m3FuzzyCompare(r[o][c],0,t)&&(r[o][c]=0)}},this.buildMajorTicks=function(e,t){var n=Static.mLogInterval(this.base(),e).width(),r=Math.round(n/t)+1;r>1e4&&(r=1e4);var i=Math.log(e.minValue()),a=(Math.log(e.maxValue())-i)/(r-1),s=[];s.push(e.minValue());for(var o=1;o<r-1;o++)s.push(Math.exp(i+o*a));return s.push(e.maxValue()),s},this.buildMinorTicks=function(e,t,n,r,i){var a=this.base();if(n<1.1){if(0==(h=this.divideInterval(n,t+1)))return;var s=Math.round(n/h),o=-1;for(s>2&&s%2==0&&(o=s/2),p=0;p<e.length-1;p++){var l=e[p],c=a/s;if(c>=1)for(m=2;m<s;m++)r.push(l*m*c);else for(m=1;m<s;m++){var u=l+m*l*(a-1)/s;m==o?i.push(u):r.push(u)}}}else{var h;if(0==(h=this.divideInterval(n,t)))return;h<1&&(h=1);var d=Math.round(n/h)-1;if(Static.m3FuzzyCompare((d+1)*h,n,n)>0&&(d=0),d<1)return;o=-1;d>2&&d%2&&(o=d/2);for(var f=Math.max(Math.pow(a,h),a),p=0;p<e.length;p++){u=e[p];for(var m=0;m<d;m++)u*=f,m==o?i.push(u):r.push(u)}}},this.align=function(e,t){var n=Static.mLogInterval(this.base(),e),r=floorEps(n.minValue(),t);0==Static.m3FuzzyCompare(e.minValue(),r,t)&&(r=e.minValue());var i=ceilEps(n.maxValue(),t);return 0==Static.m3FuzzyCompare(e.maxValue(),i,t)&&(i=e.maxValue()),Static.mPowInterval(this.base(),new Interval(r,i))}}toString(){return"[LogScaleEngine]"}}function PointMapper(){var e=0,t=new Misc.Rect;this.setBoundingRect=function(e){t=e},this.boundingRect=function(){return t},this.setFlag=function(t,n){n?e|=t:e&=~t},this.testFlag=function(t){return e&t},this.toPolygonF=function(t,n,r,i,a){return e&WeedOutPoints?e&RoundPoints?mToPolylineFiltered(t,n,r,i,a,!0):mToPolylineFiltered(t,n,r,i,a,!1):e&RoundPoints?Static.mToPoints(new Misc.Rect(0,0,-1,-1),t,n,r,i,a,!0):Static.mToPoints(new Misc.Rect(0,0,-1,-1),t,n,r,i,a,!1)},this.toPointsF=function(n,r,i,a,s){return e&WeedOutPoints?e&RoundPoints?t.left()<=t.right()&&t.top()<=t.bottom()?Static.mToPointsFiltered(t,n,r,i,a,s):mToPolylineFiltered(n,r,i,a,s,!0):Static.mToPolylineFiltered(n,r,i,a,s,!1):e&RoundPoints?Static.mToPoints(t,n,r,i,a,s,!0):Static.mToPoints(t,n,r,i,a,s,!1)}}define("scaleEngine",["static"],function(){}),Static.mToPolylineFiltered=function(e,t,n,r,i,a){var s=[],o=n.sample(r);s[0]=new Misc.Point(Math.round(e.transform(o.x)),Math.round(t.transform(o.y)));for(var l=0,c=r+1;c<=i;c++){var u,h=n.sample(c);u=a?new Misc.Point(Math.round(e.transform(h.x)),Math.round(t.transform(h.y))):new Misc.Point(e.transform(h.x),t.transform(h.y)),s[l].x===u.x&&s[l].y===u.y||(s[++l]=u)}return s},Static.mToPoints=function(e,t,n,r,i,a,s){var o=[];if(e.left()<=e.right()&&e.top()<=e.bottom())for(h=i;h<=a;h++){var l=r.sample(h),c=t.transform(l.x),u=n.transform(l.y);c>=e.left()&&c<=e.right()&&u>=e.top()&&u<=e.bottom()&&(s?o.push(new Misc.Point(Math.round(c),Math.round(u))):o.push(new Misc.Point(c,u)),0)}else for(var h=i;h<=a;h++){l=r.sample(h),c=t.transform(l.x)-1,u=n.transform(l.y)-1;s?o.push(new Misc.Point(Math.round(c),Math.round(u))):o.push(new Misc.Point(c,u)),0}return o},PointMapper.prototype.toString=function(){return"[PointMapper]"},define("pointMapper",["static"],function(){});class AxisData{constructor(){this.axisName="",this.isEnabled=!1,this.doAutoScale=!0,this.minValue,this.maxValue,this.stepSize,this.maxMajor,this.maxMinor,this.isValid=!0,this.scaleDiv=null,this.scaleEngine=null,this.scaleWidget=null,this.scaleDomDiv=null,this.canvas=null}toString(){return"[AxisData]"}}class Plot{constructor(e,t){var n;n=e||$("#plotDiv");var r=this,i=[],a=[],s=!1,o="",l="",c=!1,u="",h="",d=!1,f=null,p=new Misc.Font;this.zoomer=null,this.panner=null,this.isSidebarVisible=function(){return s},Static.bind("showSidebar",function(e,t){s=t}),this.setLegendFont=function(e){p=e},this.legendFont=function(){return p},this.autoRefresh=function(){d&&this.replot()},this.setAutoReplot=function(e){d=e},this.autoReplot=function(){return d},this.plotItemStore=function(){return i};var m=new Misc.Font(12),v=new Misc.Font(12),g=new Layout(n,this);this.getLayout=function(){return g},this.axisInterval=function(e){return this.axisValid(e)?a[e].scaleDiv.interval():new Interval},this.setAxisDecimalPlaces=function(e,t){this.axisValid(e)&&(this.axisScaleDraw(e).setDecimalPlaces(t),this.autoRefresh())},this.setNonExponentNotationLimits=function(e,t){for(var n=0;n<axisCnt;++n)this.axisScaleDraw(n).setNonExponentLimits(e,t);this.autoRefresh()},this.getNonExponentNotationLimits=function(){return this.axisScaleDraw(0).getNonExponentNotationLimits()},this.axisDecimalPlaces=function(e){return this.axisValid(e)?this.axisScaleDraw(e).decimalPlaces():3};var b=new Widget(g.getCentralDiv()),S=new Widget(g.getTitleDiv()),y=new Widget(g.getFooterDiv());b.setEnabled_1(!0),b.plot=this,this.getCentralWidget=function(){return b},this.getTitleWidget=function(){return S},this.getFooterWidget=function(){return y},this.initAxesData=function(){var e;for(e=0;e<axisCnt;e++)a[e]=new AxisData;for(a[yLeft].axisName="AxisYLeft",a[yRight].axisName="AxisYRight",a[xTop].axisName="AxisXTop",a[xBottom].axisName="AxisXBottom",a[yLeft].scaleWidget=new ScaleWidget(this,g.getScaleDivElement(yLeft),LeftScale),a[yRight].scaleWidget=new ScaleWidget(this,g.getScaleDivElement(yRight),RightScale),a[xTop].scaleWidget=new ScaleWidget(this,g.getScaleDivElement(xTop),TopScale),a[xBottom].scaleWidget=new ScaleWidget(this,g.getScaleDivElement(xBottom),BottomScale),e=0;e<axisCnt;e++){var t=a[e];t.scaleEngine=new LinearScaleEngine,t.scaleWidget.setTransformation(t.scaleEngine.transformation()),t.doAutoScale=!0,t.minValue=0,t.maxValue=1e3,t.stepSize=0,t.maxMinor=5,t.maxMajor=8,t.isValid=!1}a[yLeft].isEnabled=!0,a[yRight].isEnabled=!0,a[xBottom].isEnabled=!0,a[xTop].isEnabled=!0},this.axisMaxMinor=function(e){return this.axisValid(e)?a[e].maxMinor:0},this.axisMaxMajor=function(e){return this.axisValid(e)?a[e].maxMajor:0},this.setAxisMaxMinor=function(e,t){if(this.axisValid(e)){t=Static.qBound(0,t,100);var n=a[e];t!=n.maxMinor&&(n.maxMinor=t,n.isValid=!1,this.autoRefresh())}},this.setAxisMaxMajor=function(e,t){if(this.axisValid(e)){t=Static.qBound(1,t,1e4);var n=a[e];t!=n.maxMajor&&(n.maxMajor=t,n.isValid=!1,this.autoRefresh())}},this.axisValid=function(e){return e>=yLeft&&e<axisCnt},this.setAxisScaleEngine=function(e,t){if(this.axisValid(e)&&null!==t){var n=a[e];n.scaleEngine=t,a[e].scaleWidget.setTransformation(t.transformation()),n.isValid=!1,this.autoRefresh()}},this.legend=function(){return f},this.setLegend=function(e){f!==e&&(f=e).setPlot(this)},this.insertLegend=function(e){(f=e).setLegendDiv(g.getLegendDiv()),f.setPlot(this);for(var t=0;t<i.length;++t)this.insertLegendItem(i[t]);Static.trigger("legendInserted",f)},this.insertLegendItem=function(e,t){null!==f&&null!=e&&(e.testItemAttribute(Legend)&&f.addItem(e,t),f.isEmpty()||c&&f.legendDiv().show())},this.removeLegendItem=function(e){if(null!==f){var t=f.removeItem(e);return f.isEmpty()&&f.legendDiv().hide(),t}},this.updateLegend=function(e){if(null!=e&&e.testItemAttribute(Legend)){var t=this.removeLegendItem(e);this.insertLegendItem(e,t)}},this.axisScaleEngine=function(e){return this.axisValid(e)?a[e].scaleEngine:null},this.setAxisAutoScale=function(e,t){this.axisValid(e)&&a[e].doAutoScale!==t&&(a[e].doAutoScale=t,Static.trigger("autoScaleChanged",t),this.autoRefresh())},this.axisAutoScale=function(e){return!!this.axisValid(e)&&a[e].doAutoScale},this.setAxisScale=function(e,t,n,r){var i=0;if(void 0!==r&&(i=r),this.axisValid(e)){var s=a[e];s.doAutoScale=!1,s.isValid=!1,s.minValue=t,s.maxValue=n,s.stepSize=i,Static.trigger("rescaled"),this.autoRefresh()}},this.enableAxis=function(e,t){this.axisValid(e)&&t!==a[e].isEnabled&&(a[e].isEnabled=t,t?a[e].scaleWidget.show():a[e].scaleWidget.hide(),this.autoRefresh())},this.axisEnabled=function(e){return!!this.axisValid(e)&&a[e].isEnabled},this.setAxisTitle=function(e,t){this.axisValid(e)&&(a[e].scaleWidget.setTitle(t),this.autoRefresh())},this.axisTitle=function(e){return this.axisValid(e)?a[e].scaleWidget.title():""},this.axisScaleDiv=function(e){return a[e].scaleDiv},this.setAxisScaleDiv=function(e,t){if(this.axisValid(e)){var n=a[e];n.doAutoScale=!1,n.scaleDiv=t,n.isValid=!0,this.autoRefresh()}},this.axisScaleDraw=function(e){return this.axisValid(e)?this.axisWidget(e).scaleDraw():null},this.setAxisLabelFont=function(e,t){this.axisValid(e)&&(this.axisWidget(e).setLabelFont(t),this.autoRefresh())},this.axisLabelFont=function(e){return this.axisValid(e)?this.axisWidget(e).labelFont():null},this.setAxisTitleFont=function(e,t){this.axisValid(e)&&(this.axisWidget(e).setTitleFont(t),this.autoRefresh())},this.axisTitleFont=function(e){return this.axisValid(e)?this.axisWidget(e).titleFont():null},this.initAxesData(),this.isCursorSet=function(){return""!==u},this.cursor=function(e){return u},this.setCursor=function(e){e!=u&&(u=e,g.getCentralDiv().css("cursor",u))},this.setDefaultCursor=function(e){h!=e&&(h=e)},this.unsetCursor=function(){h!=u&&(u=h,g.getCentralDiv[0].style.cursor=u)},this.title=function(){return o},this.hideTitle=function(){""!=o&&(g.getTitleDiv().hide(),g.updateLayout(),this.autoRefresh())},this.showTitle=function(){""!=o&&(g.getTitleDiv().show(),g.updateLayout(),this.autoRefresh())},this.setTitle=function(e){o!==e&&(o=e,0==e.trim(" ").length&&(o=""),""!==o?(g.getTitleDiv().show(),Static.trigger("titleAdded",!0)):(g.getTitleDiv().hide(),Static.trigger("titleAdded",!1)),g.updateLayout(),this.autoRefresh())},this.setTitleFont=function(e){e.th<0||""===e.name||""===e.style||(m=e,g.adjustLayout(g.getTitleDiv(),2*e.th),this.autoRefresh())},this.setTitleFont(new Misc.Font(20,"Arial","normal","bold")),this.titleFont=function(){return m},this.footer=function(){return l},this.hideFooter=function(){""!=l&&(g.getFooterDiv().hide(),g.updateLayout(),this.autoRefresh())},this.showFooter=function(){""!=l&&(g.getFooterDiv().show(),g.updateLayout(),this.autoRefresh())},this.setFooter=function(e){l!==e&&(l=e,0==e.trim(" ").length&&(l=""),""!==l?(g.getFooterDiv().show(),Static.trigger("footerAdded",!0)):(g.getFooterDiv().hide(),Static.trigger("footerAdded",!1)),g.updateLayout(),this.autoRefresh())},this.setFooterFont=function(e){e.th<0||""===e.name||""===e.style||(v=e,g.adjustLayout(g.getFooterDiv(),2*e.th),this.autoRefresh())},this.setFooterFont(new Misc.Font(15,"Arial","normal","bold")),this.footerFont=function(){return v},this.enableLegend=function(e){c=e,f&&!f.isEmpty()&&(e?f.legendDiv().show():f.legendDiv().hide(),this.autoRefresh())},this.isLegendEnabled=function(e){return!!f&&!("none"==f.legendDiv()[0].style.display)},this.invTransform=function(e,t){return this.axisValid(e)?this.canvasMap(e).invTransform(t):0},this.transform=function(e,t){return this.axisValid(e)?this.canvasMap(e).transform(t):0};this.setPlotBackground=function(e){this.getCentralWidget().getElement().css("background-color",e)},this.setPlotBackground("rgb(255, 255, 200)"),this.plotBackground=function(e){return this.getCentralWidget().getElement().css("background-color")},this.setBorderRadius=function(e){this.getCentralWidget().getCanvas().css("border-radius",e)},this.borderRadius=function(e){return m_borderRadius},this.findPlotCurve=function(e){for(var t=this.itemList(Static.Rtti_PlotCurve),n=0;n<t.length;++n)if(t[n].title()===e)return t[n];t=this.itemList(Static.Rtti_PlotSpectroCurve);for(n=0;n<t.length;++n)if(t[n].title()===e)return t[n];t=this.itemList(Static.Rtti_PlotSpectrogram);for(n=0;n<t.length;++n)if(t[n].title()===e)return t[n];return null},this.findPlotMarker=function(e){for(var t=this.itemList(Static.Rtti_PlotMarker),n=0;n<t.length;++n)if(t[n].title()===e)return t[n];return null},this.hasVisiblePlotCurve=function(){for(var e=this.itemList(Static.Rtti_PlotCurve),t=0;t<e.length;++t)if(e[t].isVisible())return!0;return!1},this.hasVisiblePlotSpectroCurve=function(){for(var e=this.itemList(Static.Rtti_PlotSpectroCurve),t=0;t<e.length;++t)if(e[t].isVisible())return!0;return!1},this.hasVisiblePlotSpectrogram=function(){for(var e=this.itemList(Static.Rtti_PlotSpectrogram),t=0;t<e.length;++t)if(e[t].isVisible())return!0;return!1},this.hasPlotCurve=function(){return this.itemList(Static.Rtti_PlotCurve).length>0},this.hasPlotSpectroCurve=function(){return this.itemList(Static.Rtti_PlotSpectroCurve).length>0},this.hasPlotSpectrogram=function(){return this.itemList(Static.Rtti_PlotSpectrogram).length>0},this.drawBackGround=function(){var e=new PaintUtil.Painter(b);e.fillRect(new Misc.Rect(0,0,b.width(),b.height()),""),e=null},this.drawTitle=function(){if(""!==o){var e=new PaintUtil.Painter(S);e.setFont(m),e.drawText(o,S.width()/2,2.6*m.th/2,"center"),e=null}},this.drawFooter=function(){if(""!==l){var e=new PaintUtil.Painter(y);e.setFont(v),e.drawText(l,y.width()/2,2.6*v.th/2,"center"),e=null}},this.itemList=function(e){return void 0===e?i:_.filter(i,function(t){return t.rtti===e})},this.insertItem=function(e){i.push(e)},this.removeItem=function(e){var t=i.indexOf(e);t>-1&&i.splice(t,1)},this.canvasMap=function(e){var t=new ScaleMap;t.setTransformation(this.axisScaleEngine(e).transformation());var n=this.axisScaleDiv(e);t.setScaleInterval(n.lowerBound(),n.upperBound());var r=this.axisWidget(e);if(e==yLeft||e==yRight){var i=r.height();t.setPaintInterval(i,0)}else{var a=r.width();t.setPaintInterval(0,a)}return t},this.axisWidget=function(e){return this.axisValid(e)?a[e].scaleWidget:null},this.updateAxes=function(){for(var e=[new Interval(Number.MAX_VALUE,-Number.MAX_VALUE),new Interval(Number.MAX_VALUE,-Number.MAX_VALUE),new Interval(Number.MAX_VALUE,-Number.MAX_VALUE),new Interval(Number.MAX_VALUE,-Number.MAX_VALUE)],t=0;t<i.length;++t){var n=i[t];if(n.testItemAttribute(AutoScale)&&(n.isVisible()&&(this.axisAutoScale(n.xAxis())||this.axisAutoScale(n.yAxis())))){var s=n.boundingRect();s.width()>=0&&(s.left()<e[n.xAxis()].minValue()&&e[n.xAxis()].setMinValue(s.left()),s.right()>e[n.xAxis()].maxValue()&&e[n.xAxis()].setMaxValue(s.right())),s.height()>=0&&(s.top()<e[n.yAxis()].minValue()&&e[n.yAxis()].setMinValue(s.top()),s.bottom()>e[n.yAxis()].maxValue()&&e[n.yAxis()].setMaxValue(s.bottom()))}}for(var o=0;o<axisCnt;o++){var l=a[o],c=l.minValue,u=l.maxValue,h=l.stepSize;if(l.doAutoScale&&e[o].isValid()){l.isValid=!1;var d={x1:c=e[o].minValue(),x2:u=e[o].maxValue()};l.scaleEngine.autoScale(l.maxMajor,d,h),c=d.x1,u=d.x2}l.isValid||(l.scaleDiv=l.scaleEngine.divideScale(c,u,l.maxMajor,l.maxMinor,h),l.isValid=!0);var f=this.axisWidget(o);f.setScaleDiv(l.scaleDiv);var p={start:void 0,end:void 0};f.getBorderDistHint(p),f.setBorderDist(p.start,p.end)}i.forEach(function(e){e.testItemInterest(ScaleInterest)&&e.updateScaleDiv(r.axisScaleDiv(e.xAxis()),r.axisScaleDiv(e.yAxis()))})},this.attachItem=function(e,t){t?(this.insertItem(e),e.testItemAttribute(Legend)&&this.insertLegendItem(e)):(e.testItemAttribute(Legend)&&this.removeLegendItem(e),this.removeItem(e)),Static.trigger("itemAttached",[e,t]),t||(e=null),this.autoRefresh()},this.replot=function(){var e=this.autoReplot();this.setAutoReplot(!1),this.updateAxes();for(var t=0;t<axisCnt;t++){var n=a[t].scaleWidget;n.scaleDraw().data.plotBorderWidth=parseFloat(this.getLayout().getCentralDiv().css("border-width")),n.draw()}this.drawTitle(),this.drawFooter();for(var r=0;r<i.length;++r)i[r].isVisible()&&i[r].draw(this.axisScaleDraw(i[r].xAxis()).scaleMap(),this.axisScaleDraw(i[r].yAxis()).scaleMap());Static.trigger("replot"),this.setAutoReplot(e)},this.setAutoReplot(!0),g.getTitleDiv().hide(),void 0!==t&&this.setTitle(t),h=g.getCentralDiv().css("cursor"),this.setCursor("crosshair"),this.enableAxis(yRight,!1),this.enableAxis(xTop,!1),g.getFooterDiv().hide(),f?f.legendDiv().hide():g.getLegendDiv().hide(),Static.bind("resize",function(){r.replot()}),this.setAutoReplot(!1),this.toString=function(){return'[Plot "'+o+'"]'},Static.bind("beforePrint",function(){r.replot()})}}define("plot",["static","widget","scaleWidget","utility","miscObjects","painter","scaleDiv","interval","scaleMap","scaleWidget","transform","layout","scaleDraw","scaleEngine","pointMapper"],function(){});class SeriesData{constructor(){this.d_boundingRect=new Misc.Rect,Static.mBoundingRectPoint=function(e){return new Misc.Rect(e.x,e.y,0,0)},Static.mBoundingRect=function(e,t,n){var r,i=new Misc.Rect;if(void 0===t&&(t=0),void 0===n&&(n=e.size()-1),n<t)return i;for(r=t;r<=n;r++){if((a=Static.mBoundingRectPoint(e.sample(r))).width()>=0&&a.height()>=0){i=a,r++;break}}for(;r<=n;r++){var a;(a=Static.mBoundingRectPoint(e.sample(r))).width()>=0&&a.height()>=0&&i.setRect(Math.min(i.left(),a.left()),Math.min(i.top(),a.top()),Math.max(i.right(),a.right())-Math.min(i.left(),a.left()),Math.max(i.bottom(),a.bottom())-Math.min(i.top(),a.top()))}return i},this.setRectOfInterest=function(e){},this.toString=function(){return"[SeriesData]"}}}class ArraySeriesData extends SeriesData{constructor(e){super();var t=[];void 0!==e&&(t=e),this.setSamples=function(e){this.d_boundingRect=new Misc.Rect,t=e},this.samples=function(){return t},this.size=function(){return t.length},this.sample=function(e){return t[e]},this.toString=function(){return"[ArraySeriesData]"}}}class PointSeriesData extends ArraySeriesData{constructor(e){super(e),this.boundingRect=function(){return this.d_boundingRect.width()<0&&(this.d_boundingRect=Static.mBoundingRect(this)),this.d_boundingRect},this.toString=function(){return"[PointSeriesData]"}}}class Point3DSeriesData extends ArraySeriesData{constructor(e){super(e),this.boundingRect=function(){return this.d_boundingRect.width()<0&&(this.d_boundingRect=Static.mBoundingRect(this)),this.d_boundingRect},this.toString=function(){return"[Point3DSeriesData]"}}}class PlotSeriesItem extends PlotItem{constructor(e){super(e);var t=null,n=Vertical;this.setOrientation=function(e){n!=e&&(n=e,this.itemChanged())},this.orientation=function(){return n},this.draw=function(e,t){this.drawSeries(e,t,0,-1)},this.updateScaleDiv=function(e,t){var n=new Misc.Rect(new Misc.Point(e.lowerBound(),t.lowerBound()),e.range(),t.range());this.setRectOfInterest(n)},this.data=function(){return t},this.sample=function(e){return t?t.sample(e):null},this.setData=function(e){t!=e&&(t=e)},this.dataSize=function(){return null==t?0:t.size()},this.dataRect=function(){return null==t?new Misc.Rect:t.boundingRect()},this.setRectOfInterest=function(e){t&&t.setRectOfInterest(e)},this.swapData=function(e){var n=t;return t=e,n},this.toString=function(){return"[PlotSeriesItem]"}}boundingRect(){return this.dataRect()}}define("seriesData",["static","plotItem"],function(){});class SyntheticPointData extends SeriesData{constructor(e,t){super();var n,r=e,i=t||new Interval,a=new Interval(0,10);this.setSize=function(e){r=e},this.size=function(){return r},this.setInterval=function(e){i=e.normalized()},this.interval=function(){return i},this.setRectOfInterest=function(e){n=e,a=new Interval(e.left(),e.right()).normalized()},this.rectOfInterest=function(){return n},this.boundingRect=function(){return 0==r||!i.isValid()&&!a.isValid()?new Misc.Rect(1,1,-2,-2):Static.mBoundingRect(this)},this.y=function(e){throw'subclass must implement "this.y"'},this.sample=function(e){if(e>=r)return new Misc.Point(0,0);var t=this.x(e),n=this.y(t);return new Misc.Point(t,n)},this.x=function(e){var t=i.isValid()?i:a;if(!t.isValid()||0==r||e>=r)return 0;var n=t.width()/r;return t.minValue()+e*n},this.toString=function(){return"[SyntheticPointData]"}}}define("pointData",["static","seriesData"],function(){});class FunctionData extends SyntheticPointData{constructor(e,t){super(t);var n=e,r=new EvaluateExp(n);this.setFn=function(e){n=e,r.setExpString(n)},this.y=function(e){return r.error?0:r.eval({x:e})}}}define("functionData",["pointData"],function(){});class PlotGrid extends PlotItem{constructor(e){super(e),this.setItemAttribute(AutoScale,!0);var t=!0,n=!0,r=!1,i=!1,a=null,s=null,o="grey",l="lightGrey";this.rtti=Static.Rtti_PlotGrid,this.setMajorPen=function(e){o!==e&&(o=e,this.itemChanged())},this.majorPen=function(){return o},this.setMinorPen=function(e){l!==e&&(l=e,this.itemChanged())},this.minorPen=function(){return l},this.enableX=function(e){t!=e&&(t=e,this.itemChanged(),Static.trigger("itemChanged",[this,e]))},this.xEnabled=function(){return t},this.enableY=function(e){n!=e&&(n=e,this.itemChanged(),Static.trigger("itemChanged",[this,e]))},this.yEnabled=function(){return n},this.enableXMin=function(e){r!=e&&(r=e,this.itemChanged())},this.xMinEnabled=function(){return r},this.enableYMin=function(e){i!=e&&(i=e,this.itemChanged())},this.yMinEnabled=function(){return i},this.setXDiv=function(e){a!==e&&(a=e)},this.xDiv=function(){return a},this.setYDiv=function(e){s!==e&&(s=e)},this.yDiv=function(){return s},this.draw=function(e,a){var s=this.plot(),c=s.axisScaleDiv(this.xAxis()),u=s.axisScaleDiv(this.yAxis()),h=this.getContext();h.strokeStyle=l,t&&r&&(this.drawLines(h,"vertical",e,c.ticks(MinorTick)),this.drawLines(h,"vertical",e,c.ticks(MediumTick))),n&&i&&(this.drawLines(h,"horizontal",a,u.ticks(MinorTick)),this.drawLines(h,"horizontal",a,u.ticks(MediumTick))),h.strokeStyle=o,t&&this.drawLines(h,"vertical",e,c.ticks(MajorTick)),n&&this.drawLines(h,"horizontal",a,u.ticks(MajorTick))},this.drawLines=function(e,t,n,r){for(var i=e.canvas.width-1,a=e.canvas.height-1,s=new PaintUtil.Painter(e),o=s.pen().width,l=0;l<r.length;l++){var c=n.transform(r[l]);"horizontal"===t?s.drawLine(0,c-o,i,c-o):s.drawLine(c-o,0,c-o,a)}s=null},this.updateScaleDiv=function(e,t){this.setXDiv(e),this.setYDiv(t)},this.toString=function(){return"[PlotGrid]"}}}define("plotGrid",["static","plotItem"],function(){});var Conrec=function(){var e=function(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r<1e-20},t=function(e){for(var t=e.head;t;){var n=t.next;t.next=t.prev,t.prev=n,t=n}n=e.head;e.head=e.tail,e.tail=n},n=function(e){this.level=e,this.s=null,this.count=0};n.prototype.remove_seq=function(e){e.prev?e.prev.next=e.next:this.s=e.next,e.next&&(e.next.prev=e.prev),--this.count},n.prototype.addSegment=function(n,r){for(var i=this.s,a=null,s=null,o=!1,l=!1;i&&(null==a&&(e(n,i.head.p)?(a=i,o=!0):e(n,i.tail.p)&&(a=i)),null==s&&(e(r,i.head.p)?(s=i,l=!0):e(r,i.tail.p)&&(s=i)),null==s||null==a);)i=i.next;switch((null!=a?1:0)|(null!=s?2:0)){case 0:var c={p:n,prev:null},u={p:r,next:null};c.next=u,u.prev=c,a={head:c,tail:u,next:this.s,prev:null,closed:!1},this.s&&(this.s.prev=a),this.s=a,++this.count;break;case 1:var h={p:r};o?(h.next=a.head,h.prev=null,a.head.prev=h,a.head=h):(h.next=null,h.prev=a.tail,a.tail.next=h,a.tail=h);break;case 2:h={p:n};l?(h.next=s.head,h.prev=null,s.head.prev=h,s.head=h):(h.next=null,h.prev=s.tail,s.tail.next=h,s.tail=h);break;case 3:if(a===s){h={p:a.tail.p,next:a.head,prev:null};a.head.prev=h,a.head=h,a.closed=!0;break}switch((o?1:0)|(l?2:0)){case 0:t(a);case 1:s.tail.next=a.head,a.head.prev=s.tail,s.tail=a.tail,this.remove_seq(a);break;case 3:t(a);case 2:a.tail.next=s.head,s.head.prev=a.tail,a.tail=s.tail,this.remove_seq(s)}}};var r=function(e){if(e)this.drawContour=e;else{var t=this;t.contours={},this.drawContour=function(e,r,i,a,s,o){var l=t.contours[o];l||(l=t.contours[o]=new n(s)),l.addSegment({x:e,y:r},{x:i,y:a})},this.contourList=function(){var e=[],n=t.contours;for(var r in n)for(var i=n[r].s,a=n[r].level;i;){var s=i.head,o=[];for(o.level=a,o.k=r;s&&s.p;)o.push(s.p),s=s.next;e.push(o),i=i.next}return e.sort(function(e,t){return t.k-e.k}),e}}this.h=new Array(5),this.sh=new Array(5),this.xh=new Array(5),this.yh=new Array(5)};return r.prototype.contour=function(e,t,n,r,i,a,s,o,l){var c=this.h,u=this.sh,h=this.xh,d=this.yh,f=this.drawContour;this.contours={};for(var p,m,v,g,b,S,y=function(e,t){return(c[t]*h[e]-c[e]*h[t])/(c[t]-c[e])},x=function(e,t){return(c[t]*d[e]-c[e]*d[t])/(c[t]-c[e])},w=0,_=0,C=0,E=0,k=[0,1,1,0],R=[0,0,1,1],T=[[[0,0,8],[0,2,5],[7,6,9]],[[0,3,4],[1,3,1],[4,3,0]],[[9,6,7],[5,2,0],[8,0,0]]],A=i-1;A>=r;A--)for(var P=t;P<=n-1;P++){var B,M;if(B=Math.min(e[P][A],e[P][A+1]),M=Math.min(e[P+1][A],e[P+1][A+1]),b=Math.min(B,M),B=Math.max(e[P][A],e[P][A+1]),M=Math.max(e[P+1][A],e[P+1][A+1]),(S=Math.max(B,M))>=l[0]&&b<=l[o-1])for(var I=0;I<o;I++)if(l[I]>=b&&l[I]<=S){for(var D=4;D>=0;D--)D>0?(c[D]=e[P+k[D-1]][A+R[D-1]]-l[I],h[D]=a[P+k[D-1]],d[D]=s[A+R[D-1]]):(c[0]=.25*(c[1]+c[2]+c[3]+c[4]),h[0]=.5*(a[P]+a[P+1]),d[0]=.5*(s[A]+s[A+1])),c[D]>0?u[D]=1:c[D]<0?u[D]=-1:u[D]=0;for(D=1;D<=4;D++)if(p=D,m=0,v=4!=D?D+1:1,0!=(g=T[u[p]+1][u[m]+1][u[v]+1])){switch(g){case 1:w=h[p],C=d[p],_=h[m],E=d[m];break;case 2:w=h[m],C=d[m],_=h[v],E=d[v];break;case 3:w=h[v],C=d[v],_=h[p],E=d[p];break;case 4:w=h[p],C=d[p],_=y(m,v),E=x(m,v);break;case 5:w=h[m],C=d[m],_=y(v,p),E=x(v,p);break;case 6:w=h[v],C=d[v],_=y(p,m),E=x(p,m);break;case 7:w=y(p,m),C=x(p,m),_=y(m,v),E=x(m,v);break;case 8:w=y(m,v),C=x(m,v),_=y(v,p),E=x(v,p);break;case 9:w=y(v,p),C=x(v,p),_=y(p,m),E=x(p,m)}f(w,C,_,E,l[I],I)}}}},r}();"undefined"!=typeof exports&&(exports.Conrec=Conrec),define("conrec",function(){});class PlotRasterItem extends PlotItem{static useCache(e,t){var n=!1;return e==Enum.CachePolicy.PaintCache&&(n=!0),n}static qwtToRgba(e,t){var n=e.copy();return n.setAlpha(t),n}constructor(e){super(e),Enum.CachePolicy={NoCache:0,PaintCache:1},Enum.PaintAttribute={PaintInDeviceResolution:1};var t=null,n=new Misc.Size(1,1);this.init=function(){t=new class{constructor(){this.cache={policy:null,area:null,size:null,image:null},this.alpha=-1,this.paintAttributes=Enum.PaintAttribute.PaintInDeviceResolution,this.cache.policy=Enum.CachePolicy.NoCache}},this.setItemAttribute(AutoScale,!0),this.setItemAttribute(Legend,!1),this.setZ(8)},this.setPaintAttribute=function(e,n){n?t.paintAttributes|=e:t.paintAttributes&=~e},this.testPaintAttribute=function(e){return t.paintAttributes&e},this.setAlpha=function(e){e<0&&(e=-1),e>255&&(e=255),e!=t.alpha&&(t.alpha=e,this.itemChanged())},this.alpha=function(){return t.alpha},this.setCachePolicy=function(e){t.cache.policy!=e&&(t.cache.policy=e,this.invalidateCache(),this.itemChanged())},this.cachePolicy=function(){return t.cache.policy},this.invalidateCache=function(){t.cache.image=new Misc.Image,t.cache.area=new Misc.Rect,t.cache.size=new Misc.Size},this.interval=function(e){return new Interval},this.pixelSize=function(){return n},this.setPixelSize=function(e){n=e},this.compose=function(e,n,r,i,a,s){var o=new Misc.Image;if(r.isEmpty()||i.isEmpty()||a.isEmpty())return o;if(s&&!t.cache.image.isNull()&&t.cache.area.isEqual(r)&&t.cache.size.isEqual(i.size())&&(o=t.cache.image),o.isNull()){var l=this.imageMap(Horizontal,e,r,a),c=this.imageMap(Vertical,n,r,a);o=this.renderImage(l,c,r,a),s&&(t.cache.area=r.copy(),t.cache.size=i.size().copy(),t.cache.image=o.copy())}return t.alpha>=0&&t.alpha<255&&(o=PlotRasterItem.qwtToRgba(o,t.alpha)),o},this.imageMap=function(e,t,n,r){var i,a,s,o;if(e==Horizontal?(i=0,a=r.width,s=n.left(),o=n.right()):(i=0,a=r.height,s=n.top(),o=n.bottom()),t.isInverting()&&s<o){var l=s;s=o,o=l}var c=t.copy();return c.setPaintInterval(i,a),c.setScaleInterval(s,o),c},this.dataRasterItemPrivateData=function(){return t},this.init()}boundingRect(){var e=this.interval(XAxis),t=this.interval(YAxis);if(!e.isValid()&&!t.isValid())return new Misc.Rect;var n=new Misc.Rect;return e.isValid()?(n.setLeft(e.minValue()),n.setRight(e.maxValue())):(n.setLeft(-.5*Number.MAX_VALUE),n.setWidth(Number.MAX_VALUE)),t.isValid()?(n.setTop(t.minValue()),n.setBottom(t.maxValue())):(n.setTop(-.5*Number.MAX_VALUE),n.setHeight(Number.MAX_VALUE)),n.normalized()}draw(e,t,n,r){var i=this.dataRasterItemPrivateData();if(!r.isEmpty()&&0!=i.alpha){var a=PlotRasterItem.useCache(i.cache.policy,e),s=ScaleMap.invTransform_Rect(t,n,r),o=new Misc.Size(r.width(),r.height()),l=this.compose(t,n,s,r,o,a);l.isNull()||(e.save(),e.drawImage(l,r),e.restore())}}}define("plotRasterItem",["static","plotItem"],function(){});class PlotSpectrogram extends PlotRasterItem{constructor(e){super(e),Enum.DisplayMode={ImageMode:1,ContourMode:2};var t=this,n=new class{constructor(){this.data=null,this.colorMap=new LinearColorMap,this.displayMode=Enum.DisplayMode.ImageMode,this.contourLevels=[],this.defaultContourPen=new Misc.Pen,this.numberOfContourPlanes=10}};this.privateData=function(){return n},this.setItemAttribute(AutoScale,!0),this.setItemAttribute(Legend,!1),this.setZ(8),this.rtti=Static.Rtti_PlotSpectrogram,this.setDisplayMode=function(e,t){t!=(e&n.displayMode)&&(t?n.displayMode|=e:n.displayMode&=~e,this.legendChanged(),this.itemChanged())},this.testDisplayMode=function(e){return n.displayMode&e},this.setColorMap=function(e){n.colorMap!=e&&(n.colorMap=e),this.invalidateCache(),this.legendChanged(),this.itemChanged()},this.colorMap=function(){return n.colorMap},this.setDefaultContourPen=function(e,t,n){var r=e;"object"!=typeof r&&(r=new Misc.Pen(e,t,n)),this.doSetDefaultContourPen(r)},this.doSetDefaultContourPen=function(e){e.isEqual(n.defaultContourPen)||(n.defaultContourPen=e,this.legendChanged(),this.itemChanged())},this.defaultContourPen=function(){return n.defaultContourPen},this.contourPen=function(e){if(null==n.data||null==n.colorMap)return new Misc.Pen;var t=n.data.interval(ZAxis),r=n.colorMap.rgb(t,e);return new Misc.Pen(r.toString())},this.calculateContourLevels=function(e,t,r){if(e<1)return[];var i=n.data.interval(ZAxis);void 0==t&&(t=i.minValue(),r=i.maxValue());for(var a=(r-t)/e,s=[],o=t+.5*a;o<r;o+=a)s.push(o);return s},this.setContourLevels=function(e){n.contourLevels=e,_.sortBy(n.contourLevels),this.legendChanged(),this.itemChanged()},this.contourLevels=function(){return n.contourLevels},this.setData=function(e){e!=n.data&&(n.data=e,this.invalidateCache(),this.itemChanged())},this.data=function(){return n.data},this.interval=function(e){return null==n.data?new Interval:n.data.interval(e)},this.renderImage=function(e,t,r,i){if(i.isEmpty()||null==n.data||null==n.colorMap)return new Misc.Image;var a=n.data.interval(ZAxis);if(!a.isValid())return new Misc.Image;var s=new Misc.Image(i);n.colorMap.format()==Enum.Format.Indexed&&s.setColorTable(n.colorMap.colorTable(a)),n.data.initRaster(r,s.size());var o=new Misc.Rect(0,0,i.width,i.height);return this.renderTile(e,t,o,s),n.data.discardRaster(),s},this.renderTile=function(e,t,r,i){var a=n.data.interval(ZAxis);if(a.isValid()){var s,o,l=this.pixelSize().width-1,c=this.pixelSize().height-1,u=l+1,h=c+1,d=r.top()+c,f=r.bottom(),p=r.left()+l,m=r.right();if(n.colorMap.format()==Enum.Format.RGB)for(s=d;s<f;s+=h){var v=t.invTransform(s);for(o=p;o<m;o+=u)for(var g=e.invTransform(o),b=n.colorMap.rgb(a,n.data.value(g,v)),S=c;S>=0;--S)for(var y=l;y>=0;--y)i.setPixel(o+y-l,s+S-c,b)}else if(n.colorMap.format()==Enum.Format.Indexed)for(s=d;s<f;s+=h){v=t.invTransform(s);for(o=p;o<m;o+=u)for(g=e.invTransform(o),b=i.pixel(n.colorMap.colorIndex(a,n.data.value(g,v))),S=c;S>=0;--S)for(y=l;y>=0;--y)i.setPixel(o+y-l,s+S-c,b)}}},this.renderContourLines=function(e,r,i,a){if(null!=n.data){var s=n.contourLevels,o=n.data.contourLinesData(s,80,80);new Conrec(function(n,a,s,o,l,c){var u=t.defaultContourPen();u.style==Static.NoPen&&(u=t.contourPen(l)),u.style!=Static.NoPen&&(e.setPen(u),e.drawLine(r.transform(n),i.transform(a),r.transform(s),i.transform(o)))}).contour(o.d,0,o.x.length-1,0,o.y.length-1,o.x,o.y,s.length,s)}}}draw(e,t){var n=this.privateData(),r=this.getCanvasRect(),i=new PaintUtil.Painter(this);if(n.displayMode&Enum.DisplayMode.ImageMode&&super.draw(i,e,t,r),n.displayMode&Enum.DisplayMode.ContourMode){var a=ScaleMap.invTransform_Rect(e,t,r),s=this.boundingRect();if(s.isValid()&&(a.united(s),a.isEmpty()))return;this.renderContourLines(i,e,t,r)}}}define("plotSpectrogram",["static","conrec","plotRasterItem"],function(){});class ColorStop{constructor(e,t){this.pos,this.m_rgb,void 0==e?(this.pos=0,this.m_rgb=0):(this.pos=e,this.m_rgb=t,-1!==t.indexOf("#")&&(this.m_rgb=Static.HTMLToRGB(t)),this.r=this.m_rgb.r,this.g=this.m_rgb.g,this.b=this.m_rgb.b,this.a=this.m_rgb.a,void 0===this.a&&(this.a=255),this.r0=this.r+.5,this.g0=this.g+.5,this.b0=this.b+.5,this.a0=this.a+.5,this.rStep=0,this.gStep=0,this.bStep=0,this.aStep=0,this.posStep=0),this.updateSteps=function(e){this.rStep=e.r-this.r,this.gStep=e.g-this.g,this.bStep=e.b-this.b,this.aStep=e.a-this.a,this.posStep=e.pos-this.pos}}}class ColorStops{constructor(){var e=!1,t=[];this.findUpper=function(e){for(var n=0,r=t.length;r>0;){var i=r>>1,a=n+i;t[a].pos<=e?(n=a+1,r-=i+1):r=i}return n},this.insert=function(n,r){if("#"!==r[0]&&(r=Static.colorNameToHex(r)),!(n<0||n>1)){var i;if(0==t.length)i=0,t.resize(1);else if((i=this.findUpper(n))==t.length||Math.abs(t[i].pos-n)>=.001){t.resize(t.length+1);for(var a=t.length-1;a>i;a--)t[a]=t[a-1]}t[i]=new ColorStop(n,r),255!=r.alpha&&(e=!0),i>0&&t[i-1].updateSteps(t[i]),i<t.length-1&&t[i].updateSteps(t[i+1])}},this.rgb=function(n,r){if(r<=0)return t[0].m_rgb;if(r>=1)return t[t.length-1].m_rgb;var i=this.findUpper(r);if(n==Enum.Mode.FixedColors)return t[i-1].m_rgb;var a=t[i-1],s=(r-a.pos)/a.posStep,o=Math.round(a.r0+s*a.rStep),l=Math.round(a.g0+s*a.gStep),c=Math.round(a.b0+s*a.bStep);if(e){if(a.aStep){var u=a.a0+s*a.aStep;return Static.mRgba(o,l,c,u)}return Static.mRgba(o,l,c,a.a)}return Static.mRgb(o,l,c)},this.stops=function(){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n].pos;return e}}}class ColorMap{constructor(e){var t=e;this.format=function(){return t},this.colorTable=function(e){var t=new Array(256);if(e.isValid())for(var n=e.width()/(t.length-1),r=0;r<t.length;r++)t[r]=this.rgb(e,e.minValue()+n*r);return t},this.rgb=function(e,t){return{r:0,g:0,b:0,a:0}}}}class LinearColorMap extends ColorMap{constructor(e,t,n){var r,i=void 0==n;i&&(n=e),super(n),this.m_mode=Enum.Mode.ScaledColors,this.setColorInterval=function(e,t){(r=new ColorStops).insert(0,e),r.insert(1,t)},i?this.setColorInterval("#0000FF","#FFFF00"):this.setColorInterval(e,t),this.setMode=function(e){this.m_mode=e},this.mode=function(){return this.m_mode},this.addColorStop=function(e,t){e>=0&&e<=1&&r.insert(e,t)},this.colorStops=function(){return r.stops()},this.color1=function(){return r.rgb(this.m_mode,0)},this.color2=function(){return r.rgb(this.m_mode,1)},this.rgb=function(e,t){if(isNaN(t))return 0;var n=e.width();if(n<=0)return 0;var i=(t-e.minValue())/n;return r.rgb(this.m_mode,i)},this.colorIndex=function(e,t){var n=e.width();if(isNaN(t)||n<=0||t<=e.minValue())return 0;if(t>=e.maxValue())return 255;var r=(t-e.minValue())/n;return this.m_mode==Enum.Mode.FixedColors?255*r:255*r+.5}}}define("colorMap",["static"],function(){});class RasterData{constructor(){var e=[null,null,null];this.setInterval=function(t,n){e[t]=n},this.interval=function(t){return e[t]},this.initRaster=function(e,t){},this.discardRaster=function(){},this.contourLinesData=function(e,t,n){for(var r=t||100,i=n||100,a=this.interval(XAxis),s=this.interval(YAxis),o=a.width()/(r-1),l=s.width()/(i-1),c=[],u=a.minValue(),h=[],d=s.minValue(),f=0;f<r;f++)c.push(u+f*o);for(f=0;f<i;f++)h.push(d+f*l);c[r-1]=a.maxValue(),h[i-1]=s.maxValue();for(var p=[],m=0;m<c.length;m++){for(var v=[],g=0;g<h.length;g++)v.push(this.value(c[m],h[g]));p.push(v)}return{d:p,x:c,y:h}}}value(e,t){}}define("rasterData",function(){});class RasterFileData extends RasterData{constructor(e){Enum.InterpolationType={cubic:0,linear:1},super(),this._interpolationType=Enum.InterpolationType.linear;var t,n=e.array;this.samples3D=[];var r,i=0,a=n.length;for(r=0;r<a;r++)if(0!=r){if(t!==n[r].x)break;i++}else t=n[r].x,i++;this.samples3D=_.chunk(n,i),this.minX=this.samples3D[0][0].x,this.maxX=this.samples3D[this.samples3D.length-1][0].x;var s=this.samples3D[0];this.minY=s[0].y,this.maxY=s[s.length-1].y,this.setInterval(XAxis,new Interval(this.minX,this.maxX)),this.setInterval(YAxis,new Interval(this.minY,this.maxY)),this.setInterval(ZAxis,new Interval(e.minZ,e.maxZ))}interpolaionType(){return this._interpolationType}setInterpolaionType(e){e<Enum.InterpolationType.cubic||e>Enum.InterpolationType.linear||(this._interpolationType=e)}value(e,t){return e>this.maxX&&(e=this.maxX),e<this.minX&&(e=this.minX),t>this.maxY&&(t=this.maxY),t<this.minY&&(t=this.minY),this.interpolaionType()==Enum.InterpolationType.cubic?Utility.bicubicInterpolate(this.samples3D,e,t):this.interpolaionType()==Enum.InterpolationType.linear?Utility.bilinearInterpolate(this.samples3D,e,t):void 0}}define("rasterFileData",["rasterData"],function(){});class RasterFunctionData extends RasterData{constructor(e){super();var t=e.fx,n=new EvaluateExp(t=(t=t.replace(e.variable,"_x")).replace(e.variableY,"_y"));if(n.error)return Static.alert(n.errorMessage),null;this.minX=e.minX,this.maxX=e.maxX,this.minY=e.minY,this.maxY=e.maxY,this.setInterval(XAxis,new Interval(this.minX,this.maxX)),this.setInterval(YAxis,new Interval(this.minY,this.maxY)),this.setInterval(ZAxis,new Interval(e.minZ,e.maxZ)),this.getValue=function(e,t){return n.eval({_x:e,_y:t})}}value(e,t){return e>=this.maxX&&(e=this.maxX),e<this.minX&&(e=this.minX),t>=this.maxY&&(t=this.maxY),t<this.minY&&(t=this.minY),this.getValue(e,t)}}define("rasterFunctionData",["rasterData"],function(){});class LinearColorMapRGB extends LinearColorMap{constructor(){super(Enum.Format.RGB),this.setColorInterval("darkCyan","red"),this.addColorStop(.1,"cyan"),this.addColorStop(.6,"green"),this.addColorStop(.95,"yellow")}}class LinearColorMapIndexed extends LinearColorMap{constructor(){super(Enum.Format.Indexed),this.setColorInterval("darkCyan","red"),this.addColorStop(.1,"cyan"),this.addColorStop(.6,"green"),this.addColorStop(.95,"yellow")}}class Spectrogram extends PlotSpectrogram{constructor(e){super(e);Enum.ColorMap={RGBMap:0,IndexMap:1,HueMap:2,AlphaMap:3};var t,n=255;this.setColorMap(new LinearColorMapRGB),this.setAlpha(n),this.setCachePolicy(Enum.CachePolicy.PaintCache);for(var r=[],i=.5;i<10;i+=1)r.push(i);this.setContourLevels(r),this.setItemAttribute(Legend,!0),this.showContour=function(e){this.setDisplayMode(Enum.DisplayMode.ContourMode,e),this.plot().replot()},this.showSpectrogram=function(e){this.setDisplayMode(Enum.DisplayMode.ImageMode,e),this.setDefaultContourPen(e?new Misc.Pen("black",0):new Misc.Pen(Static.NoPen))},this.setSpectrogramColorMap=function(e){var r=this.plot();r.axisWidget(yRight),this.data().interval(ZAxis);t=e;var i=n;switch(e){case Enum.ColorMap.HueMap:case Enum.ColorMap.AlphaMap:case Enum.ColorMap.IndexMap:this.setColorMap(new LinearColorMapIndexed);break;case Enum.ColorMap.RGBMap:default:this.setColorMap(new LinearColorMapRGB)}this.setSpectrogramAlpha(i),r.replot()},this.setSpectrogramAlpha=function(e){var r=this.plot();n=e,t!=Enum.ColorMap.AlphaMap&&(this.setAlpha(e),r.replot())}}}class SpectrogramFileData extends RasterFileData{constructor(e){super(e),this.setInterval(ZAxis,new Interval(0,10))}}class SpectrogramFunctionData extends RasterFunctionData{constructor(e){super(e)}}define("spectrogram",["static","plotSpectrogram","colorMap","rasterFileData","rasterFunctionData"],function(){});class MyPlot extends Plot{constructor(e,t){super(e,t);var n=this,r=!0;function i(e,t,r,i){if(!t||0==t.length)return!1;if(n.findPlotCurve(e))return Static.alert(e+" already exist"),!1;var a=new MyCurve(e);a.expandedFn=i,r||n.addCurveInit(a),a.setSamples(t),a.setPen(new Misc.Pen(Utility.randomColor())),n.curveAttributeDlg.defaultIconSize=new Misc.Size(a.getLegendIconSize());var s="";return Static.showline&&Static.showsymbol?s="lineAndSymbol":Static.showline?s="line":Static.showsymbol&&(s="symbol"),Utility.setLegendAttribute(a,s,a.getLegendIconSize()),a.attach(n),n.rv.setCurrentCurve(a),n.sidebar&&(n.sidebar.initSidebar(),n.rv.refresh()),!0}function a(e,t,r,i,a){var s,o,l;if(a?(s=i.array,o=i.minZ,l=i.maxZ):(s=i.data,o=i.zLimits.min,l=i.zLimits.max),!s||0==s.length)return null;if(n.findPlotCurve(e))return Static.alert(e+" already exist"),null;var c=new SpectroCurve(e);return c.setSamples(s),c.setPenWidth(4),c.setColorInterval(t,r),c.setColorRange(new Interval(o,l)),c.attach(n),c}function s(e,t,r){var i=new Spectrogram(e);return r?i.setData(new SpectrogramFileData(t)):i.setData(new SpectrogramFunctionData(t)),i.setContourLevels(i.calculateContourLevels(10)),i.attach(n),Static.bind("alphaChanged",function(e,t){i.setAlpha(t)}),Static.bind("showSpectrogram",function(e,t){i.setDisplayMode(Enum.DisplayMode.ImageMode,t),i.setDefaultContourPen(t?new Misc.Pen("black",0):new Misc.Pen(Static.NoPen))}),Static.bind("showContour",function(e,t){i.setDisplayMode(Enum.DisplayMode.ContourMode,t)}),Static.bind("colorMap",function(e,t){"RGBMap"===t&&i.setColorMap(new LinearColorMapRGB),"IndexMap"===t&&i.setColorMap(new LinearColorMapIndexed)}),Static.bind("numberOfPlanes",function(e,t){i.setContourLevels(i.calculateContourLevels(t))}),!0}this.grid=new PlotGrid,Static.curvePropPane=0,Static.plotPropPane=1,Static.infoPropPane=2,this.grid.attach(this),Utility.minorGridLines(this.grid,!0),this.insertLegend(new MLegend),this.enableLegend(!0),this.file=new MFile(this,MyCurve),this.markerDlg=new MMarkerDlg,this.pointEntryDlg=new MPointEntryDlg,this._functionDlg=new MFunctionDlg,this.curveFitDlg=new MCurveFitDlg,this.curveStyleDlg=new MCurveStyleDlg,this.axisDlg=new MAxisDlg,this.curveAttributeDlg=new MCurveLegendAttributeDlg,this.addCurveInit=function(e){e.coeffs=n._functionDlg.coeffs,e.variable=n._functionDlg.variable,e.coeffsVal=function(){for(var e=[],t=n._functionDlg.coeffs||[],r=0;r<t.length;++r)e.push(1);return e}(),e.fn=n._functionDlg.expandedFn,e.unboundedRange=n._functionDlg.unboundedRange,e.lowerX=parseFloat(n._functionDlg.lowerLimit),e.upperX=parseFloat(n._functionDlg.upperLimit),e.numOfSamples=n._functionDlg.numOfPoints},Static.bind("addSpectrocurve",function(e,t,n,r){a(t,"lightGreen","green",n,r)}),Static.bind("addSpectrogram",function(e,t,n,r){s(t,n,r)}),Static.bind("addCurve",function(e,t,n,r){i(t,n,r)}),this._functionDlg.init(function(){var e=n._functionDlg.title,t=n._functionDlg.expandedFn,r=(n._functionDlg.lowerLimit,n._functionDlg.upperLimit,n._functionDlg.numOfPoints);if(n._functionDlg.threeD){"spectrocurve"===n._functionDlg.threeDType&&a(e,n._functionDlg.color1,n._functionDlg.color2,Utility.makeSamples({fx:t,threeD:!0,variable:n._functionDlg.variable,variableY:n._functionDlg.variableY,lowerX:parseFloat(n._functionDlg.lowerLimit),upperX:parseFloat(n._functionDlg.upperLimit),lowerY:parseFloat(n._functionDlg.lowerLimitY),upperY:parseFloat(n._functionDlg.upperLimitY),numOfSamples:n._functionDlg.numOfPoints,ok_fn:n._functionDlg.ok}))&&n._functionDlg.close(),"spectrogram"===n._functionDlg.threeDType&&s(e,{fx:t,variable:n._functionDlg.variable,variableY:n._functionDlg.variableY,minX:parseFloat(n._functionDlg.lowerLimit),maxX:parseFloat(n._functionDlg.upperLimit),minY:parseFloat(n._functionDlg.lowerLimitY),maxY:parseFloat(n._functionDlg.upperLimitY),minZ:0,maxZ:10})&&n._functionDlg.close()}else{var o=n._functionDlg.coeffs;if(n._functionDlg.coeffs.length)for(var l=0;l<o.length;++l)for(;-1!=t.indexOf(o[l]);)t=t.replace(o[l],1);n._functionDlg.unboundedRange?function(e,t,r){if(n.findPlotCurve(e))return Static.alert(e+" already exist"),!1;n.setAxisScale(xBottom,1,10),n.setAxisScale(yLeft,1,10);var i=new MyCurve(e);return n.addCurveInit(i),i.setData(new FunctionData(t,r)),i.setPen(new Misc.Pen(Utility.randomColor())),n.curveAttributeDlg.defaultIconSize=new Misc.Size(i.getLegendIconSize()),Static.showline&&i.setLegendAttribute(LegendShowLine,!0),Static.showsymbol&&i.setLegendAttribute(LegendShowSymbol,!0),i.attach(n),Utility.setAutoScale(n,!0),!0}(e,t,r)&&n._functionDlg.close():i(e,Utility.makeSamples({fx:t,variable:n._functionDlg.variable,lowerX:parseFloat(n._functionDlg.lowerLimit),upperX:parseFloat(n._functionDlg.upperLimit),numOfSamples:n._functionDlg.numOfPoints,ok_fn:n._functionDlg.ok}),!1,t)&&n._functionDlg.close()}}),this.addRemovePoint=new AddRemovePointPicker(this),this.addRemovePoint.setAddRemoveMousePattern(Enum.MousePatternCode.MouseSelect1,Static.LeftButton,Static.ShiftModifier);var o=new Rulers(this);Static.watchCentroidWithArea=!0,Static.bind("watchCentroidWithArea",function(e,t){Static.watchCentroidWithArea=t,o.updateWatchesAndTable()}),this.tbar=new MToolBar(this,{zIndex:1003}),this.curveClosestPoint=new CurveClosestPoint(this),this.curveClosestPoint.setMousePattern(Static.LeftButton,Static.AltModifier),this.cs=new CurveShapeItem(this),this.curveShapeEnabledByPlotSettings=function(){return r},this.setCurveShapeEnabledByPlotSettings=function(e){r=e},this.setAxisTitle(xBottom,"Bottom scale"),this.setAxisTitle(xTop,"Top scale"),this.setAxisTitle(yLeft,"Left scale"),this.setAxisTitle(yRight,"Right scale"),this.magnifier=new Magnifier(this),this.pan=new Panner(this),this.pan.setCursor("move"),this.pan.setEnabled(!1),this.zm=new MyPlotZoomer(this);var l;this.leftSidebar=new PlotSideBar(this),this.leftSidebar.setTop(parseInt($("#toolBar1").css("height"))+2);new CurvePropertiesPane(this.leftSidebar.gridItem(0).bodyElement,this,Static.curvePropPane);l=new PlotPropertiesPane(this.leftSidebar.gridItem(1).bodyElement,this,Static.plotPropPane),this.leftSidebar.showGridItem(1,!0),this.rightSidebar=new InfoSideBar(this),this.rightSidebar.setTop(parseInt($("#toolBar1").css("height"))+2);new InfoPropertiesPane(this.rightSidebar.gridItem(0).bodyElement,this,Static.infoPropPane);this.rightSidebar.showSidebar(!1),this.settings=function(){return l},this.setFooter("Footer");var c=new LegendMenu(this);c.modifyMenu(null,{pos:2,name:"axis",img:"images/axis.png",title:"Sets the axes associated with the curve.",fun:function(){var e=c.getCurve();e&&n.axisDlg.axisCb(e)}}),c.setMenuModificationCb(function(){var e=c.getCurve();e.rtti===Static.Rtti_PlotSpectroCurve||e.rtti===Static.Rtti_PlotSpectrogram?(c.modifyMenu("curve brush",{}),c.modifyMenu("curve style",{}),c.modifyMenu("legend attribute",{}),c.modifyMenu("fit",{}),c.modifyMenu("symbol",{}),c.modifyMenu("pen",{})):c.modifyMenu(null,[{pos:0,name:"curve brush",img:"images/brush.png",title:"Set the fill color.",fun:function(){Utility.setCurveBrush(m_curve,function(e){Static.trigger("curveBrushChanged",e)})}},{pos:1,name:"curve style",img:"images/style.png",title:"Sets the style of the curve.",fun:function(){var e=c.getCurve();e&&n.curveStyleDlg.curveStyleCb(e)}},{pos:3,name:"legend attribute",img:"images/attribute.png",title:"Sets how the curve is represented on the legend.",fun:function(){var e=c.getCurve();e&&n.curveAttributeDlg.curveAttributeCb(e)}},{pos:6,name:"fit",img:"images/fit.png",title:"Defines a curve fitter.",fun:function(){var e=c.getCurve();e&&n.curveFitDlg.curveFitCb(e)}},{pos:7,name:"symbol",img:"images/symbol.png",title:"attach/modify curve symbol",subMenu:null},{pos:8,name:"pen",img:"images/pen.png",title:"modify/change curve pen",subMenu:c.getPenSubMenu()}]),e.rtti===Static.Rtti_PlotSpectroCurve?c.modifyMenu(null,{name:"pen width",subMenu:c.getPenWidthSubMenu()}):c.modifyMenu("pen width",{}),c.getCurve().fitType?c.modifyMenu(null,{pos:100,name:"fit info...",title:"Displays information associated with curve fitting.",fun:function(){var e=c.getCurve();if(e){var t=n.curveFitDlg.curveFitInfoCb(e);t.length?Static.alert(t):Static.alert('No curve fitting equation found for "'+e.title()+'."')}}}):c.modifyMenu("fit info...",{})}),this.file.setInputElement($("#fileInput")),this.replot(),this.setAutoReplot(!0),Static.bind("visibilityChange",function(e,t,r){t.rtti==Static.Rtti_PlotCurve&&(n.hasVisiblePlotCurve()?n.watchAreaBelowCurve.setEnable(n.tbar.isDropdownItemChecked("Watch",6)):n.watchAreaBelowCurve.setEnable(!1))});var u=n.getLayout().getCentralDiv(),h=[{name:"Hide rulers",img:"images/hide.png",title:"Hide all rulers",fun:function(){n.rv.setVisible(!1)}},{name:"Show rulers",img:"images/show.png",title:"Show any hidden rulers",fun:function(){n.rv.setVisible(!0)}},{name:"Unlock rulers",img:"images/unlock.png",title:"Unlock any locked rulers",fun:function(){n.rv.unlockAllRulers()}},{name:"Remove all curves",title:"Permanently remove all curves",img:"images/scissors.png",fun:function(){var e=n.itemList(Static.Rtti_PlotCurve);e.forEach(function(e){e.detach()}),(e=n.itemList(Static.Rtti_PlotSpectroCurve)).forEach(function(e){e.detach()}),(e=n.itemList(Static.Rtti_PlotSpectrogram)).forEach(function(e){e.detach()})}}];Static.bind("rulerDeselected",function(){u.contextMenu(h,{triggerOn:"contextmenu",zIndex:1})}),u.contextMenu(h,{triggerOn:"contextmenu",zIndex:1});var d=!0;Static.bind("gridlinesAccordingToCurve",function(e,t){d=t;var r=o.currentCurve();r&&d&&n.grid.setAxes(r.xAxis(),r.yAxis())}),Static.bind("currentCurveChanged",function(e,t){t&&d&&n.grid.setAxes(t.xAxis(),t.yAxis()),t&&f&&n.zm.setAxis(t.xAxis(),t.yAxis())}),Static.bind("axisChanged",function(e,t,r){r&&d&&n.grid.setAxes(r.xAxis(),r.yAxis()),r&&f&&n.zm.setAxis(r.xAxis(),r.yAxis())});var f=!0;Static.bind("zoomAccordingToCurve",function(e,t){f=t;var r=o.currentCurve();r&&f&&n.zm.setAxis(r.xAxis(),r.yAxis())})}}define("myPlot",["curveClosestPoint","plot","functionData","plotGrid","spectrogram"],function(){});class Curve extends PlotSeriesItem{constructor(e){super(e),Static.LegendNoAttribute=0,Static.LegendShowLine=1,Static.LegendShowSymbol=2,Static.LegendShowBrush=4;var t=Lines,n=0,r=0,i=FilterPoints,a=Static.LegendNoAttribute,s=new Misc.Brush,o=new Misc.Pen,l=null,c=null;function u(e){return e*e}this.rtti=Static.Rtti_PlotCurve,this.setItemInterest(ScaleInterest,!0),this.minXValue=function(){return this.boundingRect().left()},this.maxXValue=function(){return this.boundingRect().right()},this.minYValue=function(){return this.boundingRect().top()},this.maxYValue=function(){return this.boundingRect().bottom()},this.setLegendAttribute=function(e,t){t!=this.testLegendAttribute(e)&&(t?a|=e:a&=~e,Utility.updateLegendIconSize(this),this.plot()&&this.plot().updateLegend(this))},this.testLegendAttribute=function(e){return a&e},this.legendAttributes=function(){return a},this.setSymbol=function(e){e!==c&&(c=e,Utility.updateLegendIconSize(this),this.legendChanged(),this.itemChanged())},this.symbol=function(){return c},this.setBrush=function(e){"string"==typeof e&&(e=new Misc.Brush(e)),s=e,this.legendChanged(),this.itemChanged()},this.brush=function(){return s},this.setPen=function(e){"object"==typeof e&&(o=e,this.legendChanged(),this.itemChanged())},this.pen=function(){return o},this.setPaintAttribute=function(e,t){t?i|=e:i&=~e},this.testPaintAttribute=function(e){return i&e},this.setSamples=function(e){this.setData(new PointSeriesData(e))},this.setCurveAttribute=function(e,t){void 0===t&&(t=!0),(n&e)!=t&&(t?n|=e:n&=~e,this.itemChanged())},this.curveAttributes=function(){return n},this.testCurveAttribute=function(e){return n&e},this.init=function(){this.setItemAttribute(Legend,!0),this.setItemAttribute(AutoScale,!0),this.setData(new PointSeriesData),this.setCurveAttribute(Fitted,!0),this.setZ(20)},this.setStyle=function(e){e!=t&&(t=e,this.legendChanged(),this.itemChanged())},this.style=function(){return t},this.drawSeries=function(e,n,r,i){var a=this.getContext(),l=new PaintUtil.Painter(a),u=this.dataSize();u<=0||(i<0&&(i=u-1),Utility.mVerifyRange(u,r,i)>0&&(l.save(),l.setPen(o),l.setBrush(s),this.drawCurve(l,t,e,n,r,i),l.restore(),c&&c.style()!==NoSymbol&&(l.save(),l.setPen(c.pen()),l.setBrush(c.brush()),this.drawSymbols(a,c,e,n,r,i),l.restore())),l=null)},this.drawSymbols=function(e,t,n,r,i,a){var s=new PointMapper;s.setFlag(WeedOutPoints,this.testPaintAttribute(FilterPoints));for(var o=i;o<=a;o+=500){var l=Math.min(500,a-o+1),c=s.toPointsF(n,r,this.data(),o,o+l-1);c.length>0&&t.drawSymbols(e,c)}},this.setBaseline=function(e){r!=e&&(r=e,this.itemChanged())},this.baseline=function(){return r},this.drawCurve=function(e,t,n,r,i,a){switch(t){case Lines:this.testCurveAttribute(Fitted)&&(i=0,a=this.dataSize()-1),this.drawLines(e,n,r,i,a);break;case Sticks:this.drawSticks(e,n,r,i,a);break;case Steps:this.drawSteps(e,n,r,i,a);break;case Dots:this.drawDots(e,n,r,i,a)}},this.setCurveFitter=function(e){l=e,this.itemChanged()},this.curveFitter=function(){return l},this.closestPoint=function(e,t){let n=this.dataSize();if(null==this.plot()||n<=0)return-1;let r=this.data(),i=this.plot().canvasMap(this.xAxis()),a=this.plot().canvasMap(this.yAxis()),s=-1,o=1e10;for(var l=0;l<n;l++){let t=r.sample(l),n=i.transform(t.x)-e.x,c=a.transform(t.y)-e.y,h=u(n)+u(c);h<o&&(s=l,o=h)}return t&&(t.distance=Math.sqrt(o)),s},this.fillCurve=function(e,t,n,r){s.color!=Static.NoBrush&&(this.closePolyline(t,n,r),r.length<=2||(e.setPen(new Misc.Pen(s.color)),e.drawPolygon(r)))},this.closePolyline=function(e,t,n){if(!(n.length<2)){var i=r;if(this.orientation()==Vertical){t.transformation()&&(i=t.transformation().bounded(i));var a=t.transform(i);n.push(new Misc.Point(n[n.length-1].x,a)),n.push(new Misc.Point(n[0].x,a))}else{e.transformation()&&(i=e.transformation().bounded(i));var s=e.transform(i);n.push(new Misc.Point(s,n[n.length-1].y)),n.push(new Misc.Point(s,n[0].y))}}},this.drawSteps=function(e,t,r,i,a){for(var s=[],o=2*(a-i)+1,l=0;l<o;++l)s.push(new Misc.Point);var c=this.orientation()==Vertical;n&Inverted&&(c=!c);var u,h=this.data();for(l=i,u=0;l<=a;l++,u+=2){var d=h.sample(l),f=t.transform(d.x),p=r.transform(d.y);if(u>0){var m=s[u-2],v=s[u-1];c?(v.x=m.x,v.y=p):(v.x=f,v.y=m.y)}s[u].x=f,s[u].y=p}e.drawPolyline(s),"noBrush"!=this.brush()&&this.fillCurve(e,t,r,s)},this.drawSticks=function(e,t,n,i,a){for(var s=t.transform(r),o=n.transform(r),l=this.orientation(),c=this.data(),u=i;u<=a;u++){var h=c.sample(u),d=t.transform(h.x),f=n.transform(h.y);l==Horizontal?e.drawLine(s,f,d,f):e.drawLine(d,o,d,f)}},this.drawDots=function(e,t,n,r,a){var s=new PointMapper;if(i&FilterPoints&&s.setFlag(WeedOutPoints,!0),i&MinimizeMemory)for(var o=this.data(),l=r;l<=a;l++){var c=o.sample(l),u=t.transform(c.x),h=n.transform(c.y);e.drawPoint(new Misc.Point(u,h))}else{var d=s.toPointsF(t,n,this.data(),r,a);e.drawPoints(d)}},this.legendIcon=function(e,t){if(0===t.width&&0===t.height)return null;var n=new Graphic(null,t.width,t.height),r=new PaintUtil.Painter(n);if(0==this.legendAttributes()||this.legendAttributes()&Static.LegendShowBrush){var i=this.brush();if(i.color==Static.NoBrush&&0==this.legendAttributes()&&(this.style()!=NoCurve?i=new Misc.Brush(this.pen().color):this.symbol()&&this.symbol().style()!=NoSymbol&&(i=new Misc.Brush(this.symbol().pen().color))),i.color!=Static.NoBrush){var a=new Misc.Rect(0,0,t.width,t.height);r.fillRect(a,i)}}if(this.legendAttributes()&Static.LegendShowLine&&this.pen().color!=Static.NoPen){var s=this.pen();r.setPen(s);var o=.5*t.height;r.drawLine(0,o,t.width,o)}if(this.legendAttributes()&Static.LegendShowSymbol&&this.symbol()){var l=t.height/2;this.symbol().style()==Ellipse&&(l-=1),r.setPen(this.symbol().pen()),this.symbol().drawGraphicSymbol(r,new Misc.Point(t.width/2,l),t)}return r=null,n},this.removePoint=function(e,t){void 0==t&&(t=!1);var n=this.data().samples();if(1!=n.length||t){for(var r=[],i=0;i<n.length;++i)n[i].isEqual(e)||r.push(n[i]);r.length!==n.length||t?(this.setSamples(r),this.itemChanged(),Static.trigger("pointRemoved",this)):Static.alert("The point selected for removal does not exist.")}else Static.alert("You cannot remove the only point in the curve. Remove the entire curve.")},this.toString=function(){return"[Curve]"},this.init()}drawLines(e,t,n,r,i){if(!(r>i)){var a=this.curveAttributes()&Fitted&&this.curveFitter(),s=this.brush().color!==Static.NoBrush,o=(new PointMapper).toPolygonF(t,n,this.data(),r,i);a&&(o=this.curveFitter().fitCurve(o)),e.drawPolyline(o),s&&this.fillCurve(e,t,n,o)}}}define("plotcurve",["static","seriesData"],function(){});class MyCurve extends Curve{constructor(e){super(e)}}define("myCurve",["plotcurve"],function(){});class SpectroCurve extends PlotSeriesItem{constructor(e){super(e),this.rtti=Static.Rtti_PlotSpectroCurve;var t=new LinearColorMap(Enum.Format.Indexed),n=new Interval(0,1e3),r=0,i=[];this.init=function(){this.setItemAttribute(Legend,!0),this.setItemAttribute(AutoScale,!0),this.setData(new Point3DSeriesData)},this.setPaintAttribute=function(e,t){t?m_paintAttributes|=e:m_paintAttributes&=~e},this.testPaintAttribute=function(e){return m_paintAttributes&e},this.setSamples=function(e){this.setData(new Point3DSeriesData(e))},this.setColorMap=function(e){e!=t&&(t=e),itemChanged()},this.colorMap=function(){return t},this.setColorRange=function(e){e!=n&&(n=e,this.itemChanged())},this.colorRange=function(){return n},this.setPenWidth=function(e){e<0&&(e=0),r!=e&&(r=e,this.itemChanged())},this.penWidth=function(){return r},this.setColorInterval=function(e,n){t.setColorInterval(e,n),this.itemChanged()},this.color1=function(){return t.color1()},this.color2=function(){return t.color2()},this.drawSeries=function(e,t,n,r){var i=this.getContext(),a=new PaintUtil.Painter(i);this.dataSize()<=0||(r<0&&(r=this.dataSize()-1),n<0&&(n=0),n>r||(this.drawDots(a,e,t,n,r),a=null))},this.drawDots=function(e,a,s,o,l){if(n.isValid()){var c=t.format();c==Enum.Format.Indexed&&(i=t.colorTable(n));for(var u=this.data(),h=o;h<=l;h++){var d=u.sample(h),f=a.transform(d.x),p=s.transform(d.y);if(c==Enum.Format.RGB){var m=t.rgb(n,d.z);e.setPen(new Misc.Pen(Static.RGB2HTML(m),r)),e.setBrush(new Misc.Brush(Static.RGB2HTML(m)))}else{var v=parseInt(t.colorIndex(n,d.z)),g=i[v];e.setPen(new Misc.Pen(Static.RGB2HTML(g),r)),e.setBrush(new Misc.Brush(Static.RGB2HTML(g)))}e.drawPoint(new Misc.Point(f,p))}i=[]}},this.init()}}define("plotSpectroCurve",["static","colorMap","plotItem","seriesData"],function(){});class Graphic{constructor(e,t,n){var r=e,i=t,a=n,s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("width",t),s.setAttribute("height",n),this.parent&&this.parent[0].appendChild(s),this.setParent=function(e){this.parent=e,this.parent[0].appendChild(s)},this.parent=function(){return r},this.setWidth=function(e){i=e},this.width=function(){return i},this.setHeight=function(e){a=e},this.height=function(){return a},this.svg=function(){return s},this.toString=function(){return"[Graphic]"}}}function mDrawXCrossSymbols(e,t,n){var r=n.size(),i=n.pen(),a=(n.brush(),r.width),s=r.height;e.beginPath(),e.strokeStyle=i.color,e.lineWidth=i.width;for(var o=0;o<t.length;o++){var l=t[o].x-.5*a-1,c=t[o].y-.5*s-1;e.moveTo(l,c),e.lineTo(l+a,c+s),e.moveTo(l+a,c),e.lineTo(l,c+s)}e.stroke()}function mDrawLineSymbols(e,t,n,r){var i=r.size(),a=r.pen(),s=(r.brush(),i.width),o=i.height,l=new PaintUtil.Painter(e);l.setPen(a),l.save();for(var c=0;c<n.length;c++){if(t&Horizontal){var u=n[c].x-.5*s-1,h=n[c].y-1;l.drawLine(u,h,u+s,h)}if(t&Vertical){u=n[c].x-1,h=n[c].y-.5*o-1;l.drawLine(u,h,u,h+o)}}l.restore(),l=null}function mDrawPathSymbols(e,t,n){var r=t.length,i=n.size(),a=n.pen(),s=n.brush(),o=i.width,l=i.height,c=new PaintUtil.Painter(e);c.setPen(a),c.setBrush(s);for(var u=0;u<r;u++){var h=t[u].x,d=t[u].y,f=n.m_path.boundingRect();c.save(),c.translate(h,d),c.scale(o/f.width(),l/f.height()),n.m_path.data.rotation&&c.rotate(n.m_path.data.rotation);var p=n.pinPoint();c.translate(-1*p.x,-1*p.y),c.drawPath(n.m_path),c.restore()}c=null}function mDrawDiamondSymbols(e,t,n){var r=new PaintUtil.Painter(e);r.save(),r.setBrush(n.brush()),r.setPen(n.pen());for(var i=n.size(),a=(new Misc.Rect(new Misc.Point,n.size()),t.length),s=0;s<a;s++)r.save(),r.translate(t[s].x-1,t[s].y-1),r.rotate(45),r.drawRect(-.5*i.width,-.5*i.height,i.width,i.height),r.restore();r.restore(),r=null}function mDrawRectSymbols(e,t,n){var r=new PaintUtil.Painter(e);r.save(),r.setBrush(n.brush()),r.setPen(n.pen());for(var i=new Misc.Rect(new Misc.Point,n.size()),a=t.length,s=0;s<a;s++)i.moveCenter(t[s]),r.drawRect(i.left(),i.top(),i.width(),i.height());r.restore(),r=null}function mDrawEllipseSymbols(e,t,n){var r=new PaintUtil.Painter(e);r.save(),r.setBrush(n.brush()),r.setPen(n.pen());for(var i=Math.min(n.size().width,n.size().height)/2,a=t.length,s=0;s<a;s++)r.drawCircle(t[s].x-1,t[s].y-1,i);r.restore(),r=null}function mDrawCrossGraphicSymbol(e,t,n,r){e.setBrush(r.brush()),e.setPen(r.pen());var i=new Misc.Rect(new Misc.Point,r.size());i.moveCenter(t),e.drawLine(i.left()+.5*i.width(),i.top(),i.left()+.5*i.width(),i.bottom()),e.drawLine(i.left(),i.top()+.5*i.height(),i.right(),i.top()+.5*i.height())}function mDrawXCrossGraphicSymbol(e,t,n,r){e.setBrush(r.brush()),e.setPen(r.pen());var i=new Misc.Rect(new Misc.Point,r.size());i.moveCenter(t),e.drawLine(i.left(),i.top(),i.right(),i.bottom()),e.drawLine(i.right(),i.top(),i.left(),i.bottom())}function mDrawRectGraphicSymbol(e,t,n,r){e.setBrush(r.brush());var i=new Misc.Rect(new Misc.Point,r.size());i.moveCenter(t),e.drawRect(i.left(),i.top(),i.width(),i.height())}function mDrawDiamondGraphicSymbol(e,t,n,r){e.setBrush(r.brush());var i=new Misc.Rect(new Misc.Point,.707*r.size().width,.707*r.size().height);i.moveCenter(t),e.drawRect(i.left(),i.top(),i.width(),i.height()),e.transform({rotation:45,rotationX:t.x,rotationY:t.y})}function mDrawEllipseGraphicSymbol(e,t,n,r){e.setBrush(r.brush());var i=Math.min(r.size().width-r.pen().width,r.size().height-r.pen().width)/2;e.drawCircle(t.x,t.y,i)}function mDrawPathGraphicSymbol(e,t,n,r){var i=r.pen(),a=0;i.style!==Static.NoPen&&(a=Math.max(i.width,1));var s=r.path().boundingRect();s=s.adjusted(-a,-a,a,a);var o=r.path().data;o.xOffset=-1*s.left(),o.yOffset=-1*s.top(),o.xCenter=(s.right()-s.left())/2,o.yCenter=(s.bottom()-s.top())/2,e.setBrush(r.brush()),e.setPen(r.pen()),o.scale=Math.min(n.width/s.width(),n.height/s.height()),e.drawPath(r.path())}define("graphic",function(){});class Symbol{constructor(e,t,n,r){var i=NoSymbol,a=new Misc.Size(-1,-1),s=new Misc.Brush("gray"),o=new Misc.Pen;this.m_path=0;var l=new Misc.Point(0,0);void 0!==r?(i=e,s=t,o=n,a=r):void 0!==n?(i=e,s=t,o=n):void 0!==t?(i=e,s=t):void 0!==e&&(i=e),this.setPinPoint=function(e){l=e},this.pinPoint=function(e){return l},this.setSize=function(e){e.isValid()&&!e.isEqual(a)&&(a=e)},this.size=function(){return a},this.setStyle=function(e){i!=e&&(i=e)},this.style=function(){return i},this.setPath=function(e){i=Path,this.m_path=e},this.path=function(){return this.m_path},this.setPen=function(e){o=e},this.pen=function(){return o},this.setBrush=function(e){s=e},this.brush=function(){return s},this.brush1=function(){return"noBrush"!==s.color},this.drawSymbols=function(e,t){if(!(t.length<=0)){this.renderSymbols(e,t)}},this.drawGraphicSymbol=function(e,t,n){this.renderGraphicSymbol(e,t,n)},this.drawSymbol=function(e,t){this.drawSymbols(e,[t])},this.renderSymbols=function(e,t){t.length;switch(i){case Ellipse:mDrawEllipseSymbols(e,t,this);break;case MRect:mDrawRectSymbols(e,t,this);break;case Diamond:mDrawDiamondSymbols(e,t,this);break;case Cross:mDrawLineSymbols(e,Horizontal|Vertical,t,this);break;case XCross:mDrawXCrossSymbols(e,t,this);break;case HLine:mDrawLineSymbols(e,Horizontal,t,this);break;case VLine:mDrawLineSymbols(e,Vertical,t,this);break;case Path:mDrawPathSymbols(e,t,this)}},this.renderGraphicSymbol=function(e,t,n){if(i!==Cross||i!==XCross){var r=new Misc.Pen(this.pen());this.brush1()&&(r.width/=2),e.setPen(r)}switch(i){case Ellipse:mDrawEllipseGraphicSymbol(e,t,0,this);break;case MRect:mDrawRectGraphicSymbol(e,t,0,this);break;case Diamond:mDrawDiamondGraphicSymbol(e,t,0,this);break;case Cross:mDrawCrossGraphicSymbol(e,t,0,this);break;case XCross:mDrawXCrossGraphicSymbol(e,t,0,this);break;case HLine:case VLine:break;case Path:mDrawPathGraphicSymbol(e,t,n,this)}},this.boundingRect=function(){var e=new Misc.Rect;switch(i){case Ellipse:case MRect:case Hexagon:var t=0;o.style!=Static.NoPen&&(t=Math.max(o.width,1)),(e=new Misc.Rect(new Misc.Point,a.width+t,a.height+t)).moveCenter(new Misc.Point);break;case XCross:case Diamond:case Triangle:case UTriangle:case DTriangle:case RTriangle:case LTriangle:case Star1:case Star2:t=0;o.style!==Static.NoPen&&(t=Math.max(o.width,1)),(e=new Misc.Rect(new Misc.Point,a.width+t,a.height+t)).moveCenter(new Misc.Point);break;case Path:e=m_path.boundingRect(),console.log(e.width()),e.moveCenter(new Misc.Point);break;default:(e=new Misc.Rect(new Misc.Point,a.width,a.height)).moveCenter(new Misc.Point)}var n=new Misc.Rect;return n.setLeft(Math.floor(e.left())),n.setTop(Math.floor(e.top())),n.setRight(Math.ceil(e.right())),n.setBottom(Math.ceil(e.bottom())),n}}toString(){return"[Symbol]"}}define("symbol",["static","graphic"],function(){});class LegendData{constructor(){var e={},t=!0;function n(t){return void 0!==e[t]}this.title=function(){return this.value(Static.TitleRole)},this.icon=function(){return this.value(Static.IconRole)},this.mode=function(){return this.hasRole(Static.ModeRole)?this.value(Static.ModeRole):Static.ReadOnly},this.setValue=function(n,r){e[n]=r,t=!1},this.isValid=function(){return!t},this.hasRole=function(e){return n(e)},this.value=function(t){return n(t)?e[t]:null},this.toString=function(){return"[LegendData]"}}}class AbstractLegend{constructor(){Static.makeAbstract(this,AbstractLegend);var e=null,t=!1,n=null,r="",i=0,a=100,s=function(t,n){t.setVisible(!n),e.autoReplot()||e.replot()};"undefined"!=typeof checkChangeFn&&(s=checkChangeFn);var o=[],l=$("<table/>").attr({});this.setLegendDiv=function(e){n||((n=e).append(l),n.css("overflow","auto"))},this.legendDiv=function(){return n},this.setPlot=function(t){e=t,n!==$("#legendDiv")&&t.getLayout().getPlotDiv().append(n)},this.isEmpty=function(){return!(l[0].rows.length>=1)},this.setMaxWidth=function(e){a=e},this.maxWidth=function(){return a},this.legendDivWidth=function(){var t=e.legendFont().textSize(r).width+i+8;return t<this.maxWidth()?t:this.maxWidth()},this.addItem=function(e,n){var a=e.plot().legendFont(),c=e.legendData()[0];if(c.isValid()){var u=c.title(),h=c.icon();h&&h.width()>i&&(i=h.width());var d=$("<tr />"),f=$('<td class="unchecked"></td>'),p=$("<label />");p.css("color",a.fontColor),p.css("font-size",a.th),p.text(" "+u);var m=$("<span/>");h&&h.setParent(m),p.appendTo(m),m.appendTo(f),d.append(f),l.append(d),void 0!==n&&n>-1?(o.splice(n,0,e),Static.setElementIndex(d,n)):o.push(e),f.on("click",e,function(e){"unchecked"===$(this).attr("class")?($(this).removeClass("unchecked"),$(this).addClass("checked"),t=!0):($(this).removeClass("checked"),$(this).addClass("unchecked"),t=!1),s&&s(e.data,t)}),e.title().length>r.length&&(r=e.title())}},this.removeItem=function(e){var t,r=o.indexOf(e);if(!(r<0))return(t=r)>-1&&o.splice(t,1),l[0].deleteRow(r),parseInt(l.css("height"))<parseInt(n.css("height"))&&n.css("overflow-y","auto"),parseInt(l.css("width"))<parseInt(n.css("width"))&&n.css("overflow-x","auto"),r},this.clearLegend=function(){for(var e=l[0].rows.length,t=0;t<e;++t)l[0].deleteRow(0)},this.rowNumberFromName=function(e){for(var t=l[0].rows,n=0;n<t.length;++n)if(t[n].cells[0].innerText===e)return n;return-1}}toString(){return"[AbstractLegend]"}renderLegend(e,t,n){return!0}updateLegend(e,t){}}class MLegend extends AbstractLegend{constructor(){super(),this.toString=function(){return"[MLegend]"}}}define("legend",["static"],function(){});class Magnifier extends HObject{constructor(e){super(e);for(var t=null,n=!0,r=1.9,i=Static.NoModifier,a=.95,s=Static.RightButton,o=Static.NoModifier,l=.9,c=107,u=Static.Key_Shift,h=109,d=Static.Key_Shift,f=!1,p=!1,m=!1,v=0,g=[],b=0;b<axisCnt;b++)g[b]=!0;g[1]=!1,g[3]=!1,this.setAxisEnabled=function(e,t){e>=0&&e<axisCnt&&(g[e]=t)},this.isAxisEnabled=function(e){return!(e>=0&&e<axisCnt)||g[e]},void 0!==e&&(e.magnifier=this,t=e,this.setElement(t.getLayout().getCentralDiv())),this.plot=function(){return t},this.setWheelFactor=function(e){r=e},this.wheelFactor=function(){return r},this.setWheelModifiers=function(e){i=e},this.wheelModifiers=function(){return i},this.setMouseFactor=function(e){a=e},this.mouseFactor=function(){return a},this.setMouseButton=function(e,t){s=e,o=t},this.getMouseButton=function(){return{button:s,modifiers:o}},this.setKeyFactor=function(e){l=e},this.keyFactor=function(){return l},this.setZoomInKey=function(e,t){c=e,u=t},this.getZoomInKey=function(){return{key:c,modifiers:u}},this.setZoomOutKey=function(e,t){h=e,d=t},this.getZoomOutKey=function(){return{key:h,modifiers:d}},this.setEnabled=function(e){n=e},this.isEnabled=function(e){return n},this.event=function(e){if(n)switch(e.type){case"mousedown":return null==this.plot()||(e.button!==s||(e.clientX,v=e.clientY,f=!0,!0));case"mouseup":e.button===s&&f&&this.plot()&&(f=!1);break;case"mousemove":if(!f)return;var t=e.clientY-v;if(0!=t){var i=a;t<0&&(i=1/i),this.rescale(i)}e.clientX,v=e.clientY;break;case"keydown":e.keyCode==u&&(p=!0),e.keyCode==d&&(m=!0),e.keyCode==c&&p?this.rescale(l):e.keyCode==h&&m&&this.rescale(1/l);break;case"keyup":e.keyCode==u&&(p=!1),e.keyCode==d&&(m=!1);break;case"mousewheel":if(0!=r){i=Math.pow(r,Math.abs(e.deltaY/15));e.deltaY>0&&(i=1/i),this.rescale(i)}}},this.rescale=function(e){var t=this.plot();if(null!=t&&1!=(e=Math.abs(e))&&0!=e){var n=!1,r=t.autoReplot();t.setAutoReplot(!1);for(var i=0;i<axisCnt;i++){var a=this.plot().axisScaleDiv(i);if(this.isAxisEnabled(i)){var s,o,l,c,u=this.plot().axisScaleEngine(i);u instanceof LogScaleEngine?(s=(Static.mLog(u.base(),a.lowerBound())+Static.mLog(u.base(),a.upperBound()))/2,o=(Static.mLog(u.base(),a.upperBound())-Static.mLog(u.base(),a.lowerBound()))/2*e,l=Math.pow(u.base(),s-o),c=Math.pow(u.base(),s+o)):(l=(s=a.lowerBound()+a.range()/2)-(o=a.range()/2*e),c=s+o),t.setAxisScale(i,l,c),n=!0}}return t.setAutoReplot(r),n&&t.replot(),!1}},this.setEnabled_1(!0),this.toString=function(){return"[Magnifier]"}}}define("magnifier",["static","hObject"],function(){});class PrivateData_2{constructor(){this.zoomRectIndex,this.zoomStack=[],this.maxStackDepth}}class PlotZoomer extends PlotPicker{constructor(e,t,n,r=!0){"number"!=typeof e?super(n=e):super(e,t,n);var i;this.getZoomerData=function(){return i},this.init=function(e){(i=new PrivateData_2).maxStackDepth=-1,this.setTrackerMode(Static.ActiveOnly),this.setRubberBand(Static.RectRubberBand),this.setStateMachine(new PickerDragRectMachine),this.plot().zoomer=this,Static.trigger("zoomerAdded",this),e&&this.plot()&&this.plot().replot(),this.setZoomBase(this.scaleRect())},this.setZoomBase=function(e=!0){if("object"==typeof e){var t=e;if(!(a=this.plot()))return;var n=this.scaleRect(),r=t|n;r=null;r=t||n,i.zoomStack=[],i.zoomStack.push(r),i.zoomRectIndex=0,t.isEqual(n)||(i.zoomStack.push(n),i.zoomRectIndex++),this.rescale()}else{var a;if(null==(a=this.plot()))return;e&&a.replot(),i.zoomStack=[],i.zoomStack.push(this.scaleRect()),i.zoomRectIndex=0,this.rescale()}},this.zoomBase=function(){return i.zoomStack[0]},this.zoomRect=function(){return i.zoomStack[i.zoomRectIndex]},this.setMaxStackDepth=function(e){if(i.maxStackDepth=e,e>=0){var t=i.zoomStack.length-1-e;if(t>0){this.zoom(-t);for(var n=i.zoomStack.length-1;n>i.zoomRectIndex;n--)i.zoomStack.pop()}}},this.maxStackDepth=function(){return i.maxStackDepth},this.zoomStack=function(){return i.zoomStack},this.setZoomStack=function(e,t=-1){if(0!=this.zoomStack.length&&!(i.maxStackDepth>=0&&this.zoomStack.length>i.maxStackDepth)){(t<0||t>this.zoomStack.length)&&(t=e.length-1);var n=this.zoomStack[t]!=this.zoomRect();i.zoomStack=e,i.zoomRectIndex=t,n&&(this.rescale(),Static.trigger("zoomed",this.zoomRect()))}},this.zoomRectIndex=function(){return i.zoomRectIndex},this.moveBy=function(e,t){var n=i.zoomStack[i.zoomRectIndex];moveTo(new Misc.Point(n.left()+e,n.top()+t))},this.moveTo=function(e){var t=e.x,n=e.y;t<this.zoomBase().left()&&(t=this.zoomBase().left()),t>this.zoomBase().right()-this.zoomRect().width()&&(t=this.zoomBase().right()-this.zoomRect().width()),n<this.zoomBase().top()&&(n=this.zoomBase().top()),n>this.zoomBase().bottom()-this.zoomRect().height()&&(n=this.zoomBase().bottom()-this.zoomRect().height()),t==this.zoomRect().left()&&n==this.zoomRect().top()||(i.zoomStack[i.zoomRectIndex].moveTo(t,n),this.rescale())},this.zoom=function(e){if("number"==typeof e){var t=e;if(0==t)i.zoomRectIndex=0;else{var n=i.zoomRectIndex+t;n=Math.max(0,n),n=Math.min(i.zoomStack.length-1,n),i.zoomRectIndex=n}this.rescale(),Static.trigger("zoomed",this.zoomRect())}else{if(i.maxStackDepth>=0&&i.zoomRectIndex>=i.maxStackDepth)return;var r=e.normalized();if(!r.isEqual(i.zoomStack[i.zoomRectIndex])){for(var a=i.zoomStack.length-1;a>i.zoomRectIndex;a--)i.zoomStack.pop();i.zoomStack.push(r),i.zoomRectIndex++,this.rescale(),Static.trigger("zoomed",r)}}},this.rescale=function(){var e=this.plot();if(e){var t=i.zoomStack[i.zoomRectIndex];if(!t.isEqual(this.scaleRect())){var n=e.autoReplot();e.setAutoReplot(!1);var r=t.left(),a=t.right();if(!e.axisScaleDiv(this.xAxis()).isIncreasing()){a=r=a}e.setAxisScale(this.xAxis(),r,a);var s=t.top(),o=t.bottom();if(!e.axisScaleDiv(this.yAxis()).isIncreasing()){o=s=o}e.setAxisScale(this.yAxis(),s,o),e.setAutoReplot(n),e.replot()}}},this.minZoomSize=function(){return new Misc.Size(i.zoomStack[0].width()/1e5,i.zoomStack[0].height()/1e5)},this.accept=function(e){if(e.length<2)return!1;var t=new Misc.Rect(e[0],e[e.length-1]);if((t=t.normalized()).width()<2&&t.height()<2)return!1;var n=t.center();return t.setSize(t.size().expandedTo(new Misc.Size(11,11))),t.moveCenter(n),e.resize(2),e[0]=t.topLeft(),e[1]=t.bottomRight(),!0},n&&this.init(r)}widgetKeyPressEvent(e){this.isActive()||(this.keyMatch(Enum.KeyPatternCode.KeyUndo,e)?this.zoom(-1):this.keyMatch(Enum.KeyPatternCode.KeyRedo,e)?this.zoom(1):this.keyMatch(Enum.KeyPatternCode.KeyHome,e)&&this.zoom(0)),super.widgetKeyPressEvent(e)}widgetMouseReleaseEvent(e){this.mouseMatch(Enum.MousePatternCode.MouseSelect2,e)||(this.mouseMatch(Enum.MousePatternCode.MouseSelect3,e)?this.zoom(-1):this.mouseMatch(Enum.MousePatternCode.MouseSelect6,e)?this.zoom(1):super.widgetMouseReleaseEvent(e))}end(e=!0){if(!(e=super.end(e)))return!1;if(!this.plot())return!1;var t=this.selection();if(t.length<2)return!1;var n=new Misc.Rect(t[0],t[t.length-1]);n=n.normalized();var r=this.invTransform(n).normalized();if(this.minZoomSize().isValid()){var i=r.center();r.setSize(r.size().expandedTo(this.minZoomSize())),r.moveCenter(i)}return this.zoom(r),!0}begin(){var e=this.getZoomerData();if(!(e.maxStackDepth>=0&&e.zoomRectIndex>=e.maxStackDepth)){var t=this.minZoomSize();if(t.isValid()){var n=new Misc.Size(.9999*e.zoomStack[e.zoomRectIndex].width(),.9999*e.zoomStack[e.zoomRectIndex].height());if(t.width>=n.width&&t.height>=n.height)return}super.begin()}}setAxis(e,t){e==super.xAxis()&&t==super.yAxis()||(super.setAxis(e,t),void 0!==this.setZoomBase&&this.setZoomBase(this.scaleRect()))}}define("plotzoomer",["plotpicker"],function(){});class MyPlotZoomer extends PlotZoomer{constructor(e){super(e),this.setEnabled(!1),this.setTrackerMode(Static.AlwaysOff),this.setTrackerPen(new Misc.Pen("blue"))}trackerText(e){var t,n=this.plot();e=this.invTransform(e);var r=0;r=n.axisEnabled(xBottom)?n.axisDecimalPlaces(xBottom):n.axisEnabled(xTop)?n.axisDecimalPlaces(xTop):n.axisDecimalPlaces(xBottom);var i=0;switch(i=n.axisEnabled(yLeft)?n.axisDecimalPlaces(yLeft):n.axisEnabled(yRight)?n.axisDecimalPlaces(yRight):n.axisDecimalPlaces(yLeft),this.rubberBand()){case Static.HLineRubberBand:t=Static.adjustForDecimalPlaces(e.y,i).toString();break;case Static.VLineRubberBand:t=Static.adjustForDecimalPlaces(e.x,r).toString();break;default:t=Static.adjustForDecimalPlaces(e.x,r).toString()+", "+Static.adjustForDecimalPlaces(e.y,i).toString()}return t}}define("myZoomer",["plotzoomer"],function(){});class CurveFitter{constructor(){this.fitCurve=function(e){throw'"fitCurve()" not reimplemented in subclass'}}}class SplineCurveFitter extends CurveFitter{constructor(){super();var e=Enum.FitMode.Auto,t=new Spline,n=100;this.setFitMode=function(e){},this.fitMode=function(){},this.setSpline=function(e){(t=e).reset()},this.spline=function(){return t},this.setSplineSize=function(e){n=Math.max(e,10)},this.splineSize=function(){return n},this.fitCurve=function(r){var i=r.length;if(i<=2)return r;var a=e;if(a==Enum.FitMode.Auto){a=Enum.FitMode.Spline;for(var s=r,o=1;o<i;o++)if(s[o].x<=s[o-1].x){a=Enum.FitMode.ParametricSpline;break}}return a==Enum.FitMode.ParametricSpline?function(e){for(var r=e.length,i=[],a=0;a<n;a++)i.push(new Misc.Point(-1,-1));var s=[],o=[];for(a=0;a<r;a++)s.push(new Misc.Point(-1,-1)),o.push(new Misc.Point(-1,-1));var l=e,c=s,u=o,h=0;for(a=0;a<r;a++){var d=l[a].x,f=l[a].y;if(a>0){var p=Math.sqrt(Static.sqr(d-c[a-1].y)+Static.sqr(f-u[a-1].y));h+=Math.max(p,1)}c[a].x=h,c[a].y=d,u[a].x=h,u[a].y=f}if(t.setPoints(s),!t.isValid())return e;var m=s[r-1].x/(n-1);for(a=0;a<n;a++){var v=a*m;i[a].x=t.value(v)}if(t.setPoints(o),!t.isValid())return e;var g=o[r-1].x/(n-1);for(a=0;a<n;a++)v=a*g,i[a].y=t.value(v);return i}(r):function(e){if(t.setPoints(e),!t.isValid())return e;for(var r=new Array(n),i=e[0].x,a=(e[e.length-1].x-i)/(n-1),s=0;s<n;s++){var o=i+s*a,l=t.value(o);r[s]=new Misc.Point(o,l)}return t.reset(),r}(r)}}}class WC_PrivateData{constructor(){this.tolerance=1,this.chunkSize=0}}class WC_Line{constructor(e=0,t=0){this.from=e,this.to=t}}class WeedingCurveFitter extends CurveFitter{constructor(e){var t;super();var n=function(e){var n=t.tolerance*t.tolerance,r=[],i=e,a=e.length,s=[];for(s.resize(a,!1),r.push(new WC_Line(0,a-1));r.length;){for(var o=r.pop(),l=i[o.to].x-i[o.from].x,c=i[o.to].y-i[o.from].y,u=Math.sqrt(l*l+c*c),h=0!=u?l/u:0,d=0!=u?c/u:0,f=0,p=o.from+1,m=o.from+1;m<o.to;m++){var v,g=i[m].x-i[o.from].x,b=i[m].y-i[o.from].y;if(g*h+b*d<0)v=g*g+b*b;else{var S=i[m].x-i[o.to].x,y=i[m].y-i[o.to].y,x=S*S+y*y,w=S*-h+y*-d;v=w<0?x:Math.abs(x-w*w)}f<v&&(f=v,p=m)}f<=n?(s[o.from]=!0,s[o.to]=!0):(r.push(new WC_Line(o.from,p)),r.push(new WC_Line(p,o.to)))}var _=[];for(m=0;m<a;m++)s[m]&&_.push(i[m]);return _};this.setTolerance=function(e){t.tolerance=Math.max(e,0)},this.tolerance=function(){return t.tolerance},this.setChunkSize=function(e){e>0&&(e=Math.max(e,3)),t.chunkSize=e},this.chunkSize=function(){return t.chunkSize},this.fitCurve=function(e){var r=[];if(0==t.chunkSize)r=n(e);else for(var i=0;i<e.length;i+=t.chunkSize){var a=e.mid(i,t.chunkSize);r=r.concat(n(a))}return r},t=new WC_PrivateData,this.setTolerance(e)}}function Spline(){var e=null,t=[],n=[],r=[],i=Static.SplineType.Natural;this.setSplineType=function(e){i=e},this.splineType=function(){return i},this.setPoints=function(a){var s,o=a.length;return o<=2?(this.reset(),!1):(e=a,t.resize(o-1),n.resize(o-1),r.resize(o-1),(s=i==Static.SplineType.Periodic?this.buildPeriodicSpline(a):this.buildNaturalSpline(a))||this.reset(),s)},this.points=function(){return e},this.reset=function(){t.resize(0),n.resize(0),r.resize(0),e.resize(0)},this.isValid=function(){return t.length>0},this.value=function(i){if(0==t.length)return 0;var a=Static.lookup(i,e),s=i-e[a].x;return((t[a]*s+n[a])*s+r[a])*s+e[a].y},this.coefficientsA=function(){return t},this.coefficientsB=function(){return n},this.coefficientsC=function(){return r},this.buildNaturalSpline=function(e){var i,a=e,s=e.length,o=t,l=n,c=r,u=new Array(s-1);for(i=0;i<s-1;i++)if(u[i]=a[i+1].x-a[i].x,u[i]<=0)return!1;var h=new Array(s-1),d=(a[1].y-a[0].y)/u[0];for(i=1;i<s-1;i++){l[i]=c[i]=u[i],o[i]=2*(u[i-1]+u[i]);var f=(a[i+1].y-a[i].y)/u[i];h[i]=6*(d-f),d=f}for(i=1;i<s-2;i++)c[i]/=o[i],o[i+1]-=l[i]*c[i];var p=new Array(s);for(p[1]=h[1],i=2;i<s-1;i++)p[i]=h[i]-c[i-1]*p[i-1];for(p[s-2]=-p[s-2]/o[s-2],i=s-3;i>0;i--)p[i]=-(p[i]+l[i]*p[i+1])/o[i];for(p[s-1]=p[0]=0,i=0;i<s-1;i++)o[i]=(p[i+1]-p[i])/(6*u[i]),l[i]=.5*p[i],c[i]=(a[i+1].y-a[i].y)/u[i]-(p[i+1]+2*p[i])*u[i]/6;return!0},this.buildPeriodicSpline=function(e){var i,a=e,s=e.length,o=t,l=n,c=r,u=new Array(s-1),h=new Array(s-1),d=new Array(s);for(i=0;i<s-1;i++)if(h[i]=a[i+1].x-a[i].x,h[i]<=0)return!1;var f=s-2,p=h[f],m=(a[0].y-a[f].y)/p;for(i=0;i<=f;i++){l[i]=c[i]=h[i],o[i]=2*(p+h[i]);var v=(a[i+1].y-a[i].y)/h[i];u[i]=6*(m-v),m=v,p=h[i]}o[0]=Math.sqrt(o[0]),c[0]=h[f]/o[0];var g=0;for(i=0;i<f-1;i++)l[i]/=o[i],i>0&&(c[i]=-c[i-1]*l[i-1]/o[i]),o[i+1]=Math.sqrt(o[i+1]-Static.sqr(l[i])),g+=Static.sqr(c[i]);for(l[f-1]=(l[f-1]-c[f-2]*l[f-2])/o[f-1],o[f]=Math.sqrt(o[f]-Static.sqr(l[f-1])-g),d[0]=u[0]/o[0],g=0,i=1;i<f;i++)d[i]=(u[i]-l[i-1]*d[i-1])/o[i],g+=c[i-1]*d[i-1];for(d[f]=(u[f]-l[f-1]*d[f-1]-g)/o[f],d[f]=-d[f]/o[f],d[f-1]=-(d[f-1]+l[f-1]*d[f])/o[f-1],i=f-2;i>=0;i--)d[i]=-(d[i]+l[i]*d[i+1]+c[i]*d[f])/o[i];for(d[s-1]=d[0],i=0;i<s-1;i++)o[i]=(d[i+1]-d[i])/(6*h[i]),l[i]=.5*d[i],c[i]=(a[i+1].y-a[i].y)/h[i]-(d[i+1]+2*d[i])*h[i]/6;return!0}}define("curveFitter",["static"],function(){}),Static.SplineType={},Static.SplineType.Natural=0,Static.SplineType.Periodic=1,Static.lookup=function(e,t){var n,r=t.length;if(e<=t[0].x)n=0;else if(e>=t[r-2].x)n=r-2;else{n=0;for(var i=r-2,a=0;i-n>1;)t[a=n+(i-n>>1)].x>e?i=a:n=a}return n},define("spline",["static"],function(){});class Panner extends HObject{constructor(e){super();var t=this,n=null,r=Static.LeftButton,i=Static.NoModifier,a=(Static.Key_Escape,Static.NoModifier,0),s=0,o=!1,l=!1,c="",u="",h=!1,d=Vertical|Horizontal,f=0,p=0;void 0!==e&&(e.panner=this,n=e),this.plot=function(){return n},this.setMouseButton=function(e,t=Static.NoModifier){r=e,i=t},this.getMouseButton=function(){return{button:r,modifiers:i}},this.setOrientation=function(e){d=e},this.rescaleAndRedraw=function(e,r){for(var i=t.plot().plotItemStore(),a=0;a<i.length;++a){var s=i[a].getCanvas();s.css("left",0),s.css("top",0)}var o=!1,l=n.autoReplot();n.setAutoReplot(!1);for(var c=0;c<axisCnt;c++){var u,h,d=t.plot().canvasMap(c),f=d.transform(t.plot().axisScaleDiv(c).lowerBound()),p=d.transform(t.plot().axisScaleDiv(c).upperBound());c==xBottom||c==xTop?(u=d.invTransform(f-e),h=d.invTransform(p-e)):(u=d.invTransform(f-r),h=d.invTransform(p-r)),this.setAxisScale(c,u,h),o=!0}n.setAutoReplot(l),o&&n.replot()},this.showCursor=function(e){e!=h&&null!=this.plot()&&""!=c&&(h=e,e?(this.plot().isCursorSet()&&(u=this.plot().cursor()),this.plot().setCursor(c)):""!==u?(this.plot().setCursor(u),u=""):this.plot().unsetCursor())},this.setCursor=function(e){c=e},this.cursor=function(){return""!=c?c:null!=this.plot()?this.plot().cursor():""},this.plot()&&this.setEnabled_1(!0),this.setEnabled=function(t){if(o!=t){o=t;var n=e.getCentralWidget();n&&(t?n.installEventFilter(this):n.removeEventFilter(this))}},this.isEnabled=function(e){return o},this.widgetMousePressEvent=function(e){var t=Static.isMobile();return!(t||e.button==r&&Utility.modifiers(e)===i)||(t?(a=e.originalEvent.touches[0].clientX,s=e.originalEvent.touches[0].clientY,l=!0):(a=e.clientX,s=e.clientY,l=!0),this.showCursor(!0),!0)},this.widgetMouseUpEvent=function(e){l&&(l=!1,t.showCursor(!1),0==f&&0==p||(t.rescaleAndRedraw(f,p),f=0,p=0))},this.widgetMouseMoveEvent=function(e){if(l){if(Static.isMobile()){var n=e.originalEvent.changedTouches[0];f=parseInt(n.clientX)-a,p=parseInt(n.clientY)-s}else f=e.clientX-a,p=e.clientY-s;d==Vertical&&(f=0),d==Horizontal&&(p=0),function(){for(var e=t.plot().plotItemStore(),n=0;n<e.length;++n){var r=e[n].getCanvas();r.css("left",f),r.css("top",p)}}()}},Static.trigger("pannerAdded",this),this.setEnabled(!0)}setAxisScale(e,t,n){this.plot().setAxisScale(e,t,n)}eventFilter(e,t){if(this.isEnabled()){switch(t.type){case"mousedown":case"touchstart":this.widgetMousePressEvent(t);break;case"mousemove":case"touchmove":this.widgetMouseMoveEvent(t);break;case"mouseleave":this.widgetMouseUpEvent(t);break;case"mouseup":case"touchend":this.widgetMouseUpEvent(t)}}}}Panner.prototype.toString=function(){return"[Panner]"},define("panner",["static","hObject"],function(){});class PlotShapeItem extends PlotItem{constructor(){super("Shape");var e=super.boundingRect(),t=new Misc.Pen("black",1,Static.NoPen),n=new Misc.Brush("#006464"),r=new Misc.MPath;this.setItemAttribute(AutoScale,!0),this.setItemAttribute(Legend,!1),this.setZ(8),this.rtti=Static.Rtti_PlotShape,this.getBoundingRect=function(){return e},this.setRect=function(e){var t=new Misc.MPath;t.addRect(e),this.setShape(t)},this.setPolygon=function(e){var t=new Misc.MPath;t.addPolygon(e),this.setShape(t)},this.setShape=function(t){r=t,e=t.isEmpty()?PlotItem.prototype.boundingRect.call(this):r.boundingRect()},this.setBrush=function(e){n=e,this.itemChanged()},this.brush=function(){return n},this.setPen=function(e){t=e,this.itemChanged()},this.pen=function(){return t},this.draw=function(i,a){if(this.clearCanvas(),!r.isEmpty()&&(t.style!=Static.NoPen||n!=Static.NoBrush)){var s=this.getCanvasRect(),o=ScaleMap.invTransform_Rect(i,a,s);if(e.intersects(o)){var l=this.getContext(),c=ScaleMap.transformPath(i,a,r,!1),u=new PaintUtil.Painter(l);u.setBrush(n),u.setPen(t),u.drawPath(c),u=null}}},this.boundingRect=function(){return this.getBoundingRect()},this.toString=function(){return"[PlotShapeItem]"}}}define("plotShapeItem",["static","plotItem"],function(){});class CurveShapeItem extends PlotShapeItem{constructor(e){super();var t=null,n=null,r=void 0,i=void 0,a=!0,s=this;function o(e,t){e&&("v_ruler1"!=e.title()&&"v_ruler2"!=e.title()||("v_ruler1"==e.title()?s.setLowerLimit(t):s.setUpperLimit(t)))}this.setEnabled=function(e){(a=e)&&t&&t.isVisible()?(this.setVisible(!0),this.refresh()):this.setVisible(!1)},this.enabled=function(e){return a},this.setCurve=function(e){e&&t==e||(t=e,this.setLimits(),a&&t&&t.isVisible()&&(this.setVisible(!0),this.refresh()))},this.curve=function(){return t},this.refresh=function(){n=this.isVisible()&&t?function(){var e=[];if("[SyntheticPointData]"==t.data().toString())return e;var n=t.data().samples();if(n&&!(n.length<2)){if(r<n[0].x||i>n[n.length-1].x||r>=i)return null;void 0==r&&(r=n[0].x),void 0==i&&(i=n[n.length-1].x);for(var a,s,o=-1,l=-1,c=(e=[],1);c<n.length;c++)n[c].x>r&&-1==o&&(o=c-1,e.push(n[o])),n[c-1].x<i&&(l=c,-1!=o&&e.push(n[l]));var u=t.plot().axisScaleEngine(t.xAxis()).toString();return"[LinearScaleEngine]"==u?(a=n[o].interpolatedPoint(n[o+1],r),s=n[l-1].interpolatedPoint(n[l],i)):"[LogScaleEngine]"==u&&(a=n[o].logInterpolatedPoint(n[o+1],r),s=n[l-1].logInterpolatedPoint(n[l],i)),e.length&&e[0].x!==a.x&&e.splice(0,1,a),e.length&&e[e.length-1].x!==s.x&&(e.pop(),e.push(s)),e.splice(0,0,new Misc.Point(e[0].x,Number.MIN_VALUE)),e.push(new Misc.Point(e[e.length-1].x,Number.MIN_VALUE)),e}}():null,this.setPolygon(n),t&&n&&(s.setAxes(t.xAxis(),t.yAxis()),t.plot().autoRefresh())},this.setLimits=function(e,t){r=e,i=t,this.refresh()},this.setLowerLimit=function(e){r=e,this.refresh()},this.setUpperLimit=function(e){i=e,this.refresh()},Static.bind("visibilityChange",function(e,n,r){n.rtti==Static.Rtti_PlotCurve&&(t&&n==t&&a&&r?s.setVisible(!0):(s.plot().curveShapeEnabledByPlotSettings()&&s.setEnabled(s.plot().tbar.isDropdownItemChecked("Watch",6)),n==t&&(s.setVisible(!1),s.setLimits())))}),Static.bind("axisChanged",function(e,n,r){r.rtti==Static.Rtti_PlotCurve&&t&&r===t&&s.setLimits()});var l=Number.MAX_VALUE,c=Number.MAX_VALUE;Static.bind("positionChanging",function(e,t,n){if(c!==t||l!==n){var r=t.plot(),i=r.autoReplot();r.setAutoReplot(!1),o(t,n),c=t,l=n,r.setAutoReplot(i),r.autoRefresh()}}),Static.bind("positionChanged",function(e,t,n){if(c!==t||l!==n){var r=t.plot(),i=r.autoReplot();r.setAutoReplot(!1),o(t,n),c=t,l=n,r.setAutoReplot(i),r.autoRefresh()}}),Static.bind("currentCurveChanged",function(e,t){t&&s.setCurve(t)}),Static.bind("curveShapeColorChanged",function(e,t){var n=s.brush();n.color=t,s.setBrush(n);var r=s.pen();r.color=t,s.setPen(r)}),Static.bind("watchEnabled",function(t,n,r){e.settings()&&e.settings().shadeWatchArea&&"Area below curve"==n.name()&&s.setEnabled(r)}),Static.bind("shadeWatchArea",function(t,n){e.setCurveShapeEnabledByPlotSettings(n),!n&&e.watchAreaBelowCurve.isEnable()||!n&&!e.watchAreaBelowCurve.isEnable()?s.setEnabled(!1):n&&e.watchAreaBelowCurve.isEnable()&&s.setEnabled(!0)}),Static.bind("itemAttached",function(t,n,r){n.rtti==Static.Rtti_PlotCurve&&(r?s.curve():e.itemList(Static.Rtti_PlotCurve).length&&e.hasVisiblePlotCurve()||s.setCurve(null),Static.trigger("visibilityChange",[n,r]),1==e.itemList(Static.Rtti_PlotCurve).length&&Static.trigger("currentCurveChanged",n))}),Static.bind("curveAdjusted",function(){s.isVisible()&&s.setLimits()}),Static.bind("autoScaleCurveShapeItem",function(e,t){s.setItemAttribute(AutoScale,t)}),this.attach(e),this.setEnabled(!1)}}define("curveShapeItem",["plotShapeItem"],function(){});class Watches{constructor(e){var t=[];function n(n,r,i){e.rv.addToWatchList(n),t.push(r),i&&n.setEnable(!1)}this.watchElements=function(){return t},n(new WatchCurveName,{text:"Curve name",tooltip:"Name of the curve that is the subject of watches.",checkboxState:"checked"}),n(new WatchLeftRulerPosition(e.rv),{text:"Left ruler position",tooltip:"Current position of the left ruler.",checkboxState:"checked"}),n(new WatchRightRulerPosition(e.rv),{text:"Right ruler position",tooltip:"Current position of the right ruler.",checkboxState:"checked"}),n(new WatchBottomRulerPosition(e.rv),{text:"Bottom ruler position",tooltip:"Current position of the bottom ruler."},!0),n(new WatchTopRulerPosition(e.rv),{text:"Top ruler position",tooltip:"Current position of the top ruler."},!0),n(new WatchSlope,{text:"Slope at left ruler",tooltip:"Slope (gradient) in the curve at the point where the left ruler intersects the curve."},!0),e.watchAreaBelowCurve=new WatchAreaBelowCurve,n(e.watchAreaBelowCurve,{text:"Area below curve",tooltip:"Area bounded by the curve, right ruler, x-axis and left ruler."},!0),n(new WatchVolumeOfRevolution,{text:"Volume of revolution(X)",tooltip:"Volume generated by a 360 degrees rotation about the x-axis of the area bounded by the curve, right ruler, x-axis and left ruler."},!0)}}define("watches",["basicWatch"],function(){});class AddRemovePointPicker extends PlotPicker{constructor(e){super(xBottom,yLeft,Static.NoRubberBand,Static.AlwaysOn,e);var t=this,n=null,r=!1;this.setStateMachine(new PickerClickPointMachine);var i=new CurveClosestPoint(e,function(e,t){r&&(e.removePoint(t),Static.trigger("curveAdjusted"))});function a(t){if(!r)return;if(!n){(n=new MyCurve(Utility.generateCurveName(e))).attach(e);let t=Utility.randomColor();n.setPen(new Misc.Pen(t));let r=new Symbol(MRect,new Misc.Brush(Static.invert(t)),new Misc.Pen(t),new Misc.Size(8,8));n.setSymbol(r);let i="";Static.showline&&Static.showsymbol?i="lineAndSymbol":Static.showline?i="line":Static.showsymbol&&(i="symbol"),Utility.setLegendAttribute(n,i,n.getLegendIconSize())}let i=n.data().samples();i.containsPoint(t)||i.push(t),i.sort(function(e,t){return e.x-t.x}),n.setSamples(i),e.autoRefresh(),Static.trigger("pointAdded",n),Static.trigger("curveAdjusted")}this.setEnabled(!1),this.activate=function(e){r=e,this.setEnabled(e),i.setEnabled(e)},this.setAddRemoveMousePattern=function(e,t,n=Static.NoModifier){this.setMousePattern(e,t,n),i.setMousePattern(t,n)},Static.bind("currentCurveChanged",function(e,r){n!==r&&(n=r||null)&&t.setAxis(n.xAxis(),n.yAxis())}),Static.bind("pointSelected",function(){r&&t.setEnabled(!1)}),Static.bind("pointNotSelected",function(){r&&t.setEnabled(!0)});var s=new Misc.Point(Number.MAX_VALUE,Number.MAX_VALUE);Static.bind("selected",function(r,i){var o=t.selection()[0];o&&(s.isEqual(o)||(s=o,a(n?ScaleMap.invTransform(e.axisScaleDraw(n.xAxis()).scaleMap(),e.axisScaleDraw(n.yAxis()).scaleMap(),o):ScaleMap.invTransform(e.axisScaleDraw(xBottom).scaleMap(),e.axisScaleDraw(yLeft).scaleMap(),o))))});var o=this.trackerFont();o.fontColor="blue",this.setTrackerFont(o)}trackerText(e){var t,n=this.plot();e=this.invTransform(e);var r=0;r=n.axisEnabled(xBottom)?n.axisDecimalPlaces(xBottom):n.axisEnabled(xTop)?n.axisDecimalPlaces(xTop):n.axisDecimalPlaces(xBottom);var i=0;i=n.axisEnabled(yLeft)?n.axisDecimalPlaces(yLeft):n.axisEnabled(yRight)?n.axisDecimalPlaces(yRight):n.axisDecimalPlaces(yLeft);var a=Static.adjustForDecimalPlaces(e.y,i),s=Static.adjustForDecimalPlaces(e.x,r),o=n.getNonExponentNotationLimits();switch((s>o.upper||s<o.lower)&&(s=s.toExponential(r)),(a>o.upper||a<o.lower)&&(a=a.toExponential(i)),this.rubberBand()){case Static.HLineRubberBand:t=a.toString();break;case Static.VLineRubberBand:t=s.toString();break;default:t=s.toString()+", "+a.toString()}return t}}define("addRemovePointPicker",["plot","curveClosestPoint","plotpicker","plotcurve","symbol"],function(){});class MFontPickerDlg{constructor(){var e=this;e.labelFont=null;var t=_.once(function(){$("body").append($('                        <div class="modal fade" id="fontPickerModal" role="dialog">                        <div class="modal-dialog modal-sm">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal">&times;</button>                        <h4 class="modal-title">Font Picker</h4>                        </div>                        <div class="modal-body">                        <div class="row">                        <div class="col-sm-2">Font:</div>                        <div class="col-sm-7">                        <select id="fontPickerFont">                        <option value="Arial">Arial</option>\t\t\t\t\t\t<option value="Arial Black">Arial Black</option>\t\t\t\t\t\t<option value="Comic Sans MS">Comic Sans MS</option>\t\t\t\t\t\t<option value="Courier New">Courier New</option>\t\t\t\t\t\t<option value="Georgia">Georgia</option>\t\t\t\t\t\t<option value="Impact">Impact</option>\t\t\t\t\t\t<option value="Lucida Console">Lucida Console</option>\t\t\t\t\t\t<option value="Lucida Sans Unicode">Lucida Sans Unicode</option>\t\t\t\t\t\t<option value="PalatinoLinotype">PalatinoLinotype</option>\t\t\t\t\t\t<option value="Tahoma">Tahoma</option>\t\t\t\t\t\t<option value="Times New Roman">Times New Roman</option>\t\t\t\t\t\t<option value="Trebuchet MS">Trebuchet MS</option>\t\t\t\t\t\t<option value="Verdana">Verdana</option>\t\t\t\t\t\t<option value="Gill Sans">Gill Sans</option>                        </select>                        </div>                        </div>                        <br>                        <div class="row">                        <div class="col-sm-2">Point:</div>                        <div class="col-sm-4">                        <input id="fontPickerPoint" type="number" min=6 max=40 value=12>                        </div>\t\t\t\t\t\t<div class="col-sm-2">Bold:</div>                        <div class="col-sm-1">                        <input id="fontPickerBold" type="checkbox" >                        </div>                        </div>\t\t\t\t\t\t<br>                        <div class="row">                        <div class="col-sm-2">Color:</div>                        <div class="col-sm-4">                        <input id="fontPickerColor" type="color" >                        </div>\t\t\t\t\t\t</div>                        <br>                        <div class="modal-footer">                        <button id="axisDlg_ok" type="button" class="btn btn-default"  data-dismiss="modal">Ok</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#fontPickerFont").change(function(){e.labelFont.name=$(this).val()}),$("#fontPickerColor").change(function(){e.labelFont.fontColor=$(this).val()}),$("#fontPickerPoint").change(function(){e.labelFont.th=$(this).val()}),$("#fontPickerBold").change(function(){e.labelFont.weight=$(this)[0].checked?"bold":"normal"})});this.fontPickerCb=function(){t(),$("#fontPickerColor").val(e.labelFont.fontColor),$("#fontPickerFont").val(e.labelFont.name),$("#fontPickerPoint").val(e.labelFont.th),"bold"==e.labelFont.weight?$("#fontPickerBold")[0].checked=!0:$("#fontPickerBold")[0].checked=!1,$("#fontPickerModal").modal({backdrop:"static"})}}}define("fontPicker",function(){});class MMarkerDlg{constructor(){const e=this;var t=null;let n=_.once(function(){t=new MFontPickerDlg,$("#markerModal").remove(),$("body").append($('                        <div class="modal fade" id="markerModal" role="dialog">                        <div class="modal-dialog modal-md">                        <div class="modal-content">                        <div class="modal-header">                        <button type="button" class= "close" id="closeMarkerDlg">&times;</button>                        <h4 id="markerTitle" class="modal-title">Marker</h4>                        </div>                        <div class="modal-body">  \x3c!--div class="panel panel-default">    <div class="panel-heading">Panel Heading</div>    <div class="panel-body">    Panel Content    </div>  </div--\x3e  <div class="panel panel-default">    <div class="panel-heading">General</div>    <div class="panel-body">    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">Name</div>    <div class="col-sm-4"><input id="marker_name" type="text"      value="marker_1"></div>    <div class="col-sm-3">Show on legend</div><div class="col-sm-1"><input id="marker_legend" type="checkbox"></div>    </div>\x3c!--row end--\x3e    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">Horizontal axis:</div>    <div class="col-sm-4">       <select id="markerHorizontalAxis">         <option value="markerAxisBottom">Bottom</option>         <option value="markerAxisTop">Top</option>\t </select>    </div>    <div class="col-sm-3">Vertical axis:</div>    <div class="col-sm-2">       <select id="markerVerticalAxis">         <option value="markerAxisLeft">Left</option>         <option value="markerAxisRight">Right</option>       </select>     </div>    </div>\x3c!--row end--\x3e    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">X-value</div>    <div class="col-sm-4"><input id="marker_xValue" type="text"  value=0.0 size="6"></div>    <div class="col-sm-3">Y-value</div><div class="col-sm-2"><input id="marker_yValue" type="text" value=0.0 size="6"></div>    </div>\x3c!--row end--\x3e    </div>  </div><div class="panel panel-default">    <div class="panel-heading">Label</div>    <div class="panel-body">    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">Text</div>    <div class="col-sm-3"><input id="marker_label" type="text"  value="Marker 1" size=12></div>    <div class="col-sm-1">Font</div><div class="col-sm-1"><input id="marker_labelFont" type="button" value="//"></div>    <div class="col-sm-1">Space</div><div class="col-sm-1"><input id="marker_labelSpace" type="number" value=2 min=2 max=40></div>    </div>\x3c!--row end--\x3e    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-3">Alignment:</div>    <div class="col-sm-3">       <select id="markerLabelAlignment">        <option value="markerAlignmentLeftTop">Left-Top</option>\t\t<option value="markerAlignmentLeftCenter">Left-Center</option>        <option value="markerAlignmentLeftBottom">Left-Bottom </option>        <option value="markerAlignmentRightTop">Right-Top</option>\t\t<option value="markerAlignmentRightCenter">Right-Center</option>        <option value="markerAlignmentRightBottom">Right-Bottom</option>\t    <option value="markerAlignmentCenterTop">Center-Top</option>\t\t<option value="markerAlignmentCenterCenter">Center-Center</option>        <option value="markerAlignmentCenterBottom">Center-Bottom</option>       </select>    </div>    <div class="col-sm-3">Orientation:</div>    <div class="col-sm-3">       <select id="markerLabelOrientation">         <option value="markerLabelHorizontal">Horizontal</option>         <option value="markerLabelVertical">Vertical</option>       </select>    </div>    </div>\x3c!--row end--\x3e    </div>  </div><div class="panel panel-default">    <div class="panel-heading">Line</div>    <div class="panel-body">    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-1">Style:</div>    <div class="col-sm-3">      <select id="markerLineStyle">\t   <option value=NoLine>No line</option>        <option value=VLine>Vertical line</option>        <option value=HLine>Horizontal line</option>\t   <option value=Cross>Cross line</option>      </select>    </div>    <div class="col-sm-2">Pen color</div>    <div class="col-sm-1"><input id="marker_lineColor" type="color"></div>    <div class="col-sm-2">Pen type:</div>    <div class="col-sm-3">      <select id="markerLineType">\t   <option value=solid>solid</option>        <option value=dot>dot</option>        <option value=dash>dash</option>\t   <option value=dashDot>dash-dot</option>\t   <option value=dashDotDot>dash-dot-dot</option>\t </select>    </div>    </div>\x3c!--row end--\x3e    </div>  </div><div class="panel panel-default">    <div class="panel-heading">Symbol</div>    <div class="panel-body">    <div class="row">\x3c!--row start--\x3e    <div class="col-sm-1">Style:</div>                        <div class="col-sm-3">                        <select id="markerSymbol">\t\t\t\t\t\t<option value=none>No symbol</option>                        <option value=arrow>Arrow</option>                        <option value=dotOnLine>Dot-on-line</option>\t\t\t\t\t\t</select>                        </div>\t\t\t\t\t\t<div class="col-sm-1">Angle:</div>                        <div class="col-sm-2"><input id="marker_symbolAngle" type="number" style="width:100%" value=0.0></div><div class="col-sm-3">Size(widthXheight)</div>                        <div class="col-sm-1" title="width x height">                        <select id="markerSymbolSize">\t\t\t\t\t<option value="6x6">6x6</option>                        \t<option value="6x8">6x8</option>                        \t<option value="6x10">6x10</option>\t\t\t\t\t<option value="6x12">6x12</option>                        \t<option value="6x14">6x14</option>\t\t\t\t\t<option value="8x6">8x6</option>                        \t<option value="8x8">8x8</option>                        \t<option value="8x10">8x10</option>\t\t\t\t\t<option value="8x12">8x12</option>                        \t<option value="8x14">8x14</option>\t\t\t\t\t<option value="10x6">10x6</option>                        \t<option value="10x8">10x8</option>                        \t<option value="10x10">10x10</option>\t\t\t\t\t<option value="10x12">10x12</option>                        \t<option value="10x14">10x14</option>\t\t\t\t\t<option value="12x6">12x6</option>                        \t<option value="12x8">12x8</option>                        \t<option value="12x10">12x10</option>\t\t\t\t\t<option value="12x12">12x12</option>                        \t<option value="12x14">12x14</option>\t\t\t\t\t<option value="14x6">14x6</option>                        \t<option value="14x8">14x8</option>                        \t<option value="14x10">14x10</option>\t\t\t\t\t<option value="14x12">14x12</option>                        \t<option value="14x14">14x14</option>\t\t\t\t  </select>                        </div>    </div>\x3c!--row end--\x3e    </div>  </div><div class="modal-footer">                        <button id="markerDlg_cancel" type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>\t\t\t\t\t\t<button id="markerDlg_remove" type="button" class="btn btn-default">Remove</button>                        <button id="markerDlg_ok" type="button" class="btn btn-default">Ok</button>                        </div>                        </div>                        </div>                        </div>                        </div>                        ')),$("#markerSymbolSize").val("14x14"),$("#markerDlg_ok").click(u),$("#markerDlg_remove").click(a),$("#closeMarkerDlg").click(c),$("#marker_name").keyup(o),$("#marker_labelFont").click(l),$("#markerLineStyle").click(function(){"NoLine"==$(this).val()?($("#marker_lineColor").attr("disabled",!0),$("#markerLineType").attr("disabled",!0)):($("#marker_lineColor").attr("disabled",!1),$("#markerLineType").attr("disabled",!1))})});class r extends Symbol{constructor(){super();this.type="arrow",this.setPen(new Misc.Pen("black",0)),this.setBrush(new Misc.Brush("red"));var e=new Misc.MPath;e.moveTo(13,30),e.lineTo(13,15),e.lineTo(10,15),e.lineTo(13,10),e.lineTo(16,15),e.lineTo(13,15),e.data.rotation=$("#marker_symbolAngle").val(),this.setPath(e),this.setPinPoint(new Misc.Point(13,10)),this.setSize(new Misc.Size(10,20))}}class i extends Symbol{constructor(){super();this.type="dotOnLine",this.setPen(new Misc.Pen("black",0)),this.setBrush(new Misc.Brush("red"));var e=new Misc.MPath;e.moveTo(13,30),e.lineTo(13,15),e.addRect(new Misc.Rect(10,9,6,6)),e.data.rotation=$("#marker_symbolAngle").val(),this.setPath(e),this.setPinPoint(new Misc.Point(14,13)),this.setSize(new Misc.Size(6,23))}}function a(){var t=e.plot.findPlotMarker($("#marker_name").val());t&&(t.detach(),c())}function s(){var n=e.plot.findPlotMarker($("#marker_name").val());if(n){t.labelFont=n.labelFont(),$("#markerDlg_remove").attr("disabled",!1),$("#marker_label").val(n.label()),$("#marker_xValue").val(n.xValue()),$("#marker_yValue").val(n.yValue()),$("#marker_labelSpace").val(n.spacing()),n.labelAlignment()&Static.AlignLeft&&n.labelAlignment()&Static.AlignTop?$("#markerLabelAlignment").val("markerAlignmentLeftTop"):n.labelAlignment()&Static.AlignLeft&&n.labelAlignment()&Static.AlignCenter?$("#markerLabelAlignment").val("markerAlignmentLeftCenter"):n.labelAlignment()&Static.AlignLeft&&n.labelAlignment()&Static.AlignBottom?$("#markerLabelAlignment").val("markerAlignmentLeftBottom"):n.labelAlignment()&Static.AlignRight&&n.labelAlignment()&Static.AlignTop?$("#markerLabelAlignment").val("markerAlignmentRightTop"):n.labelAlignment()&Static.AlignRight&&n.labelAlignment()&Static.AlignCenter?$("#markerLabelAlignment").val("markerAlignmentRightCenter"):n.labelAlignment()&Static.AlignRight&&n.labelAlignment()&Static.AlignBottom?$("#markerLabelAlignment").val("markerAlignmentRightBottom"):n.labelAlignment()&Static.AlignCenter&&n.labelAlignment()&Static.AlignTop?$("#markerLabelAlignment").val("markerAlignmentCenterTop"):n.labelAlignment()&Static.AlignCenter&&n.labelAlignment()&Static.AlignBottom?$("#markerLabelAlignment").val("markerAlignmentCenterBottom"):n.labelAlignment()&Static.AlignCenter&&$("#markerLabelAlignment").val("markerAlignmentCenterCenter"),n.labelOrientation()==Horizontal?$("#markerLabelOrientation").val("markerLabelHorizontal"):$("#markerLabelOrientation").val("markerLabelVertical"),n.testItemAttribute(Legend)?$("#marker_legend")[0].checked=!0:$("#marker_legend")[0].checked=!1,n.xAxis()===xBottom?$("#markerHorizontalAxis").val("markerAxisBottom"):$("#markerHorizontalAxis").val("markerAxisTop"),n.yAxis()===yLeft?$("#markerVerticalAxis").val("markerAxisLeft"):$("#markerVerticalAxis").val("markerAxisRight");var r="NoLine",i=n.lineStyle();i==VLine?r="VLine":i==HLine?r="HLine":i==Cross&&(r="Cross"),$("#markerLineStyle").val(r),$("#marker_lineColor").val(n.linePen().color),$("#markerLineType").val(n.linePen().style);var a=n.symbol();if(a){"arrow"===a.type?$("#markerSymbol").val("arrow"):"dotOnLine"===a.type&&$("#markerSymbol").val("dotOnLine");var s=a.path();s&&$("#marker_symbolAngle").val(parseFloat(s.data.rotation))}}else $("#markerDlg_remove").attr("disabled",!0);"NoLine"==$("#markerLineStyle").val()?($("#marker_lineColor").attr("disabled",!0),$("#markerLineType").attr("disabled",!0)):($("#marker_lineColor").attr("disabled",!1),$("#markerLineType").attr("disabled",!1)),a&&(6==a.size().width&&6==a.size().height?$("#markerSymbolSize").val("6x6"):6==a.size().width&&8==a.size().height?$("#markerSymbolSize").val("6x8"):6==a.size().width&&10==a.size().height?$("#markerSymbolSize").val("6x10"):6==a.size().width&&12==a.size().height?$("#markerSymbolSize").val("6x12"):6==a.size().width&&14==a.size().height?$("#markerSymbolSize").val("6x14"):8==a.size().width&&6==a.size().height?$("#markerSymbolSize").val("8x6"):8==a.size().width&&8==a.size().height?$("#markerSymbolSize").val("8x8"):8==a.size().width&&10==a.size().height?$("#markerSymbolSize").val("8x10"):8==a.size().width&&12==a.size().height?$("#markerSymbolSize").val("8x12"):8==a.size().width&&14==a.size().height?$("#markerSymbolSize").val("8x14"):10==a.size().width&&6==a.size().height?$("#markerSymbolSize").val("10x6"):10==a.size().width&&8==a.size().height?$("#markerSymbolSize").val("10x8"):10==a.size().width&&10==a.size().height?$("#markerSymbolSize").val("10x10"):10==a.size().width&&12==a.size().height?$("#markerSymbolSize").val("10x12"):10==a.size().width&&14==a.size().height?$("#markerSymbolSize").val("10x14"):12==a.size().width&&6==a.size().height?$("#markerSymbolSize").val("12x6"):12==a.size().width&&8==a.size().height?$("#markerSymbolSize").val("12x8"):12==a.size().width&&10==a.size().height?$("#markerSymbolSize").val("12x10"):12==a.size().width&&12==a.size().height?$("#markerSymbolSize").val("12x12"):12==a.size().width&&14==a.size().height?$("#markerSymbolSize").val("12x14"):14==a.size().width&&6==a.size().height?$("#markerSymbolSize").val("14x6"):14==a.size().width&&8==a.size().height?$("#markerSymbolSize").val("14x8"):14==a.size().width&&10==a.size().height?$("#markerSymbolSize").val("14x10"):14==a.size().width&&12==a.size().height?$("#markerSymbolSize").val("14x12"):14==a.size().width&&14==a.size().height&&$("#markerSymbolSize").val("14x14"))}function o(){s()}function l(){var n=e.plot.findPlotMarker($("#marker_name").val());t.labelFont=n?n.labelFont():new Misc.Font,t.fontPickerCb()}function c(){$("#markerDlg_cancel").click()}function u(){var n=e.plot.findPlotMarker($("#marker_name").val());n&&n.detach(),(n=new PlotMarker($("#marker_name").val())).setSpacing(parseInt($("#marker_labelSpace").val())),n.attach(e.plot),t.labelFont||(t.labelFont=new Misc.Font),n.setLabelFont(t.labelFont),"markerAxisBottom"===$("#markerHorizontalAxis").val()?n.setXAxis(xBottom):n.setXAxis(xTop),"markerAxisLeft"===$("#markerVerticalAxis").val()?n.setYAxis(yLeft):n.setYAxis(yRight),$("#marker_legend")[0].checked?n.setItemAttribute(Legend,!0):n.setItemAttribute(Legend,!1),"arrow"===$("#markerSymbol").val()?n.setSymbol(new r):"dotOnLine"===$("#markerSymbol").val()&&n.setSymbol(new i("dotOnLine")),n.setLinePen(new Misc.Pen($("#marker_lineColor").val(),1,$("#markerLineType").val())),"HLine"===$("#markerLineStyle").val()?n.setLineStyle(HLine):"VLine"===$("#markerLineStyle").val()?n.setLineStyle(VLine):"Cross"===$("#markerLineStyle").val()?n.setLineStyle(Cross):n.setLineStyle(NoLine);var a=math.eval(Static.expandDefines($("#marker_xValue").val())),s=math.eval(Static.expandDefines($("#marker_yValue").val()));n.setValue(new Misc.Point(a,s)),n.setLabel($("#marker_label").val()),"markerAlignmentLeftTop"==$("#markerLabelAlignment").val()?n.setLabelAlignment(Static.AlignLeft|Static.AlignTop):"markerAlignmentLeftCenter"==$("#markerLabelAlignment").val()?n.setLabelAlignment(Static.AlignLeft|Static.AlignCenter):"markerAlignmentLeftBottom"==$("#markerLabelAlignment").val()?n.setLabelAlignment(Static.AlignLeft|Static.AlignBottom):"markerAlignmentRightTop"==$("#markerLabelAlignment").val()?n.setLabelAlignment(Static.AlignRight|Static.AlignTop):"markerAlignmentRightCenter"==$("#markerLabelAlignment").val()?n.setLabelAlignment(Static.AlignRight|Static.AlignCenter):"markerAlignmentRightBottom"==$("#markerLabelAlignment").val()?n.setLabelAlignment(Static.AlignRight|Static.AlignBottom):"markerAlignmentCenterTop"==$("#markerLabelAlignment").val()?n.setLabelAlignment(Static.AlignCenter|Static.AlignTop):"markerAlignmentCenterCenter"==$("#markerLabelAlignment").val()?n.setLabelAlignment(Static.AlignCenter):"markerAlignmentCenterBottom"==$("#markerLabelAlignment").val()&&n.setLabelAlignment(Static.AlignCenter|Static.AlignBottom),"markerLabelHorizontal"==$("#markerLabelOrientation").val()?n.setLabelOrientation(Horizontal):"markerLabelVertical"==$("#markerLabelOrientation").val()&&n.setLabelOrientation(Vertical);var o=n.symbol();o&&("6x6"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(6,6)):"6x10"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(6,12)):"6x12"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(6,12)):"6x14"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(6,14)):"8x6"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(8,6)):"8x8"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(8,8)):"8x10"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(8,10)):"8x12"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(8,12)):"8x14"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(8,14)):"10x6"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(10,6)):"10x8"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(10,8)):"10x10"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(10,10)):"10x12"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(10,12)):"10x14"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(10,14)):"12x6"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(12,6)):"12x8"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(12,8)):"12x10"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(12,10)):"12x12"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(12,12)):"12x14"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(12,14)):"14x6"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(14,6)):"14x8"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(14,8)):"14x10"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(14,10)):"14x12"===$("#markerSymbolSize").val()?o.setSize(new Misc.Size(14,12)):"14x14"===$("#markerSymbolSize").val()&&o.setSize(new Misc.Size(14,14))),c(),e.plot.autoRefresh()}this.markerCb=function(t){n(),e.plot=t,s(),$("#markerModal").modal({backdrop:"static"})}}}define("markerDlg",["fontPicker"],function(){}),define("app/main",["curveLegendAttributeDlg","functionDlg","curveFitDlg","curveStyleDlg","axisDlg","pointEntryDlg","mtoolBar","file","watch","basicWatch","legendMenu","rulers","infoSidebar","infoPropertiesPane","plotSideBar","curvePropertiesPane","plotPropertiesPane","myPlot","myCurve","plotSpectroCurve","plotRasterItem","plotSpectrogram","rasterFileData","rasterFunctionData","pointData","symbol","legend","magnifier","plotGrid","widgetOverlay","myZoomer","curveFitter","spline","panner","contextMenu","plotMarker","curveClosestPoint","curveShapeItem","underscore","widgetOverlay","functionData","watches","addRemovePointPicker","markerDlg","fontPicker"],function(){Static.alert('This application is design to run in "chrome browser". While it may run in other browsers, some features may not behave as expected.',"small");new MyPlot($("#plotDiv"),"Plot")}),requirejs.config({baseUrl:"lib",paths:{app:"../app",underscore:"https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min",addRemovePointPicker:"../app/src/addRemovePointPicker",axisDlg:"../app/src/axisDlg",basicWatch:"../app/src/basicWatch",curveClosestPoint:"../app/src/curveClosestPoint",curveFitDlg:"../app/src/curveFitDlg",curveLegendAttributeDlg:"../app/src/curveLegendAttributeDlg",curvePropertiesPane:"../app/src/curvePropertiesPane",curveSettings:"../app/src/curveSettings",curveShapeItem:"../app/src/curveShapeItem",curveStyleDlg:"../app/src/curveStyleDlg",fontPicker:"../app/src/fontPicker",functionData:"../app/src/functionData",functionDlg:"../app/src/functionDlg",infoPropertiesPane:"../app/src/infoPropertiesPane",infoSidebar:"../app/src/infoSidebar",legendMenu:"../app/src/legendMenu",markerDlg:"../app/src/markerDlg",mpicker:"../app/src/mpicker",mtoolBar:"../app/src/mtoolBar",myCurve:"../app/src/myCurve",myPlot:"../app/src/myPlot",myZoomer:"../app/src/myZoomer",pane:"../app/src/pane",plotPropertiesPane:"../app/src/plotPropertiesPane",plotSideBar:"../app/src/plotSideBar",pointEntryDlg:"../app/src/pointEntryDlg",propertiesPane:"../app/src/propertiesPane",rasterFileData:"../app/src/rasterFileData",rasterFunctionData:"../app/src/rasterFunctionData",ruler:"../app/src/ruler",rulers:"../app/src/rulers",settings:"../app/src/settings",sideBar:"../app/src/sideBar",spectrogram:"../app/src/spectrogram",toolBar:"../app/src/toolBar",watch:"../app/src/watch",watches:"../app/src/watches"},shim:{underscore:{exports:"_"},treetable:{},static:{deps:["miscObjects"]},file:{deps:["xlsx","upload"]},plot:{deps:["static","widget","scaleWidget","utility","miscObjects","painter","scaleDiv","interval","scaleMap","scaleWidget","transform","layout","scaleDraw","scaleEngine","pointMapper"]},plotItem:{deps:["static"]},scaleMap:{deps:["static","transform"]},canvas:{deps:["static"]},curveFitter:{deps:["static"]},spline:{deps:["static"]},symbol:{deps:["static","graphic"]},seriesData:{deps:["static","plotItem"]},pointMapper:{deps:["static"]},pointData:{deps:["static","seriesData"]},scaleEngine:{deps:["static"]},scaleDraw:{deps:["static","abstractScaleDraw"]},widget:{deps:["static","hObject"]},widgetOverlay:{deps:["static","widget"]},scaleWidget:{deps:["static","widget"]},picker:{deps:["static","widgetOverlay","pickermachine"]},plotpicker:{deps:["static","picker"]},plotzoomer:{deps:["plotpicker"]},plotGrid:{deps:["static","plotItem"]},plotZoneItem:{deps:["static"]},plotSpectrogram:{deps:["static","conrec","plotRasterItem"]},plotRasterItem:{deps:["static","plotItem"]},plotSpectroCurve:{deps:["static","colorMap","plotItem","seriesData"]},colorMap:{deps:["static"]},plotcurve:{deps:["static","seriesData"]},panner:{deps:["static","hObject"]},magnifier:{deps:["static","hObject"]},plotShapeItem:{deps:["static","plotItem"]},plotMarker:{deps:["static","plotItem"]},legend:{deps:["static"]},pickermachine:{deps:["static","eventpattern"]},widget:{deps:["static","hObject"]},addRemovePointPicker:{deps:["plot","curveClosestPoint","plotpicker","plotcurve","symbol"]},axisDlg:{deps:[]},basicWatch:{deps:["static","watch","plotMarker"]},curveClosestPoint:{deps:["static","widgetOverlay","plotMarker"]},curveFitDlg:{deps:[]},curveLegendAttributeDlg:{deps:[]},curvePropertiesPane:{deps:["propertiesPane"]},curveSettings:{deps:[]},curveShapeItem:{deps:["plotShapeItem"]},curveStyleDlg:{deps:[]},fontPicker:{deps:[]},functionData:{deps:["pointData"]},functionDlg:{deps:[]},infoPropertiesPane:{deps:["pane"]},infoSidebar:{deps:["sideBar"]},legendMenu:{deps:["static","contextMenu"]},markerDlg:{deps:["fontPicker"]},mpicker:{deps:["static","plotpicker"]},mtoolBar:{deps:["toolBar","curveSettings"]},myCurve:{deps:["plotcurve"]},myPlot:{deps:["curveClosestPoint","plot","functionData","plotGrid","spectrogram"]},myZoomer:{deps:["plotzoomer"]},pane:{deps:["treetable"]},plotPropertiesPane:{deps:["propertiesPane"]},plotSideBar:{deps:["sideBar"]},pointEntryDlg:{deps:[]},propertiesPane:{deps:["pane"]},rasterFileData:{deps:["rasterData"]},rasterFunctionData:{deps:["rasterData"]},ruler:{deps:["static","plotMarker"]},rulers:{deps:["static","mpicker","ruler"]},settings:{deps:[]},sideBar:{deps:[]},spectrogram:{deps:["static","plotSpectrogram","colorMap","rasterFileData","rasterFunctionData"]},toolBar:{deps:[]},watch:{deps:[]},watches:{deps:["basicWatch"]}}}),requirejs(["app/main"]),define("app",function(){});